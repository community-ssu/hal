cscope 15 /scratchbox/users/makarhun/home/makarhun/release/hal               0002611085
	@hald-runner/main.c

26 
	~<¡dio.h
>

27 
	~<¡dlib.h
>

28 
	#DBUS_API_SUBJECT_TO_CHANGE


	)

29 
	~<dbus/dbus-glib-lowËv–.h
>

31 
	~<glib.h
>

32 
	~"uts.h
"

33 
	~"ruÂ”.h
"

35 #iâdeà
__GNUC__


36 
	#__©Œibu‹__
(
x
)

	)

39 
gboŞ—n


40 
	$·r£_udi
 (
run_»que¡
 *
r
, 
DBusMes§ge
 *
msg
, 
DBusMes§geI‹r
 *
™”
)

42 *
tmp¡r
;

45 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
(
™”
è!ğ
DBUS_TYPE_STRING
)

46 
m®fÜmed
;

47 
	`dbus_mes§ge_™”_g‘_basic
(
™”
, &
tmp¡r
);

48 
r
->
udi
 = 
	`g_¡rdup
(
tmp¡r
);

50 ià(!
	`dbus_mes§ge_™”_Ãxt
(
™”
))

51 
m®fÜmed
;

53  
TRUE
;

55 
m®fÜmed
:

56  
FALSE
;

57 
	}
}

59 
gboŞ—n


60 
	$·r£_’vœÚm’t
(
run_»que¡
 *
r
, 
DBusMes§ge
 *
msg
, 
DBusMes§geI‹r
 *
™”
)

62 
DBusMes§geI‹r
 
sub_™”
;

63 *
tmp¡r
;

66 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
(
™”
è!ğ
DBUS_TYPE_ARRAY
)

67 
m®fÜmed
;

68 
	`dbus_mes§ge_™”_»cur£
(
™”
, &
sub_™”
);

70 #ià
	`defšed
(
__F»eBSD__
)

71 
tmp¡r
 = 
	`g_¡rdup_´štf
("PATH=/sbš:/u¤/sbš:/bš:/u¤/bš:/u¤/loÿl/sbš:/u¤/X11R6/sbš:/bš:/u¤/bš:/u¤/loÿl/bš:/u¤/X11R6/bš:%s", 
	`g‘’v
("PATH"));

73 
tmp¡r
 = 
	`g_¡rdup_´štf
("PATH=/sbš:/u¤/sbš:/bš:/u¤/bš:%s", 
	`g‘’v
("PATH"));

75 
r
->
’vœÚm’t
 = 
	`g‘_¡ršg_¬¿y
(&
sub_™”
, 
tmp¡r
);

78 ià(!
	`dbus_mes§ge_™”_Ãxt
(
™”
è|| 
	`dbus_mes§ge_™”_g‘_¬g_ty³
(™”è!ğ
DBUS_TYPE_ARRAY
)

79 
m®fÜmed
;

80 
	`dbus_mes§ge_™”_»cur£
(
™”
, &
sub_™”
);

81 
r
->
¬gv
 = 
	`g‘_¡ršg_¬¿y
(&
sub_™”
, 
NULL
);

83  
TRUE
;

85 
m®fÜmed
:

86  
FALSE
;

87 
	}
}

90 
	$hªdË_run
(
DBusCÚÃùiÚ
 *
cÚ
, 
DBusMes§ge
 *
msg
)

92 
DBusMes§ge
 *
»¶y
;

93 
DBusMes§geI‹r
 
™”
;

94 
run_»que¡
 *
r
;

95 *
tmp¡r
;

97 
r
 = 
	`Ãw_run_»que¡
();

98 
	`g_as£¹
(
	`dbus_mes§ge_™”_š™
(
msg
, &
™”
));

100 ià(!
	`·r£_udi
(
r
, 
msg
, &
™”
))

101 
m®fÜmed
;

103 ià(!
	`·r£_’vœÚm’t
(
r
, 
msg
, &
™”
))

104 
m®fÜmed
;

107 ià(!
	`dbus_mes§ge_™”_Ãxt
(&
™”
è|| 
	`dbus_mes§ge_™”_g‘_¬g_ty³
(&™”è!ğ
DBUS_TYPE_STRING
)

108 
m®fÜmed
;

109 
	`dbus_mes§ge_™”_g‘_basic
(&
™”
, &
tmp¡r
);

110 
r
->
šput
 = 
	`g_¡rdup
(
tmp¡r
);

113 ià(!
	`dbus_mes§ge_™”_Ãxt
(&
™”
è|| 
	`dbus_mes§ge_™”_g‘_¬g_ty³
(&™”è!ğ
DBUS_TYPE_BOOLEAN
)

114 
m®fÜmed
;

115 
	`dbus_mes§ge_™”_g‘_basic
(&
™”
, &(
r
->
”rÜ_Ú_¡d”r
));

118 ià(!
	`dbus_mes§ge_™”_Ãxt
(&
™”
è|| 
	`dbus_mes§ge_™”_g‘_¬g_ty³
(&™”è!ğ
DBUS_TYPE_UINT32
)

119 
m®fÜmed
;

120 
	`dbus_mes§ge_™”_g‘_basic
(&
™”
, &(
r
->
timeout
));

123 
	`run_»que¡_run
(
r
, 
cÚ
, 
msg
, 
NULL
);

126 
m®fÜmed
:

127 
	`d–_run_»que¡
(
r
);

128 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
(
msg
, "org.freedesktop.HalRunner.Malformed",

130 
	`dbus_cÚÃùiÚ_£nd
(
cÚ
, 
»¶y
, 
NULL
);

131 
	`dbus_mes§ge_uÄef
(
»¶y
);

132 
	}
}

135 
	$hªdË_¡¬t
(
DBusCÚÃùiÚ
 *
cÚ
, 
DBusMes§ge
 *
msg
, 
gboŞ—n
 
is_sšgËtÚ
)

137 
DBusMes§ge
 *
»¶y
;

138 
DBusMes§geI‹r
 
™”
;

139 
run_»que¡
 *
r
;

140 
GPid
 
pid
;

142 
r
 = 
	`Ãw_run_»que¡
();

143 
r
->
is_sšgËtÚ
 = is_singleton;

145 
	`g_as£¹
(
	`dbus_mes§ge_™”_š™
(
msg
, &
™”
));

147 ià(!
	`dbus_mes§ge_™”_š™
(
msg
, &
™”
))

148 
m®fÜmed
;

150 ià(!
is_sšgËtÚ
 && !
	`·r£_udi
(
r
, 
msg
, &
™”
)) {

151 
	`årštf
(
¡d”r
, "error…arsing udi");

152 
m®fÜmed
;

155 ià(!
	`·r£_’vœÚm’t
(
r
, 
msg
, &
™”
)) {

156 
	`årštf
(
¡d”r
, "error…arsingƒnvironment");

157 
m®fÜmed
;

160 ià(
	`run_»que¡_run
(
r
, 
cÚ
, 
NULL
, &
pid
)) {

161 
gšt64
 
µid
 = 
pid
;

162 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
(
msg
);

163 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

164 
DBUS_TYPE_INT64
, &
µid
,

165 
DBUS_TYPE_INVALID
);

168 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
(
msg
, "org.freedesktop.HalRunner.Failed",

171 
	`dbus_cÚÃùiÚ_£nd
(
cÚ
, 
»¶y
, 
NULL
);

172 
	`dbus_mes§ge_uÄef
(
»¶y
);

174 
m®fÜmed
:

175 
	`d–_run_»que¡
(
r
);

176 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
(
msg
, "org.freedesktop.HalRunner.Malformed",

178 
	`dbus_cÚÃùiÚ_£nd
(
cÚ
, 
»¶y
, 
NULL
);

179 
	`dbus_mes§ge_uÄef
(
»¶y
);

180 
	}
}

183 
	$hªdË_kl
(
DBusCÚÃùiÚ
 *
cÚ
, 
DBusMes§ge
 *
msg
)

185 
DBusE¼Ü
 
”rÜ
;

186 
DBusMes§ge
 *
»¶y
 = 
NULL
;

187 *
udi
;

189 
	`dbus_”rÜ_š™
 (&
”rÜ
);

190 ià(!
	`dbus_mes§ge_g‘_¬gs
(
msg
, &
”rÜ
,

191 
DBUS_TYPE_STRING
, &
udi
,

192 
DBUS_TYPE_INVALID
)) {

193 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
msg
, "org.freedesktop.HalRunner.Malformed",

195 
	`g_as£¹
(
»¶y
);

196 
	`dbus_cÚÃùiÚ_£nd
 (
cÚ
, 
»¶y
, 
NULL
);

197 
	`dbus_mes§ge_uÄef
(
»¶y
);

200 
	`run_kl_udi
(
udi
);

203 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
(
msg
);

204 
	`dbus_cÚÃùiÚ_£nd
(
cÚ
, 
»¶y
, 
NULL
);

205 
	`dbus_mes§ge_uÄef
(
»¶y
);

206 
	}
}

208 
DBusHªdËrResuÉ


209 
	$f‹r
(
DBusCÚÃùiÚ
 *
cÚ
, 
DBusMes§ge
 *
msg
, *
u£r_d©a
)

211 
DBusMes§ge
 *
»¶y
;

213 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
msg
, "org.freedesktop.HalRunner", "Run")) {

214 
	`hªdË_run
(
cÚ
, 
msg
);

215  
DBUS_HANDLER_RESULT_HANDLED
;

216 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
msg
, "org.freedesktop.HalRunner", "Start")) {

217 
	`hªdË_¡¬t
(
cÚ
, 
msg
, 
FALSE
);

218  
DBUS_HANDLER_RESULT_HANDLED
;

219 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
msg
, "org.freedesktop.HalRunner", "StartSingleton")) {

220 
	`hªdË_¡¬t
(
cÚ
, 
msg
, 
TRUE
);

221  
DBUS_HANDLER_RESULT_HANDLED
;

222 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
msg
, "org.freedesktop.HalRunner", "Kill")) {

223 
	`hªdË_kl
(
cÚ
, 
msg
);

224  
DBUS_HANDLER_RESULT_HANDLED
;

225 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
msg
, "org.freedesktop.HalRunner", "Shutdown")) {

226 
	`run_kl_®l
 ();

227 
	`ex™
 (0);

228  
DBUS_HANDLER_RESULT_HANDLED
;

229 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
msg
, "org.freedesktop.HalRunner", "KillAll")) {

230 
	`run_kl_®l
();

232 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
(
msg
);

233 
	`dbus_cÚÃùiÚ_£nd
(
cÚ
, 
»¶y
, 
NULL
);

234 
	`dbus_mes§ge_uÄef
(
»¶y
);

235  
DBUS_HANDLER_RESULT_HANDLED
;

237  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

238 
	}
}

241 
	$maš
(
¬gc
, **
¬gv
)

243 
DBusCÚÃùiÚ
 *
c
;

244 
DBusE¼Ü
 
”rÜ
;

245 
GMašLoİ
 *
loİ
;

246 *
dbus_add»ss
;

248 
	`run_š™
();

249 
	`dbus_”rÜ_š™
(&
”rÜ
);

250 
dbus_add»ss
 = 
	`g‘’v
("HALD_RUNNER_DBUS_ADDRESS");

251 
	`g_as£¹
(
dbus_add»ss
 !ğ
NULL
);

253 
	`årštf
(
¡d”r
, "RuÂ” s¹ed -‡Îowed…©h ¬'%s'\n", 
	`g‘’v
("PATH"));

255 
c
 = 
	`dbus_cÚÃùiÚ_İ’
(
dbus_add»ss
, &
”rÜ
);

256 ià(
c
 =ğ
NULL
)

257 
”rÜ
;

259 
loİ
 = 
	`g_maš_loİ_Ãw
(
NULL
, 
FALSE
);

261 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
(
c
, 
NULL
);

262 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
(
c
, 
TRUE
);

263 
	`dbus_cÚÃùiÚ_add_f‹r
(
c
, 
f‹r
, 
NULL
, NULL);

265 
	`g_maš_loİ_run
(
loİ
);

267 
”rÜ
:

268 
	`årštf
(
¡d”r
,"AÀ”rÜ ha occu»d: %s\n", 
”rÜ
.
mes§ge
);

270 
	}
}

	@hald-runner/runner.c

26 
	~<¡dio.h
>

27 
	~<uni¡d.h
>

28 
	~<¡dlib.h
>

29 
	~<sys/ty³s.h
>

30 
	~<sys/¡©.h
>

31 
	~<sys/wa™.h
>

32 
	~<sigÇl.h
>

33 
	~<¡ršg.h
>

35 
	#DBUS_API_SUBJECT_TO_CHANGE


	)

36 
	~<dbus/dbus-glib-lowËv–.h
>

38 
	~<glib.h
>

39 
	~"uts.h
"

40 
	~"ruÂ”.h
"

43 
	#HALD_RUN_SUCCESS
 0x0

	)

45 
	#HALD_RUN_TIMEOUT
 0x1

	)

47 
	#HALD_RUN_FAILED
 0x2

	)

49 
	#HALD_RUN_KILLED
 0x4

	)

51 
GHashTabË
 *
	gudi_hash
 = 
NULL
;

52 
GLi¡
 *
	gsšgËtÚs
 = 
NULL
;

55 
run_»que¡
 *
	mr
;

56 
DBusMes§ge
 *
	mmsg
;

57 
DBusCÚÃùiÚ
 *
	mcÚ
;

58 
GPid
 
	mpid
;

59 
gšt
 
	m¡d”r_v
;

60 
gušt
 
	mw©ch
;

61 
gušt
 
	mtimeout
;

62 
gboŞ—n
 
	m£Á_kl
;

63 
gboŞ—n
 
	mem™_pid_ex™ed
;

64 } 
	trun_d©a
;

67 
	$d–_run_d©a
(
run_d©a
 *
rd
)

69 ià(
rd
 =ğ
NULL
)

72 
	`d–_run_»que¡
(
rd
->
r
);

73 ià(
rd
->
msg
)

74 
	`dbus_mes§ge_uÄef
(
rd
->
msg
);

76 
	`g_¥awn_şo£_pid
(
rd
->
pid
);

78 ià(
rd
->
¡d”r_v
 >= 0)

79 
	`şo£
(
rd
->
¡d”r_v
);

81 ià(
rd
->
timeout
 != 0)

82 
	`g_sourû_»move
(
rd
->
timeout
);

84 
	`g_ä“
(
rd
);

85 
	}
}

87 
run_»que¡
 *

88 
	$Ãw_run_»que¡
()

90 
run_»que¡
 *
»suÉ
;

91 
»suÉ
 = 
	`g_Ãw0
(
run_»que¡
, 1);

92 
	`g_as£¹
(
»suÉ
 !ğ
NULL
);

93  
»suÉ
;

94 
	}
}

97 
	$d–_run_»que¡
(
run_»que¡
 *
r
)

99 ià(
r
 =ğ
NULL
)

101 
	`g_ä“
(
r
->
udi
);

102 
	`ä“_¡ršg_¬¿y
(
r
->
’vœÚm’t
);

103 
	`ä“_¡ršg_¬¿y
(
r
->
¬gv
);

104 
	`g_ä“
(
r
->
šput
);

105 
	`g_ä“
(
r
);

106 
	}
}

109 
	$£nd_»¶y
(
DBusCÚÃùiÚ
 *
cÚ
, 
DBusMes§ge
 *
msg
, 
gušt32
 
ex™_ty³
, 
gšt32
 
»tuº_code
, 
gch¬
 **
”rÜ
)

111 
DBusMes§ge
 *
»¶y
;

112 
DBusMes§geI‹r
 
™”
;

113 
i
;

115 ià(
cÚ
 =ğ
NULL
 || 
msg
 == NULL)

118 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
(
msg
);

119 
	`g_as£¹
(
»¶y
 !ğ
NULL
);

121 
	`dbus_mes§ge_™”_š™_­³nd
(
»¶y
, &
™”
);

122 
	`dbus_mes§ge_™”_­³nd_basic
(&
™”
, 
DBUS_TYPE_UINT32
, &
ex™_ty³
);

123 
	`dbus_mes§ge_™”_­³nd_basic
(&
™”
, 
DBUS_TYPE_INT32
, &
»tuº_code
);

124 ià(
”rÜ
 !ğ
NULL
è
i
 = 0;ƒrror[i] != NULL; i++) {

125 
	`dbus_mes§ge_™”_­³nd_basic
(&
™”
, 
DBUS_TYPE_STRING
, &
”rÜ
[
i
]);

128 
	`dbus_cÚÃùiÚ_£nd
(
cÚ
, 
»¶y
, 
NULL
);

129 
	`dbus_mes§ge_uÄef
(
»¶y
);

130 
	}
}

133 
	$»move_run_d©a
(
run_d©a
 *
rd
)

135 
GLi¡
 *
li¡
;

137 ià(
rd
->
r
->
is_sšgËtÚ
) {

138 
sšgËtÚs
 = 
	`g_li¡_»move
(sšgËtÚs, 
rd
);

141 
li¡
 = (
GLi¡
 *)
	`g_hash_bË_lookup
(
udi_hash
, 
rd
->
r
->
udi
);

142 
li¡
 = 
	`g_li¡_»move
Öi¡, 
rd
);

144 
	`g_hash_bË_š£¹
(
udi_hash
, 
	`g_¡rdup
(
rd
->
r
->
udi
), 
li¡
);

146 
	}
}

149 
	$run_ex™ed
(
GPid
 
pid
, 
gšt
 
¡©us
, 
gpoš‹r
 
d©a
)

151 
run_d©a
 *
rd
 = (run_d©¨*)
d©a
;

152 **
”rÜ
 = 
NULL
;

154 
	`´štf
("pid %d:„c=%d signaled=%d: %s\n",

155 
pid
, 
	`WEXITSTATUS
(
¡©us
), 
	`WIFSIGNALED
(¡©us), 
rd
->
r
->
¬gv
[0]);

156 
rd
->
w©ch
 = 0;

157 ià(
rd
->
£Á_kl
 =ğ
TRUE
) {

159 
	`d–_run_d©a
(
rd
);

163 ià(!
	`WIFEXITED
(
¡©us
)) {

165 
	`£nd_»¶y
(
rd
->
cÚ
,„d->
msg
, 
HALD_RUN_FAILED
, 0, 
NULL
);

166 
out
;

169 ià(
rd
->
¡d”r_v
 >= 0) {

171 
”rÜ
 = 
	`g‘_¡ršg_¬¿y_äom_fd
(
rd
->
¡d”r_v
);

172 
	`şo£
(
rd
->
¡d”r_v
);

173 
rd
->
¡d”r_v
 = -1;

175 ià(
rd
->
msg
 !ğ
NULL
)

176 
	`£nd_»¶y
(
rd
->
cÚ
,„d->
msg
, 
HALD_RUN_SUCCESS
, 
	`WEXITSTATUS
(
¡©us
), 
”rÜ
);

177 
	`ä“_¡ršg_¬¿y
(
”rÜ
);

179 
out
:

180 
	`»move_run_d©a
 (
rd
);

183 if(
rd
->
cÚ
 !ğ
NULL
 &&„d->
em™_pid_ex™ed
) {

184 
DBusMes§ge
 *
sigÇl
;

185 
gšt64
 
µid
 = 
rd
->
pid
;

186 
sigÇl
 = 
	`dbus_mes§ge_Ãw_sigÇl
 ("/org/freedesktop/HalRunner",

189 
	`dbus_mes§ge_­³nd_¬gs
 (
sigÇl
,

190 
DBUS_TYPE_INT64
, &(
µid
),

191 
DBUS_TYPE_INVALID
);

192 
	`dbus_cÚÃùiÚ_£nd
(
rd
->
cÚ
, 
sigÇl
, 
NULL
);

195 
	`d–_run_d©a
(
rd
);

196 
	}
}

198 
gboŞ—n


199 
	$run_timedout
(
gpoš‹r
 
d©a
) {

200 
run_d©a
 *
rd
 = (run_d©¨*)
d©a
;

204 
	`kl
(
rd
->
pid
, 
SIGTERM
);

206 
rd
->
timeout
 = 0;

208 
rd
->
£Á_kl
 = 
TRUE
;

210 
	`£nd_»¶y
(
rd
->
cÚ
,„d->
msg
, 
HALD_RUN_TIMEOUT
, 0, 
NULL
);

211 
	`»move_run_d©a
 (
rd
);

212  
FALSE
;

213 
	}
}

215 
gboŞ—n


216 
	$fšd_´og¿m
(**
¬gv
)

219 *
´og¿m
;

220 *
·th
 = 
NULL
;

222 ià(
¬gv
[0] =ğ
NULL
)

223  
FALSE
;

225 
´og¿m
 = 
	`g_·th_g‘_ba£Çme
(
¬gv
[0]);

228 
·th
 = 
	`g_fšd_´og¿m_š_·th
 (
´og¿m
);

229 
	`g_ä“
(
´og¿m
);

230 ià(
·th
 =ğ
NULL
)

231  
FALSE
;

234 
	`g_ä“
(
¬gv
[0]);

235 
¬gv
[0] = 
·th
;

237  
TRUE
;

238 
	}
}

241 
gboŞ—n


242 
	$run_»que¡_run
 (
run_»que¡
 *
r
, 
DBusCÚÃùiÚ
 *
cÚ
, 
DBusMes§ge
 *
msg
, 
GPid
 *
out_pid
)

244 
GPid
 
pid
;

245 
GE¼Ü
 *
”rÜ
 = 
NULL
;

246 
gšt
 *
¡dš_p
 = 
NULL
;

247 
gšt
 *
¡d”r_p
 = 
NULL
;

248 
gšt
 
¡dš_v
;

249 
gšt
 
¡d”r_v
 = -1;

250 
run_d©a
 *
rd
 = 
NULL
;

251 
gboŞ—n
 
´og¿m_exi¡s
 = 
FALSE
;

252 *
´og¿m_dœ
 = 
NULL
;

253 
GLi¡
 *
li¡
;

255 
	`´štf
("RuÀ¡¬‹d % (%uè(%dè\n!", 
r
->
¬gv
[0],„->
timeout
,

256 
r
->
”rÜ_Ú_¡d”r
);

257 ià(
r
->
šput
 !ğ
NULL
) {

258 
¡dš_p
 = &
¡dš_v
;

260 ià(
r
->
”rÜ_Ú_¡d”r
) {

261 
¡d”r_p
 = &
¡d”r_v
;

264 
´og¿m_exi¡s
 = 
	`fšd_´og¿m
(
r
->
¬gv
);

266 ià(
´og¿m_exi¡s
)

267 
´og¿m_dœ
 = 
	`g_·th_g‘_dœÇme
 (
r
->
¬gv
[0]);

269 
	`´štf
(" fuÎ…©h i '%s',…rog¿m_dœ i '%s'\n", 
r
->
¬gv
[0], 
´og¿m_dœ
);

271 ià(!
´og¿m_exi¡s
 ||

272 !
	`g_¥awn_async_w™h_pes
(
´og¿m_dœ
, 
r
->
¬gv
,„->
’vœÚm’t
,

273 
G_SPAWN_DO_NOT_REAP_CHILD
,

274 
NULL
, NULL, &
pid
,

275 
¡dš_p
, 
NULL
, 
¡d”r_p
, &
”rÜ
)) {

276 
	`g_ä“
 (
´og¿m_dœ
);

277 
	`d–_run_»que¡
(
r
);

278 ià(
cÚ
 && 
msg
)

279 
	`£nd_»¶y
(
cÚ
, 
msg
, 
HALD_RUN_FAILED
, 0, 
NULL
);

280  
FALSE
;

282 
	`g_ä“
 (
´og¿m_dœ
);

284 ià(
r
->
šput
) {

285 ià(
	`wr™e
(
¡dš_v
, 
r
->
šput
, 
	`¡¾’
Ô->šput)è!ğ(
ssize_t
) strlen(r->input))

286 
	`´štf
("W¬nšg: E¼Ü whwr™šg„->špuˆ(%sètØ¡dš_v.\n", 
r
->
šput
);

287 
	`şo£
(
¡dš_v
);

290 
rd
 = 
	`g_Ãw0
(
run_d©a
,1);

291 
	`g_as£¹
(
rd
 !ğ
NULL
);

292 
rd
->
r
 =„;

293 
rd
->
msg
 = msg;

294 ià(
msg
 !ğ
NULL
)

295 
	`dbus_mes§ge_»f
(
msg
);

297 
rd
->
cÚ
 = con;

298 
rd
->
pid
 =…id;

299 
rd
->
¡d”r_v
 = stderr_v;

300 
rd
->
£Á_kl
 = 
FALSE
;

303 
rd
->
w©ch
 = 
	`g_chd_w©ch_add
(
pid
, 
run_ex™ed
,„d);

306 ià(
r
->
timeout
 > 0)

307 
rd
->
timeout
 = 
	`g_timeout_add
(
r
->timeout, 
run_timedout
,„d);

309 
rd
->
timeout
 = 0;

311 ià(
r
->
is_sšgËtÚ
) {

312 
sšgËtÚs
 = 
	`g_li¡_´•’d
(sšgËtÚs, 
rd
);

315 
li¡
 = (
GLi¡
 *)
	`g_hash_bË_lookup
(
udi_hash
, 
r
->
udi
);

316 
li¡
 = 
	`g_li¡_´•’d
Öi¡, 
rd
);

319 
	`g_hash_bË_š£¹
(
udi_hash
, 
	`g_¡rdup
(
r
->
udi
), 
li¡
);

323 ià(
out_pid
 !ğ
NULL
) {

324 *
out_pid
 = 
pid
;

325 
rd
->
em™_pid_ex™ed
 = 
TRUE
;

327  
TRUE
;

328 
	}
}

331 
	$kl_rd
(
gpoš‹r
 
d©a
, gpoš‹¸
u£r_d©a
)

333 
run_d©a
 *
rd
 = (run_d©¨*)
d©a
;

335 
	`kl
(
rd
->
pid
, 
SIGTERM
);

336 
	`´štf
("S’ˆkÈtØ%d\n", 
rd
->
pid
);

337 ià(
rd
->
timeout
 != 0) {

339 
	`g_sourû_»move
(
rd
->
timeout
);

340 
rd
->
timeout
 = 0;

344 
rd
->
£Á_kl
 = 
TRUE
;

346 ià(
rd
->
msg
 !ğ
NULL
)

347 
	`£nd_»¶y
(
rd
->
cÚ
,„d->
msg
, 
HALD_RUN_KILLED
, 0, 
NULL
);

348 
	}
}

351 
	$do_kl_udi
(
gch¬
 *
udi
)

353 
GLi¡
 *
li¡
;

354 
li¡
 = (
GLi¡
 *)
	`g_hash_bË_lookup
(
udi_hash
, 
udi
);

355 
	`g_li¡_fÜ—ch
(
li¡
, 
kl_rd
, 
NULL
);

356 
	`g_li¡_ä“
(
li¡
);

357 
	}
}

361 
	$run_kl_udi
(
gch¬
 *
udi
)

363 
	`do_kl_udi
(
udi
);

364 
	`g_hash_bË_»move
(
udi_hash
, 
udi
);

365 
	}
}

367 
gboŞ—n


368 
	$hash_kl_udi
(
gpoš‹r
 
key
, gpoš‹¸
v®ue
, gpoš‹¸
u£r_d©a
) {

369 
	`do_kl_udi
(
key
);

370  
TRUE
;

371 
	}
}

375 
	$run_kl_®l
()

377 
	`g_hash_bË_fÜ—ch_»move
(
udi_hash
, 
hash_kl_udi
, 
NULL
);

378 
	`g_li¡_fÜ—ch
(
sšgËtÚs
, 
kl_rd
, 
NULL
);

379 
	}
}

382 
	$run_š™
()

384 
udi_hash
 = 
	`g_hash_bË_Ãw_fuÎ
(
g_¡r_hash
, 
g_¡r_equ®
, 
g_ä“
, 
NULL
);

385 
	}
}

	@hald-runner/runner.h

25 #iâdeà
RUNNER_H


26 
	#RUNNER_H


	)

28 
	#DBUS_API_SUBJECT_TO_CHANGE


	)

29 
	~<dbus/dbus-glib-lowËv–.h
>

31 
	~<glib.h
>

34 
gch¬
 *
	mudi
;

35 
gch¬
 **
	m’vœÚm’t
;

36 
gch¬
 **
	m¬gv
;

37 
gch¬
 *
	mšput
;

38 
gboŞ—n
 
	m”rÜ_Ú_¡d”r
;

39 
gboŞ—n
 
	mis_sšgËtÚ
;

40 
gušt32
 
	mtimeout
;

41 } 
	trun_»que¡
;

43 
run_»que¡
 *
Ãw_run_»que¡
();

44 
d–_run_»que¡
(
run_»que¡
 *
r
);

47 
gboŞ—n
 
run_»que¡_run
(
run_»que¡
 *
r
, 
DBusCÚÃùiÚ
 *
cÚ
, 
DBusMes§ge
 *
msg
, 
GPid
 *
out_pid
);

50 
run_kl_udi
(
gch¬
 *
udi
);

53 
run_kl_®l
();

56 
run_š™
();

	@hald-runner/utils.c

25 
	~<¡dio.h
>

26 
	~<¡dlib.h
>

27 
	#DBUS_API_SUBJECT_TO_CHANGE


	)

28 
	~<dbus/dbus-glib-lowËv–.h
>

29 
	~<glib.h
>

31 
	~"uts.h
"

34 
	$g‘_¡ršg_¬¿y
(
DBusMes§geI‹r
 *
™”
, *
exŒa
)

36 
GA¼ay
 *
¬¿y
;

37 **
»suÉ
;

38 
¬¿y
 = 
	`g_¬¿y_Ãw
(
TRUE
, 
FALSE
, (*));

40 
	`dbus_mes§ge_™”_g‘_¬g_ty³
(
™”
è=ğ
DBUS_TYPE_STRING
) {

41 cÚ¡ *
v®ue
;

42 *
t
;

43 
	`dbus_mes§ge_™”_g‘_basic
(
™”
, &
v®ue
);

44 
t
 = 
	`g_¡rdup
(
v®ue
);

45 
	`g_¬¿y_­³nd_v®s
(
¬¿y
, &
t
, 1);

46 
	`dbus_mes§ge_™”_Ãxt
(
™”
);

48 ià(
exŒa
 !ğ
NULL
)

49 
	`g_¬¿y_­³nd_v®s
(
¬¿y
, &
exŒa
, 1);

50 
»suÉ
 = (**è
¬¿y
->
d©a
;

51 
	`g_¬¿y_ä“
(
¬¿y
, 
FALSE
);

52  
»suÉ
;

53 
	}
}

56 
	$g‘_¡ršg_¬¿y_äom_fd
(
fd
)

58 
GA¼ay
 *
¬¿y
;

59 **
»suÉ
;

60 
GSŒšg
 *
¡r
;

61 
gsize
 
pos
;

62 
GIOChªÃl
 *
io
;

63 
i
 = 0;

65 
¬¿y
 = 
	`g_¬¿y_Ãw
(
TRUE
, 
FALSE
, (*));

66 
¡r
 = 
	`g_¡ršg_Ãw
("");

67 
io
 = 
	`g_io_chªÃl_unix_Ãw
(
fd
);

68 
	`g_io_chªÃl_»ad_lše_¡ršg
(
io
, 
¡r
, &
pos
, 
NULL
è=ğ
G_IO_STATUS_NORMAL
 && (
i
++ < 128)) {

69 *
t
;

72 
	`g_¡ršg_”a£
(
¡r
, 
pos
, 1);

73 
t
 = 
	`g_¡rdup
(
¡r
->str);

74 
	`g_¬¿y_­³nd_v®s
(
¬¿y
, &
t
, 1);

76 
	`g_¡ršg_ä“
(
¡r
, 
TRUE
);

77 
	`g_io_chªÃl_uÄef
(
io
);

78 
»suÉ
 = (**è
¬¿y
->
d©a
;

79 
	`g_¬¿y_ä“
(
¬¿y
, 
FALSE
);

80  
»suÉ
;

81 
	}
}

84 
	$ä“_¡ršg_¬¿y
(**
¬¿y
)

86 **
p
;

88 
p
 = 
¬¿y
;… !ğ
NULL
 && *p != NULL;…++)

89 
	`g_ä“
(*
p
);

90 
	`g_ä“
(
¬¿y
);

91 
	}
}

	@hald-runner/utils.h

25 #iâdeà
UTILS_H


26 
	#UTILS_H


	)

28 
	#DBUS_API_SUBJECT_TO_CHANGE


	)

29 
	~<dbus/dbus-glib-lowËv–.h
>

31 **
g‘_¡ršg_¬¿y
(
DBusMes§geI‹r
 *
™”
, 
gch¬
 *
exŒa
);

32 **
g‘_¡ršg_¬¿y_äom_fd
(
fd
);

33 
ä“_¡ršg_¬¿y
(**
¬¿y
);

	@hald/access-check.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<¡dlib.h
>

31 
	~<¡dio.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<¡d¬g.h
>

35 
	~<¡dšt.h
>

36 
	~<sys/time.h
>

38 
	~<dbus/dbus.h
>

39 
	~<glib.h
>

41 #ifdeà
HAVE_POLKIT


42 
	~<pŞk™/pŞk™.h
>

45 
	~"h®d.h
"

46 
	~"h®d_dbus.h
"

47 
	~"logg”.h
"

48 
	~"acûss-check.h
"

59 
gboŞ—n


60 
	$acûss_check_ÿÎ”_is_roÙ_Ü_h®
 (
CIT¿ck”
 *
c™
, cÚ¡ *
ÿÎ”_unique_sysbus_Çme
)

62 
gboŞ—n
 
»t
;

63 
CIC®ËrInfo
 *
ci
;

65 
»t
 = 
FALSE
;

67 
ci
 = 
	`ci_Œack”_g‘_šfo
 (
c™
, 
ÿÎ”_unique_sysbus_Çme
);

68 ià(
ci
 =ğ
NULL
) {

69 
out
;

72 
	`HAL_INFO
 (("uid fÜ c®Ë¸i %ld", 
	`ci_Œack”_ÿÎ”_g‘_uid
 (
ci
)));

74 ià(
	`ci_Œack”_ÿÎ”_g‘_uid
 (
ci
è!ğ0 && ci_Œack”_ÿÎ”_g‘_uid (ciè!ğ
	`g‘euid
 ()) {

75 
	`HAL_WARNING
 (("uid %d i nÙ…riveged", 
	`ci_Œack”_ÿÎ”_g‘_uid
 (
ci
)));

76 
out
;

79 
»t
 = 
TRUE
;

81 
out
:

82  
»t
;

83 
	}
}

94 
gboŞ—n


95 
	$acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
CIT¿ck”
 *
c™
, 
DBusMes§ge
 *
mes§ge
)

97 
gboŞ—n
 
»t
;

98 cÚ¡ *
u£r_ba£_svc
;

100 
»t
 = 
FALSE
;

102 
u£r_ba£_svc
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

103 ià(
u£r_ba£_svc
 =ğ
NULL
) {

104 
	`HAL_WARNING
 (("Cannot determine base service of caller"));

105 
out
;

108 
»t
 = 
	`acûss_check_ÿÎ”_is_roÙ_Ü_h®
 (
c™
, 
u£r_ba£_svc
);

110 
out
:

111  
»t
;

112 
	}
}

114 #ifdeà
HAVE_POLKIT


115 
PŞK™S—t
 *

116 
	$g‘_pk_£©_äom_ck_£©
 (
CKS—t
 *
£©
)

118 *
¡r
;

119 
PŞK™S—t
 *
pk_£©
;

120 
pk_£©
 = 
	`pŞk™_£©_Ãw
 ();

121 
¡r
 = 
	`g_¡rdup_´štf
 ("/Üg/ä“desktİ/CÚsŞeK™/%s", 
	`ck_£©_g‘_id
 (
£©
));

122 
	`pŞk™_£©_£t_ck_obj»f
 (
pk_£©
, 
¡r
);

123 
	`g_ä“
 (
¡r
);

124  
pk_£©
;

125 
	}
}

127 
PŞK™SessiÚ
 *

128 
	$g‘_pk_£ssiÚ_äom_ck_£ssiÚ
 (
CKSessiÚ
 *
£ssiÚ
)

130 *
¡r
;

131 
CKS—t
 *
£©
;

132 
PŞK™S—t
 *
pk_£©
;

133 
PŞK™SessiÚ
 *
pk_£ssiÚ
;

135 
£©
 = 
	`ck_£ssiÚ_g‘_£©
 (
£ssiÚ
);

136 ià(
£©
 =ğ
NULL
) {

137 
pk_£©
 = 
NULL
;

139 
pk_£©
 = 
	`g‘_pk_£©_äom_ck_£©
 (
£©
);

142 
pk_£ssiÚ
 = 
	`pŞk™_£ssiÚ_Ãw
 ();

143 ià(
pk_£©
 !ğ
NULL
) {

144 
	`pŞk™_£ssiÚ_£t_£©
 (
pk_£ssiÚ
, 
pk_£©
);

145 
	`pŞk™_£©_uÄef
 (
pk_£©
);

147 
¡r
 = 
	`g_¡rdup_´štf
 ("/Üg/ä“desktİ/CÚsŞeK™/%s", 
	`ck_£ssiÚ_g‘_id
 (
£ssiÚ
));

148 
	`pŞk™_£ssiÚ_£t_ck_obj»f
 (
pk_£ssiÚ
, 
¡r
);

149 
	`g_ä“
 (
¡r
);

150 
	`pŞk™_£ssiÚ_£t_uid
 (
pk_£ssiÚ
, 
	`ck_£ssiÚ_g‘_u£r
 (
£ssiÚ
));

151 
	`pŞk™_£ssiÚ_£t_ck_is_aùive
 (
pk_£ssiÚ
, 
	`ck_£ssiÚ_is_aùive
 (
£ssiÚ
));

152 
	`pŞk™_£ssiÚ_£t_ck_is_loÿl
 (
pk_£ssiÚ
, 
	`ck_£ssiÚ_is_loÿl
 (
£ssiÚ
));

153 ià(!
	`ck_£ssiÚ_is_loÿl
 (
£ssiÚ
)) {

154 
	`pŞk™_£ssiÚ_£t_ck_»mÙe_ho¡
 (
pk_£ssiÚ
, 
	`ck_£ssiÚ_g‘_ho¡Çme
 (
£ssiÚ
));

156  
pk_£ssiÚ
;

157 
	}
}

159 
PŞK™C®Ër
 *

160 
	$g‘_pk_ÿÎ”_äom_ci_Œack”
 (
CIT¿ck”
 *
c™
, cÚ¡ *
ÿÎ”_unique_sysbus_Çme
)

162 
CIC®ËrInfo
 *
ci
;

163 
PŞK™SessiÚ
 *
pk_£ssiÚ
;

164 
PŞK™C®Ër
 *
pk_ÿÎ”
;

165 cÚ¡ *
ck_£ssiÚ_obj·th
;

166 cÚ¡ *
£lšux_cÚ‹xt
;

168 
pk_ÿÎ”
 = 
NULL
;

170 
ci
 = 
	`ci_Œack”_g‘_šfo
 (
c™
, 
ÿÎ”_unique_sysbus_Çme
);

171 ià(
ci
 =ğ
NULL
) {

172 
	`HAL_ERROR
 (("CªnÙ g‘ c®Ë¸šfØfÜ %s", 
ÿÎ”_unique_sysbus_Çme
));

173 
out
;

176 
ck_£ssiÚ_obj·th
 = 
	`ci_Œack”_ÿÎ”_g‘_ck_£ssiÚ_·th
 (
ci
);

177 ià(
ck_£ssiÚ_obj·th
 =ğ
NULL
) {

178 
pk_£ssiÚ
 = 
NULL
;

180 
CKSessiÚ
 *
£ssiÚ
;

182 
£ssiÚ
 = 
	`ck_Œack”_fšd_£ssiÚ
 (
	`h®d_dbus_g‘_ck_Œack”
 (), 
ck_£ssiÚ_obj·th
);

183 ià(
£ssiÚ
 =ğ
NULL
) {

185 
	`HAL_ERROR
 (("ck_session_objpath is‚ot NULL, but CKTracker don't know‡bouthe session!"));

186 
out
;

189 
pk_£ssiÚ
 = 
	`g‘_pk_£ssiÚ_äom_ck_£ssiÚ
 (
£ssiÚ
);

192 
pk_ÿÎ”
 = 
	`pŞk™_ÿÎ”_Ãw
 ();

193 
	`pŞk™_ÿÎ”_£t_dbus_Çme
 (
pk_ÿÎ”
, 
ÿÎ”_unique_sysbus_Çme
);

194 
	`pŞk™_ÿÎ”_£t_uid
 (
pk_ÿÎ”
, 
	`ci_Œack”_ÿÎ”_g‘_uid
 (
ci
));

195 
	`pŞk™_ÿÎ”_£t_pid
 (
pk_ÿÎ”
, 
	`ci_Œack”_ÿÎ”_g‘_pid
 (
ci
));

196 
£lšux_cÚ‹xt
 = 
	`ci_Œack”_ÿÎ”_g‘_£lšux_cÚ‹xt
 (
ci
);

197 ià(
£lšux_cÚ‹xt
 !ğ
NULL
) {

198 
	`pŞk™_ÿÎ”_£t_£lšux_cÚ‹xt
 (
pk_ÿÎ”
, 
£lšux_cÚ‹xt
);

200 ià(
pk_£ssiÚ
 !ğ
NULL
) {

201 
	`pŞk™_ÿÎ”_£t_ck_£ssiÚ
 (
pk_ÿÎ”
, 
pk_£ssiÚ
);

202 
	`pŞk™_£ssiÚ_uÄef
 (
pk_£ssiÚ
);

205 
out
:

206  
pk_ÿÎ”
;

207 
	}
}

250 
gboŞ—n


251 
	$acûss_check_ÿÎ”_have_acûss_to_deviû
 (
CIT¿ck”
 *
c™
,

252 
H®Deviû
 *
deviû
,

253 cÚ¡ *
aùiÚ
,

254 cÚ¡ *
ÿÎ”_unique_sysbus_Çme
,

255 *
pŞk™_»suÉ_out
)

256 #ifdeà
HAVE_CONKIT


258 
gboŞ—n
 
»t
;

259 
CIC®ËrInfo
 *
ci
;

260 #ifdeà
HAVE_POLKIT


261 
PŞK™C®Ër
 *
pk_ÿÎ”
 = 
NULL
;

262 
PŞK™AùiÚ
 *
pk_aùiÚ
 = 
NULL
;

263 
PŞK™ResuÉ
 
pk_»suÉ
;

266 
»t
 = 
FALSE
;

268 
ci
 = 
	`ci_Œack”_g‘_šfo
 (
c™
, 
ÿÎ”_unique_sysbus_Çme
);

269 ià(
ci
 =ğ
NULL
) {

270 
	`HAL_ERROR
 (("CªnÙ g‘ c®Ë¸šfØfÜ %s", 
ÿÎ”_unique_sysbus_Çme
));

271 
out
;

277 ià(
	`ci_Œack”_ÿÎ”_g‘_uid
 (
ci
) == 0 ||

278 
	`ci_Œack”_ÿÎ”_g‘_uid
 (
ci
è=ğ
	`g‘euid
 ()) {

279 
»t
 = 
TRUE
;

280 #ifdeà
HAVE_POLKIT


281 ià(
pŞk™_»suÉ_out
 !ğ
NULL
)

282 *
pŞk™_»suÉ_out
 = 
POLKIT_RESULT_YES
;

284 
out
;

290 ià(
aùiÚ
 !ğ
NULL
 &&

291 
	`¡rcmp
 (
aùiÚ
, "hal-lock") == 0 &&

292 
	`¡rcmp
 (
	`h®_deviû_g‘_udi
 (
deviû
), "/org/freedesktop/Hal/devices/computer") == 0) {

293 
»t
 = 
TRUE
;

294 #ifdeà
HAVE_POLKIT


295 ià(
pŞk™_»suÉ_out
 !ğ
NULL
)

296 *
pŞk™_»suÉ_out
 = 
POLKIT_RESULT_YES
;

298 
out
;

301 #ifdeà
HAVE_POLKIT


302 
pk_aùiÚ
 = 
	`pŞk™_aùiÚ_Ãw
 ();

303 
	`pŞk™_aùiÚ_£t_aùiÚ_id
 (
pk_aùiÚ
, 
aùiÚ
);

305 
pk_ÿÎ”
 = 
	`g‘_pk_ÿÎ”_äom_ci_Œack”
 (
c™
, 
ÿÎ”_unique_sysbus_Çme
);

306 ià(
pk_ÿÎ”
 =ğ
NULL
)

307 
out
;

309 
pk_»suÉ
 = 
	`pŞk™_cÚ‹xt_ÿn_ÿÎ”_do_aùiÚ
 (
pk_cÚ‹xt
,

310 
pk_aùiÚ
,

311 
pk_ÿÎ”
);

313 ià(
pŞk™_»suÉ_out
 !ğ
NULL
)

314 *
pŞk™_»suÉ_out
 = 
pk_»suÉ
;

316 ià(
pk_»suÉ
 !ğ
POLKIT_RESULT_YES
)

317 
out
;

320 ià(
	`ci_Œack”_ÿÎ”_g‘_ck_£ssiÚ_·th
 (
ci
è=ğ
NULL
) {

321 
out
;

325 ià(!
	`ci_Œack”_ÿÎ”_is_loÿl
 (
ci
))

326 
out
;

329 ià(!
	`ci_Œack”_ÿÎ”_š_aùive_£ssiÚ
 (
ci
))

330 
out
;

333 
»t
 = 
TRUE
;

334 
out
:

335 #ifdeà
HAVE_POLKIT


336 ià(
pk_ÿÎ”
 !ğ
NULL
)

337 
	`pŞk™_ÿÎ”_uÄef
 (
pk_ÿÎ”
);

338 ià(
pk_aùiÚ
 !ğ
NULL
)

339 
	`pŞk™_aùiÚ_uÄef
 (
pk_aùiÚ
);

341  
»t
;

342 
	}
}

345  
	gTRUE
;

378 
gboŞ—n


379 
	$acûss_check_ÿÎ”_locked_out
 (
CIT¿ck”
 *
c™
,

380 
H®Deviû
 *
deviû
,

381 cÚ¡ *
ÿÎ”_unique_sysbus_Çme
,

382 cÚ¡ *
š‹rçû_Çme
)

384 
n
;

385 
gboŞ—n
 
»t
;

386 *
glob®_lock_Çme
;

387 **
hŞd”s
;

388 **
glob®_hŞd”s
;

389 
H®Deviû
 *
compu‹r
;

390 
gboŞ—n
 
is_locked
;

391 
gboŞ—n
 
is_locked_by_£lf
;

393 
glob®_lock_Çme
 = 
NULL
;

394 
hŞd”s
 = 
NULL
;

395 
glob®_hŞd”s
 = 
NULL
;

396 
»t
 = 
TRUE
;

398 
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/org/freedesktop/Hal/devices/computer");

399 ià(
compu‹r
 =ğ
NULL
)

400 
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/org/freedesktop/Hal/devices/computer");

401 ià(
compu‹r
 =ğ
NULL
)

402 
out
;

404 
glob®_lock_Çme
 = 
	`g_¡rdup_´štf
 ("Glob®.%s", 
š‹rçû_Çme
);

406 
hŞd”s
 = 
	`h®_deviû_g‘_lock_hŞd”s
 (
deviû
, 
š‹rçû_Çme
);

407 
glob®_hŞd”s
 = 
	`h®_deviû_g‘_lock_hŞd”s
 (
compu‹r
, 
glob®_lock_Çme
);

413 
is_locked
 = 
FALSE
;

414 
is_locked_by_£lf
 = 
FALSE
;

415 ià(
hŞd”s
 !ğ
NULL
) {

416 
n
 = 0; 
hŞd”s
[n] !ğ
NULL
;‚++) {

417 
is_locked
 = 
TRUE
;

418 ià(
	`¡rcmp
 (
hŞd”s
[
n
], 
ÿÎ”_unique_sysbus_Çme
) == 0) {

419 
is_locked_by_£lf
 = 
TRUE
;

421 
»t
 = 
FALSE
;

422 
out
;

427 ià(
glob®_hŞd”s
 !ğ
NULL
) {

428 
n
 = 0; 
glob®_hŞd”s
[n] !ğ
NULL
;‚++) {

429 ià(
	`¡rcmp
 (
glob®_hŞd”s
[
n
], 
ÿÎ”_unique_sysbus_Çme
) == 0) {

431 ià(
	`acûss_check_ÿÎ”_have_acûss_to_deviû
 (

432 
c™
, 
deviû
, "h®-lock", 
glob®_hŞd”s
[
n
], 
NULL
)) {

434 
is_locked_by_£lf
 = 
TRUE
;

436 
»t
 = 
FALSE
;

437 
out
;

443 ià(
	`acûss_check_ÿÎ”_have_acûss_to_deviû
 (

444 
c™
, 
deviû
, "h®-lock", 
glob®_hŞd”s
[
n
], 
NULL
)) {

446 
is_locked
 = 
TRUE
;

452 ià(
is_locked
 && !
is_locked_by_£lf
) {

454 
	`HAL_INFO
 (("Caller '%s' is†ocked out of interface '%s' on device '%s' "

456 
ÿÎ”_unique_sysbus_Çme
,

457 
š‹rçû_Çme
,

458 
	`h®_deviû_g‘_udi
 (
deviû
)));

459 
out
;

463 
»t
 = 
FALSE
;

465 
out
:

466 
	`g_¡rä“v
 (
glob®_hŞd”s
);

467 
	`g_¡rä“v
 (
hŞd”s
);

468 
	`g_ä“
 (
glob®_lock_Çme
);

469  
»t
;

470 
	}
}

486 
gboŞ—n


487 
	$acûss_check_locked_by_Ùh”s
 (
CIT¿ck”
 *
c™
,

488 
H®Deviû
 *
deviû
,

489 cÚ¡ *
ÿÎ”_unique_sysbus_Çme
,

490 cÚ¡ *
š‹rçû_Çme
)

492 
n
;

493 
gboŞ—n
 
»t
;

494 *
glob®_lock_Çme
;

495 **
hŞd”s
;

496 **
glob®_hŞd”s
;

497 
H®Deviû
 *
compu‹r
;

499 
glob®_lock_Çme
 = 
NULL
;

500 
hŞd”s
 = 
NULL
;

501 
glob®_hŞd”s
 = 
NULL
;

502 
»t
 = 
TRUE
;

504 
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/org/freedesktop/Hal/devices/computer");

505 ià(
compu‹r
 =ğ
NULL
)

506 
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/org/freedesktop/Hal/devices/computer");

507 ià(
compu‹r
 =ğ
NULL
)

508 
out
;

510 
glob®_lock_Çme
 = 
	`g_¡rdup_´štf
 ("Glob®.%s", 
š‹rçû_Çme
);

512 
hŞd”s
 = 
	`h®_deviû_g‘_lock_hŞd”s
 (
deviû
, 
š‹rçû_Çme
);

513 
glob®_hŞd”s
 = 
	`h®_deviû_g‘_lock_hŞd”s
 (
compu‹r
, 
glob®_lock_Çme
);

515 ià(
hŞd”s
 !ğ
NULL
) {

516 
n
 = 0; 
hŞd”s
[n] !ğ
NULL
;‚++) {

517 ià(
ÿÎ”_unique_sysbus_Çme
 =ğ
NULL
 ||

518 
	`¡rcmp
 (
hŞd”s
[
n
], 
ÿÎ”_unique_sysbus_Çme
) != 0) {

520 
out
;

525 ià(
glob®_hŞd”s
 !ğ
NULL
) {

526 
n
 = 0; 
glob®_hŞd”s
[n] !ğ
NULL
;‚++) {

527 ià(
ÿÎ”_unique_sysbus_Çme
 =ğ
NULL
 ||

528 
	`¡rcmp
 (
glob®_hŞd”s
[
n
], 
ÿÎ”_unique_sysbus_Çme
) != 0) {

530 ià(
	`acûss_check_ÿÎ”_have_acûss_to_deviû
 (

531 
c™
, 
deviû
, "h®-lock", 
glob®_hŞd”s
[
n
], 
NULL
)) {

533 
out
;

540 
»t
 = 
FALSE
;

542 
out
:

543 
	`g_¡rä“v
 (
glob®_hŞd”s
);

544 
	`g_¡rä“v
 (
hŞd”s
);

545 
	`g_ä“
 (
glob®_lock_Çme
);

546  
»t
;

547 
	}
}

	@hald/access-check.h

26 #iâdeà
ACCESS_CHECK_H


27 
	#ACCESS_CHECK_H


	)

29 
	~"deviû.h
"

30 
	~"ci-Œack”.h
"

32 
gboŞ—n
 
acûss_check_ÿÎ”_is_roÙ_Ü_h®
 (
CIT¿ck”
 *
c™
,

33 cÚ¡ *
ÿÎ”_unique_sysbus_Çme
);

34 
gboŞ—n
 
acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
CIT¿ck”
 *
c™
,

35 
DBusMes§ge
 *
mes§ge
);

36 
gboŞ—n
 
acûss_check_ÿÎ”_have_acûss_to_deviû
 (
CIT¿ck”
 *
c™
,

37 
H®Deviû
 *
deviû
,

38 cÚ¡ *
aùiÚ
,

39 cÚ¡ *
ÿÎ”_unique_sysbus_Çme
,

40 *
pŞk™_»suÉ_out
);

41 
gboŞ—n
 
acûss_check_ÿÎ”_locked_out
 (
CIT¿ck”
 *
c™
,

42 
H®Deviû
 *
deviû
,

43 cÚ¡ *
ÿÎ”_unique_sysbus_Çme
,

44 cÚ¡ *
š‹rçû_Çme
);

45 
gboŞ—n
 
acûss_check_locked_by_Ùh”s
 (
CIT¿ck”
 *
c™
,

46 
H®Deviû
 *
deviû
,

47 cÚ¡ *
ÿÎ”_unique_sysbus_Çme
,

48 cÚ¡ *
š‹rçû_Çme
);

	@hald/cache_test.c

30 
	~<sys/ty³s.h
>

31 
	~<sys/¡©.h
>

32 
	~<sys/mmª.h
>

33 
	~<fú.h
>

34 
	~<uni¡d.h
>

35 
	~<¡ršg.h
>

36 
	~<¡dio.h
>

37 
	~<¡dlib.h
>

38 
	~<dœ’t.h
>

39 
	~<”ºo.h
>

40 
	~<ex·t.h
>

41 
	~<glib.h
>

42 
	~<cÚfig.h
>

44 
	~"logg”.h
"

45 
	~"ruË.h
"

46 
	~"mm­_ÿche.h
"

48 *
	gruËs_±r
 = 
NULL
;

50 
	$‹¡_ÿche
(
u_št32_t
 
off£t
, 
size_t
 
size
)

52 
u_št32_t
 
m
 = 
off£t
;

53 
ruË
 *
r
;

55 
m
 < (
off£t
 + 
size
)){

56 
r
 = (
ruË
 *è
	`RULES_PTR
(
m
);

58 
	`HAL_INFO
(("ruË=%08lx,„uË_size=%d,„ty³=%d", 
m
, 
r
->
ruË_size
,„->
¹y³
));

59 
	`HAL_INFO
((" jump_pos™iÚ=%08lx", 
r
->
jump_pos™iÚ
));

60 
	`HAL_INFO
((" key='%s', key_len=%d, key_offset=%08lx",

61 
r
->
key
,„->
key_Ën
, 
m
 + 
	`off£tof
(
ruË
, key)));

62 
	`HAL_INFO
((" value='%s', value_len=%d, value_offset=%08lx",

63 (*)
ruËs_±r
 + 
r
->
v®ue_off£t
,„->
v®ue_Ën
,„->value_offset));

65 
m
 +ğ
r
->
ruË_size
;

67 
	}
}

70 
	$di_ruËs_š™
 ()

72 
ÿche_h—d”
 *
h—d”
;

73 *
ÿch’ame
;

74 
fd
;

75 
¡©
 
¡©buf
;

77 
ÿch’ame
 = 
	`g‘’v
 ("HAL_FDI_CACHE_NAME");

78 if(
ÿch’ame
 =ğ
NULL
)

79 
ÿch’ame
 = 
HALD_CACHE_FILE
;

81 if((
fd
 = 
	`İ’
(
ÿch’ame
, 
O_RDONLY
)) < 0)

82 
	`DIE
(("UÇbËØİ’ cach%s\n", 
ÿch’ame
));

84 if(
	`f¡©
(
fd
,&
¡©buf
) < 0)

85 
	`DIE
(("UÇbËØ¡© cach%s\n", 
ÿch’ame
));

87 
ruËs_±r
 = 
	`mm­
 (
NULL
, 
¡©buf
.
¡_size
, 
PROT_READ
, 
MAP_SHARED
, 
fd
, 0);

88 if(
ruËs_±r
 =ğ
MAP_FAILED
)

89 
	`DIE
 (("Couldn'ˆmm­ f'%s',ƒ¼no=%d: %s", 
ÿch’ame
, 
”ºo
, 
	`¡»¼Ü
 (errno)));

91 
h—d”
 = (
ÿche_h—d”
*è
ruËs_±r
;

92 
	`HAL_INFO
(("´•robe: off£t=%08lx, size=%d", 
h—d”
->
fdi_ruËs_´•robe
,

93 
h—d”
->
fdi_ruËs_šfÜm©iÚ
 - h—d”->
fdi_ruËs_´•robe
));

94 
	`HAL_INFO
(("šfÜm©iÚ: off£t=%08lx, size=%d", 
h—d”
->
fdi_ruËs_šfÜm©iÚ
,

95 
h—d”
->
fdi_ruËs_pŞicy
 - h—d”->
fdi_ruËs_šfÜm©iÚ
));

96 
	`HAL_INFO
(("pŞicy: off£t=%08lx, size=%d", 
h—d”
->
fdi_ruËs_pŞicy
,

97 
h—d”
->
®l_ruËs_size
 - h—d”->
fdi_ruËs_pŞicy
));

99 
	`şo£
(
fd
);

102 
	}
}

105 
	$maš
(
¬gc
, * 
¬gv
[])

107 
ÿche_h—d”
 *
h—d”
;

109 
	`di_ruËs_š™
();

110 
h—d”
 = (
ÿche_h—d”
*è
	`RULES_PTR
(0);

112 
	`‹¡_ÿche
(
h—d”
->
fdi_ruËs_´•robe
, h—d”->
fdi_ruËs_šfÜm©iÚ
 - header->fdi_rules_preprobe);

113 
	`‹¡_ÿche
(
h—d”
->
fdi_ruËs_šfÜm©iÚ
, h—d”->
fdi_ruËs_pŞicy
 - header->fdi_rules_information);

114 
	`‹¡_ÿche
(
h—d”
->
fdi_ruËs_pŞicy
, h—d”->
®l_ruËs_size
 - header->fdi_rules_policy);

116 
	}
}

	@hald/ci-tracker.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<¡dlib.h
>

31 
	~<¡dio.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<¡d¬g.h
>

35 
	~<¡dšt.h
>

36 
	~<sys/time.h
>

38 
	~<dbus/dbus.h
>

39 
	~<glib.h
>

41 
	~"logg”.h
"

42 
	~"ci-Œack”.h
"

50 
	#VALID_INITIAL_BUS_NAME_CHARACTER
(
c
) \

51 Ğ((
c
) >= 'A' && (c) <= 'Z') || \

52 ((
c
) >= 'a' && (c) <= 'z') || \

53 ((
c
è=ğ'_'è|| ((cè=ğ'-'))

	)

60 
	#VALID_BUS_NAME_CHARACTER
(
c
) \

61 Ğ((
c
) >= '0' && (c) <= '9') || \

62 ((
c
) >= 'A' && (c) <= 'Z') || \

63 ((
c
) >= 'a' && (c) <= 'z') || \

64 ((
c
è=ğ'_'è|| ((cè=ğ'-'))

	)

66 
gboŞ—n


67 
	$v®id©e_bus_Çme
 (cÚ¡ *
Çme
)

69 
Ën
;

70 cÚ¡ *
s
;

71 cÚ¡ *
’d
;

72 cÚ¡ *
Ï¡_dÙ
;

73 
gboŞ—n
 
»t
;

75 
s
 = 
Çme
;

76 
Ën
 = 
	`¡¾’
 (
Çme
);

77 
’d
 = 
Çme
 + 
Ën
;

78 
Ï¡_dÙ
 = 
NULL
;

80 
»t
 = 
FALSE
;

85 ià(*
s
 == ':') {

87 ++
s
;

88 
s
 !ğ
’d
) {

89 ià(*
s
 == '.') {

90 ià(
	`G_UNLIKELY
 ((
s
 + 1è=ğ
’d
))

91 
”rÜ
;

92 ià(
	`G_UNLIKELY
 (!
	`VALID_BUS_NAME_CHARACTER
 (*(
s
 + 1))))

93 
”rÜ
;

94 ++
s
;

95 } ià(
	`G_UNLIKELY
 (!
	`VALID_BUS_NAME_CHARACTER
 (*
s
))) {

96 
”rÜ
;

98 ++
s
;

100  
TRUE
;

101 } ià(
	`G_UNLIKELY
 (*
s
 == '.')) {

102 
”rÜ
;

103 } ià(
	`G_UNLIKELY
 (!
	`VALID_INITIAL_BUS_NAME_CHARACTER
 (*
s
))) {

104 
”rÜ
;

106 ++
s
;

109 
s
 !ğ
’d
) {

110 ià(*
s
 == '.') {

111 ià(
	`G_UNLIKELY
 ((
s
 + 1è=ğ
’d
))

112 
”rÜ
;

113 ià(
	`G_UNLIKELY
 (!
	`VALID_INITIAL_BUS_NAME_CHARACTER
 (*(
s
 + 1))))

114 
”rÜ
;

115 
Ï¡_dÙ
 = 
s
;

116 ++
s
;

117 } ià(
	`G_UNLIKELY
 (!
	`VALID_BUS_NAME_CHARACTER
 (*
s
))) {

118 
”rÜ
;

120 ++
s
;

123 ià(
	`G_UNLIKELY
 (
Ï¡_dÙ
 =ğ
NULL
))

124 
”rÜ
;

126 
»t
 = 
TRUE
;

128 
”rÜ
:

129 ià(!
»t
)

130 
	`HAL_INFO
 (("Çm'%s' did‚Ù v®id©e", 
Çme
));

131  
»t
;

132 
	}
}

135 
	sCIT¿ck”_s
 {

136 
GHashTabË
 *
	mcÚÃùiÚ_Çme_to_ÿÎ”_šfo
;

137 
DBusCÚÃùiÚ
 *
	mdbus_cÚÃùiÚ
;

141 
	sCIC®ËrInfo_s
 {

142 
	muid
;

143 #ifdeà
HAVE_CONKIT


144 
pid_t
 
	mpid
;

145 
gboŞ—n
 
	mš_aùive_£ssiÚ
;

146 
gboŞ—n
 
	mis_loÿl
;

147 *
	m£ssiÚ_obj·th
;

148 *
	m£lšux_cÚ‹xt
;

150 *
	msy¡em_bus_unique_Çme
;

153 
CIC®ËrInfo
 *

154 
	$ÿÎ”_šfo_Ãw
 ()

156 
CIC®ËrInfo
 *
ci
;

157 
ci
 = 
	`g_Ãw0
 (
CIC®ËrInfo
, 1);

158  
ci
;

159 
	}
}

162 
	$ÿÎ”_šfo_ä“
 (
CIC®ËrInfo
 *
ci
)

164 #ifdeà
HAVE_CONKIT


165 
	`g_ä“
 (
ci
->
£ssiÚ_obj·th
);

166 
	`g_ä“
 (
ci
->
£lšux_cÚ‹xt
);

168 
	`g_ä“
 (
ci
->
sy¡em_bus_unique_Çme
);

169 
	`g_ä“
 (
ci
);

170 
	}
}

173 
CIT¿ck”
 *

174 
	$ci_Œack”_Ãw
 ()

176 
CIT¿ck”
 *
c™
;

178 
c™
 = 
	`g_Ãw0
 (
CIT¿ck”
, 1);

179  
c™
;

180 
	}
}

183 
	$ci_Œack”_£t_sy¡em_bus_cÚÃùiÚ
 (
CIT¿ck”
 *
c™
, 
DBusCÚÃùiÚ
 *
sy¡em_bus_cÚÃùiÚ
)

185 
c™
->
dbus_cÚÃùiÚ
 = 
sy¡em_bus_cÚÃùiÚ
;

186 
	}
}

190 
	$ci_Œack”_š™
 (
CIT¿ck”
 *
c™
)

192 
c™
->
cÚÃùiÚ_Çme_to_ÿÎ”_šfo
 = 
	`g_hash_bË_Ãw_fuÎ
 (
g_¡r_hash
,

193 
g_¡r_equ®
,

194 
NULL
,

195 (
GF»eFunc
è
ÿÎ”_šfo_ä“
);

196 
	}
}

199 
	$ci_Œack”_Çme_owÃr_chªged
 (
CIT¿ck”
 *
c™
,

200 cÚ¡ *
Çme
,

201 cÚ¡ *
Şd_£rviû_Çme
,

202 cÚ¡ *
Ãw_£rviû_Çme
)

204 ià(
	`¡¾’
 (
Şd_£rviû_Çme
) > 0) {

205 
CIC®ËrInfo
 *
ÿÎ”_šfo
;

208 
ÿÎ”_šfo
 = (
CIC®ËrInfo
 *è
	`g_hash_bË_lookup
 (
c™
->
cÚÃùiÚ_Çme_to_ÿÎ”_šfo
,

209 
Şd_£rviû_Çme
);

210 ià(
ÿÎ”_šfo
 !ğ
NULL
) {

211 
	`g_hash_bË_»move
 (
c™
->
cÚÃùiÚ_Çme_to_ÿÎ”_šfo
, 
Şd_£rviû_Çme
);

212 
	`HAL_INFO
 (("Removšg CIC®ËrInfØobjeù fÜ %s", 
Şd_£rviû_Çme
));

215 
	}
}

218 #ifdeà
HAVE_CONKIT


221 
	$ci_Œack”_£t_aùive
 (
gpoš‹r
 
key
, gpoš‹¸
v®ue
, gpoš‹¸
u£r_d©a
)

223 
CIC®ËrInfo
 *
ci
 = (CIC®ËrInfo*è
v®ue
;

224 *
£ssiÚ_obj·th
 = (*è
u£r_d©a
;

226 ià(
ci
->
£ssiÚ_obj·th
 !ğ
NULL
 && 
	`¡rcmp
 (ci->session_objpath, session_objpath) == 0) {

227 
ci
->
š_aùive_£ssiÚ
 = 
TRUE
;

228 
	`HAL_INFO
 (("Set in_active_session=TRUE in CICallerInfo for %s @ %s (uid %d,…id %d)",

229 
ci
->
sy¡em_bus_unique_Çme
, ci->
£ssiÚ_obj·th
, ci->
uid
, ci->
pid
));

231 
	}
}

234 
	$ci_Œack”_ş—r_aùive
 (
gpoš‹r
 
key
, gpoš‹¸
v®ue
, gpoš‹¸
u£r_d©a
)

236 
CIC®ËrInfo
 *
ci
 = (CIC®ËrInfo*è
v®ue
;

237 *
£ssiÚ_obj·th
 = (*è
u£r_d©a
;

239 ià(
ci
->
£ssiÚ_obj·th
 !ğ
NULL
 && 
	`¡rcmp
 (ci->session_objpath, session_objpath) == 0) {

240 
ci
->
š_aùive_£ssiÚ
 = 
FALSE
;

241 
	`HAL_INFO
 (("Set in_active_session=FALSE in CICallerInfo for %s @ %s (uid %d,…id %d)",

242 
ci
->
sy¡em_bus_unique_Çme
, ci->
£ssiÚ_obj·th
, ci->
uid
, ci->
pid
));

244 
	}
}

247 
	$ci_Œack”_aùive_chªged
 (
CIT¿ck”
 *
c™
, cÚ¡ *
£ssiÚ_obj·th
, 
gboŞ—n
 
is_aùive
)

249 ià(
is_aùive
) {

250 
	`g_hash_bË_fÜ—ch
 (
c™
->
cÚÃùiÚ_Çme_to_ÿÎ”_šfo
,

251 
ci_Œack”_£t_aùive
, (
gpoš‹r
è
£ssiÚ_obj·th
);

253 
	`g_hash_bË_fÜ—ch
 (
c™
->
cÚÃùiÚ_Çme_to_ÿÎ”_šfo
,

254 
ci_Œack”_ş—r_aùive
, (
gpoš‹r
è
£ssiÚ_obj·th
);

256 
	}
}

259 
CIC®ËrInfo
 *

260 
	$ci_Œack”_g‘_šfo
 (
CIT¿ck”
 *
c™
, cÚ¡ *
sy¡em_bus_unique_Çme
)

262 
CIC®ËrInfo
 *
ci
;

263 
DBusE¼Ü
 
”rÜ
;

264 #ifdeà
HAVE_CONKIT


265 
DBusMes§ge
 *
mes§ge
;

266 
DBusMes§ge
 *
»¶y
;

267 
DBusMes§geI‹r
 
™”
;

268 
DBusMes§geI‹r
 
sub_™”
;

269 *
dbus_£ssiÚ_Çme
;

270 *
¡r
;

271 
num_–ems
;

274 
ci
 = 
NULL
;

276 ià(
sy¡em_bus_unique_Çme
 =ğ
NULL
)

277 
”rÜ
;

279 ià(!
	`v®id©e_bus_Çme
 (
sy¡em_bus_unique_Çme
))

280 
”rÜ
;

285 
ci
 = 
	`g_hash_bË_lookup
 (
c™
->
cÚÃùiÚ_Çme_to_ÿÎ”_šfo
,

286 
sy¡em_bus_unique_Çme
);

287 ià(
ci
 !ğ
NULL
) {

289 
gÙ_ÿÎ”_šfo
;

293 
ci
 = 
	`ÿÎ”_šfo_Ãw
 ();

294 
ci
->
sy¡em_bus_unique_Çme
 = 
	`g_¡rdup
 (system_bus_unique_name);

296 
	`dbus_”rÜ_š™
 (&
”rÜ
);

297 
ci
->
uid
 = 
	`dbus_bus_g‘_unix_u£r
 (
c™
->
dbus_cÚÃùiÚ
, 
sy¡em_bus_unique_Çme
, &
”rÜ
);

298 ià(
ci
->
uid
 =ğ((è-1è|| 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

299 
	`HAL_WARNING
 (("Could‚Ù g‘ uid fÜ cÚÃùiÚ: % %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

300 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

301 
”rÜ
;

304 #ifdeà
HAVE_CONKIT


305 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.DBus",

309 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

310 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
sy¡em_bus_unique_Çme
);

311 
	`dbus_”rÜ_š™
 (&
”rÜ
);

312 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
c™
->
dbus_cÚÃùiÚ
, 
mes§ge
, -1, &
”rÜ
);

313 ià(
»¶y
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

314 
	`HAL_WARNING
 (("E¼Ü došg G‘CÚÃùiÚUnixProûssID oÀBus: %s: %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

315 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

316 ià(
»¶y
 !ğ
NULL
)

317 
	`dbus_mes§ge_uÄef
 (
»¶y
);

318 
”rÜ
;

320 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
™”
);

321 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
ci
->
pid
);

322 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

323 
	`dbus_mes§ge_uÄef
 (
»¶y
);

325 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.DBus",

329 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

330 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
sy¡em_bus_unique_Çme
);

331 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
c™
->
dbus_cÚÃùiÚ
, 
mes§ge
, -1, &
”rÜ
);

333 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
) &&

334 
	`¡rcmp
 (
”rÜ
.
Çme
, "org.freedesktop.DBus.Error.SELinuxSecurityContextUnknown") == 0) {

335 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

336 ià(
»¶y
 !ğ
NULL
)

337 
	`dbus_mes§ge_uÄef
 (
»¶y
);

338 
	`dbus_”rÜ_š™
 (&
”rÜ
);

339 } ià(
»¶y
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

340 
	`g_w¬nšg
 ("E¼Ü došg G‘CÚÃùiÚSELšuxSecur™yCÚ‹xˆÚ Bus: %s: %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

341 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

342 ià(
»¶y
 !ğ
NULL
)

343 
	`dbus_mes§ge_uÄef
 (
»¶y
);

344 
”rÜ
;

347 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
™”
);

348 
	`dbus_mes§ge_™”_»cur£
 (&
™”
, &
sub_™”
);

349 
	`dbus_mes§ge_™”_g‘_fixed_¬¿y
 (&
sub_™”
, (*è&
¡r
, &
num_–ems
);

350 ià(
¡r
 !ğ
NULL
 && 
num_–ems
 > 0)

351 
ci
->
£lšux_cÚ‹xt
 = 
	`g_¡ºdup
 (
¡r
, 
num_–ems
);

352 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

353 
	`dbus_mes§ge_uÄef
 (
»¶y
);

357 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.ConsoleKit",

361 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

362 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_UINT32
, &
ci
->
pid
);

363 
	`dbus_”rÜ_š™
 (&
”rÜ
);

364 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
c™
->
dbus_cÚÃùiÚ
, 
mes§ge
, -1, &
”rÜ
);

365 ià(
»¶y
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

366 
	`HAL_WARNING
 (("E¼Ü došg G‘SessiÚFÜUnixProûs Ú CÚsŞeK™: %s: %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

367 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

368 ià(
»¶y
 !ğ
NULL
)

369 
	`dbus_mes§ge_uÄef
 (
»¶y
);

371 
¡Üe_ÿÎ”_šfo
;

373 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
™”
);

374 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
dbus_£ssiÚ_Çme
);

375 
ci
->
£ssiÚ_obj·th
 = 
	`g_¡rdup
 (
dbus_£ssiÚ_Çme
);

376 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

377 
	`dbus_mes§ge_uÄef
 (
»¶y
);

379 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.ConsoleKit",

380 
ci
->
£ssiÚ_obj·th
,

383 
	`dbus_”rÜ_š™
 (&
”rÜ
);

384 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
c™
->
dbus_cÚÃùiÚ
, 
mes§ge
, -1, &
”rÜ
);

385 ià(
»¶y
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

386 
	`HAL_WARNING
 (("E¼Ü došg IsAùivÚ CÚsŞeK™: %s: %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

387 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

388 ià(
»¶y
 !ğ
NULL
)

389 
	`dbus_mes§ge_uÄef
 (
»¶y
);

390 
”rÜ
;

392 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
™”
);

393 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
ci
->
š_aùive_£ssiÚ
);

394 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

395 
	`dbus_mes§ge_uÄef
 (
»¶y
);

398 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.ConsoleKit",

399 
ci
->
£ssiÚ_obj·th
,

402 
	`dbus_”rÜ_š™
 (&
”rÜ
);

403 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
c™
->
dbus_cÚÃùiÚ
, 
mes§ge
, -1, &
”rÜ
);

404 ià(
»¶y
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

405 
	`HAL_WARNING
 (("E¼Ü došg IsLoÿÈÚ CÚsŞeK™: %s: %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

406 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

407 ià(
»¶y
 !ğ
NULL
)

408 
	`dbus_mes§ge_uÄef
 (
»¶y
);

409 
”rÜ
;

411 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
™”
);

412 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
ci
->
is_loÿl
);

413 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

414 
	`dbus_mes§ge_uÄef
 (
»¶y
);

416 
¡Üe_ÿÎ”_šfo
:

419 
	`g_hash_bË_š£¹
 (
c™
->
cÚÃùiÚ_Çme_to_ÿÎ”_šfo
,

420 
ci
->
sy¡em_bus_unique_Çme
,

421 
ci
);

423 
gÙ_ÿÎ”_šfo
:

436  
ci
;

438 
”rÜ
:

440 ià(
ci
 !ğ
NULL
)

441 
	`ÿÎ”_šfo_ä“
 (
ci
);

442  
NULL
;

443 
	}
}

445 
uid_t


446 
	$ci_Œack”_ÿÎ”_g‘_uid
 (
CIC®ËrInfo
 *
ci
)

448  
ci
->
uid
;

449 
	}
}

452 
	$ci_Œack”_ÿÎ”_g‘_sysbus_unique_Çme
 (
CIC®ËrInfo
 *
ci
)

454  
ci
->
sy¡em_bus_unique_Çme
;

455 
	}
}

457 #ifdeà
HAVE_CONKIT


458 
pid_t


459 
	$ci_Œack”_ÿÎ”_g‘_pid
 (
CIC®ËrInfo
 *
ci
)

461  
ci
->
pid
;

462 
	}
}

464 
gboŞ—n


465 
	$ci_Œack”_ÿÎ”_is_loÿl
 (
CIC®ËrInfo
 *
ci
)

467  
ci
->
is_loÿl
;

468 
	}
}

470 
gboŞ—n


471 
	$ci_Œack”_ÿÎ”_š_aùive_£ssiÚ
 (
CIC®ËrInfo
 *
ci
)

473  
ci
->
š_aùive_£ssiÚ
;

474 
	}
}

477 
	$ci_Œack”_ÿÎ”_g‘_ck_£ssiÚ_·th
 (
CIC®ËrInfo
 *
ci
)

479  
ci
->
£ssiÚ_obj·th
;

480 
	}
}

483 
	$ci_Œack”_ÿÎ”_g‘_£lšux_cÚ‹xt
 (
CIC®ËrInfo
 *
ci
)

485  
ci
->
£lšux_cÚ‹xt
;

486 
	}
}

	@hald/ci-tracker.h

26 #iâdeà
CALLER_INFO_H


27 
	#CALLER_INFO_H


	)

29 
	~<uni¡d.h
>

30 
	~<sys/ty³s.h
>

31 
	~<dbus/dbus.h
>

32 
	~<glib.h
>

34 #ifdeà
HAVE_CONKIT


35 
	~"ck-Œack”.h
"

38 
	gCIT¿ck”_s
;

39 
CIT¿ck”_s
 
	tCIT¿ck”
;

41 
	gCIC®ËrInfo_s
;

42 
CIC®ËrInfo_s
 
	tCIC®ËrInfo
;

44 
CIT¿ck”
 *
ci_Œack”_Ãw
 ();

45 
ci_Œack”_£t_sy¡em_bus_cÚÃùiÚ
 (
CIT¿ck”
 *
c™
,

46 
DBusCÚÃùiÚ
 *
sy¡em_bus_cÚÃùiÚ
);

47 
ci_Œack”_š™
 (
CIT¿ck”
 *
c™
);

48 
ci_Œack”_Çme_owÃr_chªged
 (
CIT¿ck”
 *
c™
,

49 cÚ¡ *
Çme
,

50 cÚ¡ *
Şd_£rviû_Çme
,

51 cÚ¡ *
Ãw_£rviû_Çme
);

53 #ifdeà
HAVE_CONKIT


54 
ci_Œack”_aùive_chªged
 (
CIT¿ck”
 *
c™
,

55 cÚ¡ *
£ssiÚ_obj·th
,

56 
gboŞ—n
 
is_aùive
);

59 
CIC®ËrInfo
 *
ci_Œack”_g‘_šfo
 (
CIT¿ck”
 *
c™
,

60 cÚ¡ *
sy¡em_bus_unique_Çme
);

62 
uid_t
 
ci_Œack”_ÿÎ”_g‘_uid
 (
CIC®ËrInfo
 *
ci
);

63 cÚ¡ *
ci_Œack”_ÿÎ”_g‘_sysbus_unique_Çme
 (
CIC®ËrInfo
 *
ci
);

64 #ifdeà
HAVE_CONKIT


65 
pid_t
 
ci_Œack”_ÿÎ”_g‘_pid
 (
CIC®ËrInfo
 *
ci
);

66 
gboŞ—n
 
ci_Œack”_ÿÎ”_is_loÿl
 (
CIC®ËrInfo
 *
ci
);

67 
gboŞ—n
 
ci_Œack”_ÿÎ”_š_aùive_£ssiÚ
 (
CIC®ËrInfo
 *
ci
);

68 cÚ¡ *
ci_Œack”_ÿÎ”_g‘_ck_£ssiÚ_·th
 (
CIC®ËrInfo
 *
ci
);

69 cÚ¡ *
ci_Œack”_ÿÎ”_g‘_£lšux_cÚ‹xt
 (
CIC®ËrInfo
 *
ci
);

	@hald/ck-tracker.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<¡dlib.h
>

31 
	~<¡dio.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<¡d¬g.h
>

35 
	~<¡dšt.h
>

36 
	~<sys/time.h
>

38 
	~<dbus/dbus.h
>

39 
	~<glib.h
>

41 
	~"logg”.h
"

42 
	~"ck-Œack”.h
"

44 
	sCKS—t_s
 {

45 
	m»fcouÁ
;

46 *
	m£©_obj·th
;

47 
GSLi¡
 *
	m£ssiÚs
;

50 
	sCKSessiÚ_s
 {

51 
	m»fcouÁ
;

52 *
	m£ssiÚ_obj·th
;

53 
CKS—t
 *
	m£©
;

54 
gboŞ—n
 
	mis_aùive
;

55 
uid_t
 
	mu£r
;

56 
gboŞ—n
 
	mis_loÿl
;

57 *
	mho¡Çme
;

60 
	sCKT¿ck”_s
 {

61 
	m»fcouÁ
;

62 
DBusCÚÃùiÚ
 *
	mdbus_cÚÃùiÚ
;

63 *
	mu£r_d©a
;

64 
CKS—tAddedCB
 
	m£©_added_cb
;

65 
CKS—tRemovedCB
 
	m£©_»moved_cb
;

66 
CKSessiÚAddedCB
 
	m£ssiÚ_added_cb
;

67 
CKSessiÚRemovedCB
 
	m£ssiÚ_»moved_cb
;

68 
CKSessiÚAùiveChªgedCB
 
	m£ssiÚ_aùive_chªged_cb
;

69 
CKS”viûDi§µ—»dCB
 
	m£rviû_di§µ—»d_cb
;

70 
CKS”viûAµ—»dCB
 
	m£rviû_­³¬ed_cb
;

71 
GSLi¡
 *
	m£©s
;

72 
GSLi¡
 *
	m£ssiÚs
;

75 
CKSessiÚ
 *

76 
	$ck_£ssiÚ_Ãw
 (cÚ¡ *
£ssiÚ_obj·th
)

78 
CKSessiÚ
 *
£ssiÚ
;

79 
£ssiÚ
 = 
	`g_Ãw0
 (
CKSessiÚ
, 1);

80 
£ssiÚ
->
»fcouÁ
 = 1;

81 
£ssiÚ
->
£ssiÚ_obj·th
 = 
	`g_¡rdup
 (session_objpath);

82 
£ssiÚ
->
£©
 = 
NULL
;

83 
£ssiÚ
->
ho¡Çme
 = 
NULL
;

84 
£ssiÚ
->
is_loÿl
 = 
FALSE
;

85  
£ssiÚ
;

86 
	}
}

89 
	$ck_£ssiÚ_uÄef
 (
CKSessiÚ
 *
£ssiÚ
)

91 
£ssiÚ
->
»fcouÁ
--;

92 ià(
£ssiÚ
->
»fcouÁ
 == 0) {

93 
	`g_ä“
 (
£ssiÚ
->
ho¡Çme
);

94 
	`g_ä“
 (
£ssiÚ
->
£ssiÚ_obj·th
);

95 
	`g_ä“
 (
£ssiÚ
);

97 
	}
}

100 
	$ck_£ssiÚ_»f
 (
CKSessiÚ
 *
£ssiÚ
)

102 
£ssiÚ
->
»fcouÁ
++;

103 
	}
}

105 
CKS—t
 *

106 
	$ck_£©_Ãw
 (cÚ¡ *
£©_obj·th
)

108 
CKS—t
 *
£©
;

109 
£©
 = 
	`g_Ãw0
 (
CKS—t
, 1);

110 
£©
->
»fcouÁ
 = 1;

111 
£©
->
£©_obj·th
 = 
	`g_¡rdup
 (seat_objpath);

112 
£©
->
£ssiÚs
 = 
NULL
;

113  
£©
;

114 
	}
}

117 
	$ck_£©_©ch_£ssiÚ
 (
CKS—t
 *
£©
, 
CKSessiÚ
 *
£ssiÚ
)

119 
	`ck_£ssiÚ_»f
 (
£ssiÚ
);

120 
£ssiÚ
->
£©
 = seat;

121 
£©
->
£ssiÚs
 = 
	`g_¦i¡_­³nd
 (£©->£ssiÚs, 
£ssiÚ
);

122 
	}
}

125 
	$ck_£©_d‘ach_£ssiÚ
 (
CKS—t
 *
£©
, 
CKSessiÚ
 *
£ssiÚ
)

127 
£©
->
£ssiÚs
 = 
	`g_¦i¡_»move
 (£©->£ssiÚs, 
£ssiÚ
);

128 
£ssiÚ
->
£©
 = 
NULL
;

129 
	`ck_£ssiÚ_uÄef
 (
£ssiÚ
);

130 
	}
}

133 
	$ck_£©_uÄef
 (
CKS—t
 *
£©
)

135 
£©
->
»fcouÁ
--;

136 ià(
£©
->
»fcouÁ
 == 0) {

137 
GSLi¡
 *
i
;

140 
i
 = 
£©
->
£ssiÚs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

141 
CKSessiÚ
 *
£ssiÚ
 = (CKSessiÚ *è
i
->
d©a
;

142 
£ssiÚ
->
£©
 = 
NULL
;

143 
	`ck_£ssiÚ_uÄef
 (
£ssiÚ
);

145 
	`g_¦i¡_ä“
 (
£©
->
£ssiÚs
);

147 
	`g_ä“
 (
£©
->
£©_obj·th
);

148 
	`g_ä“
 (
£©
);

150 
	}
}

154 
	$ck_£©_»f
 (
CKS—t
 *
£©
)

156 
£©
->
»fcouÁ
++;

157 
	}
}

160 
gboŞ—n


161 
	$ck_£©_g‘_šfo
 (
CKT¿ck”
 *
Œack”
, 
CKS—t
 *
£©
)

164  
TRUE
;

165 
	}
}

167 
gboŞ—n


168 
	$ck_£ssiÚ_g‘_šfo
 (
CKT¿ck”
 *
Œack”
, 
CKSessiÚ
 *
£ssiÚ
)

170 
gboŞ—n
 
»t
;

171 
DBusE¼Ü
 
”rÜ
;

172 
DBusMes§ge
 *
mes§ge
;

173 
DBusMes§ge
 *
»¶y
;

174 *
ho¡Çme
;

176 
»t
 = 
FALSE
;

178 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.ConsoleKit",

179 
£ssiÚ
->
£ssiÚ_obj·th
,

182 
	`dbus_”rÜ_š™
 (&
”rÜ
);

183 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
Œack”
->
dbus_cÚÃùiÚ
, 
mes§ge
, -1, &
”rÜ
);

184 ià(
»¶y
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

185 
	`HAL_ERROR
 (("E¼Ü došg SessiÚ.IsAùivÚ CÚsŞeK™: %s: %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

186 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

187 ià(
»¶y
 !ğ
NULL
)

188 
	`dbus_mes§ge_uÄef
 (
»¶y
);

189 
”rÜ
;

191 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
»¶y
, 
NULL
,

192 
DBUS_TYPE_BOOLEAN
, &(
£ssiÚ
->
is_aùive
),

193 
DBUS_TYPE_INVALID
)) {

194 
	`HAL_ERROR
 (("Invalid IsActive„eply from CK"));

195 
”rÜ
;

197 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

198 
	`dbus_mes§ge_uÄef
 (
»¶y
);

200 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.ConsoleKit",

201 
£ssiÚ
->
£ssiÚ_obj·th
,

204 
	`dbus_”rÜ_š™
 (&
”rÜ
);

205 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
Œack”
->
dbus_cÚÃùiÚ
, 
mes§ge
, -1, &
”rÜ
);

206 ià(
»¶y
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

207 
	`HAL_ERROR
 (("E¼Ü došg SessiÚ.IsLoÿÈÚ CÚsŞeK™: %s: %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

208 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

209 ià(
»¶y
 !ğ
NULL
)

210 
	`dbus_mes§ge_uÄef
 (
»¶y
);

211 
”rÜ
;

213 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
»¶y
, 
NULL
,

214 
DBUS_TYPE_BOOLEAN
, &(
£ssiÚ
->
is_loÿl
),

215 
DBUS_TYPE_INVALID
)) {

216 
	`HAL_ERROR
 (("Invalid IsLocal„eply from CK"));

217 
”rÜ
;

219 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

220 
	`dbus_mes§ge_uÄef
 (
»¶y
);

222 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.ConsoleKit",

223 
£ssiÚ
->
£ssiÚ_obj·th
,

226 
	`dbus_”rÜ_š™
 (&
”rÜ
);

227 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
Œack”
->
dbus_cÚÃùiÚ
, 
mes§ge
, -1, &
”rÜ
);

228 ià(
»¶y
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

229 
	`HAL_ERROR
 (("E¼Ü došg SessiÚ.G‘RemÙeHo¡NamÚ CÚsŞeK™: %s: %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

230 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

231 ià(
»¶y
 !ğ
NULL
)

232 
	`dbus_mes§ge_uÄef
 (
»¶y
);

233 
”rÜ
;

235 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
»¶y
, 
NULL
,

236 
DBUS_TYPE_STRING
, &
ho¡Çme
,

237 
DBUS_TYPE_INVALID
)) {

238 
	`HAL_ERROR
 (("Invalid GetRemoteHostName„eply from CK"));

239 
”rÜ
;

241 
£ssiÚ
->
ho¡Çme
 = 
	`g_¡rdup
 (hostname);

242 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

243 
	`dbus_mes§ge_uÄef
 (
»¶y
);

245 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.ConsoleKit",

246 
£ssiÚ
->
£ssiÚ_obj·th
,

249 
	`dbus_”rÜ_š™
 (&
”rÜ
);

250 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
Œack”
->
dbus_cÚÃùiÚ
, 
mes§ge
, -1, &
”rÜ
);

251 ià(
»¶y
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

252 
	`HAL_ERROR
 (("E¼Ü došg SessiÚ.G‘UnixU£¸Ú CÚsŞeK™: %s: %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

253 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

254 ià(
»¶y
 !ğ
NULL
)

255 
	`dbus_mes§ge_uÄef
 (
»¶y
);

256 
”rÜ
;

258 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
»¶y
, 
NULL
,

259 #ifdeà
HAVE_CK_0_3


260 
DBUS_TYPE_UINT32
, &(
£ssiÚ
->
u£r
),

262 
DBUS_TYPE_INT32
, &(
£ssiÚ
->
u£r
),

264 
DBUS_TYPE_INVALID
)) {

265 
	`HAL_ERROR
 (("Invalid GetUnixUser„eply from CK"));

266 
”rÜ
;

268 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

269 
	`dbus_mes§ge_uÄef
 (
»¶y
);

271 
	`HAL_INFO
 (("Got‡ctive state (%s)‡nd uid %d on session '%s'",

272 
£ssiÚ
->
is_aùive
 ? "ACTIVE" : "INACTIVE",

273 
£ssiÚ
->
u£r
,

274 
£ssiÚ
->
£ssiÚ_obj·th
));

276 
»t
 = 
TRUE
;

278 
”rÜ
:

279  
»t
;

280 
	}
}

282 
gboŞ—n


283 
	$ck_Œack”_š™_g‘_£ssiÚs_fÜ_£©
 (
CKT¿ck”
 *
Œack”
, 
CKS—t
 *
£©
)

285 
gboŞ—n
 
»t
;

286 
DBusE¼Ü
 
”rÜ
;

287 
DBusMes§ge
 *
mes§ge
;

288 
DBusMes§ge
 *
»¶y
;

289 
DBusMes§geI‹r
 
™”
;

290 
DBusMes§geI‹r
 
™”_¬¿y
;

292 
»t
 = 
FALSE
;

294 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.ConsoleKit",

295 
£©
->
£©_obj·th
,

298 
	`dbus_”rÜ_š™
 (&
”rÜ
);

299 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
Œack”
->
dbus_cÚÃùiÚ
, 
mes§ge
, -1, &
”rÜ
);

300 ià(
»¶y
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

301 
	`HAL_ERROR
 (("E¼Ü došg G‘S—t Ú CÚsŞeK™: %s: %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

302 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

303 ià(
»¶y
 !ğ
NULL
)

304 
	`dbus_mes§ge_uÄef
 (
»¶y
);

305 
”rÜ
;

308 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
™”
);

309 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”
è!ğ
DBUS_TYPE_ARRAY
) {

310 
	`HAL_WARNING
 (("Expecting‡n‡rray from GetSessions on ConsoleKit."));

311 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

312 
	`dbus_mes§ge_uÄef
 (
»¶y
);

313 
”rÜ
;

315 
	`dbus_mes§ge_™”_»cur£
 (&
™”
, &
™”_¬¿y
);

316 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”_¬¿y
è=ğ
DBUS_TYPE_OBJECT_PATH
) {

317 cÚ¡ *
£ssiÚ_obj·th
;

318 
CKSessiÚ
 *
£ssiÚ
;

320 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”_¬¿y
, &
£ssiÚ_obj·th
);

321 
	`HAL_INFO
 (("gÙ sessiÚ '%s' fÜ s—ˆ'%s'", 
£ssiÚ_obj·th
, 
£©
->
£©_obj·th
));

323 
£ssiÚ
 = 
	`ck_£ssiÚ_Ãw
 (
£ssiÚ_obj·th
);

326 ià(!
	`ck_£ssiÚ_g‘_šfo
 (
Œack”
, 
£ssiÚ
)) {

327 
	`HAL_ERROR
 (("Could‚Ù g‘ infÜm©iÚ fÜ sessiÚ '%s'", 
£ssiÚ_obj·th
));

328 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

329 
	`dbus_mes§ge_uÄef
 (
»¶y
);

330 
”rÜ
;

333 
	`ck_£©_©ch_£ssiÚ
 (
£©
, 
£ssiÚ
);

335 
Œack”
->
£ssiÚs
 = 
	`g_¦i¡_´•’d
 (Œack”->£ssiÚs, 
£ssiÚ
);

337 
	`dbus_mes§ge_™”_Ãxt
 (&
™”_¬¿y
);

339 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

340 
	`dbus_mes§ge_uÄef
 (
»¶y
);

342 
	`HAL_INFO
 (("GÙ‡Î sessiÚ Ú s—ˆ'%s'", 
£©
->
£©_obj·th
));

344 
»t
 = 
TRUE
;

346 
”rÜ
:

347  
»t
;

348 
	}
}

350 
gboŞ—n


351 
	$ck_Œack”_š™_g‘_£©s_ªd_£ssiÚs
 (
CKT¿ck”
 *
Œack”
)

353 
gboŞ—n
 
»t
;

354 
DBusE¼Ü
 
”rÜ
;

355 
DBusMes§ge
 *
mes§ge
;

356 
DBusMes§ge
 *
»¶y
;

357 
DBusMes§geI‹r
 
™”
;

358 
DBusMes§geI‹r
 
™”_¬¿y
;

360 
»t
 = 
FALSE
;

364 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.ConsoleKit",

368 
	`dbus_”rÜ_š™
 (&
”rÜ
);

369 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
Œack”
->
dbus_cÚÃùiÚ
, 
mes§ge
, -1, &
”rÜ
);

370 ià(
»¶y
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

371 
	`HAL_ERROR
 (("E¼Ü došg G‘S—t Ú CÚsŞeK™: %s: %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

372 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

373 ià(
»¶y
 !ğ
NULL
)

374 
	`dbus_mes§ge_uÄef
 (
»¶y
);

375 
”rÜ
;

378 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
™”
);

379 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”
è!ğ
DBUS_TYPE_ARRAY
) {

380 
	`HAL_WARNING
 (("Expecting‡n‡rray from GetSeats on ConsoleKit."));

381 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

382 
	`dbus_mes§ge_uÄef
 (
»¶y
);

383 
”rÜ
;

385 
	`dbus_mes§ge_™”_»cur£
 (&
™”
, &
™”_¬¿y
);

386 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”_¬¿y
è=ğ
DBUS_TYPE_OBJECT_PATH
) {

387 cÚ¡ *
£©_obj·th
;

388 
CKS—t
 *
£©
;

390 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”_¬¿y
, &
£©_obj·th
);

391 
	`HAL_INFO
 (("gÙ s—ˆ'%s'", 
£©_obj·th
));

393 
£©
 = 
	`ck_£©_Ãw
 (
£©_obj·th
);

396 ià(!
	`ck_£©_g‘_šfo
 (
Œack”
, 
£©
)) {

397 
	`HAL_ERROR
 (("Could‚Ù g‘ infÜm©iÚ fÜ s—ˆ'%s'", 
£©_obj·th
));

398 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

399 
	`dbus_mes§ge_uÄef
 (
»¶y
);

400 
”rÜ
;

404 ià(!
	`ck_Œack”_š™_g‘_£ssiÚs_fÜ_£©
 (
Œack”
, 
£©
)) {

405 
	`HAL_ERROR
 (("Could‚Ù g‘ sessiÚ fÜ s—ˆ'%s'", 
£©_obj·th
));

406 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

407 
	`dbus_mes§ge_uÄef
 (
»¶y
);

408 
”rÜ
;

411 
Œack”
->
£©s
 = 
	`g_¦i¡_´•’d
 (Œack”->£©s, 
£©
);

413 
	`dbus_mes§ge_™”_Ãxt
 (&
™”_¬¿y
);

415 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

416 
	`dbus_mes§ge_uÄef
 (
»¶y
);

418 
	`HAL_INFO
 (("Got seats"));

420 
»t
 = 
TRUE
;

421 
”rÜ
:

422  
»t
;

423 
	}
}

426 
	$ck_Œack”_»f
 (
CKT¿ck”
 *
Œack”
)

428 
Œack”
->
»fcouÁ
++;

429 
	}
}

432 
	$ck_Œack”_»move_®l_£©s_ªd_£ssiÚs
 (
CKT¿ck”
 *
Œack”
)

434 
GSLi¡
 *
i
;

436 
i
 = 
Œack”
->
£ssiÚs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

437 
CKSessiÚ
 *
£ssiÚ
 = (CKSessiÚ *è
i
->
d©a
;

438 
	`ck_£ssiÚ_uÄef
 (
£ssiÚ
);

440 
	`g_¦i¡_ä“
 (
Œack”
->
£ssiÚs
);

441 
Œack”
->
£ssiÚs
 = 
NULL
;

443 
i
 = 
Œack”
->
£©s
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

444 
CKS—t
 *
£©
 = (CKS—ˆ*è
i
->
d©a
;

445 
	`ck_£©_uÄef
 (
£©
);

447 
	`g_¦i¡_ä“
 (
Œack”
->
£©s
);

448 
Œack”
->
£©s
 = 
NULL
;

449 
	}
}

452 
	$ck_Œack”_uÄef
 (
CKT¿ck”
 *
Œack”
)

454 
Œack”
->
»fcouÁ
--;

456 ià(
Œack”
->
»fcouÁ
 == 0) {

457 
	`ck_Œack”_»move_®l_£©s_ªd_£ssiÚs
 (
Œack”
);

458 
Œack”
->
dbus_cÚÃùiÚ
 = 
NULL
;

460 
	}
}

463 
	$ck_Œack”_£t_sy¡em_bus_cÚÃùiÚ
 (
CKT¿ck”
 *
Œack”
, 
DBusCÚÃùiÚ
 *
sy¡em_bus_cÚÃùiÚ
)

465 
Œack”
->
dbus_cÚÃùiÚ
 = 
sy¡em_bus_cÚÃùiÚ
;

466 
	}
}

469 
	$ck_Œack”_£t_u£r_d©a
 (
CKT¿ck”
 *
Œack”
, *
u£r_d©a
)

471 
Œack”
->
u£r_d©a
 = user_data;

472 
	}
}

475 
	$ck_Œack”_£t_£©_added_cb
 (
CKT¿ck”
 *
Œack”
, 
CKS—tAddedCB
 
cb
)

477 
Œack”
->
£©_added_cb
 = 
cb
;

478 
	}
}

481 
	$ck_Œack”_£t_£©_»moved_cb
 (
CKT¿ck”
 *
Œack”
, 
CKS—tRemovedCB
 
cb
)

483 
Œack”
->
£©_»moved_cb
 = 
cb
;

484 
	}
}

487 
	$ck_Œack”_£t_£ssiÚ_added_cb
 (
CKT¿ck”
 *
Œack”
, 
CKSessiÚAddedCB
 
cb
)

489 
Œack”
->
£ssiÚ_added_cb
 = 
cb
;

490 
	}
}

493 
	$ck_Œack”_£t_£ssiÚ_»moved_cb
 (
CKT¿ck”
 *
Œack”
, 
CKSessiÚRemovedCB
 
cb
)

495 
Œack”
->
£ssiÚ_»moved_cb
 = 
cb
;

496 
	}
}

499 
	$ck_Œack”_£t_£ssiÚ_aùive_chªged_cb
 (
CKT¿ck”
 *
Œack”
, 
CKSessiÚAùiveChªgedCB
 
cb
)

501 
Œack”
->
£ssiÚ_aùive_chªged_cb
 = 
cb
;

502 
	}
}

505 
	$ck_Œack”_£t_£rviû_di§µ—»d_cb
 (
CKT¿ck”
 *
Œack”
, 
CKS”viûDi§µ—»dCB
 
cb
)

507 
Œack”
->
£rviû_di§µ—»d_cb
 = 
cb
;

508 
	}
}

511 
	$ck_Œack”_£t_£rviû_­³¬ed_cb
 (
CKT¿ck”
 *
Œack”
, 
CKS”viûAµ—»dCB
 
cb
)

513 
Œack”
->
£rviû_­³¬ed_cb
 = 
cb
;

514 
	}
}

517 
	$ck_Œack”_´oûss_sy¡em_bus_mes§ge
 (
CKT¿ck”
 *
Œack”
, 
DBusMes§ge
 *
mes§ge
)

519 cÚ¡ *
£©_obj·th
;

520 cÚ¡ *
£ssiÚ_obj·th
;

521 
dbus_boŞ_t
 
£ssiÚ_is_aùive
;

522 
GSLi¡
 *
i
;

523 
CKS—t
 *
£©
;

524 
CKSessiÚ
 *
£ssiÚ
;

533 ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.ConsoleKit.Manager", "SeatAdded")) {

535 
£©_obj·th
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

537 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, 
NULL
,

538 #ifdeà
HAVE_CK_0_3


539 
DBUS_TYPE_OBJECT_PATH
, &
£©_obj·th
,

541 
DBUS_TYPE_STRING
, &
£©_obj·th
,

543 
DBUS_TYPE_INVALID
)) {

544 
	`HAL_ERROR
 (("Invalid SeatAdded signal from CK"));

545 
out
;

548 
	`HAL_INFO
 (("Reûived S—tAdded '%s' from CK", 
£©_obj·th
));

550 
£©
 = 
	`ck_£©_Ãw
 (
£©_obj·th
);

553 ià(!
	`ck_£©_g‘_šfo
 (
Œack”
, 
£©
)) {

554 
	`HAL_ERROR
 (("Could‚Ù g‘ infÜm©iÚ fÜ s—ˆ'%s'", 
£©_obj·th
));

555 
out
;

558 
Œack”
->
£©s
 = 
	`g_¦i¡_´•’d
 (Œack”->£©s, 
£©
);

560 ià(
Œack”
->
£©_added_cb
 !ğ
NULL
) {

561 
Œack”
->
	`£©_added_cb
 (Œack”, 
£©
,¿ck”->
u£r_d©a
);

564 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.ConsoleKit.Manager", "SeatRemoved")) {

566 
£©_obj·th
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

568 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, 
NULL
,

569 #ifdeà
HAVE_CK_0_3


570 
DBUS_TYPE_OBJECT_PATH
, &
£©_obj·th
,

572 
DBUS_TYPE_STRING
, &
£©_obj·th
,

574 
DBUS_TYPE_INVALID
)) {

575 
	`HAL_ERROR
 (("Invalid SeatRemoved signal from CK"));

576 
out
;

579 
	`HAL_INFO
 (("Reûived S—tRemoved '%s' from CK", 
£©_obj·th
));

581 
i
 = 
Œack”
->
£©s
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

582 
£©
 = (
CKS—t
 *è
i
->
d©a
;

583 ià(
	`¡rcmp
 (
£©
->
£©_obj·th
, seat_objpath) == 0) {

585 
Œack”
->
£©s
 = 
	`g_¦i¡_»move
 (Œack”->£©s, 
£©
);

587 ià(
Œack”
->
£©_»moved_cb
 !ğ
NULL
) {

588 
Œack”
->
	`£©_»moved_cb
 (Œack”, 
£©
,¿ck”->
u£r_d©a
);

591 
	`ck_£©_uÄef
 (
£©
);

595 ià(
i
 =ğ
NULL
) {

596 
	`HAL_ERROR
 (("NØsuch s—ˆ'%s'", 
£©_obj·th
));

598 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.ConsoleKit.Seat", "SessionAdded")) {

600 
£©_obj·th
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

602 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, 
NULL
,

603 #ifdeà
HAVE_CK_0_3


604 
DBUS_TYPE_OBJECT_PATH
, &
£ssiÚ_obj·th
,

606 
DBUS_TYPE_STRING
, &
£ssiÚ_obj·th
,

608 
DBUS_TYPE_INVALID
)) {

609 
	`HAL_ERROR
 (("Invalid SessionAdded signal from CK"));

610 
out
;

613 
	`HAL_INFO
 (("Reûived SessiÚAdded '%s' from CK oÀ£© '%s'", 
£ssiÚ_obj·th
, 
£©_obj·th
));

615 
i
 = 
Œack”
->
£©s
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

616 
£©
 = (
CKS—t
 *è
i
->
d©a
;

617 ià(
	`¡rcmp
 (
£©
->
£©_obj·th
, seat_objpath) == 0) {

618 
£ssiÚ
 = 
	`ck_£ssiÚ_Ãw
 (
£ssiÚ_obj·th
);

621 ià(!
	`ck_£ssiÚ_g‘_šfo
 (
Œack”
, 
£ssiÚ
)) {

622 
	`HAL_ERROR
 (("Could‚Ù g‘ infÜm©iÚ fÜ sessiÚ '%s'", 
£ssiÚ_obj·th
));

623 
out
;

626 
	`ck_£©_©ch_£ssiÚ
 (
£©
, 
£ssiÚ
);

627 
Œack”
->
£ssiÚs
 = 
	`g_¦i¡_´•’d
 (Œack”->£ssiÚs, 
£ssiÚ
);

629 ià(
Œack”
->
£ssiÚ_added_cb
 !ğ
NULL
) {

630 
Œack”
->
	`£ssiÚ_added_cb
 (Œack”, 
£ssiÚ
,¿ck”->
u£r_d©a
);

635 ià(
i
 =ğ
NULL
) {

636 
	`HAL_ERROR
 (("NØ£© '% fÜ sessiÚ '%s'", 
£©_obj·th
, 
£ssiÚ_obj·th
));

638 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.ConsoleKit.Seat", "SessionRemoved")) {

640 
£©_obj·th
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

642 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, 
NULL
,

643 #ifdeà
HAVE_CK_0_3


644 
DBUS_TYPE_OBJECT_PATH
, &
£ssiÚ_obj·th
,

646 
DBUS_TYPE_STRING
, &
£ssiÚ_obj·th
,

648 
DBUS_TYPE_INVALID
)) {

649 
	`HAL_ERROR
 (("Invalid SessionRemoved signal from CK"));

650 
out
;

653 
	`HAL_INFO
 (("Reûived SessiÚRemoved '%s' from CK oÀ£© '%s'", 
£ssiÚ_obj·th
, 
£©_obj·th
));

655 
i
 = 
Œack”
->
£ssiÚs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

656 
£ssiÚ
 = (
CKSessiÚ
 *è
i
->
d©a
;

657 ià(
	`¡rcmp
 (
£ssiÚ
->
£ssiÚ_obj·th
, session_objpath) == 0) {

659 ià(
Œack”
->
£ssiÚ_»moved_cb
 !ğ
NULL
) {

660 
Œack”
->
	`£ssiÚ_»moved_cb
 (Œack”, 
£ssiÚ
,¿ck”->
u£r_d©a
);

663 ià(
£ssiÚ
->
£©
 =ğ
NULL
) {

664 
	`HAL_ERROR
 (("Session '%s'o be„emoved is‚ot‡ttachedo‡ seat",

665 
£ssiÚ_obj·th
));

667 
	`ck_£©_d‘ach_£ssiÚ
 (
£ssiÚ
->
£©
, session);

669 
Œack”
->
£ssiÚs
 = 
	`g_¦i¡_»move
 (Œack”->£ssiÚs, 
£ssiÚ
);

670 
	`ck_£ssiÚ_uÄef
 (
£ssiÚ
);

674 ià(
i
 =ğ
NULL
) {

675 
	`HAL_ERROR
 (("NØsuch sessiÚ '%s'", 
£ssiÚ_obj·th
));

677 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.ConsoleKit.Session", "ActiveChanged")) {

679 
£ssiÚ_obj·th
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

681 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, 
NULL
,

682 
DBUS_TYPE_BOOLEAN
, &
£ssiÚ_is_aùive
,

683 
DBUS_TYPE_INVALID
)) {

684 
	`HAL_ERROR
 (("Invalid SessionRemoved signal from CK"));

685 
out
;

688 
	`HAL_INFO
 (("Received ActiveChangedo %s from CK on session '%s'",

689 
£ssiÚ_is_aùive
 ? "ACTIVE" : "INACTIVE", 
£ssiÚ_obj·th
));

692 
i
 = 
Œack”
->
£ssiÚs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

693 
£ssiÚ
 = (
CKSessiÚ
 *è
i
->
d©a
;

694 ià(
	`¡rcmp
 (
£ssiÚ
->
£ssiÚ_obj·th
, session_objpath) == 0) {

696 
£ssiÚ
->
is_aùive
 = 
£ssiÚ_is_aùive
;

698 ià(
Œack”
->
£ssiÚ_aùive_chªged_cb
 !ğ
NULL
) {

699 
Œack”
->
	`£ssiÚ_aùive_chªged_cb
 (Œack”, 
£ssiÚ
,¿ck”->
u£r_d©a
);

704 ià(
i
 =ğ
NULL
) {

705 
	`HAL_ERROR
 (("NØsuch sessiÚ '%s'", 
£ssiÚ_obj·th
));

707 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, 
DBUS_INTERFACE_DBUS
, "NameOwnerChanged")) {

708 *
Çme
;

709 *
Şd_£rviû_Çme
;

710 *
Ãw_£rviû_Çme
;

712 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, 
NULL
,

713 
DBUS_TYPE_STRING
, &
Çme
,

714 
DBUS_TYPE_STRING
, &
Şd_£rviû_Çme
,

715 
DBUS_TYPE_STRING
, &
Ãw_£rviû_Çme
,

716 
DBUS_TYPE_INVALID
)) {

717 
	`HAL_ERROR
 (("Invalid NameOwnerChanged signal from bus!"));

718 
out
;

721 ià(
	`¡¾’
 (
Ãw_£rviû_Çme
è=ğ0 && 
	`¡rcmp
 (
Çme
, "org.freedesktop.ConsoleKit") == 0) {

722 
	`HAL_INFO
 (("uh, oh, ConsoleKit went‡way!"));

723 
	`ck_Œack”_»move_®l_£©s_ªd_£ssiÚs
 (
Œack”
);

724 ià(
Œack”
->
£rviû_di§µ—»d_cb
 !ğ
NULL
) {

725 
Œack”
->
	`£rviû_di§µ—»d_cb
 (Œack”,¿ck”->
u£r_d©a
);

729 ià(
	`¡¾’
 (
Şd_£rviû_Çme
è=ğ0 && 
	`¡rcmp
 (
Çme
, "org.freedesktop.ConsoleKit") == 0) {

730 
	`HAL_INFO
 (("ConsoleKit„eappeared!"));

731 
	`ck_Œack”_š™
 (
Œack”
);

732 ià(
Œack”
->
£rviû_­³¬ed_cb
 !ğ
NULL
) {

733 
Œack”
->
	`£rviû_­³¬ed_cb
 (Œack”,¿ck”->
u£r_d©a
);

740 
out
:

742 
	}
}

744 
GSLi¡
 *

745 
	$ck_Œack”_g‘_£©s
 (
CKT¿ck”
 *
Œack”
)

747  
Œack”
->
£©s
;

748 
	}
}

750 
GSLi¡
 *

751 
	$ck_Œack”_g‘_£ssiÚs
 (
CKT¿ck”
 *
Œack”
)

753  
Œack”
->
£ssiÚs
;

754 
	}
}

756 
GSLi¡
 *

757 
	$ck_£©_g‘_£ssiÚs
 (
CKS—t
 *
£©
)

759  
£©
->
£ssiÚs
;

760 
	}
}

763 
	$ck_£©_g‘_id
 (
CKS—t
 *
£©
)

765  
	`g_ba£Çme
 (
£©
->
£©_obj·th
);

766 
	}
}

768 
gboŞ—n


769 
	$ck_£ssiÚ_is_aùive
 (
CKSessiÚ
 *
£ssiÚ
)

771  
£ssiÚ
->
is_aùive
;

772 
	}
}

774 
CKS—t
 *

775 
	$ck_£ssiÚ_g‘_£©
 (
CKSessiÚ
 *
£ssiÚ
)

777  
£ssiÚ
->
£©
;

778 
	}
}

781 
	$ck_£ssiÚ_g‘_id
 (
CKSessiÚ
 *
£ssiÚ
)

783  
	`g_ba£Çme
 (
£ssiÚ
->
£ssiÚ_obj·th
);

784 
	}
}

786 
uid_t


787 
	$ck_£ssiÚ_g‘_u£r
 (
CKSessiÚ
 *
£ssiÚ
)

789  
£ssiÚ
->
u£r
;

790 
	}
}

792 
gboŞ—n


793 
	$ck_£ssiÚ_is_loÿl
 (
CKSessiÚ
 *
£ssiÚ
)

795  
£ssiÚ
->
is_loÿl
;

796 
	}
}

799 
	$ck_£ssiÚ_g‘_ho¡Çme
 (
CKSessiÚ
 *
£ssiÚ
)

801  
£ssiÚ
->
ho¡Çme
;

802 
	}
}

804 
gboŞ—n


805 
	$ck_Œack”_š™
 (
CKT¿ck”
 *
Œack”
)

807 
dbus_boŞ_t
 
»t
;

809 
»t
 = 
FALSE
;

811 ià(!
	`ck_Œack”_š™_g‘_£©s_ªd_£ssiÚs
 (
Œack”
)) {

812 
	`HAL_ERROR
 (("Could‚ot get seats‡nd sessions"));

813 
out
;

816 
	`HAL_INFO
 (("Got seats‡nd sessions"));

818 
»t
 = 
TRUE
;

820 
out
:

821  
»t
;

822 
	}
}

824 
CKT¿ck”
 *

825 
	$ck_Œack”_Ãw
 ()

827 
CKT¿ck”
 *
Œack”
;

829 
Œack”
 = 
	`g_Ãw0
 (
CKT¿ck”
, 1);

830 
Œack”
->
»fcouÁ
 = 1;

831  
Œack”
;

832 
	}
}

834 
CKSessiÚ
 *

835 
	$ck_Œack”_fšd_£ssiÚ
 (
CKT¿ck”
 *
Œack”
, cÚ¡ *
ck_£ssiÚ_obj·th
)

837 
CKSessiÚ
 *
£ssiÚ
;

838 
GSLi¡
 *
i
;

839 
i
 = 
Œack”
->
£ssiÚs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

840 
£ssiÚ
 = 
i
->
d©a
;

841 ià(
	`¡rcmp
 (
£ssiÚ
->
£ssiÚ_obj·th
, 
ck_£ssiÚ_obj·th
) == 0) {

842 
out
;

845 
£ssiÚ
 = 
NULL
;

846 
out
:

847  
£ssiÚ
;

848 
	}
}

	@hald/ck-tracker.h

26 #iâdeà
CK_TRACKER_H


27 
	#CK_TRACKER_H


	)

29 
	~<uni¡d.h
>

30 
	~<sys/ty³s.h
>

31 
	~<dbus/dbus.h
>

32 
	~<glib.h
>

34 
	gCKT¿ck”_s
;

35 
CKT¿ck”_s
 
	tCKT¿ck”
;

36 
	gCKS—t_s
;

37 
CKS—t_s
 
	tCKS—t
;

38 
	gCKSessiÚ_s
;

39 
CKSessiÚ_s
 
	tCKSessiÚ
;

41 (*
	tCKS—tAddedCB
è(
	tCKT¿ck”
 *
	tŒack”
, 
	tCKS—t
 *
	t£©
, *
	tu£r_d©a
);

42 (*
	tCKS—tRemovedCB
è(
	tCKT¿ck”
 *
	tŒack”
, 
	tCKS—t
 *
	t£©
, *
	tu£r_d©a
);

43 (*
	tCKSessiÚAddedCB
è(
	tCKT¿ck”
 *
	tŒack”
, 
	tCKSessiÚ
 *
	t£ssiÚ
, *
	tu£r_d©a
);

44 (*
	tCKSessiÚRemovedCB
è(
	tCKT¿ck”
 *
	tŒack”
, 
	tCKSessiÚ
 *
	t£ssiÚ
, *
	tu£r_d©a
);

45 (*
	tCKSessiÚAùiveChªgedCB
è(
	tCKT¿ck”
 *
	tŒack”
, 
	tCKSessiÚ
 *
	t£ssiÚ
, *
	tu£r_d©a
);

46 (*
	tCKS”viûDi§µ—»dCB
è(
	tCKT¿ck”
 *
	tŒack”
, *
	tu£r_d©a
);

47 (*
	tCKS”viûAµ—»dCB
è(
	tCKT¿ck”
 *
	tŒack”
, *
	tu£r_d©a
);

49 
CKT¿ck”
 *
	`ck_Œack”_Ãw
 ();

50 
	`ck_Œack”_£t_sy¡em_bus_cÚÃùiÚ
 (
CKT¿ck”
 *
Œack”
, 
DBusCÚÃùiÚ
 *
sy¡em_bus_cÚÃùiÚ
);

51 
	`ck_Œack”_£t_u£r_d©a
 (
CKT¿ck”
 *
Œack”
, *
u£r_d©a
);

52 
	`ck_Œack”_£t_£©_added_cb
 (
CKT¿ck”
 *
Œack”
, 
CKS—tAddedCB
 
cb
);

53 
	`ck_Œack”_£t_£©_»moved_cb
 (
CKT¿ck”
 *
Œack”
, 
CKS—tRemovedCB
 
cb
);

54 
	`ck_Œack”_£t_£ssiÚ_added_cb
 (
CKT¿ck”
 *
Œack”
, 
CKSessiÚAddedCB
 
cb
);

55 
	`ck_Œack”_£t_£ssiÚ_»moved_cb
 (
CKT¿ck”
 *
Œack”
, 
CKSessiÚRemovedCB
 
cb
);

56 
	`ck_Œack”_£t_£ssiÚ_aùive_chªged_cb
 (
CKT¿ck”
 *
Œack”
, 
CKSessiÚAùiveChªgedCB
 
cb
);

57 
	`ck_Œack”_£t_£rviû_di§µ—»d_cb
 (
CKT¿ck”
 *
Œack”
, 
CKS”viûDi§µ—»dCB
 
cb
);

58 
	`ck_Œack”_£t_£rviû_­³¬ed_cb
 (
CKT¿ck”
 *
Œack”
, 
CKS”viûAµ—»dCB
 
cb
);

60 
gboŞ—n
 
	`ck_Œack”_š™
 (
CKT¿ck”
 *
Œack”
);

76 
	`ck_Œack”_´oûss_sy¡em_bus_mes§ge
 (
CKT¿ck”
 *
Œack”
, 
DBusMes§ge
 *
mes§ge
);

78 
	`ck_Œack”_»f
 (
CKT¿ck”
 *
Œack”
);

79 
	`ck_Œack”_uÄef
 (
CKT¿ck”
 *
Œack”
);

81 
GSLi¡
 *
	`ck_Œack”_g‘_£©s
 (
CKT¿ck”
 *
Œack”
);

82 
GSLi¡
 *
	`ck_Œack”_g‘_£ssiÚs
 (
CKT¿ck”
 *
Œack”
);

84 
CKSessiÚ
 *
	`ck_Œack”_fšd_£ssiÚ
 (
CKT¿ck”
 *
Œack”
, cÚ¡ *
ck_£ssiÚ_obj·th
);

86 
GSLi¡
 *
	`ck_£©_g‘_£ssiÚs
 (
CKS—t
 *
£©
);

87 cÚ¡ *
	`ck_£©_g‘_id
 (
CKS—t
 *
£©
);

89 
gboŞ—n
 
	`ck_£ssiÚ_is_aùive
 (
CKSessiÚ
 *
£ssiÚ
);

90 
CKS—t
 *
	`ck_£ssiÚ_g‘_£©
 (
CKSessiÚ
 *
£ssiÚ
);

91 cÚ¡ *
	`ck_£ssiÚ_g‘_id
 (
CKSessiÚ
 *
£ssiÚ
);

92 
uid_t
 
	`ck_£ssiÚ_g‘_u£r
 (
CKSessiÚ
 *
£ssiÚ
);

93 
gboŞ—n
 
	`ck_£ssiÚ_is_loÿl
 (
CKSessiÚ
 *
£ssiÚ
);

94 cÚ¡ *
	`ck_£ssiÚ_g‘_ho¡Çme
 (
CKSessiÚ
 *
£ssiÚ
);

	@hald/create_cache.c

31 
	~<sys/ty³s.h
>

32 
	~<sys/¡©.h
>

33 
	~<fú.h
>

34 
	~<uni¡d.h
>

35 
	~<¡ršg.h
>

36 
	~<¡dio.h
>

37 
	~<¡dlib.h
>

38 
	~<dœ’t.h
>

39 
	~<”ºo.h
>

40 
	~<¡ršg.h
>

41 
	~<g‘İt.h
>

42 
	~<sy¦og.h
>

43 
	~<ex·t.h
>

44 
	~<glib.h
>

45 
	~<cÚfig.h
>

47 
	~"logg”.h
"

48 
	~"ruË.h
"

50 
XML_P¬£r
 
	g·r£r
;

51 
	gs_”rÜ
[256];

52 
	gh®dc_v”bo£
 = 0;

55 
	sfdi_cÚ‹xt
 {

56 
	md•th
;

57 
u_št32_t
 
	mm©ch_©_d•th
[
HAL_MAX_INDENT_DEPTH
];

58 
ruË
 
	mruË
;

59 
off_t
 
	mpos™iÚ
;

60 
	mÿche_fd
;

65 #ifdeà
__GLIBC__


66 
	$_®phasÜt
(cÚ¡ *
a
, cÚ¡ *
b
)

68 
	$_®phasÜt
(cÚ¡ 
dœ’t
 **
a
, cÚ¡ dœ’ˆ**
b
)

71  -
	`®phasÜt
 (
a
, 
b
);

72 
	}
}

75 
ruË_ty³


76 
	$g‘_ruË_ty³
 (cÚ¡ *
¡r
)

78 ià(
	`¡rcmp
 (
¡r
, "match") == 0)

79  
RULE_MATCH
;

80 ià(
	`¡rcmp
 (
¡r
, "merge") == 0)

81  
RULE_MERGE
;

82 ià(
	`¡rcmp
 (
¡r
, "append") == 0)

83  
RULE_APPEND
;

84 ià(
	`¡rcmp
 (
¡r
, "prepend") == 0)

85  
RULE_PREPEND
;

86 ià(
	`¡rcmp
 (
¡r
, "addset") == 0)

87  
RULE_ADDSET
;

88 ià(
	`¡rcmp
 (
¡r
, "remove") == 0)

89  
RULE_REMOVE
;

90 ià(
	`¡rcmp
 (
¡r
, "clear") == 0)

91  
RULE_CLEAR
;

92 ià(
	`¡rcmp
 (
¡r
, "spawn") == 0)

93  
RULE_SPAWN
;

94  
RULE_UNKNOWN
;

95 
	}
}

97 
m©ch_ty³


98 
	$g‘_m©ch_ty³
(cÚ¡ *
¡r
)

100 ià(
	`¡rcmp
 (
¡r
, "string") == 0)

101  
MATCH_STRING
;

102 ià(
	`¡rcmp
 (
¡r
, "int") == 0)

103  
MATCH_INT
;

104 ià(
	`¡rcmp
 (
¡r
, "uint64") == 0)

105  
MATCH_UINT64
;

106 ià(
	`¡rcmp
 (
¡r
, "bool") == 0)

107  
MATCH_BOOL
;

108 ià(
	`¡rcmp
 (
¡r
, "exists") == 0)

109  
MATCH_EXISTS
;

110 ià(
	`¡rcmp
 (
¡r
, "empty") == 0)

111  
MATCH_EMPTY
;

112 ià(
	`¡rcmp
 (
¡r
, "is_ascii") == 0)

113  
MATCH_ISASCII
;

114 ià(
	`¡rcmp
 (
¡r
, "is_absolute_path") == 0)

115  
MATCH_IS_ABS_PATH
;

116 ià(
	`¡rcmp
 (
¡r
, "sibling_contains") == 0)

117  
MATCH_SIBLING_CONTAINS
;

118 ià(
	`¡rcmp
 (
¡r
, "contains") == 0)

119  
MATCH_CONTAINS
;

120 ià(
	`¡rcmp
 (
¡r
, "contains_ncase") == 0)

121  
MATCH_CONTAINS_NCASE
;

122 ià(
	`¡rcmp
 (
¡r
, "prefix") == 0)

123  
MATCH_PREFIX
;

124 ià(
	`¡rcmp
 (
¡r
, "prefix_ncase") == 0)

125  
MATCH_PREFIX_NCASE
;

126 ià(
	`¡rcmp
 (
¡r
, "suffix") == 0)

127  
MATCH_SUFFIX
;

128 ià(
	`¡rcmp
 (
¡r
, "suffix_ncase") == 0)

129  
MATCH_SUFFIX_NCASE
;

130 ià(
	`¡rcmp
 (
¡r
, "compare_lt") == 0)

131  
MATCH_COMPARE_LT
;

132 ià(
	`¡rcmp
 (
¡r
, "compare_le") == 0)

133  
MATCH_COMPARE_LE
;

134 ià(
	`¡rcmp
 (
¡r
, "compare_gt") == 0)

135  
MATCH_COMPARE_GT
;

136 ià(
	`¡rcmp
 (
¡r
, "compare_ge") == 0)

137  
MATCH_COMPARE_GE
;

138 ià(
	`¡rcmp
 (
¡r
, "compare_ne") == 0)

139  
MATCH_COMPARE_NE
;

140 ià(
	`¡rcmp
 (
¡r
, "contains_not") == 0)

141  
MATCH_CONTAINS_NOT
;

142 ià(
	`¡rcmp
 (
¡r
, "contains_outof") == 0)

143  
MATCH_CONTAINS_OUTOF
;

144 ià(
	`¡rcmp
 (
¡r
, "int_outof") == 0)

145  
MATCH_INT_OUTOF
;

146 ià(
	`¡rcmp
 (
¡r
, "prefix_outof") == 0)

147  
MATCH_PREFIX_OUTOF
;

148 ià(
	`¡rcmp
 (
¡r
, "string_outof") == 0)

149  
MATCH_STRING_OUTOF
;

150  
MATCH_UNKNOWN
;

151 
	}
}

153 
m”ge_ty³


154 
	$g‘_m”ge_ty³
 (cÚ¡ *
¡r
)

156 ià(
	`¡rcmp
 (
¡r
, "string") == 0)

157  
MERGE_STRING
;

158 ià(
	`¡rcmp
 (
¡r
, "bool") == 0)

159  
MERGE_BOOLEAN
;

160 ià(
	`¡rcmp
 (
¡r
, "int") == 0)

161  
MERGE_INT32
;

162 ià(
	`¡rcmp
 (
¡r
, "uint64") == 0)

163  
MERGE_UINT64
;

164 ià(
	`¡rcmp
 (
¡r
, "double") == 0)

165  
MERGE_DOUBLE
;

166 ià(
	`¡rcmp
 (
¡r
, "strlist") == 0)

167  
MERGE_STRLIST
;

168 ià(
	`¡rcmp
 (
¡r
, "copy_property") == 0)

169  
MERGE_COPY_PROPERTY
;

170 ià(
	`¡rcmp
 (
¡r
, "remove") == 0)

171  
MERGE_REMOVE
;

172  
MERGE_UNKNOWN
;

173 
	}
}

175 
	#ROUND
(
Ën
,
®ign
è(Ö’ +‡ligÀ- 1è& -®ign)

	)

176 
	#ROUND32
(
Ën
è
	`ROUND
Ö’, 4)

	)

177 
	#RULES_ROUND
(
off
è
	`ROUND
(off, 
	`__®ignof__
(
ruË
))

	)

179 
	$·d32_wr™e
(
fd
, 
off_t
 
off£t
, *
d©a
, 
size_t
 
Ën
)

181 
ssize_t
 
»suÉ
;

182 
·d
[3] = {0, 0, 0};

184 
	`l£ek
(
fd
, 
off£t
, 
SEEK_SET
);

185 
»suÉ
 = 
	`wr™e
(
fd
, 
d©a
, 
Ën
);

187 ià(
»suÉ
 !ğ(
ssize_t
è
Ën
)

188 
	`DIE
(("Disk writeƒrror"));

190 ià((
off£t
 + 
Ën
) & 0x03) {

191 
»suÉ
 = 
	`wr™e
(
fd
, 
·d
, 4 - ((
off£t
 + 
Ën
) & 0x03));

193 ià(
»suÉ
 !ğ(
ssize_t
è(4 - ((
off£t
 + 
Ën
) & 0x03)))

194 
	`DIE
(("Disk writeƒrror"));

196 
	}
}

198 
	$š™_ruË_¡ruù
(
ruË
 *rule)

200 
	`mem£t
(
ruË
, 0, (rule));

201 
ruË
->
ruË_size
 = (rule);

202 
ruË
->
¹y³
 = 
RULE_UNKNOWN
;

203 
ruË
->
ty³_m©ch
 = 
MATCH_UNKNOWN
;

204 
ruË
->
ty³_m”ge
 = 
MERGE_UNKNOWN
;

205 
ruË
->
v®ue_off£t
 = 
	`off£tof
(
ÿche_h—d”
, 
em±y_¡ršg
);

206 
	}
}

209 
	$¡Üe_key
(
fdi_cÚ‹xt
 *
fdi_ùx
, cÚ¡ *
key
)

211 ià(
fdi_ùx
->
ruË
.
¹y³
 =ğ
RULE_UNKNOWN
)

212 
	`DIE
(("I„efuseo store garbage"));

214 ià((
key
 =ğ
NULL
) || (*key == '\0'))

215 
	`DIE
(("Key is‚ot valid"));

217 
fdi_ùx
->
ruË
.
key_Ën
 = 
	`¡¾’
(
key
) + 1;

219 
	`·d32_wr™e
(
fdi_ùx
->
ÿche_fd
, fdi_ùx->
pos™iÚ
 + (
ruË
),

220 (*)
key
, 
fdi_ùx
->
ruË
.
key_Ën
);

222 ià(
h®dc_v”bo£
)

223 
	`HAL_INFO
(("StÜšg key '%s'‡ˆruË=%08lx", 
key
, 
fdi_ùx
->
pos™iÚ
));

224 
	}
}

227 
	$¡Üe_v®ue
(
fdi_cÚ‹xt
 *
fdi_ùx
, cÚ¡ *
v®ue
, 
size_t
 
v®ue_Ën
)

229 
off_t
 
off£t
;

230 * 
p
;

232 ià(
fdi_ùx
->
ruË
.
¹y³
 =ğ
RULE_UNKNOWN
)

233 
	`DIE
(("I„efuseo store garbage"));

235 ià(
fdi_ùx
->
ruË
.
key_Ën
 < 2)

236 
	`DIE
(("Key†ength isoo smallo berue"));

238 ià((
v®ue_Ën
 =ğ0è|| (
v®ue
 =ğ
NULL
) || (*value == '\0')) ;

240 
off£t
 = 
fdi_ùx
->
pos™iÚ
 + (
ruË
è+ 
	`ROUND32
(fdi_ùx->ruË.
key_Ën
);

242 ià(
fdi_ùx
->
ruË
.
v®ue_Ën
 == 0) {

243 
fdi_ùx
->
ruË
.
v®ue_off£t
 = 
off£t
;

244 
fdi_ùx
->
ruË
.
v®ue_Ën
 = value_len + 1;

247 
off£t
 +ğ
fdi_ùx
->
ruË
.
v®ue_Ën
 - 1;

248 
fdi_ùx
->
ruË
.
v®ue_Ën
 += value_len;

251 
	`·d32_wr™e
(
fdi_ùx
->
ÿche_fd
, 
off£t
, (*)
v®ue
, 
v®ue_Ën
);

252 
	`·d32_wr™e
(
fdi_ùx
->
ÿche_fd
, 
off£t
 + 
v®ue_Ën
, "", 1);

254 
p
 = 
	`m®loc
(
v®ue_Ën
 + 1);

256 if(!
p
)

257 
	`DIE
(("Could‚Ù‡Îoÿ‹ %lu by‹s", (è
v®ue_Ën
 + 1));

259 
	`memıy
(
p
, 
v®ue
, 
v®ue_Ën
);

260 
p
[
v®ue_Ën
] = '\0';

262 ià(
h®dc_v”bo£
)

263 
	`HAL_INFO
(("Storing value '%s', value_len=%d,‡t„ule=%08lx, offset=%08lx",

264 
p
, 
v®ue_Ën
, 
fdi_ùx
->
pos™iÚ
, 
off£t
));

266 
	`ä“
(
p
);

267 
	}
}

269 
	$¡Üe_ruË
(
fdi_cÚ‹xt
 *
fdi_ùx
)

271 ià(
fdi_ùx
->
ruË
.
¹y³
 =ğ
RULE_UNKNOWN
)

272 
	`DIE
(("I„efuseo store garbage"));

274 
fdi_ùx
->
ruË
.
ruË_size
 =

275 
	`RULES_ROUND
((
ruË
) +

276 
	`ROUND32
(
fdi_ùx
->
ruË
.
key_Ën
) +

277 
	`ROUND32
(
fdi_ùx
->
ruË
.
v®ue_Ën
));

279 
	`·d32_wr™e
(
fdi_ùx
->
ÿche_fd
, fdi_ùx->
pos™iÚ
,

280 &
fdi_ùx
->
ruË
, (rule));

282 ià(
h®dc_v”bo£
) {

283 
	`HAL_INFO
(("rule=%08lx,„ule_size=%d,„type=%d",

284 
fdi_ùx
->
pos™iÚ
, fdi_ùx->
ruË
.
ruË_size
, fdi_ùx->ruË.
¹y³
));

286 
	`HAL_INFO
((" jump_pos™iÚ=%08lx", 
fdi_ùx
->
ruË
.
jump_pos™iÚ
));

288 
	`HAL_INFO
((" key_len=%d, key_offset=%08lx",

289 
fdi_ùx
->
ruË
.
key_Ën
, fdi_ùx->
pos™iÚ
 + 
	`off£tof
(ruË, 
key
)));

291 
	`HAL_INFO
((" value_len=%d, value_offset=%08lx",

292 
fdi_ùx
->
ruË
.
v®ue_Ën
, fdi_ùx->ruË.
v®ue_off£t
));

295 
	`š™_ruË_¡ruù
(&
fdi_ùx
->
ruË
);

296 
	}
}

298 
	$»memb”_jump_pos™iÚ
(
fdi_cÚ‹xt
 *
fdi_ùx
)

300 ià(
fdi_ùx
->
d•th
 >ğ
HAL_MAX_INDENT_DEPTH
)

301 
	`DIE
(("Rule depth overflow"));

302 
fdi_ùx
->
m©ch_©_d•th
[fdi_ùx->
d•th
++] = fdi_ùx->
pos™iÚ
;

303 
	}
}

305 
	$£t_jump_pos™iÚ
(
fdi_cÚ‹xt
 *
fdi_ùx
)

307 
off_t
 
off£t
;

308 
u_št32_t
 
off£t32
;

310 ià(
fdi_ùx
->
d•th
 <= 0)

311 
	`DIE
(("Rule depth underrun"));

313 
fdi_ùx
->
d•th
--;

314 
off£t
 = 
	`RULES_ROUND
(
	`l£ek
(
fdi_ùx
->
ÿche_fd
, 0, 
SEEK_END
));

315 
off£t32
 = (
u_št32_t
)
off£t
;

316 
	`·d32_wr™e
(
fdi_ùx
->
ÿche_fd
,

317 
fdi_ùx
->
m©ch_©_d•th
[fdi_ùx->
d•th
] + 
	`off£tof
(
ruË
, 
jump_pos™iÚ
),

318 &
off£t32
, (
fdi_ùx
->
ruË
.
jump_pos™iÚ
));

320 ià(
h®dc_v”bo£
)

321 
	`HAL_INFO
(("modify„ule=0x%08x, set jumpo 0x%08x",

322 
fdi_ùx
->
m©ch_©_d•th
[fdi_ùx->
d•th
], 
off£t
));

324 
	}
}

328 
	$¡¬t
 (*
d©a
, cÚ¡ *
–
, cÚ¡ **
©Œ
)

330 
fdi_cÚ‹xt
 *
fdi_ùx
 = 
d©a
;

331 
i
;

334 ià(
fdi_ùx
->
ruË
.
¹y³
 !ğ
RULE_UNKNOWN
)

335 
	`¡Üe_ruË
(
fdi_ùx
);

337 
	`š™_ruË_¡ruù
(&
fdi_ùx
->
ruË
);

338 
fdi_ùx
->
ruË
.
¹y³
 = 
	`g‘_ruË_ty³
(
–
);

339 
fdi_ùx
->
pos™iÚ
 = 
	`RULES_ROUND
(
	`l£ek
(fdi_ùx->
ÿche_fd
, 0, 
SEEK_END
));

340 ià(
fdi_ùx
->
ruË
.
¹y³
 =ğ
RULE_UNKNOWN
) ;

343 
i
 = 0; 
©Œ
[i] !ğ
NULL
; i+=2) {

344 ià(
	`¡rcmp
 (
©Œ
[
i
], "key") == 0) {

345 ià(
fdi_ùx
->
ruË
.
key_Ën
 > 0) {

346 
	`¢´štf
 (
s_”rÜ
,  (s_error), "Bad„ule: key‡lready defined");

347 
	`XML_StİP¬£r
 (
·r£r
, 
FALSE
);

351 
	`¡Üe_key
(
fdi_ùx
, 
©Œ
[
i
 + 1]);

354 ià(
fdi_ùx
->
ruË
.
¹y³
 =ğ
RULE_SPAWN
) {

355 ià(
	`¡rcmp
(
©Œ
[
i
], "udi") == 0) {

356 ià(
fdi_ùx
->
ruË
.
key_Ën
 > 0) {

357 
	`¢´štf
 (
s_”rÜ
,  (s_error), "Bad„ule: key‡lready defined");

358 
	`XML_StİP¬£r
 (
·r£r
, 
FALSE
);

362 
	`¡Üe_key
(
fdi_ùx
, 
©Œ
[
i
 + 1]);

367 } ià(
fdi_ùx
->
ruË
.
¹y³
 =ğ
RULE_MATCH
) {

369 ià(
fdi_ùx
->
ruË
.
key_Ën
 == 0) {

370 
	`¢´štf
 (
s_”rÜ
,  (s_error), "Bad„ule: value without‡ key");

371 
	`XML_StİP¬£r
 (
·r£r
, 
FALSE
);

375 
fdi_ùx
->
ruË
.
ty³_m©ch
 = 
	`g‘_m©ch_ty³
(
©Œ
[
i
]);

377 ià(
fdi_ùx
->
ruË
.
ty³_m©ch
 =ğ
MATCH_UNKNOWN
) {

378 
	`¢´štf
 (
s_”rÜ
,  (s_error), "Bad„ule: unknownype_match");

379 
	`XML_StİP¬£r
 (
·r£r
, 
FALSE
);

383 
	`¡Üe_v®ue
(
fdi_ùx
, 
©Œ
[
i
 + 1], 
	`¡¾’
(attr[i + 1]));

386 ià(
	`¡rcmp
(
©Œ
[
i
], "type") != 0){

390 
fdi_ùx
->
ruË
.
ty³_m”ge
 = 
	`g‘_m”ge_ty³
(
©Œ
[
i
 + 1]);

392 ià(
fdi_ùx
->
ruË
.
ty³_m”ge
 =ğ
MERGE_UNKNOWN
) {

393 
	`¢´štf
 (
s_”rÜ
,  (s_error), "Bad„ule: unknownype_merge");

394 
	`XML_StİP¬£r
 (
·r£r
, 
FALSE
);

402 ià(
fdi_ùx
->
ruË
.
key_Ën
 == 0) {

403 
	`¢´štf
 (
s_”rÜ
,  (s_error), "Bad„ule: key‚ot found");

404 
	`XML_StİP¬£r
 (
·r£r
, 
FALSE
);

410 ià(
fdi_ùx
->
ruË
.
¹y³
 =ğ
RULE_MATCH
)

411 
	`»memb”_jump_pos™iÚ
(
fdi_ùx
);

414 
	}
}

418 
	$cd©a
 (*
d©a
, cÚ¡ *
s
, 
Ën
){

419 
fdi_cÚ‹xt
 *
fdi_ùx
 = 
d©a
;

421 ià(
fdi_ùx
->
ruË
.
¹y³
 !ğ
RULE_MERGE
 &&

422 
fdi_ùx
->
ruË
.
¹y³
 !ğ
RULE_PREPEND
 &&

423 
fdi_ùx
->
ruË
.
¹y³
 !ğ
RULE_ADDSET
 &&

424 
fdi_ùx
->
ruË
.
¹y³
 !ğ
RULE_APPEND
 &&

425 
fdi_ùx
->
ruË
.
¹y³
 !ğ
RULE_REMOVE
 &&

426 
fdi_ùx
->
ruË
.
¹y³
 !ğ
RULE_SPAWN
)

429 
	`¡Üe_v®ue
(
fdi_ùx
, 
s
, 
Ën
);

430 
	}
}

434 
	$’d
 (*
d©a
, cÚ¡ *
–
){

435 
fdi_cÚ‹xt
 *
fdi_ùx
 = 
d©a
;

436 
ruË_ty³
 
¹y³
 = 
	`g‘_ruË_ty³
(
–
);

438 ià(
¹y³
 =ğ
RULE_UNKNOWN
) ;

439 ià(
¹y³
 =ğ
RULE_MATCH
){

440 ià(
fdi_ùx
->
ruË
.
¹y³
 =ğ
RULE_MATCH
) {

443 
	`¡Üe_ruË
(
fdi_ùx
);

445 
	`£t_jump_pos™iÚ
(
fdi_ùx
);

450 ià(
fdi_ùx
->
ruË
.
¹y³
 !=„type) {

451 
	`¢´štf
 (
s_”rÜ
,  (s_”rÜ), "UÃx³ùedag '%s'", 
–
);

452 
	`XML_StİP¬£r
 (
·r£r
, 
FALSE
);

455 
	`¡Üe_ruË
(
fdi_ùx
);

456 
	}
}

460 
	$ruËs_add_fdi_fe
 (cÚ¡ *
f’ame
, 
fd
)

462 
fdi_cÚ‹xt
 *
fdi_ùx
;

463 *
buf
;

464 
gsize
 
buæ’
;

465 
rc
;

466 
»t
;

468 
»t
 = -1;

470 ià(!
	`g_fe_g‘_cÚ‹Ás
 (
f’ame
, &
buf
, &
buæ’
, 
NULL
))

471 
out
;

474 
fdi_ùx
 = 
	`g_Ãw0
 (
fdi_cÚ‹xt
, 1);

475 
	`mem£t
(
fdi_ùx
, 0, (
fdi_cÚ‹xt
));

476 
	`š™_ruË_¡ruù
(&
fdi_ùx
->
ruË
);

477 
fdi_ùx
->
ÿche_fd
 = 
fd
;

479 
·r£r
 = 
	`XML_P¬£rC»©e
 (
NULL
);

480 ià(
·r£r
 =ğ
NULL
) {

481 
	`HAL_ERROR
 (("Couldn't‡llocate memory for…arser"));

482 
	`g_ä“
 (
fdi_ùx
);

483 
out
;

485 
	`XML_S‘U£rD©a
 (
·r£r
, 
fdi_ùx
);

486 
	`XML_S‘EËm’tHªdËr
 (
·r£r
, 
¡¬t
, 
’d
);

487 
	`XML_S‘Ch¬aù”D©aHªdËr
 (
·r£r
, 
cd©a
);

488 
rc
 = 
	`XML_P¬£
 (
·r£r
, 
buf
, 
buæ’
, 1);

489 ià(
rc
 == 0) {

490 ià(
	`XML_G‘E¼ÜCode
 (
·r£r
è=ğ
XML_ERROR_ABORTED
) {

491 
	`HAL_ERROR
 (("%s:%d: semanticƒrror: %s",

492 
f’ame
,

493 (è
	`XML_G‘Cu¼’tLšeNumb”
 (
·r£r
),

494 
s_”rÜ
));

495 
	`sy¦og
 (
LOG_ERR
,

497 
f’ame
,

498 (è
	`XML_G‘Cu¼’tLšeNumb”
 (
·r£r
),

499 
s_”rÜ
);

502 
	`HAL_ERROR
 (("%s:%d: XML…arseƒrror: %s",

503 
f’ame
,

504 (è
	`XML_G‘Cu¼’tLšeNumb”
 (
·r£r
),

505 
	`XML_E¼ÜSŒšg
 (
	`XML_G‘E¼ÜCode
 (
·r£r
))));

506 
	`sy¦og
 (
LOG_ERR
,

508 
f’ame
,

509 (è
	`XML_G‘Cu¼’tLšeNumb”
 (
·r£r
),

510 
	`XML_E¼ÜSŒšg
 (
	`XML_G‘E¼ÜCode
 (
·r£r
)));

513 
	`XML_P¬£rF»e
 (
·r£r
);

514 
	`g_ä“
 (
buf
);

515 
	`g_ä“
 (
fdi_ùx
);

516 
out
;

518 
	`XML_P¬£rF»e
 (
·r£r
);

519 
	`g_ä“
 (
buf
);

522 
	`š™_ruË_¡ruù
(&
fdi_ùx
->
ruË
);

523 
fdi_ùx
->
ruË
.
¹y³
 = 
RULE_EOF
;

524 
fdi_ùx
->
pos™iÚ
 = 
	`RULES_ROUND
(
	`l£ek
(fdi_ùx->
ÿche_fd
, 0, 
SEEK_END
));

525 
	`¡Üe_key
(
fdi_ùx
, 
f’ame
);

526 
	`¡Üe_v®ue
(
fdi_ùx
, "", 0);

527 
	`¡Üe_ruË
(
fdi_ùx
);

528 
	`g_ä“
 (
fdi_ùx
);

529 
»t
 = 
	`l£ek
(
fd
, 0, 
SEEK_END
);

530 
out
:

531  
»t
;

533 
	}
}

540 
	$ruËs_£¬ch_ªd_add_fdi_fes
 (cÚ¡ *
dœ
, 
fd
)

542 
i
;

543 
num_’Œ›s
;

544 
dœ’t
 **
Çme_li¡
;

545 
num_sk³d_fdi_fes
;

547 
num_sk³d_fdi_fes
 = 0;

549 
num_’Œ›s
 = 
	`sÿndœ
 (
dœ
, &
Çme_li¡
, 
NULL
, 
_®phasÜt
);

550 ià(
num_’Œ›s
 == -1) {

551 
	`HAL_ERROR
 (("CªnÙ sÿÀ'%s': %s", 
dœ
, 
	`¡»¼Ü
 (
”ºo
)));

552 
”rÜ
;

555 
i
 = 
num_’Œ›s
 - 1; i >= 0; i--) {

556 
Ën
;

557 *
f’ame
;

558 
gch¬
 *
fuÎ_·th
;

560 
f’ame
 = 
Çme_li¡
[
i
]->
d_Çme
;

561 
Ën
 = 
	`¡¾’
 (
f’ame
);

562 
fuÎ_·th
 = 
	`g_¡rdup_´štf
 ("%s/%s", 
dœ
, 
f’ame
);

563 ià(
	`g_fe_‹¡
 (
fuÎ_·th
, (
G_FILE_TEST_IS_REGULAR
))) {

564 ià(
Ën
 >ğ5 && 
	`¡rcmp
(&
f’ame
[len - 4], ".fdi") == 0) {

565 
fdi_ruËs_size
;

566 
off_t
 
off£t_befÜe
;

567 
off£t_befÜe
 = 
	`l£ek
 (
fd
, 0, 
SEEK_CUR
);

568 
fdi_ruËs_size
 = 
	`ruËs_add_fdi_fe
 (
fuÎ_·th
, 
fd
);

569 ià(
fdi_ruËs_size
 < 0) {

570 
	`HAL_ERROR
 (("”rÜ…roûssšg fd˜f'%s'", 
fuÎ_·th
));

572 ià(
	`árunÿ‹
 (
fd
, 
off£t_befÜe
) != 0) {

573 
	`HAL_ERROR
 (("Cannotruncate„ules fdi"));

574 
”rÜ
;

576 
	`l£ek
 (
fd
, 0, 
SEEK_END
);

577 
	`HAL_INFO
 (("sk³d fd˜f'%s'", 
fuÎ_·th
));

578 
num_sk³d_fdi_fes
++;

581 } ià(
	`g_fe_‹¡
 (
fuÎ_·th
, (
G_FILE_TEST_IS_DIR
)è&& 
f’ame
[0] != '.') {

582 
num_by‹s
;

583 *
dœÇme
;

584 
»t
;

586 
num_by‹s
 = 
Ën
 + 
	`¡¾’
 (
dœ
) + 1 + 1;

587 
dœÇme
 = (*è
	`m®loc
 (
num_by‹s
);

588 ià(
dœÇme
 =ğ
NULL
)

591 
	`¢´štf
 (
dœÇme
, 
num_by‹s
, "%s/%s", 
dœ
, 
f’ame
);

592 
»t
 = 
	`ruËs_£¬ch_ªd_add_fdi_fes
 (
dœÇme
, 
fd
);

593 ià(
»t
 == -1)

594 
”rÜ
;

595 
num_sk³d_fdi_fes
 +ğ
»t
;

596 
	`ä“
 (
dœÇme
);

598 
	`g_ä“
 (
fuÎ_·th
);

599 
	`ä“
 (
Çme_li¡
[
i
]);

602 ; 
i
 >= 0; i--) {

603 
	`ä“
 (
Çme_li¡
[
i
]);

605 
	`ä“
 (
Çme_li¡
);

607  
num_sk³d_fdi_fes
;

608 
”rÜ
:

610 
	}
}

615 
	$di_ruËs_š™
 ()

617 * 
ÿch’ame
;

618 
fd
 = -1;

619 
ÿche_h—d”
 
h—d”
;

620 
gch¬
 *
ÿch’ame_‹mp
;

621 *
h®_fdi_sourû_´•robe
 = 
	`g‘’v
 ("HAL_FDI_SOURCE_PREPROBE");

622 *
h®_fdi_sourû_šfÜm©iÚ
 = 
	`g‘’v
 ("HAL_FDI_SOURCE_INFORMATION");

623 *
h®_fdi_sourû_pŞicy
 = 
	`g‘’v
 ("HAL_FDI_SOURCE_POLICY");

624 
n
;

625 
num_sk³d_fdi_fes
;

627 
num_sk³d_fdi_fes
 = 0;

629 
ÿch’ame
 = 
	`g‘’v
 ("HAL_FDI_CACHE_NAME");

630 if(
ÿch’ame
 =ğ
NULL
)

631 
ÿch’ame
 = 
HALD_CACHE_FILE
;

632 ià(
h®dc_v”bo£
)

633 
	`HAL_INFO
 (("Loading„ules"));

635 
ÿch’ame_‹mp
 = 
	`g_¡rcÚÿt
 (
ÿch’ame
, "~", 
NULL
);

637 
fd
 = 
	`İ’
(
ÿch’ame_‹mp
, 
O_CREAT
|
O_RDWR
|
O_TRUNC
, 0644);

638 if(
fd
 < 0) {

639 
	`HAL_ERROR
 (("UÇbËØİ’ fd˜ÿch'%s' ffÜ wr™šg: %s", 
ÿch’ame_‹mp
, 
	`¡»¼Ü
(
”ºo
)));

640 
”rÜ
;

643 
	`mem£t
(&
h—d”
, 0, (
ÿche_h—d”
));

644 
	`·d32_wr™e
(
fd
, 0, &
h—d”
, (
ÿche_h—d”
));

646 
h—d”
.
fdi_ruËs_´•robe
 = 
	`RULES_ROUND
(
	`l£ek
(
fd
, 0, 
SEEK_END
));

647 ià(
h®_fdi_sourû_´•robe
 !ğ
NULL
) {

648 ià((
n
 = 
	`ruËs_£¬ch_ªd_add_fdi_fes
 (
h®_fdi_sourû_´•robe
, 
fd
)) == -1)

649 
”rÜ
;

650 
num_sk³d_fdi_fes
 +ğ
n
;

652 ià((
n
 = 
	`ruËs_£¬ch_ªd_add_fdi_fes
 (
PACKAGE_DATA_DIR
 "/h®/fdi/´•robe", 
fd
)) == -1)

653 
”rÜ
;

654 
num_sk³d_fdi_fes
 +ğ
n
;

655 ià((
n
 = 
	`ruËs_£¬ch_ªd_add_fdi_fes
 (
PACKAGE_SYSCONF_DIR
 "/h®/fdi/´•robe", 
fd
)) == -1)

656 
”rÜ
;

657 
num_sk³d_fdi_fes
 +ğ
n
;

660 
h—d”
.
fdi_ruËs_šfÜm©iÚ
 = 
	`RULES_ROUND
(
	`l£ek
(
fd
, 0, 
SEEK_END
));

661 ià(
h®_fdi_sourû_šfÜm©iÚ
 !ğ
NULL
) {

662 ià((
n
 = 
	`ruËs_£¬ch_ªd_add_fdi_fes
 (
h®_fdi_sourû_šfÜm©iÚ
, 
fd
)) == -1)

663 
”rÜ
;

664 
num_sk³d_fdi_fes
 +ğ
n
;

666 ià((
n
 = 
	`ruËs_£¬ch_ªd_add_fdi_fes
 (
PACKAGE_DATA_DIR
 "/h®/fdi/šfÜm©iÚ", 
fd
)) == -1)

667 
”rÜ
;

668 
num_sk³d_fdi_fes
 +ğ
n
;

669 ià((
n
 = 
	`ruËs_£¬ch_ªd_add_fdi_fes
 (
PACKAGE_SYSCONF_DIR
 "/h®/fdi/šfÜm©iÚ", 
fd
)) == -1)

670 
”rÜ
;

671 
num_sk³d_fdi_fes
 +ğ
n
;

674 
h—d”
.
fdi_ruËs_pŞicy
 = 
	`RULES_ROUND
(
	`l£ek
(
fd
, 0, 
SEEK_END
));

675 ià(
h®_fdi_sourû_pŞicy
 !ğ
NULL
) {

676 ià((
n
 = 
	`ruËs_£¬ch_ªd_add_fdi_fes
 (
h®_fdi_sourû_pŞicy
, 
fd
)) == -1)

677 
”rÜ
;

678 
num_sk³d_fdi_fes
 +ğ
n
;

680 ià((
n
 = 
	`ruËs_£¬ch_ªd_add_fdi_fes
 (
PACKAGE_DATA_DIR
 "/h®/fdi/pŞicy", 
fd
)) == -1)

681 
”rÜ
;

682 
num_sk³d_fdi_fes
 +ğ
n
;

683 ià((
n
 = 
	`ruËs_£¬ch_ªd_add_fdi_fes
 (
PACKAGE_SYSCONF_DIR
 "/h®/fdi/pŞicy", 
fd
)) == -1)

684 
”rÜ
;

685 
num_sk³d_fdi_fes
 +ğ
n
;

688 
h—d”
.
®l_ruËs_size
 = 
	`l£ek
(
fd
, 0, 
SEEK_END
);

689 
	`·d32_wr™e
(
fd
, 0, &
h—d”
, (
ÿche_h—d”
));

690 
	`şo£
(
fd
);

691 ià(
	`»Çme
 (
ÿch’ame_‹mp
, 
ÿch’ame
) != 0) {

692 
	`HAL_ERROR
 (("CªnÙ„’am'%s'Ø'%s': %s", 
ÿch’ame_‹mp
, 
ÿch’ame
, 
	`¡»¼Ü
 (
”ºo
)));

693 
”rÜ
;

696 ià(
h®dc_v”bo£
){

697 
	`HAL_INFO
(("´•robe: off£t=%08lx, size=%d", 
h—d”
.
fdi_ruËs_´•robe
,

698 
h—d”
.
fdi_ruËs_šfÜm©iÚ
 - h—d”.
fdi_ruËs_´•robe
));

699 
	`HAL_INFO
(("šfÜm©iÚ: off£t=%08lx, size=%d", 
h—d”
.
fdi_ruËs_šfÜm©iÚ
,

700 
h—d”
.
fdi_ruËs_pŞicy
 - h—d”.
fdi_ruËs_šfÜm©iÚ
));

701 
	`HAL_INFO
(("pŞicy: off£t=%08lx, size=%d", 
h—d”
.
fdi_ruËs_pŞicy
,

702 
h—d”
.
®l_ruËs_size
 - h—d”.
fdi_ruËs_pŞicy
));

703 
	`HAL_INFO
 (("G’”©šg„uË dÚ(occupyšg %d by‹s)", 
h—d”
.
®l_ruËs_size
));

706 
	`g_ä“
 (
ÿch’ame_‹mp
);

707  
num_sk³d_fdi_fes
;

708 
”rÜ
:

709 
	`HAL_ERROR
 (("Error generating fdi cache"));

710 ià(
fd
 >= 0)

711 
	`şo£
 (
fd
);

713 
	`uÆšk
 (
ÿch’ame_‹mp
);

714 
	`g_ä“
 (
ÿch’ame_‹mp
);

716 
	}
}

725 
	$u§ge
 ()

727 
	`årštf
 (
¡d”r
, "\n" "usage : hald-generate-fdi-cache [OPTION]\n");

728 
	`årštf
 (
¡d”r
,

738 
	}
}

741 
	$maš
(
¬gc
, * 
¬gv
[])

743 
num_sk³d_fdi_fes
;

744 
	`İ’log
 ("h®d", 
LOG_PID
, 
LOG_DAEMON
);

747 
c
;

748 
İtiÚ_šdex
 = 0;

749 cÚ¡ *
İt
;

750 
İtiÚ
 
lÚg_İtiÚs
[] = {

751 {"h–p", 0, 
NULL
, 0},

752 {"v”siÚ", 0, 
NULL
, 0},

753 {"v”bo£", 0, 
NULL
, 0},

754 {
NULL
, 0, NULL, 0}

757 
c
 = 
	`g‘İt_lÚg
 (
¬gc
, 
¬gv
, "",

758 
lÚg_İtiÚs
, &
İtiÚ_šdex
);

759 ià(
c
 == -1)

762 
c
) {

764 
İt
 = 
lÚg_İtiÚs
[
İtiÚ_šdex
].
Çme
;

766 ià(
	`¡rcmp
 (
İt
, "help") == 0) {

767 
	`u§ge
 ();

769 } ià(
	`¡rcmp
 (
İt
, "version") == 0) {

770 
	`årštf
 (
¡d”r
, "HAL…ackagv”siÚ: " 
PACKAGE_VERSION
 "\n");

772 } ià(
	`¡rcmp
 (
İt
, "verbose") == 0) {

773 
h®dc_v”bo£
 = 1;

778 
	`u§ge
 ();

784 
num_sk³d_fdi_fes
 = 
	`di_ruËs_š™
();

785 ià(
num_sk³d_fdi_fes
 == 0) {

788 } ià(
num_sk³d_fdi_fes
 == -1) {

793 
	`årštf
 (
¡d”r
, "Sk³d %d fd˜fes\n", 
num_sk³d_fdi_fes
);

796 
	}
}

	@hald/device.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dio.h
>

32 
	~<¡ršg.h
>

34 
	~"h®d.h
"

35 
	~"deviû.h
"

36 
	~"h®d_m¬sh®.h
"

37 
	~"logg”.h
"

38 
	~"h®d_ruÂ”.h
"

40 
GSLi¡
 *
	glocked_deviûs
 = 
NULL
;

43 
	$add_to_locked_£t
 (
H®Deviû
 *
deviû
)

45 ià(
	`g_¦i¡_fšd
 (
locked_deviûs
, 
deviû
è!ğ
NULL
)

48 
locked_deviûs
 = 
	`g_¦i¡_´•’d
 (locked_deviûs, 
deviû
);

49 
	}
}

53 
	$»move_äom_locked_£t
 (
H®Deviû
 *
deviû
)

55 
locked_deviûs
 = 
	`g_¦i¡_»move
 (locked_deviûs, 
deviû
);

56 
	}
}

58 
	s_H®Prİ”ty
 {

59 
	mty³
;

61 *
	m¡r_v®ue
;

62 
dbus_št32_t
 
	mšt_v®ue
;

63 
dbus_ušt64_t
 
	mušt64_v®ue
;

64 
dbus_boŞ_t
 
	mboŞ_v®ue
;

65 
	mdoubË_v®ue
;

66 
GSLi¡
 *
	m¡¾i¡_v®ue
;

67 } 
	mv
;

69 
_H®Prİ”ty
 
	tH®Prİ”ty
;

71 
šlše
 

72 
	$h®_´İ”ty_ä“
 (
H®Prİ”ty
 *
´İ
)

74 ià(
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_STRING
) {

75 
	`g_ä“
 (
´İ
->
v
.
¡r_v®ue
);

76 } ià(
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_STRLIST
) {

77 
GSLi¡
 *
i
;

78 
i
 = 
´İ
->
v
.
¡¾i¡_v®ue
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

79 
	`g_ä“
 (
i
->
d©a
);

81 
	`g_¦i¡_ä“
 (
´İ
->
v
.
¡¾i¡_v®ue
);

83 
	`g_¦iû_ä“
 (
H®Prİ”ty
, 
´İ
);

84 
	}
}

86 
šlše
 
H®Prİ”ty
 *

87 
	$h®_´İ”ty_Ãw
 (
ty³
)

89 
H®Prİ”ty
 *
´İ
;

90 
´İ
 = 
	`g_¦iû_Ãw0
 (
H®Prİ”ty
);

91 
´İ
->
ty³
 =ype;

92  
´İ
;

93 
	}
}

95 
šlše
 

96 
	$h®_´İ”ty_g‘_ty³
 (
H®Prİ”ty
 *
´İ
)

98 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, 
HAL_PROPERTY_TYPE_INVALID
);

99  
´İ
->
ty³
;

100 
	}
}

102 
šlše
 const *

103 
	$h®_´İ”ty_g‘_¡ršg
 (
H®Prİ”ty
 *
´İ
)

105 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, NULL);

106 
	`g_»tuº_v®_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_STRING
, 
NULL
);

107  
´İ
->
v
.
¡r_v®ue
;

108 
	}
}

110 
šlše
 
dbus_št32_t


111 
	$h®_´İ”ty_g‘_št
 (
H®Prİ”ty
 *
´İ
)

113 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, -1);

114 
	`g_»tuº_v®_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_INT32
, -1);

115  
´İ
->
v
.
št_v®ue
;

116 
	}
}

118 
šlše
 
dbus_ušt64_t


119 
	$h®_´İ”ty_g‘_ušt64
 (
H®Prİ”ty
 *
´İ
)

121 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, -1);

122 
	`g_»tuº_v®_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_UINT64
, -1);

123  
´İ
->
v
.
ušt64_v®ue
;

124 
	}
}

126 
šlše
 
dbus_boŞ_t


127 
	$h®_´İ”ty_g‘_boŞ
 (
H®Prİ”ty
 *
´İ
)

129 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, 
FALSE
);

130 
	`g_»tuº_v®_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_BOOLEAN
, 
FALSE
);

131  
´İ
->
v
.
boŞ_v®ue
;

132 
	}
}

134 
šlše
 
GSLi¡
 *

135 
	$h®_´İ”ty_g‘_¡¾i¡
 (
H®Prİ”ty
 *
´İ
)

137 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, NULL);

138 
	`g_»tuº_v®_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_STRLIST
, 
NULL
);

140  
´İ
->
v
.
¡¾i¡_v®ue
;

141 
	}
}

143 
šlše
 *

144 
	$h®_´İ”ty_to_¡ršg
 (
H®Prİ”ty
 *
´İ
)

146 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, NULL);

148 
´İ
->
ty³
) {

149 
HAL_PROPERTY_TYPE_STRING
:

150  
	`g_¡rdup
 (
´İ
->
v
.
¡r_v®ue
);

151 
HAL_PROPERTY_TYPE_INT32
:

152  
	`g_¡rdup_´štf
 ("%d", 
´İ
->
v
.
št_v®ue
);

153 
HAL_PROPERTY_TYPE_UINT64
:

154  
	`g_¡rdup_´štf
 ("%Îu", (è
´İ
->
v
.
ušt64_v®ue
);

155 
HAL_PROPERTY_TYPE_BOOLEAN
:

157  
	`g_¡rdup
 (
´İ
->
v
.
boŞ_v®ue
 ? "true" : "false");

158 
HAL_PROPERTY_TYPE_DOUBLE
:

159  
	`g_¡rdup_´štf
 ("%f", 
´İ
->
v
.
doubË_v®ue
);

160 
HAL_PROPERTY_TYPE_STRLIST
:

162 
GSLi¡
 *
™”
;

163 
GSŒšg
 *
buf
;

165 
buf
 = 
	`g_¡ršg_Ãw
 ("");

167 
™”
 = 
	`h®_´İ”ty_g‘_¡¾i¡
 (
´İ
); i‹¸!ğ
NULL
;

168 
™”
 = 
	`g_¦i¡_Ãxt
 (iter)) {

169 
	`g_¡ršg_­³nd
 (
buf
, (cÚ¡ *è
™”
->
d©a
);

171 ià(
	`g_¦i¡_Ãxt
 (
™”
è!ğ
NULL
) {

172 
	`g_¡ršg_­³nd_c
(
buf
, '\t');

175  
	`g_¡ršg_ä“
 (
buf
, 
FALSE
);

179  
NULL
;

181 
	}
}

183 
šlše
 

184 
	$h®_´İ”ty_g‘_doubË
 (
H®Prİ”ty
 *
´İ
)

186 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, -1.0);

187 
	`g_»tuº_v®_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_DOUBLE
, -1.0);

189  
´İ
->
v
.
doubË_v®ue
;

190 
	}
}

192 
šlše
 

193 
	$h®_´İ”ty_£t_¡ršg
 (
H®Prİ”ty
 *
´İ
, cÚ¡ *
v®ue
)

195 *
’dch¬
;

196 
gboŞ—n
 
v®id©ed
 = 
TRUE
;

198 
	`g_»tuº_if_ç
 (
´İ
 !ğ
NULL
);

199 
	`g_»tuº_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_STRING
 ||

200 
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_INVALID
);

202 
´İ
->
ty³
 = 
HAL_PROPERTY_TYPE_STRING
;

203 ià(
´İ
->
v
.
¡r_v®ue
 !ğ
NULL
)

204 
	`g_ä“
 (
´İ
->
v
.
¡r_v®ue
);

205 
´İ
->
v
.
¡r_v®ue
 = 
	`g_¡rdup
 (
v®ue
 !ğ
NULL
 ? value : "");

207 !
	`g_utf8_v®id©e
 (
´İ
->
v
.
¡r_v®ue
, -1,

208 (cÚ¡ **è&
’dch¬
)) {

209 
v®id©ed
 = 
FALSE
;

210 *
’dch¬
 = '?';

213 ià(!
v®id©ed
) {

214 
	`HAL_WARNING
 (("Property has invalid UTF-8 string '%s', it was changedo: '%s'",

215 
v®ue
, 
´İ
->
v
.
¡r_v®ue
));

217 
	}
}

219 
šlše
 

220 
	$h®_´İ”ty_£t_št
 (
H®Prİ”ty
 *
´İ
, 
dbus_št32_t
 
v®ue
)

222 
	`g_»tuº_if_ç
 (
´İ
 !ğ
NULL
);

223 
	`g_»tuº_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_INT32
 ||

224 
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_INVALID
);

225 
´İ
->
ty³
 = 
HAL_PROPERTY_TYPE_INT32
;

226 
´İ
->
v
.
št_v®ue
 = 
v®ue
;

227 
	}
}

229 
šlše
 

230 
	$h®_´İ”ty_£t_ušt64
 (
H®Prİ”ty
 *
´İ
, 
dbus_ušt64_t
 
v®ue
)

232 
	`g_»tuº_if_ç
 (
´İ
 !ğ
NULL
);

233 
	`g_»tuº_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_UINT64
 ||

234 
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_INVALID
);

235 
´İ
->
ty³
 = 
HAL_PROPERTY_TYPE_UINT64
;

236 
´İ
->
v
.
ušt64_v®ue
 = 
v®ue
;

237 
	}
}

239 
šlše
 

240 
	$h®_´İ”ty_£t_boŞ
 (
H®Prİ”ty
 *
´İ
, 
dbus_boŞ_t
 
v®ue
)

242 
	`g_»tuº_if_ç
 (
´İ
 !ğ
NULL
);

243 
	`g_»tuº_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_BOOLEAN
 ||

244 
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_INVALID
);

245 
´İ
->
ty³
 = 
HAL_PROPERTY_TYPE_BOOLEAN
;

246 
´İ
->
v
.
boŞ_v®ue
 = 
v®ue
;

247 
	}
}

249 
šlše
 

250 
	$h®_´İ”ty_£t_doubË
 (
H®Prİ”ty
 *
´İ
, 
v®ue
)

252 
	`g_»tuº_if_ç
 (
´İ
 !ğ
NULL
);

253 
	`g_»tuº_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_DOUBLE
 ||

254 
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_INVALID
);

255 
´İ
->
ty³
 = 
HAL_PROPERTY_TYPE_DOUBLE
;

256 
´İ
->
v
.
doubË_v®ue
 = 
v®ue
;

257 
	}
}

259 
šlše
 
gboŞ—n


260 
	$h®_´İ”ty_¡¾i¡_­³nd
 (
H®Prİ”ty
 *
´İ
, cÚ¡ *
v®ue
)

262 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, 
FALSE
);

263 
	`g_»tuº_v®_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_STRLIST
, 
FALSE
);

265 
´İ
->
v
.
¡¾i¡_v®ue
 = 
	`g_¦i¡_­³nd
 (´İ->v.¡¾i¡_v®ue, 
	`g_¡rdup
 (
v®ue
));

267  
TRUE
;

268 
	}
}

270 
šlše
 
gboŞ—n


271 
	$h®_´İ”ty_¡¾i¡_´•’d
 (
H®Prİ”ty
 *
´İ
, cÚ¡ *
v®ue
)

273 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, 
FALSE
);

274 
	`g_»tuº_v®_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_STRLIST
, 
FALSE
);

276 
´İ
->
v
.
¡¾i¡_v®ue
 = 
	`g_¦i¡_´•’d
 (´İ->v.¡¾i¡_v®ue, 
	`g_¡rdup
 (
v®ue
));

278  
TRUE
;

279 
	}
}

281 
šlše
 
gboŞ—n


282 
	$h®_´İ”ty_¡¾i¡_»move_–em
 (
H®Prİ”ty
 *
´İ
, 
gušt
 
šdex
)

284 
GSLi¡
 *
–em
;

286 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, 
FALSE
);

287 
	`g_»tuº_v®_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_STRLIST
, 
FALSE
);

289 ià(
´İ
->
v
.
¡¾i¡_v®ue
 =ğ
NULL
)

290  
FALSE
;

292 
–em
 = 
	`g_¦i¡_Áh
 (
´İ
->
v
.
¡¾i¡_v®ue
, 
šdex
);

293 ià(
–em
 =ğ
NULL
)

294  
FALSE
;

296 
	`g_ä“
 (
–em
->
d©a
);

297 
´İ
->
v
.
¡¾i¡_v®ue
 = 
	`g_¦i¡_d–‘e_lšk
 (´İ->v.¡¾i¡_v®ue, 
–em
);

298  
TRUE
;

299 
	}
}

302 
šlše
 
gboŞ—n


303 
	$h®_´İ”ty_¡¾i¡_add
 (
H®Prİ”ty
 *
´İ
, cÚ¡ *
v®ue
)

305 
GSLi¡
 *
–em
;

307 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, 
FALSE
);

308 
	`g_»tuº_v®_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_STRLIST
, 
FALSE
);

310 
–em
 = 
´İ
->
v
.
¡¾i¡_v®ue
;ƒËm !ğ
NULL
;ƒËm = 
	`g_¦i¡_Ãxt
 (elem)) {

311 ià(
	`¡rcmp
 (
–em
->
d©a
, 
v®ue
) == 0) {

312  
FALSE
;

316  
	`h®_´İ”ty_¡¾i¡_­³nd
 (
´İ
, 
v®ue
);

317 
	}
}

319 
šlše
 
gboŞ—n


320 
	$h®_´İ”ty_¡¾i¡_»move
 (
H®Prİ”ty
 *
´İ
, cÚ¡ *
v®ue
)

322 
gušt
 
i
;

323 
GSLi¡
 *
–em
;

325 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, 
FALSE
);

326 
	`g_»tuº_v®_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_STRLIST
, 
FALSE
);

328 
–em
 = 
´İ
->
v
.
¡¾i¡_v®ue
, 
i
 = 0;ƒËm !ğ
NULL
;ƒËm = 
	`g_¦i¡_Ãxt
 (elem), i++) {

329 ià(
	`¡rcmp
 (
–em
->
d©a
, 
v®ue
) == 0) {

330  
	`h®_´İ”ty_¡¾i¡_»move_–em
 (
´İ
, 
i
);

334  
FALSE
;

335 
	}
}

337 
šlše
 
gboŞ—n


338 
	$h®_´İ”ty_¡¾i¡_ş—r
 (
H®Prİ”ty
 *
´İ
)

340 
GSLi¡
 *
–em
;

342 
	`g_»tuº_v®_if_ç
 (
´İ
 !ğ
NULL
, 
FALSE
);

343 
	`g_»tuº_v®_if_ç
 (
´İ
->
ty³
 =ğ
HAL_PROPERTY_TYPE_STRLIST
, 
FALSE
);

345 
–em
 = 
´İ
->
v
.
¡¾i¡_v®ue
;ƒËm !ğ
NULL
;ƒËm = 
	`g_¦i¡_Ãxt
 (elem)) {

346 
	`g_ä“
 (
–em
->
d©a
);

348 
	`g_¦i¡_ä“
 (
´İ
->
v
.
¡¾i¡_v®ue
);

350  
TRUE
;

351 
	}
}

357 
GObjeùCÏss
 *
	g·»Á_şass
;

359 
	s_H®DeviûPriv©e


361 *
	mudi
;

362 
	mnum_addÚs
;

363 
	mnum_addÚs_»ady
;

365 
GHashTabË
 *
	m´İs
;

369 
	mPROPERTY_CHANGED
,

370 
	mCAPABILITY_ADDED
,

371 
	mLOCK_ACQUIRED
,

372 
	mLOCK_RELEASED
,

373 
	mPRE_PROPERTY_CHANGED
,

374 
	mLAST_SIGNAL


377 
gušt
 
	gsigÇls
[
LAST_SIGNAL
] = { 0 };

379 #ifdeà
HALD_MEMLEAK_DBG


380 
	gdbg_h®_deviû_objeù_d–
 = 0;

384 
	$h®_deviû_fš®ize
 (
GObjeù
 *
obj
)

386 
H®Deviû
 *
deviû
 = 
	`HAL_DEVICE
 (
obj
);

388 
	`ruÂ”_deviû_fš®ized
 (
deviû
);

390 
	`»move_äom_locked_£t
 (
deviû
);

392 #ifdeà
HALD_MEMLEAK_DBG


393 
dbg_h®_deviû_objeù_d–
--;

394 
	`´štf
 ("************* iÀfš®izfÜ udi=%s\n", 
deviû
->
´iv©e
->
udi
);

397 
	`g_ä“
 (
deviû
->
´iv©e
->
udi
);

399 
	`g_hash_bË_de¡roy
 (
deviû
->
´iv©e
->
´İs
);

401 
	`g_ä“
 (
deviû
->
´iv©e
);

403 ià(
·»Á_şass
->
fš®ize
)

404 
·»Á_şass
->
	`fš®ize
 (
obj
);

405 
	}
}

408 
	$h®_deviû_şass_š™
 (
H®DeviûCÏss
 *
kÏss
)

410 
GObjeùCÏss
 *
obj_şass
 = (GObjeùCÏs *è
kÏss
;

412 
·»Á_şass
 = 
	`g_ty³_şass_³ek_·»Á
 (
kÏss
);

414 
obj_şass
->
fš®ize
 = 
h®_deviû_fš®ize
;

416 
sigÇls
[
PROPERTY_CHANGED
] =

417 
	`g_sigÇl_Ãw
 ("property_changed",

418 
	`G_TYPE_FROM_CLASS
 (
kÏss
),

419 
G_SIGNAL_RUN_LAST
,

420 
	`G_STRUCT_OFFSET
 (
H®DeviûCÏss
,

421 
´İ”ty_chªged
),

422 
NULL
, NULL,

423 
h®d_m¬sh®_VOID__STRING_BOOL_BOOL
,

424 
G_TYPE_NONE
, 3,

425 
G_TYPE_STRING
,

426 
G_TYPE_BOOLEAN
,

427 
G_TYPE_BOOLEAN
);

429 
sigÇls
[
PRE_PROPERTY_CHANGED
] =

430 
	`g_sigÇl_Ãw
 ("pre_property_changed",

431 
	`G_TYPE_FROM_CLASS
 (
kÏss
),

432 
G_SIGNAL_RUN_LAST
,

433 
	`G_STRUCT_OFFSET
 (
H®DeviûCÏss
,

434 
´İ”ty_chªged
),

435 
NULL
, NULL,

436 
h®d_m¬sh®_VOID__STRING_BOOL
,

437 
G_TYPE_NONE
, 2,

438 
G_TYPE_STRING
,

439 
G_TYPE_BOOLEAN
);

442 
sigÇls
[
CAPABILITY_ADDED
] =

443 
	`g_sigÇl_Ãw
 ("capability_added",

444 
	`G_TYPE_FROM_CLASS
 (
kÏss
),

445 
G_SIGNAL_RUN_LAST
,

446 
	`G_STRUCT_OFFSET
 (
H®DeviûCÏss
,

447 
ÿ·b™y_added
),

448 
NULL
, NULL,

449 
h®d_m¬sh®_VOID__STRING
,

450 
G_TYPE_NONE
, 1,

451 
G_TYPE_STRING
);

453 
sigÇls
[
LOCK_ACQUIRED
] =

454 
	`g_sigÇl_Ãw
 ("lock_acquired",

455 
	`G_TYPE_FROM_CLASS
 (
kÏss
),

456 
G_SIGNAL_RUN_LAST
,

457 
	`G_STRUCT_OFFSET
 (
H®DeviûCÏss
,

458 
lock_acquœed
),

459 
NULL
, NULL,

460 
h®d_m¬sh®_VOID__STRING_STRING
,

461 
G_TYPE_NONE
, 2,

462 
G_TYPE_STRING
,

463 
G_TYPE_STRING
);

465 
sigÇls
[
LOCK_RELEASED
] =

466 
	`g_sigÇl_Ãw
 ("lock_released",

467 
	`G_TYPE_FROM_CLASS
 (
kÏss
),

468 
G_SIGNAL_RUN_LAST
,

469 
	`G_STRUCT_OFFSET
 (
H®DeviûCÏss
,

470 
lock_»Ëa£d
),

471 
NULL
, NULL,

472 
h®d_m¬sh®_VOID__STRING_STRING
,

473 
G_TYPE_NONE
, 2,

474 
G_TYPE_STRING
,

475 
G_TYPE_STRING
);

476 
	}
}

479 
	$h®_deviû_š™
 (
H®Deviû
 *
deviû
)

481 
‹mp_deviû_couÁ”
 = 0;

483 
deviû
->
´iv©e
 = 
	`g_Ãw0
 (
H®DeviûPriv©e
, 1);

485 
deviû
->
´iv©e
->
udi
 = 
	`g_¡rdup_´štf
 ("/org/freedesktop/Hal/devices/temp/%d",

486 
‹mp_deviû_couÁ”
++);

487 
deviû
->
´iv©e
->
num_addÚs
 = 0;

488 
deviû
->
´iv©e
->
num_addÚs_»ady
 = 0;

490 
deviû
->
´iv©e
->
´İs
 = 
	`g_hash_bË_Ãw_fuÎ
 (
g_dœeù_hash
,

491 
g_dœeù_equ®
,

492 
NULL
,

493 (
GDe¡royNÙify
è
h®_´İ”ty_ä“
);

494 
	}
}

496 
GTy³


497 
	$h®_deviû_g‘_ty³
 ()

499 
GTy³
 
ty³
 = 0;

501 ià(!
ty³
) {

502 
GTy³Info
 
ty³_šfo
 = {

503  (
H®DeviûCÏss
),

504 
NULL
, NULL,

505 (
GCÏssIn™Func
è
h®_deviû_şass_š™
,

506 
NULL
, NULL,

507  (
H®Deviû
),

509 (
GIn¡ªûIn™Func
è
h®_deviû_š™
,

510 
NULL


513 
ty³
 = 
	`g_ty³_»gi¡”_¡©ic
 (
G_TYPE_OBJECT
,

515 &
ty³_šfo
,

519  
ty³
;

520 
	}
}

523 
H®Deviû
 *

524 
	$h®_deviû_Ãw
 ()

526 
H®Deviû
 *
deviû
;

528 
deviû
 = 
	`g_objeù_Ãw
 (
HAL_TYPE_DEVICE
, 
NULL
, NULL);

530 #ifdeà
HALD_MEMLEAK_DBG


531 
dbg_h®_deviû_objeù_d–
++;

533  
deviû
;

534 
	}
}

536 
šlše
 
H®Prİ”ty
 *

537 
	$h®_deviû_´İ”ty_fšd
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
)

539 
GQu¬k
 
qu¬k
 = 
	`g_qu¬k_Œy_¡ršg
 (
key
);

541 
	`g_»tuº_v®_if_ç
 (
deviû
 !ğ
NULL
, NULL);

542 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, NULL);

544 ià(
qu¬k
)

545  
	`g_hash_bË_lookup
 (
deviû
->
´iv©e
->
´İs
, 
	`GINT_TO_POINTER
(
qu¬k
));

547  
NULL
;

548 
	}
}

552 
H®Deviû
 *
	mrg‘
;

553 cÚ¡ *
	msourû_Çme¥aû
;

554 cÚ¡ *
	mrg‘_Çme¥aû
;

555 
size_t
 
	msourû_ns_Ën
;

556 } 
	tm”ge_»wr™e_ud_t
;

559 
	$m”ge_deviû_»wr™e_cb
 (
H®Deviû
 *
sourû
,

560 cÚ¡ *
key
,

561 
gpoš‹r
 
u£r_d©a
)

563 
ty³
;

564 
m”ge_»wr™e_ud_t
 *
ud
;

565 
H®Prİ”ty
 *
p
;

566 
rg‘_ty³
;

567 
gch¬
 *
rg‘_key
;

569 
ud
 = (
m”ge_»wr™e_ud_t
 *è
u£r_d©a
;

572 ià(
	`¡ºcmp
(
key
, 
ud
->
sourû_Çme¥aû
, ud->
sourû_ns_Ën
) != 0)

573 
out
;

575 
rg‘_key
 = 
	`g_¡rdup_´štf
("%s%s", 
ud
->
rg‘_Çme¥aû
, 
key
 + ud->
sourû_ns_Ën
);

577 
ty³
 = 
	`h®_deviû_´İ”ty_g‘_ty³
 (
sourû
, 
key
);

579 
p
 = 
	`h®_deviû_´İ”ty_fšd
 (
sourû
, 
key
);

582 
rg‘_ty³
 = 
	`h®_deviû_´İ”ty_g‘_ty³
 (
ud
->
rg‘
, 
rg‘_key
);

583 ià(
rg‘_ty³
 !ğ
HAL_PROPERTY_TYPE_INVALID
 &&¬g‘_ty³ !ğ
ty³
) {

584 
	`h®_deviû_´İ”ty_»move
 (
ud
->
rg‘
, 
rg‘_key
);

587 
ty³
) {

588 
HAL_PROPERTY_TYPE_STRING
:

589 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
ud
->
rg‘
, 
rg‘_key
, 
	`h®_´İ”ty_g‘_¡ršg
 (
p
));

592 
HAL_PROPERTY_TYPE_INT32
:

593 
	`h®_deviû_´İ”ty_£t_št
 (
ud
->
rg‘
, 
rg‘_key
, 
	`h®_´İ”ty_g‘_št
 (
p
));

596 
HAL_PROPERTY_TYPE_UINT64
:

597 
	`h®_deviû_´İ”ty_£t_ušt64
 (
ud
->
rg‘
, 
rg‘_key
, 
	`h®_´İ”ty_g‘_ušt64
 (
p
));

600 
HAL_PROPERTY_TYPE_BOOLEAN
:

601 
	`h®_deviû_´İ”ty_£t_boŞ
 (
ud
->
rg‘
, 
rg‘_key
, 
	`h®_´İ”ty_g‘_boŞ
 (
p
));

604 
HAL_PROPERTY_TYPE_DOUBLE
:

605 
	`h®_deviû_´İ”ty_£t_doubË
 (
ud
->
rg‘
, 
rg‘_key
, 
	`h®_´İ”ty_g‘_doubË
 (
p
));

608 
HAL_PROPERTY_TYPE_STRLIST
:

610 
GSLi¡
 *
l
;

612 
	`h®_deviû_´İ”ty_¡¾i¡_ş—r
 (
ud
->
rg‘
, 
rg‘_key
, 
FALSE
);

613 
l
 = 
	`h®_´İ”ty_g‘_¡¾i¡
 (
p
);† !ğ
NULL
;† =†->
Ãxt
)

614 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
ud
->
rg‘
, 
rg‘_key
, 
l
->
d©a
, 
FALSE
);

619 
	`HAL_WARNING
 (("UnknowÀ´İ”tyy³ %d", 
ty³
));

623 
	`g_ä“
 (
rg‘_key
);

624 
out
:

626 
	}
}

640 
	$h®_deviû_m”ge_w™h_»wr™e
 (
H®Deviû
 *
rg‘
,

641 
H®Deviû
 *
sourû
,

642 cÚ¡ *
rg‘_Çme¥aû
,

643 cÚ¡ *
sourû_Çme¥aû
)

645 
m”ge_»wr™e_ud_t
 
ud
;

647 
ud
.
rg‘
 =arget;

648 
ud
.
sourû_Çme¥aû
 = source_namespace;

649 
ud
.
rg‘_Çme¥aû
 =arget_namespace;

650 
ud
.
sourû_ns_Ën
 = 
	`¡¾’
 (
sourû_Çme¥aû
);

655 
	`h®_deviû_´İ”ty_fÜ—ch
 (
sourû
, 
m”ge_deviû_»wr™e_cb
, &
ud
);

658 
	}
}

660 
šlše
 
GSLi¡
 *

661 
	$h®_deviû_´İ”ty_g‘_¡¾i¡
 (
H®Deviû
 *
deviû
,

662 cÚ¡ *
key
)

664 
H®Prİ”ty
 *
´İ
;

666 
	`g_»tuº_v®_if_ç
 (
deviû
 !ğ
NULL
, NULL);

667 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, NULL);

669 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

670 ià(
´İ
 !ğ
NULL
)

671  
	`h®_´İ”ty_g‘_¡¾i¡
 (
´İ
);

673  
NULL
;

674 
	}
}

676 
gušt


677 
	$h®_deviû_´İ”ty_g‘_¡¾i¡_Ëngth
 (
H®Deviû
 *
deviû
,

678 cÚ¡ *
key
)

680 
GSLi¡
 *
i
;

682 
i
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
deviû
, 
key
);

683 ià(
i
 !ğ
NULL
)

684  
	`g_¦i¡_Ëngth
 (
i
);

687 
	}
}

689 
gboŞ—n


690 
	$h®_deviû_´İ”ty_¡¾i¡_cÚšs
 (
H®Deviû
 *
deviû
,

691 cÚ¡ *
key
,

692 cÚ¡ *
v®ue
)

694 
GSLi¡
 *
i
;

695 
GSLi¡
 *
–ems
;

696 
gboŞ—n
 
»t
;

698 
»t
 = 
FALSE
;

700 
–ems
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
deviû
, 
key
);

701 
i
 = 
–ems
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

702 ià(
	`¡rcmp
 (
i
->
d©a
, 
v®ue
) == 0) {

703 
»t
 = 
TRUE
;

708  
»t
;

709 
	}
}

713 
	$h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
H®Deviû
 *
deviû
,

714 cÚ¡ *
key
,

715 
H®DeviûSŒLi¡I‹r
 *
™”
)

717 
H®Prİ”ty
 *
´İ
;

719 
	`g_»tuº_if_ç
 (
deviû
 !ğ
NULL
);

720 
	`g_»tuº_if_ç
 (
key
 !ğ
NULL
);

722 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

724 ià(
´İ
 !ğ
NULL
)

725 
™”
->
i
 = 
	`h®_´İ”ty_g‘_¡¾i¡
 (
´İ
);

727 
™”
->
i
 = 
NULL
;

728 
	}
}

731 
	$h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (
H®DeviûSŒLi¡I‹r
 *
™”
)

733 
	`g_»tuº_v®_if_ç
 (
™”
 !ğ
NULL
, NULL);

734 
	`g_»tuº_v®_if_ç
 (
™”
->
i
 !ğ
NULL
, NULL);

735  
™”
->
i
->
d©a
;

736 
	}
}

739 
	$h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (
H®DeviûSŒLi¡I‹r
 *
™”
)

741 
	`g_»tuº_if_ç
 (
™”
 !ğ
NULL
);

742 
	`g_»tuº_if_ç
 (
™”
->
i
 !ğ
NULL
);

743 
™”
->
i
 = 
	`g_¦i¡_Ãxt
 (iter->i);

744 
	}
}

746 
gboŞ—n


747 
	$h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (
H®DeviûSŒLi¡I‹r
 *
™”
)

749 
	`g_»tuº_v®_if_ç
 (
™”
 !ğ
NULL
, 
FALSE
);

750 ià(
™”
->
i
 =ğ
NULL
) {

751  
FALSE
;

753  
TRUE
;

755 
	}
}

758 
	$h®_deviû_´İ”ty_dup_¡¾i¡_as_¡rv
 (
H®Deviû
 *
deviû
,

759 cÚ¡ *
key
)

761 
gušt
 
j
;

762 
gušt
 
Ën
;

763 
gch¬
 **
¡rv
;

764 
GSLi¡
 *
i
;

766 
¡rv
 = 
NULL
;

768 
i
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
deviû
, 
key
);

769 ià(
i
 =ğ
NULL
)

770 
out
;

772 
Ën
 = 
	`g_¦i¡_Ëngth
 (
i
);

773 ià(
Ën
 == 0)

774 
out
;

776 
¡rv
 = 
	`g_Ãw
 (*, 
Ën
 + 1);

778 
j
 = 0; 
i
 !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i), j++) {

779 
¡rv
[
j
] = 
	`g_¡rdup
 ((cÚ¡ 
gch¬
 *è
i
->
d©a
);

781 
¡rv
[
j
] = 
NULL
;

783 
out
:

784  
¡rv
;

785 
	}
}

788 
	$h®_deviû_g‘_udi
 (
H®Deviû
 *
deviû
)

790  
deviû
->
´iv©e
->
udi
;

791 
	}
}

794 
	$h®_deviû_£t_udi
 (
H®Deviû
 *
deviû
, cÚ¡ *
udi
)

796 ià(
deviû
->
´iv©e
->
udi
 !ğ
NULL
)

797 
	`g_ä“
 (
deviû
->
´iv©e
->
udi
);

798 
deviû
->
´iv©e
->
udi
 = 
	`g_¡rdup
 (udi);

799 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
deviû
, "šfo.udi", 
udi
);

800 
	}
}

803 
	$h®_deviû_add_ÿ·b™y
 (
H®Deviû
 *
deviû
, cÚ¡ *
ÿ·b™y
)

805 ià(
	`h®_deviû_´İ”ty_¡¾i¡_add
 (
deviû
, "šfo.ÿ·b™›s", 
ÿ·b™y
))

806 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
CAPABILITY_ADDED
], 0, 
ÿ·b™y
);

807 
	}
}

809 
gboŞ—n


810 
	$h®_deviû_has_ÿ·b™y
 (
H®Deviû
 *
deviû
, cÚ¡ *
ÿ·b™y
)

812 
GSLi¡
 *
ÿps
;

813 
GSLi¡
 *
™”
;

814 
gboŞ—n
 
m©ched
 = 
FALSE
;

816 
ÿps
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
deviû
, "info.capabilities");

818 ià(
ÿps
 =ğ
NULL
)

819  
FALSE
;

821 
™”
 = 
ÿps
; i‹¸!ğ
NULL
; i‹¸ğ™”->
Ãxt
) {

822 ià(
	`¡rcmp
 (
™”
->
d©a
, 
ÿ·b™y
) == 0) {

823 
m©ched
 = 
TRUE
;

828  
m©ched
;

829 
	}
}

832 
	$h®_deviû_num_´İ”t›s
 (
H®Deviû
 *
deviû
)

834 
	`g_»tuº_v®_if_ç
 (
deviû
 !ğ
NULL
, -1);

836  
	`g_hash_bË_size
 (
deviû
->
´iv©e
->
´İs
);

837 
	}
}

839 
gboŞ—n


840 
	$h®_deviû_has_´İ”ty
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
)

842 
	`g_»tuº_v®_if_ç
 (
deviû
 !ğ
NULL
, 
FALSE
);

843 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, 
FALSE
);

845  
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
è!ğ
NULL
;

846 
	}
}

849 
	$h®_deviû_´İ”ty_to_¡ršg
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
)

851 
H®Prİ”ty
 *
´İ
;

853 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

854 ià(!
´İ
)

855  
NULL
;

857  
	`h®_´İ”ty_to_¡ršg
 (
´İ
);

858 
	}
}

862 
H®Deviû
 *
	mdeviû
;

863 
H®DeviûPrİ”tyFÜ—chFn
 
	mÿÎback
;

864 
gpoš‹r
 
	mu£r_d©a
;

865 } 
	thdpã_ud_t
;

868 
	$hdpã
 (
gpoš‹r
 
key
,

869 
gpoš‹r
 
v®ue
,

870 
gpoš‹r
 
u£r_d©a
)

872 
hdpã_ud_t
 *
c
;

873 
H®Prİ”ty
 *
´İ
;

874 cÚ¡ 
gch¬
 *
key_¡ršg
 = 
	`g_qu¬k_to_¡ršg
 ((
GQu¬k
è
	`GPOINTER_TO_UINT
(
key
));

876 
c
 = (
hdpã_ud_t
 *è
u£r_d©a
;

877 
´İ
 = (
H®Prİ”ty
 *è
v®ue
;

879 
c
->
	`ÿÎback
 (c->
deviû
, 
key_¡ršg
, c->
u£r_d©a
);

880 
	}
}

883 
	$h®_deviû_´İ”ty_fÜ—ch
 (
H®Deviû
 *
deviû
,

884 
H®DeviûPrİ”tyFÜ—chFn
 
ÿÎback
,

885 
gpoš‹r
 
u£r_d©a
)

887 
hdpã_ud_t
 
c
;

889 
	`g_»tuº_if_ç
 (
deviû
 !ğ
NULL
);

890 
	`g_»tuº_if_ç
 (
ÿÎback
 !ğ
NULL
);

892 
c
.
deviû
 = device;

893 
c
.
ÿÎback
 = callback;

894 
c
.
u£r_d©a
 = user_data;

896 
	`g_hash_bË_fÜ—ch
 (
deviû
->
´iv©e
->
´İs
, 
hdpã
, &
c
);

897 
	}
}

900 
	$h®_deviû_´İ”ty_g‘_ty³
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
)

902 
H®Prİ”ty
 *
´İ
;

904 
	`g_»tuº_v®_if_ç
 (
deviû
 !ğ
NULL
, 
HAL_PROPERTY_TYPE_INVALID
);

905 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, 
HAL_PROPERTY_TYPE_INVALID
);

907 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

909 ià(
´İ
 !ğ
NULL
)

910  
	`h®_´İ”ty_g‘_ty³
 (
´İ
);

912  
HAL_PROPERTY_TYPE_INVALID
;

913 
	}
}

916 
	$h®_deviû_´İ”ty_g‘_¡ršg
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
)

918 
H®Prİ”ty
 *
´İ
;

920 
	`g_»tuº_v®_if_ç
 (
deviû
 !ğ
NULL
, NULL);

921 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, NULL);

923 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

925 ià(
´İ
 !ğ
NULL
)

926  
	`h®_´İ”ty_g‘_¡ršg
 (
´İ
);

928  
NULL
;

929 
	}
}

932 
	$h®_deviû_´İ”ty_g‘_as_¡ršg
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
, *
buf
, 
size_t
 
bufsize
)

934 
H®Prİ”ty
 *
´İ
;

936 
	`g_»tuº_v®_if_ç
 (
deviû
 !ğ
NULL
, NULL);

937 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, NULL);

938 
	`g_»tuº_v®_if_ç
 (
buf
 !ğ
NULL
, NULL);

940 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

942 ià(
´İ
 !ğ
NULL
) {

943 
	`h®_´İ”ty_g‘_ty³
 (
´İ
)) {

944 
HAL_PROPERTY_TYPE_STRING
:

945 
	`¡ºıy
 (
buf
, 
	`h®_´İ”ty_g‘_¡ršg
 (
´İ
), 
bufsize
);

947 
HAL_PROPERTY_TYPE_INT32
:

948 
	`¢´štf
 (
buf
, 
bufsize
, "%d", 
	`h®_´İ”ty_g‘_št
 (
´İ
));

950 
HAL_PROPERTY_TYPE_UINT64
:

951 
	`¢´štf
 (
buf
, 
bufsize
, "%Îu", (è
	`h®_´İ”ty_g‘_ušt64
 (
´İ
));

953 
HAL_PROPERTY_TYPE_DOUBLE
:

954 
	`¢´štf
 (
buf
, 
bufsize
, "%f", 
	`h®_´İ”ty_g‘_doubË
 (
´İ
));

956 
HAL_PROPERTY_TYPE_BOOLEAN
:

957 
	`¡ºıy
 (
buf
, 
	`h®_´İ”ty_g‘_boŞ
 (
´İ
è? "Œue" : "çl£", 
bufsize
);

960 
HAL_PROPERTY_TYPE_STRLIST
:

963 
GSLi¡
 *
™”
;

964 
gušt
 
i
;

966 ià(
bufsize
 > 0)

967 
buf
[0] = '\t';

968 
i
 = 1;

969 
™”
 = 
	`h®_´İ”ty_g‘_¡¾i¡
 (
´İ
);

970 
™”
 !ğ
NULL
 && 
i
 < 
bufsize
;

971 
™”
 = 
	`g_¦i¡_Ãxt
 (iter)) {

972 
gušt
 
Ën
;

973 cÚ¡ *
¡r
;

975 
¡r
 = (cÚ¡ *è
™”
->
d©a
;

976 
Ën
 = 
	`¡¾’
 (
¡r
);

977 
	`¡ºıy
 (
buf
 + 
i
, 
¡r
, 
bufsize
 - i);

978 
i
 +ğ
Ën
;

980 ià(
i
 < 
bufsize
) {

981 
buf
[
i
] = '\t';

982 
i
++;

988  
buf
;

990 
buf
[0] = '\0';

991  
NULL
;

993 
	}
}

995 
dbus_št32_t


996 
	$h®_deviû_´İ”ty_g‘_št
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
)

998 
H®Prİ”ty
 *
´İ
;

1000 
	`g_»tuº_v®_if_ç
 (
deviû
 !ğ
NULL
, -1);

1001 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, -1);

1003 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1005 ià(
´İ
 !ğ
NULL
)

1006  
	`h®_´İ”ty_g‘_št
 (
´İ
);

1009 
	}
}

1011 
dbus_ušt64_t


1012 
	$h®_deviû_´İ”ty_g‘_ušt64
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
)

1014 
H®Prİ”ty
 *
´İ
;

1016 
	`g_»tuº_v®_if_ç
 (
deviû
 !ğ
NULL
, -1);

1017 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, -1);

1019 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1021 ià(
´İ
 !ğ
NULL
)

1022  
	`h®_´İ”ty_g‘_ušt64
 (
´İ
);

1025 
	}
}

1027 
dbus_boŞ_t


1028 
	$h®_deviû_´İ”ty_g‘_boŞ
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
)

1030 
H®Prİ”ty
 *
´İ
;

1032 
	`g_»tuº_v®_if_ç
 (
deviû
 !ğ
NULL
, 
FALSE
);

1033 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, 
FALSE
);

1035 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1037 ià(
´İ
 !ğ
NULL
)

1038  
	`h®_´İ”ty_g‘_boŞ
 (
´İ
);

1040  
FALSE
;

1041 
	}
}

1044 
	$h®_deviû_´İ”ty_g‘_doubË
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
)

1046 
H®Prİ”ty
 *
´İ
;

1048 
	`g_»tuº_v®_if_ç
 (
deviû
 !ğ
NULL
, -1.0);

1049 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, -1.0);

1051 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1053 ià(
´İ
 !ğ
NULL
)

1054  
	`h®_´İ”ty_g‘_doubË
 (
´İ
);

1057 
	}
}

1059 
gboŞ—n


1060 
	$h®_deviû_´İ”ty_£t_¡ršg
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
,

1061 cÚ¡ *
v®ue
)

1063 
H®Prİ”ty
 *
´İ
;

1066 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1068 ià(
´İ
 !ğ
NULL
) {

1069 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_STRING
)

1070  
FALSE
;

1073 ià(
	`¡rcmp
 (
	`h®_´İ”ty_g‘_¡ršg
 (
´İ
), 
v®ue
 !ğ
NULL
 ? value : "") == 0)

1074  
TRUE
;

1076 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PRE_PROPERTY_CHANGED
], 0,

1077 
key
, 
FALSE
);

1079 
	`h®_´İ”ty_£t_¡ršg
 (
´İ
, 
v®ue
);

1081 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1082 
key
, 
FALSE
, FALSE);

1085 
´İ
 = 
	`h®_´İ”ty_Ãw
 (
HAL_PROPERTY_TYPE_STRING
);

1086 
	`h®_´İ”ty_£t_¡ršg
 (
´İ
, 
v®ue
);

1088 
	`g_hash_bË_š£¹
 (
deviû
->
´iv©e
->
´İs
,

1089 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
 (
key
)), 
´İ
);

1091 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1092 
key
, 
FALSE
, 
TRUE
);

1095  
TRUE
;

1096 
	}
}

1098 
gboŞ—n


1099 
	$h®_deviû_´İ”ty_£t_št
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
,

1100 
dbus_št32_t
 
v®ue
)

1102 
H®Prİ”ty
 *
´İ
;

1105 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1107 ià(
´İ
 !ğ
NULL
) {

1108 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_INT32
)

1109  
FALSE
;

1112 ià(
	`h®_´İ”ty_g‘_št
 (
´İ
è=ğ
v®ue
)

1113  
TRUE
;

1115 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PRE_PROPERTY_CHANGED
], 0,

1116 
key
, 
FALSE
);

1118 
	`h®_´İ”ty_£t_št
 (
´İ
, 
v®ue
);

1120 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1121 
key
, 
FALSE
, FALSE);

1124 
´İ
 = 
	`h®_´İ”ty_Ãw
 (
HAL_PROPERTY_TYPE_INT32
);

1125 
	`h®_´İ”ty_£t_št
 (
´İ
, 
v®ue
);

1126 
	`g_hash_bË_š£¹
 (
deviû
->
´iv©e
->
´İs
,

1127 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
 (
key
)), 
´İ
);

1129 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1130 
key
, 
FALSE
, 
TRUE
);

1133  
TRUE
;

1134 
	}
}

1136 
gboŞ—n


1137 
	$h®_deviû_´İ”ty_£t_ušt64
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
,

1138 
dbus_ušt64_t
 
v®ue
)

1140 
H®Prİ”ty
 *
´İ
;

1143 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1145 ià(
´İ
 !ğ
NULL
) {

1146 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_UINT64
)

1147  
FALSE
;

1150 ià(
	`h®_´İ”ty_g‘_ušt64
 (
´İ
è=ğ
v®ue
)

1151  
TRUE
;

1153 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PRE_PROPERTY_CHANGED
], 0,

1154 
key
, 
FALSE
);

1156 
	`h®_´İ”ty_£t_ušt64
 (
´İ
, 
v®ue
);

1158 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1159 
key
, 
FALSE
, FALSE);

1162 
´İ
 = 
	`h®_´İ”ty_Ãw
 (
HAL_PROPERTY_TYPE_UINT64
);

1163 
	`h®_´İ”ty_£t_ušt64
 (
´İ
, 
v®ue
);

1164 
	`g_hash_bË_š£¹
 (
deviû
->
´iv©e
->
´İs
,

1165 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
 (
key
)), 
´İ
);

1167 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1168 
key
, 
FALSE
, 
TRUE
);

1171  
TRUE
;

1172 
	}
}

1174 
gboŞ—n


1175 
	$h®_deviû_´İ”ty_£t_boŞ
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
,

1176 
dbus_boŞ_t
 
v®ue
)

1178 
H®Prİ”ty
 *
´İ
;

1181 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1183 ià(
´İ
 !ğ
NULL
) {

1184 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_BOOLEAN
)

1185  
FALSE
;

1188 ià(
	`h®_´İ”ty_g‘_boŞ
 (
´İ
è=ğ
v®ue
)

1189  
TRUE
;

1191 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PRE_PROPERTY_CHANGED
], 0,

1192 
key
, 
FALSE
);

1194 
	`h®_´İ”ty_£t_boŞ
 (
´İ
, 
v®ue
);

1196 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1197 
key
, 
FALSE
, FALSE);

1200 
´İ
 = 
	`h®_´İ”ty_Ãw
 (
HAL_PROPERTY_TYPE_BOOLEAN
);

1201 
	`h®_´İ”ty_£t_boŞ
 (
´İ
, 
v®ue
);

1202 
	`g_hash_bË_š£¹
 (
deviû
->
´iv©e
->
´İs
,

1203 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
 (
key
)), 
´İ
);

1205 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1206 
key
, 
FALSE
, 
TRUE
);

1209  
TRUE
;

1210 
	}
}

1212 
gboŞ—n


1213 
	$h®_deviû_´İ”ty_£t_doubË
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
,

1214 
v®ue
)

1216 
H®Prİ”ty
 *
´İ
;

1219 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1221 ià(
´İ
 !ğ
NULL
) {

1222 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_DOUBLE
)

1223  
FALSE
;

1226 ià(
	`h®_´İ”ty_g‘_doubË
 (
´İ
è=ğ
v®ue
)

1227  
TRUE
;

1229 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PRE_PROPERTY_CHANGED
], 0,

1230 
key
, 
FALSE
);

1232 
	`h®_´İ”ty_£t_doubË
 (
´İ
, 
v®ue
);

1234 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1235 
key
, 
FALSE
, FALSE);

1238 
´İ
 = 
	`h®_´İ”ty_Ãw
 (
HAL_PROPERTY_TYPE_DOUBLE
);

1239 
	`h®_´İ”ty_£t_doubË
 (
´İ
, 
v®ue
);

1240 
	`g_hash_bË_š£¹
 (
deviû
->
´iv©e
->
´İs
,

1241 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
 (
key
)), 
´İ
);

1243 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1244 
key
, 
FALSE
, 
TRUE
);

1247  
TRUE
;

1248 
	}
}

1250 
gboŞ—n


1251 
	$h®_deviû_´İ”ty_£t_¡¾i¡
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
,

1252 
GSLi¡
 *
v®ue
)

1254 
H®Prİ”ty
 *
´İ
;

1255 
GSLi¡
 *
l
;

1258 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1260 ià(
´İ
 !ğ
NULL
) {

1261 
GSLi¡
 *
cu¼’t
;

1263 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_STRLIST
)

1264  
FALSE
;

1267 
cu¼’t
 = 
	`h®_´İ”ty_g‘_¡¾i¡
 (
´İ
);

1268 ià(
	`g_¦i¡_Ëngth
 (
v®ue
è=ğg_¦i¡_Ëngth (
cu¼’t
)) {

1269 
gboŞ—n
 
equ®
 = 
TRUE
;

1270 
l
 = 
v®ue
;† !ğ
NULL
;† =†->
Ãxt
, 
cu¼’t
 = current->next) {

1271 ià(
	`¡rcmp
 (
l
->
d©a
, 
cu¼’t
->data) != 0) {

1272 
equ®
 = 
FALSE
;

1276 ià(
equ®
è 
TRUE
;

1279 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PRE_PROPERTY_CHANGED
], 0,

1280 
key
, 
FALSE
);

1287 
	`g_hash_bË_»move
 (
deviû
->
´iv©e
->
´İs
, 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
(
key
)));

1288 
´İ
 = 
	`h®_´İ”ty_Ãw
 (
HAL_PROPERTY_TYPE_STRLIST
);

1289 
l
 = 
v®ue
 ;† !ğ
NULL
;† =†->
Ãxt
) {

1290 
	`h®_´İ”ty_¡¾i¡_­³nd
 (
´İ
, 
l
->
d©a
);

1292 
	`g_hash_bË_š£¹
 (
deviû
->
´iv©e
->
´İs
, 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
 (
key
)),

1293 
´İ
);

1295 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1296 
key
, 
FALSE
, FALSE);

1299 
´İ
 = 
	`h®_´İ”ty_Ãw
 (
HAL_PROPERTY_TYPE_STRLIST
);

1300 
l
 = 
v®ue
 ;† !ğ
NULL
;† =†->
Ãxt
) {

1301 
	`h®_´İ”ty_¡¾i¡_­³nd
 (
´İ
, 
l
->
d©a
);

1303 
	`g_hash_bË_š£¹
 (
deviû
->
´iv©e
->
´İs
, 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
 (
key
)),

1304 
´İ
);

1306 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1307 
key
, 
FALSE
, 
TRUE
);

1310  
TRUE
;

1311 
	}
}

1314 
gboŞ—n


1315 
	$h®_deviû_cİy_´İ”ty
 (
H®Deviû
 *
äom_deviû
, cÚ¡ *
äom
, H®Deviû *
to_deviû
, cÚ¡ *
to
)

1317 
gboŞ—n
 
rc
;

1319 
rc
 = 
FALSE
;

1321 ià(
	`h®_deviû_has_´İ”ty
 (
äom_deviû
, 
äom
)) {

1322 
	`h®_deviû_´İ”ty_g‘_ty³
 (
äom_deviû
, 
äom
)) {

1323 
HAL_PROPERTY_TYPE_STRING
:

1324 
rc
 = 
	`h®_deviû_´İ”ty_£t_¡ršg
 (

1325 
to_deviû
, 
to
, 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
äom_deviû
, 
äom
));

1327 
HAL_PROPERTY_TYPE_INT32
:

1328 
rc
 = 
	`h®_deviû_´İ”ty_£t_št
 (

1329 
to_deviû
, 
to
, 
	`h®_deviû_´İ”ty_g‘_št
 (
äom_deviû
, 
äom
));

1331 
HAL_PROPERTY_TYPE_UINT64
:

1332 
rc
 = 
	`h®_deviû_´İ”ty_£t_ušt64
 (

1333 
to_deviû
, 
to
, 
	`h®_deviû_´İ”ty_g‘_ušt64
 (
äom_deviû
, 
äom
));

1335 
HAL_PROPERTY_TYPE_BOOLEAN
:

1336 
rc
 = 
	`h®_deviû_´İ”ty_£t_boŞ
 (

1337 
to_deviû
, 
to
, 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
äom_deviû
, 
äom
));

1339 
HAL_PROPERTY_TYPE_DOUBLE
:

1340 
rc
 = 
	`h®_deviû_´İ”ty_£t_doubË
 (

1341 
to_deviû
, 
to
, 
	`h®_deviû_´İ”ty_g‘_doubË
 (
äom_deviû
, 
äom
));

1343 
HAL_PROPERTY_TYPE_STRLIST
:

1344 
rc
 = 
	`h®_deviû_´İ”ty_£t_¡¾i¡
(

1345 
to_deviû
, 
to
, 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
äom_deviû
, 
äom
));

1351  
rc
;

1352 
	}
}

1354 
gboŞ—n


1355 
	$h®_deviû_´İ”ty_»move
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
)

1357 
GQu¬k
 
qu¬k
 = 
	`g_qu¬k_Œy_¡ršg
 (
key
);

1358 ià(
qu¬k
 && 
	`g_hash_bË_lookup
 (
deviû
->
´iv©e
->
´İs
, 
	`GINT_TO_POINTER
(quark))) {

1359 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PRE_PROPERTY_CHANGED
], 0,

1360 
key
, 
TRUE
);

1362 ià(
	`g_hash_bË_»move
 (
deviû
->
´iv©e
->
´İs
,

1363 
	`GINT_TO_POINTER
(
qu¬k
))) {

1364 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1365 
key
, 
TRUE
, 
FALSE
);

1366  
TRUE
;

1369  
FALSE
;

1370 
	}
}

1373 
	$h®_deviû_´št_fÜ—ch_cb
 (
H®Deviû
 *
deviû
,

1374 cÚ¡ *
key
,

1375 
gpoš‹r
 
u£r_d©a
)

1377 
ty³
;

1378 
H®Prİ”ty
 *
p
;

1380 
p
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1381 ià(
p
 =ğ
NULL
) {

1382 
out
;

1385 
ty³
 = 
	`h®_´İ”ty_g‘_ty³
 (
p
);

1387 
ty³
) {

1388 
HAL_PROPERTY_TYPE_STRING
:

1389 
	`årštf
 (
¡d”r
, " % ğ'%s' (¡ršg)\n", 
key
,

1390 
	`h®_´İ”ty_g‘_¡ršg
 (
p
));

1393 
HAL_PROPERTY_TYPE_INT32
:

1394 
	`årštf
 (
¡d”r
, " % ğ%d 0x%x (št)\n", 
key
,

1395 
	`h®_´İ”ty_g‘_št
 (
p
),

1396 
	`h®_´İ”ty_g‘_št
 (
p
));

1399 
HAL_PROPERTY_TYPE_UINT64
:

1400 
	`årštf
 (
¡d”r
, " % ğ%Îu 0x%Îx (ušt64)\n", 
key
,

1401 (è
	`h®_´İ”ty_g‘_ušt64
 (
p
),

1402 (è
	`h®_´İ”ty_g‘_ušt64
 (
p
));

1405 
HAL_PROPERTY_TYPE_DOUBLE
:

1406 
	`årštf
 (
¡d”r
, " % ğ%g (doubË)\n", 
key
,

1407 
	`h®_´İ”ty_g‘_doubË
 (
p
));

1410 
HAL_PROPERTY_TYPE_BOOLEAN
:

1411 
	`årštf
 (
¡d”r
, " % ğ%  (boŞ)\n", 
key
,

1412 (
	`h®_´İ”ty_g‘_boŞ
 (
p
) ? "true" :

1419 
	`HAL_WARNING
 (("UnknowÀ´İ”tyy³ %d", 
ty³
));

1423 
out
:

1425 
	}
}

1428 
	$h®_deviû_´št
 (
H®Deviû
 *
deviû
)

1430 
	`årštf
 (
¡d”r
, "deviû ud˜ğ%s\n", 
	`h®_deviû_g‘_udi
 (
deviû
));

1431 
	`h®_deviû_´İ”ty_fÜ—ch
 (
deviû
, 
h®_deviû_´št_fÜ—ch_cb
, 
NULL
);

1432 
	`årštf
 (
¡d”r
, "\n");

1433 
	}
}

1436 
	$h®_deviû_´İ”ty_g‘_¡¾i¡_–em
 (
H®Deviû
 *
deviû
,

1437 cÚ¡ *
key
,

1438 
gušt
 
šdex
)

1440 
GSLi¡
 *
¡¾i¡
;

1441 
GSLi¡
 *
i
;

1443 
¡¾i¡
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
deviû
, 
key
);

1444 ià(
¡¾i¡
 =ğ
NULL
)

1445  
NULL
;

1447 
i
 = 
	`g_¦i¡_Áh
 (
¡¾i¡
, 
šdex
);

1448 ià(
i
 =ğ
NULL
)

1449  
NULL
;

1451  (cÚ¡ *è
i
->
d©a
;

1452 
	}
}

1454 
gboŞ—n


1455 
	$h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
H®Deviû
 *
deviû
,

1456 cÚ¡ *
key
,

1457 cÚ¡ *
v®ue
,

1458 
gboŞ—n
 
chªge£t
)

1460 
H®Prİ”ty
 *
´İ
;

1463 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1465 ià(
´İ
 !ğ
NULL
) {

1466 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_STRLIST
)

1467  
FALSE
;

1469 
	`h®_´İ”ty_¡¾i¡_­³nd
 (
´İ
, 
v®ue
);

1471 ià(!
chªge£t
)

1472 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1473 
key
, 
FALSE
, FALSE);

1476 
´İ
 = 
	`h®_´İ”ty_Ãw
 (
HAL_PROPERTY_TYPE_STRLIST
);

1477 
	`h®_´İ”ty_¡¾i¡_­³nd
 (
´İ
, 
v®ue
);

1479 
	`g_hash_bË_š£¹
 (
deviû
->
´iv©e
->
´İs
,

1480 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
 (
key
)), 
´İ
);

1482 ià(!
chªge£t
)

1483 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1484 
key
, 
FALSE
, 
TRUE
);

1487  
TRUE
;

1488 
	}
}

1490 
gboŞ—n


1491 
	$h®_deviû_´İ”ty_¡¾i¡_­³nd_fšish_chªge£t
 (
H®Deviû
 *
deviû
,

1492 cÚ¡ *
key
,

1493 
gboŞ—n
 
is_added
){

1495 
H®Prİ”ty
 *
´İ
;

1498 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1500 ià(
´İ
 !ğ
NULL
) {

1501 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_STRLIST
)

1502  
FALSE
;

1504 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1505 
key
, 
FALSE
, 
is_added
);

1508  
FALSE
;

1511  
TRUE
;

1512 
	}
}

1515 
gboŞ—n


1516 
	$h®_deviû_´İ”ty_¡¾i¡_´•’d
 (
H®Deviû
 *
deviû
,

1517 cÚ¡ *
key
,

1518 cÚ¡ *
v®ue
)

1520 
H®Prİ”ty
 *
´İ
;

1523 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1525 ià(
´İ
 !ğ
NULL
) {

1526 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_STRLIST
)

1527  
FALSE
;

1529 
	`h®_´İ”ty_¡¾i¡_´•’d
 (
´İ
, 
v®ue
);

1531 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1532 
key
, 
FALSE
, FALSE);

1535 
´İ
 = 
	`h®_´İ”ty_Ãw
 (
HAL_PROPERTY_TYPE_STRLIST
);

1536 
	`h®_´İ”ty_¡¾i¡_´•’d
 (
´İ
, 
v®ue
);

1538 
	`g_hash_bË_š£¹
 (
deviû
->
´iv©e
->
´İs
,

1539 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
 (
key
)), 
´İ
);

1541 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1542 
key
, 
FALSE
, 
TRUE
);

1545  
TRUE
;

1546 
	}
}

1548 
gboŞ—n


1549 
	$h®_deviû_´İ”ty_¡¾i¡_»move_–em
 (
H®Deviû
 *
deviû
,

1550 cÚ¡ *
key
,

1551 
gušt
 
šdex
)

1553 
H®Prİ”ty
 *
´İ
;

1556 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1558 ià(
´İ
 =ğ
NULL
)

1559  
FALSE
;

1561 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_STRLIST
)

1562  
FALSE
;

1564 ià(
	`h®_´İ”ty_¡¾i¡_»move_–em
 (
´İ
, 
šdex
)) {

1565 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1566 
key
, 
FALSE
, FALSE);

1567  
TRUE
;

1570  
FALSE
;

1571 
	}
}

1573 
gboŞ—n


1574 
	$h®_deviû_´İ”ty_¡¾i¡_ş—r
 (
H®Deviû
 *
deviû
,

1575 cÚ¡ *
key
,

1576 
gboŞ—n
 
chªge£t
)

1578 
H®Prİ”ty
 *
´İ
;

1581 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1583 ià(
´İ
 =ğ
NULL
) {

1584 
´İ
 = 
	`h®_´İ”ty_Ãw
 (
HAL_PROPERTY_TYPE_STRLIST
);

1585 
	`g_hash_bË_š£¹
 (
deviû
->
´iv©e
->
´İs
,

1586 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
 (
key
)), 
´İ
);

1588 ià(!
chªge£t
)

1589 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1590 
key
, 
FALSE
, 
TRUE
);

1591  
TRUE
;

1594 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_STRLIST
)

1595  
FALSE
;

1598 
	`g_hash_bË_»move
 (
deviû
->
´iv©e
->
´İs
, 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
(
key
)));

1599 
´İ
 = 
	`h®_´İ”ty_Ãw
 (
HAL_PROPERTY_TYPE_STRLIST
);

1600 
	`g_hash_bË_š£¹
 (
deviû
->
´iv©e
->
´İs
, 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
(
key
)), 
´İ
);

1602 ià(!
chªge£t
) {

1603 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1604 
key
, 
FALSE
, FALSE);

1607  
TRUE
;

1608 
	}
}

1611 
gboŞ—n


1612 
	$h®_deviû_´İ”ty_¡¾i¡_add
 (
H®Deviû
 *
deviû
,

1613 cÚ¡ *
key
,

1614 cÚ¡ *
v®ue
)

1616 
H®Prİ”ty
 *
´İ
;

1617 
gboŞ—n
 
»s
;

1619 
»s
 = 
FALSE
;

1622 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1624 ià(
´İ
 !ğ
NULL
) {

1625 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_STRLIST
)

1626 
out
;

1628 
»s
 = 
	`h®_´İ”ty_¡¾i¡_add
 (
´İ
, 
v®ue
);

1629 ià(
»s
) {

1630 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1631 
key
, 
FALSE
, FALSE);

1635 
´İ
 = 
	`h®_´İ”ty_Ãw
 (
HAL_PROPERTY_TYPE_STRLIST
);

1636 
	`h®_´İ”ty_¡¾i¡_´•’d
 (
´İ
, 
v®ue
);

1638 
	`g_hash_bË_š£¹
 (
deviû
->
´iv©e
->
´İs
,

1639 
	`GINT_TO_POINTER
(
	`g_qu¬k_äom_¡ršg
 (
key
)), 
´İ
);

1641 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1642 
key
, 
FALSE
, 
TRUE
);

1644 
»s
 = 
TRUE
;

1647 
out
:

1648  
»s
;

1649 
	}
}

1651 
gboŞ—n


1652 
	$h®_deviû_´İ”ty_¡¾i¡_»move
 (
H®Deviû
 *
deviû
,

1653 cÚ¡ *
key
,

1654 cÚ¡ *
v®ue
)

1656 
H®Prİ”ty
 *
´İ
;

1659 
´İ
 = 
	`h®_deviû_´İ”ty_fšd
 (
deviû
, 
key
);

1661 ià(
´İ
 =ğ
NULL
)

1662  
FALSE
;

1664 ià(
	`h®_´İ”ty_g‘_ty³
 (
´İ
è!ğ
HAL_PROPERTY_TYPE_STRLIST
)

1665  
FALSE
;

1667 ià(
	`h®_´İ”ty_¡¾i¡_»move
 (
´İ
, 
v®ue
)) {

1668 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
PROPERTY_CHANGED
], 0,

1669 
key
, 
FALSE
, FALSE);

1672  
TRUE
;

1673 
	}
}

1675 
gboŞ—n


1676 
	$h®_deviû_´İ”ty_¡¾i¡_is_em±y
 (
H®Deviû
 *
deviû
,

1677 cÚ¡ *
key
)

1679 
GSLi¡
 *
¡¾i¡
;

1681 iàĞ
	`h®_deviû_has_´İ”ty
 (
deviû
, 
key
)) {

1682 
¡¾i¡
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
deviû
, 
key
);

1683 ià(
¡¾i¡
 =ğ
NULL
 )

1684  
TRUE
;

1686 ià(
	`g_¦i¡_Ëngth
 (
¡¾i¡
) > 0)

1687  
FALSE
;

1689  
TRUE
;

1691  
FALSE
;

1692 
	}
}

1695 
	$h®_deviû_šc_num_addÚs
 (
H®Deviû
 *
deviû
)

1697 
deviû
->
´iv©e
->
num_addÚs
++;

1698 
	}
}

1700 
gboŞ—n


1701 
	$h®_deviû_šc_num_»ady_addÚs
 (
H®Deviû
 *
deviû
)

1703 ià(
	`h®_deviû_¬e_®l_addÚs_»ady
 (
deviû
)) {

1704 
	`HAL_ERROR
 (("In hal_device_inc_num_ready_addons for udi=%s but‡ll‡ddons‡re‡lready„eady!",

1705 
deviû
->
´iv©e
->
udi
));

1706  
FALSE
;

1709 
deviû
->
´iv©e
->
num_addÚs_»ady
++;

1710  
TRUE
;

1711 
	}
}

1713 
gboŞ—n


1714 
	$h®_deviû_¬e_®l_addÚs_»ady
 (
H®Deviû
 *
deviû
)

1716 ià(
deviû
->
´iv©e
->
num_addÚs_»ady
 =ğdeviû->´iv©e->
num_addÚs
) {

1717  
TRUE
;

1719  
FALSE
;

1721 
	}
}

1733 
gboŞ—n


1734 
	$h®_deviû_acquœe_lock
 (
H®Deviû
 *
deviû
, cÚ¡ *
lock_Çme
, 
gboŞ—n
 
exşusive
, cÚ¡ *
£nd”
)

1736 
gboŞ—n
 
»t
;

1737 
buf
[256];

1739 
»t
 = 
FALSE
;

1741 
	`g_¢´štf
 (
buf
,  (buf), "šfo.Çmed_locks.%s.exşusive", 
lock_Çme
);

1742 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
deviû
, 
buf
è=ğ
TRUE
) {

1744 
out
;

1746 
	`h®_deviû_´İ”ty_£t_boŞ
 (
deviû
, 
buf
, 
exşusive
);

1748 
	`g_¢´štf
 (
buf
,  (buf), "šfo.Çmed_locks.%s.dbus_Çme", 
lock_Çme
);

1749 ià(
exşusive
 && 
	`h®_deviû_has_´İ”ty
 (
deviû
, 
buf
)) {

1751 
out
;

1753 ià(
	`h®_deviû_´İ”ty_¡¾i¡_cÚšs
 (
deviû
, 
buf
, 
£nd”
)) {

1755 
out
;

1758 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
deviû
, 
buf
, 
£nd”
, 
FALSE
);

1759 
	`g_¢´štf
 (
buf
,  (buf), "šfo.Çmed_locks.%s.locked", 
lock_Çme
);

1760 
	`h®_deviû_´İ”ty_£t_boŞ
 (
deviû
, 
buf
, 
TRUE
);

1762 
	`h®_deviû_´İ”ty_¡¾i¡_add
 (
deviû
, "šfo.Çmed_locks", 
lock_Çme
);

1764 
	`add_to_locked_£t
 (
deviû
);

1766 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
LOCK_ACQUIRED
], 0, 
lock_Çme
, 
£nd”
);

1768 
»t
 = 
TRUE
;

1769 
out
:

1770  
»t
;

1771 
	}
}

1783 
gboŞ—n


1784 
	$h®_deviû_»Ëa£_lock
 (
H®Deviû
 *
deviû
, cÚ¡ *
lock_Çme
, cÚ¡ *
£nd”
)

1786 
gboŞ—n
 
»t
;

1787 
buf
[256];

1789 
»t
 = 
FALSE
;

1791 
	`HAL_INFO
 (("Removšg†ock '%s' from '%s'", 
lock_Çme
, 
£nd”
));

1793 
	`g_¢´štf
 (
buf
,  (buf), "šfo.Çmed_locks.%s.locked", 
lock_Çme
);

1794 ià(!
	`h®_deviû_´İ”ty_g‘_boŞ
 (
deviû
, 
buf
)) {

1796 
out
;

1799 
	`g_¢´štf
 (
buf
,  (buf), "šfo.Çmed_locks.%s.dbus_Çme", 
lock_Çme
);

1800 ià(!
	`h®_deviû_´İ”ty_¡¾i¡_cÚšs
 (
deviû
, 
buf
, 
£nd”
)) {

1802 
out
;

1805 ià(
	`h®_deviû_´İ”ty_g‘_¡¾i¡_Ëngth
 (
deviû
, 
buf
) == 1) {

1807 
	`g_¢´štf
 (
buf
,  (buf), "šfo.Çmed_locks.%s.exşusive", 
lock_Çme
);

1808 
	`h®_deviû_´İ”ty_»move
 (
deviû
, 
buf
);

1809 
	`g_¢´štf
 (
buf
,  (buf), "šfo.Çmed_locks.%s.locked", 
lock_Çme
);

1810 
	`h®_deviû_´İ”ty_»move
 (
deviû
, 
buf
);

1811 
	`g_¢´štf
 (
buf
,  (buf), "šfo.Çmed_locks.%s.dbus_Çme", 
lock_Çme
);

1812 
	`h®_deviû_´İ”ty_»move
 (
deviû
, 
buf
);

1814 ià(
	`h®_deviû_´İ”ty_g‘_¡¾i¡_Ëngth
 (
deviû
, "info.named_locks") == 1) {

1815 
	`h®_deviû_´İ”ty_»move
 (
deviû
, "info.named_locks");

1816 
	`»move_äom_locked_£t
 (
deviû
);

1818 
	`h®_deviû_´İ”ty_¡¾i¡_»move
 (
deviû
, "šfo.Çmed_locks", 
lock_Çme
);

1822 
	`h®_deviû_´İ”ty_¡¾i¡_»move
 (
deviû
, 
buf
, 
£nd”
);

1825 
	`g_sigÇl_em™
 (
deviû
, 
sigÇls
[
LOCK_RELEASED
], 0, 
lock_Çme
, 
£nd”
);

1827 
»t
 = 
TRUE
;

1829 
out
:

1830  
»t
;

1831 
	}
}

1845 
	$h®_deviû_g‘_lock_hŞd”s
 (
H®Deviû
 *
deviû
, cÚ¡ *
lock_Çme
)

1847 **
»t
;

1848 
buf
[256];

1850 
	`g_¢´štf
 (
buf
,  (buf), "šfo.Çmed_locks.%s.dbus_Çme", 
lock_Çme
);

1851 
»t
 = 
	`h®_deviû_´İ”ty_dup_¡¾i¡_as_¡rv
 (
deviû
, 
buf
);

1852  
»t
;

1853 
	}
}

1865 
	$h®_deviû_g‘_num_lock_hŞd”s
 (
H®Deviû
 *
deviû
, cÚ¡ *
lock_Çme
)

1867 
num
;

1868 **
hŞd”s
;

1870 
num
 = 0;

1871 
hŞd”s
 = 
	`h®_deviû_g‘_lock_hŞd”s
 (
deviû
, 
lock_Çme
);

1872 ià(
hŞd”s
 =ğ
NULL
)

1873 
out
;

1875 
num
 = 
	`g_¡rv_Ëngth
 (
hŞd”s
);

1876 
	`g_¡rä“v
 (
hŞd”s
);

1877 
out
:

1878  
num
;

1879 
	}
}

1890 
	$h®_deviû_ş›Á_discÚÃùed
 (cÚ¡ *
£nd”
)

1892 
GSLi¡
 *
i
;

1894 
	`HAL_INFO
 (("Removšg†ock äom '%s'", 
£nd”
));

1896 
i
 = 
locked_deviûs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

1897 
H®Deviû
 *
deviû
 = 
i
->
d©a
;

1898 **
locks
;

1899 
n
;

1901 
	`HAL_INFO
 (("Lookšg‡ˆud˜'%s'", 
deviû
->
´iv©e
->
udi
));

1903 
locks
 = 
	`h®_deviû_´İ”ty_dup_¡¾i¡_as_¡rv
 (
deviû
, "info.named_locks");

1904 ià(
locks
 !ğ
NULL
) {

1905 
n
 = 0; 
locks
[n] !ğ
NULL
;‚++) {

1906 *
lock_Çme
 = 
locks
[
n
];

1907 
	`HAL_INFO
 (("Lock '%s'", 
lock_Çme
));

1908 
	`h®_deviû_»Ëa£_lock
 (
deviû
, 
lock_Çme
, 
£nd”
);

1910 
	`g_¡rä“v
 (
locks
);

1913 
	}
}

1915 
gboŞ—n


1916 
	$h®_deviû_is_lock_exşusive
 (
H®Deviû
 *
deviû
, cÚ¡ *
lock_Çme
)

1918 
buf
[256];

1919 
	`g_¢´štf
 (
buf
,  (buf), "šfo.Çmed_locks.%s.exşusive", 
lock_Çme
);

1920  
	`h®_deviû_´İ”ty_g‘_boŞ
 (
deviû
, 
buf
);

1921 
	}
}

	@hald/device.h

27 #iâdeà
DEVICE_H


28 
	#DEVICE_H


	)

30 #iâdeà
DBUS_API_SUBJECT_TO_CHANGE


31 
	#DBUS_API_SUBJECT_TO_CHANGE


	)

34 
	~<glib-objeù.h
>

35 
	~<dbus/dbus.h
>

37 
	g_H®DeviûPriv©e
;

38 
_H®DeviûPriv©e
 
	tH®DeviûPriv©e
;

41 
_H®Deviû
 
	tH®Deviû
;

42 
_H®DeviûCÏss
 
	tH®DeviûCÏss
;

44 
	s_H®Deviû
 {

45 
GObjeù
 
	m·»Á
;

46 
H®DeviûPriv©e
 *
	m´iv©e
;

49 
	s_H®DeviûCÏss
 {

50 
GObjeùCÏss
 
	m·»Á_şass
;

53 (*
	m´İ”ty_chªged
è(
H®Deviû
 *
	mdeviû
,

54 cÚ¡ *
	mkey
,

55 
gboŞ—n
 
	m»moved
,

56 
gboŞ—n
 
	madded
);

58 (*
	mÿ·b™y_added
è(
H®Deviû
 *
	mdeviû
,

59 cÚ¡ *
	mÿ·b™y
);

61 (*
	mlock_acquœed
è(
H®Deviû
 *
	mdeviû
,

62 cÚ¡ *
	mlock_Çme
,

63 cÚ¡ *
	mlock_owÃr
);

65 (*
	mlock_»Ëa£d
è(
H®Deviû
 *
	mdeviû
,

66 cÚ¡ *
	mlock_Çme
,

67 cÚ¡ *
	mlock_owÃr
);

70 
	#HAL_TYPE_DEVICE
 (
	`h®_deviû_g‘_ty³
 ())

	)

71 
	#HAL_DEVICE
(
obj
è(
	`G_TYPE_CHECK_INSTANCE_CAST
 ((obj), \

72 
HAL_TYPE_DEVICE
, 
H®Deviû
))

	)

73 
	#HAL_DEVICE_CLASS
(
kÏss
è(
	`G_TYPE_CHECK_CLASS_CAST
 ((klass), \

74 
HAL_TYPE_DEVICE
, 
H®DeviûCÏss
))

	)

75 
	#HAL_IS_DEVICE
(
obj
è(
	`G_TYPE_CHECK_INSTANCE_TYPE
 ((obj), \

76 
HAL_TYPE_DEVICE
))

	)

77 
	#HAL_IS_DEVICE_CLASS
(
kÏss
è(
	`G_TYPE_CHECK_CLASS_TYPE
 ((klass), \

78 
HAL_TYPE_DEVICE
))

	)

80 
	#HAL_PROPERTY_TYPE_INVALID
 
DBUS_TYPE_INVALID


	)

81 
	#HAL_PROPERTY_TYPE_INT32
 
DBUS_TYPE_INT32


	)

82 
	#HAL_PROPERTY_TYPE_UINT64
 
DBUS_TYPE_UINT64


	)

83 
	#HAL_PROPERTY_TYPE_DOUBLE
 
DBUS_TYPE_DOUBLE


	)

84 
	#HAL_PROPERTY_TYPE_BOOLEAN
 
DBUS_TYPE_BOOLEAN


	)

85 
	#HAL_PROPERTY_TYPE_STRING
 
DBUS_TYPE_STRING


	)

86 
	#HAL_PROPERTY_TYPE_STRLIST
 ((è(
DBUS_TYPE_STRING
<<8)+('l'))

	)

90 
_H®DeviûSŒLi¡I‹r
 
	tH®DeviûSŒLi¡I‹r
;

91 
	s_H®DeviûSŒLi¡I‹r
 {

92 
GSLi¡
 *
	mi
;

96 (*
	tH®DeviûPrİ”tyFÜ—chFn
è(
	tH®Deviû
 *
	tdeviû
,

97 cÚ¡ *
	tkey
,

98 
	tgpoš‹r
 
	tu£r_d©a
);

100 
GTy³
 
	`h®_deviû_g‘_ty³
 ();

102 
H®Deviû
 *
	`h®_deviû_Ãw
 ();

104 
	`h®_deviû_m”ge_w™h_»wr™e
 (
H®Deviû
 *
rg‘
,

105 
H®Deviû
 *
sourû
,

106 cÚ¡ *
rg‘_Çme¥aû
,

107 cÚ¡ *
sourû_Çme¥aû
);

109 cÚ¡ *
	`h®_deviû_g‘_udi
 (
H®Deviû
 *
deviû
);

110 
	`h®_deviû_£t_udi
 (
H®Deviû
 *
deviû
,

111 cÚ¡ *
udi
);

113 
	`h®_deviû_add_ÿ·b™y
 (
H®Deviû
 *
deviû
,

114 cÚ¡ *
ÿ·b™y
);

115 
gboŞ—n
 
	`h®_deviû_has_ÿ·b™y
 (
H®Deviû
 *
deviû
,

116 cÚ¡ *
ÿ·b™y
);

118 
gboŞ—n
 
	`h®_deviû_has_´İ”ty
 (
H®Deviû
 *
deviû
,

119 cÚ¡ *
key
);

121 
	`h®_deviû_num_´İ”t›s
 (
H®Deviû
 *
deviû
);

122 * 
	`h®_deviû_´İ”ty_to_¡ršg
 (
H®Deviû
 *
deviû
,

123 cÚ¡ *
key
);

124 
	`h®_deviû_´İ”ty_fÜ—ch
 (
H®Deviû
 *
deviû
,

125 
H®DeviûPrİ”tyFÜ—chFn
 
ÿÎback
,

126 
gpoš‹r
 
u£r_d©a
);

128 
	`h®_deviû_´İ”ty_g‘_ty³
 (
H®Deviû
 *
deviû
,

129 cÚ¡ *
key
);

130 cÚ¡ *
	`h®_deviû_´İ”ty_g‘_as_¡ršg
 (
H®Deviû
 *
deviû
,

131 cÚ¡ *
key
,

132 *
buf
,

133 
size_t
 
bufsize
);

136 cÚ¡ *
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
H®Deviû
 *
deviû
,

137 cÚ¡ *
key
);

138 
dbus_št32_t
 
	`h®_deviû_´İ”ty_g‘_št
 (
H®Deviû
 *
deviû
,

139 cÚ¡ *
key
);

140 
dbus_ušt64_t
 
	`h®_deviû_´İ”ty_g‘_ušt64
 (
H®Deviû
 *
deviû
,

141 cÚ¡ *
key
);

142 
dbus_boŞ_t
 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
H®Deviû
 *
deviû
,

143 cÚ¡ *
key
);

144 
	`h®_deviû_´İ”ty_g‘_doubË
 (
H®Deviû
 *
deviû
,

145 cÚ¡ *
key
);

146 cÚ¡ *
	`h®_deviû_´İ”ty_g‘_¡¾i¡_–em
 (
H®Deviû
 *
deviû
,

147 cÚ¡ *
key
,

148 
gušt
 
šdex
);

149 
gušt
 
	`h®_deviû_´İ”ty_g‘_¡¾i¡_Ëngth
 (
H®Deviû
 *
deviû
,

150 cÚ¡ *
key
);

151 
gboŞ—n
 
	`h®_deviû_´İ”ty_¡¾i¡_cÚšs
 (
H®Deviû
 *
deviû
,

152 cÚ¡ *
key
,

153 cÚ¡ *
v®ue
);

154 **
	`h®_deviû_´İ”ty_dup_¡¾i¡_as_¡rv
 (
H®Deviû
 *
deviû
,

155 cÚ¡ *
key
);

157 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
H®Deviû
 *
deviû
,

158 cÚ¡ *
key
,

159 
H®DeviûSŒLi¡I‹r
 *
™”
);

160 cÚ¡ *
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (
H®DeviûSŒLi¡I‹r
 *
™”
);

161 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (
H®DeviûSŒLi¡I‹r
 *
™”
);

162 
gboŞ—n
 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (
H®DeviûSŒLi¡I‹r
 *
™”
);

166 
gboŞ—n
 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
H®Deviû
 *
deviû
,

167 cÚ¡ *
key
,

168 cÚ¡ *
v®ue
);

169 
gboŞ—n
 
	`h®_deviû_´İ”ty_£t_št
 (
H®Deviû
 *
deviû
,

170 cÚ¡ *
key
,

171 
dbus_št32_t
 
v®ue
);

172 
gboŞ—n
 
	`h®_deviû_´İ”ty_£t_ušt64
 (
H®Deviû
 *
deviû
,

173 cÚ¡ *
key
,

174 
dbus_ušt64_t
 
v®ue
);

175 
gboŞ—n
 
	`h®_deviû_´İ”ty_£t_boŞ
 (
H®Deviû
 *
deviû
,

176 cÚ¡ *
key
,

177 
dbus_boŞ_t
 
v®ue
);

178 
gboŞ—n
 
	`h®_deviû_´İ”ty_£t_doubË
 (
H®Deviû
 *
deviû
,

179 cÚ¡ *
key
,

180 
v®ue
);

181 
gboŞ—n
 
	`h®_deviû_´İ”ty_£t_¡¾i¡
 (
H®Deviû
 *
deviû
,

182 cÚ¡ *
key
,

183 
GSLi¡
 *
v®ue
);

184 
gboŞ—n
 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
H®Deviû
 *
deviû
,

185 cÚ¡ *
key
,

186 cÚ¡ *
v®ue
,

187 
gboŞ—n
 
chªge£t
);

188 
gboŞ—n
 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd_fšish_chªge£t
 (
H®Deviû
 *
deviû
,

189 cÚ¡ *
key
,

190 
gboŞ—n
 
is_added
);

191 
gboŞ—n
 
	`h®_deviû_´İ”ty_¡¾i¡_´•’d
 (
H®Deviû
 *
deviû
,

192 cÚ¡ *
key
,

193 cÚ¡ *
v®ue
);

194 
gboŞ—n
 
	`h®_deviû_´İ”ty_¡¾i¡_»move_–em
 (
H®Deviû
 *
deviû
,

195 cÚ¡ *
key
,

196 
gušt
 
šdex
);

197 
gboŞ—n
 
	`h®_deviû_´İ”ty_¡¾i¡_ş—r
 (
H®Deviû
 *
deviû
,

198 cÚ¡ *
key
,

199 
gboŞ—n
 
chªge£t
);

200 
gboŞ—n
 
	`h®_deviû_´İ”ty_¡¾i¡_add
 (
H®Deviû
 *
deviû
,

201 cÚ¡ *
key
,

202 cÚ¡ *
v®ue
);

203 
gboŞ—n
 
	`h®_deviû_´İ”ty_¡¾i¡_»move
 (
H®Deviû
 *
deviû
,

204 cÚ¡ *
key
,

205 cÚ¡ *
v®ue
);

206 
gboŞ—n
 
	`h®_deviû_´İ”ty_¡¾i¡_is_em±y
 (
H®Deviû
 *
deviû
,

207 cÚ¡ *
key
);

209 
gboŞ—n
 
	`h®_deviû_´İ”ty_»move
 (
H®Deviû
 *
deviû
,

210 cÚ¡ *
key
);

213 
	`h®_deviû_´št
 (
H®Deviû
 *
deviû
);

215 
gboŞ—n
 
	`h®_deviû_cİy_´İ”ty
 (
H®Deviû
 *
äom_deviû
,

216 cÚ¡ *
äom
,

217 
H®Deviû
 *
to_deviû
,

218 cÚ¡ *
to
);

220 
	`h®_deviû_šc_num_addÚs
 (
H®Deviû
 *
deviû
);

222 
gboŞ—n
 
	`h®_deviû_šc_num_»ady_addÚs
 (
H®Deviû
 *
deviû
);

224 
gboŞ—n
 
	`h®_deviû_¬e_®l_addÚs_»ady
 (
H®Deviû
 *
deviû
);

226 
gboŞ—n
 
	`h®_deviû_acquœe_lock
 (
H®Deviû
 *
deviû
, cÚ¡ *
lock_Çme
, gboŞ—À
exşusive
, cÚ¡ *
£nd”
);

228 
gboŞ—n
 
	`h®_deviû_»Ëa£_lock
 (
H®Deviû
 *
deviû
, cÚ¡ *
lock_Çme
, cÚ¡ *
£nd”
);

230 
gboŞ—n
 
	`h®_deviû_is_lock_exşusive
 (
H®Deviû
 *
deviû
, cÚ¡ *
lock_Çme
);

232 **
	`h®_deviû_g‘_lock_hŞd”s
 (
H®Deviû
 *
deviû
, cÚ¡ *
lock_Çme
);

234 
	`h®_deviû_g‘_num_lock_hŞd”s
 (
H®Deviû
 *
deviû
, cÚ¡ *
lock_Çme
);

237 
	`h®_deviû_ş›Á_discÚÃùed
 (cÚ¡ *
£nd”
);

	@hald/device_info.c

30 #ifdeà
HAVE_CONFIG_H


31 
	~<cÚfig.h
>

34 
	~<¡dio.h
>

35 
	~<¡dlib.h
>

36 
	~<¡ršg.h
>

37 
	~<dœ’t.h
>

38 
	~<uni¡d.h
>

39 
	~<ex·t.h
>

40 
	~<as£¹.h
>

41 
	~<dbus/dbus.h
>

42 
	~<dbus/dbus-glib.h
>

43 
	~<sys/ty³s.h
>

44 
	~<sys/¡©.h
>

45 
	~<fú.h
>

46 
	~<m©h.h
>

47 
	~<sys/mmª.h
>

48 
	~<”ºo.h
>

50 
	~"h®d.h
"

51 
	~"logg”.h
"

52 
	~"mm­_ÿche.h
"

53 
	~"deviû_šfo.h
"

54 
	~"deviû_¡Üe.h
"

55 
	~"ut.h
"

56 
	~"ruË.h
"

57 
	~"os¥ec.h
"

59 *
	gruËs_±r
 = 
NULL
;

61 #ifdeà
DUMP_RULES


63 
	$g‘_m©ch_ty³_¡r
 (
m©ch_ty³
 
ty³
)

65 
ty³
) {

66 
MATCH_STRING
:

68 
MATCH_STRING_OUTOF
:

70 
MATCH_INT
:

72 
MATCH_INT_OUTOF
:

74 
MATCH_UINT64
:

76 
MATCH_BOOL
:

78 
MATCH_DOUBLE
:

80 
MATCH_EXISTS
:

82 
MATCH_EMPTY
:

84 
MATCH_ISASCII
:

86 
MATCH_IS_ABS_PATH
:

88 
MATCH_SIBLING_CONTAINS
:

90 
MATCH_CONTAINS
:

92 
MATCH_CONTAINS_NCASE
:

94 
MATCH_CONTAINS_NOT
:

96 
MATCH_CONTAINS_OUTOF
:

98 
MATCH_PREFIX
:

100 
MATCH_PREFIX_NCASE
:

102 
MATCH_PREFIX_OUTOF
:

104 
MATCH_SUFFIX
:

106 
MATCH_SUFFIX_NCASE
:

108 
MATCH_COMPARE_LT
:

110 
MATCH_COMPARE_LE
:

112 
MATCH_COMPARE_GT
:

114 
MATCH_COMPARE_GE
:

116 
MATCH_COMPARE_NE
:

118 
MATCH_UNKNOWN
:

122 
	}
}

142 
gboŞ—n


143 
	$»sŞve_udrİ_·th
 (cÚ¡ *
·th
, cÚ¡ *
sourû_udi
,

144 *
udi_»suÉ
, 
size_t
 
udi_»suÉ_size
,

145 *
´İ_»suÉ
, 
size_t
 
´İ_»suÉ_size
)

147 
i
;

148 
gch¬
 **
tok’s
 = 
NULL
;

149 
gboŞ—n
 
rc
 = 
FALSE
;

152 
tok’s
 = 
	`g_¡r¥l™
 (
·th
, ":", 64);

155 ià(
tok’s
 =ğ
NULL
 ||okens[0] == NULL ||okens[1] == NULL) {

156 
	`¡ºıy
 (
udi_»suÉ
, 
sourû_udi
, 
udi_»suÉ_size
);

157 
	`¡ºıy
 (
´İ_»suÉ
, 
·th
, 
´İ_»suÉ_size
);

158 
rc
 = 
TRUE
;

159 
out
;

163 
	`¡ºıy
 (
udi_»suÉ
, 
sourû_udi
, 
udi_»suÉ_size
);

165 
i
 = 0; 
tok’s
[i] !ğ
NULL
; i++) {

166 
H®Deviû
 *
d
;

167 
gch¬
 *
cu¹ok’
;

171 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi_»suÉ
);

172 ià(
d
 =ğ
NULL
)

173 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi_»suÉ
);

174 ià(
d
 =ğ
NULL
)

175 
out
;

177 
cu¹ok’
 = 
tok’s
[
i
];

180 ià(
tok’s
[
i
+1] =ğ
NULL
) {

181 
	`¡ºıy
 (
´İ_»suÉ
, 
cu¹ok’
, 
´İ_»suÉ_size
);

182 
rc
 = 
TRUE
;

183 
out
;

188 ià(
cu¹ok’
[0] == '@') {

189 cÚ¡ *
udrİ
;

190 cÚ¡ *
Ãwudi
;

192 
udrİ
 = 
cu¹ok’
 + 1;

194 
Ãwudi
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
udrİ
);

195 ià(
Ãwudi
 =ğ
NULL
)

196 
out
;

198 
	`¡ºıy
 (
udi_»suÉ
, 
Ãwudi
, 
udi_»suÉ_size
);

200 
	`¡ºıy
 (
udi_»suÉ
, 
cu¹ok’
, 
udi_»suÉ_size
);

205 
out
:

206 
	`g_¡rä“v
 (
tok’s
);

207  
rc
;

208 
	}
}

225 
gboŞ—n


226 
	$m©ch_com·»_´İ”ty
 (
H®Deviû
 *
d
, cÚ¡ *
key
, cÚ¡ *
right_side
, 
dbus_št64_t
 *
»suÉ
)

228 
gboŞ—n
 
rc
;

229 
´İty³
;

231 
rc
 = 
FALSE
;

233 ià(!
	`h®_deviû_has_´İ”ty
 (
d
, 
key
))

234 
out
;

236 
´İty³
 = 
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
key
);

237 
´İty³
) {

238 
HAL_PROPERTY_TYPE_STRING
:

239 *
»suÉ
 = (
dbus_št64_t
è
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
key
), 
right_side
);

240 
rc
 = 
TRUE
;

243 
HAL_PROPERTY_TYPE_INT32
:

244 *
»suÉ
 = ((
dbus_št64_t
è
	`h®_deviû_´İ”ty_g‘_št
 (
d
, 
key
)è- 
	`¡¹Şl
 (
right_side
, 
NULL
, 0);

245 
rc
 = 
TRUE
;

248 
HAL_PROPERTY_TYPE_UINT64
:

249 *
»suÉ
 = ((
dbus_št64_t
è
	`h®_deviû_´İ”ty_g‘_ušt64
 (
d
, 
key
)è- ((dbus_št64_tè
	`¡¹Şl
 (
right_side
, 
NULL
, 0));

250 
rc
 = 
TRUE
;

253 
HAL_PROPERTY_TYPE_DOUBLE
:

254 *
»suÉ
 = (
dbus_št64_t
è
	`û
 (
	`h®_deviû_´İ”ty_g‘_doubË
 (
d
, 
key
è- 
	`©of
 (
right_side
));

255 
rc
 = 
TRUE
;

260 
HAL_PROPERTY_TYPE_BOOLEAN
:

265 
out
:

266  
rc
;

267 
	}
}

269 
gboŞ—n


270 
	$hªdË_m©ch
 (
ruË
 *ruË, 
H®Deviû
 *
d
)

272 
udi_to_check
[
HAL_PATH_MAX
];

273 
´İ_to_check
[
HAL_PATH_MAX
];

274 cÚ¡ *
key
 = 
ruË
->key;

275 cÚ¡ *
v®ue
 = (*)
	`RULES_PTR
(
ruË
->
v®ue_off£t
);

276 cÚ¡ *
d_udi
;

278 
d_udi
 = 
	`h®_deviû_g‘_udi
 (
d
);

281 ià(!
	`»sŞve_udrİ_·th
 (
key
,

282 
d_udi
,

283 
udi_to_check
,  (udi_to_check),

284 
´İ_to_check
,  (prop_to_check))) {

286  
FALSE
;

289 ià(
	`¡rcmp
(
udi_to_check
, 
d_udi
)) {

290 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi_to_check
);

291 ià(
d
 =ğ
NULL
)

292 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi_to_check
);

293 ià(
d
 =ğ
NULL
) {

294 
	`HAL_ERROR
 (("Could‚Ù fšd deviû w™h ud˜'%s'", 
udi_to_check
));

295  
FALSE
;

299 
ruË
->
ty³_m©ch
) {

300 
MATCH_STRING
:

302 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è!ğ
HAL_PROPERTY_TYPE_STRING
)

303  
FALSE
;

304 ià(
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
´İ_to_check
), 
v®ue
) != 0)

305  
FALSE
;

306  
TRUE
;

309 
MATCH_INT
:

311 
v®
 = 
	`¡¹Ş
 (
v®ue
, 
NULL
, 0);

313 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è!ğ
HAL_PROPERTY_TYPE_INT32
)

314  
FALSE
;

315 ià(
	`h®_deviû_´İ”ty_g‘_št
 (
d
, 
´İ_to_check
è!ğ
v®
)

316  
FALSE
;

317  
TRUE
;

320 
MATCH_UINT64
:

322 
dbus_ušt64_t
 
v®
 = 
	`¡¹Ş
 (
v®ue
, 
NULL
, 0);

324 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è!ğ
HAL_PROPERTY_TYPE_UINT64
)

325  
FALSE
;

326 ià(
	`h®_deviû_´İ”ty_g‘_ušt64
 (
d
, 
´İ_to_check
è!ğ
v®
)

327  
FALSE
;

328  
TRUE
;

331 
MATCH_BOOL
:

333 
dbus_boŞ_t
 
v®
;

335 ià(
	`¡rcmp
 (
v®ue
, "false") == 0)

336 
v®
 = 
FALSE
;

337 ià(
	`¡rcmp
 (
v®ue
, "true") == 0)

338 
v®
 = 
TRUE
;

340  
FALSE
;

342 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è!ğ
HAL_PROPERTY_TYPE_BOOLEAN
)

343  
FALSE
;

344 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, 
´İ_to_check
è!ğ
v®
)

345  
FALSE
;

346  
TRUE
;

349 
MATCH_DOUBLE
:

351 
v®
 = 
	`©of
 (
v®ue
);

353 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è!ğ
HAL_PROPERTY_TYPE_DOUBLE
)

354  
FALSE
;

355 ià(
	`h®_deviû_´İ”ty_g‘_doubË
 (
d
, 
´İ_to_check
è!ğ
v®
)

356  
FALSE
;

357  
TRUE
;

360 
MATCH_EXISTS
:

362 
dbus_boŞ_t
 
should_exi¡
 = 
TRUE
;

364 ià(
	`¡rcmp
 (
v®ue
, "false") == 0)

365 
should_exi¡
 = 
FALSE
;

367 ià(
should_exi¡
) {

368 ià(
	`h®_deviû_has_´İ”ty
 (
d
, 
´İ_to_check
))

369  
TRUE
;

371  
FALSE
;

373 ià(
	`h®_deviû_has_´İ”ty
 (
d
, 
´İ_to_check
))

374  
FALSE
;

376  
TRUE
;

380 
MATCH_EMPTY
:

382 
dbus_boŞ_t
 
is_em±y
 = 
TRUE
;

383 
dbus_boŞ_t
 
should_be_em±y
 = 
TRUE
;

385 ià(
	`¡rcmp
 (
v®ue
, "false") == 0)

386 
should_be_em±y
 = 
FALSE
;

387 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è!ğ
HAL_PROPERTY_TYPE_STRING
)

388  
FALSE
;

389 ià(
	`h®_deviû_has_´İ”ty
 (
d
, 
´İ_to_check
))

390 ià(
	`¡¾’
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
´İ_to_check
)) > 0)

391 
is_em±y
 = 
FALSE
;

393 ià(
should_be_em±y
) {

394 ià(
is_em±y
)

395  
TRUE
;

397  
FALSE
;

399 ià(
is_em±y
)

400  
FALSE
;

402  
TRUE
;

406 
MATCH_ISASCII
:

408 
dbus_boŞ_t
 
is_ascii
 = 
TRUE
;

409 
dbus_boŞ_t
 
should_be_ascii
 = 
TRUE
;

410 
i
;

411 cÚ¡ *
¡r
;

413 ià(
	`¡rcmp
 (
v®ue
, "false") == 0)

414 
should_be_ascii
 = 
FALSE
;

416 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è!ğ
HAL_PROPERTY_TYPE_STRING
)

417  
FALSE
;

419 
is_ascii
 = 
TRUE
;

421 
¡r
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
´İ_to_check
);

422 
i
 = 0; 
¡r
[i] != '\0'; i++) {

423 ià(((è
¡r
[
i
]) > 0x7f)

424 
is_ascii
 = 
FALSE
;

427 ià(
should_be_ascii
) {

428 ià(
is_ascii
)

429  
TRUE
;

431  
FALSE
;

433 ià(
is_ascii
)

434  
FALSE
;

436  
TRUE
;

440 
MATCH_IS_ABS_PATH
:

442 cÚ¡ *
·th
 = 
NULL
;

443 
dbus_boŞ_t
 
is_absŞu‹_·th
 = 
FALSE
;

444 
dbus_boŞ_t
 
should_be_absŞu‹_·th
 = 
TRUE
;

446 ià(
	`¡rcmp
 (
v®ue
, "false") == 0)

447 
should_be_absŞu‹_·th
 = 
FALSE
;

449 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è!ğ
HAL_PROPERTY_TYPE_STRING
)

450  
FALSE
;

452 ià(
	`h®_deviû_has_´İ”ty
 (
d
, 
´İ_to_check
)) {

453 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
´İ_to_check
);

454 ià(
	`g_·th_is_absŞu‹
 (
·th
))

455 
is_absŞu‹_·th
 = 
TRUE
;

458 ià(
should_be_absŞu‹_·th
) {

459 ià(
is_absŞu‹_·th
)

460  
TRUE
;

462  
FALSE
;

464 ià(
is_absŞu‹_·th
)

465  
FALSE
;

467  
TRUE
;

471 
MATCH_CONTAINS
:

472 
MATCH_CONTAINS_NOT
:

474 
dbus_boŞ_t
 
cÚšs
 = 
FALSE
;

476 ià(
	`h®_deviû_has_´İ”ty
 (
d
, 
´İ_to_check
è&& 
v®ue
 !ğ
NULL
) {

478 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è=ğ
HAL_PROPERTY_TYPE_STRING
) {

479 cÚ¡ *
hay¡ack
;

481 
hay¡ack
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
´İ_to_check
);

482 ià(
hay¡ack
 !ğ
NULL
 && (
	`¡r¡r
(hay¡ack, 
v®ue
) != NULL))

483 
cÚšs
 = 
TRUE
;

484 } ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è=ğ
HAL_PROPERTY_TYPE_STRLIST
) {

485 
H®DeviûSŒLi¡I‹r
 
™”
;

486 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
d
, 
´İ_to_check
, &
™”
);

487 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
™”
);

488 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
™”
)) {

489 cÚ¡ *
¡r
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
™”
);

490 ià(
	`¡rcmp
 (
¡r
, 
v®ue
) == 0) {

491 
cÚšs
 = 
TRUE
;

496  
FALSE
;

500 ià(
ruË
->
ty³_m©ch
 =ğ
MATCH_CONTAINS
) {

501  
cÚšs
;

503  !
cÚšs
;

507 
MATCH_CONTAINS_OUTOF
:

508 
MATCH_PREFIX_OUTOF
:

509 
MATCH_STRING_OUTOF
:

511 
dbus_boŞ_t
 
cÚšs
 = 
FALSE
;

513 ià(
	`h®_deviû_has_´İ”ty
 (
d
, 
´İ_to_check
è&& 
v®ue
 !ğ
NULL
) {

515 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è=ğ
HAL_PROPERTY_TYPE_STRING
) {

516 cÚ¡ *
hay¡ack
;

517 
gch¬
 **
v®ues
;

518 
i
;

520 
v®ues
 = 
	`g_¡r¥l™
 (
v®ue
, ";", 0);

522 
hay¡ack
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
´İ_to_check
);

523 ià(
hay¡ack
 !ğ
NULL
 && 
v®ues
 != NULL) {

524 
i
 = 0; 
v®ues
 [i] ; ++i) {

525 ià(
ruË
->
ty³_m©ch
 =ğ
MATCH_CONTAINS_OUTOF
) {

526 ià(
	`¡r¡r
(
hay¡ack
, 
v®ues
[
i
]è!ğ
NULL
) {

527 
cÚšs
 = 
TRUE
;

531 ià(
ruË
->
ty³_m©ch
 =ğ
MATCH_PREFIX_OUTOF
) {

532 ià(
	`g_¡r_has_´efix
 (
hay¡ack
, 
v®ues
[
i
])) {

533 
cÚšs
 = 
TRUE
;

537 ià(
ruË
->
ty³_m©ch
 =ğ
MATCH_STRING_OUTOF
) {

538 ià(
	`¡rcmp
 (
hay¡ack
, 
v®ues
[
i
]) == 0) {

539 
cÚšs
 = 
TRUE
;

545 
	`g_¡rä“v
 (
v®ues
);

549  
cÚšs
;

552 
MATCH_INT_OUTOF
:

554 
dbus_boŞ_t
 
cÚšed
 = 
FALSE
;

556 ià(
	`h®_deviû_has_´İ”ty
 (
d
, 
´İ_to_check
è&& 
v®ue
 !ğ
NULL
) {

558 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è=ğ
HAL_PROPERTY_TYPE_INT32
) {

559 
gch¬
 **
v®ues
;

560 
i
;

561 
to_check
;

563 
v®ues
 = 
	`g_¡r¥l™
 (
v®ue
, ";", 0);

564 
to_check
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, 
´İ_to_check
);

566 ià(
v®ues
 !ğ
NULL
) {

567 
i
 = 0; 
v®ues
 [i] ; ++i) {

568 ià(
to_check
 =ğ
	`¡¹Ş
 (
v®ues
[
i
], 
NULL
, 0)) {

569 
cÚšed
 = 
TRUE
;

574 
	`g_¡rä“v
 (
v®ues
);

578  
cÚšed
;

582 
MATCH_SIBLING_CONTAINS
:

584 
dbus_boŞ_t
 
cÚšs
 = 
FALSE
;

585 cÚ¡ *
·»Á_udi
;

587 
·»Á_udi
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent");

588 ià(
·»Á_udi
 !ğ
NULL
) {

589 
GSLi¡
 *
i
;

590 
GSLi¡
 *
siblšgs
;

592 
siblšgs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

594 
·»Á_udi
);

595 
i
 = 
siblšgs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

596 
H®Deviû
 *
sib
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

598 ià(
sib
 =ğ
d
)

601 
	`HAL_INFO
 (("Checking sibling '%s' of '%s' whether '%s' contains '%s'",

602 
	`h®_deviû_g‘_udi
 (
sib
), h®_deviû_g‘_ud˜(
d
), 
´İ_to_check
, 
v®ue
));

604 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
sib
, 
´İ_to_check
è=ğ
HAL_PROPERTY_TYPE_STRING
) {

605 ià(
	`h®_deviû_has_´İ”ty
 (
sib
, 
´İ_to_check
)) {

606 cÚ¡ *
hay¡ack
;

608 
hay¡ack
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
sib
, 
´İ_to_check
);

609 ià(
v®ue
 !ğ
NULL
 && 
hay¡ack
 !ğNULL && 
	`¡r¡r
 (haystack, value))

610 
cÚšs
 = 
TRUE
;

612 } ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
sib
, 
´İ_to_check
è=ğ
HAL_PROPERTY_TYPE_STRLIST
 && 
v®ue
 !ğ
NULL
) {

613 
H®DeviûSŒLi¡I‹r
 
™”
;

614 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
sib
, 
´İ_to_check
, &
™”
);

615 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
™”
);

616 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
™”
)) {

617 cÚ¡ *
¡r
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
™”
);

618 ià(
	`¡rcmp
 (
¡r
, 
v®ue
) == 0) {

619 
cÚšs
 = 
TRUE
;

625 ià(
cÚšs
)

629 
	`g_¦i¡_ä“
 (
siblšgs
);

632  
cÚšs
;

635 
MATCH_CONTAINS_NCASE
:

637 
dbus_boŞ_t
 
cÚšs_nÿ£
 = 
FALSE
;

639 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è=ğ
HAL_PROPERTY_TYPE_STRING
) {

640 ià(
	`h®_deviû_has_´İ”ty
 (
d
, 
´İ_to_check
)) {

641 *
v®ue_low”ÿ£
;

642 *
hay¡ack_low”ÿ£
;

644 
v®ue_low”ÿ£
 = 
	`g_utf8_¡rdown
 (
v®ue
, -1);

645 
hay¡ack_low”ÿ£
 = 
	`g_utf8_¡rdown
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
´İ_to_check
), -1);

646 ià(
v®ue_low”ÿ£
 !ğ
NULL
 && 
hay¡ack_low”ÿ£
 != NULL &&

647 
	`¡r¡r
 (
hay¡ack_low”ÿ£
, 
v®ue_low”ÿ£
))

648 
cÚšs_nÿ£
 = 
TRUE
;

650 
	`g_ä“
 (
v®ue_low”ÿ£
);

651 
	`g_ä“
 (
hay¡ack_low”ÿ£
);

653 } ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è=ğ
HAL_PROPERTY_TYPE_STRLIST
 && 
v®ue
 !ğ
NULL
) {

654 
H®DeviûSŒLi¡I‹r
 
™”
;

655 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
d
, 
´İ_to_check
, &
™”
);

656 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
™”
);

657 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
™”
)) {

658 cÚ¡ *
¡r
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
™”
);

659 ià(
	`g_ascii_¡rÿ£cmp
 (
¡r
, 
v®ue
) == 0) {

660 
cÚšs_nÿ£
 = 
TRUE
;

665  
FALSE
;

667  
cÚšs_nÿ£
;

670 
MATCH_PREFIX
:

672 
dbus_boŞ_t
 
´efix
 = 
FALSE
;

674 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è=ğ
HAL_PROPERTY_TYPE_STRING
) {

675 ià(
	`h®_deviû_has_´İ”ty
 (
d
, 
´İ_to_check
)) {

676 cÚ¡ *
hay¡ack
;

677 
hay¡ack
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
´İ_to_check
);

678 ià(
v®ue
 !ğ
NULL
 && 
hay¡ack
 != NULL &&

679 
	`g_¡r_has_´efix
 (
hay¡ack
, 
v®ue
)) {

680 
´efix
 = 
TRUE
;

684  
FALSE
;

687  
´efix
;

690 
MATCH_PREFIX_NCASE
:

692 
dbus_boŞ_t
 
´efix_nÿ£
 = 
FALSE
;

694 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è=ğ
HAL_PROPERTY_TYPE_STRING
) {

695 ià(
	`h®_deviû_has_´İ”ty
 (
d
, 
´İ_to_check
)) {

696 *
v®ue_low”ÿ£
;

697 *
hay¡ack_low”ÿ£
;

698 
v®ue_low”ÿ£
 = 
	`g_utf8_¡rdown
 (
v®ue
, -1);

699 
hay¡ack_low”ÿ£
 = 
	`g_utf8_¡rdown
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
´İ_to_check
), -1);

700 ià(
v®ue_low”ÿ£
 !ğ
NULL
 && 
hay¡ack_low”ÿ£
 != NULL &&

701 
	`g_¡r_has_´efix
 (
hay¡ack_low”ÿ£
, 
v®ue_low”ÿ£
)) {

702 
´efix_nÿ£
 = 
TRUE
;

704 
	`g_ä“
 (
v®ue_low”ÿ£
);

705 
	`g_ä“
 (
hay¡ack_low”ÿ£
);

708  
FALSE
;

710  
´efix_nÿ£
;

713 
MATCH_SUFFIX
:

715 
dbus_boŞ_t
 
suffix
 = 
FALSE
;

717 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è=ğ
HAL_PROPERTY_TYPE_STRING
) {

718 ià(
	`h®_deviû_has_´İ”ty
 (
d
, 
´İ_to_check
)) {

719 cÚ¡ *
hay¡ack
;

720 
hay¡ack
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
´İ_to_check
);

721 ià(
v®ue
 !ğ
NULL
 && 
hay¡ack
 != NULL &&

722 
	`g_¡r_has_suffix
 (
hay¡ack
, 
v®ue
)) {

723 
suffix
 = 
TRUE
;

727  
FALSE
;

730  
suffix
;

733 
MATCH_SUFFIX_NCASE
:

735 
dbus_boŞ_t
 
suffix_nÿ£
 = 
FALSE
;

737 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
´İ_to_check
è=ğ
HAL_PROPERTY_TYPE_STRING
) {

738 ià(
	`h®_deviû_has_´İ”ty
 (
d
, 
´İ_to_check
)) {

739 *
v®ue_low”ÿ£
;

740 *
hay¡ack_low”ÿ£
;

741 
v®ue_low”ÿ£
 = 
	`g_utf8_¡rdown
 (
v®ue
, -1);

742 
hay¡ack_low”ÿ£
 = 
	`g_utf8_¡rdown
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
´İ_to_check
), -1);

743 ià(
v®ue_low”ÿ£
 !ğ
NULL
 && 
hay¡ack_low”ÿ£
 != NULL &&

744 
	`g_¡r_has_suffix
 (
hay¡ack_low”ÿ£
, 
v®ue_low”ÿ£
)) {

745 
suffix_nÿ£
 = 
TRUE
;

747 
	`g_ä“
 (
v®ue_low”ÿ£
);

748 
	`g_ä“
 (
hay¡ack_low”ÿ£
);

751  
FALSE
;

753  
suffix_nÿ£
;

756 
MATCH_COMPARE_LT
:

758 
dbus_št64_t
 
»suÉ
;

760 ià(!
	`m©ch_com·»_´İ”ty
 (
d
, 
´İ_to_check
, 
v®ue
, &
»suÉ
))

761  
FALSE
;

763  
»suÉ
 < 0;

766 
MATCH_COMPARE_LE
:

768 
dbus_št64_t
 
»suÉ
;

770 ià(!
	`m©ch_com·»_´İ”ty
 (
d
, 
´İ_to_check
, 
v®ue
, &
»suÉ
))

771  
FALSE
;

773  
»suÉ
 <= 0;

776 
MATCH_COMPARE_GT
:

778 
dbus_št64_t
 
»suÉ
;

780 ià(!
	`m©ch_com·»_´İ”ty
 (
d
, 
´İ_to_check
, 
v®ue
, &
»suÉ
))

781  
FALSE
;

783  
»suÉ
 > 0;

786 
MATCH_COMPARE_GE
:

788 
dbus_št64_t
 
»suÉ
;

790 ià(!
	`m©ch_com·»_´İ”ty
 (
d
, 
´İ_to_check
, 
v®ue
, &
»suÉ
))

791  
FALSE
;

793  
»suÉ
 >= 0;

796 
MATCH_COMPARE_NE
:

798 
dbus_št64_t
 
»suÉ
;

800 ià(!
	`m©ch_com·»_´İ”ty
 (
d
, 
´İ_to_check
, 
v®ue
, &
»suÉ
))

801  
FALSE
;

803  
»suÉ
 != 0;

808 
	`HAL_INFO
(("match ERROR"));

809  
FALSE
;

813 
	}
}

817 
	$¥awÃd_deviû_ÿÎouts_add_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

822 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

823 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

824 
	}
}

827 
gboŞ—n


828 
	$hªdË_m”ge
 (
ruË
 *ruË, 
H®Deviû
 *
d
)

830 cÚ¡ *
v®ue
 = (*)
	`RULES_PTR
(
ruË
->
v®ue_off£t
);

831 cÚ¡ *
key
;

832 
key_to_m”ge
[
HAL_PATH_MAX
];

834 ià(
ruË
->
¹y³
 =ğ
RULE_MERGE
 ||„uË->¹y³ =ğ
RULE_APPEND
 ||

835 
ruË
->
¹y³
 =ğ
RULE_PREPEND
 ||„uË->¹y³ =ğ
RULE_ADDSET
 ) {

836 
udi_to_m”ge
[
HAL_PATH_MAX
];

839 ià(!
	`»sŞve_udrİ_·th
 (
ruË
->
key
, 
	`h®_deviû_g‘_udi
 (
d
),

840 
udi_to_m”ge
,  (udi_to_merge),

841 
key_to_m”ge
,  (key_to_merge))) {

842 
	`HAL_ERROR
 (("Could‚Ù„esŞvkey·th '%s' oÀud˜'%s'", 
ruË
->
key
, 
	`h®_deviû_g‘_udi
 (
d
)));

843  
FALSE
;

845 
key
 = 
key_to_m”ge
;

847 ià(
	`¡rcmp
(
	`h®_deviû_g‘_udi
 (
d
), 
udi_to_m”ge
) != 0) {

849 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi_to_m”ge
);

850 ià(
d
 =ğ
NULL
) {

851 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi_to_m”ge
);

853 ià(
d
 =ğ
NULL
) {

854 
	`HAL_ERROR
 (("Could‚Ù fšd deviû w™h ud˜'%s'", 
udi_to_m”ge
));

855  
FALSE
;

861 
key
 = 
ruË
->key;

864 ià(
ruË
->
¹y³
 =ğ
RULE_MERGE
) {

866 ià(
ruË
->
ty³_m”ge
 =ğ
MERGE_STRING
) {

867 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, 
key
, 
v®ue
);

869 } ià(
ruË
->
ty³_m”ge
 =ğ
MERGE_STRLIST
) {

870 
ty³
 = 
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
key
);

872 ià(
ty³
 =ğ
HAL_PROPERTY_TYPE_STRLIST
 ||y³ =ğ
HAL_PROPERTY_TYPE_INVALID
) {

873 
	`h®_deviû_´İ”ty_»move
 (
d
, 
key
);

874 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
d
, 
key
, 
v®ue
, 
FALSE
);

877 } ià(
ruË
->
ty³_m”ge
 =ğ
MERGE_INT32
) {

878 
dbus_št32_t
 
v®
 = 
	`¡¹Ş
 (
v®ue
, 
NULL
, 0);

879 
	`h®_deviû_´İ”ty_£t_št
 (
d
, 
key
, 
v®
);

881 } ià(
ruË
->
ty³_m”ge
 =ğ
MERGE_UINT64
) {

882 
dbus_ušt64_t
 
v®
 = 
	`¡¹ouÎ
 (
v®ue
, 
NULL
, 0);

883 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, 
key
, 
v®
);

885 } ià(
ruË
->
ty³_m”ge
 =ğ
MERGE_BOOLEAN
) {

886 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, 
key
, (
	`¡rcmp
 (
v®ue
, "Œue"è=ğ0è? 
TRUE
 : 
FALSE
);

888 } ià(
ruË
->
ty³_m”ge
 =ğ
MERGE_DOUBLE
) {

889 
	`h®_deviû_´İ”ty_£t_doubË
 (
d
, 
key
, 
	`©of
 (
v®ue
));

891 } ià(
ruË
->
ty³_m”ge
 =ğ
MERGE_COPY_PROPERTY
) {

893 
udi_to_m”ge_äom
[
HAL_PATH_MAX
];

894 
´İ_to_m”ge
[
HAL_PATH_MAX
];

899 ià(!
	`»sŞve_udrİ_·th
 (
v®ue
,

900 
	`h®_deviû_g‘_udi
 (
d
),

901 
udi_to_m”ge_äom
,  (udi_to_merge_from),

902 
´İ_to_m”ge
,  (prop_to_merge))) {

903 
	`HAL_ERROR
 (("Could‚Ù„esŞvkey·th '%s' oÀud˜'%s'", 
v®ue
, 
	`h®_deviû_g‘_udi
 (
d
)));

905 
H®Deviû
 *
cİyäom
;

907 
cİyäom
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi_to_m”ge_äom
);

908 ià(
cİyäom
 =ğ
NULL
) {

909 
cİyäom
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi_to_m”ge_äom
);

911 ià(
cİyäom
 =ğ
NULL
) {

912 
	`HAL_ERROR
 (("Could‚Ù fšd deviû w™h ud˜'%s'", 
udi_to_m”ge_äom
));

914 
	`h®_deviû_cİy_´İ”ty
 (
cİyäom
, 
´İ_to_m”ge
, 
d
, 
key
);

919 
	`HAL_ERROR
 (("unknowÀm”gty³ (%u)", 
ruË
->
ty³_m”ge
));

922 } ià(
ruË
->
¹y³
 =ğ
RULE_APPEND
 ||„uË->¹y³ =ğ
RULE_PREPEND
) {

923 
buf
[
HAL_PATH_MAX
];

924 
buf2
[
HAL_PATH_MAX
];

926 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
key
è!ğ
HAL_PROPERTY_TYPE_STRING
 &&

927 
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
key
è!ğ
HAL_PROPERTY_TYPE_STRLIST
 &&

928 
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
key
è!ğ
HAL_PROPERTY_TYPE_INVALID
) {

929 
	`HAL_ERROR
 (("invalid keyype"));

930  
FALSE
;

933 ià(
ruË
->
ty³_m”ge
 =ğ
MERGE_STRLIST
) {

934 ià(
ruË
->
¹y³
 =ğ
RULE_APPEND
)

935 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
d
, 
key
, 
v®ue
, 
FALSE
);

937 
	`h®_deviû_´İ”ty_¡¾i¡_´•’d
 (
d
, 
key
, 
v®ue
);

939 cÚ¡ *
exi¡šg_¡ršg
;

941 
ruË
->
ty³_m”ge
) {

942 
MERGE_STRING
:

943 
	`¡ºıy
 (
buf
, 
v®ue
,  (buf));

945 
MERGE_COPY_PROPERTY
:

947 
udi_to_m”ge_äom
[
HAL_PATH_MAX
];

948 
´İ_to_m”ge
[
HAL_PATH_MAX
];

953 ià(!
	`»sŞve_udrİ_·th
 (
v®ue
,

954 
	`h®_deviû_g‘_udi
 (
d
),

955 
udi_to_m”ge_äom
,  (udi_to_merge_from),

956 
´İ_to_m”ge
,  (prop_to_merge))) {

957 
	`HAL_ERROR
 (("Could‚Ù„esŞvkey·th '%s' oÀud˜'%s'", 
v®ue
, 
	`h®_deviû_g‘_udi
 (
d
)));

959 
H®Deviû
 *
cİyäom
;

961 
cİyäom
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi_to_m”ge_äom
);

962 ià(
cİyäom
 =ğ
NULL
) {

963 
cİyäom
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi_to_m”ge_äom
);

965 ià(
cİyäom
 =ğ
NULL
) {

966 
	`HAL_ERROR
 (("Could‚Ù fšd deviû w™h ud˜'%s'", 
udi_to_m”ge_äom
));

968 
	`h®_deviû_´İ”ty_g‘_as_¡ršg
 (
cİyäom
, 
´İ_to_m”ge
, 
buf
,  (buf));

977 
exi¡šg_¡ršg
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
key
);

978 ià(
exi¡šg_¡ršg
 !ğ
NULL
) {

979 ià(
ruË
->
¹y³
 =ğ
RULE_APPEND
) {

980 
	`¡ºıy
 (
buf2
, 
exi¡šg_¡ršg
,  (buf2));

981 
	`¡ºÿt
 (
buf2
, 
buf
,  (buf2è- 
	`¡¾’
(buf2));

983 
	`¡ºıy
 (
buf2
, 
buf
,  (buf2));

984 
	`¡ºÿt
 (
buf2
, 
exi¡šg_¡ršg
,  (buf2è- 
	`¡¾’
(buf2));

987 
	`¡ºıy
 (
buf2
, 
buf
,  (buf2));

990 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, 
key
, 
buf2
);

993 } ià(
ruË
->
¹y³
 =ğ
RULE_ADDSET
) {

995 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
key
è!ğ
HAL_PROPERTY_TYPE_STRLIST
 &&

996 
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
key
è!ğ
HAL_PROPERTY_TYPE_INVALID
) {

997 
	`HAL_ERROR
 (("invalid keyype"));

998  
FALSE
;

1001 ià(!
	`h®_deviû_has_´İ”ty
 (
d
, 
key
) ||

1002 !
	`h®_deviû_´İ”ty_¡¾i¡_cÚšs
 (
d
, 
key
, 
v®ue
)) {

1003 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
d
, 
key
, 
v®ue
, 
FALSE
);

1006 } ià(
ruË
->
¹y³
 =ğ
RULE_REMOVE
) {

1008 ià(
ruË
->
ty³_m”ge
 =ğ
MERGE_STRLIST
) {

1010 
	`h®_deviû_´İ”ty_¡¾i¡_»move
 (
d
, 
key
, 
v®ue
);

1014 ià(
	`¡¾’
 (
v®ue
) == 0)

1015 
	`h®_deviû_´İ”ty_»move
 (
d
, 
key
);

1018 } ià(
ruË
->
¹y³
 =ğ
RULE_SPAWN
) {

1019 
H®Deviû
 *
¥awÃd
;

1020 
¥awÃd
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
key
);

1021 ià(
¥awÃd
 =ğ
NULL
)

1022 
¥awÃd
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
key
);

1024 ià(
¥awÃd
 =ğ
NULL
) {

1025 
	`HAL_INFO
 (("Spawning‚ew device object '%s' caused by <spawn> on udi '%s'",

1026 
key
, 
	`h®_deviû_g‘_udi
 (
d
)));

1027 
¥awÃd
 = 
	`h®_deviû_Ãw
 ();

1028 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
¥awÃd
, "info.subsystem", "unknown");

1029 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
¥awÃd
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
d
));

1030 
	`h®_deviû_£t_udi
 (
¥awÃd
, 
key
);

1032 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
¥awÃd
);

1034 
	`di_£¬ch_ªd_m”ge
 (
¥awÃd
, 
DEVICE_INFO_TYPE_INFORMATION
);

1035 
	`di_£¬ch_ªd_m”ge
 (
¥awÃd
, 
DEVICE_INFO_TYPE_POLICY
);

1037 
	`h®_ut_ÿÎout_deviû_add
 (
¥awÃd
, 
¥awÃd_deviû_ÿÎouts_add_dÚe
, 
NULL
, NULL);

1041 
	`HAL_ERROR
 (("UnknowÀruËy³ (%u)", 
ruË
->
¹y³
));

1042  
FALSE
;

1044  
TRUE
;

1045 
	}
}

1047 
ruË
 *
	$di_Ãxt
(
ruË
 *rule){

1048 
ÿche_h—d”
 *
h—d”
 = (ÿche_h—d”*è
	`RULES_PTR
(0);

1049 
size_t
 
off£t
 = (*)
ruË
 - (*)
ruËs_±r
;

1050 
size_t
 
Ãxt
 = 
off£t
 + 
ruË
->
ruË_size
;

1052 ià(((
off£t
 >ğ
h—d”
->
fdi_ruËs_´•robe
è&& (
Ãxt
 < h—d”->
fdi_ruËs_šfÜm©iÚ
)) ||

1053 ((
off£t
 >ğ
h—d”
->
fdi_ruËs_šfÜm©iÚ
è&& (
Ãxt
 < h—d”->
fdi_ruËs_pŞicy
)) ||

1054 ((
off£t
 >ğ
h—d”
->
fdi_ruËs_pŞicy
è&& (
Ãxt
 < h—d”->
®l_ruËs_size
))){

1055  (
ruË
*è
	`RULES_PTR
(
Ãxt
);

1057  
NULL
;

1058 
	}
}

1060 
ruË
 *
	$di_jump
(
ruË
 *rule){

1061 
ÿche_h—d”
 *
h—d”
 = (ÿche_h—d”*è
	`RULES_PTR
(0);

1062 
size_t
 
off£t
 = (*)
ruË
 - (*)
ruËs_±r
;

1063 
size_t
 
Ãxt
 = 
ruË
->
jump_pos™iÚ
;

1065 ià(
Ãxt
 =ğ0è 
NULL
;

1066 ià(((
off£t
 >ğ
h—d”
->
fdi_ruËs_´•robe
è&& (
Ãxt
 < h—d”->
fdi_ruËs_šfÜm©iÚ
)) ||

1067 ((
off£t
 >ğ
h—d”
->
fdi_ruËs_šfÜm©iÚ
è&& (
Ãxt
 < h—d”->
fdi_ruËs_pŞicy
)) ||

1068 ((
off£t
 >ğ
h—d”
->
fdi_ruËs_pŞicy
è&& (
Ãxt
 < h—d”->
®l_ruËs_size
))){

1069  (
ruË
*è
	`RULES_PTR
(
Ãxt
);

1071  
NULL
;

1072 
	}
}

1077 
	$ruËs_m©ch_ªd_m”ge_deviû
 (*
fdi_ruËs_li¡
, 
H®Deviû
 *
d
)

1079 
ruË
 *ruË = 
fdi_ruËs_li¡
;

1080 
ruË
 !ğ
NULL
){

1083 
ruË
->
¹y³
) {

1084 
RULE_MATCH
:

1087 ià(!
	`hªdË_m©ch
 (
ruË
, 
d
)) {

1089 
ruË
 = 
	`di_jump
(rule);

1091 if(
ruË
 =ğ
NULL
)

1092 
	`DIE
(("Rule is NULL on jump"));

1098 
RULE_APPEND
:

1099 
RULE_PREPEND
:

1100 
RULE_ADDSET
:

1101 
RULE_REMOVE
:

1102 
RULE_CLEAR
:

1103 
RULE_SPAWN
:

1104 
RULE_MERGE
:

1106 
	`hªdË_m”ge
 (
ruË
, 
d
);

1109 
RULE_EOF
:

1114 
	`HAL_WARNING
(("UnhªdËd„uË (%i)!", 
ruË
->
¹y³
));

1115 
ruË
 = 
	`di_jump
(rule);

1118 
ruË
 = 
	`di_Ãxt
(rule);

1120 
	}
}

1123 
gboŞ—n


1124 
	$di_£¬ch_ªd_m”ge
 (
H®Deviû
 *
d
, 
DeviûInfoTy³
 
ty³
){

1125 
ÿche_h—d”
 *
h—d”
;

1128 ià(
	`di_ÿche_coh”’cy_check
 (
FALSE
)) {

1129 
	`di_ruËs_š™
 ();

1132 
h—d”
 = (
ÿche_h—d”
*è
	`RULES_PTR
(0);

1134 
ty³
) {

1135 
DEVICE_INFO_TYPE_PREPROBE
:

1137 if(
h—d”
->
fdi_ruËs_šfÜm©iÚ
 > h—d”->
fdi_ruËs_´•robe
)

1142 
	`ruËs_m©ch_ªd_m”ge_deviû
 (
	`RULES_PTR
(
h—d”
->
fdi_ruËs_´•robe
), 
d
);

1146 
DEVICE_INFO_TYPE_INFORMATION
:

1148 if(
h—d”
->
fdi_ruËs_pŞicy
 > h—d”->
fdi_ruËs_šfÜm©iÚ
)

1153 
	`ruËs_m©ch_ªd_m”ge_deviû
 (
	`RULES_PTR
(
h—d”
->
fdi_ruËs_šfÜm©iÚ
), 
d
);

1157 
DEVICE_INFO_TYPE_POLICY
:

1159 if(
h—d”
->
®l_ruËs_size
 > h—d”->
fdi_ruËs_pŞicy
)

1164 
	`ruËs_m©ch_ªd_m”ge_deviû
 (
	`RULES_PTR
(
h—d”
->
fdi_ruËs_pŞicy
), 
d
);

1172  
TRUE
;

1173 
	}
}

	@hald/device_info.h

26 #iâdeà
DEVICE_INFO_H


27 
	#DEVICE_INFO_H


	)

29 
	~<¡d¬g.h
>

30 
	~<¡dšt.h
>

31 
	~<dbus/dbus.h
>

33 
	~"deviû_¡Üe.h
"

37 
	mDEVICE_INFO_TYPE_PREPROBE
,

38 
	mDEVICE_INFO_TYPE_INFORMATION
,

39 
	mDEVICE_INFO_TYPE_POLICY


40 } 
	tDeviûInfoTy³
;

42 
di_ruËs_š™
 ();

43 
di_ruËs_ş—nup
 ();

44 
gboŞ—n
 
di_£¬ch_ªd_m”ge
 (
H®Deviû
 *
d
, 
DeviûInfoTy³
 
ty³
);

	@hald/device_pm.c

27 
	~<¡dio.h
>

28 
	~<¡ršg.h
>

29 
	~<time.h
>

30 
	~<ùy³.h
>

31 
	~<¡dšt.h
>

33 
	~<glib.h
>

35 
	~"h®d.h
"

36 
	~"logg”.h
"

37 
	~"ut_pm.h
"

38 
	~"deviû_pm.h
"

39 
	~"deviû_¡Üe.h
"

49 
	$deviû_pm_ab¡¿ù_´İs
 (
H®Deviû
 *
d
)

51 cÚ¡ *
»pÜtšg_un™
;

52 
»pÜtšg_cu¼’t
;

53 
»pÜtšg_Ï¡fuÎ
;

54 
»pÜtšg_design
;

55 
»pÜtšg_¿‹
;

56 
nÜm®i£d_cu¼’t
;

57 
nÜm®i£d_Ï¡fuÎ
;

58 
nÜm®i£d_design
;

59 
nÜm®i£d_¿‹
;

60 
design_vŞge
;

61 
vŞge
;

62 
gboŞ—n
 
ch¬gšg
;

63 
gboŞ—n
 
disch¬gšg
;

66 
»pÜtšg_un™
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
,

68 
»pÜtšg_cu¼’t
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
,

70 
»pÜtšg_Ï¡fuÎ
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
,

72 
»pÜtšg_design
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
,

74 
»pÜtšg_¿‹
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
,

80 ià(
»pÜtšg_¿‹
 == 0xffff) {

81 
»pÜtšg_¿‹
 = 0;

86 ià(
»pÜtšg_un™
 && 
	`¡rcmp
 (reporting_unit, "mAh") == 0) {

91 
design_vŞge
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.voltage.design");

92 
vŞge
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.voltage.current");

99 ià(
design_vŞge
 <= 0)

100 
design_vŞge
 = 1000;

104 ià(
vŞge
 < (
design_vŞge
/2) || voltage > design_voltage) {

106 
vŞge
 = 
design_vŞge
;

109 
nÜm®i£d_cu¼’t
 = (
»pÜtšg_cu¼’t
 * 
vŞge
) / 1000;

110 
nÜm®i£d_Ï¡fuÎ
 = (
»pÜtšg_Ï¡fuÎ
 * 
vŞge
) / 1000;

111 
nÜm®i£d_design
 = (
»pÜtšg_design
 * 
vŞge
) / 1000;

112 
nÜm®i£d_¿‹
 = (
»pÜtšg_¿‹
 * 
vŞge
) / 1000;

116 
nÜm®i£d_cu¼’t
 = 
»pÜtšg_cu¼’t
;

117 
nÜm®i£d_Ï¡fuÎ
 = 
»pÜtšg_Ï¡fuÎ
;

118 
nÜm®i£d_design
 = 
»pÜtšg_design
;

119 
nÜm®i£d_¿‹
 = 
»pÜtšg_¿‹
;

125 ià(
nÜm®i£d_cu¼’t
 < 0)

126 
nÜm®i£d_cu¼’t
 = 0;

127 ià(
nÜm®i£d_Ï¡fuÎ
 < 0)

128 
nÜm®i£d_Ï¡fuÎ
 = 0;

129 ià(
nÜm®i£d_design
 < 0)

130 
nÜm®i£d_design
 = 0;

131 ià(
nÜm®i£d_¿‹
 < 0)

132 
nÜm®i£d_¿‹
 = 0;

136 
ch¬gšg
 = 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "battery.rechargeable.is_charging");

137 
disch¬gšg
 = 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "battery.rechargeable.is_discharging");

139 ià(!
ch¬gšg
 && !
disch¬gšg
) {

140 
GSLi¡
 *
i
;

141 
GSLi¡
 *
deviûs
;

142 
H®Deviû
 *
_d
;

143 
gboŞ—n
 
Úlše
;

144 cÚ¡ *
b©_ty³
;

146 
Úlše
 = 
FALSE
;

149 
b©_ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "battery.type");

150 ià(
b©_ty³
 !ğ
NULL
 && !
	`¡ºcmp
 (bat_type, "primary", 7)) {

154 
deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

157 
i
 = 
deviûs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

158 
_d
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

159 ià(
	`h®_deviû_has_´İ”ty
 (
_d
, "linux.acpi_type")) {

160 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
_d
, "ac_adapter.present")) {

161 
Úlše
 = 
TRUE
;

165 
	`g_¦i¡_ä“
 (
deviûs
);

167 ià(
Úlše
) {

168 
nÜm®i£d_¿‹
 = 0;

171 
deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

174 
i
 = 
deviûs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

175 
_d
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

176 ià(
	`h®_deviû_has_´İ”ty
 (
_d
, "linux.acpi_type")) {

177 
b©_ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
_d
, "battery.type");

178 ià(
b©_ty³
 !ğ
NULL
 && !
	`¡ºcmp
 (bat_type, "primary", 7)) {

179 ià(
	`¡rcmp
 (
	`h®_deviû_g‘_udi
(
d
), h®_deviû_g‘_udi(
_d
)) != 0) {

180 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
_d
, "battery.rechargeable.is_discharging"))

181 
nÜm®i£d_¿‹
 = 0;

186 
	`g_¦i¡_ä“
(
deviûs
);

189 
nÜm®i£d_¿‹
 = 0;

195 ià(
nÜm®i£d_cu¼’t
 > 
nÜm®i£d_Ï¡fuÎ
)

196 
nÜm®i£d_cu¼’t
 = 
nÜm®i£d_Ï¡fuÎ
;

198 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.cu¼’t", 
nÜm®i£d_cu¼’t
);

199 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.Ï¡_fuÎ", 
nÜm®i£d_Ï¡fuÎ
);

200 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.design", 
nÜm®i£d_design
);

201 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.¿‹", 
nÜm®i£d_¿‹
);

202 
	}
}

212 
	$deviû_pm_ÿlcuÏ‹_³rûÁage
 (
H®Deviû
 *
d
)

214 
³rûÁage
;

215 
cu¼’t
;

216 
Ï¡fuÎ
;

218 
³rûÁage
 = -1;

221 
cu¼’t
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.charge_level.current");

222 
Ï¡fuÎ
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.charge_level.last_full");

225 ià(
cu¼’t
 < 0) {

226 
	`HAL_WARNING
 (("b©‹ry.ch¬ge_Ëv–.cu¼’ˆ%i, d–‘b©‹ry.ch¬ge_Ëv–.³rûÁage", 
cu¼’t
));

227 } ià(
cu¼’t
 == 0) {

228 
³rûÁage
 = 0;

229 } ià(
Ï¡fuÎ
 <= 0) {

230 
	`HAL_WARNING
 (("b©‹ry.ch¬ge_Ëv–.Ï¡fuÎ %i, d–‘b©‹ry.ch¬ge_Ëv–.³rûÁage", 
Ï¡fuÎ
));

232 
³rûÁage
 = ((è
cu¼’t
 / (è
Ï¡fuÎ
) * 100;

234 ià(
³rûÁage
 > 100)

235 
³rûÁage
 = 100;

236 ià(
³rûÁage
 < 0)

237 
³rûÁage
 = 1;

240 ià(
³rûÁage
 < 0)

241 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.percentage");

243 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.³rûÁage", 
³rûÁage
);

244 
	}
}

254 
	$deviû_pm_ÿlcuÏ‹_time
 (
H®Deviû
 *
d
)

256 
time
;

257 
gboŞ—n
 
ÿlcuÏ‹_³r_time
;

259 
ÿlcuÏ‹_³r_time
 = 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "battery.remaining_time.calculate_per_time");

262 ià(!
ÿlcuÏ‹_³r_time
 && 
	`h®_deviû_´İ”ty_g‘_boŞ
(
d
, "battery.rechargeable.is_charging")) {

263 cÚ¡ *
ty³
;

264 cÚ¡ *
un™
;

266 
ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
d
, "battery.type");

267 ià((
ty³
 !ğ
NULL
è&& (
	`¡rcmp
(type, "primary") == 0)) {

268 
un™
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
d
, "battery.charge_level.unit");

270 ià((
un™
 !ğ
NULL
è&& (
	`¡rcmp
(unit, "mWh") == 0)) {

273 ià(
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.charge_level.rate") > 50000) {

274 
	`HAL_WARNING
(("battery.charge_level.rate (%d) was > 50000 mWh,‡ssumehats wrong, calculate from‚ow based onime.",

275 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.charge_level.rate")));

276 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.»maššg_time.ÿlcuÏ‹_³r_time", 
TRUE
);

277 
ÿlcuÏ‹_³r_time
 = 
TRUE
;

283 
time
 = 
	`ut_compu‹_time_»maššg
 (

284 
	`h®_deviû_g‘_udi
 (
d
),

285 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.charge_level.rate"),

286 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.charge_level.current"),

287 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.charge_level.last_full"),

288 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "battery.rechargeable.is_discharging"),

289 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "battery.rechargeable.is_charging"),

290 
ÿlcuÏ‹_³r_time
);

293 ià(
time
 > 0)

294 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»maššg_time", 
time
);

296 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.remaining_time");

297 
	}
}

311 
	$deviû_pm_»move_İtiÚ®_´İs
 (
H®Deviû
 *
d
)

313 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.is_rechargeable");

314 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.rechargeable.is_charging");

315 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.rechargeable.is_discharging");

316 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.vendor");

317 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.model");

318 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.serial");

319 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.reporting.technology");

320 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.technology");

321 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.vendor");

322 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.unit");

323 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.current");

324 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.percentage");

325 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.last_full");

326 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.design");

327 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.capacity_state");

328 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.warning");

329 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.low");

330 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.granularity_1");

331 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.granularity_2");

332 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.rate");

333 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.voltage.unit");

334 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.voltage.design");

335 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.voltage.current");

336 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.alarm.unit");

337 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.alarm.design");

338 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.reporting.current");

339 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.reporting.last_full");

340 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.reporting.design");

341 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.reporting.rate");

342 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.reporting.warning");

343 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.reporting.low");

344 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.reporting.granularity_1");

345 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.reporting.granularity_2");

346 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.reporting.unit");

347 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.remaining_time");

348 
	}
}

	@hald/device_pm.h

26 #iâdeà
DEVICE_PM_H


27 
	#DEVICE_PM_H


	)

29 
	~"deviû.h
"

31 
deviû_pm_»move_İtiÚ®_´İs
 (
H®Deviû
 *
d
);

32 
deviû_pm_ab¡¿ù_´İs
 (
H®Deviû
 *
d
);

33 
deviû_pm_ÿlcuÏ‹_³rûÁage
 (
H®Deviû
 *
d
);

34 
deviû_pm_ÿlcuÏ‹_time
 (
H®Deviû
 *
d
);

	@hald/device_store.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dio.h
>

32 
	~<¡ršg.h
>

34 
	~"deviû_¡Üe.h
"

35 
	~"h®d_m¬sh®.h
"

36 
	~"logg”.h
"

38 
GObjeùCÏss
 *
	g·»Á_şass
;

41 
	mSTORE_CHANGED
,

42 
	mDEVICE_PROPERTY_CHANGED
,

43 
	mDEVICE_CAPABILITY_ADDED
,

44 
	mDEVICE_LOCK_ACQUIRED
,

45 
	mDEVICE_LOCK_RELEASED
,

46 
	mLAST_SIGNAL


49 
gušt
 
	gsigÇls
[
LAST_SIGNAL
] = { 0 };

52 
	$h®_deviû_¡Üe_fš®ize
 (
GObjeù
 *
obj
)

54 
H®DeviûStÜe
 *
¡Üe
 = 
	`HAL_DEVICE_STORE
 (
obj
);

56 
	`g_¦i¡_fÜ—ch
 (
¡Üe
->
deviûs
, (
GFunc
è
g_objeù_uÄef
, 
NULL
);

58 ià(
·»Á_şass
->
fš®ize
)

59 
·»Á_şass
->
	`fš®ize
 (
obj
);

60 
	}
}

63 
	$h®_deviû_¡Üe_şass_š™
 (
H®DeviûStÜeCÏss
 *
kÏss
)

65 
GObjeùCÏss
 *
obj_şass
 = (GObjeùCÏs *è
kÏss
;

67 
·»Á_şass
 = 
	`g_ty³_şass_³ek_·»Á
 (
kÏss
);

69 
obj_şass
->
fš®ize
 = 
h®_deviû_¡Üe_fš®ize
;

71 
sigÇls
[
STORE_CHANGED
] =

72 
	`g_sigÇl_Ãw
 ("store_changed",

73 
	`G_TYPE_FROM_CLASS
 (
kÏss
),

74 
G_SIGNAL_RUN_LAST
,

75 
	`G_STRUCT_OFFSET
 (
H®DeviûStÜeCÏss
,

76 
¡Üe_chªged
),

77 
NULL
, NULL,

78 
h®d_m¬sh®_VOID__OBJECT_BOOL
,

79 
G_TYPE_NONE
, 2,

80 
G_TYPE_OBJECT
,

81 
G_TYPE_BOOLEAN
);

83 
sigÇls
[
DEVICE_PROPERTY_CHANGED
] =

84 
	`g_sigÇl_Ãw
 ("device_property_changed",

85 
	`G_TYPE_FROM_CLASS
 (
kÏss
),

86 
G_SIGNAL_RUN_LAST
,

87 
	`G_STRUCT_OFFSET
 (
H®DeviûStÜeCÏss
,

88 
deviû_´İ”ty_chªged
),

89 
NULL
, NULL,

90 
h®d_m¬sh®_VOID__OBJECT_STRING_BOOL_BOOL
,

91 
G_TYPE_NONE
, 4,

92 
G_TYPE_OBJECT
,

93 
G_TYPE_STRING
,

94 
G_TYPE_BOOLEAN
,

95 
G_TYPE_BOOLEAN
);

97 
sigÇls
[
DEVICE_CAPABILITY_ADDED
] =

98 
	`g_sigÇl_Ãw
 ("device_capability_added",

99 
	`G_TYPE_FROM_CLASS
 (
kÏss
),

100 
G_SIGNAL_RUN_LAST
,

101 
	`G_STRUCT_OFFSET
 (
H®DeviûStÜeCÏss
,

102 
deviû_ÿ·b™y_added
),

103 
NULL
, NULL,

104 
h®d_m¬sh®_VOID__OBJECT_STRING
,

105 
G_TYPE_NONE
, 2,

106 
G_TYPE_OBJECT
,

107 
G_TYPE_STRING
);

109 
sigÇls
[
DEVICE_LOCK_ACQUIRED
] =

110 
	`g_sigÇl_Ãw
 ("device_lock_acquired",

111 
	`G_TYPE_FROM_CLASS
 (
kÏss
),

112 
G_SIGNAL_RUN_LAST
,

113 
	`G_STRUCT_OFFSET
 (
H®DeviûStÜeCÏss
,

114 
deviû_lock_acquœed
),

115 
NULL
, NULL,

116 
h®d_m¬sh®_VOID__OBJECT_STRING_STRING
,

117 
G_TYPE_NONE
, 3,

118 
G_TYPE_OBJECT
,

119 
G_TYPE_STRING
,

120 
G_TYPE_STRING
);

122 
sigÇls
[
DEVICE_LOCK_RELEASED
] =

123 
	`g_sigÇl_Ãw
 ("device_lock_released",

124 
	`G_TYPE_FROM_CLASS
 (
kÏss
),

125 
G_SIGNAL_RUN_LAST
,

126 
	`G_STRUCT_OFFSET
 (
H®DeviûStÜeCÏss
,

127 
deviû_lock_»Ëa£d
),

128 
NULL
, NULL,

129 
h®d_m¬sh®_VOID__OBJECT_STRING_STRING
,

130 
G_TYPE_NONE
, 3,

131 
G_TYPE_OBJECT
,

132 
G_TYPE_STRING
,

133 
G_TYPE_STRING
);

135 
	}
}

138 
	$h®_deviû_¡Üe_š™
 (
H®DeviûStÜe
 *
deviû
)

140 
deviû
->
´İ”ty_šdex
 = 
	`g_hash_bË_Ãw_fuÎ
 (
g_¡r_hash
, 
g_¡r_equ®
, 
g_ä“
, 
NULL
);

141 
	}
}

143 
GTy³


144 
	$h®_deviû_¡Üe_g‘_ty³
 ()

146 
GTy³
 
ty³
 = 0;

148 ià(!
ty³
) {

149 
GTy³Info
 
ty³_šfo
 = {

150  (
H®DeviûStÜeCÏss
),

151 
NULL
, NULL,

152 (
GCÏssIn™Func
è
h®_deviû_¡Üe_şass_š™
,

153 
NULL
, NULL,

154  (
H®DeviûStÜe
),

156 (
GIn¡ªûIn™Func
è
h®_deviû_¡Üe_š™


159 
ty³
 = 
	`g_ty³_»gi¡”_¡©ic
 (
G_TYPE_OBJECT
,

161 &
ty³_šfo
,

165  
ty³
;

166 
	}
}

168 
H®DeviûStÜe
 *

169 
	$h®_deviû_¡Üe_Ãw
 ()

171 
H®DeviûStÜe
 *
¡Üe
;

173 
¡Üe
 = 
	`g_objeù_Ãw
 (
HAL_TYPE_DEVICE_STORE
, 
NULL
, NULL);

175  
¡Üe
;

176 
	}
}

179 
´İ”ty_šdex_check_®l
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
, 
gboŞ—n
 
add
);

182 
´İ”ty_šdex_modify_¡ršg
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
,

183 cÚ¡ *
key
, 
gboŞ—n
 
added
);

186 
	$deviû_´e_´İ”ty_chªged
 (
H®Deviû
 *
deviû
,

187 cÚ¡ *
key
,

188 
gboŞ—n
 
»moved
,

189 
gpoš‹r
 
d©a
)

191 
H®DeviûStÜe
 *
¡Üe
 = 
	`HAL_DEVICE_STORE
 (
d©a
);

193 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
deviû
, 
key
è=ğ
HAL_PROPERTY_TYPE_STRING
) {

194 
	`´İ”ty_šdex_modify_¡ršg
(
¡Üe
, 
deviû
, 
key
, 
FALSE
);

196 
	}
}

200 
	$em™_deviû_´İ”ty_chªged
 (
H®Deviû
 *
deviû
,

201 cÚ¡ *
key
,

202 
gboŞ—n
 
added
,

203 
gboŞ—n
 
»moved
,

204 
gpoš‹r
 
d©a
)

206 
H®DeviûStÜe
 *
¡Üe
 = 
	`HAL_DEVICE_STORE
 (
d©a
);

208 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
deviû
, 
key
è=ğ
HAL_PROPERTY_TYPE_STRING
) {

209 
	`´İ”ty_šdex_modify_¡ršg
(
¡Üe
, 
deviû
, 
key
, 
TRUE
);

212 
	`g_sigÇl_em™
 (
¡Üe
, 
sigÇls
[
DEVICE_PROPERTY_CHANGED
], 0,

213 
deviû
, 
key
, 
added
, 
»moved
);

214 
	}
}

217 
	$em™_deviû_ÿ·b™y_added
 (
H®Deviû
 *
deviû
,

218 cÚ¡ *
ÿ·b™y
,

219 
gpoš‹r
 
d©a
)

221 
H®DeviûStÜe
 *
¡Üe
 = 
	`HAL_DEVICE_STORE
 (
d©a
);

223 
	`g_sigÇl_em™
 (
¡Üe
, 
sigÇls
[
DEVICE_CAPABILITY_ADDED
], 0,

224 
deviû
, 
ÿ·b™y
);

225 
	}
}

228 
	$em™_deviû_lock_acquœed
 (
H®Deviû
 *
deviû
,

229 cÚ¡ *
lock_Çme
,

230 cÚ¡ *
lock_owÃr
,

231 
gpoš‹r
 
d©a
)

233 
H®DeviûStÜe
 *
¡Üe
 = 
	`HAL_DEVICE_STORE
 (
d©a
);

235 
	`g_sigÇl_em™
 (
¡Üe
, 
sigÇls
[
DEVICE_LOCK_ACQUIRED
], 0,

236 
deviû
, 
lock_Çme
, 
lock_owÃr
);

237 
	}
}

240 
	$em™_deviû_lock_»Ëa£d
 (
H®Deviû
 *
deviû
,

241 cÚ¡ *
lock_Çme
,

242 cÚ¡ *
lock_owÃr
,

243 
gpoš‹r
 
d©a
)

245 
H®DeviûStÜe
 *
¡Üe
 = 
	`HAL_DEVICE_STORE
 (
d©a
);

247 
	`g_sigÇl_em™
 (
¡Üe
, 
sigÇls
[
DEVICE_LOCK_RELEASED
], 0,

248 
deviû
, 
lock_Çme
, 
lock_owÃr
);

249 
	}
}

252 
	$h®_deviû_¡Üe_add
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
)

254 cÚ¡ 
buf
[] = "/org/freedesktop/Hal/devices/";

256 ià(
	`¡ºcmp
(
	`h®_deviû_g‘_udi
 (
deviû
), 
buf
,  (buf) - 1) != 0) {

258 
	`HAL_ERROR
(("Can't‡dd HalDevice with incorrect UDI. Valid "

260 
out
;

262 
¡Üe
->
deviûs
 = 
	`g_¦i¡_´•’d
 (store->devices,

263 
	`g_objeù_»f
 (
deviû
));

265 
	`g_sigÇl_cÚÃù
 (
deviû
, "property_changed",

266 
	`G_CALLBACK
 (
em™_deviû_´İ”ty_chªged
), 
¡Üe
);

267 
	`g_sigÇl_cÚÃù
 (
deviû
, "pre_property_changed",

268 
	`G_CALLBACK
 (
deviû_´e_´İ”ty_chªged
), 
¡Üe
);

269 
	`g_sigÇl_cÚÃù
 (
deviû
, "capability_added",

270 
	`G_CALLBACK
 (
em™_deviû_ÿ·b™y_added
), 
¡Üe
);

271 
	`g_sigÇl_cÚÃù
 (
deviû
, "lock_acquired",

272 
	`G_CALLBACK
 (
em™_deviû_lock_acquœed
), 
¡Üe
);

273 
	`g_sigÇl_cÚÃù
 (
deviû
, "lock_released",

274 
	`G_CALLBACK
 (
em™_deviû_lock_»Ëa£d
), 
¡Üe
);

276 
	`´İ”ty_šdex_check_®l
 (
¡Üe
, 
deviû
, 
TRUE
);

277 
	`g_sigÇl_em™
 (
¡Üe
, 
sigÇls
[
STORE_CHANGED
], 0, 
deviû
, 
TRUE
);

279 
out
:

281 
	}
}

283 
gboŞ—n


284 
	$h®_deviû_¡Üe_»move
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
)

286 ià(!
	`g_¦i¡_fšd
 (
¡Üe
->
deviûs
, 
deviû
))

287  
FALSE
;

289 
¡Üe
->
deviûs
 = 
	`g_¦i¡_»move
 (¡Üe->deviûs, 
deviû
);

291 
	`g_sigÇl_hªdËrs_discÚÃù_by_func
 (
deviû
,

292 (
gpoš‹r
)
em™_deviû_´İ”ty_chªged
,

293 
¡Üe
);

294 
	`g_sigÇl_hªdËrs_discÚÃù_by_func
 (
deviû
,

295 (
gpoš‹r
)
deviû_´e_´İ”ty_chªged
,

296 
¡Üe
);

297 
	`g_sigÇl_hªdËrs_discÚÃù_by_func
 (
deviû
,

298 (
gpoš‹r
)
em™_deviû_ÿ·b™y_added
,

299 
¡Üe
);

300 
	`g_sigÇl_hªdËrs_discÚÃù_by_func
 (
deviû
,

301 (
gpoš‹r
)
em™_deviû_lock_acquœed
,

302 
¡Üe
);

303 
	`g_sigÇl_hªdËrs_discÚÃù_by_func
 (
deviû
,

304 (
gpoš‹r
)
em™_deviû_lock_»Ëa£d
,

305 
¡Üe
);

307 
	`´İ”ty_šdex_check_®l
 (
¡Üe
, 
deviû
, 
FALSE
);

309 
	`g_sigÇl_em™
 (
¡Üe
, 
sigÇls
[
STORE_CHANGED
], 0, 
deviû
, 
FALSE
);

311 
	`g_objeù_uÄef
 (
deviû
);

313  
TRUE
;

314 
	}
}

316 
H®Deviû
 *

317 
	$h®_deviû_¡Üe_fšd
 (
H®DeviûStÜe
 *
¡Üe
, cÚ¡ *
udi
)

319 
GSLi¡
 *
™”
;

321 
™”
 = 
¡Üe
->
deviûs
; i‹¸!ğ
NULL
; i‹¸ğ™”->
Ãxt
) {

322 
H®Deviû
 *
d
 = 
™”
->
d©a
;

324 ià(
	`¡rcmp
 (
	`h®_deviû_g‘_udi
 (
d
), 
udi
) == 0)

325  
d
;

328  
NULL
;

329 
	}
}

332 
	$h®_deviû_¡Üe_fÜ—ch
 (
H®DeviûStÜe
 *
¡Üe
,

333 
H®DeviûStÜeFÜ—chFn
 
ÿÎback
,

334 
gpoš‹r
 
u£r_d©a
)

336 
GSLi¡
 *
™”
;

338 
	`g_»tuº_if_ç
 (
¡Üe
 !ğ
NULL
);

339 
	`g_»tuº_if_ç
 (
ÿÎback
 !ğ
NULL
);

341 
™”
 = 
¡Üe
->
deviûs
; i‹¸!ğ
NULL
; i‹¸ğ™”->
Ãxt
) {

342 
H®Deviû
 *
d
 = 
	`HAL_DEVICE
 (
™”
->
d©a
);

343 
gboŞ—n
 
cÚt
;

345 
cÚt
 = 
	`ÿÎback
 (
¡Üe
, 
d
, 
u£r_d©a
);

347 ià(
cÚt
 =ğ
FALSE
)

350 
	}
}

352 
gboŞ—n


353 
	$h®_deviû_¡Üe_´št_fÜ—ch_â
 (
H®DeviûStÜe
 *
¡Üe
,

354 
H®Deviû
 *
deviû
,

355 
gpoš‹r
 
u£r_d©a
)

357 
	`årštf
 (
¡d”r
, "----\n");

358 
	`h®_deviû_´št
 (
deviû
);

359 
	`årštf
 (
¡d”r
, "----\n");

360  
TRUE
;

361 
	}
}

364 
	$h®_deviû_¡Üe_´št
 (
H®DeviûStÜe
 *
¡Üe
)

366 
	`årštf
 (
¡d”r
, "===============================================\n");

367 
	`årštf
 (
¡d”r
, "Dumping %u devices\n",

368 
	`g_¦i¡_Ëngth
 (
¡Üe
->
deviûs
));

369 
	`årštf
 (
¡d”r
, "===============================================\n");

370 
	`h®_deviû_¡Üe_fÜ—ch
 (
¡Üe
,

371 
h®_deviû_¡Üe_´št_fÜ—ch_â
,

372 
NULL
);

373 
	`årštf
 (
¡d”r
, "===============================================\n");

374 
	}
}

376 
H®Deviû
 *

377 
	$h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
H®DeviûStÜe
 *
¡Üe
,

378 cÚ¡ *
key
,

379 cÚ¡ *
v®ue
)

381 
GSLi¡
 *
™”
;

382 
GSLi¡
 *
deviûs
;

383 
GHashTabË
 *
šdex
;

385 
	`g_»tuº_v®_if_ç
 (
¡Üe
 !ğ
NULL
, NULL);

386 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, NULL);

387 
	`g_»tuº_v®_if_ç
 (
v®ue
 !ğ
NULL
, NULL);

389 
šdex
 = 
	`g_hash_bË_lookup
 (
¡Üe
->
´İ”ty_šdex
, 
key
);

391 ià(
šdex
) {

392 
deviûs
 = 
	`g_hash_bË_lookup
 (
šdex
, 
v®ue
);

393 ià(
deviûs
)

394  (
H®Deviû
*è
deviûs
->
d©a
;

396  
NULL
;

398 
™”
 = 
¡Üe
->
deviûs
; i‹¸!ğ
NULL
; i‹¸ğ™”->
Ãxt
) {

399 
H®Deviû
 *
d
 = 
	`HAL_DEVICE
 (
™”
->
d©a
);

400 
ty³
;

402 ià(!
	`h®_deviû_has_´İ”ty
 (
d
, 
key
))

405 
ty³
 = 
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
key
);

406 ià(
ty³
 !ğ
HAL_PROPERTY_TYPE_STRING
)

409 ià(
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
key
),

410 
v®ue
) == 0)

411  
d
;

415  
NULL
;

416 
	}
}

418 
H®Deviû
 *

419 
	$h®_deviû_¡Üe_m©ch_key_v®ue_št
 (
H®DeviûStÜe
 *
¡Üe
,

420 cÚ¡ *
key
,

421 
v®ue
)

423 
GSLi¡
 *
™”
;

425 
	`g_»tuº_v®_if_ç
 (
¡Üe
 !ğ
NULL
, NULL);

426 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, NULL);

428 
™”
 = 
¡Üe
->
deviûs
; i‹¸!ğ
NULL
; i‹¸ğ™”->
Ãxt
) {

429 
H®Deviû
 *
d
 = 
	`HAL_DEVICE
 (
™”
->
d©a
);

430 
ty³
;

432 ià(!
	`h®_deviû_has_´İ”ty
 (
d
, 
key
))

435 
ty³
 = 
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
key
);

436 ià(
ty³
 !ğ
HAL_PROPERTY_TYPE_INT32
)

439 ià(
	`h®_deviû_´İ”ty_g‘_št
 (
d
, 
key
è=ğ
v®ue
)

440  
d
;

443  
NULL
;

444 
	}
}

446 
GSLi¡
 *

447 
	$h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
H®DeviûStÜe
 *
¡Üe
,

448 cÚ¡ *
key
,

449 cÚ¡ *
v®ue
)

451 
GSLi¡
 *
™”
;

452 
GSLi¡
 *
m©ches
 = 
NULL
;

453 
GSLi¡
 *
deviûs
;

454 
GHashTabË
 *
šdex
;

456 
	`g_»tuº_v®_if_ç
 (
¡Üe
 !ğ
NULL
, NULL);

457 
	`g_»tuº_v®_if_ç
 (
key
 !ğ
NULL
, NULL);

458 
	`g_»tuº_v®_if_ç
 (
v®ue
 !ğ
NULL
, NULL);

460 
šdex
 = 
	`g_hash_bË_lookup
 (
¡Üe
->
´İ”ty_šdex
, 
key
);

462 ià(
šdex
) {

463 
deviûs
 = 
	`g_hash_bË_lookup
 (
šdex
, 
v®ue
);

464  
	`g_¦i¡_cİy
(
deviûs
);

466 
™”
 = 
¡Üe
->
deviûs
; i‹¸!ğ
NULL
; i‹¸ğ™”->
Ãxt
) {

467 
H®Deviû
 *
d
 = 
	`HAL_DEVICE
 (
™”
->
d©a
);

468 
ty³
;

470 ià(!
	`h®_deviû_has_´İ”ty
 (
d
, 
key
))

473 
ty³
 = 
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
key
);

474 ià(
ty³
 !ğ
HAL_PROPERTY_TYPE_STRING
)

477 ià(
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
key
),

478 
v®ue
) == 0)

479 
m©ches
 = 
	`g_¦i¡_´•’d
 (m©ches, 
d
);

483  
m©ches
;

484 
	}
}

488 
	$h®_deviû_¡Üe_šdex_´İ”ty
 (
H®DeviûStÜe
 *
¡Üe
, cÚ¡ *
key
)

490 
GHashTabË
 *
šdex
;

492 
šdex
 = 
	`g_hash_bË_lookup
 (
¡Üe
->
´İ”ty_šdex
, 
key
);

494 ià(!
šdex
) {

495 
šdex
 = 
	`g_hash_bË_Ãw
 (
g_¡r_hash
, 
g_¡r_equ®
);

496 
	`g_hash_bË_š£¹
 (
¡Üe
->
´İ”ty_šdex
, 
	`g_¡rdup
 (
key
), 
šdex
);

498 
	}
}

501 
	$´İ”ty_šdex_modify_¡ršg
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
,

502 cÚ¡ *
key
, 
gboŞ—n
 
added
)

504 
GHashTabË
 *
šdex
;

505 cÚ¡ *
v®ue
;

506 
GSLi¡
 *
deviûs
;

508 
v®ue
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
deviû
, 
key
);

509 
šdex
 = 
	`g_hash_bË_lookup
 (
¡Üe
->
´İ”ty_šdex
, 
key
);

511 ià(!
šdex
) ;

513 
deviûs
 = 
	`g_hash_bË_lookup
 (
šdex
, 
v®ue
);

515 ià(
added
) {

516 
	`HAL_DEBUG
 (("addšg %°tØ(%s,%s)", 
deviû
, 
key
, 
v®ue
));

517 
deviûs
 = 
	`g_¦i¡_´•’d
 (deviûs, 
deviû
);

519 
	`HAL_DEBUG
 (("»movšg %°äom (%s,%s)", 
deviû
, 
key
, 
v®ue
));

520 
deviûs
 = 
	`g_¦i¡_»move_®l
 (deviûs, 
deviû
);

522 
	`g_hash_bË_š£¹
 (
šdex
, (
gpoš‹r
è
v®ue
, 
deviûs
);

523 
	}
}

525 #ià
GLIB_CHECK_VERSION
 (2,14,0)

528 
šlše
 

529 
	$li¡_keys
 (
gpoš‹r
 
key
, gpoš‹¸
v®ue
, 
GLi¡
 **
keys
)

531 *
keys
 = 
	`g_li¡_­³nd
 (*keys, 
key
);

532 
	}
}

534 
šlše
 
GLi¡
*

535 
	$g_hash_bË_g‘_keys
 (
GHashTabË
 *
hash
)

537 
GLi¡
 *
keys
 = 
NULL
;

538 
	`g_hash_bË_fÜ—ch
 (
hash
, (
GHFunc
)
li¡_keys
, &
keys
);

539  
keys
;

540 
	}
}

544 
	$´İ”ty_šdex_check_®l
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
, 
gboŞ—n
 
added
)

546 
GLi¡
 *
šdexed_´İ”t›s
, *
Í
;

548 
šdexed_´İ”t›s
 = 
	`g_hash_bË_g‘_keys
 (
¡Üe
->
´İ”ty_šdex
);

549 
Í
 = 
šdexed_´İ”t›s
;†p;†°ğ
	`g_li¡_Ãxt
 (lp)) {

550 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
deviû
, 
Í
->
d©a
è=ğ
HAL_PROPERTY_TYPE_STRING
) {

551 
	`´İ”ty_šdex_modify_¡ršg
 (
¡Üe
, 
deviû
, 
Í
->
d©a
, 
added
);

554 
	`g_li¡_ä“
 (
šdexed_´İ”t›s
);

555 
	}
}

	@hald/device_store.h

27 #iâdeà
DEVICE_STORE_H


28 
	#DEVICE_STORE_H


	)

30 
	~<glib-objeù.h
>

32 
	~"deviû.h
"

34 
_H®DeviûStÜe
 
	tH®DeviûStÜe
;

35 
_H®DeviûStÜeCÏss
 
	tH®DeviûStÜeCÏss
;

37 
	s_H®DeviûStÜe
 {

38 
GObjeù
 
	m·»Á
;

40 
GSLi¡
 *
	mdeviûs
;

41 
GHashTabË
 *
	m´İ”ty_šdex
;

44 
	s_H®DeviûStÜeCÏss
 {

45 
GObjeùCÏss
 
	m·»Á_şass
;

48 (*
	m¡Üe_chªged
è(
H®DeviûStÜe
 *
	m¡Üe
,

49 
H®Deviû
 *
	mdeviû
,

50 
gboŞ—n
 
	madded
);

52 (*
	mdeviû_´İ”ty_chªged
è(
H®DeviûStÜe
 *
	m¡Üe
,

53 
H®Deviû
 *
	mdeviû
,

54 cÚ¡ *
	mkey
,

55 
gboŞ—n
 
	m»moved
,

56 
gboŞ—n
 
	madded
);

58 (*
	mdeviû_ÿ·b™y_added
è(
H®DeviûStÜe
 *
	m¡Üe
,

59 
H®Deviû
 *
	mdeviû
,

60 cÚ¡ *
	mÿ·b™y
);

63 (*
	mdeviû_lock_acquœed
è(
H®DeviûStÜe
 *
	m¡Üe
,

64 
H®Deviû
 *
	mdeviû
,

65 cÚ¡ *
	mlock_Çme
,

66 cÚ¡ *
	mlock_owÃr
);

68 (*
	mdeviû_lock_»Ëa£d
è(
H®DeviûStÜe
 *
	m¡Üe
,

69 
H®Deviû
 *
	mdeviû
,

70 cÚ¡ *
	mlock_Çme
,

71 cÚ¡ *
	mlock_owÃr
);

74 
	#HAL_TYPE_DEVICE_STORE
 (
	`h®_deviû_¡Üe_g‘_ty³
 ())

	)

75 
	#HAL_DEVICE_STORE
(
obj
è(
	`G_TYPE_CHECK_INSTANCE_CAST
 ((obj),\

76 
HAL_TYPE_DEVICE_STORE
, \

77 
H®DeviûStÜe
))

	)

78 
	#HAL_DEVICE_STORE_CLASS
(
kÏss
è(
	`G_TYPE_CHECK_CLASS_CAST
 ((klass), \

79 
HAL_TYPE_DEVICE_STORE
, \

80 
H®DeviûStÜeCÏss
))

	)

81 
	#HAL_IS_DEVICE_STORE
(
obj
è(
	`G_TYPE_CHECK_INSTANCE_TYPE
 ((obj),\

82 
HAL_TYPE_DEVICE_STORE
))

	)

83 
	#HAL_IS_DEVICE_STORE_CLASS
(
kÏss
è(
	`G_TYPE_CHECK_CLASS_TYPE
 ((klass), \

84 
HAL_TYPE_DEVICE_STORE
))

	)

86 (*
	tH®DeviûStÜeAsyncC®lback
è(
	tH®DeviûStÜe
 *
	t¡Üe
,

87 
	tH®Deviû
 *
	tdeviû
,

88 
	tgpoš‹r
 
	tu£r_d©a
);

91 
	$gboŞ—n
 (*
	tH®DeviûStÜeFÜ—chFn
è(
	tH®DeviûStÜe
 *
	t¡Üe
,

92 
	tH®Deviû
 *
	tdeviû
,

93 
	tgpoš‹r
 
	tu£r_d©a
);

95 
GTy³
 
	`h®_deviû_¡Üe_g‘_ty³
 ();

97 
H®DeviûStÜe
 *
	`h®_deviû_¡Üe_Ãw
 ();

99 
	`h®_deviû_¡Üe_add
 (
H®DeviûStÜe
 *
¡Üe
,

100 
H®Deviû
 *
deviû
);

101 
gboŞ—n
 
	`h®_deviû_¡Üe_»move
 (
H®DeviûStÜe
 *
¡Üe
,

102 
H®Deviû
 *
deviû
);

104 
H®Deviû
 *
	`h®_deviû_¡Üe_fšd
 (
H®DeviûStÜe
 *
¡Üe
,

105 cÚ¡ *
udi
);

107 
	`h®_deviû_¡Üe_fÜ—ch
 (
H®DeviûStÜe
 *
¡Üe
,

108 
H®DeviûStÜeFÜ—chFn
 
ÿÎback
,

109 
gpoš‹r
 
u£r_d©a
);

111 
H®Deviû
 *
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
H®DeviûStÜe
 *
¡Üe
,

112 cÚ¡ *
key
,

113 cÚ¡ *
v®ue
);

115 
H®Deviû
 *
	`h®_deviû_¡Üe_m©ch_key_v®ue_št
 (
H®DeviûStÜe
 *
¡Üe
,

116 cÚ¡ *
key
,

117 
v®ue
);

119 
GSLi¡
 *
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
H®DeviûStÜe
 *
¡Üe
,

120 cÚ¡ *
key
,

121 cÚ¡ *
v®ue
);

123 
	`h®_deviû_¡Üe_´št
 (
H®DeviûStÜe
 *
¡Üe
);

125 
	`h®_deviû_¡Üe_šdex_´İ”ty
 (
H®DeviûStÜe
 *
¡Üe
, cÚ¡ *
key
);

	@hald/dummy/osspec.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<glib.h
>

31 
	~<dbus/dbus.h
>

32 
	~<dbus/dbus-glib.h
>

34 
	~"../os¥ec.h
"

35 
	~"../logg”.h
"

36 
	~"../h®d.h
"

37 
	~"../ut.h
"

38 
	~"../deviû_šfo.h
"

40 
H®FeMÚ™Ü
 *

41 
	$os¥ec_g‘_fe_mÚ™Ü
 ()

43  
NULL
;

44 
	}
}

46 
gušt


47 
	$h®_fe_mÚ™Ü_add_nÙify
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

48 cÚ¡ *
·th
,

49 
mask
,

50 
H®FeMÚ™ÜNÙifyFunc
 
nÙify_func
,

51 
gpoš‹r
 
d©a
)

54 
	}
}

57 
	$os¥ec_´iveged_š™
 ()

59 
	}
}

62 
	$os¥ec_š™
 ()

64 
	}
}

67 
	$compu‹r_ÿÎouts_add_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

69 
	`HAL_INFO
 (("Add c®lout com¶‘ed udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

72 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

73 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

75 
	`os¥ec_´obe_dÚe
 ();

76 
	}
}

79 
	$os¥ec_´obe
 ()

81 
H®Deviû
 *
roÙ
;

83 
roÙ
 = 
	`h®_deviû_Ãw
 ();

84 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
roÙ
, "info.subsystem", "unknown");

85 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
roÙ
, "info.product", "Computer");

86 
	`h®_deviû_£t_udi
 (
roÙ
, "/org/freedesktop/Hal/devices/computer");

88 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
roÙ
);

90 
	`di_£¬ch_ªd_m”ge
 (
roÙ
, 
DEVICE_INFO_TYPE_INFORMATION
);

91 
	`di_£¬ch_ªd_m”ge
 (
roÙ
, 
DEVICE_INFO_TYPE_POLICY
);

93 
	`h®_ut_ÿÎout_deviû_add
 (
roÙ
, 
compu‹r_ÿÎouts_add_dÚe
, 
NULL
, NULL);

94 
	}
}

96 
DBusHªdËrResuÉ


97 
	$os¥ec_f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£r_d©a
)

99  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

100 
	}
}

102 
gboŞ—n


103 
	$os¥ec_deviû_»sÿn
 (
H®Deviû
 *
d
)

105  
FALSE
;

106 
	}
}

108 
gboŞ—n


109 
	$os¥ec_deviû_»´obe
 (
H®Deviû
 *
d
)

111  
FALSE
;

112 
	}
}

115 
	$os¥ec_»äesh_mouÁ_¡©e_fÜ_block_deviû
 (
H®Deviû
 *
d
)

117 
	}
}

	@hald/freebsd/addons/addon-storage.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

29 
	~<¡dlib.h
>

30 
	~<as£¹.h
>

31 
	~<fú.h
>

32 
	~<uni¡d.h
>

34 
	~"libh®/libh®.h
"

36 
	~"../lib´obe/hå.h
"

37 
	~"../lib´obe/hå-cdrom.h
"

41 cÚ¡ 
timev®
 
	mupd©e_š‹rv®
;

42 *
	mdeviû_fe
;

43 *
	m·»Á
;

44 
boŞ—n
 
	mis_cdrom
;

45 
boŞ—n
 
	mis_scsi_»movabË
;

46 
boŞ—n
 
	mhad_medŸ
;

47 
timev®
 
	mÃxt_upd©e
;

48 } 
	gaddÚ
 = { { 2, 0 } };

51 
boŞ—n


52 
	$hf_addÚ_¡Üage_cdrom_ejeù_´es£d
 (
HFPCDROM
 *
cdrom
)

54 
buf
[8];

55 
ccb
[16] = {

56 
HFP_CDROM_GET_EVENT_STATUS_NOTIFICATION
,

64 
	`HFP_N_ELEMENTS
(
buf
)

67 
	`as£¹
(
cdrom
 !ğ
NULL
);

69  
	`hå_cdrom_£nd_ccb
(
cdrom
, 
ccb
, 10, 
HFP_CDROM_DIRECTION_IN
, 
buf
, (buf), 
NULL
)

70 && 
buf
[1] >= 6

71 && 
buf
[4] == 0x1;

72 
	}
}

74 
boŞ—n


75 
	$hf_addÚ_¡Üage_scsi_»ad_ÿ·c™y
 (
HFPCDROM
 *
scsi_deviû
)

77 
buf
[8];

78 
ccb
[16] = { 0x25 };

80 
	`as£¹
(
scsi_deviû
 !ğ
NULL
);

83  
	`hå_cdrom_£nd_ccb
(
scsi_deviû
, 
ccb
, 10, 
HFP_CDROM_DIRECTION_IN
, 
buf
, (buf), 
NULL
);

84 
	}
}

86 
boŞ—n


87 
	$hf_addÚ_¡Üage_upd©e
 ()

89 
boŞ—n
 
has_medŸ
 = 
FALSE
;

91 ià(
addÚ
.
is_cdrom
)

93 
HFPCDROM
 *
cdrom
;

95 
cdrom
 = 
	`hå_cdrom_Ãw
(
addÚ
.
deviû_fe
,‡ddÚ.
·»Á
);

96 ià(
cdrom
)

98 ià(
	`hå_cdrom_‹¡_un™_»ady
(
cdrom
))

99 
has_medŸ
 = 
TRUE
;

101 ià(
	`hf_addÚ_¡Üage_cdrom_ejeù_´es£d
(
cdrom
))

103 
	`libh®_deviû_em™_cÚd™iÚ
(
hå_ùx
, 
hå_udi
, "EjeùP»s£d", "", &
hå_”rÜ
);

104 
	`dbus_”rÜ_ä“
(&
hå_”rÜ
);

107 
	`hå_cdrom_ä“
(
cdrom
);

110 ià(
addÚ
.
is_scsi_»movabË
)

118 
HFPCDROM
 *
scsi_deviû
;

123 
scsi_deviû
 = 
	`hå_cdrom_Ãw_äom_fd
(-1, 
addÚ
.
deviû_fe
,‡ddÚ.
·»Á
);

124 ià(
scsi_deviû
)

129 ià(
	`hå_cdrom_‹¡_un™_»ady
(
scsi_deviû
è&& 
	`hf_addÚ_¡Üage_scsi_»ad_ÿ·c™y
(scsi_device))

130 
has_medŸ
 = 
TRUE
;

132 
	`hå_cdrom_ä“
(
scsi_deviû
);

137 
fd
;

139 
fd
 = 
	`İ’
(
addÚ
.
deviû_fe
, 
O_RDONLY
);

140 ià(
fd
 >= 0)

142 
has_medŸ
 = 
TRUE
;

143 
	`şo£
(
fd
);

147 
	`hå_g‘timeofday
(&
addÚ
.
Ãxt_upd©e
);

148 
	`hå_timev®add
(&
addÚ
.
Ãxt_upd©e
, &addÚ.
upd©e_š‹rv®
);

150  
has_medŸ
;

151 
	}
}

153 
boŞ—n


154 
	$pŞl_fÜ_medŸ
 ()

156 
boŞ—n
 
has_medŸ
;

158 
has_medŸ
 = 
	`hf_addÚ_¡Üage_upd©e
();

159 ià(
has_medŸ
 !ğ
addÚ
.
had_medŸ
)

172 
	`libh®_deviû_»sÿn
(
hå_ùx
, 
hå_udi
, &
hå_”rÜ
);

173 
	`dbus_”rÜ_ä“
(&
hå_”rÜ
);

174 
addÚ
.
had_medŸ
 = 
has_medŸ
;

176  
TRUE
;

178  
FALSE
;

179 
	}
}

182 
	$upd©e_´oc_t™Ë
 (cÚ¡ *
deviû
, 
boŞ—n
 
pŞlšg_’abËd
)

184 ià(
pŞlšg_’abËd
)

185 
	`£roù™Ë
("%s", 
deviû
);

187 
	`£roù™Ë
("nØpŞlšg oÀ% beÿu£ iˆi ex¶ic™ly di§bËd", 
deviû
);

188 
	}
}

190 
DBusHªdËrResuÉ


191 
	$f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£r_d©a
)

193 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
mes§ge
,

197 
DBusMes§ge
 *
»¶y
;

198 
dbus_boŞ_t
 
had_efãù
;

200 
	`hå_šfo
("Forcing…oll for media becusse CheckForMedia() was called");

202 
had_efãù
 = 
	`pŞl_fÜ_medŸ
();

204 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

205 
	`dbus_mes§ge_­³nd_¬gs
(
»¶y
, 
DBUS_TYPE_BOOLEAN
, &
had_efãù
, 
DBUS_TYPE_INVALID
);

206 
	`dbus_cÚÃùiÚ_£nd
(
cÚÃùiÚ
, 
»¶y
, 
NULL
);

207 
	`dbus_mes§ge_uÄef
(
»¶y
);

210  
DBUS_HANDLER_RESULT_HANDLED
;

211 
	}
}

214 
	$maš
 (
¬gc
, **
¬gv
)

216 *
drive_ty³
;

217 *
»movabË
;

218 *
bus
;

219 *
driv”
;

220 
boŞ—n
 
should_pŞl
;

221 
DBusCÚÃùiÚ
 *
cÚÃùiÚ
;

223 ià(! 
	`hå_š™
(
¬gc
, 
¬gv
))

224 
’d
;

226 
addÚ
.
deviû_fe
 = 
	`g‘’v
("HAL_PROP_BLOCK_DEVICE");

227 ià(! 
addÚ
.
deviû_fe
)

228 
’d
;

230 
drive_ty³
 = 
	`g‘’v
("HAL_PROP_STORAGE_DRIVE_TYPE");

231 ià(! 
drive_ty³
)

232 
’d
;

234 
»movabË
 = 
	`g‘’v
("HAL_PROP_STORAGE_REMOVABLE");

235 ià(! 
»movabË
)

236 
’d
;

238 
bus
 = 
	`g‘’v
("HAL_PROP_STORAGE_BUS");

239 ià(! 
bus
)

240 
’d
;

242 
driv”
 = 
	`g‘’v
("HAL_PROP_FREEBSD_DRIVER");

243 ià(! 
driv”
)

244 
’d
;

246 
addÚ
.
·»Á
 = 
	`g‘’v
("HAL_PROP_INFO_PARENT");

247 ià(! 
addÚ
.
·»Á
)

248 
’d
;

250 
addÚ
.
is_cdrom
 = ! 
	`¡rcmp
(
drive_ty³
, "cdrom");

251 
addÚ
.
is_scsi_»movabË
 = (! 
	`¡rcmp
(
bus
, "scsi") ||

252 (! 
	`¡rcmp
(
bus
, "usb"è&& (! sŒcmp(
driv”
, "da") || ! strcmp(driver, "sa") ||

253 ! 
	`¡rcmp
(
driv”
, "cd")))è&& ! sŒcmp(
»movabË
, "true");

254 
addÚ
.
had_medŸ
 = 
	`hf_addÚ_¡Üage_upd©e
();

256 ià(! 
	`libh®_deviû_addÚ_is_»ady
(
hå_ùx
, 
hå_udi
, &
hå_”rÜ
))

257 
’d
;

258 
	`dbus_”rÜ_ä“
(&
hå_”rÜ
);

260 
cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
(
hå_ùx
);

261 
	`as£¹
(
cÚÃùiÚ
 !ğ
NULL
);

262 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
(
cÚÃùiÚ
, 0);

263 
	`dbus_cÚÃùiÚ_add_f‹r
(
cÚÃùiÚ
, 
f‹r_funùiÚ
, 
NULL
, NULL);

265 ià(! 
	`libh®_deviû_şaim_š‹rçû
(
hå_ùx
,

266 
hå_udi
,

271 &
hå_”rÜ
))

273 
	`hå_ü™iÿl
("Cannot claim interface 'org.freedesktop.Hal.Device.Storage.Removable'");

274 
’d
;

276 
	`dbus_”rÜ_ä“
(&
hå_”rÜ
);

278 
TRUE
)

281 
TRUE
)

283 
timev®
 
now
;

285 
	`hå_g‘timeofday
(&
now
);

286 ià(
	`hå_timev®cmp
(&
now
, &
addÚ
.
Ãxt_upd©e
, <))

288 
timev®
 
timeout
;

290 
timeout
 = 
addÚ
.
Ãxt_upd©e
;

291 
	`hå_timev®sub
(&
timeout
, &
now
);

293 ià(
timeout
.
tv_£c
 < 0)

294 
timeout
 = 
addÚ
.
upd©e_š‹rv®
;

296 
	`dbus_cÚÃùiÚ_»ad_wr™e_di¥©ch
(
cÚÃùiÚ
, 
timeout
.
tv_£c
 * 1000 +imeout.
tv_u£c
 / 1000);

297 ià(! 
	`dbus_cÚÃùiÚ_g‘_is_cÚÃùed
(
cÚÃùiÚ
))

298 
’d
;

304 
should_pŞl
 = 
	`libh®_deviû_g‘_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.medŸ_check_’abËd", &
hå_”rÜ
);

305 
	`dbus_”rÜ_ä“
(&
hå_”rÜ
);

306 
	`upd©e_´oc_t™Ë
(
addÚ
.
deviû_fe
, 
should_pŞl
);

308 ià(
should_pŞl
)

310 
	`pŞl_fÜ_medŸ
();

314 
	`hå_g‘timeofday
(&
addÚ
.
Ãxt_upd©e
);

315 
	`hå_timev®add
(&
addÚ
.
Ãxt_upd©e
, &addÚ.
upd©e_š‹rv®
);

319 
’d
:

321 
	}
}

	@hald/freebsd/hal-file-monitor.c

24 
	~<¡dlib.h
>

25 
	~<¡dio.h
>

26 
	~<fú.h
>

27 
	~<time.h
>

28 
	~<uni¡d.h
>

29 
	~<¡ršg.h
>

30 
	~<”ºo.h
>

32 
	~<sys/ty³s.h
>

33 
	~<sys/ev’t.h
>

34 
	~<sys/time.h
>

35 
	~<sys/¡©.h
>

37 
	~<glib.h
>

38 
	~<glib/gi18n.h
>

39 
	~<glib/g¡dio.h
>

40 
	~<glib-objeù.h
>

42 
	~"../h®-fe-mÚ™Ü.h
"

44 
	#HAL_FILE_MONITOR_GET_PRIVATE
(
o
è(
	`G_TYPE_INSTANCE_GET_PRIVATE
 ((o), 
HAL_TYPE_FILE_MONITOR
, 
H®FeMÚ™ÜPriv©e
))

	)

46 
	#VN_NOTE_CHANGED
 (
NOTE_WRITE
 | 
NOTE_EXTEND
 | 
NOTE_ATTRIB
 | 
NOTE_LINK
)

	)

47 
	#VN_NOTE_DELETED
 (
NOTE_DELETE
 | 
NOTE_REVOKE
)

	)

48 
	#VN_NOTE_ALL
 (
VN_NOTE_CHANGED
 | 
VN_NOTE_DELETED
 | 
NOTE_RENAME
)

	)

52 *
	m·th
;

53 
	momask
;

54 
gboŞ—n
 
	misdœ
;

55 
H®FeMÚ™ÜNÙifyFunc
 
	mfunc
;

56 
gpoš‹r
 
	mud©a
;

57 
GHashTabË
 *
	mdœ_cÚ‹Ás
;

58 } 
	tFeKqueueD©a
;

62 *
	m·th
;

63 
time_t
 
	m©ime
;

64 
gboŞ—n
 
	mowÃr
;

65 
H®FeMÚ™ÜNÙifyFunc
 
	mfunc
;

66 
gpoš‹r
 
	mud©a
;

67 } 
	tFeAcûssD©a
;

69 
	sH®FeMÚ™ÜPriv©e


71 
	mkqueue_fd
;

72 
gušt
 
	mio_w©ch
;

73 
gušt
 
	macûss_sourû
;

75 
gboŞ—n
 
	mš™Ÿlized_kqueue
;

77 
GHashTabË
 *
	mfd_to_kd©a
;

78 
GHashTabË
 *
	mfd_to_ad©a
;

81 
	$G_DEFINE_TYPE
 (
H®FeMÚ™Ü
, 
h®_fe_mÚ™Ü
, 
G_TYPE_OBJECT
)

83 
gpoš‹r
 
mÚ™Ü_objeù
 = 
NULL
;

85 
	`h®_fe_mÚ™Ü_fš®ize
 (
GObjeù
 *
objeù
);

86 
GHashTabË
 *
	`g‘_dœ_cÚ‹Ás
 (cÚ¡ *
·th
);

87 
GHashTabË
 *
	`diff_dœ_cÚ‹Ás
 (
FeKqueueD©a
 *
d©a
, 
GSLi¡
 **
added
, GSLi¡ **
»moved
);

88 
	`h®_mask_to_kmask
 (
mask
);

89 
	`mÚ™Ü_»Ëa£_kd©a
 (
H®FeMÚ™Ü
 *
mÚ™Ü
, 
fd
, 
FeKqueueD©a
 *
d©a
);

90 
	`mÚ™Ü_»Ëa£_ad©a
 (
H®FeMÚ™Ü
 *
mÚ™Ü
, 
fd
, 
FeAcûssD©a
 *
d©a
);

91 
gboŞ—n
 
	`»move_kd©a_fÜ—ch
 (
gpoš‹r
 
fd
, 
FeKqueueD©a
 *
d©a
, 
H®FeMÚ™Ü
 *
mÚ™Ü
);

92 
gboŞ—n
 
	`»move_ad©a_fÜ—ch
 (
gpoš‹r
 
fd
, 
FeAcûssD©a
 *
d©a
, 
H®FeMÚ™Ü
 *
mÚ™Ü
);

93 
	`h®_fe_mÚ™Ü_»move_kd©a
 (
H®FeMÚ™Ü
 *
mÚ™Ü
, 
gušt
 
id
);

94 
	`h®_fe_mÚ™Ü_»move_ad©a
 (
H®FeMÚ™Ü
 *
mÚ™Ü
, 
gušt
 
id
);

95 
	`£tup_mÚ™Ü
 (
H®FeMÚ™Ü
 *
mÚ™Ü
);

96 
	`şo£_mÚ™Ü
 (
H®FeMÚ™Ü
 *
mÚ™Ü
);

97 
gboŞ—n
 
	`h®_fe_acûss_mÚ™Ü
 (
gpoš‹r
 
d©a
);

99 
	`em™_mÚ™Ü_ev’t
 (
H®FeMÚ™Ü
 *
mÚ™Ü
, 
H®FeMÚ™ÜEv’t
 
ev’t
, cÚ¡ *
·th
, 
H®FeMÚ™ÜNÙifyFunc
 
func
, 
gpoš‹r
 
ud©a
);

100 
gboŞ—n
 
	`hªdË_kqueue_ev’t
 (
GIOChªÃl
 *
sourû
, 
GIOCÚd™iÚ
 
cÚd™iÚ
, 
gpoš‹r
 
ud©a
);

102 
GQu¬k


103 
	$h®_fe_mÚ™Ü_”rÜ_qu¬k
 ()

105 
GQu¬k
 
»t
 = 0;

106 ià(
»t
 == 0)

108 
»t
 = 
	`g_qu¬k_äom_¡©ic_¡ršg
 ("hal_file_monitor_error");

111  
»t
;

112 
	}
}

115 
	$h®_mask_to_kmask
 (
mask
)

117 
kmask
 = 0;

119 ià(
mask
 & 
HAL_FILE_MONITOR_EVENT_CREATE
)

121 
kmask
 |ğ
NOTE_WRITE
 | 
NOTE_LINK
;

124 ià(
mask
 & 
HAL_FILE_MONITOR_EVENT_DELETE
)

126 
kmask
 |ğ
NOTE_WRITE
 | 
NOTE_LINK
 | 
VN_NOTE_DELETED
;

129 ià(
mask
 & 
HAL_FILE_MONITOR_EVENT_CHANGE
)

131 
kmask
 |ğ
VN_NOTE_CHANGED
;

134  
kmask
;

135 
	}
}

137 
gušt


138 
	$h®_fe_mÚ™Ü_add_nÙify
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

139 cÚ¡ *
·th
,

140 
mask
,

141 
H®FeMÚ™ÜNÙifyFunc
 
nÙify_func
,

142 
gpoš‹r
 
d©a
)

144 
kev’t
 
ev
;

145 
¡©
 
sb
;

146 
fd
;

147 
id
 = 0;

149 ià(! 
mÚ™Ü
->
´iv
->
š™Ÿlized_kqueue
)

151  
id
;

154 
fd
 = 
	`İ’
 (
·th
, 
O_RDONLY
);

155 ià(
fd
 < 0)

157  
id
;

160 ià(
	`f¡©
 (
fd
, &
sb
) == -1)

162 
	`şo£
 (
fd
);

163  
id
;

166 ià(
mask
 & 
HAL_FILE_MONITOR_EVENT_ACCESS
)

168 
FeAcûssD©a
 *
ad©a
;

170 
ad©a
 = 
	`g_Ãw0
 (
FeAcûssD©a
, 1);

171 
ad©a
->
·th
 = 
	`g_¡rdup
 (path);

172 
ad©a
->
©ime
 = 
sb
.
¡_©ime
;

173 
ad©a
->
func
 = 
nÙify_func
;

174 
ad©a
->
ud©a
 = 
d©a
;

175 ià(
mask
 =ğ
HAL_FILE_MONITOR_EVENT_ACCESS
)

178 
ad©a
->
owÃr
 = 
TRUE
;

180 
	`g_hash_bË_š£¹
 (
mÚ™Ü
->
´iv
->
fd_to_ad©a
,

181 
	`GINT_TO_POINTER
 (
fd
),

182 
ad©a
);

183 
id
 = 
fd
;

186 ià((
mask
 & 
HAL_FILE_MONITOR_EVENT_CREATE
) ||

187 (
mask
 & 
HAL_FILE_MONITOR_EVENT_DELETE
) ||

188 (
mask
 & 
HAL_FILE_MONITOR_EVENT_CHANGE
))

190 
FeKqueueD©a
 *
kd©a
;

191 
kmask
;

192 
gboŞ—n
 
isdœ
;

194 
kmask
 = 
	`h®_mask_to_kmask
 (
mask
);

196 
isdœ
 = (
sb
.
¡_mode
 & 
S_IFDIR
) != 0;

197 ià(! 
isdœ
 && 
mask
 =ğ
HAL_FILE_MONITOR_EVENT_CREATE
)

200 
dÚe
;

203 
kd©a
 = 
	`g_Ãw0
 (
FeKqueueD©a
, 1);

204 
kd©a
->
·th
 = 
	`g_¡rdup
 (path);

205 
kd©a
->
omask
 = 
mask
;

206 
kd©a
->
isdœ
 = isdir;

207 
kd©a
->
func
 = 
nÙify_func
;

208 
kd©a
->
ud©a
 = 
d©a
;

209 ià(
isdœ
)

211 
kd©a
->
dœ_cÚ‹Ás
 = 
	`g‘_dœ_cÚ‹Ás
 (
·th
);

215 
	`EV_SET
 (&
ev
, 
fd
, 
EVFILT_VNODE
, 
EV_ADD
 | 
EV_ENABLE
 | 
EV_CLEAR
,

216 
kmask
, 0, 
mÚ™Ü
);

217 ià(
	`kev’t
 (
mÚ™Ü
->
´iv
->
kqueue_fd
, &
ev
, 1, 
NULL
, 0, NULL) < 0)

219 
	`mÚ™Ü_»Ëa£_kd©a
 (
mÚ™Ü
, 
fd
, 
kd©a
);

220 
dÚe
;

222 
	`g_hash_bË_š£¹
 (
mÚ™Ü
->
´iv
->
fd_to_kd©a
,

223 
	`GINT_TO_POINTER
 (
fd
),

224 
kd©a
);

225 
id
 = 
fd
;

228 
dÚe
:

229  
id
;

230 
	}
}

233 
	$h®_fe_mÚ™Ü_»move_kd©a
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

234 
gušt
 
id
)

236 
FeKqueueD©a
 *
kd©a
;

238 
kd©a
 = (
FeKqueueD©a
 *è
	`g_hash_bË_lookup
 (
mÚ™Ü
->
´iv
->
fd_to_kd©a
, 
	`GINT_TO_POINTER
 (
id
));

240 ià(
kd©a
)

242 
	`g_hash_bË_»move
 (
mÚ™Ü
->
´iv
->
fd_to_kd©a
, 
	`GINT_TO_POINTER
 (
id
));

243 
	`mÚ™Ü_»Ëa£_kd©a
 (
mÚ™Ü
, 
id
, 
kd©a
);

245 
	}
}

248 
	$h®_fe_mÚ™Ü_»move_ad©a
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

249 
gušt
 
id
)

251 
FeAcûssD©a
 *
ad©a
;

253 
ad©a
 = (
FeAcûssD©a
 *è
	`g_hash_bË_lookup
 (
mÚ™Ü
->
´iv
->
fd_to_ad©a
, 
	`GINT_TO_POINTER
 (
id
));

255 ià(
ad©a
)

257 
	`g_hash_bË_»move
 (
mÚ™Ü
->
´iv
->
fd_to_ad©a
, 
	`GINT_TO_POINTER
 (
id
));

258 
	`mÚ™Ü_»Ëa£_ad©a
 (
mÚ™Ü
, 
id
, 
ad©a
);

260 
	}
}

263 
	$h®_fe_mÚ™Ü_»move_nÙify
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

264 
gušt
 
id
)

266 ià(! 
mÚ™Ü
->
´iv
->
š™Ÿlized_kqueue
)

269 
	`h®_fe_mÚ™Ü_»move_kd©a
 (
mÚ™Ü
, 
id
);

270 
	`h®_fe_mÚ™Ü_»move_ad©a
 (
mÚ™Ü
, 
id
);

272 
	}
}

275 
	$mÚ™Ü_»Ëa£_kd©a
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

276 
fd
,

277 
FeKqueueD©a
 *
d©a
)

279 
	`g_ä“
 (
d©a
->
·th
);

280 
d©a
->
·th
 = 
NULL
;

282 ià(
d©a
->
dœ_cÚ‹Ás
)

284 
	`g_hash_bË_»move_®l
 (
d©a
->
dœ_cÚ‹Ás
);

285 
	`g_hash_bË_de¡roy
 (
d©a
->
dœ_cÚ‹Ás
);

287 
d©a
->
dœ_cÚ‹Ás
 = 
NULL
;

289 
	`şo£
 (
fd
);

291 
	`g_ä“
 (
d©a
);

292 
	}
}

295 
	$mÚ™Ü_»Ëa£_ad©a
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

296 
fd
,

297 
FeAcûssD©a
 *
d©a
)

299 
	`g_ä“
 (
d©a
->
·th
);

300 
d©a
->
·th
 = 
NULL
;

302 ià(
d©a
->
owÃr
)

304 
	`şo£
 (
fd
);

307 
	`g_ä“
 (
d©a
);

308 
	}
}

310 
gboŞ—n


311 
	$»move_kd©a_fÜ—ch
 (
gpoš‹r
 
fd
,

312 
FeKqueueD©a
 *
d©a
,

313 
H®FeMÚ™Ü
 *
mÚ™Ü
)

315 
	`mÚ™Ü_»Ëa£_kd©a
 (
mÚ™Ü
, 
	`GPOINTER_TO_INT
 (
fd
), 
d©a
);

316  
TRUE
;

317 
	}
}

319 
gboŞ—n


320 
	$»move_ad©a_fÜ—ch
 (
gpoš‹r
 
fd
,

321 
FeAcûssD©a
 *
d©a
,

322 
H®FeMÚ™Ü
 *
mÚ™Ü
)

324 
	`mÚ™Ü_»Ëa£_ad©a
 (
mÚ™Ü
, 
	`GPOINTER_TO_INT
 (
fd
), 
d©a
);

325  
TRUE
;

326 
	}
}

329 
	$şo£_mÚ™Ü
 (
H®FeMÚ™Ü
 *
mÚ™Ü
)

331 ià(! 
mÚ™Ü
->
´iv
->
š™Ÿlized_kqueue
)

336 
mÚ™Ü
->
´iv
->
š™Ÿlized_kqueue
 = 
FALSE
;

338 
	`g_hash_bË_fÜ—ch_»move
 (
mÚ™Ü
->
´iv
->
fd_to_kd©a
,

339 (
GHRFunc
è
»move_kd©a_fÜ—ch
,

340 
mÚ™Ü
);

342 
	`g_hash_bË_fÜ—ch_»move
 (
mÚ™Ü
->
´iv
->
fd_to_ad©a
,

343 (
GHRFunc
è
»move_ad©a_fÜ—ch
,

344 
mÚ™Ü
);

346 ià(
mÚ™Ü
->
´iv
->
io_w©ch
)

348 
	`g_sourû_»move
 (
mÚ™Ü
->
´iv
->
io_w©ch
);

350 
mÚ™Ü
->
´iv
->
io_w©ch
 = 0;

352 ià(
mÚ™Ü
->
´iv
->
acûss_sourû
)

354 
	`g_sourû_»move
 (
mÚ™Ü
->
´iv
->
acûss_sourû
);

356 
mÚ™Ü
->
´iv
->
acûss_sourû
 = 0;

358 ià(
mÚ™Ü
->
´iv
->
kqueue_fd
 > -1)

360 
	`şo£
 (
mÚ™Ü
->
´iv
->
kqueue_fd
);

362 
mÚ™Ü
->
´iv
->
kqueue_fd
 = -1;

363 
	}
}

365 
gboŞ—n


366 
	$h®_fe_acûss_mÚ™Ü
 (
gpoš‹r
 
d©a
)

368 
H®FeMÚ™Ü
 *
mÚ™Ü
;

369 
GLi¡
 *
keys
, *
l
;

371 
	`g_»tuº_v®_if_ç
 (
	`HAL_IS_FILE_MONITOR
 (
d©a
), 
FALSE
);

373 
mÚ™Ü
 = 
	`HAL_FILE_MONITOR
 (
d©a
);

375 
	`g_»tuº_v®_if_ç
 (
mÚ™Ü
->
´iv
 !ğ
NULL
, 
FALSE
);

377 
keys
 = 
	`g_hash_bË_g‘_keys
 (
mÚ™Ü
->
´iv
->
fd_to_ad©a
);

379 
l
 = 
keys
;† !ğ
NULL
;† =†->
Ãxt
)

381 
FeAcûssD©a
 *
ad©a
;

382 
¡©
 
sb
;

383 
fd
;

385 
fd
 = 
	`GPOINTER_TO_INT
 (
l
->
d©a
);

386 
ad©a
 = 
	`g_hash_bË_lookup
 (
mÚ™Ü
->
´iv
->
fd_to_ad©a
,

387 
l
->
d©a
);

389 ià(! 
ad©a
)

394 ià(
	`f¡©
 (
fd
, &
sb
) == -1)

396 
	`g_w¬nšg
 ("FaedØ¡© %s: %s", 
ad©a
->
·th
, 
	`g_¡»¼Ü
 (
”ºo
));

397 
	`h®_fe_mÚ™Ü_»move_ad©a
 (
mÚ™Ü
, 
fd
);

401 ià(
sb
.
¡_©ime
 !ğ
ad©a
->
©ime
)

403 
ad©a
->
©ime
 = 
sb
.
¡_©ime
;

404 
	`em™_mÚ™Ü_ev’t
 (
mÚ™Ü
, 
HAL_FILE_MONITOR_EVENT_ACCESS
, 
ad©a
->
·th
,‡d©a->
func
,‡d©a->
ud©a
);

408  
TRUE
;

409 
	}
}

412 
	$£tup_mÚ™Ü
 (
H®FeMÚ™Ü
 *
mÚ™Ü
)

414 
GIOChªÃl
 *
io_chªÃl
;

415 
fd
;

417 ià(
mÚ™Ü
->
´iv
->
š™Ÿlized_kqueue
)

422 ià((
fd
 = 
	`kqueue
 ()) < 0)

424 
	`g_w¬nšg
 ("Failedo initialize kqueue: %s",

425 
	`g_¡»¼Ü
 (
”ºo
));

429 
mÚ™Ü
->
´iv
->
kqueue_fd
 = 
fd
;

431 
mÚ™Ü
->
´iv
->
fd_to_kd©a
 = 
	`g_hash_bË_Ãw
 (
g_dœeù_hash
,

432 
g_dœeù_equ®
);

433 
mÚ™Ü
->
´iv
->
fd_to_ad©a
 = 
	`g_hash_bË_Ãw
 (
g_dœeù_hash
,

434 
g_dœeù_equ®
);

436 
io_chªÃl
 = 
	`g_io_chªÃl_unix_Ãw
 (
fd
);

437 
mÚ™Ü
->
´iv
->
io_w©ch
 = 
	`g_io_add_w©ch
 (
io_chªÃl
,

438 
G_IO_IN
|
G_IO_PRI
,

439 (
GIOFunc
è
hªdË_kqueue_ev’t
,

440 
mÚ™Ü
);

441 
	`g_io_chªÃl_uÄef
 (
io_chªÃl
);

443 
mÚ™Ü
->
´iv
->
acûss_sourû
 = 
	`g_timeout_add
 (1000, (
GSourûFunc
è
h®_fe_acûss_mÚ™Ü
, monitor);

445 
mÚ™Ü
->
´iv
->
š™Ÿlized_kqueue
 = 
TRUE
;

446 
	}
}

449 
	$h®_fe_mÚ™Ü_š™
 (
H®FeMÚ™Ü
 *
mÚ™Ü
)

451 
mÚ™Ü
->
´iv
 = 
	`HAL_FILE_MONITOR_GET_PRIVATE
 (monitor);

453 
	`£tup_mÚ™Ü
 (
mÚ™Ü
);

454 
	}
}

457 
	$h®_fe_mÚ™Ü_şass_š™
 (
H®FeMÚ™ÜCÏss
 *
kÏss
)

459 
GObjeùCÏss
 *
objeù_şass
 = 
	`G_OBJECT_CLASS
 (
kÏss
);

461 
objeù_şass
->
fš®ize
 = 
h®_fe_mÚ™Ü_fš®ize
;

463 
	`g_ty³_şass_add_´iv©e
 (
kÏss
,  (
H®FeMÚ™ÜPriv©e
));

464 
	}
}

467 
	$h®_fe_mÚ™Ü_fš®ize
 (
GObjeù
 *
objeù
)

469 
H®FeMÚ™Ü
 *
mÚ™Ü
;

471 
	`g_»tuº_if_ç
 (
objeù
 !ğ
NULL
);

472 
	`g_»tuº_if_ç
 (
	`HAL_IS_FILE_MONITOR
 (
objeù
));

474 
mÚ™Ü
 = 
	`HAL_FILE_MONITOR
 (
objeù
);

476 
	`g_»tuº_if_ç
 (
mÚ™Ü
->
´iv
 !ğ
NULL
);

478 
	`şo£_mÚ™Ü
 (
mÚ™Ü
);

480 
	`g_hash_bË_de¡roy
 (
mÚ™Ü
->
´iv
->
fd_to_kd©a
);

481 
	`g_hash_bË_de¡roy
 (
mÚ™Ü
->
´iv
->
fd_to_ad©a
);

483 
	`G_OBJECT_CLASS
 (
h®_fe_mÚ™Ü_·»Á_şass
)->
	`fš®ize
 (
objeù
);

484 
	}
}

486 
H®FeMÚ™Ü
 *

487 
	$h®_fe_mÚ™Ü_Ãw
 ()

489 ià(
mÚ™Ü_objeù
 !ğ
NULL
)

491 
	`g_objeù_»f
 (
mÚ™Ü_objeù
);

495 
mÚ™Ü_objeù
 = 
	`g_objeù_Ãw
 (
HAL_TYPE_FILE_MONITOR
, 
NULL
);

497 
	`g_objeù_add_w—k_poš‹r
 (
mÚ™Ü_objeù
,

498 (
gpoš‹r
 *è&
mÚ™Ü_objeù
);

501  
	`HAL_FILE_MONITOR
 (
mÚ™Ü_objeù
);

502 
	}
}

547 
	$em™_mÚ™Ü_ev’t
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

548 
H®FeMÚ™ÜEv’t
 
ev’t
,

549 cÚ¡ *
·th
,

550 
H®FeMÚ™ÜNÙifyFunc
 
func
,

551 
gpoš‹r
 
ud©a
)

553 ià(
func
)

555 
	`func
 (
mÚ™Ü
, 
ev’t
, 
·th
, 
ud©a
);

557 
	}
}

559 
gboŞ—n


560 
	$hªdË_kqueue_ev’t
 (
GIOChªÃl
 *
sourû
,

561 
GIOCÚd™iÚ
 
cÚd™iÚ
,

562 
gpoš‹r
 
ud©a
)

564 
kev’t
 
ev
;

565 
time¥ec
 
timeout
 = { 0, 0 };

566 
Ãv’ts
;

567 
H®FeMÚ™Ü
 *
mÚ™Ü
;

569 
	`g_»tuº_v®_if_ç
 (
	`HAL_IS_FILE_MONITOR
 (
ud©a
), 
FALSE
);

571 
mÚ™Ü
 = 
	`HAL_FILE_MONITOR
 (
ud©a
);

573 
	`g_»tuº_v®_if_ç
 (
mÚ™Ü
->
´iv
 !ğ
NULL
, 
FALSE
);

575 
	`g_»tuº_v®_if_ç
 (
mÚ™Ü
->
´iv
->
kqueue_fd
 > -1, 
FALSE
);

577 
Ãv’ts
 = 
	`kev’t
 (
mÚ™Ü
->
´iv
->
kqueue_fd
, 
NULL
, 0, &
ev
, 1, &
timeout
);

578 ià(
Ãv’ts
 == 1)

580 
fd
;

581 
FeKqueueD©a
 *
d©a
;

583 
fd
 = 
ev
.
id’t
;

584 
d©a
 = 
	`g_hash_bË_lookup
 (
mÚ™Ü
->
´iv
->
fd_to_kd©a
,

585 
	`GINT_TO_POINTER
 (
fd
));

586 ià(! 
d©a
)

589  
TRUE
;

592 ià((
d©a
->
omask
 & 
HAL_FILE_MONITOR_EVENT_DELETE
) &&

593 (
ev
.
fæags
 & 
VN_NOTE_DELETED
))

595 
	`em™_mÚ™Ü_ev’t
 (
mÚ™Ü
, 
HAL_FILE_MONITOR_EVENT_DELETE
, 
d©a
->
·th
, d©a->
func
, d©a->
ud©a
);

596 
	`h®_fe_mÚ™Ü_»move_kd©a
 (
mÚ™Ü
, 
fd
);

597  
TRUE
;

600 ià((
d©a
->
omask
 & 
HAL_FILE_MONITOR_EVENT_CREATE
) ||

601 (
d©a
->
omask
 & 
HAL_FILE_MONITOR_EVENT_DELETE
))

603 ià(
d©a
->
isdœ
)

605 
GSLi¡
 *
added
 = 
NULL
;

606 
GSLi¡
 *
»moved
 = 
NULL
;

607 
GSLi¡
 *
l
;

608 
GHashTabË
 *
bË
;

609 
gboŞ—n
 
found_chªge
 = 
FALSE
;

611 
bË
 = 
	`diff_dœ_cÚ‹Ás
 (
d©a
, &
added
, &
»moved
);

612 ià(
d©a
->
omask
 & 
HAL_FILE_MONITOR_EVENT_CREATE
)

614 
l
 = 
added
;† !ğ
NULL
;† =†->
Ãxt
)

616 *
·th
;

618 
·th
 = 
	`g_bud_f’ame
 (
d©a
->·th, 
l
->d©a, 
NULL
);

619 
	`em™_mÚ™Ü_ev’t
 (
mÚ™Ü
, 
HAL_FILE_MONITOR_EVENT_CREATE
, 
·th
, 
d©a
->
func
, d©a->
ud©a
);

620 
	`g_ä“
 (
·th
);

624 ià(
d©a
->
omask
 & 
HAL_FILE_MONITOR_EVENT_DELETE
)

626 
l
 = 
»moved
;† !ğ
NULL
;† =†->
Ãxt
)

628 *
·th
;

630 
·th
 = 
	`g_bud_f’ame
 (
d©a
->·th, 
l
->d©a, 
NULL
);

631 
	`em™_mÚ™Ü_ev’t
 (
mÚ™Ü
, 
HAL_FILE_MONITOR_EVENT_DELETE
, 
·th
, 
d©a
->
func
, d©a->
ud©a
);

632 
	`g_ä“
 (
·th
);

636 ià(
added
 || 
»moved
)

638 
	`g_hash_bË_»move_®l
 (
d©a
->
dœ_cÚ‹Ás
);

639 
	`g_hash_bË_de¡roy
 (
d©a
->
dœ_cÚ‹Ás
);

640 
d©a
->
dœ_cÚ‹Ás
 = 
bË
;

641 
found_chªge
 = 
TRUE
;

643 ià(
bË
)

645 
	`g_hash_bË_»move_®l
 (
bË
);

646 
	`g_hash_bË_de¡roy
 (
bË
);

650 
	`h®_fe_mÚ™Ü_»move_kd©a
 (
mÚ™Ü
, 
fd
);

653 ià(
added
)

655 
	`g_¦i¡_fÜ—ch
 (
added
, (
GFunc
è
g_ä“
, 
NULL
);

656 
	`g_¦i¡_ä“
 (
added
);

658 ià(
»moved
)

660 
	`g_¦i¡_fÜ—ch
 (
»moved
, (
GFunc
è
g_ä“
, 
NULL
);

661 
	`g_¦i¡_ä“
 (
»moved
);

664 ià(
found_chªge
)

666  
TRUE
;

671 ià(
d©a
->
omask
 & 
HAL_FILE_MONITOR_EVENT_CHANGE
)

673 
	`em™_mÚ™Ü_ev’t
 (
mÚ™Ü
, 
HAL_FILE_MONITOR_EVENT_CHANGE
, 
d©a
->
·th
, d©a->
func
, d©a->
ud©a
);

678 
	`g_w¬nšg
 ("FaedØ»ad from kqueue: %s", 
	`g_¡»¼Ü
 (
”ºo
));

679  
FALSE
;

682  
TRUE
;

683 
	}
}

685 
GHashTabË
 *

686 
	$diff_dœ_cÚ‹Ás
 (
FeKqueueD©a
 *
d©a
,

687 
GSLi¡
 **
added
,

688 
GSLi¡
 **
»moved
)

690 
GDœ
 *
dœ
;

691 
GE¼Ü
 *
”r
 = 
NULL
;

692 
GHashTabË
 *
bË
 = 
NULL
;

694 
dœ
 = 
	`g_dœ_İ’
 (
d©a
->
·th
, 0, &
”r
);

695 ià(
dœ
)

697 cÚ¡ *
âame
;

699 
bË
 = 
	`g_hash_bË_Ãw_fuÎ
 (
g_¡r_hash
, 
g_¡r_equ®
, 
g_ä“
, 
NULL
);

701 (
âame
 = 
	`g_dœ_»ad_Çme
 (
dœ
)))

703 ià(
added
)

705 ià(! 
	`g_hash_bË_lookup
 (
d©a
->
dœ_cÚ‹Ás
, 
âame
))

707 *
added
 = 
	`g_¦i¡_´•’d
 (*added, 
	`g_¡rdup
 (
âame
));

711 
	`g_hash_bË_š£¹
 (
bË
, 
	`g_¡rdup
 (
âame
), 
	`GINT_TO_POINTER
 (
TRUE
));

714 
	`g_dœ_şo£
 (
dœ
);

716 ià(
»moved
)

718 
GLi¡
 *
keys
;

719 
GLi¡
 *
l
;

721 
keys
 = 
	`g_hash_bË_g‘_keys
 (
d©a
->
dœ_cÚ‹Ás
);

723 
l
 = 
keys
;† !ğ
NULL
;† =†->
Ãxt
)

725 ià(! 
	`g_hash_bË_lookup
 (
bË
, 
l
->
d©a
))

727 *
»moved
 = 
	`g_¦i¡_´•’d
 (*»moved, 
	`g_¡rdup
 (
l
->
d©a
));

735 
	`g_w¬nšg
 ("FaedØİ’ dœeùÜy: %s", 
”r
->
mes§ge
);

736 
	`g_”rÜ_ä“
 (
”r
);

739  
bË
;

740 
	}
}

742 
GHashTabË
 *

743 
	$g‘_dœ_cÚ‹Ás
 (cÚ¡ *
·th
)

745 
GDœ
 *
dœ
;

746 
GE¼Ü
 *
”r
 = 
NULL
;

747 
GHashTabË
 *
bË
 = 
NULL
;

749 
dœ
 = 
	`g_dœ_İ’
 (
·th
, 0, &
”r
);

750 ià(
dœ
)

752 cÚ¡ *
âame
;

754 
bË
 = 
	`g_hash_bË_Ãw_fuÎ
 (
g_¡r_hash
, 
g_¡r_equ®
, 
g_ä“
, 
NULL
);

756 (
âame
 = 
	`g_dœ_»ad_Çme
 (
dœ
)))

758 
	`g_hash_bË_š£¹
 (
bË
, 
	`g_¡rdup
 (
âame
), 
	`GINT_TO_POINTER
 (
TRUE
));

760 
	`g_dœ_şo£
 (
dœ
);

764 
	`g_w¬nšg
 ("FaedØİ’ dœeùÜy %s: %s\n", 
·th
, 
”r
->
mes§ge
);

765 
	`g_”rÜ_ä“
 (
”r
);

768  
bË
;

769 
	}
}

	@hald/freebsd/hf-acpi.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<m©h.h
>

29 
	~<¡dio.h
>

30 
	~<¡ršg.h
>

31 
	~<”ºo.h
>

32 
	~<fú.h
>

33 
	~<uni¡d.h
>

34 
	~<sys/ioùl.h
>

35 
	~<sys/ty³s.h
>

36 
	~<dev/aıiÿ/aıiio.h
>

37 
	~<glib.h
>

39 
	~"../h®d.h
"

40 
	~"../h®d_dbus.h
"

41 
	~"../logg”.h
"

42 
	~"../ut.h
"

43 
	~"../ut_pm.h
"

45 
	~"hf-aıi.h
"

46 
	~"hf-ut.h
"

48 #iâdeà
ACPI_BIF_UNITS_MA


49 
	#ACPI_BIF_UNITS_MA
 1

	)

52 
	#HF_ACPIDEV
 "/dev/aıi"

	)

54 cÚ¡ 
	sÏ±İ_·Ãl_ty³
 {

55 *
	macûss
;

56 *
	mÇme
;

57 *
	mmax_sysùl
;

58 
	mmax_Ëv–s
;

59 
	#HF_ACPI_IBM_MAX_LEVELS
 8

	)

60 
	#HF_ACPI_TOSHIBA_MAX_LEVELS
 8

	)

61 
	#HF_ACPI_SONY_MAX_LEVELS
 8

	)

62 
	#HF_ACPI_PANASONIC_MAX_LEVELS
 16

	)

63 
	#HF_ACPI_ASUS_MAX_LEVELS
 16

	)

64 
	#HF_ACPI_FUJITSU_MAX_LEVELS
 8

	)

66 } 
	gÏ±İ_·Ãl_ty³s
[] = {

67 { "ibm", "IBM", 
NULL
,

68 
HF_ACPI_IBM_MAX_LEVELS
 },

69 { "toshiba", "Toshiba", 
NULL
,

70 
HF_ACPI_TOSHIBA_MAX_LEVELS
 },

71 { "sÚy", "SÚy", 
NULL
,

72 
HF_ACPI_SONY_MAX_LEVELS
 },

74 
HF_ACPI_PANASONIC_MAX_LEVELS
 },

75 { "asus", "Asus", 
NULL
,

76 
HF_ACPI_ASUS_MAX_LEVELS
 },

77 { "fuj™su", "Fuj™su", 
NULL
,

78 
HF_ACPI_FUJITSU_MAX_LEVELS
 }

81 cÚ¡ *
	gvideo_outs
[] = {

89 
	$hf_aıi_pŞl_aÿd
 (
H®Deviû
 *
deviû
)

91 
aşše
;

93 ià(! 
	`hf_g‘_št_sysùl
(&
aşše
, 
NULL
, "hw.acpi.acline"))

96 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "ac_adapter.present",

97 
aşše
 ? 
TRUE
 : 
FALSE
);

98 
	}
}

101 
	$hf_aıi_pŞl_b©t
 (
H®Deviû
 *
deviû
)

103 
fd
;

104 
vŞt
, 
dvŞt
, 
¿‹
, 
Ï¡fuÎ
, 
ÿp
, 
dÿp
, 
lÿp
, 
wÿp
, 
g¿1
, 
g¿2
;

105 
gboŞ—n
 
i¥»£Á
;

106 
aıi_b©‹ry_ioùl_¬g
 
b©tif
, 
b©t¡
, 
b©tšfo
;

108 
b©tif
.
un™
 = 
b©t¡
.un™ = 
b©tšfo
.unit =

109 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "freebsd.unit");

111 
fd
 = 
	`İ’
(
HF_ACPIDEV
, 
O_RDONLY
);

112 ià(
fd
 < 0)

114 
	`HAL_WARNING
(("uÇbËØİ’ %s: %s", 
HF_ACPIDEV
, 
	`g_¡»¼Ü
(
”ºo
)));

118 #ifdeà
ACPIIO_BATT_GET_BIF


119 ià(
	`ioùl
(
fd
, 
ACPIIO_BATT_GET_BIF
, &
b©tif
) == -1)

121 ià(
	`ioùl
(
fd
, 
ACPIIO_CMBAT_GET_BIF
, &
b©tif
) == -1)

124 
	`HAL_WARNING
(("ioctl ACPIIO_BATT_GET_BIF failed for battery %d: %s",

125 
b©tif
.
un™
, 
	`g_¡»¼Ü
(
”ºo
)));

126 
’d
;

128 #ifdeà
ACPIIO_BATT_GET_BST


129 ià(
	`ioùl
(
fd
, 
ACPIIO_BATT_GET_BST
, &
b©t¡
) == -1)

131 ià(
	`ioùl
(
fd
, 
ACPIIO_CMBAT_GET_BST
, &
b©t¡
) == -1)

134 
	`HAL_WARNING
(("ioctl ACPIIO_BATT_GET_BST failed for battery %d: %s",

135 
b©t¡
.
un™
, 
	`g_¡»¼Ü
(
”ºo
)));

136 
’d
;

138 ià(
	`ioùl
(
fd
, 
ACPIIO_BATT_GET_BATTINFO
, &
b©tšfo
) == -1)

140 
	`HAL_WARNING
(("ioctl ACPIIO_BATT_GET_BATTINFO failed for battery %d: %s",

141 
b©tšfo
.
un™
, 
	`g_¡»¼Ü
(
”ºo
)));

142 
’d
;

145 
i¥»£Á
 = (
b©t¡
.
b¡
.
¡©e
 =ğ
ACPI_BATT_STAT_NOT_PRESENT
è? 
FALSE
 : 
TRUE
;

146 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "b©‹ry.´e£Á", 
i¥»£Á
);

148 ià(! 
i¥»£Á
)

149 
’d
;

151 
dvŞt
 = 
b©tif
.
bif
.
dvŞ
;

152 
vŞt
 = 
b©t¡
.
b¡
.volt;

153 
ÿp
 = 
b©t¡
.
b¡
.cap;

154 
dÿp
 = 
b©tif
.
bif
.dcap;

155 
¿‹
 = 
b©t¡
.
b¡
.rate;

156 
Ï¡fuÎ
 = 
b©tif
.
bif
.
lfÿp
;

157 
lÿp
 = 
b©tif
.
bif
.lcap;

158 
wÿp
 = 
b©tif
.
bif
.wcap;

159 
g¿1
 = 
b©tif
.
bif
.gra1;

160 
g¿2
 = 
b©tif
.
bif
.gra2;

162 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "battery.voltage.unit", "mV");

163 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.vŞge.cu¼’t", 
vŞt
);

164 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.vŞge.design", 
dvŞt
);

166 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.»pÜtšg.design", 
dÿp
);

167 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.»pÜtšg.cu¼’t", 
ÿp
);

168 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.»pÜtšg.¿‹", 
¿‹
);

169 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.»pÜtšg.Ï¡_fuÎ", 
Ï¡fuÎ
);

170 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.»pÜtšg.low", 
lÿp
);

171 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.»pÜtšg.w¬nšg", 
wÿp
);

173 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "battery.charge_level.unit", "mWh");

182 ià(
¿‹
 == 0xffff)

183 
¿‹
 = 0;

185 ià(
b©tif
.
bif
.
un™s
 =ğ
ACPI_BIF_UNITS_MA
)

187 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "battery.reporting.units", "mAh");

189 ià(
dvŞt
 <= 0)

190 
dvŞt
 = 1;

191 ià(
vŞt
 <ğ0 || vŞˆ> 
dvŞt
)

192 
vŞt
 = 
dvŞt
;

194 
ÿp
 = (è
	`ršt
((ÿ°* 
vŞt
) / 1000.0);

195 
dÿp
 = (è
	`ršt
((dÿ°* 
vŞt
) / 1000.0);

196 
¿‹
 = (è
	`ršt
(Ô©* 
vŞt
) / 1000.0);

197 
Ï¡fuÎ
 = (è
	`ršt
(Öa¡fuÎ * 
vŞt
) / 1000.0);

198 
lÿp
 = (è
	`ršt
(Öÿ°* 
vŞt
) / 1000.0);

199 
wÿp
 = (è
	`ršt
((wÿ°* 
vŞt
) / 1000.0);

200 
g¿1
 = (è
	`ršt
((g¿1 * 
vŞt
) / 1000.0);

201 
g¿2
 = (è
	`ršt
((g¿2 * 
vŞt
) / 1000.0);

204 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "battery.reporting.unit", "mWh");

206 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.ch¬ge_Ëv–.design", 
dÿp
);

207 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "battery.charge_level.last_full",

208 
Ï¡fuÎ
);

209 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.ch¬ge_Ëv–.cu¼’t", 
ÿp
);

210 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.ch¬ge_Ëv–.¿‹", 
¿‹
);

211 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.ch¬ge_Ëv–.w¬nšg", 
wÿp
);

212 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "b©‹ry.ch¬ge_Ëv–.low", 
lÿp
);

213 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "battery.charge_level.granularity_1",

214 
g¿1
);

215 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "battery.charge_level.granularity_2",

216 
g¿2
);

219 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "battery.is_rechargeable",

220 
b©tif
.
bif
.
b‹ch
 =ğ0 ? 
FALSE
 : 
TRUE
);

221 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "battery.charge_level.percentage",

222 
b©tšfo
.b©tšfo.
ÿp
);

224 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
(
deviû
, "battery.is_rechargeable"))

226 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "battery.rechargeable.is_charging",

227 
b©tšfo
.b©tšfo.
¡©e
 & 
ACPI_BATT_STAT_CHARGING
 ? 
TRUE
 : 
FALSE
);

228 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "battery.rechargeable.is_discharging",

229 
b©tšfo
.b©tšfo.
¡©e
 & 
ACPI_BATT_STAT_DISCHARG
 ? 
TRUE
 : 
FALSE
);

233 ià(
b©tšfo
.b©tšfo.
mš
 > 0)

235 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "battery.remaining_time",

236 
b©tšfo
.b©tšfo.
mš
 * 60);

237 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "b©‹ry.»maššg_time.ÿlcuÏ‹_³r_time", 
FALSE
);

241 
»maššg_time
;

243 
»maššg_time
 = 
	`ut_compu‹_time_»maššg
(
	`h®_deviû_g‘_udi
(
deviû
), 
¿‹
, 
ÿp
,

244 
Ï¡fuÎ
,

245 
	`h®_deviû_´İ”ty_g‘_boŞ
(
deviû
, "battery.rechargeable.is_discharging"),

246 
	`h®_deviû_´İ”ty_g‘_boŞ
(
deviû
, "battery.rechargeable.is_charging"),

247 
	`h®_deviû_´İ”ty_g‘_boŞ
(
deviû
, "battery.remaining_time.calculate_per_time"));

248 ià(
»maššg_time
 > 0)

249 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "battery.remaining_time",

250 
»maššg_time
);

252 
	`h®_deviû_´İ”ty_»move
(
deviû
, "battery.remaining_time");

255 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.v’dÜ", 
b©tif
.
bif
.
Ûmšfo
);

257 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "b©‹ry.v’dÜ", 
b©tif
.
bif
.
Ûmšfo
);

258 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "b©‹ry.mod–", 
b©tif
.
bif
.
mod–
);

259 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "b©‹ry.‹chnŞogy", 
b©tif
.
bif
.
ty³
);

260 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "b©‹ry.£rŸl", 
b©tif
.
bif
.
£rŸl
);

262 
’d
:

263 
	`şo£
(
fd
);

264 
	}
}

267 
	$hf_aıi_pŞl_video
 (
H®Deviû
 *
deviû
)

269 cÚ¡ *
ty³
;

270 
un™
;

271 
Ëv–
;

273 
ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "display_device.type");

274 ià(
	`¡rcmp
(
ty³
, "lcd") != 0)

278 
un™
 = 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "freebsd.unit");

282 ià(
	`hf_g‘_št_sysùl
(&
Ëv–
, 
NULL
, "dev.aıi.video.lcd%i.brighŠess", 
un™
))

283 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "di¥Ïy_deviû.lcd.brighŠess", 
Ëv–
);

287 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "display_device.lcd.brightness", 100);

288 
	}
}

291 
	$hf_aıi_bu‰Ú_upd©e_¡©e
 (
H®Deviû
 *
deviû
, 
gboŞ—n
 
isşo£d
)

294 ià(
	`¡rcmp
(
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "button.type"), "lid"))

297 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "bu‰Ú.has_¡©e", 
TRUE
);

298 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "bu‰Ú.¡©e.v®ue", 
isşo£d
);

299 
	}
}

302 
	$hf_aıi_bu‰Ú_£t_´İ”t›s
 (
H®Deviû
 *
deviû
)

304 cÚ¡ *
²pid
;

305 cÚ¡ *
ty³
 = 
NULL
;

307 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "button");

308 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "button");

310 
²pid
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "pnp.id");

311 ià(
²pid
)

313 ià(! 
	`¡rcmp
(
²pid
, "PNP0C0C"))

314 
ty³
 = "power";

315 ià(! 
	`¡rcmp
(
²pid
, "PNP0C0D"))

316 
ty³
 = "lid";

317 ià(! 
	`¡rcmp
(
²pid
, "PNP0C0E"))

318 
ty³
 = "sleep";

321 ià(
ty³
)

323 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "bu‰Ú.ty³", 
ty³
);

324 ià(! 
	`¡rcmp
(
ty³
, "lid"))

326 *
lid_¡©e
;

328 
lid_¡©e
 = 
	`hf_g‘_¡ršg_sysùl
(
NULL
, "hw.acpi.lid_switch_state");

329 ià(
lid_¡©e
 && ! 
	`¡rcmp
(lid_state, "NONE"))

330 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "šfo.ignÜe", 
TRUE
);

331 
	`g_ä“
(
lid_¡©e
);

336 
	`hf_aıi_bu‰Ú_upd©e_¡©e
(
deviû
, 
FALSE
);

338 
	}
}

341 
	$hf_aıi_tz_£t_´İ”t›s
 (
H®Deviû
 *
deviû
)

343 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "sensor");

344 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "sensor");

346 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "sensor.type", "temperature");

347 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "sensor.location", "cpu");

348 
	}
}

351 
	$hf_aıi_aÿd_£t_´İ”t›s
 (
H®Deviû
 *
deviû
)

353 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "ac_adapter");

354 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "ac_adapter");

355 ià(
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "freebsd.unit") > 0)

359 
	`hf_aıi_pŞl_aÿd
(
deviû
);

360 
	}
}

363 
	$hf_aıi_b©‹ry_£t_´İ”t›s
 (
H®Deviû
 *
deviû
)

365 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "battery.type", "primary");

366 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "battery");

367 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "battery");

368 
	`hf_aıi_pŞl_b©t
(
deviû
);

369 
	}
}

371 
gboŞ—n


372 
	$hf_aıi_pŞl_®l_aÿds
 ()

374 
H®Deviû
 *
deviû
;

378 
deviû
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(),

381 ià(
deviû
 !ğ
NULL
)

383 
	`deviû_´İ”ty_©omic_upd©e_begš
();

384 
	`hf_aıi_pŞl_aÿd
(
deviû
);

385 
	`deviû_´İ”ty_©omic_upd©e_’d
();

387  
TRUE
;

390  
FALSE
;

391 
	}
}

393 
gboŞ—n


394 
	$hf_aıi_pŞl_®l_b©ts
 ()

396 
GSLi¡
 *
l
;

397 
GSLi¡
 *
b©ts
;

398 
H®Deviû
 *
deviû
;

399 
gboŞ—n
 
»suÉ
 = 
FALSE
;

401 
b©ts
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(),

405 
	`HF_LIST_FOREACH
(
l
, 
b©ts
)

407 
deviû
 = 
	`HAL_DEVICE
(
l
->
d©a
);

408 
	`deviû_´İ”ty_©omic_upd©e_begš
();

409 
	`hf_aıi_pŞl_b©t
(
deviû
);

410 
	`deviû_´İ”ty_©omic_upd©e_’d
();

411 
»suÉ
 = 
TRUE
;

413 
	`g_¦i¡_ä“
(
b©ts
);

415  
»suÉ
;

416 
	}
}

418 
gboŞ—n


419 
	$hf_aıi_pŞl_®l_videos
 ()

421 
GSLi¡
 *
vouts
, *
l
;

422 
H®Deviû
 *
deviû
;

423 
gboŞ—n
 
»suÉ
 = 
FALSE
;

425 
vouts
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(),

429 
	`HF_LIST_FOREACH
(
l
, 
vouts
)

431 
deviû
 = 
	`HAL_DEVICE
(
l
->
d©a
);

432 
	`deviû_´İ”ty_©omic_upd©e_begš
();

433 
	`hf_aıi_pŞl_video
(
deviû
);

434 
	`deviû_´İ”ty_©omic_upd©e_’d
();

435 
»suÉ
 = 
TRUE
;

437 
	`g_¦i¡_ä“
(
vouts
);

439  
»suÉ
;

440 
	}
}

442 
gboŞ—n


443 
	$hf_aıi_pŞl_cb
 (
gpoš‹r
 
d©a
)

445 
gboŞ—n
 
»suÉ
 = 
FALSE
;

447 ià(
hf_is_wa™šg
)

448  
TRUE
;

450 
»suÉ
 |ğ
	`hf_aıi_pŞl_®l_aÿds
();

451 
»suÉ
 |ğ
	`hf_aıi_pŞl_®l_b©ts
();

452 
»suÉ
 |ğ
	`hf_aıi_pŞl_®l_videos
();

454 ià(! 
»suÉ
)

455  
FALSE
;

457  
TRUE
;

458 
	}
}

460 
H®Deviû
 *

461 
	$hf_aıi_video_deviû_Ãw
 (
H®Deviû
 *
·»Á
, cÚ¡ *
ty³
)

463 
H®Deviû
 *
deviû
;

464 *
´oduù
;

465 
un™
;

467 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
·»Á
), 
NULL
);

469 
un™
 = 
	`h®_deviû_´İ”ty_g‘_št
(
·»Á
, "freebsd.unit");

470 ià(! 
	`hf_has_sysùl
("hw.aıi.video.%s%i.aùive", 
ty³
, 
un™
))

471  
NULL
;

473 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

475 
´oduù
 = 
	`g_¡rdup_´štf
("%s (%s)",

476 (
	`h®_deviû_´İ”ty_g‘_¡ršg
(
·»Á
, "šfo.´oduù"è!ğ
NULL
) ?

477 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
·»Á
, "info.product") : "Video Output",

478 
ty³
);

479 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.´oduù", 
ty³
);

480 
	`g_ä“
(
´oduù
);

483 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "ä“bsd.un™", 
un™
);

485 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "display_device");

486 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "display_device");

488 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "di¥Ïy_deviû.ty³", 
ty³
);

490 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_di¥Ïy_deviû_%s_%i", 
	`h®_deviû_g‘_udi
(
·»Á
),

491 
ty³
, 
un™
);

493 
	`hf_aıi_pŞl_video
(
deviû
);

495  
deviû
;

496 
	}
}

498 
H®Deviû
 *

499 
	$hf_aıi_Ï±İ_·Ãl_Ãw
 (
H®Deviû
 *
·»Á
, 
max_Ëv–s
,

500 cÚ¡ *
max_sysùl
, cÚ¡ *
acûss
,

501 cÚ¡ *
Çme
)

503 
H®Deviû
 *
deviû
;

505 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
·»Á
), 
NULL
);

507 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

509 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "šfo.´oduù", "L­tİ Pª– (%s)", 
Çme
);

511 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "laptop_panel");

512 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "laptop_panel");

514 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "Ï±İ_·Ãl.acûss_m‘hod", 
acûss
);

515 ià(
max_sysùl
 =ğ
NULL
)

516 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "Ï±İ_·Ãl.num_Ëv–s", 
max_Ëv–s
);

519 
bmax
;

521 ià(
	`hf_g‘_št_sysùl
(&
bmax
, 
NULL
, 
max_sysùl
))

522 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "Ï±İ_·Ãl.num_Ëv–s", 
bmax
);

524 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "Ï±İ_·Ãl.num_Ëv–s", 
max_Ëv–s
);

527 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_Ï±İ_·Ãl_%s", 
	`h®_deviû_g‘_udi
(
·»Á
), 
acûss
);

529  
deviû
;

530 
	}
}

533 
	$hf_aıi_š™
 ()

535 
	`g_timeout_add
(30000, 
hf_aıi_pŞl_cb
, 
NULL
);

536 
	}
}

539 
	$hf_aıi_´obe
 ()

541 
GSLi¡
 *
video_deviûs
, *
l
;

542 
i
;

544 
video_deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
(

545 
	`h®d_g‘_gdl
(), "freebsd.driver", "acpi_video");

546 
	`HF_LIST_FOREACH
(
l
, 
video_deviûs
)

548 
H®Deviû
 *
·»Á
 = 
	`HAL_DEVICE
(
l
->
d©a
);

550 ià(! 
	`h®_deviû_´İ”ty_g‘_boŞ
(
·»Á
, "info.ignore"))

552 
un™
;

553 
j
;

555 
un™
 = 
	`h®_deviû_´İ”ty_g‘_št
(
·»Á
, "freebsd.unit");

557 
j
 = 0; j < (è
	`G_N_ELEMENTS
(
video_outs
); j++)

559 ià(! 
	`hf_deviû_¡Üe_m©ch
(
	`h®d_g‘_gdl
(),

560 "di¥Ïy_deviû.ty³", 
HAL_PROPERTY_TYPE_STRING
, 
video_outs
[
j
],

561 "ä“bsd.un™", 
HAL_PROPERTY_TYPE_INT32
, 
un™
,

562 
NULL
)) {

563 
H®Deviû
 *
deviû
;

565 
deviû
 = 
	`hf_aıi_video_deviû_Ãw
(
·»Á
, 
video_outs
[
j
]);

566 ià(
deviû
)

567 
	`hf_deviû_´•robe_ªd_add
(
deviû
);

572 
	`g_¦i¡_ä“
(
video_deviûs
);

574 
i
 = 0; i < (è
	`G_N_ELEMENTS
(
Ï±İ_·Ãl_ty³s
); i++)

576 
H®Deviû
 *
·»Á
;

577 *
²ame
;

579 
²ame
 = 
	`g_¡rdup_´štf
("aıi_%s", 
Ï±İ_·Ãl_ty³s
[
i
].
acûss
);

583 
·»Á
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(),

584 "ä“bsd.driv”", 
²ame
);

585 
	`g_ä“
(
²ame
);

587 ià(
·»Á
 && ! 
	`h®_deviû_´İ”ty_g‘_boŞ
(parent, "info.ignore"))

589 ià(! 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(),

591 
Ï±İ_·Ãl_ty³s
[
i
].
acûss
))

593 
H®Deviû
 *
·Ãl_deviû
;

595 
·Ãl_deviû
 = 
	`hf_aıi_Ï±İ_·Ãl_Ãw
(
·»Á
,

596 
Ï±İ_·Ãl_ty³s
[
i
].
max_Ëv–s
,

597 
Ï±İ_·Ãl_ty³s
[
i
].
max_sysùl
,

598 
Ï±İ_·Ãl_ty³s
[
i
].
acûss
,

599 
Ï±İ_·Ãl_ty³s
[
i
].
Çme
);

600 
	`hf_deviû_´•robe_ªd_add
(
·Ãl_deviû
);

604 
	}
}

606 
gboŞ—n


607 
	$hf_aıi_deviû_»sÿn
 (
H®Deviû
 *
deviû
)

609 ià(
	`h®_deviû_has_ÿ·b™y
(
deviû
, "ac_adapter"))

610 
	`hf_aıi_pŞl_aÿd
(
deviû
);

611 ià(
	`h®_deviû_has_ÿ·b™y
(
deviû
, "battery"))

612 
	`hf_aıi_pŞl_b©t
(
deviû
);

613 ià(
	`h®_deviû_has_ÿ·b™y
(
deviû
, "display_device"))

614 
	`hf_aıi_pŞl_video
(
deviû
);

616  
FALSE
;

618  
TRUE
;

619 
	}
}

621 
gboŞ—n


622 
	$hf_aıi_devd_nÙify
 (cÚ¡ *
sy¡em
,

623 cÚ¡ *
subsy¡em
,

624 cÚ¡ *
ty³
,

625 cÚ¡ *
d©a
)

627 ià(
	`¡rcmp
(
sy¡em
, "ACPI"))

628  
FALSE
;

630 ià(! 
	`¡rcmp
(
subsy¡em
, "ACAD"))

631 
	`hf_aıi_pŞl_®l_aÿds
();

632 ià(! 
	`¡rcmp
(
subsy¡em
, "CMBAT"))

634 *
±r
;

635 
un™
;

637 
±r
 = 
	`¡r¡r
(
ty³
, ".BAT");

639 ià(
±r
 && 
	`ssÿnf
ÕŒ, ".BAT%i", &
un™
))

641 
H®Deviû
 *
cmb©
;

643 
cmb©
 = 
	`hf_deviû_¡Üe_m©ch
(
	`h®d_g‘_gdl
(),

644 "šfo.ÿ‹gÜy", 
HAL_PROPERTY_TYPE_STRING
, "battery",

645 "ä“bsd.un™", 
HAL_PROPERTY_TYPE_INT32
, 
un™
,

646 
NULL
);

648 ià(
cmb©
)

649 
	`hf_aıi_pŞl_b©t
(
cmb©
);

651 
	`hf_aıi_pŞl_®l_b©ts
();

654 
	`hf_aıi_pŞl_®l_b©ts
();

656 ià(! 
	`¡rcmp
(
subsy¡em
, "Lid") || ! strcmp(subsystem, "Button"))

658 
H®Deviû
 *
bu‰Ú
;

659 cÚ¡ *
bty³
 = 
NULL
;

661 ià(! 
	`¡rcmp
(
subsy¡em
, "Lid"))

662 
bty³
 = "lid";

663 ià(
d©a
 && ! 
	`¡rcmp
(data, "notify=0x00"))

664 
bty³
 = "power";

665 ià(
d©a
 && ! 
	`¡rcmp
(data, "notify=0x01"))

666 
bty³
 = "sleep";

668 ià(
bty³
)

670 
bu‰Ú
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(),

672 
bty³
);

674 ià(
bu‰Ú
)

676 ià(! 
	`¡rcmp
(
bty³
, "lid"))

678 
gboŞ—n
 
isşo£d
;

680 
isşo£d
 = (
d©a
 && ! 
	`¡rcmp
(data, "notify=0x00")) ?

681 
TRUE
 : 
FALSE
;

682 
	`deviû_´İ”ty_©omic_upd©e_begš
();

683 
	`hf_aıi_bu‰Ú_upd©e_¡©e
(
bu‰Ú
, 
isşo£d
);

684 
	`deviû_´İ”ty_©omic_upd©e_’d
();

686 
	`deviû_£nd_sigÇl_cÚd™iÚ
(
bu‰Ú
, "Bu‰ÚP»s£d", 
bty³
);

691  
TRUE
;

692 
	}
}

694 
HFHªdËr
 
	ghf_aıi_hªdËr
 = {

695 .
š™
 = 
hf_aıi_š™
,

696 .
	g´obe
 = 
hf_aıi_´obe
,

697 .
	gdeviû_»sÿn
 = 
hf_aıi_deviû_»sÿn


700 
HFDevdHªdËr
 
	ghf_aıi_devd_hªdËr
 = {

701 .
nÙify
 = 
hf_aıi_devd_nÙify


	@hald/freebsd/hf-acpi.h

24 #iâdeà
_HF_ACPI_H


25 
	#_HF_ACPI_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"hf-os¥ec.h
"

32 
	~"hf-devd.h
"

34 
HFHªdËr
 
hf_aıi_hªdËr
;

35 
HFDevdHªdËr
 
hf_aıi_devd_hªdËr
;

37 
hf_aıi_bu‰Ú_£t_´İ”t›s
 (
H®Deviû
 *
deviû
);

38 
hf_aıi_aÿd_£t_´İ”t›s
 (
H®Deviû
 *
deviû
);

39 
hf_aıi_b©‹ry_£t_´İ”t›s
 (
H®Deviû
 *
deviû
);

40 
hf_aıi_tz_£t_´İ”t›s
 (
H®Deviû
 *
deviû
);

	@hald/freebsd/hf-ata.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

29 
	~<fú.h
>

30 
	~<uni¡d.h
>

31 
	~<”ºo.h
>

32 
	~<sys/ioùl.h
>

33 
	~<sys/©a.h
>

35 
	~"../logg”.h
"

37 
	~"hf-©a.h
"

38 
	~"hf-block.h
"

39 
	~"hf-devŒ“.h
"

40 
	~"hf-pci.h
"

41 
	~"hf-¡Üage.h
"

42 
	~"hf-ut.h
"

44 
	#HF_ATA_DEVICE
 "/dev/©a"

	)

46 
	ghf_©a_fd
;

48 
GLi¡
 *
	ghf_©a_³ndšg_deviûs
 = 
NULL
;

52 
	$hf_©a_g‘_v’dÜ
 (cÚ¡ *
mod–
)

54 *
£p
;

56 
	`g_»tuº_v®_if_ç
(
mod–
 !ğ
NULL
, NULL);

58 
£p
 = 
	`¡½brk
(
mod–
, " -");

59 ià(
£p
)

60  
	`g_¡ºdup
(
mod–
, 
£p
 - model);

61 ià(
	`g_¡r_has_´efix
(
mod–
, "ST"))

62  
	`g_¡rdup
("Seagate");

64  
NULL
;

65 
	}
}

67 
H®Deviû
 *

68 
	$hf_©a_ide_deviû_Ãw
 (
H®Deviû
 *
·»Á
, 
ms
)

70 
H®Deviû
 *
deviû
;

71 
ho¡
;

73 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
·»Á
), 
NULL
);

75 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

77 
ho¡
 = 
	`h®_deviû_´İ”ty_g‘_št
(
·»Á
, "ide_host.number");

78 
	`hf_deviû_£t_udi
(
deviû
, "ide_%i_%i", 
ho¡
, 
ms
);

80 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.subsystem", "ide");

81 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "šfo.´oduù", "IDE Deviû (%s)", 
ms
 == 0 ? "Master" : "Slave");

83 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "ide.ho¡", 
ho¡
);

84 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "ide.chªÃl", 
ms
);

86  
deviû
;

87 
	}
}

89 
H®Deviû
 *

90 
hf_©a_block_deviû_Ãw
 (
H®Deviû
 *
·»Á
,

91 
ms
,

92 #ifdeà
IOCATADEVICES


93 cÚ¡ 
©a_ioc_deviûs
 *
deviûs
)

95 cÚ¡ 
©a_cmd
 *
	gdeviûs
)

98 
H®Deviû
 *
	gdeviû
;

99 cÚ¡ 
©a_·¿ms
 *
	g·¿ms
;

100 *
	gv’dÜ
;

102 
g_»tuº_v®_if_ç
(
HAL_IS_DEVICE
(
·»Á
), 
NULL
);

103 
g_»tuº_v®_if_ç
(
deviûs
 !ğ
NULL
, NULL);

105 #ifdeà
IOCATADEVICES


106 
	g·¿ms
 = &
deviûs
->
·¿ms
[
ms
];

108 
	g·¿ms
 = &
deviûs
->
u
.
·¿m
.
·¿ms
[
ms
];

110 
	gv’dÜ
 = 
hf_©a_g‘_v’dÜ
(
·¿ms
->
mod–
);

112 
	gdeviû
 = 
hf_deviû_Ãw
(
·»Á
);

114 #ifdeà
IOCATADEVICES


115 
hf_devŒ“_deviû_£t_Çme
(
deviû
, 
deviûs
->
Çme
[
ms
]);

117 
hf_devŒ“_deviû_£t_Çme
(
deviû
, 
deviûs
->
u
.
·¿m
.
Çme
[
ms
]);

120 #ifdeà
IOCATADEVICES


121 
hf_block_deviû_’abË
(
deviû
, 
deviûs
->
Çme
[
ms
]);

123 
hf_block_deviû_’abË
(
deviû
, 
deviûs
->
u
.
·¿m
.
Çme
[
ms
]);

125 
hf_¡Üage_deviû_’abË
(
deviû
);

127 
h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.´oduù", 
·¿ms
->
mod–
);

128 ià(
	gv’dÜ
)

129 
h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.v’dÜ", 
v’dÜ
);

131 ià(
	g·¿ms
->
	g§ÿ·b™›s
 &&…arams->satacapabilities != 0xffff)

132 
h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "storage.bus", "sata");

134 
h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "storage.bus", "ide");

136 
	g·¿ms
->
	gcÚfig
 & 
	gATA_ATAPI_TYPE_MASK
)

138 
	gATA_ATAPI_TYPE_TAPE
:

139 
hf_¡Üage_deviû_’abË_³
(
deviû
);

142 
	gATA_ATAPI_TYPE_CDROM
:

143 
ATA_ATAPI_TYPE_OPTICAL
:

144 
hf_¡Üage_deviû_’abË_cdrom
(
deviû
);

148 ià((
	g·¿ms
->
	gsuµÜt
.
	gcommªd1
 & 
	gATA_SUPPORT_REMOVABLE
) != 0)

149 
h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.»movabË", 
TRUE
);

151 
h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "¡Üage.Üigš©šg_deviû", 
h®_deviû_g‘_udi
(
·»Á
));

152 
h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "¡Üage.mod–", 
·¿ms
->
mod–
);

153 
h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "¡Üage.v’dÜ", 
v’dÜ
);

154 ià(*
	g·¿ms
->
	g£rŸl
)

155 
h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "¡Üage.£rŸl", 
·¿ms
->
£rŸl
);

156 ià(*
	g·¿ms
->
	g»visiÚ
)

157 
hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "¡Üage.fœmw¬e_»visiÚ", "%.8s", 
·¿ms
->
»visiÚ
);

159 
g_ä“
(
v’dÜ
);

161 
hf_block_deviû_com¶‘e
(
deviû
, deviû, 
FALSE
);

163  
	gdeviû
;

167 
	$hf_©a_´obe_deviûs
 (
H®Deviû
 *
ide_ho¡
)

169 #ifdeà
IOCATADEVICES


170 
©a_ioc_deviûs
 
deviûs
;

172 
©a_cmd
 
deviûs
;

174 
i
;

176 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
ide_ho¡
));

178 #ifdeà
IOCATADEVICES


179 
deviûs
.
chªÃl
 = 
	`h®_deviû_´İ”ty_g‘_št
(
ide_ho¡
, "ide_host.number");

180 ià(
	`ioùl
(
hf_©a_fd
, 
IOCATADEVICES
, &
deviûs
) < 0)

182 
	`HAL_WARNING
(("uÇbËØ´obdeviû oàATA chªÃÈ%i: %s", 
deviûs
.
chªÃl
, 
	`g_¡»¼Ü
(
”ºo
)));

186 
	`mem£t
(&
deviûs
, 0, (devices));

187 
deviûs
.
cmd
 = 
ATAGPARM
;

188 
deviûs
.
deviû
 = -1;

189 
deviûs
.
chªÃl
 = 
	`h®_deviû_´İ”ty_g‘_št
(
ide_ho¡
, "ide_host.number");

190 ià(
	`ioùl
(
hf_©a_fd
, 
IOCATA
, &
deviûs
) < 0)

192 
	`HAL_WARNING
(("uÇbËØ´obdeviû oàATA chªÃÈ%i: %s", 
deviûs
.
chªÃl
, 
	`g_¡»¼Ü
(
”ºo
)));

197 
i
 = 0; i < 2; i++)

198 #ifdeà
IOCATADEVICES


199 ià(*
deviûs
.
Çme
[
i
])

201 ià(*
deviûs
.
u
.
·¿m
.
Çme
[
i
])

204 
H®Deviû
 *
ide_deviû
;

206 
ide_deviû
 = 
	`hf_deviû_¡Üe_m©ch
(
	`h®d_g‘_gdl
(),

207 "ide.ho¡", 
HAL_PROPERTY_TYPE_INT32
, 
deviûs
.
chªÃl
,

208 "ide.chªÃl", 
HAL_PROPERTY_TYPE_INT32
, 
i
,

209 
NULL
);

211 ià(! 
ide_deviû
)

213 
ide_deviû
 = 
	`hf_©a_ide_deviû_Ãw
(
ide_ho¡
, 
i
);

214 
	`hf_deviû_´•robe_ªd_add
(
ide_deviû
);

217 ià(! 
	`h®_deviû_´İ”ty_g‘_boŞ
(
ide_deviû
, "info.ignore")

218 #ifdeà
IOCATADEVICES


219 && ! 
	`hf_devŒ“_fšd_äom_Çme
(
	`h®d_g‘_gdl
(), 
deviûs
.
Çme
[
i
]))

221 && ! 
	`hf_devŒ“_fšd_äom_Çme
(
	`h®d_g‘_gdl
(), 
deviûs
.
u
.
·¿m
.
Çme
[
i
]))

224 
H®Deviû
 *
block_deviû
;

226 
block_deviû
 = 
	`hf_©a_block_deviû_Ãw
(
ide_deviû
, 
i
, &
deviûs
);

236 
hf_©a_³ndšg_deviûs
 = 
	`g_li¡_­³nd
(hf_©a_³ndšg_deviûs, 
block_deviû
);

239 
	}
}

242 
	$hf_©a_add_³ndšg_deviûs
 ()

244 
GLi¡
 *
l
;

246 
	`HF_LIST_FOREACH
(
l
, 
hf_©a_³ndšg_deviûs
)

247 
	`hf_¡Üage_deviû_add
(
l
->
d©a
);

249 
	`g_li¡_ä“
(
hf_©a_³ndšg_deviûs
);

250 
hf_©a_³ndšg_deviûs
 = 
NULL
;

251 
	}
}

254 
	$hf_©a_´iveged_š™
 ()

256 
hf_©a_fd
 = 
	`İ’
(
HF_ATA_DEVICE
, 
O_RDONLY
);

257 ià(
hf_©a_fd
 < 0)

258 
	`HAL_INFO
(("uÇbËØİ’ %s: %s", 
HF_ATA_DEVICE
, 
	`g_¡»¼Ü
(
”ºo
)));

259 
	}
}

262 
	$hf_©a_´obe
 ()

264 
GSLi¡
 *
gdl_deviûs
;

265 
GSLi¡
 *
l
;

272 
	`g_as£¹
(
hf_©a_³ndšg_deviûs
 =ğ
NULL
);

274 ià(
hf_©a_fd
 < 0)

278 
gdl_deviûs
 = 
	`g_¦i¡_cİy
(
	`h®d_g‘_gdl
()->
deviûs
);

279 
	`HF_LIST_FOREACH
(
l
, 
gdl_deviûs
)

281 
H®Deviû
 *
deviû
 = 
l
->
d©a
;

283 ià(
	`h®_deviû_has_´İ”ty
(
deviû
, "ide_ho¡.numb”"è&& ! 
	`h®_deviû_´İ”ty_g‘_boŞ
(device, "info.ignore"))

284 
	`hf_©a_´obe_deviûs
(
deviû
);

286 
	`g_¦i¡_ä“
(
gdl_deviûs
);

287 
	}
}

290 
	$hf_©a_chªÃl_£t_´İ”t›s
 (
H®Deviû
 *
deviû
)

292 
un™
;

294 
un™
 = 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "freebsd.unit");

296 
	`hf_deviû_£t_udi
(
deviû
, "ide_ho¡_%i", 
un™
);

298 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.subsystem", "ide_host");

299 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "ide_ho¡.numb”", 
un™
);

300 
	}
}

302 
HFHªdËr
 
	ghf_©a_hªdËr
 = {

303 .
´iveged_š™
 = 
hf_©a_´iveged_š™
,

304 .
	g´obe
 = 
hf_©a_´obe


	@hald/freebsd/hf-ata.h

24 #iâdeà
_HF_ATA_H


25 
	#_HF_ATA_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"hf-os¥ec.h
"

33 
HFHªdËr
 
hf_©a_hªdËr
;

35 
GLi¡
 *
hf_©a_³ndšg_deviûs
;

37 
hf_©a_add_³ndšg_deviûs
 ();

39 
hf_©a_chªÃl_£t_´İ”t›s
 (
H®Deviû
 *
deviû
);

	@hald/freebsd/hf-block.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

29 
	~<”ºo.h
>

30 
	~<sys/ty³s.h
>

31 
	~<sys/¡©.h
>

33 
	~"../logg”.h
"

35 
	~"hf-block.h
"

36 
	~"hf-ut.h
"

38 
gboŞ—n


39 
	$hf_block_g‘_majÜ_mšÜ
 (cÚ¡ *
f’ame
, *
majÜ
, *
mšÜ
)

41 
¡©
 
sb
;

43 
	`g_»tuº_v®_if_ç
(
f’ame
 !ğ
NULL
, 
FALSE
);

44 
	`g_»tuº_v®_if_ç
(
majÜ
 !ğ
NULL
, 
FALSE
);

45 
	`g_»tuº_v®_if_ç
(
mšÜ
 !ğ
NULL
, 
FALSE
);

47 ià(
	`¡©
(
f’ame
, &
sb
) < 0)

49 
	`HAL_WARNING
(("uÇbËØ¡© %s: %s", 
f’ame
, 
	`g_¡»¼Ü
(
”ºo
)));

50  
FALSE
;

53 *
majÜ
 = 
	`majÜ
(
sb
.
¡_rdev
);

54 *
mšÜ
 = 
	`mšÜ
(
sb
.
¡_rdev
);

56  
TRUE
;

57 
	}
}

61 
	$hf_block_deviû_compu‹_udi
 (
H®Deviû
 *
deviû
)

63 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

65 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
(
deviû
, "block.is_volume"))

67 cÚ¡ *
Ïb–
;

68 cÚ¡ *
uuid
;

70 
Ïb–
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "volume.label");

71 
uuid
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "volume.uuid");

73 ià(
uuid
 && *uuid)

74 
	`hf_deviû_£t_udi
(
deviû
, "vŞume_uuid_%s", 
uuid
);

75 ià(
Ïb–
 && *label)

76 
	`hf_deviû_£t_udi
(
deviû
, "vŞume_Ïb–_%s", 
Ïb–
);

77 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
(
deviû
, "volume.is_disc") &&

78 
	`h®_deviû_´İ”ty_g‘_boŞ
(
deviû
, "volume.disc.is_blank"))

80 
	`hf_deviû_£t_udi
(
deviû
, "vŞume_em±y_%s", 
	`h®_deviû_´İ”ty_g‘_¡ršg
(device, "volume.disc.type"));

81 ià(
	`h®_deviû_has_´İ”ty
(
deviû
, "volume.partition.number")

82 && 
	`h®_deviû_has_´İ”ty
(
deviû
, "volume.size"))

83 
	`hf_deviû_£t_udi
(
deviû
, "volume_part%i_size_%ju",

84 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "volume.partition.number"),

85 
	`h®_deviû_´İ”ty_g‘_ušt64
(
deviû
, "volume.size"));

86 ià(
	`h®_deviû_has_´İ”ty
(
deviû
, "volume.partition.number"))

87 
	`hf_deviû_£t_udi
(
deviû
, "volume_part%i",

88 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "volume.partition.number"));

89 ià(
	`h®_deviû_has_´İ”ty
(
deviû
, "volume.size"))

90 
	`hf_deviû_£t_udi
(
deviû
, "volume_size_%ju",

91 
	`h®_deviû_´İ”ty_g‘_ušt64
(
deviû
, "volume.size"));

93 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_vŞume", 
	`h®_deviû_´İ”ty_g‘_¡ršg
(device, "info.parent"));

95 ià(
	`h®_deviû_has_ÿ·b™y
(
deviû
, "storage"))

97 cÚ¡ *
mod–
;

98 cÚ¡ *
£rŸl
;

99 cÚ¡ *
physiÿl_deviû
;

101 
mod–
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "storage.model");

102 
£rŸl
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "storage.serial");

103 
physiÿl_deviû
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "storage.originating_device");

105 ià(
£rŸl
 && *serial)

106 
	`hf_deviû_£t_udi
(
deviû
, "¡Üage_£rŸl_%s", 
£rŸl
);

107 ià(
mod–
 && *model)

108 
	`hf_deviû_£t_udi
(
deviû
, "¡Üage_mod–_%s", 
mod–
);

109 ià(
physiÿl_deviû
 && *physical_device)

110 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_¡Üage", 
physiÿl_deviû
);

112 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_¡Üage", 
	`h®_deviû_´İ”ty_g‘_¡ršg
(device, "info.parent"));

115 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_block", 
	`h®_deviû_´İ”ty_g‘_¡ršg
(device, "info.parent"));

116 
	}
}

119 
	$hf_block_deviû_compu‹_´oduù
 (
H®Deviû
 *
deviû
)

121 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

123 ià(
	`h®_deviû_has_´İ”ty
(
deviû
, "info.product"))

126 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
(
deviû
, "block.is_volume"))

128 cÚ¡ *
¡r
;

130 ià((
¡r
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "volume.label")) && *str)

131 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.´oduù", 
¡r
);

132 ià((
¡r
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "volume.fstype")) && *str)

133 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "šfo.´oduù", "VŞum(%s)", 
¡r
);

134 ià((
¡r
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "vŞume.fsu§ge")è&& ! 
	`¡rcmp
(str, "unused"))

135 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "Volume (Unused)");

137 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "Volume");

139 ià(
	`h®_deviû_has_ÿ·b™y
(
deviû
, "storage"))

140 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "Storage Device");

142 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "Block Device");

143 
	}
}

146 
	$hf_block_deviû_’abË
 (
H®Deviû
 *
deviû
, cÚ¡ *
devÇme
)

148 
majÜ
;

149 
mšÜ
;

151 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

152 
	`g_»tuº_if_ç
(
devÇme
 !ğ
NULL
);

154 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "block");

156 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.subsystem", "block");

157 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "block");

159 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "block.deviû", "/dev/%s", 
devÇme
);

160 ià(
	`hf_block_g‘_majÜ_mšÜ
(
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "block.deviû"), &
majÜ
, &
mšÜ
))

162 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "block.majÜ", 
majÜ
);

163 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "block.mšÜ", 
mšÜ
);

165 
	}
}

168 
	$hf_block_deviû_com¶‘e
 (
H®Deviû
 *
deviû
,

169 
H®Deviû
 *
¡Üage_deviû
,

170 
gboŞ—n
 
is_vŞume
)

172 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

173 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
¡Üage_deviû
));

175 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "block.is_vŞume", 
is_vŞume
);

177 
	`hf_block_deviû_compu‹_udi
(
deviû
);

178 
	`hf_block_deviû_compu‹_´oduù
(
deviû
);

181 
	`h®_deviû_cİy_´İ”ty
(
¡Üage_deviû
, "šfo.udi", 
deviû
, "block.storage_device");

182 
	}
}

	@hald/freebsd/hf-block.h

24 #iâdeà
_HF_BLOCK_H


25 
	#_HF_BLOCK_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"../h®d.h
"

33 
hf_block_deviû_’abË
 (
H®Deviû
 *
deviû
, cÚ¡ *
devÇme
);

34 
hf_block_deviû_com¶‘e
 (
H®Deviû
 *
deviû
,

35 
H®Deviû
 *
¡Üage_deviû
,

36 
gboŞ—n
 
is_vŞume
);

	@hald/freebsd/hf-computer.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<¡ršg.h
>

30 
	~<sys/ut¢ame.h
>

32 
	~"../h®d.h
"

34 
	~"hf-compu‹r.h
"

35 
	~"hf-ut.h
"

38 
	$hf_compu‹r_deviû_´obe
 (
H®Deviû
 *
deviû
)

40 cÚ¡ *
chassis_ty³
;

41 cÚ¡ *
fÜmçùÜ
;

42 cÚ¡ *
sys_mªuçùu»r
;

43 cÚ¡ *
sys_´oduù
;

44 cÚ¡ *
sys_v”siÚ
;

46 
	`hf_ruÂ”_run_sync
(
deviû
, 0, "h®d-´obe-smbios", 
NULL
);

48 
sys_mªuçùu»r
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "system.hardware.vendor");

49 
sys_´oduù
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "system.hardware.product");

50 
sys_v”siÚ
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "system.hardware.version");

52 ià(
sys_mªuçùu»r
 && 
sys_´oduù
 && 
sys_v”siÚ
)

54 ià(
	`¡rcmp
(
sys_v”siÚ
, "Not Specified"))

55 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "sy¡em.´oduù", "% %s", 
sys_´oduù
, 
sys_v”siÚ
);

57 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "sy¡em.´oduù", 
sys_´oduù
);

60 
chassis_ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "system.chassis.type");

61 
fÜmçùÜ
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "system.formfactor");

63 ià(
chassis_ty³
 && (! 
fÜmçùÜ
 || ! 
	`¡rcmp
(formfactor, "unknown")))

65 
i
;

74 cÚ¡ *
chassis_m­
[] = {

106 
i
 = 0; i < (è
	`G_N_ELEMENTS
(
chassis_m­
); i += 2)

107 ià(! 
	`¡rcmp
(
chassis_m­
[
i
], 
chassis_ty³
))

109 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "sy¡em.fÜmçùÜ", 
chassis_m­
[
i
 + 1]);

113 
	}
}

115 
gboŞ—n


116 
	$hf_compu‹r_deviû_add
 ()

118 
H®Deviû
 *
deviû
;

119 
ut¢ame
 
un
;

120 cÚ¡ *
pow”_ty³
 = 
NULL
;

121 
gboŞ—n
 
ÿn_su¥’d_to_¿m
 = 
FALSE
;

122 
gboŞ—n
 
ÿn_su¥’d_to_disk
 = 
FALSE
;

123 
gboŞ—n
 
should_decode_dmi
 = 
FALSE
;

125 ià(
	`h®_deviû_¡Üe_fšd
(
	`h®d_g‘_gdl
(), 
HF_COMPUTER
))

126  
TRUE
;

128 
deviû
 = 
	`h®_deviû_Ãw
();

129 
	`hf_deviû_£t_udi
(
deviû
, "computer");

130 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.subsystem", "unknown");

131 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "Computer");

133 ià(
	`uÇme
(&
un
) == 0)

135 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "sy¡em.k”Ãl.Çme", 
un
.
sy¢ame
);

136 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "sy¡em.k”Ãl.v”siÚ", 
un
.
»Ëa£
);

137 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "sy¡em.k”Ãl.machše", 
un
.
machše
);

140 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "system.formfactor", "unknown");

142 ià(
	`hf_has_sysùl
("dev.acpi.0.%%driver"))

144 *
¡©es
;

146 
pow”_ty³
 = "acpi";

147 
should_decode_dmi
 = 
TRUE
;

149 
¡©es
 = 
	`hf_g‘_¡ršg_sysùl
(
NULL
, "hw.acpi.supported_sleep_state");

150 ià(
¡©es
)

152 **
–em’ts
;

154 
–em’ts
 = 
	`g_¡r¥l™
(
¡©es
, " ", 0);

155 
	`g_ä“
(
¡©es
);

157 
ÿn_su¥’d_to_¿m
 = 
	`hf_¡rv_fšd
(
–em’ts
, "S2") != -1 || hf_strv_find(elements, "S3") != -1;

158 
ÿn_su¥’d_to_disk
 = 
	`hf_¡rv_fšd
(
–em’ts
, "S4") != -1;

159 
	`g_¡rä“v
(
–em’ts
);

164 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "pow”_mªagem’t.ty³", 
pow”_ty³
);

165 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "pow”_mªagem’t.ÿn_su¥’d", 
ÿn_su¥’d_to_¿m
);

166 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "pow”_mªagem’t.ÿn_hib”Ç‹", 
ÿn_su¥’d_to_disk
);

168 ià(
	`hf_deviû_´•robe
(
deviû
))

170 ià(
should_decode_dmi
)

171 
	`hf_compu‹r_deviû_´obe
(
deviû
);

172 
	`hf_deviû_add
(
deviû
);

174  
TRUE
;

177  
FALSE
;

178 
	}
}

	@hald/freebsd/hf-computer.h

25 #iâdeà
_HF_COMPUTER_H


26 
	#_HF_COMPUTER_H


	)

28 #ifdeà
HAVE_CONFIG_H


29 
	~<cÚfig.h
>

32 
	~<glib.h
>

34 
gboŞ—n
 
hf_compu‹r_deviû_add
 ();

	@hald/freebsd/hf-devd.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

29 
	~<”ºo.h
>

30 
	~<uni¡d.h
>

31 
	~<sys/ty³s.h
>

32 
	~<sys/sock‘.h
>

33 
	~<sys/un.h
>

35 
	~"../logg”.h
"

36 
	~"../os¥ec.h
"

38 
	~"hf-devd.h
"

39 
	~"hf-devŒ“.h
"

40 
	~"hf-aıi.h
"

41 
	~"hf-Ãt.h
"

42 
	~"hf-pcmcŸ.h
"

43 
	~"hf-usb.h
"

44 
	~"hf-ut.h
"

46 
	#HF_DEVD_SOCK_PATH
 "/v¬/run/devd.pe"

	)

48 
	#HF_DEVD_EVENT_NOTIFY
 '!'

	)

49 
	#HF_DEVD_EVENT_ADD
 '+'

	)

50 
	#HF_DEVD_EVENT_REMOVE
 '-'

	)

51 
	#HF_DEVD_EVENT_NOMATCH
 '?'

	)

53 
HFDevdHªdËr
 *
	ghªdËrs
[] = {

54 &
hf_usb_devd_hªdËr
,

55 &
hf_Ãt_devd_hªdËr
,

56 &
hf_aıi_devd_hªdËr
,

57 &
hf_pcmcŸ_devd_hªdËr


60 
gboŞ—n
 
	ghf_devd_š™ed
 = 
FALSE
;

62 
hf_devd_š™
 ();

64 
GHashTabË
 *

65 
	$hf_devd_·r£_·¿ms
 (cÚ¡ *
¡r
)

67 
GHashTabË
 *
·¿ms
;

68 **
·œs
;

69 
i
;

71 
	`g_»tuº_v®_if_ç
(
¡r
 !ğ
NULL
, 
FALSE
);

73 
·¿ms
 = 
	`g_hash_bË_Ãw_fuÎ
(
g_¡r_hash
, 
g_¡r_equ®
, 
g_ä“
, g_free);

75 
·œs
 = 
	`g_¡r¥l™
(
¡r
, " ", 0);

76 
i
 = 0; 
·œs
[i]; i++)

78 *
equ®
;

80 
equ®
 = 
	`¡rchr
(
·œs
[
i
], '=');

81 
	`g_hash_bË_š£¹
(
·¿ms
,

82 
equ®
 ? 
	`g_¡ºdup
(
·œs
[
i
],ƒqu® -…aœs[i]è: 
	`g_¡rdup
(pairs[i]),

83 
equ®
 ? 
	`g_¡rdup
Óqu® + 1è: 
NULL
);

85 
	`g_¡rä“v
(
·œs
);

87  
·¿ms
;

88 
	}
}

90 
gboŞ—n


91 
	$hf_devd_·r£_add_»move
 (cÚ¡ *
ev’t
,

92 **
Çme
,

93 
GHashTabË
 **
·¿ms
,

94 
GHashTabË
 **
©
,

95 **
·»Á
)

97 *
·¿ms_±r
;

98 *
©_±r
;

99 *
·»Á_±r
;

107 
	`g_»tuº_v®_if_ç
(
ev’t
 !ğ
NULL
, 
FALSE
);

108 
	`g_»tuº_v®_if_ç
(
Çme
 !ğ
NULL
, 
FALSE
);

109 
	`g_»tuº_v®_if_ç
(
·¿ms
 !ğ
NULL
, 
FALSE
);

110 
	`g_»tuº_v®_if_ç
(
©
 !ğ
NULL
, 
FALSE
);

111 
	`g_»tuº_v®_if_ç
(
·»Á
 !ğ
NULL
, 
FALSE
);

113 ià((
·¿ms_±r
 = 
	`¡rchr
(
ev’t
, ' '))

114 && (
©_±r
 = 
	`¡r¡r
(
·¿ms_±r
 + 1, "‡t "))

115 && (
·»Á_±r
 = 
	`¡r¡r
(
©_±r
 + 4, " on ")))

117 *
·¿ms_¡r
;

118 *
©_¡r
;

120 *
Çme
 = 
	`g_¡ºdup
(
ev’t
, 
·¿ms_±r
 -ƒvent);

121 
·¿ms_¡r
 = 
	`g_¡ºdup
(
·¿ms_±r
 + 1, 
©_±r
 -…arams_ptr - 1);

122 
©_¡r
 = 
	`g_¡ºdup
(
©_±r
 + 4, 
·»Á_±r
 -‡t_ptr - 4);

123 *
·»Á
 = 
	`g_¡rdup
(
·»Á_±r
 + 4);

125 ià(! 
	`¡rcmp
(*
·»Á
, "."))

127 
	`g_ä“
(*
·»Á
);

128 *
·»Á
 = 
NULL
;

131 *
·¿ms
 = 
	`hf_devd_·r£_·¿ms
(
·¿ms_¡r
);

132 
	`g_ä“
(
·¿ms_¡r
);

134 *
©
 = 
	`hf_devd_·r£_·¿ms
(
©_¡r
);

135 
	`g_ä“
(
©_¡r
);

137  
TRUE
;

140  
FALSE
;

141 
	}
}

143 
gboŞ—n


144 
	$hf_devd_·r£_nom©ch
 (cÚ¡ *
ev’t
,

145 
GHashTabË
 **
©
,

146 **
·»Á
)

148 *
©_±r
;

149 *
·»Á_±r
;

155 
	`g_»tuº_v®_if_ç
(
ev’t
 !ğ
NULL
, 
FALSE
);

156 
	`g_»tuº_v®_if_ç
(
©
 !ğ
NULL
, 
FALSE
);

157 
	`g_»tuº_v®_if_ç
(
·»Á
 !ğ
NULL
, 
FALSE
);

159 ià((
©_±r
 = 
	`¡r¡r
(
ev’t
, "‡t "))

160 && (
·»Á_±r
 = 
	`¡r¡r
(
©_±r
 + 4, " on ")))

162 *
©_¡r
;

164 
©_¡r
 = 
	`g_¡ºdup
(
©_±r
 + 4, 
·»Á_±r
 -‡t_ptr - 4);

165 *
·»Á
 = 
	`g_¡rdup
(
·»Á_±r
 + 4);

167 ià(! 
	`¡rcmp
(*
·»Á
, "."))

169 
	`g_ä“
(*
·»Á
);

170 *
·»Á
 = 
NULL
;

173 *
©
 = 
	`hf_devd_·r£_·¿ms
(
©_¡r
);

174 
	`g_ä“
(
©_¡r
);

176  
TRUE
;

179  
FALSE
;

180 
	}
}

182 
gboŞ—n


183 
	$hf_devd_·r£_nÙify
 (cÚ¡ *
ev’t
,

184 **
sy¡em
,

185 **
subsy¡em
,

186 **
ty³
,

187 **
d©a
)

189 **
™ems
;

190 
gboŞ—n
 
¡©us
 = 
FALSE
;

196 
	`g_»tuº_v®_if_ç
(
ev’t
 !ğ
NULL
, 
FALSE
);

197 
	`g_»tuº_v®_if_ç
(
sy¡em
 !ğ
NULL
, 
FALSE
);

198 
	`g_»tuº_v®_if_ç
(
subsy¡em
 !ğ
NULL
, 
FALSE
);

199 
	`g_»tuº_v®_if_ç
(
ty³
 !ğ
NULL
, 
FALSE
);

200 
	`g_»tuº_v®_if_ç
(
d©a
 !ğ
NULL
, 
FALSE
);

202 
™ems
 = 
	`g_¡r¥l™
(
ev’t
, " ", 0);

203 ià(
	`g_¡rv_Ëngth
(
™ems
) < 3)

204 
’d
;

206 ià(! 
	`g_¡r_has_´efix
(
™ems
[0], "system=") ||

207 ! 
	`g_¡r_has_´efix
(
™ems
[1], "subsystem=") ||

208 ! 
	`g_¡r_has_´efix
(
™ems
[2], "type="))

209 
’d
;

211 *
sy¡em
 = 
	`g_¡rdup
(
™ems
[0] + 7);

212 *
subsy¡em
 = 
	`g_¡rdup
(
™ems
[1] + 10);

213 *
ty³
 = 
	`g_¡rdup
(
™ems
[2] + 5);

214 *
d©a
 = 
	`g_¡rdup
(
™ems
[3]);

216 
¡©us
 = 
TRUE
;

218 
’d
:

219 
	`g_¡rä“v
(
™ems
);

220  
¡©us
;

221 
	}
}

224 
	$hf_devd_´oûss_add_ev’t
 (cÚ¡ *
Çme
,

225 
GHashTabË
 *
·¿ms
,

226 
GHashTabË
 *
©
,

227 cÚ¡ *
·»Á
)

229 
i
;

231 
	`g_»tuº_if_ç
(
Çme
 !ğ
NULL
);

232 
	`g_»tuº_if_ç
(
·¿ms
 !ğ
NULL
);

233 
	`g_»tuº_if_ç
(
©
 !ğ
NULL
);

235 
i
 = 0; i < (è
	`G_N_ELEMENTS
(
hªdËrs
); i++)

236 ià(
hªdËrs
[
i
]->
add
 && hªdËrs[i]->
	`add
(
Çme
, 
·¿ms
, 
©
, 
·»Á
))

241 
	`os¥ec_´obe
();

242 
	}
}

245 
	$hf_devd_´oûss_»move_ev’t
 (cÚ¡ *
Çme
,

246 
GHashTabË
 *
·¿ms
,

247 
GHashTabË
 *
©
,

248 cÚ¡ *
·»Á
)

250 
i
;

251 
H®Deviû
 *
deviû
;

253 
	`g_»tuº_if_ç
(
Çme
 !ğ
NULL
);

254 
	`g_»tuº_if_ç
(
·¿ms
 !ğ
NULL
);

255 
	`g_»tuº_if_ç
(
©
 !ğ
NULL
);

257 
i
 = 0; i < (è
	`G_N_ELEMENTS
(
hªdËrs
); i++)

258 ià(
hªdËrs
[
i
]->
»move
 && hªdËrs[i]->
	`»move
(
Çme
, 
·¿ms
, 
©
, 
·»Á
))

263 
deviû
 = 
	`hf_devŒ“_fšd_äom_Çme
(
	`h®d_g‘_gdl
(), 
Çme
);

264 ià(
deviû
)

265 
	`hf_deviû_»move_Œ“
(
deviû
);

266 
	}
}

269 
	$hf_devd_´oûss_nÙify_ev’t
 (cÚ¡ *
sy¡em
,

270 cÚ¡ *
subsy¡em
,

271 cÚ¡ *
ty³
,

272 cÚ¡ *
d©a
)

274 
i
;

276 
	`g_»tuº_if_ç
(
sy¡em
 !ğ
NULL
);

277 
	`g_»tuº_if_ç
(
subsy¡em
 !ğ
NULL
);

278 
	`g_»tuº_if_ç
(
ty³
 !ğ
NULL
);

279 
	`g_»tuº_if_ç
(
d©a
 !ğ
NULL
);

281 
i
 = 0; i < (è
	`G_N_ELEMENTS
(
hªdËrs
); i++)

282 ià(
hªdËrs
[
i
]->
nÙify
 && hªdËrs[i]->
	`nÙify
(
sy¡em
, 
subsy¡em
, 
ty³
, 
d©a
))

286 
	}
}

289 
	$hf_devd_´oûss_nom©ch_ev’t
 (
GHashTabË
 *
©
, cÚ¡ *
·»Á
)

291 
i
;

293 
	`g_»tuº_if_ç
(
©
 !ğ
NULL
);

295 
i
 = 0; i < (è
	`G_N_ELEMENTS
(
hªdËrs
); i++)

296 ià(
hªdËrs
[
i
]->
nom©ch
 && hªdËrs[i]->
	`nom©ch
(
©
, 
·»Á
))

298 
	}
}

301 
	$hf_devd_´oûss_ev’t
 (cÚ¡ *
ev’t
)

303 
	`g_»tuº_if_ç
(
ev’t
 !ğ
NULL
);

305 
	`HAL_INFO
(("»ûived devdƒv’t: %s", 
ev’t
));

307 
ev’t
[0])

309 
HF_DEVD_EVENT_ADD
:

310 
HF_DEVD_EVENT_REMOVE
:

312 *
Çme
;

313 
GHashTabË
 *
·¿ms
;

314 
GHashTabË
 *
©
;

315 *
·»Á
;

317 ià(! 
	`hf_devd_·r£_add_»move
(
ev’t
 + 1, &
Çme
, &
·¿ms
, &
©
, &
·»Á
))

318 
m®fÜmed
;

320 ià(
ev’t
[0] =ğ
HF_DEVD_EVENT_ADD
)

321 
	`hf_devd_´oûss_add_ev’t
(
Çme
, 
·¿ms
, 
©
, 
·»Á
);

323 
	`hf_devd_´oûss_»move_ev’t
(
Çme
, 
·¿ms
, 
©
, 
·»Á
);

325 
	`g_ä“
(
Çme
);

326 
	`g_hash_bË_de¡roy
(
·¿ms
);

327 
	`g_hash_bË_de¡roy
(
©
);

328 
	`g_ä“
(
·»Á
);

332 
HF_DEVD_EVENT_NOTIFY
:

334 *
sy¡em
;

335 *
subsy¡em
;

336 *
ty³
;

337 *
d©a
;

339 ià(! 
	`hf_devd_·r£_nÙify
(
ev’t
 + 1, &
sy¡em
, &
subsy¡em
, &
ty³
, &
d©a
))

340 
m®fÜmed
;

342 
	`hf_devd_´oûss_nÙify_ev’t
(
sy¡em
, 
subsy¡em
, 
ty³
, 
d©a
);

344 
	`g_ä“
(
sy¡em
);

345 
	`g_ä“
(
subsy¡em
);

346 
	`g_ä“
(
ty³
);

347 
	`g_ä“
(
d©a
);

351 
HF_DEVD_EVENT_NOMATCH
:

353 
GHashTabË
 *
©
;

354 *
·»Á
;

356 ià(! 
	`hf_devd_·r£_nom©ch
(
ev’t
 + 1, &
©
, &
·»Á
))

357 
m®fÜmed
;

359 
	`hf_devd_´oûss_nom©ch_ev’t
(
©
, 
·»Á
);

361 
	`g_hash_bË_de¡roy
(
©
);

362 
	`g_ä“
(
·»Á
);

367 
m®fÜmed
:

368 
	`HAL_WARNING
(("m®fÜmed devdƒv’t: %s", 
ev’t
));

369 
	}
}

371 
gboŞ—n


372 
	$hf_devd_ev’t_cb
 (
GIOChªÃl
 *
sourû
, 
GIOCÚd™iÚ
 
cÚd™iÚ
,

373 
gpoš‹r
 
u£r_d©a
)

375 *
ev’t
;

376 
gsize
 
‹rmš©Ü
;

377 
GIOStus
 
¡©us
;

379 ià(
hf_is_wa™šg
)

380  
TRUE
;

382 
¡©us
 = 
	`g_io_chªÃl_»ad_lše
(
sourû
, &
ev’t
, 
NULL
, &
‹rmš©Ü
, NULL);

384 ià(
¡©us
 !ğ
G_IO_STATUS_NORMAL
)

386 
ev’t
[
‹rmš©Ü
] = 0;

387 
	`hf_devd_´oûss_ev’t
(
ev’t
);

388 
	`g_ä“
(
ev’t
);

390 ià(
¡©us
 !ğ
G_IO_STATUS_AGAIN
)

392 
	`hf_devd_š™
();

393 ià(
hf_devd_š™ed
)

395 
fd
;

397 
fd
 = 
	`g_io_chªÃl_unix_g‘_fd
(
sourû
);

398 
	`g_io_chªÃl_shutdown
(
sourû
, 
FALSE
, 
NULL
);

399 
	`şo£
(
fd
);

401  
FALSE
;

405  
TRUE
;

406 
	}
}

409 
	$hf_devd_š™
 ()

411 
ev’t_fd
;

412 
sockaddr_un
 
addr
;

414 
ev’t_fd
 = 
	`sock‘
(
PF_UNIX
, 
SOCK_STREAM
, 0);

415 ià(
ev’t_fd
 < 0)

417 
	`HAL_WARNING
(("çedØü—‹ƒv’ˆsock‘: %s", 
	`g_¡»¼Ü
(
”ºo
)));

418 
hf_devd_š™ed
 = 
FALSE
;

422 
addr
.
sun_çmy
 = 
AF_UNIX
;

423 
	`¡ºıy
(
addr
.
sun_·th
, 
HF_DEVD_SOCK_PATH
, (addr.sun_path));

424 ià(
	`cÚÃù
(
ev’t_fd
, (
sockaddr
 *)&
addr
, (addr)) == 0)

426 
GIOChªÃl
 *
chªÃl
;

428 
chªÃl
 = 
	`g_io_chªÃl_unix_Ãw
(
ev’t_fd
);

429 
	`g_io_add_w©ch
(
chªÃl
, 
G_IO_IN
, 
hf_devd_ev’t_cb
, 
NULL
);

430 
	`g_io_chªÃl_uÄef
(
chªÃl
);

431 
hf_devd_š™ed
 = 
TRUE
;

435 
	`HAL_WARNING
(("çedØcÚÃùØ%s: %s", 
HF_DEVD_SOCK_PATH
,

436 
	`g_¡»¼Ü
(
”ºo
)));

437 
	`şo£
(
ev’t_fd
);

438 
hf_devd_š™ed
 = 
FALSE
;

440 
	}
}

442 
HFHªdËr
 
	ghf_devd_hªdËr
 = {

443 .
š™
 = 
hf_devd_š™


	@hald/freebsd/hf-devd.h

24 #iâdeà
_HF_DEVD_H


25 
	#_HF_DEVD_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<glib.h
>

33 
	~"hf-os¥ec.h
"

35 
HFHªdËr
 
hf_devd_hªdËr
;

41 
gboŞ—n
 (*
add
è(cÚ¡ *
	mÇme
,

42 
GHashTabË
 *
	m·¿ms
,

43 
GHashTabË
 *
	m©
,

44 cÚ¡ *
	m·»Á
);

45 
gboŞ—n
 (*
»move
è(cÚ¡ *
	mÇme
,

46 
GHashTabË
 *
	m·¿ms
,

47 
GHashTabË
 *
	m©
,

48 cÚ¡ *
	m·»Á
);

49 
gboŞ—n
 (*
nÙify
è(cÚ¡ *
	msy¡em
,

50 cÚ¡ *
	msubsy¡em
,

51 cÚ¡ *
	mty³
,

52 cÚ¡ *
	md©a
);

53 
gboŞ—n
 (*
nom©ch
è(
GHashTabË
 *
	m©
,

54 cÚ¡ *
	m·»Á
);

55 } 
	tHFDevdHªdËr
;

	@hald/freebsd/hf-devtree.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡dio.h
>

29 
	~<¡ršg.h
>

31 
	~"../ids.h
"

32 
	~"../logg”.h
"

34 
	~"hf-devŒ“.h
"

35 
	~"hf-aıi.h
"

36 
	~"hf-©a.h
"

37 
	~"hf-block.h
"

38 
	~"hf-drm.h
"

39 
	~"hf-pcmcŸ.h
"

40 
	~"hf-¡Üage.h
"

41 
	~"hf-ut.h
"

45 cÚ¡ *
	mdriv”
;

46 (*
	m£t_´İ”t›s
è(
H®Deviû
 *
	mdeviû
);

47 } 
	tHªdËr
;

51 cÚ¡ 
HªdËr
 *
	mhªdËr
;

52 
	mun™
;

53 } 
	tDeviûInfo
;

55 
gboŞ—n


56 
	$hf_devŒ“_·r£_Çme
 (cÚ¡ *
Çme
,

57 **
driv”
,

58 *
un™
)

60 *
_driv”
;

61 
_un™
;

62 
gboŞ—n
 
¡©us
 = 
FALSE
;

64 
	`g_»tuº_v®_if_ç
(
Çme
 !ğ
NULL
, 
FALSE
);

66 
_driv”
 = 
	`g_Ãw
(, 
	`¡¾’
(
Çme
) + 1);

67 ià(
	`ssÿnf
(
Çme
, "%[^0-9]%i", 
_driv”
, &
_un™
) == 2)

69 ià(
driv”
)

71 *
driv”
 = 
_driv”
;

72 
_driv”
 = 
NULL
;

74 ià(
un™
)

75 *
un™
 = 
_un™
;

76 
¡©us
 = 
TRUE
;

79 
	`g_ä“
(
_driv”
);

80  
¡©us
;

81 
	}
}

83 
gboŞ—n


84 
	$hf_devŒ“_ıu_ÿn_thrÙe
 (
ıu
)

86 
gboŞ—n
 
ÿn
 = 
FALSE
;

87 *
Ëv–s
;

89 
Ëv–s
 = 
	`hf_g‘_¡ršg_sysùl
(
NULL
, "dev.ıu.%i.äeq_Ëv–s", 
ıu
);

90 ià(
Ëv–s
)

92 **
toks
;

94 
toks
 = 
	`g_¡r¥l™
(
Ëv–s
, " ", 0);

96 ià(
	`g_¡rv_Ëngth
(
toks
) > 1)

97 
ÿn
 = 
TRUE
;

99 
	`g_¡rä“v
(
toks
);

100 
	`g_ä“
(
Ëv–s
);

103  
ÿn
;

104 
	}
}

107 
	$hf_devŒ“_ıu_g‘_maxäeq
 (
ıu
)

109 *
Ëv–s
;

110 
äeq
 = -1;

112 
Ëv–s
 = 
	`hf_g‘_¡ršg_sysùl
(
NULL
, "dev.ıu.%i.äeq_Ëv–s", 
ıu
);

113 ià(
Ëv–s
)

115 
	`ssÿnf
(
Ëv–s
, "%i/", &
äeq
);

116 
	`g_ä“
(
Ëv–s
);

119 ià(
äeq
 == -1)

121 
nıu
;

125 ià(
	`hf_g‘_št_sysùl
(&
nıu
, 
NULL
, "hw.ncpu") &&‚cpu == 1)

126 
	`hf_g‘_št_sysùl
(&
äeq
, 
NULL
, "hw.clockrate");

129  
äeq
;

130 
	}
}

133 
	$hf_devŒ“_ıu_£t_´İ”t›s
 (
H®Deviû
 *
deviû
)

135 
un™
;

136 
äeq
;

137 
nıu
;

139 
un™
 = 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "freebsd.unit");

141 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "processor");

142 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "processor");

144 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "´oûssÜ.numb”", 
un™
);

145 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "´oûssÜ.ÿn_thrÙe", 
	`hf_devŒ“_ıu_ÿn_thrÙe
(
un™
));

147 
äeq
 = 
	`hf_devŒ“_ıu_g‘_maxäeq
(
un™
);

148 ià(
äeq
 != -1)

149 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "´oûssÜ.maximum_¥“d", 
äeq
);

152 ià(
	`hf_g‘_št_sysùl
(&
nıu
, 
NULL
, "hw.ncpu") &&‚cpu == 1)

154 *
mod–
;

156 
mod–
 = 
	`hf_g‘_¡ršg_sysùl
(
NULL
, "hw.model");

157 ià(
mod–
)

159 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.´oduù", 
mod–
);

160 
	`g_ä“
(
mod–
);

163 
	}
}

166 
	$hf_devŒ“_fd_£t_´İ”t›s
 (
H®Deviû
 *
deviû
)

168 *
devÇme
;

170 
devÇme
 = 
	`hf_devŒ“_deviû_g‘_Çme
(
deviû
);

171 
	`hf_block_deviû_’abË
(
deviû
, 
devÇme
);

172 
	`g_ä“
(
devÇme
);

174 
	`hf_¡Üage_deviû_’abË
(
deviû
);

176 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "storage.drive_type", "floppy");

178 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.»movabË", 
TRUE
);

179 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.no_·¹™iÚs_hšt", 
TRUE
);

181 
	`h®_deviû_cİy_´İ”ty
(
deviû
, "info.product", device, "storage.model");

183 
	`hf_block_deviû_com¶‘e
(
deviû
, deviû, 
FALSE
);

184 
	}
}

187 
	$hf_devŒ“_©kbd_£t_´İ”t›s
 (
H®Deviû
 *
deviû
)

189 
	`hf_deviû_£t_šput
(
deviû
, "keybßrd", 
NULL
);

190 
	}
}

193 
	$hf_devŒ“_psm_£t_´İ”t›s
 (
H®Deviû
 *
deviû
)

195 *
devÇme
;

197 
devÇme
 = 
	`hf_devŒ“_deviû_g‘_Çme
(
deviû
);

198 
	`hf_deviû_£t_šput
(
deviû
, "mou£", 
devÇme
);

199 
	`g_ä“
(
devÇme
);

200 
	}
}

203 
	$hf_devŒ“_joy_£t_´İ”t›s
 (
H®Deviû
 *
deviû
)

205 *
devÇme
;

207 
devÇme
 = 
	`hf_devŒ“_deviû_g‘_Çme
(
deviû
);

208 
	`hf_deviû_£t_šput
(
deviû
, "joy¡ick", 
devÇme
);

209 
	`g_ä“
(
devÇme
);

211 ià(! 
	`h®_deviû_has_´İ”ty
(
deviû
, "info.product"))

212 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "PC Joystick");

213 
	}
}

215 
H®Deviû
 *

216 
	$hf_devŒ“_deviû_Ãw
 (
H®Deviû
 *
·»Á
, cÚ¡ 
HªdËr
 *
hªdËr
, 
un™
)

218 
H®Deviû
 *
deviû
;

219 *
desc
;

220 *
²pšfo
;

222 
	`g_»tuº_v®_if_ç
(
hªdËr
 !ğ
NULL
, NULL);

224 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

226 
	`hf_deviû_£t_udi
(
deviû
, "%s_%i", 
hªdËr
->
driv”
, 
un™
);

228 
desc
 = 
	`hf_g‘_¡ršg_sysùl
(
NULL
, "dev.%s.%i.%%desc", 
hªdËr
->
driv”
, 
un™
);

229 ià(
desc
 && *desc)

230 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.´oduù", 
desc
);

231 
	`g_ä“
(
desc
);

233 
	`hf_devŒ“_deviû_£t_šfo
(
deviû
, 
hªdËr
->
driv”
, 
un™
);

236 
²pšfo
 = 
	`hf_g‘_¡ršg_sysùl
(
NULL
, "dev.%s.%i.%%²pšfo", 
hªdËr
->
driv”
, 
un™
);

237 ià(
²pšfo
)

239 **
™ems
;

240 
i
;

242 
™ems
 = 
	`g_¡r¥l™
(
²pšfo
, " ", 0);

243 
	`g_ä“
(
²pšfo
);

245 
i
 = 0; 
™ems
[i]; i++)

246 ià(
	`g_¡r_has_´efix
(
™ems
[
i
], "_HID="))

248 ià(
	`¡rcmp
(
™ems
[
i
], "_HID=none"))

250 *
²p_desütiÚ
;

252 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "²p.id", 
™ems
[
i
] + 5);

254 
	`ids_fšd_²p
(
™ems
[
i
] + 5, &
²p_desütiÚ
);

255 ià(
²p_desütiÚ
)

257 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "²p.desütiÚ", 
²p_desütiÚ
);

258 ià(! 
	`h®_deviû_has_´İ”ty
(
deviû
, "info.product"))

259 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "²p.desütiÚ", 
²p_desütiÚ
);

265 
	`g_¡rä“v
(
™ems
);

268 ià(
hªdËr
->
£t_´İ”t›s
)

269 
hªdËr
->
	`£t_´İ”t›s
(
deviû
);

271 ià(! 
	`h®_deviû_has_´İ”ty
(
deviû
, "info.subsystem"))

273 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.subsystem", "platform");

274 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "¶©fÜm.id", "%s.%i", 
hªdËr
->
driv”
, 
un™
);

277  
deviû
;

278 
	}
}

280 
gboŞ—n


281 
	$hf_devŒ“_deviû_is
 (
H®Deviû
 *
deviû
)

283 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
deviû
), 
FALSE
);

285  
	`h®_deviû_has_´İ”ty
(
deviû
, "freebsd.driver");

286 
	}
}

288 
GSLi¡
 *

289 
	$hf_devŒ“_lookup
 (
GSLi¡
 *
deviûs
, cÚ¡ *
driv”
, 
un™
)

291 
GSLi¡
 *
l
;

293 
	`g_»tuº_v®_if_ç
(
driv”
 !ğ
NULL
, NULL);

295 
	`HF_LIST_FOREACH
(
l
, 
deviûs
)

297 
DeviûInfo
 *
šfo
 = 
l
->
d©a
;

299 ià(! 
	`¡rcmp
(
šfo
->
hªdËr
->
driv”
, driv”è&& info->
un™
 == unit)

300  
l
;

303  
NULL
;

304 
	}
}

306 
GSLi¡
 *

307 
	$hf_devŒ“_g‘_roÙ
 (
GSLi¡
 *
deviûs
)

309 
GSLi¡
 *
roÙ
;

310 
DeviûInfo
 *
šfo
;

311 *
driv”
;

312 
un™
;

314 
	`g_»tuº_v®_if_ç
(
deviûs
 !ğ
NULL
, NULL);

316 
roÙ
 = 
deviûs
;

317 
šfo
 = 
roÙ
->
d©a
;

319 
driv”
 = 
	`g_¡rdup
(
šfo
->
hªdËr
->driver);

320 
un™
 = 
šfo
->unit;

322 
driv”
)

324 *
·»Á_Çme
;

326 
·»Á_Çme
 = 
	`hf_g‘_¡ršg_sysùl
(
NULL
, "dev.%s.%i.%%·»Á", 
driv”
, 
un™
);

328 
	`g_ä“
(
driv”
);

329 
driv”
 = 
NULL
;

331 ià(
·»Á_Çme
)

333 ià(
	`hf_devŒ“_·r£_Çme
(
·»Á_Çme
, &
driv”
, &
un™
))

335 
GSLi¡
 *
Ãw_roÙ
;

337 
Ãw_roÙ
 = 
	`hf_devŒ“_lookup
(
deviûs
, 
driv”
, 
un™
);

338 ià(
Ãw_roÙ
)

340 
roÙ
 = 
Ãw_roÙ
;

341 
šfo
 = 
roÙ
->
d©a
;

343 
	`g_ä“
(
driv”
);

344 
driv”
 = 
	`g_¡rdup
(
šfo
->
hªdËr
->driver);

345 
un™
 = 
šfo
->unit;

348 
	`g_ä“
(
·»Á_Çme
);

352  
roÙ
;

353 
	}
}

355 
HªdËr
 
	ghªdËrs
[] = {

356 { "aıi_aÿd", 
hf_aıi_aÿd_£t_´İ”t›s
 },

357 { "aıi_asus", 
NULL
 },

358 { "aıi_bu‰Ú", 
hf_aıi_bu‰Ú_£t_´İ”t›s
 },

359 { "aıi_fuj™su", 
NULL
 },

360 { "aıi_ibm", 
NULL
 },

361 { "aıi_lid", 
hf_aıi_bu‰Ú_£t_´İ”t›s
 },

362 { "aıi_·ÇsÚic", 
NULL
 },

363 { "aıi_sÚy", 
NULL
 },

364 { "aıi_toshiba", 
NULL
 },

365 { "aıi_tz", 
hf_aıi_tz_£t_´İ”t›s
 },

366 { "aıi_video", 
NULL
 },

367 { "©a", 
hf_©a_chªÃl_£t_´İ”t›s
 },

368 { "©kbd", 
hf_devŒ“_©kbd_£t_´İ”t›s
 },

369 { "©kbdc", 
NULL
 },

370 { "b©‹ry", 
hf_aıi_b©‹ry_£t_´İ”t›s
 },

371 { "ÿrdbus", 
hf_pcmcŸ_£t_´İ”t›s
 },

372 { "ıu", 
hf_devŒ“_ıu_£t_´İ”t›s
 },

373 { "drm", 
hf_drm_£t_´İ”t›s
 },

374 { "fd", 
hf_devŒ“_fd_£t_´İ”t›s
 },

375 { "fdc", 
NULL
 },

376 { "joy", 
hf_devŒ“_joy_£t_´İ”t›s
 },

377 { "nvidŸ", 
NULL
 },

378 { "pcÿrd", 
hf_pcmcŸ_£t_´İ”t›s
 },

379 { "pcm", 
NULL
 },

380 { "psm", 
hf_devŒ“_psm_£t_´İ”t›s
 },

381 { "sio", 
NULL
 },

382 { "¥—k”", 
NULL
 }

386 
	$hf_devŒ“_´obe
 ()

388 
GSLi¡
 *
deviûs
 = 
NULL
;

389 
i
;

393 
i
 = 0; i < (è
	`G_N_ELEMENTS
(
hªdËrs
); i++)

395 
j
;

397 
j
 = 0; 
	`hf_has_sysùl
("dev.%s.%i.%%driv”", 
hªdËrs
[
i
].
driv”
, j); j++)

398 ià(! 
	`hf_devŒ“_fšd_äom_šfo
(
	`h®d_g‘_gdl
(), 
hªdËrs
[
i
].
driv”
, 
j
))

400 
DeviûInfo
 *
šfo
;

402 
šfo
 = 
	`g_Ãw
(
DeviûInfo
, 1);

403 
šfo
->
hªdËr
 = &
hªdËrs
[
i
];

404 
šfo
->
un™
 = 
j
;

406 
deviûs
 = 
	`g_¦i¡_´•’d
(deviûs, 
šfo
);

412 
deviûs
)

414 
GSLi¡
 *
roÙ
;

415 
DeviûInfo
 *
šfo
;

416 
H®Deviû
 *
·»Á
;

418 
roÙ
 = 
	`hf_devŒ“_g‘_roÙ
(
deviûs
);

419 
	`g_as£¹
(
roÙ
 !ğ
NULL
);

421 
šfo
 = 
roÙ
->
d©a
;

423 
·»Á
 = 
	`hf_devŒ“_fšd_·»Á_äom_šfo
(
	`h®d_g‘_gdl
(), 
šfo
->
hªdËr
->
driv”
, info->
un™
);

424 ià(! 
·»Á
 || ! 
	`h®_deviû_´İ”ty_g‘_boŞ
(parent, "info.ignore"))

426 
H®Deviû
 *
deviû
;

428 
deviû
 = 
	`hf_devŒ“_deviû_Ãw
(
·»Á
, 
šfo
->
hªdËr
, info->
un™
);

429 
	`hf_deviû_´•robe_ªd_add
(
deviû
);

432 
deviûs
 = 
	`g_¦i¡_d–‘e_lšk
(deviûs, 
roÙ
);

433 
	`g_ä“
(
šfo
);

435 
	}
}

437 
H®Deviû
 *

438 
	$hf_devŒ“_fšd_äom_Çme
 (
H®DeviûStÜe
 *
¡Üe
, cÚ¡ *
Çme
)

440 *
driv”
;

441 
un™
;

442 
H®Deviû
 *
deviû
 = 
NULL
;

444 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE_STORE
(
¡Üe
), 
NULL
);

445 
	`g_»tuº_v®_if_ç
(
Çme
 !ğ
NULL
, NULL);

447 ià(
	`hf_devŒ“_·r£_Çme
(
Çme
, &
driv”
, &
un™
))

449 
deviû
 = 
	`hf_devŒ“_fšd_äom_šfo
(
¡Üe
, 
driv”
, 
un™
);

450 
	`g_ä“
(
driv”
);

453  
deviû
;

454 
	}
}

456 
H®Deviû
 *

457 
	$hf_devŒ“_fšd_äom_šfo
 (
H®DeviûStÜe
 *
¡Üe
, cÚ¡ *
driv”
, 
un™
)

459 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE_STORE
(
¡Üe
), 
NULL
);

460 
	`g_»tuº_v®_if_ç
(
driv”
 !ğ
NULL
, NULL);

462  
	`hf_deviû_¡Üe_m©ch
(
¡Üe
,

463 "ä“bsd.driv”", 
HAL_PROPERTY_TYPE_STRING
, 
driv”
,

464 "ä“bsd.un™", 
HAL_PROPERTY_TYPE_INT32
, 
un™
,

465 
NULL
);

466 
	}
}

468 
H®Deviû
 *

469 
	$hf_devŒ“_fšd_·»Á_äom_Çme
 (
H®DeviûStÜe
 *
¡Üe
, cÚ¡ *
Çme
)

471 *
driv”
;

472 
un™
;

473 
H®Deviû
 *
deviû
 = 
NULL
;

475 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE_STORE
(
¡Üe
), 
NULL
);

476 
	`g_»tuº_v®_if_ç
(
Çme
 !ğ
NULL
, NULL);

478 ià(
	`hf_devŒ“_·r£_Çme
(
Çme
, &
driv”
, &
un™
))

480 
deviû
 = 
	`hf_devŒ“_fšd_·»Á_äom_šfo
(
¡Üe
, 
driv”
, 
un™
);

481 
	`g_ä“
(
driv”
);

484  
deviû
;

485 
	}
}

487 
H®Deviû
 *

488 
	$hf_devŒ“_fšd_·»Á_äom_šfo
 (
H®DeviûStÜe
 *
¡Üe
,

489 cÚ¡ *
driv”
,

490 
un™
)

492 
H®Deviû
 *
·»Á
 = 
NULL
;

493 *
driv”_™”
;

495 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE_STORE
(
¡Üe
), 
NULL
);

496 
	`g_»tuº_v®_if_ç
(
driv”
 !ğ
NULL
, NULL);

498 
driv”_™”
 = 
	`g_¡rdup
(
driv”
);

499 ! 
·»Á
 && 
driv”_™”
)

501 *
·»Á_Çme
;

503 
·»Á_Çme
 = 
	`hf_g‘_¡ršg_sysùl
(
NULL
, "dev.%s.%i.%%·»Á", 
driv”_™”
, 
un™
);

505 
	`g_ä“
(
driv”_™”
);

506 
driv”_™”
 = 
NULL
;

508 ià(
·»Á_Çme
)

510 
·»Á
 = 
	`hf_devŒ“_fšd_äom_Çme
(
¡Üe
, 
·»Á_Çme
);

511 ià(! 
·»Á
)

512 
	`hf_devŒ“_·r£_Çme
(
·»Á_Çme
, &
driv”_™”
, &
un™
);

513 
	`g_ä“
(
·»Á_Çme
);

517  
·»Á
;

518 
	}
}

521 
	$hf_devŒ“_deviû_£t_šfo
 (
H®Deviû
 *
deviû
, cÚ¡ *
driv”
, 
un™
)

523 *
devfe
;

525 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

526 
	`g_»tuº_if_ç
(
driv”
 !ğ
NULL
);

528 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "ä“bsd.driv”", 
driv”
);

529 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "ä“bsd.un™", 
un™
);

531 
devfe
 = 
	`g_¡rdup_´štf
("/dev/%s%i", 
driv”
, 
un™
);

532 ià(
	`g_fe_‹¡
(
devfe
, 
G_FILE_TEST_EXISTS
))

533 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "ä“bsd.deviû_fe", 
devfe
);

534 
	`g_ä“
(
devfe
);

535 
	}
}

537 
gboŞ—n


538 
	$hf_devŒ“_deviû_g‘_šfo
 (
H®Deviû
 *
deviû
, cÚ¡ **
driv”
, *
un™
)

540 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
deviû
), 
FALSE
);

542 ià(
	`hf_devŒ“_deviû_is
(
deviû
))

544 ià(
driv”
)

545 *
driv”
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "freebsd.driver");

546 ià(
un™
)

547 *
un™
 = 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "freebsd.unit");

549  
TRUE
;

552  
FALSE
;

553 
	}
}

556 
	$hf_devŒ“_deviû_£t_Çme
 (
H®Deviû
 *
deviû
, cÚ¡ *
Çme
)

558 *
driv”
;

559 
un™
;

561 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

562 
	`g_»tuº_if_ç
(
Çme
 !ğ
NULL
);

564 ià(
	`hf_devŒ“_·r£_Çme
(
Çme
, &
driv”
, &
un™
))

566 
	`hf_devŒ“_deviû_£t_šfo
(
deviû
, 
driv”
, 
un™
);

567 
	`g_ä“
(
driv”
);

569 
	}
}

572 
	$hf_devŒ“_deviû_g‘_Çme
 (
H®Deviû
 *
deviû
)

574 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
deviû
), 
NULL
);

576 ià(
	`hf_devŒ“_deviû_is
(
deviû
))

577  
	`g_¡rdup_´štf
("%s%i",

578 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "freebsd.driver"),

579 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "freebsd.unit"));

581  
NULL
;

582 
	}
}

584 
gboŞ—n


585 
	$hf_devŒ“_is_driv”
 (cÚ¡ *
Çme
, cÚ¡ *
driv”
)

587 *
un™
;

589 
	`g_»tuº_v®_if_ç
(
Çme
 !ğ
NULL
, 
FALSE
);

590 
	`g_»tuº_v®_if_ç
(
driv”
 !ğ
NULL
, 
FALSE
);

592 
un™
 = 
	`¡½brk
(
Çme
, "0123456789");

593 ià(
un™
)

594  ! 
	`¡ºcmp
(
Çme
, 
driv”
, 
un™
 -‚ame);

596  
FALSE
;

597 
	}
}

599 
HFHªdËr
 
	ghf_devŒ“_hªdËr
 = {

600 .
´obe
 = 
hf_devŒ“_´obe


	@hald/freebsd/hf-devtree.h

24 #iâdeà
_HF_DEVTREE_H


25 
	#_HF_DEVTREE_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"hf-os¥ec.h
"

33 
HFHªdËr
 
hf_devŒ“_hªdËr
;

35 
H®Deviû
 *
hf_devŒ“_fšd_äom_Çme
 (
H®DeviûStÜe
 *
¡Üe
,

36 cÚ¡ *
Çme
);

37 
H®Deviû
 *
hf_devŒ“_fšd_äom_šfo
 (
H®DeviûStÜe
 *
¡Üe
,

38 cÚ¡ *
driv”
,

39 
un™
);

41 
H®Deviû
 *
hf_devŒ“_fšd_·»Á_äom_Çme
 (
H®DeviûStÜe
 *
¡Üe
,

42 cÚ¡ *
Çme
);

43 
H®Deviû
 *
hf_devŒ“_fšd_·»Á_äom_šfo
 (
H®DeviûStÜe
 *
¡Üe
,

44 cÚ¡ *
driv”
,

45 
un™
);

47 
hf_devŒ“_deviû_£t_šfo
 (
H®Deviû
 *
deviû
,

48 cÚ¡ *
driv”
,

49 
un™
);

50 
gboŞ—n
 
hf_devŒ“_deviû_g‘_šfo
 (
H®Deviû
 *
deviû
,

51 cÚ¡ **
driv”
,

52 *
un™
);

54 
hf_devŒ“_deviû_£t_Çme
 (
H®Deviû
 *
deviû
, cÚ¡ *
devÇme
);

55 *
hf_devŒ“_deviû_g‘_Çme
 (
H®Deviû
 *
deviû
);

57 
gboŞ—n
 
hf_devŒ“_is_driv”
 (cÚ¡ *
Çme
, cÚ¡ *
driv”
);

	@hald/freebsd/hf-drm.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

29 
	~<”ºo.h
>

30 
	~<¡dlib.h
>

31 
	~<fú.h
>

32 
	~<sys/ioùl.h
>

33 
	~<uni¡d.h
>

35 
	~"../logg”.h
"

36 
	~"../os¥ec.h
"

38 
	~"hf-drm.h
"

39 
	~"hf-devŒ“.h
"

40 
	~"hf-ut.h
"

42 
	#HF_DRM_DEVICE
 "/dev/dri/ÿrd"

	)

46 
	mmajÜ
;

47 
	mmšÜ
;

48 
	m·tchËv–
;

49 
	mÇme_Ën
;

50 *
	mÇme
;

51 
	md©e_Ën
;

52 *
	md©e
;

53 
	mdesc_Ën
;

54 *
	mdesc
;

55 } 
	thf_drm_v”siÚ_t
;

57 
	#HF_DRM_VERSION_IOCTL
 
	`_IOWR
('d', 0x00, 
hf_drm_v”siÚ_t
)

	)

61 
	mšdex
;

62 *
	mÇme
;

63 *
	mv”siÚ
;

64 *
	mdeviû_fe
;

65 *
	mv’dÜ
;

66 } 
	tC¬d
;

68 
GSLi¡
 *
	gÿrds
 = 
NULL
;

70 
C¬d
 *

71 
	$hf_drm_fšd_ÿrd
 (
šdex
)

73 
GSLi¡
 *
l
;

75 
	`HF_LIST_FOREACH
(
l
, 
ÿrds
)

77 
C¬d
 *
ÿrd
 = 
l
->
d©a
;

79 ià(
ÿrd
->
šdex
 == index)

80  
ÿrd
;

83  
NULL
;

84 
	}
}

87 
	$hf_drm_v”siÚ_ä“
 (
hf_drm_v”siÚ_t
 *
v”s
)

89 
	`g_»tuº_if_ç
(
v”s
 !ğ
NULL
);

91 
	`g_ä“
(
v”s
->
Çme
);

92 
	`g_ä“
(
v”s
->
d©e
);

93 
	`g_ä“
(
v”s
->
desc
);

95 
	`g_ä“
(
v”s
);

96 
	}
}

99 
	$hf_drm_£t_´İ”t›s_»®
 (
H®Deviû
 *
deviû
, 
C¬d
 *
ÿrd
)

101 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

102 
	`g_»tuº_if_ç
(
ÿrd
 !ğ
NULL
);

104 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "drm");

106 ià(
ÿrd
->
v’dÜ
)

107 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.v’dÜ", 
ÿrd
->
v’dÜ
);

108 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "Direct Rendering Manager Device");

109 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.subsystem", "drm");

110 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "drm");

111 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "ä“bsd.deviû_fe", "%s%i", 
ÿrd
->
deviû_fe
, c¬d->
šdex
);

112 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "drm.dri_lib¿ry", 
ÿrd
->
Çme
);

113 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "drm.v”siÚ", 
ÿrd
->
v”siÚ
);

115 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_drm_%s_ÿrd%i", 
	`h®_deviû_´İ”ty_g‘_¡ršg
(deviû, "šfo.·»Á"), 
ÿrd
->
Çme
, c¬d->
šdex
);

116 
	}
}

118 
H®Deviû
 *

119 
	$hf_drm_deviû_Ãw
 (
H®Deviû
 *
·»Á
, 
C¬d
 *
ÿrd
)

121 
H®Deviû
 *
deviû
;

123 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
·»Á
), 
NULL
);

125 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

127 
	`hf_drm_£t_´İ”t›s_»®
(
deviû
, 
ÿrd
);

129  
deviû
;

130 
	}
}

133 
	$hf_drm_´iveged_š™
 ()

135 
i
;

137 
i
 = 0; i < 16; i++)

139 *
f’ame
;

140 
fd
;

142 
f’ame
 = 
	`g_¡rdup_´štf
(
HF_DRM_DEVICE
 "%i", 
i
);

143 
fd
 = 
	`İ’
(
f’ame
, 
O_RDONLY
);

144 
	`g_ä“
(
f’ame
);

146 ià(
fd
 >= 0)

148 
C¬d
 *
ÿrd
;

149 
hf_drm_v”siÚ_t
 *
drm_v”siÚ
;

150 
»s
;

152 
ÿrd
 = 
	`g_Ãw0
(
C¬d
, 1);

153 
ÿrd
->
šdex
 = 
i
;

154 
drm_v”siÚ
 = 
	`g_Ãw0
(
hf_drm_v”siÚ_t
, 1);

156 
»s
 = 
	`ioùl
(
fd
, 
HF_DRM_VERSION_IOCTL
, 
drm_v”siÚ
);

157 ià(
»s
)

159 
	`hf_drm_v”siÚ_ä“
(
drm_v”siÚ
);

160 
	`g_ä“
(
ÿrd
);

161 
	`şo£
(
fd
);

165 ià(
drm_v”siÚ
->
Çme_Ën
)

166 
drm_v”siÚ
->
Çme
 = 
	`g_m®loc
(drm_v”siÚ->
Çme_Ën
 + 1);

167 ià(
drm_v”siÚ
->
d©e_Ën
)

168 
drm_v”siÚ
->
d©e
 = 
	`g_m®loc
(drm_v”siÚ->
d©e_Ën
 + 1);

169 ià(
drm_v”siÚ
->
desc_Ën
)

170 
drm_v”siÚ
->
desc
 = 
	`g_m®loc
(drm_v”siÚ->
desc_Ën
 + 1);

172 
»s
 = 
	`ioùl
(
fd
, 
HF_DRM_VERSION_IOCTL
, 
drm_v”siÚ
);

173 
	`şo£
(
fd
);

175 ià(
»s
)

177 
	`hf_drm_v”siÚ_ä“
(
drm_v”siÚ
);

178 
	`g_ä“
(
ÿrd
);

182 ià(
drm_v”siÚ
->
Çme
)

183 
drm_v”siÚ
->
Çme
[drm_v”siÚ->
Çme_Ën
] = '\0';

184 ià(
drm_v”siÚ
->
d©e
)

185 
drm_v”siÚ
->
d©e
[drm_v”siÚ->
d©e_Ën
] = '\0';

186 ià(
drm_v”siÚ
->
desc
)

187 
drm_v”siÚ
->
desc
[drm_v”siÚ->
desc_Ën
] = '\0';

189 ià(! 
drm_v”siÚ
->
Çme
 || ! drm_v”siÚ->
d©e
)

191 
	`hf_drm_v”siÚ_ä“
(
drm_v”siÚ
);

192 
	`g_ä“
(
ÿrd
);

196 
ÿrd
->
v”siÚ
 = 
	`g_¡rdup_´štf
("drm %i.%i.%˜%s", 
drm_v”siÚ
->
majÜ
, drm_v”siÚ->
mšÜ
, drm_v”siÚ->
·tchËv–
, drm_v”siÚ->
d©e
);

197 
ÿrd
->
deviû_fe
 = 
	`g_¡rdup
(
HF_DRM_DEVICE
);

198 
ÿrd
->
Çme
 = 
	`g_¡rdup
(
drm_v”siÚ
->name);

199 ià(
drm_v”siÚ
->
desc
)

200 
ÿrd
->
v’dÜ
 = 
	`g_¡rdup
(
drm_v”siÚ
->
desc
);

201 
	`hf_drm_v”siÚ_ä“
(
drm_v”siÚ
);

203 
ÿrds
 = 
	`g_¦i¡_­³nd
(ÿrds, 
ÿrd
);

206 
	}
}

209 
	$hf_drm_£t_´İ”t›s
 (
H®Deviû
 *
deviû
)

211 
C¬d
 *
ÿrd
;

212 
un™
;

214 ià(! 
ÿrds
)

217 
un™
 = 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "freebsd.unit");

218 
ÿrd
 = 
	`hf_drm_fšd_ÿrd
(
un™
);

220 ià(! 
ÿrd
)

223 
	`hf_drm_£t_´İ”t›s_»®
(
deviû
, 
ÿrd
);

224 
	}
}

227 
	$hf_drm_´obe
 ()

229 
GSLi¡
 *
nvidŸ_deviûs
, *
l
;

231 
nvidŸ_deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(),

233 
	`HF_LIST_FOREACH
(
l
, 
nvidŸ_deviûs
)

235 
H®Deviû
 *
·»Á
 = 
	`HAL_DEVICE
(
l
->
d©a
);

237 ià(! 
	`h®_deviû_´İ”ty_g‘_boŞ
(
·»Á
, "info.ignore"))

239 
C¬d
 *
ÿrd
;

240 
H®Deviû
 *
deviû
;

241 
un™
;

243 
un™
 = 
	`h®_deviû_´İ”ty_g‘_št
(
·»Á
, "freebsd.unit");

244 
ÿrd
 = 
	`g_Ãw0
(
C¬d
, 1);

246 
ÿrd
->
šdex
 = 
un™
;

247 
ÿrd
->
Çme
 = 
	`g_¡rdup
("nvidia");

248 
ÿrd
->
v’dÜ
 = 
	`g_¡rdup
("nVidia Corporation");

249 
ÿrd
->
deviû_fe
 = 
	`g_¡rdup
("/dev/nvidia");

250 
ÿrd
->
v”siÚ
 = 
	`hf_g‘_¡ršg_sysùl
(
NULL
, "hw.nvidia.version");

252 
deviû
 = 
	`hf_drm_deviû_Ãw
(
·»Á
, 
ÿrd
);

254 ià(
deviû
)

255 
	`hf_deviû_´•robe_ªd_add
(
deviû
);

257 
	`g_ä“
(
ÿrd
->
Çme
);

258 
	`g_ä“
(
ÿrd
->
v”siÚ
);

259 
	`g_ä“
(
ÿrd
->
deviû_fe
);

260 
	`g_ä“
(
ÿrd
->
v’dÜ
);

261 
	`g_ä“
(
ÿrd
);

264 
	`g_¦i¡_ä“
(
nvidŸ_deviûs
);

265 
	}
}

267 
HFHªdËr
 
	ghf_drm_hªdËr
 =

269 .
´iveged_š™
 = 
hf_drm_´iveged_š™
,

270 .
	g´obe
 = 
hf_drm_´obe


	@hald/freebsd/hf-drm.h

24 #iâdeà
_HF_DRM_H


25 
	#_HF_DRM_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"hf-os¥ec.h
"

33 
HFHªdËr
 
hf_drm_hªdËr
;

35 
hf_drm_£t_´İ”t›s
 (
H®Deviû
 *
deviû
);

	@hald/freebsd/hf-net.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<¡ršg.h
>

30 
	~<uni¡d.h
>

31 
	~<sys/ty³s.h
>

32 
	~<sys/ioùl.h
>

33 
	~<sys/sock‘.h
>

34 
	~<sys/sockio.h
>

35 
	~<sys/sysùl.h
>

36 
	~<sys/time.h
>

37 
	~<Ãt/if.h
>

38 
	~<Ãt/if_¬p.h
>

39 
	~<Ãt/if_medŸ.h
>

40 
	~<Ãt/if_mib.h
>

42 
	~"../h®d_dbus.h
"

43 
	~"../logg”.h
"

44 
	~"../ut.h
"

46 
	~"hf-Ãt.h
"

47 
	~"hf-devŒ“.h
"

48 
	~"hf-ut.h
"

50 
gboŞ—n


51 
	$hf_Ãt_g‘_lšk_up
 (cÚ¡ *
š‹rçû
)

53 
fd
;

54 
iäeq
 
»q
;

55 
gboŞ—n
 
is_up
 = 
FALSE
;

57 
	`g_»tuº_v®_if_ç
(
š‹rçû
 !ğ
NULL
, 
FALSE
);

59 
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

60 ià(
fd
 < 0)

61  
FALSE
;

63 
	`mem£t
(&
»q
, 0, (req));

64 
	`¡ºıy
(
»q
.
iä_Çme
, 
š‹rçû
, (req.ifr_name));

66 ià(
	`ioùl
(
fd
, 
SIOCGIFFLAGS
, &
»q
è!ğ-1 && (»q.
iä_æags
 & 
IFF_UP
) != 0)

67 
is_up
 = 
TRUE
;

69 
	`şo£
(
fd
);

71  
is_up
;

72 
	}
}

74 
gušt64


75 
	$hf_Ãt_g‘_¿‹
 (
ifšdex
)

77 
ifmibd©a
 
ifmd
;

78 
oid
[6];

79 
size_t
 
Ën
;

80 
gušt64
 
»suÉ
;

82 
oid
[0] = 
CTL_NET
;

83 
oid
[1] = 
PF_LINK
;

84 
oid
[2] = 
NETLINK_GENERIC
;

85 
oid
[3] = 
IFMIB_IFDATA
;

86 
oid
[4] = 
ifšdex
;

87 
oid
[5] = 
IFDATA_GENERAL
;

89 
Ën
 = (
ifmd
);

91 ià(
	`sysùl
(
oid
, (oid)/(), &
ifmd
, &
Ën
, 
NULL
, 0) == -1)

92 
»suÉ
 = 0;

94 
»suÉ
 = 
ifmd
.
ifmd_d©a
.
ifi_baud¿‹
;

96  
»suÉ
;

97 
	}
}

100 
	$hf_Ãt_deviû_£t_lšk_up
 (
H®Deviû
 *
deviû
, 
gboŞ—n
 
is_up
)

102 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

104 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "Ãt.š‹rçû_up", 
is_up
);

105 ià(
	`h®_deviû_has_ÿ·b™y
(
deviû
, "net.80203"))

106 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "Ãt.80203.lšk", 
is_up
);

107 
	}
}

109 
H®Deviû
 *

110 
	$hf_Ãt_deviû_Ãw
 (cÚ¡ *
š‹rçû
, 
H®Deviû
 *
·»Á
, 
GE¼Ü
 **
”r
)

112 *
ouut
;

113 **
lšes
;

114 
i
;

115 
ifšdex
;

116 
GE¼Ü
 *
tmp_”r
 = 
NULL
;

117 cÚ¡ *
mac
 = 
NULL
;

118 cÚ¡ *
medŸ
 = 
NULL
;

119 
gboŞ—n
 
is_‘h”Ãt
 = 
FALSE
;

120 
gboŞ—n
 
is_wœ–ess
 = 
FALSE
;

121 
gboŞ—n
 
is_tok’ršg
 = 
FALSE
;

122 
H®Deviû
 *
deviû
 = 
NULL
;

124 
	`g_»tuº_v®_if_ç
(
š‹rçû
 !ğ
NULL
, NULL);

125 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
·»Á
), 
NULL
);

127 
ouut
 = 
	`hf_run
(&
tmp_”r
, "/sbš/ifcÚfig %s", 
š‹rçû
);

128 ià(! 
ouut
)

130 
	`g_£t_”rÜ
(
”r
, 0, 0, "ifcÚfig fau»: %s", 
tmp_”r
->
mes§ge
);

131 
	`g_”rÜ_ä“
(
tmp_”r
);

132  
NULL
;

135 
lšes
 = 
	`g_¡r¥l™
(
ouut
, "\n", 0);

136 
	`g_ä“
(
ouut
);

138 
i
 = 0; 
lšes
[i]; i++)

140 ià(
	`g_¡r_has_´efix
(
lšes
[
i
], "\tether "))

141 
mac
 = 
lšes
[
i
] + 7;

142 ià(
	`g_¡r_has_´efix
(
lšes
[
i
], "\tmedia: "))

143 
medŸ
 = 
lšes
[
i
] + 8;

144 ià(
	`g_¡r_has_´efix
(
lšes
[
i
], "\tmedia: Ethernet"))

145 
is_‘h”Ãt
 = 
TRUE
;

146 ià(
	`g_¡r_has_´efix
(
lšes
[
i
], "\tmedia: IEEE 802.11 Wireless Ethernet"))

148 
is_‘h”Ãt
 = 
TRUE
;

149 
is_wœ–ess
 = 
TRUE
;

151 ià(
	`g_¡r_has_´efix
(
lšes
[
i
], "\tmedia: Token„ing"))

152 
is_tok’ršg
 = 
TRUE
;

155 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

157 
	`hf_deviû_£t_udi
(
deviû
, "Ãt_%s", 
mac
 ? maø: 
	`h®_ut_g‘_Ï¡_–em’t
(
	`h®_deviû_g‘_udi
(
·»Á
)));

158 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "Networking Interface");

160 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "net");

161 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "Ãt.add»ss", 
mac
 ? mac : "00:00:00:00:00:00");

162 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "Ãt.š‹rçû", 
š‹rçû
);

163 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "Ãt.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
(
·»Á
));

164 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "Ãt.medŸ", 
medŸ
);

165 ià(
	`hf_devŒ“_is_driv”
(
š‹rçû
, "fwe"))

166 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "Ãt.¬p_´Ùo_hw_id", 
ARPHRD_IEEE1394
);

167 ià(
is_‘h”Ãt
)

168 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "Ãt.¬p_´Ùo_hw_id", 
ARPHRD_ETHER
);

169 ià(
is_tok’ršg
)

170 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "Ãt.¬p_´Ùo_hw_id", 
ARPHRD_IEEE802
);

173 
ifšdex
 = 
	`if_Çm‘ošdex
(
š‹rçû
);

174 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "Ãt.ä“bsd.ifšdex", 
ifšdex
);

176 ià(
is_‘h”Ãt
)

178 
dbus_ušt64_t
 
num”ic_mac
 = 0;

179 
a5
, 
a4
, 
a3
, 
a2
, 
a1
, 
a0
;

181 ià(
mac
 && 
	`ssÿnf
(mac, "%x:%x:%x:%x:%x:%x", &
a5
, &
a4
, &
a3
, &
a2
, &
a1
, &
a0
) == 6)

182 
num”ic_mac
 =

183 ((
dbus_ušt64_t
è
a5
 << 40) |

184 ((
dbus_ušt64_t
è
a4
 << 32) |

185 ((
dbus_ušt64_t
è
a3
 << 24) |

186 ((
dbus_ušt64_t
è
a2
 << 16) |

187 ((
dbus_ušt64_t
è
a1
 << 8) |

188 ((
dbus_ušt64_t
è
a0
 << 0);

190 ià(
is_wœ–ess
)

192 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "WLAN Networking Interface");

193 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "net.80211");

194 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "net.80211");

195 
	`h®_deviû_´İ”ty_£t_ušt64
(
deviû
, "Ãt.80211.mac_add»ss", 
num”ic_mac
);

199 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "net.80203");

200 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "net.80203");

201 
	`h®_deviû_´İ”ty_£t_ušt64
(
deviû
, "Ãt.80203.mac_add»ss", 
num”ic_mac
);

202 
	`h®_deviû_´İ”ty_£t_ušt64
(
deviû
, "Ãt.80203.¿‹", 
	`hf_Ãt_g‘_¿‹
(
ifšdex
));

206 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "net");

208 
	`g_¡rä“v
(
lšes
);

210 
	`hf_Ãt_deviû_£t_lšk_up
(
deviû
, 
	`hf_Ãt_g‘_lšk_up
(
š‹rçû
));

212  
deviû
;

213 
	}
}

215 
gboŞ—n


216 
	$hf_Ãt_upd©e_timeout_cb
 (
gpoš‹r
 
d©a
)

218 
GSLi¡
 *
l
;

220 ià(
hf_is_wa™šg
)

221  
TRUE
;

223 
	`HF_LIST_FOREACH
(
l
, 
	`h®d_g‘_gdl
()->
deviûs
)

225 
H®Deviû
 *
deviû
 = 
l
->
d©a
;

226 cÚ¡ *
š‹rçû
;

228 
š‹rçû
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "net.interface");

229 ià(
š‹rçû
)

231 
	`deviû_´İ”ty_©omic_upd©e_begš
();

232 
	`hf_Ãt_deviû_£t_lšk_up
(
deviû
, 
	`hf_Ãt_g‘_lšk_up
(
š‹rçû
));

233 
	`deviû_´İ”ty_©omic_upd©e_’d
();

237  
TRUE
;

238 
	}
}

241 
	$hf_Ãt_š™
 ()

243 
	`g_timeout_add
(3000, 
hf_Ãt_upd©e_timeout_cb
, 
NULL
);

244 
	}
}

247 
	$hf_Ãt_´obe
 ()

249 
GE¼Ü
 *
”r
 = 
NULL
;

250 *
ouut
;

251 *
‹rmš©Ü
;

252 **
š‹rçûs
;

253 
i
;

255 
ouut
 = 
	`hf_run
(&
”r
, "/sbin/ifconfig -l");

256 ià(! 
ouut
)

258 
	`HAL_WARNING
(("ifcÚfig fau»: %s", 
”r
->
mes§ge
));

259 
	`g_”rÜ_ä“
(
”r
);

263 
‹rmš©Ü
 = 
	`¡¼chr
(
ouut
, '\n');

264 ià(
‹rmš©Ü
)

265 *
‹rmš©Ü
 = 0;

267 
š‹rçûs
 = 
	`g_¡r¥l™
(
ouut
, " ", 0);

268 
	`g_ä“
(
ouut
);

270 
i
 = 0; 
š‹rçûs
[i]; i++)

271 ià(! 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(), "Ãt.š‹rçû", 
š‹rçûs
[
i
]))

273 
H®Deviû
 *
·»Á
;

275 
·»Á
 = 
	`hf_devŒ“_fšd_äom_Çme
(
	`h®d_g‘_gdl
(), 
š‹rçûs
[
i
]);

276 ià(
·»Á
 && ! 
	`h®_deviû_´İ”ty_g‘_boŞ
(parent, "info.ignore"))

278 
H®Deviû
 *
deviû
;

280 
deviû
 = 
	`hf_Ãt_deviû_Ãw
(
š‹rçûs
[
i
], 
·»Á
, &
”r
);

281 ià(
deviû
)

282 
	`hf_deviû_´•robe_ªd_add
(
deviû
);

285 
	`HAL_WARNING
(("uÇbËØhªdË‚‘wÜk iÁ”çû %s: %s", 
š‹rçûs
[
i
], 
”r
->
mes§ge
));

286 
	`g_ş—r_”rÜ
(&
”r
);

290 
	`g_¡rä“v
(
š‹rçûs
);

291 
	}
}

293 
gboŞ—n


294 
	$hf_Ãt_devd_add
 (cÚ¡ *
Çme
,

295 
GHashTabË
 *
·¿ms
,

296 
GHashTabË
 *
©
,

297 cÚ¡ *
·»Á
)

299 
s
;

300 
gboŞ—n
 
cÚsumed
 = 
FALSE
;

305 
s
 = 
	`sock‘
(
PF_INET
, 
SOCK_DGRAM
, 0);

306 ià(
s
 >= 0)

308 
ifmedŸ»q
 
ifmr
;

310 
	`mem£t
(&
ifmr
, 0, (ifmr));

311 
	`¡ºıy
(
ifmr
.
ifm_Çme
, 
Çme
, (ifmr.ifm_name));

313 ià(
	`ioùl
(
s
, 
SIOCGIFMEDIA
, (
ÿddr_t
è&
ifmr
) >= 0

314 && (
ifmr
.
ifm_¡©us
 & 
IFM_AVALID
) != 0)

316 
	`HAL_INFO
(("found‚ew‚‘wÜk iÁ”çû: %s", 
Çme
));

317 
	`hf_Ãt_´obe
();

318 
cÚsumed
 = 
TRUE
;

320 
	`şo£
(
s
);

323  
cÚsumed
;

324 
	}
}

326 
gboŞ—n


327 
	$hf_Ãt_devd_»move
 (cÚ¡ *
Çme
,

328 
GHashTabË
 *
·¿ms
,

329 
GHashTabË
 *
©
,

330 cÚ¡ *
·»Á
)

332 
H®Deviû
 *
deviû
;

338 
deviû
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(), "Ãt.š‹rçû", 
Çme
);

339 ià(
deviû
)

341 
	`hf_deviû_»move_Œ“
(
deviû
);

342  
TRUE
;

345  
FALSE
;

346 
	}
}

348 
gboŞ—n


349 
	$hf_Ãt_devd_nÙify
 (cÚ¡ *
sy¡em
,

350 cÚ¡ *
subsy¡em
,

351 cÚ¡ *
ty³
,

352 cÚ¡ *
d©a
)

354 
H®Deviû
 *
deviû
;

356 ià(
	`¡rcmp
(
sy¡em
, "IFNET"))

357  
FALSE
;

359 
deviû
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(), "Ãt.š‹rçû", 
subsy¡em
);

360 ià(
deviû
)

362 
gboŞ—n
 
is_up
;

364 ià(! 
	`¡rcmp
(
ty³
, "LINK_UP"))

365 
is_up
 = 
TRUE
;

366 ià(! 
	`¡rcmp
(
ty³
, "LINK_DOWN"))

367 
is_up
 = 
FALSE
;

369  
TRUE
;

371 
	`deviû_´İ”ty_©omic_upd©e_begš
();

372 
	`hf_Ãt_deviû_£t_lšk_up
(
deviû
, 
is_up
);

373 
	`deviû_´İ”ty_©omic_upd©e_’d
();

376  
TRUE
;

377 
	}
}

379 
HFHªdËr
 
	ghf_Ãt_hªdËr
 = {

380 .
š™
 = 
hf_Ãt_š™
,

381 .
	g´obe
 = 
hf_Ãt_´obe


384 
HFDevdHªdËr
 
	ghf_Ãt_devd_hªdËr
 = {

385 .
add
 = 
hf_Ãt_devd_add
,

386 .
	g»move
 = 
hf_Ãt_devd_»move
,

387 .
	gnÙify
 = 
hf_Ãt_devd_nÙify


	@hald/freebsd/hf-net.h

24 #iâdeà
_HF_NET_H


25 
	#_HF_NET_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"hf-os¥ec.h
"

32 
	~"hf-devd.h
"

34 
HFHªdËr
 
hf_Ãt_hªdËr
;

35 
HFDevdHªdËr
 
hf_Ãt_devd_hªdËr
;

	@hald/freebsd/hf-osspec.h

24 #iâdeà
_HF_OSSPEC_H


25 
	#_HF_OSSPEC_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"../h®d.h
"

35 (*
	m´iveged_š™
) ();

36 (*
	mš™
) ();

37 (*
	m´obe
) ();

38 
gboŞ—n
 (*
deviû_»sÿn
è(
H®Deviû
 *
	mdeviû
);

39 
gboŞ—n
 (*
deviû_»´obe
è(
H®Deviû
 *
	mdeviû
);

40 } 
	tHFHªdËr
;

	@hald/freebsd/hf-pci.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡dio.h
>

29 
	~<¡ršg.h
>

30 
	~<b™¡ršg.h
>

31 
	~<”ºo.h
>

32 
	~<fú.h
>

33 
	~<uni¡d.h
>

34 
	~<sys/ioùl.h
>

35 
	~<sys/ty³s.h
>

36 
	~<sys/pciio.h
>

37 
	~<glib.h
>

39 
	~"../h®d.h
"

40 
	~"../ids.h
"

41 
	~"../deviû.h
"

42 
	~"../logg”.h
"

43 
	~"../ut.h
"

45 
	~"hf-pci.h
"

46 
	~"hf-devŒ“.h
"

47 
	~"hf-ut.h
"

49 
	#HF_PCI_DEVICE
 "/dev/pci"

	)

52 
	#PCIR_SECBUS_1
 0x19

	)

53 
	#PCIR_HDRTYPE
 0x0e

	)

54 
	#PCIM_HDRTYPE_BRIDGE
 0x01

	)

55 
	#PCIM_HDRTYPE_CARDBUS
 0x02

	)

56 
	#PCIM_MFDEV
 0x80

	)

60 
H®Deviû
 *
	mdeviû
;

61 
pci_cÚf
 
	mp
;

62 
	m£cÚd¬y_bus
;

63 
	mh—d”_ty³
;

64 } 
	tDeviûInfo
;

66 
	ghf_pci_fd
;

69 
	$hf_pci_g‘_»gi¡”
 (cÚ¡ 
pci_cÚf
 *
p
, 
»g
)

71 
pci_io
 
io
;

73 
	`g_»tuº_v®_if_ç
(
p
 !ğ
NULL
, 0);

75 
	`mem£t
(&
io
, 0, (io));

76 
io
.
pi_£l
 = 
p
->
pc_£l
;

77 
io
.
pi_»g
 = 
»g
;

78 
io
.
pi_width
 = 1;

80 ià(
	`ioùl
(
hf_pci_fd
, 
PCIOCREAD
, &
io
) < 0)

82 
	`HAL_WARNING
(("uÇbËØ»ad„egi¡” %.2x oàPCI deviû %i:%i:%i", 
»g
, 
p
->
pc_£l
.
pc_bus
,…->pc_£l.
pc_dev
,…->pc_£l.
pc_func
));

86  
io
.
pi_d©a
;

87 
	}
}

89 
H®Deviû
 *

90 
	$hf_pci_deviû_Ãw
 (
H®Deviû
 *
·»Á
, cÚ¡ 
pci_cÚf
 *
p
, 
£cÚd¬y_bus
)

92 
H®Deviû
 *
deviû
;

93 *
v’dÜ
;

94 *
´oduù
;

95 *
subsys_v’dÜ
;

96 *
subsys_´oduù
;

98 
	`g_»tuº_v®_if_ç
(
p
 !ğ
NULL
, NULL);

100 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

102 
	`hf_deviû_£t_udi
(
deviû
, "pci_%.4x_%.4x", 
p
->
pc_v’dÜ
,…->
pc_deviû
);

103 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.subsystem", "pci");

104 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pci.deviû_şass", 
p
->
pc_şass
);

105 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pci.deviû_subşass", 
p
->
pc_subşass
);

106 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pci.deviû_´ÙocŞ", 
p
->
pc_´ogif
);

107 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pci.´oduù_id", 
p
->
pc_deviû
);

108 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pci.v’dÜ_id", 
p
->
pc_v’dÜ
);

109 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pci.subsys_´oduù_id", 
p
->
pc_subdeviû
);

110 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pci.subsys_v’dÜ_id", 
p
->
pc_subv’dÜ
);

112 ià(
p
->
pd_Çme
 && *p->pd_name)

113 
	`hf_devŒ“_deviû_£t_šfo
(
deviû
, 
p
->
pd_Çme
,…->
pd_un™
);

115 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pci.ä“bsd.bus", 
p
->
pc_£l
.
pc_bus
);

116 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pci.ä“bsd.deviû", 
p
->
pc_£l
.
pc_dev
);

117 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pci.ä“bsd.funùiÚ", 
p
->
pc_£l
.
pc_func
);

118 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pci.ä“bsd.£cÚd¬y_bus", 
£cÚd¬y_bus
);

120 
	`ids_fšd_pci
(
p
->
pc_v’dÜ
,…->
pc_deviû
,

121 
p
->
pc_subv’dÜ
,…->
pc_subdeviû
,

122 &
v’dÜ
, &
´oduù
,

123 &
subsys_v’dÜ
, &
subsys_´oduù
);

125 ià(
v’dÜ
)

127 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.v’dÜ", 
v’dÜ
);

128 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "pci.v’dÜ", 
v’dÜ
);

130 ià(
´oduù
)

132 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.´oduù", 
´oduù
);

133 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "pci.´oduù", 
´oduù
);

135 ià(
subsys_v’dÜ
)

136 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "pci.subsys_v’dÜ", 
subsys_v’dÜ
);

137 ià(
subsys_´oduù
)

138 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "pci.subsys_´oduù", 
subsys_´oduù
);

140  
deviû
;

141 
	}
}

144 
	$hf_pci_´iveged_š™
 ()

146 
hf_pci_fd
 = 
	`İ’
(
HF_PCI_DEVICE
, 
O_RDWR
);

147 ià(
hf_pci_fd
 < 0)

148 
	`HAL_INFO
(("uÇbËØİ’ %s: %s", 
HF_PCI_DEVICE
, 
	`g_¡»¼Ü
(
”ºo
)));

149 
	}
}

152 
	$hf_pci_´obe_bus
 (
H®Deviû
 *
·»Á
, 
bus
, 
b™¡r_t
 *
busm­
)

154 
pci_m©ch_cÚf
 
m©ch_cÚf
;

155 
pci_cÚf_io
 
pc
;

156 
pci_cÚf
 
cÚf
[255];

157 
pci_cÚf
 *
p
;

158 
GSLi¡
 *
deviûs
 = 
NULL
;

159 
GSLi¡
 *
l
;

161 
	`g_»tuº_if_ç
(
busm­
 !ğ
NULL
);

162 
	`g_»tuº_if_ç
(
bus
 >= 0 && bus <= 0xff);

165 ià(
	`b™_‹¡
(
busm­
, 
bus
))

167 
	`HAL_WARNING
(("PCI bu %.2x‡µ—ršgwiû (fœmw¬bug), ignÜed", 
bus
));

171 
	`b™_£t
(
busm­
, 
bus
);

173 
¡¬t
:

174 
	`mem£t
(&
m©ch_cÚf
, 0, (match_conf));

175 
m©ch_cÚf
.
pc_£l
.
pc_bus
 = 
bus
;

176 
m©ch_cÚf
.
æags
 = 
PCI_GETCONF_MATCH_BUS
;

178 
	`mem£t
(&
pc
, 0, (pc));

179 
pc
.
·t_buf_Ën
 = (
m©ch_cÚf
);

180 
pc
.
num_·‰”ns
 = 1;

181 
pc
.
·‰”ns
 = &
m©ch_cÚf
;

182 
pc
.
m©ch_buf_Ën
 = (
cÚf
);

183 
pc
.
m©ches
 = 
cÚf
;

189 ià(
	`ioùl
(
hf_pci_fd
, 
PCIOCGETCONF
, &
pc
) < 0)

191 
	`HAL_WARNING
(("ioùÈPCIOCGETCONF: %s", 
	`g_¡»¼Ü
(
”ºo
)));

195 ià(
pc
.
¡©us
 =ğ
PCI_GETCONF_LIST_CHANGED
)

197 
	`g_¦i¡_fÜ—ch
(
deviûs
, (
GFunc
è
g_ä“
, 
NULL
);

198 
	`g_¦i¡_ä“
(
deviûs
);

199 
deviûs
 = 
NULL
;

200 
¡¬t
;

202 ià(
pc
.
¡©us
 =ğ
PCI_GETCONF_ERROR
)

204 
	`HAL_WARNING
(("PCI_GETCONF_ERROR"));

208 
p
 = 
cÚf
;… < &cÚf[
pc
.
num_m©ches
];…++)

210 
DeviûInfo
 *
šfo
;

212 
šfo
 = 
	`g_Ãw
(
DeviûInfo
, 1);

213 
šfo
->
deviû
 = 
	`hf_deviû_¡Üe_m©ch
(
	`h®d_g‘_gdl
(),

215 
HAL_PROPERTY_TYPE_INT32
,

216 
p
->
pc_£l
.
pc_bus
,

218 
HAL_PROPERTY_TYPE_INT32
,

219 
p
->
pc_£l
.
pc_dev
,

221 
HAL_PROPERTY_TYPE_INT32
,

222 
p
->
pc_£l
.
pc_func
,

223 
NULL
);

224 
šfo
->
p
 = *p;

225 
šfo
->
£cÚd¬y_bus
 = 
	`hf_pci_g‘_»gi¡”
(
p
, 
PCIR_SECBUS_1
);

226 
šfo
->
h—d”_ty³
 = 
	`hf_pci_g‘_»gi¡”
(
p
, 
PCIR_HDRTYPE
);

228 
deviûs
 = 
	`g_¦i¡_´•’d
(deviûs, 
šfo
);

231 
pc
.
¡©us
 =ğ
PCI_GETCONF_MORE_DEVS
);

235 
	`HF_LIST_FOREACH
(
l
, 
deviûs
)

237 
DeviûInfo
 *
šfo
 = 
l
->
d©a
;

244 ià(! 
šfo
->
deviû
)

246 
šfo
->
deviû
 = 
	`hf_pci_deviû_Ãw
(
·»Á
, &šfo->
p
, info->
£cÚd¬y_bus
);

247 ià(
	`hf_deviû_´•robe
(
šfo
->
deviû
))

248 
	`hf_deviû_add
(
šfo
->
deviû
);

253 ià(
šfo
->
h—d”_ty³
 =ğ
PCIM_HDRTYPE_BRIDGE
 || info->h—d”_ty³ =ğ
PCIM_HDRTYPE_CARDBUS
 || (šfo->h—d”_ty³ & ~
PCIM_MFDEV
) == PCIM_HDRTYPE_BRIDGE || (info->header_type & ~PCIM_MFDEV) == PCIM_HDRTYPE_CARDBUS)

255 
	`hf_pci_´obe_bus
(
šfo
->
deviû
, info->
£cÚd¬y_bus
, 
busm­
);

260 
	`g_¦i¡_fÜ—ch
(
deviûs
, (
GFunc
è
g_ä“
, 
NULL
);

261 
	`g_¦i¡_ä“
(
deviûs
);

262 
	}
}

265 
	$hf_pci_´obe
 ()

267 
b™¡r_t
 
	`b™_deş
(
busm­
, 256) = { 0 };

269 ià(
hf_pci_fd
 < 0)

272 
	`hf_pci_´obe_bus
(
NULL
, 0, 
busm­
);

273 
	}
}

275 
HFHªdËr
 
	ghf_pci_hªdËr
 = {

276 .
´iveged_š™
 = 
hf_pci_´iveged_š™
,

277 .
	g´obe
 = 
hf_pci_´obe


	@hald/freebsd/hf-pci.h

24 #iâdeà
_HF_PCI_H


25 
	#_HF_PCI_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"hf-os¥ec.h
"

33 
HFHªdËr
 
hf_pci_hªdËr
;

	@hald/freebsd/hf-pcmcia.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡dio.h
>

29 
	~<¡ršg.h
>

31 
	~"../h®d_dbus.h
"

32 
	~"../logg”.h
"

34 
	~"hf-pcmcŸ.h
"

35 
	~"hf-devŒ“.h
"

36 
	~"hf-ut.h
"

39 
	$hf_pcmcŸ_£t_Ûm_šfo
 (
H®Deviû
 *
deviû
,

40 cÚ¡ *
šfo
,

41 cÚ¡ *
šfo_´İ”ty
,

42 cÚ¡ *
id_´İ”ty
)

44 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

45 
	`g_»tuº_if_ç
(
šfo_´İ”ty
 !ğ
NULL
);

46 
	`g_»tuº_if_ç
(
id_´İ”ty
 !ğ
NULL
);

48 ià(
šfo
)

49 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, 
šfo_´İ”ty
, 
šfo
);

52 
id
;

54 
id
 = 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, 
id_´İ”ty
);

55 ià(
id
 > -1)

56 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, 
šfo_´İ”ty
, "UnknowÀ(0x%04x)", 
id
);

58 
	}
}

61 
	$hf_pcmcŸ_upd©e_cis
 (
H®Deviû
 *
deviû
)

63 *
devÇme
;

64 *
ouut
;

65 *
v’dÜ
 = 
NULL
, *
´oduù
 = NULL;

66 **
lšes
;

67 cÚ¡ *
commªd
;

68 
i
;

70 
devÇme
 = 
	`hf_devŒ“_deviû_g‘_Çme
(
deviû
);

71 ià(
	`g_fe_‹¡
("/u¤/sbš/dumpcis", 
G_FILE_TEST_IS_EXECUTABLE
))

73 
commªd
 = "/usr/sbin/dumpcis";

77 
commªd
 = "/usr/sbin/pccardc dumpcisfile";

79 
ouut
 = 
	`hf_run
(
NULL
, "% /dev/%s.cis", 
commªd
, 
devÇme
);

80 
	`g_ä“
(
devÇme
);

82 ià(! 
ouut
)

86 
lšes
 = 
	`g_¡r¥l™
(
ouut
, "\n", 0);

87 
	`g_ä“
(
ouut
);

89 
i
 = 0; 
lšes
[i]; i++)

91 ià(
	`g_¡r_has_´efix
(
lšes
[
i
], "\tPCMCIA ID ="))

93 
mªuf_id
, 
ÿrd_id
;

95 ià(
	`ssÿnf
(
lšes
[
i
], "\tPCMCIA ID = 0x%x, OEM ID = 0x%x", &
mªuf_id
,

96 &
ÿrd_id
))

98 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pcmcŸ.mªf_id", 
mªuf_id
);

99 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pcmcŸ.ÿrd_id", 
ÿrd_id
);

102 ià(
	`¡r¡r
(
lšes
[
i
], "Functional ID"))

104 ià(
lšes
[
i
 + 1])

106 
func_id
;

108 ià(
	`ssÿnf
(
lšes
[
i
 + 1], " 000: %x", &
func_id
))

109 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pcmcia.func_id",

110 
func_id
);

113 ià(
	`g_¡r_has_´efix
(
lšes
[
i
], "\tVersion ="))

115 **
toks
;

117 
toks
 = 
	`g_¡r¥l™_£t
(
lšes
[
i
], "[]", 0);

118 ià(
	`g_¡rv_Ëngth
(
toks
) >= 2)

119 
v’dÜ
 = 
	`g_¡rdup
(
toks
[1]);

120 
	`g_¡rä“v
(
toks
);

122 ià(
	`g_¡r_has_´efix
(
lšes
[
i
], "\tAddit. info ="))

124 **
toks
;

126 
toks
 = 
	`g_¡r¥l™_£t
(
lšes
[
i
], "[]", 0);

127 ià(
	`g_¡rv_Ëngth
(
toks
) >= 2)

128 
´oduù
 = 
	`g_¡rdup
(
toks
[1]);

129 
	`g_¡rä“v
(
toks
);

132 
	`g_¡rä“v
(
lšes
);

134 
	`hf_pcmcŸ_£t_Ûm_šfo
(
deviû
, 
v’dÜ
, "info.vendor", "pcmcia.manf_id");

135 
	`g_ä“
(
v’dÜ
);

137 
	`hf_pcmcŸ_£t_Ûm_šfo
(
deviû
, 
´oduù
, "info.product", "pcmcia.card_id");

138 
	`g_ä“
(
´oduù
);

139 
	}
}

142 
	$hf_pcmcŸ_£t_´İ”t›s
 (
H®Deviû
 *
deviû
)

145 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.subsystem", "pcmcia");

146 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "pcmcia_socket");

147 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "pcmcia_socket");

148 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "pcmcia_socket.number",

149 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "freebsd.unit"));

150 
	`hf_pcmcŸ_upd©e_cis
(
deviû
);

151 
	}
}

153 
gboŞ—n


154 
	$hf_pcmcŸ_devd_add
 (cÚ¡ *
Çme
,

155 
GHashTabË
 *
·¿ms
,

156 
GHashTabË
 *
©
,

157 cÚ¡ *
·»Á
)

159 
H®Deviû
 *
deviû
;

161 ià(! 
·»Á
)

162  
FALSE
;

163 ià(! 
	`hf_devŒ“_is_driv”
(
·»Á
, "pccard") && ! hf_devtree_is_driver(parent, "cardbus"))

164  
FALSE
;

166 
deviû
 = 
	`hf_devŒ“_fšd_äom_Çme
(
	`h®d_g‘_gdl
(), 
·»Á
);

167 ià(
deviû
)

169 ià(
Çme
)

170 
	`HAL_INFO
(("found‚ew PC C¬d % Ú %s", 
Çme
, 
·»Á
));

172 
	`HAL_INFO
(("upd©šg PC C¬d infÜm©iÚ fÜ %s", 
·»Á
));

174 
	`deviû_´İ”ty_©omic_upd©e_begš
();

175 
	`hf_pcmcŸ_upd©e_cis
(
deviû
);

176 
	`deviû_´İ”ty_©omic_upd©e_’d
();

178  
TRUE
;

181  
FALSE
;

182 
	}
}

184 
gboŞ—n


185 
	$hf_pcmcŸ_devd_nom©ch
 (
GHashTabË
 *
©
,

186 cÚ¡ *
·»Á
)

188  
	`hf_pcmcŸ_devd_add
(
NULL
, NULL, NULL, 
·»Á
);

189 
	}
}

191 
gboŞ—n


192 
	$hf_pcmcŸ_devd_»move
 (cÚ¡ *
Çme
,

193 
GHashTabË
 *
·¿ms
,

194 
GHashTabË
 *
©
,

195 cÚ¡ *
·»Á
)

197 ià(! 
·»Á
)

198  
FALSE
;

199 ià(! 
	`hf_devŒ“_is_driv”
(
·»Á
, "pccard") && ! hf_devtree_is_driver(parent, "cardbus"))

200  
FALSE
;

202 
	`HAL_INFO
(("d‘eùed„emov® oàPC C¬d %s", 
Çme
));

203  
	`hf_pcmcŸ_devd_add
(
NULL
, NULL, NULL, 
·»Á
);

204 
	}
}

206 
HFDevdHªdËr
 
	ghf_pcmcŸ_devd_hªdËr
 = {

207 .
add
 = 
hf_pcmcŸ_devd_add
,

208 .
	g»move
 = 
hf_pcmcŸ_devd_»move
,

209 .
	gnom©ch
 = 
hf_pcmcŸ_devd_nom©ch


	@hald/freebsd/hf-pcmcia.h

24 #iâdeà
_HF_PCMCIA_H


25 
	#_HF_PCMCIA_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"../h®d.h
"

33 
	~"hf-devd.h
"

35 
HFDevdHªdËr
 
hf_pcmcŸ_devd_hªdËr
;

37 
hf_pcmcŸ_£t_´İ”t›s
 (
H®Deviû
 *
deviû
);

	@hald/freebsd/hf-scsi.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

29 
	~<fú.h
>

30 
	~<”ºo.h
>

31 
	~<sys/ty³s.h
>

32 
	~<sys/ioùl.h
>

33 
	~<¡dio.h
>

34 
	~<ÿm/ÿm.h
>

35 
	~<ÿm/ÿm_ccb.h
>

36 
	~<ÿm/scsi/scsi_®l.h
>

37 
	~<ÿm/scsi/scsi_·ss.h
>

39 
	~"../logg”.h
"

41 
	~"hf-scsi.h
"

42 
	~"hf-©a.h
"

43 
	~"hf-block.h
"

44 
	~"hf-devŒ“.h
"

45 
	~"hf-¡Üage.h
"

46 
	~"hf-ut.h
"

48 
	#HF_SCSI_DEVICE
 "/dev/x±0"

	)

50 
	#N_RESULTS
 100

	)

52 
	ghf_scsi_fd
;

54 
gboŞ—n


55 
	$hf_scsi_is_cdrom
 (
ty³
)

57  (
ty³
 =ğ
T_CDROM
 ||y³ =ğ
T_WORM
 ||y³ =ğ
T_OPTICAL
);

58 
	}
}

60 
H®Deviû
 *

61 
	$hf_scsi_bus_deviû_Ãw
 (
H®Deviû
 *
·»Á
,

62 cÚ¡ 
bus_m©ch_»suÉ
 *
m©ch
)

64 
H®Deviû
 *
deviû
;

66 
	`g_»tuº_v®_if_ç
(
m©ch
 !ğ
NULL
, NULL);

68 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

70 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.subsystem", "scsi_host");

71 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "scsi_ho¡.ho¡", 
m©ch
->
·th_id
);

72 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "SCSI Host Adapter");

75 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_scsi_ho¡", 
	`h®_deviû_´İ”ty_g‘_¡ršg
(device, "info.parent"));

77  
deviû
;

78 
	}
}

80 
H®Deviû
 *

81 
	$hf_scsi_scsi_deviû_Ãw
 (
H®Deviû
 *
·»Á
,

82 cÚ¡ 
deviû_m©ch_»suÉ
 *
m©ch
)

84 
H®Deviû
 *
deviû
;

86 
v’dÜ
[16];

87 
´oduù
[48];

88 
ty³
;

90 
	`g_»tuº_v®_if_ç
(
m©ch
 !ğ
NULL
, NULL);

92 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

94 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.subsystem", "scsi");

95 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "scsi.ho¡", 
m©ch
->
·th_id
);

96 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "scsi.bus", 
m©ch
->
·th_id
);

97 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "scsi.rg‘", 
m©ch
->
rg‘_id
);

98 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "scsi.lun", 
m©ch
->
rg‘_lun
);

99 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "SCSI Device");

101 
	`ÿm_¡rvis
(
v’dÜ
, 
m©ch
->
šq_d©a
.vendor, (match->inq_data.vendor), (vendor));

102 
	`ÿm_¡rvis
(
´oduù
, 
m©ch
->
šq_d©a
.product, (match->inq_data.product), (product));

104 ià(*
v’dÜ
)

106 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.v’dÜ", 
v’dÜ
);

107 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "scsi.v’dÜ", 
v’dÜ
);

109 ià(*
´oduù
)

110 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "scsi.mod–", 
´oduù
);

113 
ty³
 = 
	`SID_TYPE
(&
m©ch
->
šq_d©a
);

114 
ty³
)

116 
T_DIRECT
:

117 
T_RBC
:

120 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "scsi.type", "disk");

122 
T_SEQUENTIAL
:

123 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "scsi.type", "tape");

125 
T_PRINTER
:

126 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "scsi.type", "printer");

128 
T_PROCESSOR
:

129 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "scsi.type", "processor");

131 
T_WORM
:

132 
T_CDROM
:

133 
T_OPTICAL
:

134 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "scsi.type", "cdrom");

136 
T_CHANGER
:

137 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "scsi.type", "medium_changer");

139 
T_SCANNER
:

140 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "scsi.type", "scanner");

142 
T_STORARRAY
:

143 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "scsi.type", "array");

146 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "scsi.type", "unknown");

150 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_scsi_device_lun%i",

151 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "info.parent"),

152 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "scsi.lun"));

154  
deviû
;

155 
	}
}

157 
H®Deviû
 *

158 
	$hf_scsi_block_deviû_Ãw
 (
H®Deviû
 *
·»Á
,

159 cÚ¡ 
deviû_m©ch_»suÉ
 *
m©ch
,

160 cÚ¡ *
devÇme
)

162 
H®Deviû
 *
deviû
;

163 
ty³
;

165 
»visiÚ
[16];

167 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
·»Á
), 
NULL
);

168 
	`g_»tuº_v®_if_ç
(
m©ch
 !ğ
NULL
, NULL);

169 
	`g_»tuº_v®_if_ç
(
devÇme
 !ğ
NULL
, NULL);

171 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

173 
	`hf_devŒ“_deviû_£t_Çme
(
deviû
, 
devÇme
);

174 
	`hf_block_deviû_’abË
(
deviû
, 
devÇme
);

176 
	`hf_¡Üage_deviû_’abË
(
deviû
);

178 
ty³
 = 
	`SID_TYPE
(&
m©ch
->
šq_d©a
);

180 ià(
ty³
 =ğ
T_SEQUENTIAL
)

181 
	`hf_¡Üage_deviû_’abË_³
(
deviû
);

182 ià(
	`hf_scsi_is_cdrom
(
ty³
))

183 
	`hf_¡Üage_deviû_’abË_cdrom
(
deviû
);

185 ià(
	`SID_IS_REMOVABLE
(&
m©ch
->
šq_d©a
))

187 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.»movabË", 
TRUE
);

188 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.medŸ_check_’abËd", 
TRUE
);

189 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.»movabË.suµÜt_async_nÙifiÿtiÚ", 
FALSE
);

192 
	`ÿm_¡rvis
(
»visiÚ
, 
m©ch
->
šq_d©a
.revision, (match->inq_data.revision), (revision));

194 ià(
	`h®_deviû_has_´İ”ty
(
·»Á
, "scsi.vendor"))

196 
	`h®_deviû_cİy_´İ”ty
(
·»Á
, "scsi.v’dÜ", 
deviû
, "info.vendor");

197 
	`h®_deviû_cİy_´İ”ty
(
·»Á
, "scsi.v’dÜ", 
deviû
, "storage.vendor");

199 ià(
	`h®_deviû_has_´İ”ty
(
·»Á
, "scsi.model"))

201 
	`h®_deviû_cİy_´İ”ty
(
·»Á
, "scsi.mod–", 
deviû
, "info.product");

202 
	`h®_deviû_cİy_´İ”ty
(
·»Á
, "scsi.mod–", 
deviû
, "storage.model");

204 ià(*
»visiÚ
)

205 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "¡Üage.fœmw¬e_»visiÚ", 
»visiÚ
);

211 
·»Á
)

213 cÚ¡ *
bus
;

214 cÚ¡ *
·»Á_udi
;

216 
bus
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
·»Á
, "info.subsystem");

217 ià(
bus
)

219 ià(! 
	`¡rcmp
(
bus
, "scsi"))

221 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "storage.bus", "scsi");

222 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "¡Üage.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
(
·»Á
));

223 
	`h®_deviû_cİy_´İ”ty
(
·»Á
, "scsi.lun", 
deviû
, "storage.lun");

226 ià(! 
	`¡rcmp
(
bus
, "usb"))

228 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "storage.bus", "usb");

229 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "¡Üage.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
(
·»Á
));

230 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.hÙ¶uggabË", 
TRUE
);

235 
·»Á_udi
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
·»Á
, "info.parent");

236 ià(
·»Á_udi
)

238 
·»Á
 = 
	`h®_deviû_¡Üe_fšd
(
	`h®d_g‘_gdl
(), 
·»Á_udi
);

239 
	`g_as£¹
(
·»Á
 !ğ
NULL
);

242 
·»Á
 = 
NULL
;

245  
deviû
;

246 
	}
}

249 
	$hf_scsi_´iveged_š™
 ()

251 
hf_scsi_fd
 = 
	`İ’
(
HF_SCSI_DEVICE
, 
O_RDWR
);

252 ià(
hf_scsi_fd
 < 0)

253 
	`HAL_INFO
(("uÇbËØİ’ %s: %s", 
HF_SCSI_DEVICE
, 
	`g_¡»¼Ü
(
”ºo
)));

254 
	}
}

256 
H®Deviû
 *

257 
	$hf_scsi_g‘_©a_chªÃl
 (
H®Deviû
 *
scsi_bus
)

259 
H®Deviû
 *
·»Á
;

261 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
scsi_bus
), 
NULL
);

263 
·»Á
 = 
	`hf_deviû_¡Üe_g‘_·»Á
(
	`h®d_g‘_gdl
(), 
scsi_bus
);

264 ià(
·»Á
)

266 cÚ¡ *
driv”
;

268 
driv”
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
·»Á
, "freebsd.driver");

269 ià(! 
driv”
 || 
	`¡rcmp
(driver, "ata"))

270 
·»Á
 = 
NULL
;

273  
·»Á
;

274 
	}
}

276 
H®Deviû
 *

277 
	$hf_scsi_g‘_©­i_deviû
 (
H®Deviû
 *
©a_chªÃl
, 
rg‘_id
)

279 
H®Deviû
 *
deviû
 = 
NULL
;

280 
ide_ho¡
;

281 
GLi¡
 *
l
;

283 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
©a_chªÃl
), 
NULL
);

284 
	`g_»tuº_v®_if_ç
(
rg‘_id
 =ğ0 ||¬g‘_id =ğ1, 
NULL
);

286 
ide_ho¡
 = 
	`h®_deviû_´İ”ty_g‘_št
(
©a_chªÃl
, "ide_host.number");

293 
	`HF_LIST_FOREACH
(
l
, 
hf_©a_³ndšg_deviûs
)

295 
H®Deviû
 *
chd
 = 
	`HAL_DEVICE
(
l
->
d©a
);

296 
H®Deviû
 *
·»Á
;

297 cÚ¡ *
driv”
;

298 cÚ¡ *
phys_deviû
;

299 
ho¡
;

300 
chªÃl
;

302 
driv”
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
chd
, "freebsd.driver");

304 ià(! 
driv”
 || (
	`¡rcmp
(driver, "acd") && strcmp(driver, "ast") && strcmp(driver, "afd")))

307 
phys_deviû
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
chd
, "storage.originating_device");

308 ià(! 
phys_deviû
)

311 
·»Á
 = 
	`h®_deviû_¡Üe_fšd
(
	`h®d_g‘_gdl
(), 
phys_deviû
);

312 ià(! 
·»Á
)

315 
ho¡
 = 
	`h®_deviû_´İ”ty_g‘_št
(
·»Á
, "ide.host");

316 ià(
ho¡
 !ğ
ide_ho¡
)

319 
chªÃl
 = 
	`h®_deviû_´İ”ty_g‘_št
(
·»Á
, "ide.channel");

320 ià(
rg‘_id
 =ğ
chªÃl
)

322 
deviû
 = 
chd
;

327  
deviû
;

328 
	}
}

331 
	$hf_scsi_hªdË_³ndšg_deviû
 (
deviû_m©ch_»suÉ
 **
m©ch
,

332 **
devÇme
)

334 
	`g_»tuº_if_ç
(
m©ch
 !ğ
NULL
);

335 
	`g_»tuº_if_ç
(
devÇme
 !ğ
NULL
);

337 ià(*
m©ch
 && *
devÇme
)

339 
H®Deviû
 *
·»Á
;

341 
·»Á
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_št
(
	`h®d_g‘_gdl
(), "scsi_ho¡.ho¡", (*
m©ch
)->
·th_id
);

342 ià(! 
·»Á
 || ! 
	`h®_deviû_´İ”ty_g‘_boŞ
(parent, "info.ignore"))

344 
H®Deviû
 *
©­i_deviû
 = 
NULL
;

345 
H®Deviû
 *
scsi_deviû
;

346 
ty³
;

355 ià(
·»Á
)

357 
H®Deviû
 *
©a_chªÃl
;

359 
©a_chªÃl
 = 
	`hf_scsi_g‘_©a_chªÃl
(
·»Á
);

360 ià(
©a_chªÃl
)

362 
©­i_deviû
 = 
	`hf_scsi_g‘_©­i_deviû
(
©a_chªÃl
, (*
m©ch
)->
rg‘_id
);

363 ià(
©­i_deviû
)

365 *
ÿm_devÇme
;

366 *
scsi_·th
;

368 
ÿm_devÇme
 = 
	`g_¡rdup_´štf
("/dev/%s", *
devÇme
);

369 
scsi_·th
 = 
	`g_¡rdup_´štf
("%d,%d,%d", (*
m©ch
)->
·th_id
, (*m©ch)->
rg‘_id
, (*m©ch)->
rg‘_lun
);

370 
	`h®_deviû_´İ”ty_£t_¡ršg
(
©­i_deviû
, "block.ä“bsd.©­i_ÿm_deviû", 
ÿm_devÇme
);

371 
	`h®_deviû_´İ”ty_£t_¡ršg
(
©­i_deviû
, "block.ä“bsd.ÿm_·th", 
scsi_·th
);

372 
	`g_ä“
(
ÿm_devÇme
);

373 
	`g_ä“
(
scsi_·th
);

378 
ty³
 = 
	`SID_TYPE
(&(*
m©ch
)->
šq_d©a
);

379 
scsi_deviû
 = 
	`hf_scsi_scsi_deviû_Ãw
(
·»Á
, *
m©ch
);

380 ià(
	`hf_deviû_´•robe_ªd_add
(
scsi_deviû
è&& (
ty³
 =ğ
T_DIRECT
 ||

381 
ty³
 =ğ
T_SEQUENTIAL
 ||y³ =ğ
T_RBC
 ||y³ =ğ
T_STORARRAY
 ||

382 
	`hf_scsi_is_cdrom
(
ty³
)))

384 
H®Deviû
 *
block_deviû
;

385 *
scsi_·th
;

387 
block_deviû
 = 
	`hf_scsi_block_deviû_Ãw
(
scsi_deviû
, *
m©ch
, *
devÇme
);

389 
scsi_·th
 = 
	`g_¡rdup_´štf
("%d,%d,%d", (*
m©ch
)->
·th_id
, (*m©ch)->
rg‘_id
, (*m©ch)->
rg‘_lun
);

390 
	`h®_deviû_´İ”ty_£t_¡ršg
(
block_deviû
, "block.ä“bsd.ÿm_·th", 
scsi_·th
);

391 
	`g_ä“
(
scsi_·th
);

393 ià(
	`hf_deviû_´•robe
(
block_deviû
))

400 ià(
©­i_deviû
)

401 
	`h®_deviû_´İ”ty_£t_boŞ
(
©­i_deviû
, "šfo.ignÜe", 
TRUE
);

403 
	`hf_ruÂ”_run_sync
(
block_deviû
, 0, "h®d-´obe-scsi", 
NULL
);

410 
	`hf_block_deviû_com¶‘e
(
block_deviû
, block_deviû, 
FALSE
);

412 
	`hf_deviû_add
(
block_deviû
);

413 
	`hf_¡Üage_deviû_´obe
(
block_deviû
, 
FALSE
);

419 
	`g_ä“
(*
m©ch
);

420 *
m©ch
 = 
NULL
;

422 
	`g_ä“
(*
devÇme
);

423 *
devÇme
 = 
NULL
;

424 
	}
}

428 
	$hf_scsi_´obe
 ()

430 
ccb
 ccb;

431 
deviû_m©ch_»suÉ
 *
³ndšg_deviû
 = 
NULL
;

432 *
³ndšg_devÇme
 = 
NULL
;

434 ià(
hf_scsi_fd
 < 0)

435 
’d
;

437 
	`mem£t
(&
ccb
, 0, (ccb));

439 
ccb
.
ccb_h
.
·th_id
 = 
CAM_XPT_PATH_ID
;

440 
ccb
.
ccb_h
.
rg‘_id
 = 
CAM_TARGET_WILDCARD
;

441 
ccb
.
ccb_h
.
rg‘_lun
 = 
CAM_LUN_WILDCARD
;

443 
ccb
.
ccb_h
.
func_code
 = 
XPT_DEV_MATCH
;

444 
ccb
.
cdm
.
m©ch_buf_Ën
 = (
dev_m©ch_»suÉ
è* 
N_RESULTS
;

445 
ccb
.
cdm
.
m©ches
 = 
	`g_Ãw
(
dev_m©ch_»suÉ
, 
N_RESULTS
);

446 
ccb
.
cdm
.
num_m©ches
 = 0;

447 
ccb
.
cdm
.
num_·‰”ns
 = 0;

448 
ccb
.
cdm
.
·‰”n_buf_Ën
 = 0;

452 
i
;

454 ià(
	`ioùl
(
hf_scsi_fd
, 
CAMIOCOMMAND
, &
ccb
) < 0)

456 
	`HAL_WARNING
(("uÇbËØg‘†i¡ oàSCSI deviûs: %s", 
	`g_¡»¼Ü
(
”ºo
)));

460 ià(
ccb
.
ccb_h
.
¡©us
 !ğ
CAM_REQ_CMP


461 || (
ccb
.
cdm
.
¡©us
 !ğ
CAM_DEV_MATCH_LAST


462 && 
ccb
.
cdm
.
¡©us
 !ğ
CAM_DEV_MATCH_MORE
))

464 
	`HAL_WARNING
(("gÙ CAMƒ¼Ü %#x, CDMƒ¼Ü %d", 
ccb
.
ccb_h
.
¡©us
, ccb.
cdm
.status));

468 
i
 = 0; i < (è
ccb
.
cdm
.
num_m©ches
; i++)

469 
ccb
.
cdm
.
m©ches
[
i
].
ty³
)

471 
DEV_MATCH_BUS
:

473 
bus_m©ch_»suÉ
 *
m©ch
;

474 
H®Deviû
 *
deviû
;

475 
H®Deviû
 *
·»Á
 = 
NULL
;

477 
m©ch
 = &
ccb
.
cdm
.
m©ches
[
i
].
»suÉ
.
bus_»suÉ
;

478 ià((è
m©ch
->
·th_id
 == -1)

481 
	`hf_scsi_hªdË_³ndšg_deviû
(&
³ndšg_deviû
, &
³ndšg_devÇme
);

483 
deviû
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_št
(
	`h®d_g‘_gdl
(), "scsi_ho¡.ho¡", 
m©ch
->
·th_id
);

484 ià(
deviû
)

487 ià(! 
	`¡rcmp
(
m©ch
->
dev_Çme
, "umass-sim"))

489 
·»Á
 = 
	`hf_devŒ“_fšd_äom_šfo
(
	`h®d_g‘_gdl
(), "umass", 
m©ch
->
un™_numb”
);

492 ià(
·»Á
)

494 
H®Deviû
 *
·»Á_if
;

496 
·»Á_if
 = 
	`hf_deviû_¡Üe_m©ch
(
	`h®d_g‘_gdl
(),

497 "šfo.·»Á", 
HAL_PROPERTY_TYPE_STRING
, 
	`h®_deviû_g‘_udi
(
·»Á
),

498 "usb.š‹rçû.şass", 
HAL_PROPERTY_TYPE_INT32
, 0x08,

499 
NULL
);

501 ià(
·»Á_if
)

502 
·»Á
 = 
·»Á_if
;

505 ià(! 
	`¡rcmp
(
m©ch
->
dev_Çme
, "ata"))

506 
·»Á
 = 
	`hf_devŒ“_fšd_äom_šfo
(
	`h®d_g‘_gdl
(), "©a", 
m©ch
->
un™_numb”
);

508 ià(! 
·»Á
 || ! 
	`h®_deviû_´İ”ty_g‘_boŞ
(parent, "info.ignore"))

510 
deviû
 = 
	`hf_scsi_bus_deviû_Ãw
(
·»Á
, 
m©ch
);

511 
	`hf_deviû_´•robe_ªd_add
(
deviû
);

516 
DEV_MATCH_DEVICE
:

518 
deviû_m©ch_»suÉ
 *
m©ch
;

519 
H®Deviû
 *
deviû
;

521 
m©ch
 = &
ccb
.
cdm
.
m©ches
[
i
].
»suÉ
.
deviû_»suÉ
;

522 ià((è
m©ch
->
·th_id
 == -1)

525 
	`hf_scsi_hªdË_³ndšg_deviû
(&
³ndšg_deviû
, &
³ndšg_devÇme
);

527 
deviû
 = 
	`hf_deviû_¡Üe_m©ch
(
	`h®d_g‘_gdl
(),

528 "scsi.bus", 
HAL_PROPERTY_TYPE_INT32
, 
m©ch
->
·th_id
,

529 "scsi.rg‘", 
HAL_PROPERTY_TYPE_INT32
, 
m©ch
->
rg‘_id
,

530 "scsi.lun", 
HAL_PROPERTY_TYPE_INT32
, 
m©ch
->
rg‘_lun
,

531 
NULL
);

533 ià(
deviû
)

536 
³ndšg_deviû
 = 
	`g_Ãw
(
deviû_m©ch_»suÉ
, 1);

537 *
³ndšg_deviû
 = *
m©ch
;

541 
DEV_MATCH_PERIPH
:

543 
³rh_m©ch_»suÉ
 *
m©ch
;

545 ià(! 
³ndšg_deviû
)

548 ià(
³ndšg_devÇme
)

551 
m©ch
 = &
ccb
.
cdm
.
m©ches
[
i
].
»suÉ
.
³rh_»suÉ
;

552 ià((è
m©ch
->
·th_id
 =ğ-1 || ! 
	`¡rcmp
(m©ch->
³rh_Çme
, "pass"))

555 
³ndšg_devÇme
 = 
	`g_¡rdup_´štf
("%s%i", 
m©ch
->
³rh_Çme
, m©ch->
un™_numb”
);

560 
ccb
.
ccb_h
.
¡©us
 =ğ
CAM_REQ_CMP
 && ccb.
cdm
.¡©u =ğ
CAM_DEV_MATCH_MORE
);

562 
	`hf_scsi_hªdË_³ndšg_deviû
(&
³ndšg_deviû
, &
³ndšg_devÇme
);

564 
	`g_ä“
(
ccb
.
cdm
.
m©ches
);

566 
’d
:

572 
	`hf_©a_add_³ndšg_deviûs
();

573 
	}
}

575 
HFHªdËr
 
	ghf_scsi_hªdËr
 = {

576 .
´iveged_š™
 = 
hf_scsi_´iveged_š™
,

577 .
	g´obe
 = 
hf_scsi_´obe


	@hald/freebsd/hf-scsi.h

24 #iâdeà
_HF_SCSI_H


25 
	#_HF_SCSI_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"hf-os¥ec.h
"

33 
HFHªdËr
 
hf_scsi_hªdËr
;

	@hald/freebsd/hf-serial.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~"hf-£rŸl.h
"

29 
	~"hf-ut.h
"

31 
H®Deviû
 *

32 
	$hf_£rŸl_deviû_Ãw
 (
H®Deviû
 *
·»Á
)

34 
H®Deviû
 *
deviû
;

35 cÚ¡ *
´oduù
;

36 
un™
;

38 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
·»Á
), 
NULL
);

40 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

42 
´oduù
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
·»Á
, "info.product");

43 ià(
´oduù
)

44 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.´oduù", 
´oduù
);

46 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "serial");

47 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "serial");

49 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "£rŸl.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
(
·»Á
));

52 
un™
 = 
	`h®_deviû_´İ”ty_g‘_št
(
·»Á
, "freebsd.unit");

53 ià(
un™
 < 10)

54 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "£rŸl.deviû", "/dev/‰yd%i", 
un™
);

55 ià(
un™
 < 32)

56 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "£rŸl.deviû", "/dev/‰yd%c", 
un™
 - 10 + 'a');

58 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "£rŸl.deviû", 
NULL
);

60 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "£rŸl.pÜt", 
un™
);

61 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "serial.type", "platform");

64 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_£rŸl_%s_%i", 
	`h®_deviû_g‘_udi
(
·»Á
), "¶©fÜm", 
un™
);

66  
deviû
;

67 
	}
}

70 
	$hf_£rŸl_´obe
 ()

72 
GSLi¡
 *
sio_deviûs
;

73 
GSLi¡
 *
l
;

75 
sio_deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(), "freebsd.driver", "sio");

76 
	`HF_LIST_FOREACH
(
l
, 
sio_deviûs
)

78 
H®Deviû
 *
·»Á
 = 
l
->
d©a
;

80 ià(! 
	`h®_deviû_¡Üe_m©ch_key_v®ue_št
(
	`h®d_g‘_gdl
(), "£rŸl.pÜt", 
	`h®_deviû_´İ”ty_g‘_št
(
·»Á
, "freebsd.unit"))

81 && ! 
	`h®_deviû_´İ”ty_g‘_boŞ
(
·»Á
, "info.ignore"))

83 
H®Deviû
 *
deviû
;

85 
deviû
 = 
	`hf_£rŸl_deviû_Ãw
(
l
->
d©a
);

86 
	`hf_deviû_´•robe_ªd_add
(
deviû
);

89 
	`g_¦i¡_ä“
(
sio_deviûs
);

90 
	}
}

92 
HFHªdËr
 
	ghf_£rŸl_hªdËr
 = {

93 .
´obe
 = 
hf_£rŸl_´obe


	@hald/freebsd/hf-serial.h

24 #iâdeà
_HF_SERIAL_H


25 
	#_HF_SERIAL_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"hf-os¥ec.h
"

33 
HFHªdËr
 
hf_£rŸl_hªdËr
;

	@hald/freebsd/hf-sound.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

30 
	~"../logg”.h
"

31 
	~"../ut.h
"

33 
	~"hf-sound.h
"

34 
	~"hf-devŒ“.h
"

35 
	~"hf-ut.h
"

37 
	#HF_SNDSTAT_DEV
 "/dev/¢d¡©"

	)

39 
GHashTabË
 *
	gdrv_hash
 = 
NULL
;

41 cÚ¡ 
	soss_sound_deviû
 {

42 *
	mty³
;

43 *
	mdriv”
;

44 } 
	goss_sound_deviûs
[] = {

52 
H®Deviû
 *

53 
	$hf_sound_oss_deviû_Ãw
 (
H®Deviû
 *
·»Á
,

54 cÚ¡ *
ty³
,

55 cÚ¡ *
driv”
)

57 
H®Deviû
 *
deviû
;

58 *
´oduù
, *
ÿrd_id
, *
devÇme
, *
dev_node
;

59 cÚ¡ *
µroduù
;

60 
un™
;

62 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
·»Á
), 
NULL
);

64 
un™
 = 
	`h®_deviû_´İ”ty_g‘_št
(
·»Á
, "freebsd.unit");

65 
dev_node
 = 
	`g_¡rdup_´štf
("/dev/%s%i", 
driv”
, 
un™
);

67 ià(! 
	`g_fe_‹¡
(
dev_node
, 
G_FILE_TEST_EXISTS
))

69 
	`g_ä“
(
dev_node
);

70  
NULL
;

73 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

75 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "oss.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
(
·»Á
));

77 
µroduù
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
·»Á
, "info.product");

79 
´oduù
 = 
	`g_¡rdup_´štf
("% (%s)", (
µroduù
 !ğ
NULL
) ?…product : "Sound Card",

80 
ty³
);

81 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.´oduù", 
´oduù
);

82 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "oss.deviû_id", 
´oduù
);

83 
	`g_ä“
(
´oduù
);

85 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "oss");

86 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "oss");

88 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "oss.ty³", 
ty³
);

90 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "oss.ÿrd", 
un™
);

91 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "oss.deviû", 
un™
);

93 
devÇme
 = 
	`hf_devŒ“_deviû_g‘_Çme
(
·»Á
);

94 ià(
devÇme
)

96 
ÿrd_id
 = 
	`g_hash_bË_lookup
(
drv_hash
, (
gcÚ¡poš‹r
)
devÇme
);

97 ià(
ÿrd_id
)

98 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "oss.ÿrd_id", 
ÿrd_id
);

100 
	`h®_deviû_cİy_´İ”ty
(
deviû
, "oss.card_id", device, "oss.device_id");

103 
	`h®_deviû_cİy_´İ”ty
(
deviû
, "oss.card_id", device, "oss.device_id");

104 
	`g_ä“
(
devÇme
);

106 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "oss.deviû_fe", 
dev_node
);

107 
	`g_ä“
(
dev_node
);

109 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_oss_%s_%i", 
	`h®_deviû_g‘_udi
(
·»Á
), 
ty³
, 
un™
);

111  
deviû
;

112 
	}
}

115 
	$hf_sound_´obe
 ()

117 
GIOChªÃl
 *
chªÃl
;

118 
GE¼Ü
 *
”r
 = 
NULL
;

119 
GSLi¡
 *
pcm_deviûs
, *
l
;

120 *
buf
;

121 **
toks
;

122 
gsize
 
Ën
;

123 
i
;

125 
drv_hash
 = 
	`g_hash_bË_Ãw_fuÎ
(
g_¡r_hash
, 
g_¡r_equ®
, 
g_ä“
, g_free);

127 
chªÃl
 = 
	`g_io_chªÃl_Ãw_fe
(
HF_SNDSTAT_DEV
, "r", &
”r
);

128 ià(
chªÃl
 =ğ
NULL
)

130 
	`HAL_WARNING
(("uÇbËØİ’ %s: %s", 
HF_SNDSTAT_DEV
, 
”r
->
mes§ge
));

131 
no¢d¡©
;

134 ià(
	`g_io_chªÃl_»ad_to_’d
(
chªÃl
, &
buf
, &
Ën
, &
”r
) !=

135 
G_IO_STATUS_NORMAL
)

137 
	`HAL_WARNING
(("çedØ»ad %s: %s", 
HF_SNDSTAT_DEV
, 
”r
->
mes§ge
));

138 
	`g_io_chªÃl_uÄef
(
chªÃl
);

139 
no¢d¡©
;

141 
	`g_io_chªÃl_uÄef
(
chªÃl
);

143 
toks
 = 
	`g_¡r¥l™
(
buf
, "\n", 0);

144 
	`g_ä“
(
buf
);

146 ià(
	`g_¡rv_Ëngth
(
toks
) < 3)

148 
	`HAL_INFO
(("no soundcards found"));

149 
	`g_¡rä“v
(
toks
);

150 
no¢d¡©
;

153 
i
 = 2; 
toks
[i] !ğ
NULL
; i++)

155 *
drv
, *
desü
, *
±r
;

162 ià(
	`g_ascii_is¥aû
(
toks
[
i
][0]))

164 ià(
	`¡rcmp
(
toks
[
i
], "File Versions:") == 0)

167 
±r
 = 
	`¡rchr
(
toks
[
i
], ':');

168 ià(
±r
 =ğ
NULL
)

171 
drv
 = 
	`g_¡ºdup
(
toks
[
i
], 
	`¡¾’
Ñoks[i]è- sŒËn(
±r
));

173 
±r
 = 
	`¡r¡r
(
toks
[
i
], "snd_");

174 ià(
±r
 =ğ
NULL
)

176 
	`g_ä“
(
drv
);

180 
desü
 = 
	`g_¡rdup
(
±r
);

182 
	`g_hash_bË_š£¹
(
drv_hash
, (
gpoš‹r
)
drv
, (gpoš‹r)
desü
);

184 
	`g_¡rä“v
(
toks
);

186 
no¢d¡©
:

188 
pcm_deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(),

190 
	`HF_LIST_FOREACH
(
l
, 
pcm_deviûs
)

192 
H®Deviû
 *
·»Á
 = 
	`HAL_DEVICE
(
l
->
d©a
);

194 ià(! 
	`h®_deviû_´İ”ty_g‘_boŞ
(
·»Á
, "info.ignore"))

196 
un™
;

197 
j
;

199 
un™
 = 
	`h®_deviû_´İ”ty_g‘_št
(
·»Á
, "freebsd.unit");

201 
j
 = 0; j < (è
	`G_N_ELEMENTS
(
oss_sound_deviûs
); j++)

202 ià(! 
	`hf_deviû_¡Üe_m©ch
(
	`h®d_g‘_gdl
(),

203 "oss.ÿrd", 
HAL_PROPERTY_TYPE_INT32
, 
un™
,

204 "oss.ty³", 
HAL_PROPERTY_TYPE_STRING
, 
oss_sound_deviûs
[
j
].
ty³
,

205 
NULL
))

207 
H®Deviû
 *
deviû
;

209 
deviû
 = 
	`hf_sound_oss_deviû_Ãw
(
·»Á
,

210 
oss_sound_deviûs
[
j
].
ty³
,

211 
oss_sound_deviûs
[
j
].
driv”
);

212 ià(
deviû
)

213 
	`hf_deviû_´•robe_ªd_add
(
deviû
);

217 
	`g_¦i¡_ä“
(
pcm_deviûs
);

219 
	`g_hash_bË_de¡roy
(
drv_hash
);

220 
	}
}

222 
HFHªdËr
 
	ghf_sound_hªdËr
 = {

223 .
´obe
 = 
hf_sound_´obe


	@hald/freebsd/hf-sound.h

24 #iâdeà
_HF_SOUND_H


25 
	#_HF_SOUND_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"hf-os¥ec.h
"

33 
HFHªdËr
 
hf_sound_hªdËr
;

	@hald/freebsd/hf-storage.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<¡dlib.h
>

30 
	~<lim™s.h
>

31 
	~<š‰y³s.h
>

32 
	~<¡ršg.h
>

33 
	~<sys/ty³s.h
>

34 
	~<sys/diskÏb–.h
>

36 
	~"../logg”.h
"

37 
	~"../os¥ec.h
"

39 
	~"hf-¡Üage.h
"

40 
	~"hf-block.h
"

41 
	~"hf-devŒ“.h
"

42 
	~"hf-vŞume.h
"

43 
	~"hf-ut.h
"

47 *
	mÇme
;

48 *
	mcÚf
;

49 } 
	tDisk
;

53 *
	mşass
;

54 *
	mdev
;

55 *
	m¡r_ty³
;

56 
gušt
 
	mhash
;

57 
gušt64
 
	mmedŸsize
;

58 
gušt64
 
	moff£t
;

59 
gušt
 
	m£ùÜsize
;

60 
gšt
 
	mty³
;

61 
gšt
 
	mšdex
;

62 } 
	tGeom_Objeù
;

64 
GNode
 *
	ghf_¡Üage_geom_Œ“
 = 
NULL
;

65 
GHashTabË
 *
	ghf_¡Üage_geom_hash
 = 
NULL
;

67 
hf_¡Üage_š™_geom
 ();

68 
gboŞ—n
 
hf_¡Üage_deviû_has_addÚ
 (
H®Deviû
 *
deviû
);

71 
	$hf_¡Üage_geom_ä“
 (
gpoš‹r
 
d©a
)

73 
Geom_Objeù
 *
geom_obj
;

75 
	`g_»tuº_if_ç
(
d©a
 !ğ
NULL
);

77 
geom_obj
 = (
Geom_Objeù
 *è
d©a
;

78 
	`g_ä“
(
geom_obj
->
şass
);

79 
	`g_ä“
(
geom_obj
->
dev
);

80 
	`g_ä“
(
geom_obj
->
¡r_ty³
);

82 
	`g_ä“
(
geom_obj
);

83 
	}
}

87 
	$hf_¡Üage_g‘_disk_Çmes
 (
GE¼Ü
 **
”r
)

89 *
li¡
;

90 **
Çmes
;

92 
li¡
 = 
	`hf_g‘_¡ršg_sysùl
(
”r
, "kern.disks");

93 ià(! 
li¡
)

94  
NULL
;

96 
Çmes
 = 
	`g_¡r¥l™
(
li¡
, " ", 0);

97 
	`g_ä“
(
li¡
);

99  
Çmes
;

100 
	}
}

102 
gboŞ—n


103 
	$hf_¡Üage_şass_is_·¹™iÚabË
 (cÚ¡ *
geom_şass
)

105  (! 
	`¡rcmp
(
geom_şass
, "MBR") ||

106 ! 
	`¡rcmp
(
geom_şass
, "MBREXT") ||

107 ! 
	`¡rcmp
(
geom_şass
, "GPT") ||

108 ! 
	`¡rcmp
(
geom_şass
, "APPLE") || ! strcmp(geom_class, "SUN"));

109 
	}
}

111 
gboŞ—n


112 
	$hf_¡Üage_geom_has_·¹™iÚs
 (cÚ¡ 
Geom_Objeù
 *
geom_obj
, 
GNode
 *
node
)

114 ià(! 
node
 || ! 
geom_obj
)

115  
FALSE
;

117 ià(
	`g_node_n_chd»n
(
node
) > 0)

118  
TRUE
;

120 ià(
	`hf_¡Üage_şass_is_·¹™iÚabË
(
geom_obj
->
şass
) &&

121 
	`g_node_Ãxt_siblšg
(
node
è!ğ
NULL
)

123 
GNode
 *
siblšg
;

125 
siblšg
 = 
	`g_node_Ãxt_siblšg
(
node
); sibling;

126 
siblšg
 = 
	`g_node_Ãxt_siblšg
(sibling))

128 
Geom_Objeù
 *
siblšg_geom
;

130 
siblšg_geom
 = 
	`g_hash_bË_lookup
(
hf_¡Üage_geom_hash
,

131 
siblšg
->
d©a
);

133 ià(
siblšg_geom
 &&

134 
	`hf_¡Üage_şass_is_·¹™iÚabË
(
siblšg_geom
->
şass
))

135  
TRUE
;

139  
FALSE
;

140 
	}
}

142 
gboŞ—n


143 
	$hf_¡Üage_geom_is_sw­
 (cÚ¡ 
Geom_Objeù
 *
geom_obj
)

145 
	`g_»tuº_v®_if_ç
(
geom_obj
 !ğ
NULL
, 
FALSE
);

147  (! 
	`¡rcmp
(
geom_obj
->
şass
, "BSD"è&& geom_obj->
ty³
 =ğ
FS_SWAP
)

148 || ((! 
	`¡rcmp
(
geom_obj
->
şass
, "MBR") ||

149 ! 
	`¡rcmp
(
geom_obj
->
şass
, "MBREXT"))

150 && (
geom_obj
->
ty³
 == 0x18

151 || 
geom_obj
->
ty³
 == 0x42

152 || 
geom_obj
->
ty³
 == 0x82

153 || 
geom_obj
->
ty³
 == 0xB8));

154 
	}
}

157 
	$hf_¡Üage_deviû_´obe_geom
 (
H®Deviû
 *
·»Á
,

158 
H®Deviû
 *
¡Üage_deviû
,

159 cÚ¡ 
Geom_Objeù
 *
geom_obj
)

161 
H®Deviû
 *
deviû
 = 
NULL
;

162 
GNode
 *
node
;

163 
Geom_Objeù
 *
Ãxt
;

165 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
·»Á
));

166 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
¡Üage_deviû
));

168 ià(! 
geom_obj
)

171 
node
 = 
	`g_node_fšd
(
hf_¡Üage_geom_Œ“
, 
G_PRE_ORDER
, 
G_TRAVERSE_ALL
,

172 
	`GUINT_TO_POINTER
(
geom_obj
->
hash
));

174 ià(! 
node
)

177 ià(
geom_obj
->
ty³
 !ğ
FS_UNUSED
)

179 *
¥ecŸl
;

181 
¥ecŸl
 = 
	`g_¡rdup_´štf
("/dev/%s", 
geom_obj
->
dev
);

182 
deviû
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
(), "block.deviû", 
¥ecŸl
);

183 
	`g_ä“
(
¥ecŸl
);

185 ià(! 
deviû
)

186 
deviû
 = 
	`hf_vŞume_deviû_add
(
·»Á
,

187 
¡Üage_deviû
,

188 
	`hf_¡Üage_geom_has_·¹™iÚs
(
geom_obj
, 
node
),

189 
	`hf_¡Üage_geom_is_sw­
(
geom_obj
),

190 
geom_obj
->
dev
,

191 
geom_obj
->
şass
,

192 
geom_obj
->
¡r_ty³
,

193 
geom_obj
->
ty³
,

194 
geom_obj
->
šdex
,

195 
geom_obj
->
off£t
,

196 
geom_obj
->
medŸsize
);

199 ià(! 
deviû
 || ! 
	`h®_deviû_´İ”ty_g‘_boŞ
(device, "info.ignore"))

201 
Ãxt
 = (
	`g_node_fœ¡_chd
(
node
)) ?

202 
	`g_hash_bË_lookup
(
hf_¡Üage_geom_hash
,

203 (
	`g_node_fœ¡_chd
(
node
))->
d©a
è: 
NULL
;

204 
	`hf_¡Üage_deviû_´obe_geom
(
deviû
 ? deviû : 
·»Á
, 
¡Üage_deviû
,

205 
Ãxt
);

207 
Ãxt
 = (
	`g_node_Ãxt_siblšg
(
node
)è? 
	`g_hash_bË_lookup
(
hf_¡Üage_geom_hash
,

208 (
	`g_node_Ãxt_siblšg
(
node
))->
d©a
è: 
NULL
;

209 
	`hf_¡Üage_deviû_´obe_geom
(
·»Á
, 
¡Üage_deviû
, 
Ãxt
);

210 
	}
}

213 
	$hf_¡Üage_deviû_´obe_·¹™iÚs
 (
H®Deviû
 *
deviû
)

215 *
diskÇme
;

216 
gušt
 
hash
;

217 
Geom_Objeù
 *
geom_obj
;

218 
GNode
 *
node
;

220 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

222 
diskÇme
 = 
	`hf_devŒ“_deviû_g‘_Çme
(
deviû
);

223 ià(! 
diskÇme
)

226 
hash
 = 
	`g_¡r_hash
(
diskÇme
);

228 
node
 = 
	`g_node_fšd
(
hf_¡Üage_geom_Œ“
, 
G_PRE_ORDER
, 
G_TRAVERSE_ALL
,

229 
	`GUINT_TO_POINTER
(
hash
));

230 ià(! 
node
 || ! 
	`g_node_fœ¡_chd
(node))

233 
geom_obj
 = 
	`g_hash_bË_lookup
(
hf_¡Üage_geom_hash
,

234 (
	`g_node_fœ¡_chd
(
node
))->
d©a
);

235 ià(! 
geom_obj
)

238 
	`hf_¡Üage_deviû_´obe_geom
(
deviû
, deviû, 
geom_obj
);

240 
	`g_ä“
(
diskÇme
);

241 
	}
}

243 
gboŞ—n


244 
	$hf_¡Üage_deviû_has_·¹™iÚs
 (
H®Deviû
 *
deviû
)

246 
gboŞ—n
 
has
 = 
FALSE
;

247 *
diskÇme
;

248 
Geom_Objeù
 *
geom_obj
;

249 
gušt
 
hash
;

251 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
deviû
), 
FALSE
);

253 
diskÇme
 = 
	`hf_devŒ“_deviû_g‘_Çme
(
deviû
);

254 ià(! 
diskÇme
)

255  
FALSE
;

257 
hash
 = 
	`g_¡r_hash
(
diskÇme
);

258 
geom_obj
 = 
	`g_hash_bË_lookup
(
hf_¡Üage_geom_hash
,

259 
	`GUINT_TO_POINTER
(
hash
));

260 ià(
geom_obj
)

262 
GNode
 *
node
;

264 
node
 = 
	`g_node_fšd
(
hf_¡Üage_geom_Œ“
, 
G_PRE_ORDER
,

265 
G_TRAVERSE_ALL
, 
	`GUINT_TO_POINTER
(
hash
));

266 ià(
	`hf_¡Üage_geom_has_·¹™iÚs
(
geom_obj
, 
node
))

267 
has
 = 
TRUE
;

269 
	`g_ä“
(
diskÇme
);

271  
has
;

272 
	}
}

274 
H®Deviû
 *

275 
	$hf_¡Üage_deviû_Ãw
 (
H®Deviû
 *
·»Á
, cÚ¡ *
diskÇme
)

277 
H®Deviû
 *
deviû
;

279 
	`g_»tuº_v®_if_ç
(
diskÇme
 !ğ
NULL
, NULL);

281 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

283 
	`hf_devŒ“_deviû_£t_Çme
(
deviû
, 
diskÇme
);

285 
	`hf_block_deviû_’abË
(
deviû
, 
diskÇme
);

286 
	`hf_¡Üage_deviû_’abË
(
deviû
);

287 
	`hf_block_deviû_com¶‘e
(
deviû
, deviû, 
FALSE
);

289  
deviû
;

290 
	}
}

293 
	$hf_¡Üage_deviû_´obe
 (
H®Deviû
 *
deviû
, 
gboŞ—n
 
Úly_medŸ
)

295 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

297 
	`hf_¡Üage_š™_geom
();

299 ià(
	`hf_ruÂ”_run_sync
(
deviû
, 0, "hald-probe-storage",

300 "HF_HAS_CHILDREN", 
	`HF_BOOL_TO_STRING
(
	`hf_¡Üage_deviû_has_·¹™iÚs
(
deviû
)),

301 "HF_ONLY_CHECK_FOR_MEDIA", 
	`HF_BOOL_TO_STRING
(
Úly_medŸ
),

302 
NULL
) == 2)

304 *
devÇme
;

306 
devÇme
 = 
	`hf_devŒ“_deviû_g‘_Çme
(
deviû
);

307 
	`g_as£¹
(
devÇme
 !ğ
NULL
);

317 
	`hf_vŞume_deviû_add
(
deviû
, deviû, 
FALSE
, FALSE, 
devÇme
, 
NULL
, NULL, -1, 0, 0, 0);

318 
	`g_ä“
(
devÇme
);

321 
	`hf_¡Üage_deviû_´obe_·¹™iÚs
(
deviû
);

322 
	}
}

325 
	$hf_¡Üage_´obe
 ()

327 
GE¼Ü
 *
”r
 = 
NULL
;

328 **
disks
;

332 
disks
 = 
	`hf_¡Üage_g‘_disk_Çmes
(&
”r
);

333 ià(
disks
)

335 
i
;

337 
i
 = 0; 
disks
[i]; i++)

339 
H®Deviû
 *
deviû
;

341 
deviû
 = 
	`hf_devŒ“_fšd_äom_Çme
(
	`h®d_g‘_gdl
(), 
disks
[
i
]);

342 ià(! 
deviû
)

344 
H®Deviû
 *
·»Á
;

348 
·»Á
 = 
	`hf_devŒ“_fšd_·»Á_äom_Çme
(
	`h®d_g‘_gdl
(), 
disks
[
i
]);

349 ià(! 
·»Á
 || ! 
	`h®_deviû_´İ”ty_g‘_boŞ
(parent, "info.ignore"))

351 
deviû
 = 
	`hf_¡Üage_deviû_Ãw
(
·»Á
, 
disks
[
i
]);

352 
	`hf_¡Üage_deviû_add
(
deviû
);

357 
	`g_¡rä“v
(
disks
);

361 
	`HAL_WARNING
(("uÇbËØg‘ disk†i¡: %s", 
”r
->
mes§ge
));

362 
	`g_”rÜ_ä“
(
”r
);

364 
	}
}

366 
GSLi¡
 *

367 
	$hf_¡Üage_·r£_cÚáxt
 (cÚ¡ *
cÚáxt
)

369 
GSLi¡
 *
disks
 = 
NULL
;

370 **
lšes
;

371 
Disk
 *
disk
 = 
NULL
;

372 
GSŒšg
 *
disk_cÚf
 = 
NULL
;

373 
GNode
 *
roÙ
, *
·»Á
;

374 
GNode
 *
chd
 = 
NULL
;

375 
GHashTabË
 *
bË
;

376 
cu¼_d•th
 = 0;

377 
i
;

379 ià(! 
cÚáxt
)

380  
NULL
;

382 
roÙ
 = 
	`g_node_Ãw
 (
NULL
);

383 
·»Á
 = 
roÙ
;

385 
bË
 = 
	`g_hash_bË_Ãw_fuÎ
(
g_dœeù_hash
, 
g_dœeù_equ®
, 
NULL
,

386 (
GDe¡royNÙify
è
hf_¡Üage_geom_ä“
);

388 
lšes
 = 
	`g_¡r¥l™
(
cÚáxt
, "\n", 0);

389 
i
 = 0; 
lšes
[i]; i++)

391 
Geom_Objeù
 *
geom_obj
;

392 **
f›lds
;

393 
d•th
;

394 
gušt
 
hash
;

396 ià(! *
lšes
[
i
])

399 
f›lds
 = 
	`g_¡r¥l™
(
lšes
[
i
], " ", 0);

400 ià(
	`g_¡rv_Ëngth
(
f›lds
) < 3)

402 
	`g_¡rä“v
(
f›lds
);

406 
geom_obj
 = 
	`g_Ãw0
(
Geom_Objeù
, 1);

408 
d•th
 = 
	`©oi
(
f›lds
[0]);

409 
geom_obj
->
şass
 = 
	`g_¡rdup
(
f›lds
[1]);

410 
geom_obj
->
dev
 = 
	`g_¡rdup
(
f›lds
[2]);

411 
geom_obj
->
ty³
 = -1;

412 
hash
 = 
	`g_¡r_hash
(
geom_obj
->
dev
);

413 
geom_obj
->
hash
 = hash;

415 ià(
	`g_¡rv_Ëngth
(
f›lds
) >= 5)

417 
geom_obj
->
medŸsize
 = 
	`¡¹oumax
(
f›lds
[3], 
NULL
, 10);

418 
geom_obj
->
£ùÜsize
 = (
gušt
è
	`¡¹oul
(
f›lds
[4], 
NULL
, 10);

421 ià(
	`g_¡rv_Ëngth
(
f›lds
) >= 7)

422 ià(! 
	`¡rcmp
(
f›lds
[5], "i"))

423 
geom_obj
->
šdex
 = 
	`©oi
(
f›lds
[6]) + 1;

425 ià(
	`g_¡rv_Ëngth
(
f›lds
) >= 9)

426 ià(! 
	`¡rcmp
(
f›lds
[7], "o"))

427 
geom_obj
->
off£t
 = 
	`¡¹oumax
(
f›lds
[8], 
NULL
, 10);

429 ià(
	`g_¡rv_Ëngth
(
f›lds
) >= 11)

431 ià(! 
	`¡rcmp
 (
f›lds
[9], "ty"))

433 ià(! 
	`¡rcmp
 (
geom_obj
->
şass
, "GPT") ||

434 ! 
	`¡rcmp
 (
geom_obj
->
şass
, "APPLE"))

435 
geom_obj
->
¡r_ty³
 = 
	`g_¡rdup
(
f›lds
[10]);

437 
geom_obj
->
ty³
 = 
	`©oi
(
f›lds
[10]);

441 
	`g_hash_bË_š£¹
 (
bË
, 
	`GUINT_TO_POINTER
(
hash
), 
geom_obj
);

443 ià(
d•th
 > 
cu¼_d•th
)

445 
	`g_as£¹
(
chd
 !ğ
NULL
);

446 
·»Á
 = 
chd
;

448 ià(
d•th
 < 
cu¼_d•th
)

450 
GNode
 *
cur
;

451 
Ëv–s
;

453 
Ëv–s
 = 
cu¼_d•th
 - 
d•th
;

454 
cur
 = 
chd
; cu¸&& 
Ëv–s
 > 0; cu¸ğcur->
·»Á
,†evels--)

457 ià(
cur
 =ğ
NULL
)

458 
·»Á
 = 
roÙ
;

460 
·»Á
 = 
cur
->parent;

463 
chd
 = 
	`g_node_­³nd_d©a
(
·»Á
, 
	`GUINT_TO_POINTER
(
hash
));

464 
cu¼_d•th
 = 
d•th
;

466 ià(! 
	`¡rcmp
(
geom_obj
->
şass
, "DISK"))

468 ià(
disk
)

469 
disk
->
cÚf
 = 
	`g_¡ršg_ä“
(
disk_cÚf
, 
FALSE
);

471 
disk
 = 
	`g_Ãw
(
Disk
, 1);

472 
disk
->
Çme
 = 
	`g_¡rdup
(
geom_obj
->
dev
);

473 
disk_cÚf
 = 
	`g_¡ršg_Ãw
(
NULL
);

474 
disks
 = 
	`g_¦i¡_´•’d
(disks, 
disk
);

476 
	`g_¡rä“v
(
f›lds
);

478 ià(
disk
)

480 ià(*
disk_cÚf
->
¡r
)

481 
	`g_¡ršg_­³nd_c
(
disk_cÚf
, '\n');

482 
	`g_¡ršg_­³nd
(
disk_cÚf
, 
lšes
[
i
]);

485 
	`g_¡rä“v
(
lšes
);

487 ià(
disk
)

488 
disk
->
cÚf
 = 
	`g_¡ršg_ä“
(
disk_cÚf
, 
FALSE
);

490 ià(
hf_¡Üage_geom_hash
)

491 
	`g_hash_bË_de¡roy
(
hf_¡Üage_geom_hash
);

493 
hf_¡Üage_geom_hash
 = 
bË
;

495 ià(
hf_¡Üage_geom_Œ“
)

496 
	`g_node_de¡roy
(
hf_¡Üage_geom_Œ“
);

498 
hf_¡Üage_geom_Œ“
 = 
roÙ
;

500  
disks
;

501 
	}
}

503 
Disk
 *

504 
	$hf_¡Üage_fšd_disk
 (cÚ¡ 
GSLi¡
 *
disks
, cÚ¡ *
Çme
)

506 cÚ¡ 
GSLi¡
 *
l
;

508 
	`HF_LIST_FOREACH
(
l
, 
disks
)

510 
Disk
 *
disk
 = 
l
->
d©a
;

512 ià(! 
	`¡rcmp
(
disk
->
Çme
,‚ame))

513  
disk
;

516  
NULL
;

517 
	}
}

520 
	$hf_¡Üage_disk_ä“
 (
Disk
 *
disk
)

522 
	`g_»tuº_if_ç
(
disk
 !ğ
NULL
);

524 
	`g_ä“
(
disk
->
Çme
);

525 
	`g_ä“
(
disk
->
cÚf
);

526 
	`g_ä“
(
disk
);

527 
	}
}

530 
	$hf_¡Üage_deviû_»sÿn_»®
 (
H®Deviû
 *
deviû
)

532 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

536 
	`hf_deviû_»move_chd»n
(
deviû
);

540 
	`hf_¡Üage_deviû_´obe
(
deviû
, 
TRUE
);

541 
	}
}

543 
gboŞ—n


544 
	$hf_¡Üage_cÚáxt_timeout_cb
 (
gpoš‹r
 
d©a
)

546 
GSLi¡
 *
disks
 = 
NULL
;

547 
gboŞ—n
 
fœ¡
 = 
TRUE
;

548 *
cÚáxt
;

549 
GSLi¡
 *
Ãw_disks
;

551 ià(
hf_is_wa™šg
)

552  
TRUE
;

554 
cÚáxt
 = 
	`hf_g‘_¡ršg_sysùl
(
NULL
, "kern.geom.conftxt");

555 
Ãw_disks
 = 
	`hf_¡Üage_·r£_cÚáxt
(
cÚáxt
);

556 
	`g_ä“
(
cÚáxt
);

560 ià(
fœ¡
)

561 
fœ¡
 = 
FALSE
;

564 
GSLi¡
 *
l
;

568 
	`HF_LIST_FOREACH
(
l
, 
Ãw_disks
)

570 
Disk
 *
disk
 = 
l
->
d©a
;

572 ià(! 
	`hf_¡Üage_fšd_disk
(
disks
, 
disk
->
Çme
))

574 
	`os¥ec_´obe
();

581 
	`HF_LIST_FOREACH
(
l
, 
disks
)

583 
Disk
 *
disk
 = 
l
->
d©a
;

584 
Disk
 *
Ãw_disk
;

585 
H®Deviû
 *
deviû
;

587 
Ãw_disk
 = 
	`hf_¡Üage_fšd_disk
(
Ãw_disks
, 
disk
->
Çme
);

588 ià(
Ãw_disk
)

590 ià(
	`¡rcmp
(
disk
->
cÚf
, 
Ãw_disk
->conf))

593 
deviû
 = 
	`hf_devŒ“_fšd_äom_Çme
(
	`h®d_g‘_gdl
(), 
disk
->
Çme
);

594 ià(
deviû
 && 
	`h®_deviû_has_ÿ·b™y
(device, "storage") &&

595 ! 
	`hf_¡Üage_deviû_has_addÚ
(
deviû
))

596 
	`hf_¡Üage_deviû_»sÿn_»®
(
deviû
);

602 
deviû
 = 
	`hf_devŒ“_fšd_äom_Çme
(
	`h®d_g‘_gdl
(), 
disk
->
Çme
);

603 ià(
deviû
 && 
	`h®_deviû_has_ÿ·b™y
(device, "storage"))

604 
	`hf_deviû_»move_Œ“
(
deviû
);

609 
	`g_¦i¡_fÜ—ch
(
disks
, (
GFunc
è
hf_¡Üage_disk_ä“
, 
NULL
);

610 
	`g_¦i¡_ä“
(
disks
);

611 
disks
 = 
Ãw_disks
;

613  
TRUE
;

614 
	}
}

617 
	$hf_¡Üage_š™_geom
 ()

619 *
cÚáxt
;

620 
gboŞ—n
 
š™ed
 = 
FALSE
;

621 
GSLi¡
 *
disks
;

623 ià(
š™ed
)

626 
cÚáxt
 = 
	`hf_g‘_¡ršg_sysùl
(
NULL
, "kern.geom.conftxt");

627 
disks
 = 
	`hf_¡Üage_·r£_cÚáxt
(
cÚáxt
);

628 
	`g_ä“
(
cÚáxt
);

630 
	`g_¦i¡_fÜ—ch
(
disks
, (
GFunc
è
hf_¡Üage_disk_ä“
, 
NULL
);

631 
	`g_¦i¡_ä“
(
disks
);

633 
š™ed
 = 
TRUE
;

634 
	}
}

637 
	$hf_¡Üage_š™
 ()

639 
	`hf_¡Üage_š™_geom
();

640 
	`g_timeout_add
(3000, 
hf_¡Üage_cÚáxt_timeout_cb
, 
NULL
);

641 
	}
}

644 
	$hf_¡Üage_deviû_’abË
 (
H®Deviû
 *
deviû
)

646 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

647 
	`g_»tuº_if_ç
(
devÇme
 !ğ
NULL
);

649 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "storage.bus", "platform");

650 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "storage.drive_type", "disk");

652 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.»movabË", 
FALSE
);

653 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.»quœes_ejeù", 
FALSE
);

654 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.hÙ¶uggabË", 
FALSE
);

655 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.medŸ_check_’abËd", 
FALSE
);

656 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.automouÁ_’abËd_hšt", 
TRUE
);

657 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.no_·¹™iÚs_hšt", 
FALSE
);

658 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.»movabË.suµÜt_async_nÙifiÿtiÚ", 
FALSE
);

660 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "¡Üage.Üigš©šg_deviû", 
NULL
);

661 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "¡Üage.mod–", 
NULL
);

662 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "¡Üage.v’dÜ", 
NULL
);

664 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "storage");

665 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "storage");

666 
	}
}

669 
	$hf_¡Üage_deviû_’abË_³
 (
H®Deviû
 *
deviû
)

671 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

673 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "storage.drive_type", "tape");

674 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.»movabË", 
TRUE
);

675 
	}
}

678 
	$hf_¡Üage_deviû_’abË_cdrom
 (
H®Deviû
 *
deviû
)

680 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

682 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "storage.cdrom");

683 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "storage.cdrom");

684 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "storage.drive_type", "cdrom");

685 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.»movabË", 
TRUE
);

687 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.medŸ_check_’abËd", 
TRUE
);

689 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.no_·¹™iÚs_hšt", 
TRUE
);

691 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.»quœes_ejeù", 
TRUE
);

693 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.»movabË.suµÜt_async_nÙifiÿtiÚ", 
FALSE
);

696 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.cdr", 
FALSE
);

697 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.cdrw", 
FALSE
);

698 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.dvd", 
FALSE
);

699 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.dvdr", 
FALSE
);

700 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.dvdrw", 
FALSE
);

701 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.dvd¿m", 
FALSE
);

702 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.dvd¶u¤", 
FALSE
);

703 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.dvd¶u¤w", 
FALSE
);

704 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.dvd¶u¤dl", 
FALSE
);

705 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.dvd¶u¤wdl", 
FALSE
);

706 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.bd", 
FALSE
);

707 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.bdr", 
FALSE
);

708 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.bd»", 
FALSE
);

709 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.hddvd", 
FALSE
);

710 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.hddvdr", 
FALSE
);

711 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.hddvdrw", 
FALSE
);

712 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "¡Üage.cdrom.suµÜt_medŸ_chªged", 
FALSE
);

713 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "storage.cdrom.read_speed", 0);

714 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "storage.cdrom.write_speed", 0);

715 
	}
}

719 
	$hf_¡Üage_deviû_add
 (
H®Deviû
 *
deviû
)

721 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

723 
	`hf_¡Üage_š™_geom
();

725 ià(
	`hf_deviû_´•robe
(
deviû
))

727 
	`hf_¡Üage_deviû_´obe
(
deviû
, 
FALSE
);

728 
	`hf_deviû_add
(
deviû
);

730 
	}
}

732 
GSLi¡
 *

733 
	$hf_¡Üage_g‘_geoms
 (cÚ¡ *
devÇme
)

735 
GNode
 *
node
;

736 
GSLi¡
 *
geom_li¡
 = 
NULL
;

737 
n_chd»n
, 
i
;

738 
gušt
 
hash
;

740 
	`g_»tuº_v®_if_ç
(
devÇme
 !ğ
NULL
, NULL);

742 
	`hf_¡Üage_š™_geom
();

744 
hash
 = 
	`g_¡r_hash
(
devÇme
);

745 
node
 = 
	`g_node_fšd
(
hf_¡Üage_geom_Œ“
, 
G_PRE_ORDER
, 
G_TRAVERSE_ALL
,

746 
	`GUINT_TO_POINTER
(
hash
));

747 ià(! 
node
)

748  
NULL
;

750 
n_chd»n
 = 
	`g_node_n_chd»n
(
node
);

751 
i
 = 0; i < 
n_chd»n
; i++)

753 
GNode
 *
chd
;

754 
Geom_Objeù
 *
geom_obj
;

756 
chd
 = 
	`g_node_Áh_chd
(
node
, 
i
);

757 
geom_obj
 = (
Geom_Objeù
 *è
	`g_hash_bË_lookup
(
hf_¡Üage_geom_hash
,

758 
chd
->
d©a
);

759 ià(
geom_obj
)

760 
geom_li¡
 = 
	`g_¦i¡_´•’d
(geom_li¡, 
	`g_¡rdup
(
geom_obj
->
dev
));

763  
geom_li¡
;

764 
	}
}

766 
gboŞ—n


767 
	$hf_¡Üage_deviû_»sÿn
 (
H®Deviû
 *
deviû
)

769 ià(
	`h®_deviû_has_ÿ·b™y
(
deviû
, "storage"))

771 
	`hf_¡Üage_deviû_»sÿn_»®
(
deviû
);

772  
TRUE
;

775  
FALSE
;

776 
	}
}

778 
gboŞ—n


779 
	$hf_¡Üage_deviû_has_addÚ
 (
H®Deviû
 *
deviû
)

781 
H®DeviûSŒLi¡I‹r
 
™”
;

783 
	`g_»tuº_v®_if_ç
(
deviû
 !ğ
NULL
, 
FALSE
);

785 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
(
deviû
, "šfo.addÚs", &
™”
);

786 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
(&
™”
);

787 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
(&
™”
))

789 cÚ¡ *
addÚ
;

791 
addÚ
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
(&
™”
);

793 ià(! 
	`¡rcmp
(
addÚ
, "hald-addon-storage"))

794  
TRUE
;

797  
FALSE
;

798 
	}
}

800 
HFHªdËr
 
	ghf_¡Üage_hªdËr
 = {

801 .
š™
 = 
hf_¡Üage_š™
,

802 .
	g´obe
 = 
hf_¡Üage_´obe
,

803 .
	gdeviû_»sÿn
 = 
hf_¡Üage_deviû_»sÿn


	@hald/freebsd/hf-storage.h

24 #iâdeà
_HF_STORAGE_H


25 
	#_HF_STORAGE_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"hf-os¥ec.h
"

33 
HFHªdËr
 
hf_¡Üage_hªdËr
;

35 
hf_¡Üage_deviû_’abË
 (
H®Deviû
 *
deviû
);

36 
hf_¡Üage_deviû_’abË_³
 (
H®Deviû
 *
deviû
);

37 
hf_¡Üage_deviû_’abË_cdrom
 (
H®Deviû
 *
deviû
);

38 
hf_¡Üage_deviû_´obe
 (
H®Deviû
 *
deviû
, 
gboŞ—n
 
Úly_medŸ
);

39 
hf_¡Üage_deviû_add
 (
H®Deviû
 *
deviû
);

40 
GSLi¡
 *
hf_¡Üage_g‘_geoms
 (cÚ¡ *
devÇme
);

	@hald/freebsd/hf-usb.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

29 
	~<”ºo.h
>

30 
	~<¡dlib.h
>

31 
	~<fú.h
>

32 
	~<sys/ioùl.h
>

33 
	~<uni¡d.h
>

34 
	~<dev/usb/usb.h
>

36 
	~"../logg”.h
"

37 
	~"../os¥ec.h
"

39 
	~"hf-usb.h
"

40 
	~"hf-devŒ“.h
"

41 
	~"hf-ut.h
"

43 
	#HF_USB_DEVICE
 "/dev/usb"

	)

47 
	mfd
;

48 
	mšdex
;

49 } 
	tCÚŒŞËr
;

51 
GSLi¡
 *
	gcÚŒŞËrs
 = 
NULL
;

53 
	ghf_usb_fd
;

55 
gboŞ—n
 
hf_usb_´obe_deviû
 (
H®Deviû
 *
·»Á
,

56 
CÚŒŞËr
 *
cÚŒŞËr
,

57 cÚ¡ 
usb_deviû_šfo
 *
deviû_šfo
);

59 
CÚŒŞËr
 *

60 
	$hf_usb_fšd_cÚŒŞËr
 (
šdex
)

62 
GSLi¡
 *
l
;

64 
	`HF_LIST_FOREACH
(
l
, 
cÚŒŞËrs
)

66 
CÚŒŞËr
 *
cÚŒŞËr
 = 
l
->
d©a
;

68 ià(
cÚŒŞËr
->
šdex
 == index)

69  
cÚŒŞËr
;

72  
NULL
;

73 
	}
}

75 
H®Deviû
 *

76 
	$hf_usb_fšd_hub
 (cÚ¡ 
usb_deviû_šfo
 *
deviû_šfo
)

78 
GSLi¡
 *
a
;

80 
	`g_»tuº_v®_if_ç
(
deviû_šfo
 !ğ
NULL
, 
FALSE
);

82 
	`HF_LIST_FOREACH
(
a
, 
	`h®d_g‘_gdl
()->
deviûs
)

84 
H®Deviû
 *
deviû
 = 
a
->
d©a
;

86 ià(
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "usb_deviû.bus_numb”"è=ğ
deviû_šfo
->
udi_bus
)

88 
H®DeviûSŒLi¡I‹r
 
™”
;

90 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
(
deviû
, "usb_deviû.ä“bsd.pÜts", &
™”
);

91 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
(&
™”
);

92 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
(&
™”
))

94 cÚ¡ *
pÜt
;

96 
pÜt
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
(&
™”
);

98 ià(
	`©oi
(
pÜt
è=ğ
deviû_šfo
->
udi_addr
)

99  
deviû
;

104  
NULL
;

105 
	}
}

107 
gboŞ—n


108 
	$hf_usb_g‘_desütÜ
 (
fd
,

109 
addr
,

110 
ty³
,

111 
šdex
,

112 
gpoš‹r
 
desc
,

113 
Ën
,

114 
GE¼Ü
 **
”r
)

116 
usb_ùl_»que¡
 
»q
;

117 
buf
[
Ën
];

119 
	`g_»tuº_v®_if_ç
(
desc
 !ğ
NULL
, 
FALSE
);

121 
	`mem£t
(&
»q
, 0, (req));

123 
»q
.
uü_addr
 = 
addr
;

124 
»q
.
uü_»que¡
.
bmReque¡Ty³
 = 
UT_READ_DEVICE
;

125 
»q
.
uü_»que¡
.
bReque¡
 = 
UR_GET_DESCRIPTOR
;

126 
	`USETW2
(
»q
.
uü_»que¡
.
wV®ue
, 
ty³
, 
šdex
);

127 
	`USETW
(
»q
.
uü_»que¡
.
wIndex
, 0);

128 
	`USETW
(
»q
.
uü_»que¡
.
wL’gth
, 
Ën
);

129 
»q
.
uü_d©a
 = 
buf
;

131 ià(
	`ioùl
(
fd
, 
USB_REQUEST
, &
»q
) < 0)

133 
	`g_£t_”rÜ
(
”r
, 0, 0, "%s", 
	`g_¡»¼Ü
(
”ºo
));

134  
FALSE
;

136 ià(
»q
.
uü_aùËn
 !ğ
Ën
)

138 
	`g_£t_”rÜ
(
”r
, 0, 0, "bad†ength");

139  
FALSE
;

142 
	`memıy
(
desc
, 
buf
, 
Ën
);

143  
TRUE
;

144 
	}
}

147 
	$hf_usb_g‘_¡ršg_desütÜ
 (
fd
,

148 
addr
,

149 
šdex
,

150 
GE¼Ü
 **
”r
)

152 
usb_¡ršg_desütÜ_t
 
¡ršg_desc
;

153 
gunich¬2
 
unicode_¡r
[
	`G_N_ELEMENTS
(
¡ršg_desc
.
bSŒšg
)];

154 
Ën
;

155 
i
;

156 *
¡r
;

157 
GE¼Ü
 *
tmp_”r
 = 
NULL
;

161 ià(! 
	`hf_usb_g‘_desütÜ
(
fd
, 
addr
, 
UDESC_STRING
, 
šdex
, &
¡ršg_desc
, 2, 
”r
))

162  
NULL
;

164 ià(
¡ršg_desc
.
bL’gth
 < 2)

166 
	`g_£t_”rÜ
(
”r
, 0, 0, "bad†ength");

167  
NULL
;

172 ià(! 
	`hf_usb_g‘_desütÜ
(
fd
, 
addr
, 
UDESC_STRING
, 
šdex
, &
¡ršg_desc
, sŒšg_desc.
bL’gth
, 
”r
))

173  
NULL
;

175 
Ën
 = (
¡ršg_desc
.
bL’gth
 - 2è/ (
uWÜd
);

176 
i
 = 0; i < 
Ën
; i++)

177 
unicode_¡r
[
i
] = 
	`UGETW
(
¡ršg_desc
.
bSŒšg
[i]);

179 
¡r
 = 
	`g_utf16_to_utf8
(
unicode_¡r
, 
Ën
, 
NULL
, NULL, &
tmp_”r
);

180 ià(! 
¡r
)

182 
	`g_£t_”rÜ
(
”r
, 0, 0, "uÇbËØcÚv”ˆ¡ršgØUTF-8: %s", 
tmp_”r
->
mes§ge
);

183 
	`g_”rÜ_ä“
(
tmp_”r
);

186  
¡r
;

187 
	}
}

189 
gpoš‹r


190 
	$hf_usb_g‘_fuÎ_cÚfig_desütÜ
 (
fd
,

191 
addr
,

192 
šdex
,

193 *
Ën
,

194 
GE¼Ü
 **
”r
)

196 
usb_cÚfig_desütÜ_t
 
cÚfig_desc
;

197 
_Ën
;

198 *
buf
;

208 ià(! 
	`hf_usb_g‘_desütÜ
(
fd
, 
addr
, 
UDESC_CONFIG
, 
šdex
, &
cÚfig_desc
, 
USB_CONFIG_DESCRIPTOR_SIZE
, 
”r
))

209  
NULL
;

213 
_Ën
 = 
	`UGETW
(
cÚfig_desc
.
wTÙ®L’gth
);

214 
buf
 = 
	`g_Ãw
(, 
_Ën
);

216 ià(
	`hf_usb_g‘_desütÜ
(
fd
, 
addr
, 
UDESC_CONFIG
, 
šdex
, 
buf
, 
_Ën
, 
”r
))

218 ià(
Ën
)

219 *
Ën
 = 
_Ën
;

221  
buf
;

226 
	`g_ä“
(
buf
);

227  
NULL
;

228 
	}
}

235 
	$hf_usb_deviû_compu‹_udi
 (
H®Deviû
 *
deviû
)

237 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

239 ià(
	`h®_deviû_has_ÿ·b™y
(
deviû
, "hiddev"))

240 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_hiddev",

241 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "info.parent"));

242 ià(
	`h®_deviû_has_ÿ·b™y
(
deviû
, "video4linux"))

243 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_video4linux",

244 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "info.parent"));

245 ià(
	`h®_deviû_has_´İ”ty
(
deviû
, "usb.interface.number"))

246 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "%s_if%i",

247 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "info.parent"),

248 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "usb.interface.number"));

250 
	`hf_deviû_£t_udi
(
deviû
, "usb_device_%x_%x_%s",

251 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "usb_device.vendor_id"),

252 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "usb_device.product_id"),

253 
	`h®_deviû_has_´İ”ty
(
deviû
, "usb_device.serial")

254 ? 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "usb_device.serial")

256 
	}
}

259 
	$hf_usb_add_webÿm_´İ”t›s
 (
H®Deviû
 *
deviû
)

261 
un™
;

263 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

265 
un™
 = 
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, "freebsd.unit");

266 ià(
un™
 < 0)

267 
un™
 = 0;

269 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "video4linux");

270 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "video4linux");

271 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "video4lšux.deviû", "/dev/video%i", 
un™
);

272 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "Video Device");

273 
	}
}

277 
	$hf_usb_g‘_š‹rçû_Çme
 (cÚ¡ 
usb_š‹rçû_desütÜ_t
 *
desc
)

279 
desc
->
bIÁ”çûCÏss
)

300 
	}
}

303 
	$hf_usb_g‘_devÇme
 (cÚ¡ 
usb_deviû_šfo
 *
di
, cÚ¡ *
driv”
)

305 
i
;

307 
	`g_»tuº_v®_if_ç
(
di
 !ğ
NULL
, NULL);

308 
	`g_»tuº_v®_if_ç
(
driv”
 !ğ
NULL
, NULL);

310 
i
 = 0; i < 
USB_MAX_DEVNAMES
; i++)

311 ià(
	`hf_devŒ“_is_driv”
(
di
->
udi_devÇmes
[
i
], 
driv”
))

312  
di
->
udi_devÇmes
[
i
];

314  
NULL
;

315 
	}
}

317 
H®Deviû
 *

318 
	$hf_usb_deviû_Ãw
 (
H®Deviû
 *
·»Á
,

319 
CÚŒŞËr
 *
cÚŒŞËr
,

320 cÚ¡ 
usb_deviû_šfo
 *
di
,

321 cÚ¡ 
usb_deviû_desütÜ_t
 *
deviû_desc
)

323 
H®Deviû
 *
deviû
;

324 
¥“d
;

325 
usb_cÚfig_desütÜ_t
 
cÚfig_desc
;

326 
gboŞ—n
 
ÿn_wake_up
 = 
FALSE
;

327 
num_š‹rçûs
 = 0;

328 
i
;

329 cÚ¡ *
devÇme
;

331 
	`g_»tuº_v®_if_ç
(
cÚŒŞËr
 !ğ
NULL
, NULL);

332 
	`g_»tuº_v®_if_ç
(
di
 !ğ
NULL
, NULL);

333 
	`g_»tuº_v®_if_ç
(
deviû_desc
 !ğ
NULL
, NULL);

335 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

337 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.subsystem", "usb_device");

338 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.´oduù", 
di
->
udi_´oduù
);

339 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.v’dÜ", 
di
->
udi_v’dÜ
);

341 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.bus_numb”", 
di
->
udi_bus
);

342 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.cÚfigu¿tiÚ_v®ue", 
di
->
udi_cÚfig
);

343 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.num_cÚfigu¿tiÚs", 
deviû_desc
->
bNumCÚfigu¿tiÚs
);

344 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.deviû_şass", 
di
->
udi_şass
);

345 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.deviû_subşass", 
di
->
udi_subşass
);

346 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.deviû_´ÙocŞ", 
di
->
udi_´ÙocŞ
);

347 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "usb_deviû.is_£lf_pow”ed", 
di
->
udi_pow”
 == 0);

348 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.max_pow”", 
di
->
udi_pow”
);

349 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.num_pÜts", 
di
->
udi_ÅÜts
);

350 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.pÜt_numb”", 
di
->
udi_addr
);

352 
di
->
udi_¥“d
)

354 
USB_SPEED_LOW
: 
¥“d
 = 0x00150; ;

355 
USB_SPEED_FULL
: 
¥“d
 = 0x01200; ;

356 
USB_SPEED_HIGH
: 
¥“d
 = 0x48000; ;

357 : 
¥“d
 = 0; ;

359 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.¥“d_bcd", 
¥“d
);

361 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.v”siÚ_bcd", 
	`UGETW
(
deviû_desc
->
bcdUSB
));

363 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.´oduù_id", 
di
->
udi_´oduùNo
);

364 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.v’dÜ_id", 
di
->
udi_v’dÜNo
);

365 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.deviû_»visiÚ_bcd", 
	`UGETW
(
deviû_desc
->
bcdDeviû
));

367 ià(
deviû_desc
->
iS”ŸlNumb”
 != 0)

369 *
£rŸl
;

371 
£rŸl
 = 
	`hf_usb_g‘_¡ršg_desütÜ
(
cÚŒŞËr
->
fd
, 
di
->
udi_addr
, 
deviû_desc
->
iS”ŸlNumb”
, 
NULL
);

372 ià(
£rŸl
)

374 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "usb_deviû.£rŸl", 
£rŸl
);

375 
	`g_ä“
(
£rŸl
);

379 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "usb_deviû.´oduù", 
di
->
udi_´oduù
);

380 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "usb_deviû.v’dÜ", 
di
->
udi_v’dÜ
);

382 ià(
di
->
udi_cÚfig
 !ğ0 && 
	`hf_usb_g‘_desütÜ
(
cÚŒŞËr
->
fd
,

383 
di
->
udi_addr
,

384 
UDESC_CONFIG
,

385 
di
->
udi_cÚfig
 - 1,

386 &
cÚfig_desc
,

387 
USB_CONFIG_DESCRIPTOR_SIZE
,

388 
NULL
))

390 
ÿn_wake_up
 = (
cÚfig_desc
.
bmA‰ribu‹s
 & 
UC_REMOTE_WAKEUP
) != 0;

391 
num_š‹rçûs
 = 
cÚfig_desc
.
bNumIÁ”çû
;

393 ià(
cÚfig_desc
.
iCÚfigu¿tiÚ
 != 0)

395 *
cÚfigu¿tiÚ
;

397 
cÚfigu¿tiÚ
 = 
	`hf_usb_g‘_¡ršg_desütÜ
(
cÚŒŞËr
->
fd
, 
di
->
udi_addr
, 
cÚfig_desc
.
iCÚfigu¿tiÚ
, 
NULL
);

398 ià(
cÚfigu¿tiÚ
)

400 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "usb_deviû.cÚfigu¿tiÚ", 
cÚfigu¿tiÚ
);

401 
	`g_ä“
(
cÚfigu¿tiÚ
);

406 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "usb_deviû.ÿn_wake_up", 
ÿn_wake_up
);

407 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb_deviû.num_š‹rçûs", 
num_š‹rçûs
);

409 
i
 = 0; i < 
di
->
udi_ÅÜts
; i++)

410 ià(
di
->
udi_pÜts
[
i
] > 0 && di->udi_pÜts[i] < 
USB_MAX_DEVICES
)

412 *
pÜt
;

414 
pÜt
 = 
	`g_¡rdup_´štf
("%i", 
di
->
udi_pÜts
[
i
]);

415 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
(
deviû
, "usb_deviû.ä“bsd.pÜts", 
pÜt
, 
FALSE
);

416 
	`g_ä“
(
pÜt
);

423 ià(*
di
->
udi_devÇmes
[0])

424 
	`hf_devŒ“_deviû_£t_Çme
(
deviû
, 
di
->
udi_devÇmes
[0]);

426 ià((
devÇme
 = 
	`hf_usb_g‘_devÇme
(
di
, "ukbd")))

427 
	`hf_deviû_£t_šput
(
deviû
, "keybßrd", 
devÇme
);

428 ià((
devÇme
 = 
	`hf_usb_g‘_devÇme
(
di
, "ums")))

429 
	`hf_deviû_£t_šput
(
deviû
, "mou£", 
devÇme
);

430 ià((
devÇme
 = 
	`hf_usb_g‘_devÇme
(
di
, "uhid")))

432 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "hiddev");

433 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "hiddev");

434 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "hiddev.deviû", "/dev/%s", 
devÇme
);

435 
	`h®_deviû_cİy_´İ”ty
(
deviû
, "info.product", device, "hiddev.product");

437 ià((
devÇme
 = 
	`hf_usb_g‘_devÇme
(
di
, "ldev")))

445 
	`hf_usb_add_webÿm_´İ”t›s
(
deviû
);

447 ià((
devÇme
 = 
	`hf_usb_g‘_devÇme
(
di
, "pwc")))

449 
	`hf_usb_add_webÿm_´İ”t›s
(
deviû
);

452 
	`hf_usb_deviû_compu‹_udi
(
deviû
);

454  
deviû
;

455 
	}
}

457 
H®Deviû
 *

458 
	$hf_usb_š‹rçû_deviû_Ãw
 (
H®Deviû
 *
·»Á
,

459 
CÚŒŞËr
 *
cÚŒŞËr
,

460 cÚ¡ 
usb_deviû_šfo
 *
di
,

461 cÚ¡ 
usb_š‹rçû_desütÜ_t
 *
desc
)

463 
H®Deviû
 *
deviû
;

464 cÚ¡ *
Çme
;

466 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
·»Á
), 
NULL
);

467 
	`g_»tuº_v®_if_ç
(
desc
 !ğ
NULL
, NULL);

469 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

471 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.subsystem", "usb");

473 
	`h®_deviû_m”ge_w™h_»wr™e
(
deviû
, 
·»Á
, "usb.", "usb_device.");

475 
Çme
 = 
	`hf_usb_g‘_š‹rçû_Çme
(
desc
);

476 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.´oduù", 
Çme
);

477 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "usb.´oduù", 
Çme
);

479 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb.š‹rçû.şass", 
desc
->
bIÁ”çûCÏss
);

480 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb.š‹rçû.subşass", 
desc
->
bIÁ”çûSubCÏss
);

481 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb.š‹rçû.´ÙocŞ", 
desc
->
bIÁ”çûPrÙocŞ
);

482 
	`h®_deviû_´İ”ty_£t_št
(
deviû
, "usb.š‹rçû.numb”", 
desc
->
bIÁ”çûNumb”
);

484 ià(
desc
->
iIÁ”çû
 != 0)

486 *
š‹rçû
;

488 
š‹rçû
 = 
	`hf_usb_g‘_¡ršg_desütÜ
(
cÚŒŞËr
->
fd
, 
di
->
udi_addr
, 
desc
->
iIÁ”çû
, 
NULL
);

489 ià(
š‹rçû
)

491 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "usb.š‹rçû.desütiÚ", 
š‹rçû
);

492 
	`g_ä“
(
š‹rçû
);

497 
	`hf_usb_deviû_compu‹_udi
(
deviû
);

499  
deviû
;

500 
	}
}

503 
	$hf_usb_´obe_add»ss
 (
H®Deviû
 *
·»Á
,

504 
CÚŒŞËr
 *
cÚŒŞËr
,

505 
addr
)

507 
usb_deviû_šfo
 
deviû_šfo
;

509 
	`g_»tuº_if_ç
(
cÚŒŞËr
 !ğ
NULL
);

511 
	`mem£t
(&
deviû_šfo
, 0, (device_info));

512 
deviû_šfo
.
udi_addr
 = 
addr
;

514 ià(
	`ioùl
(
cÚŒŞËr
->
fd
, 
USB_DEVICEINFO
, &
deviû_šfo
) != -1)

516 
H®Deviû
 *
»®_·»Á
;

525 
»®_·»Á
 = 
	`hf_usb_fšd_hub
(&
deviû_šfo
);

526 ià(
»®_·»Á
)

528 
·»Á
 = 
»®_·»Á
;

529 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
(
·»Á
, "info.ignore"))

533 
	`hf_usb_´obe_deviû
(
·»Á
, 
cÚŒŞËr
, &
deviû_šfo
);

535 
	}
}

537 
gboŞ—n


538 
	$hf_usb_´obe_deviû
 (
H®Deviû
 *
·»Á
,

539 
CÚŒŞËr
 *
cÚŒŞËr
,

540 cÚ¡ 
usb_deviû_šfo
 *
deviû_šfo
)

542 
usb_deviû_desütÜ_t
 
deviû_desc
;

543 
GE¼Ü
 *
”r
 = 
NULL
;

544 
H®Deviû
 *
deviû
;

545 
i
;

547 
	`g_»tuº_v®_if_ç
(
cÚŒŞËr
 !ğ
NULL
, 
FALSE
);

548 
	`g_»tuº_v®_if_ç
(
deviû_šfo
 !ğ
NULL
, 
FALSE
);

550 
deviû
 = 
	`hf_deviû_¡Üe_m©ch
(
	`h®d_g‘_gdl
(),

551 "usb_deviû.bus_numb”", 
HAL_PROPERTY_TYPE_INT32
, 
deviû_šfo
->
udi_bus
,

552 "usb_deviû.pÜt_numb”", 
HAL_PROPERTY_TYPE_INT32
, 
deviû_šfo
->
udi_addr
,

553 
NULL
);

555 ià(
deviû
)

556  
FALSE
;

558 ià(! 
	`hf_usb_g‘_desütÜ
(
cÚŒŞËr
->
fd
,

559 
deviû_šfo
->
udi_addr
,

560 
UDESC_DEVICE
,

562 &
deviû_desc
,

563 
USB_DEVICE_DESCRIPTOR_SIZE
,

564 &
”r
))

566 
	`HAL_WARNING
(("uÇbËØg‘ deviû desütÜ oàUSB deviû %i.%i: %s", 
cÚŒŞËr
->
šdex
, 
deviû_šfo
->
udi_addr
, 
”r
->
mes§ge
));

567 
	`g_”rÜ_ä“
(
”r
);

568  
FALSE
;

573 
deviû
 = 
	`hf_usb_deviû_Ãw
(
·»Á
, 
cÚŒŞËr
, 
deviû_šfo
, &
deviû_desc
);

574 ià(
	`hf_deviû_´•robe
(
deviû
))

576 ià(
	`h®_deviû_has_ÿ·b™y
(
deviû
, "hiddev"))

577 
	`hf_ruÂ”_run_sync
(
deviû
, 0, "h®d-´obe-hiddev", 
NULL
);

579 
	`hf_deviû_add
(
deviû
);

582  
FALSE
;

586 
i
 = 0; i < 
deviû_desc
.
bNumCÚfigu¿tiÚs
; i++)

588 
usb_cÚfig_desütÜ_t
 *
cÚfig_desc
;

589 
Ën
;

590 *
p
;

591 
j
;

593 
cÚfig_desc
 = 
	`hf_usb_g‘_fuÎ_cÚfig_desütÜ
(
cÚŒŞËr
->
fd
, 
deviû_šfo
->
udi_addr
, 
i
, &
Ën
, &
”r
);

594 ià(! 
cÚfig_desc
)

596 
	`HAL_WARNING
(("uÇbËØg‘ cÚfigu¿tiÚ desütÜ %˜oàUSB deviû %i.%i: %s", 
i
, 
cÚŒŞËr
->
šdex
, 
deviû_šfo
->
udi_addr
, 
”r
->
mes§ge
));

597 
	`g_ş—r_”rÜ
(&
”r
);

601 
p
 = (*è
cÚfig_desc
 + 
USB_CONFIG_DESCRIPTOR_SIZE
;

602 
j
 = 0; j < 
cÚfig_desc
->
bNumIÁ”çû
; j++)

604 
usb_š‹rçû_desütÜ_t
 *
if_desc
 = (usb_š‹rçû_desütÜ_ˆ*è
p
;

605 
H®Deviû
 *
if_deviû
;

607 ià(
p
 + 
USB_INTERFACE_DESCRIPTOR_SIZE
 > (*è
cÚfig_desc
 + 
Ën
)

609 
	`HAL_WARNING
(("USB deviû %i.%i: shÜˆcÚfigu¿tiÚ desütÜ %i", 
cÚŒŞËr
->
šdex
, 
deviû_šfo
->
udi_addr
, 
i
));

613 
if_deviû
 = 
	`hf_usb_š‹rçû_deviû_Ãw
(
deviû
, 
cÚŒŞËr
, 
deviû_šfo
, 
if_desc
);

614 
	`hf_deviû_´•robe_ªd_add
(
if_deviû
);

616 
p
 +ğ
USB_INTERFACE_DESCRIPTOR_SIZE
 + 
if_desc
->
bNumEndpošts
 * 
USB_ENDPOINT_DESCRIPTOR_SIZE
;

619 
	`g_ä“
(
cÚfig_desc
);

624 
i
 = 0; i < 
deviû_šfo
->
udi_ÅÜts
; i++)

625 ià(
deviû_šfo
->
udi_pÜts
[
i
] > 0 && deviû_šfo->udi_pÜts[i] < 
USB_MAX_DEVICES
)

626 
	`hf_usb_´obe_add»ss
(
deviû
, 
cÚŒŞËr
, 
deviû_šfo
->
udi_pÜts
[
i
]);

628  
TRUE
;

629 
	}
}

632 
	$hf_usb_´iveged_š™
 ()

634 
i
;

636 
hf_usb_fd
 = 
	`İ’
(
HF_USB_DEVICE
, 
O_RDONLY
);

637 ià(
hf_usb_fd
 < 0)

638 
	`HAL_INFO
(("uÇbËØİ’ %s: %s", 
HF_USB_DEVICE
, 
	`g_¡»¼Ü
(
”ºo
)));

640 
i
 = 0; i < 16; i++)

642 *
f’ame
;

643 
fd
;

645 
f’ame
 = 
	`g_¡rdup_´štf
("/dev/usb%i", 
i
);

646 
fd
 = 
	`İ’
(
f’ame
, 
O_RDONLY
);

647 
	`g_ä“
(
f’ame
);

649 ià(
fd
 >= 0)

651 
CÚŒŞËr
 *
cÚŒŞËr
;

653 
cÚŒŞËr
 = 
	`g_Ãw0
(
CÚŒŞËr
, 1);

654 
cÚŒŞËr
->
fd
 = fd;

655 
cÚŒŞËr
->
šdex
 = 
i
;

657 
cÚŒŞËrs
 = 
	`g_¦i¡_­³nd
(cÚŒŞËrs, 
cÚŒŞËr
);

660 
	}
}

663 
	$hf_usb_´oûss_ev’t
 (cÚ¡ 
usb_ev’t
 *
ev’t
)

665 
	`g_»tuº_if_ç
(
ev’t
 !ğ
NULL
);

667 
ev’t
->
ue_ty³
)

669 
USB_EVENT_CTRLR_ATTACH
:

670 
	`HAL_INFO
(("received USB_EVENT_CTRLR_ATTACHƒvent, bus %i",

671 
ev’t
->
u
.
ue_ù¾r
.
ue_bus
));

675 
USB_EVENT_CTRLR_DETACH
:

676 
	`HAL_INFO
(("received USB_EVENT_CTRLR_DETACHƒvent, bus %i",

677 
ev’t
->
u
.
ue_ù¾r
.
ue_bus
));

681 
USB_EVENT_DEVICE_ATTACH
:

683 
CÚŒŞËr
 *
cÚŒŞËr
;

685 
	`HAL_INFO
(("received USB_EVENT_DEVICE_ATTACHƒvent, device %i.%i",

686 
ev’t
->
u
.
ue_deviû
.
udi_bus
,ƒv’t->u.ue_deviû.
udi_addr
));

688 
cÚŒŞËr
 = 
	`hf_usb_fšd_cÚŒŞËr
(
ev’t
->
u
.
ue_deviû
.
udi_bus
);

689 ià(
cÚŒŞËr
)

691 
H®Deviû
 *
·»Á
;

693 
·»Á
 = 
	`hf_usb_fšd_hub
(&
ev’t
->
u
.
ue_deviû
);

694 ià(! 
·»Á
 || ! 
	`h®_deviû_´İ”ty_g‘_boŞ
(parent, "info.ignore"))

695 
	`hf_usb_´obe_deviû
(
·»Á
, 
cÚŒŞËr
, &
ev’t
->
u
.
ue_deviû
);

700 
USB_EVENT_DEVICE_DETACH
:

702 
H®Deviû
 *
deviû
;

704 
	`HAL_INFO
(("received USB_EVENT_DEVICE_DETACHƒvent, device %i.%i",

705 
ev’t
->
u
.
ue_deviû
.
udi_bus
,ƒv’t->u.ue_deviû.
udi_addr
));

707 
deviû
 = 
	`hf_deviû_¡Üe_m©ch
(
	`h®d_g‘_gdl
(),

708 "usb_deviû.bus_numb”", 
HAL_PROPERTY_TYPE_INT32
, 
ev’t
->
u
.
ue_deviû
.
udi_bus
,

709 "usb_deviû.pÜt_numb”", 
HAL_PROPERTY_TYPE_INT32
, 
ev’t
->
u
.
ue_deviû
.
udi_addr
,

710 
NULL
);

712 ià(
deviû
)

713 
	`hf_deviû_»move_Œ“
(
deviû
);

724 
USB_EVENT_DRIVER_ATTACH
:

725 
	`HAL_INFO
(("received USB_EVENT_DRIVER_ATTACHƒvent"));

728 
USB_EVENT_DRIVER_DETACH
:

729 
	`HAL_INFO
(("received USB_EVENT_DRIVER_DETACHƒvent"));

733 
	`HAL_WARNING
(("»ûived unknowÀUSBƒv’ˆ%i", 
ev’t
->
ue_ty³
));

736 
	}
}

738 
gboŞ—n


739 
	$hf_usb_ev’t_cb
 (
GIOChªÃl
 *
sourû
, 
GIOCÚd™iÚ
 
cÚd™iÚ
, 
gpoš‹r
 
u£r_d©a
)

741 
usb_ev’t
 
ev’t
;

743 ià(
hf_is_wa™šg
)

744  
TRUE
;

746 ià(
	`»ad
(
hf_usb_fd
, &
ev’t
, (event)) == (event))

747 
	`hf_usb_´oûss_ev’t
(&
ev’t
);

749  
TRUE
;

750 
	}
}

753 
	$hf_usb_š™
 ()

755 
GIOChªÃl
 *
chªÃl
;

757 ià(
hf_usb_fd
 < 0)

760 
chªÃl
 = 
	`g_io_chªÃl_unix_Ãw
(
hf_usb_fd
);

761 
	`g_io_add_w©ch
(
chªÃl
, 
G_IO_IN
, 
hf_usb_ev’t_cb
, 
NULL
);

762 
	}
}

765 
	$hf_usb_´obe
 ()

767 
GSLi¡
 *
l
;

771 
	`HF_LIST_FOREACH
(
l
, 
cÚŒŞËrs
)

773 
CÚŒŞËr
 *
cÚŒŞËr
 = 
l
->
d©a
;

774 
H®Deviû
 *
·»Á
;

776 
·»Á
 = 
	`hf_devŒ“_fšd_·»Á_äom_šfo
(
	`h®d_g‘_gdl
(), "usb", 
cÚŒŞËr
->
šdex
);

777 ià(! 
·»Á
 || ! 
	`h®_deviû_´İ”ty_g‘_boŞ
(parent, "info.ignore"))

779 
i
;

781 
i
 = 1; i < 
USB_MAX_DEVICES
; i++)

782 
	`hf_usb_´obe_add»ss
(
·»Á
, 
cÚŒŞËr
, 
i
);

785 
	}
}

787 
gboŞ—n


788 
	$hf_usb_devd_add
 (cÚ¡ *
Çme
,

789 
GHashTabË
 *
·¿ms
,

790 
GHashTabË
 *
©
,

791 cÚ¡ *
·»Á
)

793 
H®Deviû
 *
·»Á_deviû
;

794 cÚ¡ *
pÜt_šdex
;

795 cÚ¡ *
pÜt
;

796 
H®Deviû
 *
deviû
;

803 ià(! 
·»Á
)

804  
FALSE
;

806 
pÜt_šdex
 = 
	`g_hash_bË_lookup
(
©
, "port");

807 ià(! 
pÜt_šdex
)

808  
FALSE
;

815 ià(
	`hf_devŒ“_fšd_äom_Çme
(
	`h®d_g‘_gdl
(), 
Çme
))

816  
FALSE
;

825 
·»Á_deviû
 = 
	`hf_devŒ“_fšd_äom_Çme
(
	`h®d_g‘_gdl
(), 
·»Á
);

826 ià(! 
·»Á_deviû
)

827  
FALSE
;

829 
pÜt
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡_–em
(
·»Á_deviû
, "usb_deviû.ä“bsd.pÜts", 
	`©oi
(
pÜt_šdex
));

830 ià(! 
pÜt
)

831  
FALSE
;

833 
deviû
 = 
	`hf_deviû_¡Üe_m©ch
(
	`h®d_g‘_gdl
(),

834 "šfo.·»Á", 
HAL_PROPERTY_TYPE_STRING
, 
	`h®_deviû_g‘_udi
(
·»Á_deviû
),

835 "usb_deviû.pÜt_numb”", 
HAL_PROPERTY_TYPE_INT32
, 
	`©oi
(
pÜt
),

836 
NULL
);

838 ià(
deviû
)

840 
	`os¥ec_deviû_»´obe
(
deviû
);

841  
TRUE
;

844  
FALSE
;

845 
	}
}

847 
gboŞ—n


848 
	$hf_usb_devd_»move
 (cÚ¡ *
Çme
,

849 
GHashTabË
 *
·¿ms
,

850 
GHashTabË
 *
©
,

851 cÚ¡ *
·»Á
)

853 
H®Deviû
 *
deviû
;

868 
deviû
 = 
	`hf_devŒ“_fšd_äom_Çme
(
	`h®d_g‘_gdl
(), 
Çme
);

869 ià(
deviû
 && 
	`h®_deviû_has_´İ”ty
(device, "usb_device.port_number"))

871 
	`os¥ec_deviû_»´obe
(
deviû
);

872  
TRUE
;

875  
FALSE
;

876 
	}
}

878 
HFHªdËr
 
	ghf_usb_hªdËr
 = {

879 .
´iveged_š™
 = 
hf_usb_´iveged_š™
,

880 .
	gš™
 = 
hf_usb_š™
,

881 .
	g´obe
 = 
hf_usb_´obe


884 
HFDevdHªdËr
 
	ghf_usb_devd_hªdËr
 = {

885 .
add
 = 
hf_usb_devd_add
,

886 .
	g»move
 = 
hf_usb_devd_»move


	@hald/freebsd/hf-usb.h

24 #iâdeà
_HF_USB_H


25 
	#_HF_USB_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"hf-os¥ec.h
"

32 
	~"hf-devd.h
"

34 
HFHªdËr
 
hf_usb_hªdËr
;

35 
HFDevdHªdËr
 
hf_usb_devd_hªdËr
;

	@hald/freebsd/hf-util.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡dio.h
>

29 
	~<¡ršg.h
>

30 
	~<”ºo.h
>

31 
	~<sys/ty³s.h
>

32 
	~<sys/sysùl.h
>

33 
	~<glib.h
>

35 
	~"../h®d_ruÂ”.h
"

36 
	~"../os¥ec.h
"

37 
	~"../ut.h
"

38 
	~"../deviû_šfo.h
"

40 
	~"hf-©a.h
"

41 
	~"hf-ut.h
"

45 
gboŞ—n
 
	mdÚe
;

46 } 
	tAsyncInfo
;

50 
	mex™_ty³
;

51 
	m»tuº_code
;

52 } 
	tRuÂ”Info
;

56 *
	mkey
;

57 *
	m¡rv®
;

58 
	mty³
;

59 
	mštv®
;

60 } 
	tPrİ”tyBag
;

62 
gboŞ—n
 
	ghf_is_wa™šg
 = 
FALSE
;

65 
	$hf_async_š™
 (
AsyncInfo
 *
šfo
)

67 
	`g_»tuº_if_ç
(
šfo
 !ğ
NULL
);

69 
šfo
->
dÚe
 = 
FALSE
;

70 
	}
}

73 
	$hf_async_wa™
 (
AsyncInfo
 *
šfo
)

75 
	`g_»tuº_if_ç
(
šfo
 !ğ
NULL
);

76 
	`g_»tuº_if_ç
(
hf_is_wa™šg
 =ğ
FALSE
);

78 ! 
šfo
->
dÚe
)

80 
hf_is_wa™šg
 = 
TRUE
;

81 
	`g_maš_cÚ‹xt_™”©iÚ
(
NULL
, 
TRUE
);

82 
hf_is_wa™šg
 = 
FALSE
;

85 
šfo
->
dÚe
 = 
FALSE
;

86 
	}
}

88 
H®Deviû
 *

89 
	$hf_deviû_Ãw
 (
H®Deviû
 *
·»Á
)

91 
H®Deviû
 *
deviû
;

93 
deviû
 = 
	`h®_deviû_Ãw
();

95 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.·»Á", 
·»Á
 ? 
	`h®_deviû_g‘_udi
Õ¬’tè: 
HF_COMPUTER
);

97  
deviû
;

98 
	}
}

101 
	$hf_deviû_ÿÎout_dÚe_cb
 (
H®Deviû
 *
deviû
, 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

103 
AsyncInfo
 *
async
 = 
d©a1
;

105 
async
->
dÚe
 = 
TRUE
;

106 
	}
}

108 
gboŞ—n


109 
	$hf_deviû_´•robe
 (
H®Deviû
 *
deviû
)

111 
AsyncInfo
 
async
;

112 
gboŞ—n
 
ignÜe
;

114 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
deviû
), 
FALSE
);

117 
	`h®_deviû_¡Üe_add
(
	`h®d_g‘_tdl
(), 
deviû
);

120 
	`di_£¬ch_ªd_m”ge
(
deviû
, 
DEVICE_INFO_TYPE_PREPROBE
);

123 
	`hf_async_š™
(&
async
);

124 
	`h®_ut_ÿÎout_deviû_´•robe
(
deviû
, 
hf_deviû_ÿÎout_dÚe_cb
, &
async
, 
NULL
);

125 
	`hf_async_wa™
(&
async
);

127 
ignÜe
 = 
	`h®_deviû_´İ”ty_g‘_boŞ
(
deviû
, "info.ignore");

128 ià(
ignÜe
)

130 
	`h®_deviû_´İ”ty_»move
(
deviû
, "info.category");

131 
	`h®_deviû_´İ”ty_»move
(
deviû
, "info.capabilities");

132 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.udi", "/org/freedesktop/Hal/devices/ignored-device");

133 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.product", "Ignored Device");

136 
	`h®_deviû_¡Üe_»move
(
	`h®d_g‘_tdl
(), 
deviû
);

137 
	`h®_deviû_¡Üe_add
(
	`h®d_g‘_gdl
(), 
deviû
);

140  ! 
ignÜe
;

141 
	}
}

144 
	$hf_deviû_add
 (
H®Deviû
 *
deviû
)

146 
AsyncInfo
 
async
;

148 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

151 
	`di_£¬ch_ªd_m”ge
(
deviû
, 
DEVICE_INFO_TYPE_INFORMATION
);

152 
	`di_£¬ch_ªd_m”ge
(
deviû
, 
DEVICE_INFO_TYPE_POLICY
);

155 
	`hf_async_š™
(&
async
);

156 
	`h®_ut_ÿÎout_deviû_add
(
deviû
, 
hf_deviû_ÿÎout_dÚe_cb
, &
async
, 
NULL
);

157 
	`hf_async_wa™
(&
async
);

160 
	`h®_deviû_¡Üe_»move
(
	`h®d_g‘_tdl
(), 
deviû
);

161 
	`h®_deviû_¡Üe_add
(
	`h®d_g‘_gdl
(), 
deviû
);

162 
	}
}

164 
gboŞ—n


165 
	$hf_deviû_´•robe_ªd_add
 (
H®Deviû
 *
deviû
)

167 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
deviû
), 
FALSE
);

169 ià(
	`hf_deviû_´•robe
(
deviû
))

171 
	`hf_deviû_add
(
deviû
);

172  
TRUE
;

175  
FALSE
;

176 
	}
}

179 
	$hf_deviû_»move
 (
H®Deviû
 *
deviû
)

181 
AsyncInfo
 
async
;

183 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

185 
	`hf_async_š™
(&
async
);

186 
	`h®_ut_ÿÎout_deviû_»move
(
deviû
, 
hf_deviû_ÿÎout_dÚe_cb
, &
async
, 
NULL
);

187 
	`hf_async_wa™
(&
async
);

189 
	`h®_deviû_¡Üe_»move
(
	`h®d_g‘_gdl
(), 
deviû
);

190 
	`g_objeù_uÄef
(
deviû
);

191 
	}
}

194 
	$hf_deviû_»move_chd»n
 (
H®Deviû
 *
deviû
)

196 
GSLi¡
 *
chd»n
;

198 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

200 
chd»n
 = 
	`hf_deviû_¡Üe_g‘_chd»n
(
	`h®d_g‘_gdl
(), 
deviû
);

201 
chd»n
 = 
	`g_¦i¡_»v”£
(children);

202 
	`g_¦i¡_fÜ—ch
(
chd»n
, (
GFunc
è
hf_deviû_»move
, 
NULL
);

203 
	`g_¦i¡_ä“
(
chd»n
);

204 
	}
}

208 
	$hf_deviû_»move_Œ“
 (
H®Deviû
 *
deviû
)

210 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

212 
	`hf_deviû_»move_chd»n
(
deviû
);

213 
	`hf_deviû_»move
(
deviû
);

214 
	}
}

222 
H®DeviûStÜe
 *

223 
	$hf_³ndšg_gdl_Ãw
 ()

225 
H®DeviûStÜe
 *
¡Üe
;

226 
GLi¡
 *
l
;

227 
GSLi¡
 *
¦
;

229 
¡Üe
 = 
	`h®_deviû_¡Üe_Ãw
();

231 
	`HF_LIST_FOREACH
(
¦
, 
	`h®d_g‘_gdl
()->
deviûs
)

232 
	`h®_deviû_¡Üe_add
(
¡Üe
, 
¦
->
d©a
);

234 
	`HF_LIST_FOREACH
(
l
, 
hf_©a_³ndšg_deviûs
)

235 
	`h®_deviû_¡Üe_add
(
¡Üe
, 
l
->
d©a
);

237  
¡Üe
;

238 
	}
}

241 
	$hf_³ndšg_gdl_ä“
 (
H®DeviûStÜe
 *
¡Üe
)

243 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE_STORE
(
¡Üe
));

246 
¡Üe
->
deviûs
)

247 
	`h®_deviû_¡Üe_»move
(
¡Üe
, stÜe->
deviûs
->
d©a
);

249 
	`g_objeù_uÄef
(
¡Üe
);

250 
	}
}

253 
	$hf_deviû_£t_udi
 (
H®Deviû
 *
deviû
, cÚ¡ *
fÜm©
, ...)

255 
va_li¡
 
¬gs
;

256 *
udi
;

257 *
§ã_¡r
;

259 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

260 
	`g_»tuº_if_ç
(
fÜm©
 !ğ
NULL
);

262 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

263 
udi
 = 
	`g_¡rdup_v´štf
(
fÜm©
, 
¬gs
);

264 
	`va_’d
(
¬gs
);

266 
§ã_¡r
 = 
	`hf_¡r_esÿ³
(
udi
);

267 
	`g_ä“
(
udi
);

269 
	`hf_deviû_£t_fuÎ_udi
(
deviû
, "/Üg/ä“desktİ/H®/deviûs/%s", 
§ã_¡r
);

270 
	`g_ä“
(
§ã_¡r
);

271 
	}
}

274 
	$hf_deviû_£t_fuÎ_udi
 (
H®Deviû
 *
deviû
, cÚ¡ *
fÜm©
, ...)

276 
va_li¡
 
¬gs
;

277 
H®DeviûStÜe
 *
³ndšg_gdl
;

278 *
»que¡ed_udi
;

279 
aùu®_udi
[256];

281 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

282 
	`g_»tuº_if_ç
(
fÜm©
 !ğ
NULL
);

289 
³ndšg_gdl
 = 
	`hf_³ndšg_gdl_Ãw
();

291 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

292 
»que¡ed_udi
 = 
	`g_¡rdup_v´štf
(
fÜm©
, 
¬gs
);

293 
	`va_’d
(
¬gs
);

295 
	`h®_ut_make_udi_unique
 (
³ndšg_gdl
, 
aùu®_udi
, ×ùu®_udi), 
»que¡ed_udi
);

297 
	`hf_³ndšg_gdl_ä“
(
³ndšg_gdl
);

298 
	`g_ä“
(
»que¡ed_udi
);

300 
	`h®_deviû_£t_udi
(
deviû
, 
aùu®_udi
);

301 
	}
}

304 
	$hf_deviû_´İ”ty_£t_¡ršg_´štf
 (
H®Deviû
 *
deviû
,

305 cÚ¡ *
key
,

306 cÚ¡ *
fÜm©
,

309 *
v®ue
 = 
NULL
;

311 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

312 
	`g_»tuº_if_ç
(
key
 !ğ
NULL
);

314 ià(
fÜm©
)

316 
va_li¡
 
¬gs
;

318 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

319 
v®ue
 = 
	`g_¡rdup_v´štf
(
fÜm©
, 
¬gs
);

320 
	`va_’d
(
¬gs
);

323 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, 
key
, 
v®ue
);

324 
	`g_ä“
(
v®ue
);

325 
	}
}

328 
	$hf_deviû_£t_šput
 (
H®Deviû
 *
deviû
,

329 cÚ¡ *
şass
,

330 cÚ¡ *
devÇme
)

332 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

334 
	`h®_deviû_add_ÿ·b™y
(
deviû
, "input");

336 ià(
şass
)

338 *
ÿ‹gÜy
;

340 
ÿ‹gÜy
 = 
	`g_¡rdup_´štf
("šput.%s", 
şass
);

341 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šfo.ÿ‹gÜy", 
ÿ‹gÜy
);

342 
	`h®_deviû_add_ÿ·b™y
(
deviû
, 
ÿ‹gÜy
);

343 
	`g_ä“
(
ÿ‹gÜy
);

346 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "info.category", "input");

348 ià(
devÇme
)

349 
	`hf_deviû_´İ”ty_£t_¡ršg_´štf
(
deviû
, "šput.deviû", "/dev/%s", 
devÇme
);

351 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "šput.deviû", 
NULL
);

352 
	}
}

354 
H®Deviû
 *

355 
	$hf_deviû_¡Üe_g‘_·»Á
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
)

357 cÚ¡ *
·»Á_udi
;

359 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE_STORE
(
¡Üe
), 
NULL
);

360 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
deviû
), 
NULL
);

362 
·»Á_udi
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "info.parent");

363 ià(
·»Á_udi
)

364  
	`h®_deviû_¡Üe_fšd
(
¡Üe
, 
·»Á_udi
);

366  
NULL
;

367 
	}
}

369 
GSLi¡
 *

370 
	$hf_deviû_¡Üe_g‘_chd»n
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
)

372 
GSLi¡
 *
chd»n
;

373 
GSLi¡
 *
tmp
;

374 
GSLi¡
 *
l
;

376 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE_STORE
(
¡Üe
), 
NULL
);

377 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
deviû
), 
NULL
);

379 
chd»n
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
(
¡Üe
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
(
deviû
));

382 
tmp
 = 
	`g_¦i¡_cİy
(
chd»n
);

383 
	`HF_LIST_FOREACH
(
l
, 
tmp
)

384 
chd»n
 = 
	`g_¦i¡_cÚÿt
(chd»n, 
	`hf_deviû_¡Üe_g‘_chd»n
(
¡Üe
, 
l
->
d©a
));

385 
	`g_¦i¡_ä“
(
tmp
);

387  
chd»n
;

388 
	}
}

390 
gboŞ—n


391 
	$hf_has_sysùl
 (cÚ¡ *
fÜm©
, ...)

393 
va_li¡
 
¬gs
;

394 *
Çme
;

395 
size_t
 
v®ue_Ën
;

396 
gboŞ—n
 
¡©us
;

398 
	`g_»tuº_v®_if_ç
(
fÜm©
 !ğ
NULL
, 
FALSE
);

400 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

401 
Çme
 = 
	`g_¡rdup_v´štf
(
fÜm©
, 
¬gs
);

402 
	`va_’d
(
¬gs
);

404 
¡©us
 = 
	`sysùlbyÇme
(
Çme
, 
NULL
, &
v®ue_Ën
, NULL, 0) == 0;

406 
	`g_ä“
(
Çme
);

407  
¡©us
;

408 
	}
}

410 
gboŞ—n


411 
	$hf_g‘_št_sysùl
 (*
v®ue
, 
GE¼Ü
 **
”r
, cÚ¡ *
fÜm©
, ...)

413 
va_li¡
 
¬gs
;

414 *
Çme
;

415 
size_t
 
v®ue_Ën
 = ();

416 
gboŞ—n
 
¡©us
;

418 
	`g_»tuº_v®_if_ç
(
v®ue
 !ğ
NULL
, 
FALSE
);

419 
	`g_»tuº_v®_if_ç
(
fÜm©
 !ğ
NULL
, 
FALSE
);

421 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

422 
Çme
 = 
	`g_¡rdup_v´štf
(
fÜm©
, 
¬gs
);

423 
	`va_’d
(
¬gs
);

425 
¡©us
 = 
	`sysùlbyÇme
(
Çme
, 
v®ue
, &
v®ue_Ën
, 
NULL
, 0) == 0;

426 ià(! 
¡©us
)

427 
	`g_£t_”rÜ
(
”r
, 0, 0, "%s", 
	`g_¡»¼Ü
(
”ºo
));

429 
	`g_ä“
(
Çme
);

430  
¡©us
;

431 
	}
}

434 
	$hf_g‘_¡ršg_sysùl
 (
GE¼Ü
 **
”r
, cÚ¡ *
fÜm©
, ...)

436 
va_li¡
 
¬gs
;

437 *
Çme
;

438 
size_t
 
v®ue_Ën
;

439 *
¡r
 = 
NULL
;

441 
	`g_»tuº_v®_if_ç
(
fÜm©
 !ğ
NULL
, 
FALSE
);

443 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

444 
Çme
 = 
	`g_¡rdup_v´štf
(
fÜm©
, 
¬gs
);

445 
	`va_’d
(
¬gs
);

447 ià(
	`sysùlbyÇme
(
Çme
, 
NULL
, &
v®ue_Ën
, NULL, 0) == 0)

449 
¡r
 = 
	`g_Ãw
(, 
v®ue_Ën
 + 1);

450 ià(
	`sysùlbyÇme
(
Çme
, 
¡r
, &
v®ue_Ën
, 
NULL
, 0) == 0)

451 
¡r
[
v®ue_Ën
] = 0;

454 
	`g_ä“
(
¡r
);

455 
¡r
 = 
NULL
;

459 ià(! 
¡r
)

460 
	`g_£t_”rÜ
(
”r
, 0, 0, "%s", 
	`g_¡»¼Ü
(
”ºo
));

462 
	`g_ä“
(
Çme
);

463  
¡r
;

464 
	}
}

467 
	$hf_run
 (
GE¼Ü
 **
”r
, cÚ¡ *
fÜm©
, ...)

469 
va_li¡
 
¬gs
;

470 *
commªd
;

471 
ex™_¡©us
;

472 *
ouut
 = 
NULL
;

474 
	`g_»tuº_v®_if_ç
(
fÜm©
 !ğ
NULL
, NULL);

476 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

477 
commªd
 = 
	`g_¡rdup_v´štf
(
fÜm©
, 
¬gs
);

478 
	`va_’d
(
¬gs
);

480 ià(
	`g_¥awn_commªd_lše_sync
(
commªd
, &
ouut
, 
NULL
, &
ex™_¡©us
, 
”r
))

482 ià(
ex™_¡©us
 != 0)

484 
	`g_£t_”rÜ
(
”r
, 0, 0, "commªd„‘uºed stu %i", 
ex™_¡©us
);

485 
	`g_ä“
(
ouut
);

486 
ouut
 = 
NULL
;

490 
	`g_ä“
(
commªd
);

491  
ouut
;

492 
	}
}

495 
	$hf_ruÂ”_‹rmš©ed_cb
 (
H®Deviû
 *
deviû
,

496 
gušt32
 
ex™_ty³
,

497 
»tuº_code
,

498 **
”rÜ
,

499 
gpoš‹r
 
d©a1
,

500 
gpoš‹r
 
d©a2
)

502 
AsyncInfo
 *
async
 = 
d©a1
;

503 
RuÂ”Info
 *
šfo
 = 
d©a2
;

505 
šfo
->
ex™_ty³
 =ƒxit_type;

506 
šfo
->
»tuº_code
 =„eturn_code;

508 
async
->
dÚe
 = 
TRUE
;

509 
	}
}

512 
	$hf_ruÂ”_run_sync
 (
H®Deviû
 *
deviû
,

513 
timeout
,

514 cÚ¡ *
commªd_lše
, ...)

516 
AsyncInfo
 
async
;

517 
RuÂ”Info
 
šfo
;

518 
GPŒA¼ay
 *
exŒa_’v
;

519 cÚ¡ *
v¬ŸbË
;

520 
va_li¡
 
¬gs
;

522 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
deviû
), 0);

523 
	`g_»tuº_v®_if_ç
(
commªd_lše
 !ğ
NULL
, 0);

525 ià(
timeout
 <= 0)

526 
timeout
 = 
HAL_HELPER_TIMEOUT
;

528 
exŒa_’v
 = 
	`g_±r_¬¿y_Ãw
();

530 
	`va_¡¬t
(
¬gs
, 
commªd_lše
);

531 (
v¬ŸbË
 = 
	`va_¬g
(
¬gs
, const *)))

533 cÚ¡ *
v®ue
;

535 
v®ue
 = 
	`va_¬g
(
¬gs
, const *);

536 
	`g_as£¹
(
v®ue
 !ğ
NULL
);

538 
	`g_±r_¬¿y_add
(
exŒa_’v
, 
	`g_¡rdup_´štf
("%s=%s", 
v¬ŸbË
, 
v®ue
));

540 
	`va_’d
(
¬gs
);

542 
	`g_±r_¬¿y_add
(
exŒa_’v
, 
NULL
);

544 
	`hf_async_š™
(&
async
);

545 
	`h®d_ruÂ”_run
(
deviû
, 
commªd_lše
, (**è
exŒa_’v
->
pd©a
, 
timeout
, 
hf_ruÂ”_‹rmš©ed_cb
, &
async
, &
šfo
);

546 
	`hf_async_wa™
(&
async
);

548 
	`g_±r_¬¿y_fÜ—ch
(
exŒa_’v
, (
GFunc
è
g_ä“
, 
NULL
);

549 
	`g_±r_¬¿y_ä“
(
exŒa_’v
, 
TRUE
);

551  
šfo
.
ex™_ty³
 =ğ
HALD_RUN_SUCCESS
 ? info.
»tuº_code
 : -1;

552 
	}
}

555 
	$hf_¡rv_fšd
 (**
¡rv
, cÚ¡ *
–em
)

557 
i
;

559 
	`g_»tuº_v®_if_ç
(
¡rv
 !ğ
NULL
, -1);

560 
	`g_»tuº_v®_if_ç
(
–em
 !ğ
NULL
, -1);

562 
i
 = 0; 
¡rv
[i]; i++)

563 ià(! 
	`¡rcmp
(
¡rv
[
i
], 
–em
))

564  
i
;

567 
	}
}

570 
	$hf_´İ”ty_bag_ä“
 (
Prİ”tyBag
 *
bag
)

572 
	`g_ä“
(
bag
->
key
);

573 
	`g_ä“
(
bag
->
¡rv®
);

575 
	`g_ä“
(
bag
);

576 
	}
}

578 
H®Deviû
 *

579 
	$hf_deviû_¡Üe_m©ch
 (
H®DeviûStÜe
 *
¡Üe
, ...)

581 
GSLi¡
 *
´İs
 = 
NULL
;

582 
va_li¡
 
¬gs
;

583 
GSLi¡
 *
a
;

584 
H®Deviû
 *
deviû
 = 
NULL
;

586 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE_STORE
(
¡Üe
), 
NULL
);

588 
	`va_¡¬t
(
¬gs
, 
¡Üe
);

590 
TRUE
)

592 *
key
;

593 
Prİ”tyBag
 *
bag
;

595 
key
 = 
	`va_¬g
(
¬gs
, *);

596 ià(! 
key
)

599 
bag
 = 
	`g_Ãw0
(
Prİ”tyBag
, 1);

600 
bag
->
key
 = 
	`g_¡rdup
(key);

602 
bag
->
ty³
 = 
	`va_¬g
(
¬gs
, );

603 
bag
->
ty³
)

605 
HAL_PROPERTY_TYPE_STRING
:

607 *
v®
;

609 
v®
 = 
	`va_¬g
(
¬gs
, *);

610 
bag
->
¡rv®
 = 
	`g_¡rdup
(
v®
 ? val : "");

613 
HAL_PROPERTY_TYPE_INT32
:

614 
bag
->
štv®
 = 
	`va_¬g
(
¬gs
, );

617 
	`g_¦i¡_fÜ—ch
(
´İs
, (
GFunc
è
hf_´İ”ty_bag_ä“
, 
NULL
);

618 
	`g_¦i¡_ä“
(
´İs
);

619 
	`hf_´İ”ty_bag_ä“
(
bag
);

621 
	`va_’d
(
¬gs
);

623 
	`g_»tuº_v®_if_»ached
(
NULL
);

626 
´İs
 = 
	`g_¦i¡_´•’d
Õrİs, 
bag
);

629 
	`va_’d
(
¬gs
);

631 
	`HF_LIST_FOREACH
(
a
, 
¡Üe
->
deviûs
)

633 
GSLi¡
 *
b
;

635 
deviû
 = (
H®Deviû
 *è
a
->
d©a
;

637 
	`HF_LIST_FOREACH
(
b
, 
´İs
)

639 
Prİ”tyBag
 *
bag
;

641 
bag
 = (
Prİ”tyBag
 *è
b
->
d©a
;

643 
bag
->
ty³
)

645 
HAL_PROPERTY_TYPE_STRING
:

647 cÚ¡ *
p¡r
;

649 
p¡r
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, 
bag
->
key
);

650 ià(! 
p¡r
 || 
	`¡rcmp
Õ¡r, 
bag
->
¡rv®
))

651 
deviû
 = 
NULL
;

654 
HAL_PROPERTY_TYPE_INT32
:

655 ià(
	`h®_deviû_´İ”ty_g‘_št
(
deviû
, 
bag
->
key
) !=

656 
bag
->
štv®
)

657 
deviû
 = 
NULL
;

660 
	`g_as£¹_nÙ_»ached
();

663 ià(! 
deviû
)

667 ià(
deviû
)

671 
	`g_¦i¡_fÜ—ch
(
´İs
, (
GFunc
è
hf_´İ”ty_bag_ä“
, 
NULL
);

672 
	`g_¦i¡_ä“
(
´İs
);

674  
deviû
;

675 
	}
}

678 
	$hf_¡r_esÿ³
 (cÚ¡ *
¡r
)

680 *
§ã_¡r
;

682 
	`g_»tuº_v®_if_ç
(
¡r
 !ğ
NULL
, NULL);

684 
§ã_¡r
 = 
	`g_¡rdup
(
¡r
);

685 
	`g_¡rÿnÚ
(
§ã_¡r
,

691  
§ã_¡r
;

692 
	}
}

	@hald/freebsd/hf-util.h

24 #iâdeà
_HF_UTIL_H


25 
	#_HF_UTIL_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡d¬g.h
>

32 
	~<glib.h
>

34 
	~"../h®d.h
"

36 
	#HF_COMPUTER
 "/Üg/ä“desktİ/H®/deviûs/compu‹r"

	)

38 
	#HF_BOOL_TO_STRING
(
v®
è((v®è? "Œue" : "çl£")

	)

40 
	#HF_LIST_FOREACH
(
v¬
, 
h—d
) \

41 (
v¬
èğ(
h—d
); \

42 (
v¬
); \

43 (
v¬
èğ(v¬)->
Ãxt
)

	)

66 
hf_is_wa™šg
;

68 
H®Deviû
 *
hf_deviû_Ãw
 (H®Deviû *
·»Á
);

70 
gboŞ—n
 
hf_deviû_´•robe
 (
H®Deviû
 *
deviû
);

71 
hf_deviû_add
 (
H®Deviû
 *
deviû
);

72 
gboŞ—n
 
hf_deviû_´•robe_ªd_add
 (
H®Deviû
 *
deviû
);

73 
hf_deviû_»move
 (
H®Deviû
 *
deviû
);

74 
hf_deviû_»move_chd»n
 (
H®Deviû
 *
deviû
);

75 
hf_deviû_»move_Œ“
 (
H®Deviû
 *
deviû
);

77 
	$hf_deviû_£t_udi
 (
H®Deviû
 *
deviû
,

78 cÚ¡ *
fÜm©
,

79 ...è
	`G_GNUC_PRINTF
(2, 3);

80 
	$hf_deviû_£t_fuÎ_udi
 (
H®Deviû
 *
deviû
,

81 cÚ¡ *
fÜm©
,

82 ...è
	`G_GNUC_PRINTF
(2, 3);

84 
	$hf_deviû_´İ”ty_£t_¡ršg_´štf
 (
H®Deviû
 *
deviû
,

85 cÚ¡ *
key
,

86 cÚ¡ *
fÜm©
,

87 ...è
	`G_GNUC_PRINTF
(3, 4);

89 
	`hf_deviû_£t_šput
 (
H®Deviû
 *
deviû
,

90 cÚ¡ *
şass
,

91 cÚ¡ *
devÇme
);

93 
H®Deviû
 *
	`hf_deviû_¡Üe_g‘_·»Á
 (
H®DeviûStÜe
 *
¡Üe
,

94 
H®Deviû
 *
deviû
);

95 
GSLi¡
 *
	`hf_deviû_¡Üe_g‘_chd»n
 (
H®DeviûStÜe
 *
¡Üe
,

96 
H®Deviû
 *
deviû
);

98 
gboŞ—n
 
	$hf_has_sysùl
 (cÚ¡ *
fÜm©
, ...è
	`G_GNUC_PRINTF
(1, 2);

99 
gboŞ—n
 
	$hf_g‘_št_sysùl
 (*
v®ue
,

100 
GE¼Ü
 **
”r
,

101 cÚ¡ *
fÜm©
,

102 ...è
	`G_GNUC_PRINTF
(3, 4);

103 *
	$hf_g‘_¡ršg_sysùl
 (
GE¼Ü
 **
”r
,

104 cÚ¡ *
fÜm©
,

105 ...è
	`G_GNUC_PRINTF
(2, 3);

107 *
	$hf_run
 (
GE¼Ü
 **
”r
, cÚ¡ *
fÜm©
, ...è
	`G_GNUC_PRINTF
(2, 3);

109 
	`hf_ruÂ”_run_sync
 (
H®Deviû
 *
deviû
, 
timeout
, cÚ¡ *
commªd_lše
, ...);

111 
	`hf_¡rv_fšd
 (**
¡rv
, cÚ¡ *
–em
);

113 *
	`hf_¡r_esÿ³
 (cÚ¡ *
¡r
);

115 
H®Deviû
 *
	`hf_deviû_¡Üe_m©ch
 (
H®DeviûStÜe
 *
¡Üe
, ...);

	@hald/freebsd/hf-volume.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

29 
	~<”ºo.h
>

30 
	~<sys/·¿m.h
>

31 
	~<sys/uüed.h
>

32 
	~<sys/mouÁ.h
>

34 
	~"../h®d.h
"

35 
	~"../h®d_dbus.h
"

36 
	~"../h®d_ruÂ”.h
"

37 
	~"../logg”.h
"

38 
	~"../ut.h
"

39 
	~"../deviû_šfo.h
"

40 
	~"../os¥ec.h
"

42 
	~"hf-vŞume.h
"

43 
	~"hf-block.h
"

44 
	~"hf-¡Üage.h
"

45 
	~"hf-ut.h
"

47 
	#PROBE_VOLUME_TIMEOUT
 (
HAL_HELPER_TIMEOUT
 * 6)

	)

50 
	$hf_vŞume_g‘_mouÁs
 (
¡©fs
 **
mouÁs
, *
n_mouÁs
)

52 
	`g_»tuº_if_ç
(
mouÁs
 !ğ
NULL
);

53 
	`g_»tuº_if_ç
(
n_mouÁs
 !ğ
NULL
);

55 *
n_mouÁs
 = 
	`g‘mÁšfo
(
mouÁs
, 
MNT_NOWAIT
);

56 ià(*
n_mouÁs
 == 0)

58 
	`HAL_WARNING
(("uÇbËØg‘†i¡ oàmouÁed fesy¡ems: %s", 
	`g_¡»¼Ü
(
”ºo
)));

59 *
mouÁs
 = 
NULL
;

61 
	}
}

63 cÚ¡ 
¡©fs
 *

64 
	$hf_vŞume_mouÁs_fšd
 (cÚ¡ 
¡©fs
 *
mouÁs
,

65 
n_mouÁs
,

66 cÚ¡ *
¥ecŸl
)

68 
i
;

70 
	`g_»tuº_v®_if_ç
(
mouÁs
 !ğ
NULL
, NULL);

71 
	`g_»tuº_v®_if_ç
(
¥ecŸl
 !ğ
NULL
, NULL);

73 
i
 = 0; i < 
n_mouÁs
; i++)

74 ià(! 
	`¡rcmp
(
mouÁs
[
i
].
f_mÁäomÇme
, 
¥ecŸl
))

75  &
mouÁs
[
i
];

77  
NULL
;

78 
	}
}

81 
	$hf_vŞume_deviû_upd©e_mouÁ_´İ”t›s
 (
H®Deviû
 *
deviû
,

82 cÚ¡ 
¡©fs
 *
mouÁs
,

83 
n_mouÁs
)

85 cÚ¡ 
¡©fs
 *
mouÁ
 = 
NULL
;

87 
	`g_»tuº_if_ç
(
	`HAL_IS_DEVICE
(
deviû
));

89 ià(
mouÁs
)

91 cÚ¡ *
¥ecŸl
;

93 
¥ecŸl
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "block.device");

94 ià(
¥ecŸl
)

95 
mouÁ
 = 
	`hf_vŞume_mouÁs_fšd
(
mouÁs
, 
n_mouÁs
, 
¥ecŸl
);

98 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "vŞume.is_mouÁed", 
mouÁ
 !ğ
NULL
);

99 
	`h®_deviû_´İ”ty_£t_boŞ
(
deviû
, "vŞume.is_mouÁed_»ad_Úly", 
mouÁ
 && (mouÁ->
f_æags
 & 
MNT_RDONLY
) != 0);

100 
	`h®_deviû_´İ”ty_£t_¡ršg
(
deviû
, "vŞume.mouÁ_pošt", 
mouÁ
 ? mouÁ->
f_mÁÚÇme
 : 
NULL
);

101 
	}
}

103 
H®Deviû
 *

104 
	$hf_vŞume_deviû_add
 (
H®Deviû
 *
·»Á
,

105 
H®Deviû
 *
¡Üage_deviû
,

106 
gboŞ—n
 
has_chd»n
,

107 
gboŞ—n
 
is_sw­
,

108 cÚ¡ *
devÇme
,

109 cÚ¡ *
gşass
,

110 cÚ¡ *
g¡r_ty³
,

111 
gty³
,

112 
gšdex
,

113 
dbus_št64_t
 
·¹™iÚ_off£t
,

114 
dbus_št64_t
 
·¹™iÚ_size
)

116 
H®Deviû
 *
deviû
;

117 *
·¹™iÚ_off£t_¡r
;

118 *
·¹™iÚ_size_¡r
;

119 *
ty³_¡r
;

120 *
geom_şass
;

121 *
šdex_¡r
;

122 
gboŞ—n
 
is_vŞume
;

124 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
·»Á
), 
NULL
);

125 
	`g_»tuº_v®_if_ç
(
	`HAL_IS_DEVICE
(
¡Üage_deviû
), 
NULL
);

126 
	`g_»tuº_v®_if_ç
(
devÇme
 !ğ
NULL
, NULL);

128 
deviû
 = 
	`hf_deviû_Ãw
(
·»Á
);

130 
	`hf_block_deviû_’abË
(
deviû
, 
devÇme
);

132 ià(! 
	`hf_deviû_´•robe
(
deviû
))

133 
’d
;

135 ià(! 
gşass
)

136 
geom_şass
 = 
	`g_¡rdup
("");

138 
geom_şass
 = 
	`g_¡rdup
(
gşass
);

140 ià(
g¡r_ty³
)

141 
ty³_¡r
 = 
	`g_¡rdup
(
g¡r_ty³
);

143 
ty³_¡r
 = 
	`g_¡rdup_´štf
("%d", 
gty³
);

145 
šdex_¡r
 = 
	`g_¡rdup_´štf
("%d", 
gšdex
);

147 
·¹™iÚ_off£t_¡r
 = 
	`g_¡rdup_´štf
("%ju", 
·¹™iÚ_off£t
);

148 
·¹™iÚ_size_¡r
 = 
	`g_¡rdup_´štf
("%ju", 
·¹™iÚ_size
);

150 
is_vŞume
 = 
	`hf_ruÂ”_run_sync
(
deviû
, 
PROBE_VOLUME_TIMEOUT
,

152 "HF_HAS_CHILDREN", 
	`HF_BOOL_TO_STRING
(
has_chd»n
),

153 "HF_IS_SWAP", 
	`HF_BOOL_TO_STRING
(
is_sw­
),

154 "HF_VOLUME_GEOM_CLASS", 
geom_şass
,

155 "HF_VOLUME_PART_TYPE", 
ty³_¡r
,

156 "HF_VOLUME_PART_INDEX", 
šdex_¡r
,

157 "HF_VOLUME_OFFSET", 
·¹™iÚ_off£t_¡r
,

158 "HF_VOLUME_SIZE", 
·¹™iÚ_size_¡r
,

159 
NULL
) == 0;

160 ià(
is_vŞume
)

162 
¡©fs
 *
mouÁs
;

163 
n_mouÁs
;

165 
	`hf_vŞume_g‘_mouÁs
(&
mouÁs
, &
n_mouÁs
);

166 
	`hf_vŞume_deviû_upd©e_mouÁ_´İ”t›s
(
deviû
, 
mouÁs
, 
n_mouÁs
);

169 
	`g_ä“
(
·¹™iÚ_off£t_¡r
);

170 
	`g_ä“
(
·¹™iÚ_size_¡r
);

171 
	`g_ä“
(
šdex_¡r
);

172 
	`g_ä“
(
ty³_¡r
);

173 
	`g_ä“
(
geom_şass
);

175 
	`hf_block_deviû_com¶‘e
(
deviû
, 
¡Üage_deviû
, 
is_vŞume
);

177 
	`hf_deviû_add
(
deviû
);

179 
’d
:

180  
deviû
;

181 
	}
}

184 
	$hf_vŞume_upd©e_mouÁs
 ()

186 
GSLi¡
 *
l
;

187 
¡©fs
 *
mouÁs
;

188 
n_mouÁs
;

190 
	`hf_vŞume_g‘_mouÁs
(&
mouÁs
, &
n_mouÁs
);

192 
	`HF_LIST_FOREACH
(
l
, 
	`h®d_g‘_gdl
()->
deviûs
)

194 
H®Deviû
 *
deviû
 = 
l
->
d©a
;

196 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
(
deviû
, "block.is_volume"))

198 
	`deviû_´İ”ty_©omic_upd©e_begš
();

199 
	`hf_vŞume_deviû_upd©e_mouÁ_´İ”t›s
(
deviû
, 
mouÁs
, 
n_mouÁs
);

200 
	`deviû_´İ”ty_©omic_upd©e_’d
();

203 
	}
}

206 
	$hf_vŞume_upd©e_mouÁ
 (
H®Deviû
 *
deviû
)

208 
¡©fs
 *
mouÁs
;

209 
n_mouÁs
;

211 
	`g_»tuº_if_ç
(
deviû
 !ğ
NULL
);

213 
	`hf_vŞume_g‘_mouÁs
(&
mouÁs
, &
n_mouÁs
);

215 
	`deviû_´İ”ty_©omic_upd©e_begš
();

216 
	`hf_vŞume_deviû_upd©e_mouÁ_´İ”t›s
(
deviû
, 
mouÁs
, 
n_mouÁs
);

217 
	`deviû_´İ”ty_©omic_upd©e_’d
();

218 
	}
}

220 
gboŞ—n


221 
	$hf_vŞume_upd©e_mouÁs_timeout_cb
 (
gpoš‹r
 
d©a
)

223 ià(
hf_is_wa™šg
)

224  
TRUE
;

226 
	`hf_vŞume_upd©e_mouÁs
();

228  
TRUE
;

229 
	}
}

232 
	$hf_vŞume_š™
 ()

234 
	`g_timeout_add
(3000, 
hf_vŞume_upd©e_mouÁs_timeout_cb
, 
NULL
);

235 
	}
}

237 
gboŞ—n


238 
	$hf_vŞume_deviû_»´obe
 (
H®Deviû
 *
deviû
)

240 cÚ¡ *
¡Üage_deviû_udi
;

241 
H®Deviû
 *
¡Üage_deviû
;

243 
¡Üage_deviû_udi
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
deviû
, "block.storage_device");

244 ià(! 
¡Üage_deviû_udi
 || ! 
	`¡rcmp
(¡Üage_deviû_udi, 
	`h®_deviû_g‘_udi
(
deviû
)))

245  
FALSE
;

247 
¡Üage_deviû
 = 
	`h®_deviû_¡Üe_fšd
(
	`h®d_g‘_gdl
(), 
¡Üage_deviû_udi
);

248 
	`g_as£¹
(
¡Üage_deviû
 !ğ
NULL
);

250 
	`hf_deviû_»move_Œ“
(
deviû
);

251 
	`os¥ec_´obe
();

253 
	`hf_¡Üage_deviû_´obe
(
¡Üage_deviû
, 
TRUE
);

255  
TRUE
;

256 
	}
}

258 
HFHªdËr
 
	ghf_vŞume_hªdËr
 = {

259 .
š™
 = 
hf_vŞume_š™
,

260 .
	gdeviû_»´obe
 = 
hf_vŞume_deviû_»´obe


	@hald/freebsd/hf-volume.h

24 #iâdeà
_HF_VOLUME_H


25 
	#_HF_VOLUME_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"hf-os¥ec.h
"

33 
HFHªdËr
 
hf_vŞume_hªdËr
;

35 
hf_vŞume_upd©e_mouÁ
 (
H®Deviû
 *
deviû
);

37 
H®Deviû
 *
hf_vŞume_deviû_add
 (H®Deviû *
·»Á
,

38 
H®Deviû
 *
¡Üage_deviû
,

39 
gboŞ—n
 
has_chd»n
,

40 
gboŞ—n
 
is_sw­
,

41 cÚ¡ *
devÇme
,

42 cÚ¡ *
gşass
,

43 cÚ¡ *
g¡r_ty³
,

44 
gty³
,

45 
gšdex
,

46 
dbus_št64_t
 
·¹™iÚ_off£t
,

47 
dbus_št64_t
 
·¹™iÚ_size
);

	@hald/freebsd/libprobe/hfp-cdrom.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

29 
	~<”ºo.h
>

30 
	~<fú.h
>

31 
	~<as£¹.h
>

32 
	~<uni¡d.h
>

33 
	~<sys/ioùl.h
>

34 
	~<sys/ty³s.h
>

35 
	~<sys/©a.h
>

36 
	~<¡dio.h
>

37 
	~<ÿmlib.h
>

38 
	~<ÿm/scsi/scsi_mes§ge.h
>

40 
	~"hå.h
"

41 
	~"hå-cdrom.h
"

43 
	s_HFPCDROM


45 
ÿm_deviû
 *
	mÿm
;

46 
	mfd
;

47 
	mchªÃl
;

48 
	mdeviû
;

49 
boŞ—n
 
	mfd_owÃd
;

52 
HFPCDROM
 *

53 
	$hå_cdrom_Ãw_»®
 (
boŞ—n
 
has_fd
,

54 
fd
,

55 cÚ¡ *
·th
,

56 cÚ¡ *
·»Á
)

58 
HFPCDROM
 *
cdrom
 = 
NULL
;

59 
ÿm_deviû
 *
ÿm
;

61 
	`as£¹
(
·th
 !ğ
NULL
);

62 
	`as£¹
(
·»Á
 !ğ
NULL
);

65 
ÿm
 = 
	`ÿm_İ’_deviû
(
·th
, 
O_RDWR
);

66 ià(
ÿm
)

68 
cdrom
 = 
	`hå_Ãw0
(
HFPCDROM
, 1);

69 
cdrom
->
ÿm
 = cam;

70 
cdrom
->
fd
 = -1;

74 #iâdeà
IOCATAREQUEST


75 
fd
 = 
	`İ’
("/dev/©a", 
O_RDONLY
);

77 ià(! 
has_fd
)

78 
fd
 = 
	`İ’
(
·th
, 
O_RDONLY
);

80 ià(
fd
 >= 0)

82 
cdrom
 = 
	`hå_Ãw0
(
HFPCDROM
, 1);

83 
cdrom
->
fd
 = fd;

84 #iâdeà
IOCATAREQUEST


85 
cdrom
->
fd_owÃd
 = 
TRUE
;

86 
cdrom
->
chªÃl
 = 
	`libh®_deviû_g‘_´İ”ty_št
(
hå_ùx
,

87 
·»Á
,

89 &
hå_”rÜ
);

90 
	`dbus_”rÜ_ä“
(&
hå_”rÜ
);

91 
cdrom
->
deviû
 = 
	`libh®_deviû_g‘_´İ”ty_št
(
hå_ùx
,

92 
·»Á
,

94 &
hå_”rÜ
);

95 
	`dbus_”rÜ_ä“
(&
hå_”rÜ
);

97 
cdrom
->
fd_owÃd
 = ! 
has_fd
;

98 
cdrom
->
chªÃl
 = -1;

99 
cdrom
->
deviû
 = -1;

104  
cdrom
;

105 
	}
}

107 
HFPCDROM
 *

108 
	$hå_cdrom_Ãw
 (cÚ¡ *
·th
, cÚ¡ *
·»Á
)

110 
	`as£¹
(
·th
 !ğ
NULL
);

111 
	`as£¹
(
·»Á
 !ğ
NULL
);

113  
	`hå_cdrom_Ãw_»®
(
FALSE
, -1, 
·th
, 
·»Á
);

114 
	}
}

116 
HFPCDROM
 *

117 
	$hå_cdrom_Ãw_äom_fd
 (
fd
, cÚ¡ *
·th
, cÚ¡ *
·»Á
)

119 
	`as£¹
(
·th
 !ğ
NULL
);

120 
	`as£¹
(
·»Á
 !ğ
NULL
);

122  
	`hå_cdrom_Ãw_»®
(
TRUE
, 
fd
, 
·th
, 
·»Á
);

123 
	}
}

125 
boŞ—n


126 
	$hå_cdrom_£nd_ccb
 (
HFPCDROM
 *
cdrom
,

127 cÚ¡ *
ccb
,

128 
ccb_Ën
,

129 
HFPCDROMDœeùiÚ
 
dœeùiÚ
,

130 *
d©a
,

131 
Ën
,

132 **
”r
)

134 
timeout
;

136 
	`as£¹
(
cdrom
 !ğ
NULL
);

137 
	`as£¹
(
ccb
 !ğ
NULL
);

138 
	`as£¹
(
dœeùiÚ
 =ğ
HFP_CDROM_DIRECTION_NONE


139 || 
dœeùiÚ
 =ğ
HFP_CDROM_DIRECTION_IN


140 || 
dœeùiÚ
 =ğ
HFP_CDROM_DIRECTION_OUT
);

141 
	`as£¹
(
dœeùiÚ
 =ğ
HFP_CDROM_DIRECTION_NONE
 || 
d©a
 !ğ
NULL
);

143 
timeout
 = 10;

145 ià(
cdrom
->
fd
 >= 0)

147 #ifdeà
IOCATAREQUEST


148 
©a_ioc_»que¡
 
»q
;

150 
	`mem£t
(&
»q
, 0, (req));

151 
»q
.
æags
 = 
ATA_CMD_ATAPI
;

152 
»q
.
timeout
 =imeout;

153 
	`memıy
(
»q
.
u
.
©­i
.
ccb
, ccb, 16);

155 ià(
d©a
)

157 
©­i_dœeùiÚ
[] = { 0, 
ATA_CMD_READ
, 
ATA_CMD_WRITE
 };

159 
»q
.
æags
 |ğ
©­i_dœeùiÚ
[
dœeùiÚ
];

160 
»q
.
d©a
 = data;

161 
»q
.
couÁ
 = 
Ën
;

164 ià(
	`ioùl
(
cdrom
->
fd
, 
IOCATAREQUEST
, &
»q
) < 0)

166 ià(
”r
)

167 *
”r
 = 
	`hå_¡rdup_´štf
("IOCATAREQUEST fau»: %s", 
	`¡»¼Ü
(
”ºo
));

168  
FALSE
;

170 ià(
»q
.
”rÜ
 != 0)

172 ià(
”r
)

173 *
”r
 = 
	`hå_¡rdup_´štf
("ATAPIƒ¼Ü %i", 
»q
.
”rÜ
);

174  
FALSE
;

177 
©a_cmd
 
iocmd
;

181 
	`as£¹
(
cdrom
->
chªÃl
 >= 0);

182 
	`as£¹
(
cdrom
->
deviû
 >= 0 && cdrom->device < 2);

184 
	`mem£t
(&
iocmd
, 0, (iocmd));

185 
iocmd
.
u
.
»que¡
.
æags
 = 
ATA_CMD_ATAPI
;

186 
iocmd
.
u
.
»que¡
.
timeout
 =imeout;

187 
iocmd
.
cmd
 = 
ATAREQUEST
;

188 
iocmd
.
chªÃl
 = 
cdrom
->channel;

189 
iocmd
.
deviû
 = 
cdrom
->device;

190 
	`memıy
(
iocmd
.
u
.
»que¡
.u.
©­i
.
ccb
, ccb, 16);

192 ià(
d©a
)

194 
©­i_dœeùiÚ
[] = { 0, 
ATA_CMD_READ
, 
ATA_CMD_WRITE
 };

196 
iocmd
.
u
.
»que¡
.
æags
 |ğ
©­i_dœeùiÚ
[
dœeùiÚ
];

197 
iocmd
.
u
.
»que¡
.
d©a
 = data;

198 
iocmd
.
u
.
»que¡
.
couÁ
 = 
Ën
;

201 ià(
	`ioùl
(
cdrom
->
fd
, 
IOCATA
, &
iocmd
) < 0)

203 ià(
”r
)

204 *
”r
 = 
	`hå_¡rdup_´štf
("IOCATA fau»: %s", 
	`¡»¼Ü
(
”ºo
));

205  
FALSE
;

207 ià(
iocmd
.
u
.
»que¡
.
”rÜ
 != 0)

209 ià(
”r
)

210 *
”r
 = 
	`hå_¡rdup_´štf
("ATAPIƒ¼Ü %i", 
iocmd
.
u
.
»que¡
.
”rÜ
);

211  
FALSE
;

217 
ccb
 
ÿm_ccb
;

218 
scsi_dœeùiÚ
[] = { 
CAM_DIR_NONE
, 
CAM_DIR_IN
, 
CAM_DIR_OUT
 };

220 
	`mem£t
(&
ÿm_ccb
, 0, (cam_ccb));

222 
ÿm_ccb
.
ccb_h
.
·th_id
 = 
cdrom
->
ÿm
->path_id;

223 
ÿm_ccb
.
ccb_h
.
rg‘_id
 = 
cdrom
->
ÿm
->target_id;

224 
ÿm_ccb
.
ccb_h
.
rg‘_lun
 = 
cdrom
->
ÿm
->target_lun;

226 
	`ÿm_fl_csio
(&
ÿm_ccb
.
csio
,

228 
NULL
,

229 
scsi_dœeùiÚ
[
dœeùiÚ
],

230 
MSG_SIMPLE_Q_TAG
,

231 
d©a
,

232 
Ën
,

233 (
ÿm_ccb
.
csio
.
£n£_d©a
),

234 
ccb_Ën
,

235 
timeout
 * 1000);

237 
	`memıy
(
ÿm_ccb
.
csio
.
cdb_io
.
cdb_by‹s
, 
ccb
, 16);

239 ià(
	`ÿm_£nd_ccb
(
cdrom
->
ÿm
, &
ÿm_ccb
) == -1)

241 ià(
”r
)

242 *
”r
 = 
	`hå_¡rdup_´štf
("ÿm_£nd_ccb(èçu»: %s", 
	`¡»¼Ü
(
”ºo
));

244 ià((
ÿm_ccb
.
ccb_h
.
¡©us
 & 
CAM_STATUS_MASK
è!ğ
CAM_REQ_CMP
)

246 ià(
”r
)

247 *
”r
 = 
	`hå_¡rdup_´štf
("CCB„eque¡ faed w™h stu %i", 
ÿm_ccb
.
ccb_h
.
¡©us
 & 
CAM_STATUS_MASK
);

248  
FALSE
;

252  
TRUE
;

253 
	}
}

255 
boŞ—n


256 
	$hå_cdrom_‹¡_un™_»ady
 (
HFPCDROM
 *
cdrom
)

258 
ccb
[16] = { 
HFP_CDROM_TEST_UNIT_READY
 };

260 
	`as£¹
(
cdrom
 !ğ
NULL
);

262  
	`hå_cdrom_£nd_ccb
(
cdrom
, 
ccb
, 6, 
HFP_CDROM_DIRECTION_NONE
, 
NULL
, 0, NULL);

263 
	}
}

266 
	$hå_cdrom_ä“
 (
HFPCDROM
 *
cdrom
)

268 
	`as£¹
(
cdrom
 !ğ
NULL
);

270 ià(
cdrom
->
ÿm
)

271 
	`ÿm_şo£_deviû
(
cdrom
->
ÿm
);

272 ià(
cdrom
->
fd_owÃd
 && cdrom->
fd
 >= 0)

273 
	`şo£
(
cdrom
->
fd
);

275 
	`hå_ä“
(
cdrom
);

276 
	}
}

	@hald/freebsd/libprobe/hfp-cdrom.h

24 #iâdeà
_HFP_CDROM_H


25 
	#_HFP_CDROM_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<sys/ty³s.h
>

33 
	~"hå.h
"

35 
_HFPCDROM
 
	tHFPCDROM
;

39 
	mHFP_CDROM_DIRECTION_NONE
,

40 
	mHFP_CDROM_DIRECTION_IN
,

41 
	mHFP_CDROM_DIRECTION_OUT


42 } 
	tHFPCDROMDœeùiÚ
;

47 
	mHFP_CDROM_TEST_UNIT_READY
 = 0x00,

48 
	mHFP_CDROM_GET_EVENT_STATUS_NOTIFICATION
 = 0x4a,

49 
	mHFP_CDROM_MODE_SENSE_BIG
 = 0x5a

56 
u_št16_t
 
	md©a_Ëngth
;

57 
u_št8_t
 
	mmedium_ty³
;

58 
	#HFP_CDROM_MST_TYPE_MASK_LOW
 0x0f

	)

59 
	#HFP_CDROM_MST_FMT_NONE
 0x00

	)

60 
	#HFP_CDROM_MST_DATA_120
 0x01

	)

61 
	#HFP_CDROM_MST_AUDIO_120
 0x02

	)

62 
	#HFP_CDROM_MST_COMB_120
 0x03

	)

63 
	#HFP_CDROM_MST_PHOTO_120
 0x04

	)

64 
	#HFP_CDROM_MST_DATA_80
 0x05

	)

65 
	#HFP_CDROM_MST_AUDIO_80
 0x06

	)

66 
	#HFP_CDROM_MST_COMB_80
 0x07

	)

67 
	#HFP_CDROM_MST_PHOTO_80
 0x08

	)

69 
	#HFP_CDROM_MST_TYPE_MASK_HIGH
 0x70

	)

70 
	#HFP_CDROM_MST_CDROM
 0x00

	)

71 
	#HFP_CDROM_MST_CDR
 0x10

	)

72 
	#HFP_CDROM_MST_CDRW
 0x20

	)

74 
	#HFP_CDROM_MST_NO_DISC
 0x70

	)

75 
	#HFP_CDROM_MST_DOOR_OPEN
 0x71

	)

76 
	#HFP_CDROM_MST_FMT_ERROR
 0x72

	)

78 
u_št8_t
 
	mdev_¥ec
;

79 
u_št16_t
 
	munu£d
;

80 
u_št16_t
 
	mblk_desc_Ën
;

83 
u_št8_t
 
	m·ge_code
;

84 
	#HFP_CDROM_CAP_PAGE
 0x2a

	)

86 
u_št8_t
 
	m·¿m_Ën
;

88 
u_št16_t
 
	mmedŸ
;

89 
	#HFP_CDROM_MST_READ_CDR
 0x0001

	)

90 
	#HFP_CDROM_MST_READ_CDRW
 0x0002

	)

91 
	#HFP_CDROM_MST_READ_PACKET
 0x0004

	)

92 
	#HFP_CDROM_MST_READ_DVDROM
 0x0008

	)

93 
	#HFP_CDROM_MST_READ_DVDR
 0x0010

	)

94 
	#HFP_CDROM_MST_READ_DVDRAM
 0x0020

	)

95 
	#HFP_CDROM_MST_WRITE_CDR
 0x0100

	)

96 
	#HFP_CDROM_MST_WRITE_CDRW
 0x0200

	)

97 
	#HFP_CDROM_MST_WRITE_TEST
 0x0400

	)

98 
	#HFP_CDROM_MST_WRITE_DVDR
 0x1000

	)

99 
	#HFP_CDROM_MST_WRITE_DVDRAM
 0x2000

	)

101 
u_št16_t
 
	mÿ·b™›s
;

102 
	#HFP_CDROM_MSTAUDIO_PLAY
 0x0001

	)

103 
	#HFP_CDROM_MST_COMPOSITE
 0x0002

	)

104 
	#HFP_CDROM_MST_AUDIO_P1
 0x0004

	)

105 
	#HFP_CDROM_MST_AUDIO_P2
 0x0008

	)

106 
	#HFP_CDROM_MST_MODE2_f1
 0x0010

	)

107 
	#HFP_CDROM_MST_MODE2_f2
 0x0020

	)

108 
	#HFP_CDROM_MST_MULTISESSION
 0x0040

	)

109 
	#HFP_CDROM_MST_BURNPROOF
 0x0080

	)

110 
	#HFP_CDROM_MST_READ_CDDA
 0x0100

	)

111 
	#HFP_CDROM_MST_CDDA_STREAM
 0x0200

	)

112 
	#HFP_CDROM_MST_COMBINED_RW
 0x0400

	)

113 
	#HFP_CDROM_MST_CORRECTED_RW
 0x0800

	)

114 
	#HFP_CDROM_MST_SUPPORT_C2
 0x1000

	)

115 
	#HFP_CDROM_MST_ISRC
 0x2000

	)

116 
	#HFP_CDROM_MST_UPC
 0x4000

	)

118 
u_št8_t
 
	mmechªism
;

119 
	#HFP_CDROM_MST_LOCKABLE
 0x01

	)

120 
	#HFP_CDROM_MST_LOCKED
 0x02

	)

121 
	#HFP_CDROM_MST_PREVENT
 0x04

	)

122 
	#HFP_CDROM_MST_EJECT
 0x08

	)

123 
	#HFP_CDROM_MST_MECH_MASK
 0xe0

	)

124 
	#HFP_CDROM_MST_MECH_CADDY
 0x00

	)

125 
	#HFP_CDROM_MST_MECH_TRAY
 0x20

	)

126 
	#HFP_CDROM_MST_MECH_POPUP
 0x40

	)

127 
	#HFP_CDROM_MST_MECH_CHANGER
 0x80

	)

128 
	#HFP_CDROM_MST_MECH_CARTRIDGE
 0xa0

	)

130 
ušt8_t
 
	maudio
;

131 
	#HFP_CDROM_MST_SEP_VOL
 0x01

	)

132 
	#HFP_CDROM_MST_SEP_MUTE
 0x02

	)

134 
u_št16_t
 
	mmax_»ad_¥“d
;

135 
u_št16_t
 
	mmax_vŞ_Ëv–s
;

136 
u_št16_t
 
	mbuf_size
;

137 
u_št16_t
 
	mcur_»ad_¥“d
;

139 
u_št8_t
 
	m»£rved3
;

140 
u_št8_t
 
	mmisc
;

142 
u_št16_t
 
	mmax_wr™e_¥“d
;

143 
u_št16_t
 
	mcur_wr™e_¥“d
;

144 
u_št16_t
 
	mcİy_´Ùeù_»v
;

145 
u_št16_t
 
	m»£rved4
;

146 } 
	tHFPCDROMC­ab™›s
;

148 
HFPCDROM
 *
hå_cdrom_Ãw
 (cÚ¡ *
·th
, cÚ¡ *
·»Á
);

149 
HFPCDROM
 *
hå_cdrom_Ãw_äom_fd
 (
fd
, cÚ¡ *
·th
, cÚ¡ *
·»Á
);

151 
boŞ—n
 
hå_cdrom_£nd_ccb
 (
HFPCDROM
 *
cdrom
,

152 cÚ¡ *
ccb
,

153 
ccb_Ën
,

154 
HFPCDROMDœeùiÚ
 
dœeùiÚ
,

155 *
d©a
,

156 
Ën
,

157 **
”r
);

159 
boŞ—n
 
hå_cdrom_‹¡_un™_»ady
 (
HFPCDROM
 *
cdrom
);

161 
hå_cdrom_ä“
 (
HFPCDROM
 *
cdrom
);

	@hald/freebsd/libprobe/hfp.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<sy¦og.h
>

29 
	~<¡d¬g.h
>

30 
	~<¡dio.h
>

31 
	~<¡ršg.h
>

32 
	~<¡dlib.h
>

33 
	~<as£¹.h
>

34 
	~<libg’.h
>

36 
	~"hå.h
"

38 
LibH®CÚ‹xt
 *
	ghå_ùx
 = 
NULL
;

39 *
	ghå_udi
 = 
NULL
;

40 
DBusE¼Ü
 
	ghå_”rÜ
;

42 *
	glog_domaš
;

43 
boŞ—n
 
	gv”bo£
 = 
FALSE
;

44 
boŞ—n
 
	gu£_sy¦og
 = 
FALSE
;

46 
boŞ—n


47 
	$hå_š™
 (
¬gc
, **
¬gv
)

49 *
p¢ame
 = 
NULL
;

51 
	`as£¹
(
hå_ùx
 =ğ
NULL
);

53 ià(
¬gc
 > 0)

54 
p¢ame
 = 
	`ba£Çme
(
¬gv
[0]);

56 ià(
p¢ame
)

57 
log_domaš
 = 
	`hå_¡rdup
(
p¢ame
);

59 
log_domaš
 = "hfp";

61 ià(
	`g‘’v
("HALD_VERBOSE"))

62 
v”bo£
 = 
TRUE
;

63 ià(
	`g‘’v
("HALD_USE_SYSLOG"))

64 
u£_sy¦og
 = 
TRUE
;

66 
hå_udi
 = 
	`g‘’v
("UDI");

67 ià(! 
hå_udi
)

68  
FALSE
;

70 
	`dbus_”rÜ_š™
(&
hå_”rÜ
);

71 
hå_ùx
 = 
	`libh®_ùx_š™_dœeù
(&
hå_”rÜ
);

72 
	`dbus_”rÜ_ä“
(&
hå_”rÜ
);

74  
TRUE
;

75 
	}
}

78 
	$hå_no_memÜy
 ()

80 
	`hå_ü™iÿl
("memory‡llocation failure");

81 
	`abÜt
();

82 
	}
}

85 
	$hå_m®loc
 (
size_t
 
size
)

87 *
mem
;

89 
mem
 = 
	`m®loc
(
size
);

90 ià(! 
mem
)

91 
	`hå_no_memÜy
();

93  
mem
;

94 
	}
}

97 
	$hå_m®loc0
 (
size_t
 
size
)

99 *
mem
;

101 
mem
 = 
	`ÿÎoc
(1, 
size
);

102 ià(! 
mem
)

103 
	`hå_no_memÜy
();

105  
mem
;

106 
	}
}

109 
	$hå_¡rdup
 (cÚ¡ *
¡r
)

111 *
cİy
;

113 ià(
¡r
)

115 
cİy
 = 
	`¡rdup
(
¡r
);

116 ià(! 
cİy
)

117 
	`hå_no_memÜy
();

120 
cİy
 = 
NULL
;

122  
cİy
;

123 
	}
}

126 
	$hå_¡ºdup
 (cÚ¡ *
¡r
, 
size_t
 
size
)

128 *
cİy
;

130 ià(
¡r
)

132 
cİy
 = 
	`hå_Ãw
(, 
size
 + 1);

133 
	`¡ºıy
(
cİy
, 
¡r
, 
size
);

134 
cİy
[
size
] = 0;

137 
cİy
 = 
NULL
;

139  
cİy
;

140 
	}
}

143 
	$hå_¡rdup_´štf
 (cÚ¡ *
fÜm©
, ...)

145 
va_li¡
 
¬gs
;

146 *
¡r
;

148 
	`as£¹
(
fÜm©
 !ğ
NULL
);

150 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

151 ià(
	`va¥rštf
(&
¡r
, 
fÜm©
, 
¬gs
) == -1)

152 
	`hå_no_memÜy
();

153 
	`va_’d
(
¬gs
);

155  
¡r
;

156 
	}
}

159 
	$hå_ä“
 (*
mem
)

161 ià(
mem
)

162 
	`ä“
(
mem
);

163 
	}
}

166 
	$hå_logv
 (
HFPLogLev–
 
log_Ëv–
, cÚ¡ *
fÜm©
, 
va_li¡
 
¬gs
)

168 
	`as£¹
(
log_Ëv–
 =ğ
HFP_LOG_LEVEL_DEBUG


169 || 
log_Ëv–
 =ğ
HFP_LOG_LEVEL_INFO


170 || 
log_Ëv–
 =ğ
HFP_LOG_LEVEL_WARNING


171 || 
log_Ëv–
 =ğ
HFP_LOG_LEVEL_CRITICAL
);

172 
	`as£¹
(
fÜm©
 !ğ
NULL
);

174 ià(
v”bo£
)

176 cÚ¡ *
log_Ëv–s
[] = { "debug", "info", "WARNING", "CRITICAL" };

177 cÚ¡ 
sy¦og_Ëv–s
[] = { 
LOG_DEBUG
, 
LOG_INFO
, 
LOG_WARNING
, 
LOG_CRIT
 };

178 ià(
u£_sy¦og
)

179 
	`vsy¦og
(
sy¦og_Ëv–s
[
log_Ëv–
], 
fÜm©
, 
¬gs
);

182 
	`årštf
(
¡d”r
, "% %s: ", 
log_domaš
, 
log_Ëv–s
[
log_Ëv–
]);

183 
	`vårštf
(
¡d”r
, 
fÜm©
, 
¬gs
);

184 
	`årštf
(
¡d”r
, "\n");

187 
	}
}

189 
	#LOG_FUNCTION
(
Çme
, 
Ëv–
) \

190 
	`Çme
 (cÚ¡ *
fÜm©
, ...) \

192 
va_li¡
 
¬gs
; \

194 
	`as£¹
(
fÜm©
 !ğ
NULL
); \

196 
	`va_¡¬t
(
¬gs
, 
fÜm©
); \

197 
	`hå_logv
(
HFP_LOG_LEVEL_
 ## 
Ëv–
, 
fÜm©
, 
¬gs
); \

198 
	`va_’d
(
¬gs
); \

199 }

	)

201 
	$LOG_FUNCTION
(
hå_šfo
, 
INFO
)

202 
	$LOG_FUNCTION
(
hå_w¬nšg
, 
WARNING
)

203 
	$LOG_FUNCTION
(
hå_ü™iÿl
, 
CRITICAL
)

204 
	$LOG_FUNCTION
(
vŞume_id_log
, 
DEBUG
)

206 
boŞ—n


207 
	$hå_g‘’v_boŞ
 (cÚ¡ *
v¬ŸbË
)

209 *
v®ue
;

211 
	`as£¹
(
v¬ŸbË
 !ğ
NULL
);

213 
v®ue
 = 
	`g‘’v
(
v¬ŸbË
);

215  
v®ue
 && ! 
	`¡rcmp
(value, "true");

216 
	}
}

219 
	$hå_g‘timeofday
 (
timev®
 *
t
)

221 
¡©us
;

223 
	`as£¹
(
t
 !ğ
NULL
);

225 
¡©us
 = 
	`g‘timeofday
(
t
, 
NULL
);

226 
	`as£¹
(
¡©us
 == 0);

227 
	}
}

232 
	$hå_timev®fix
 (
timev®
 *
t
)

234 
	`as£¹
(
t
 !ğ
NULL
);

236 ià(
t
->
tv_u£c
 < 0)

238 
t
->
tv_£c
--;

239 
t
->
tv_u£c
 += 1000000;

241 ià(
t
->
tv_u£c
 >= 1000000)

243 
t
->
tv_£c
++;

244 
t
->
tv_u£c
 -= 1000000;

246 
	}
}

249 
	$hå_timev®add
 (
timev®
 *
t1
, cÚ¡ timev® *
t2
)

251 
	`as£¹
(
t1
 !ğ
NULL
);

252 
	`as£¹
(
t2
 !ğ
NULL
);

254 
t1
->
tv_£c
 +ğ
t2
->tv_sec;

255 
t1
->
tv_u£c
 +ğ
t2
->tv_usec;

257 
	`hå_timev®fix
(
t1
);

258 
	}
}

261 
	$hå_timev®sub
 (
timev®
 *
t1
, cÚ¡ timev® *
t2
)

263 
	`as£¹
(
t1
 !ğ
NULL
);

264 
	`as£¹
(
t2
 !ğ
NULL
);

266 
t1
->
tv_£c
 -ğ
t2
->tv_sec;

267 
t1
->
tv_u£c
 -ğ
t2
->tv_usec;

269 
	`hå_timev®fix
(
t1
);

270 
	}
}

	@hald/freebsd/libprobe/hfp.h

24 #iâdeà
_HFP_H


25 
	#_HFP_H


	)

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡d¬g.h
>

32 
	~<sys/ty³s.h
>

33 
	~<sys/time.h
>

35 
	~"libh®/libh®.h
"

38 #ià
__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 > 4)

39 
	#HFP_GNUC_PRINTF
(
fÜm©_idx
, 
¬g_idx
) \

40 
	`__©Œibu‹__
((
	`__fÜm©__
(
__´štf__
, 
fÜm©_idx
, 
¬g_idx
)))

	)

42 
	#HFP_GNUC_PRINTF
(
fÜm©_idx
, 
¬g_idx
)

	)

46 
	#HFP_N_ELEMENTS
(
¬r
è(×¼è/ (×¼)[0]))

	)

48 
	tboŞ—n
;

52 
	mHFP_LOG_LEVEL_DEBUG
,

53 
	mHFP_LOG_LEVEL_INFO
,

54 
	mHFP_LOG_LEVEL_WARNING
,

55 
	mHFP_LOG_LEVEL_CRITICAL


56 } 
	tHFPLogLev–
;

58 
LibH®CÚ‹xt
 *
hå_ùx
;

59 *
hå_udi
;

60 
DBusE¼Ü
 
hå_”rÜ
;

62 
boŞ—n
 
hå_š™
 (
¬gc
, **
¬gv
);

64 *
hå_m®loc
 (
size_t
 
size
);

65 *
hå_m®loc0
 (
size_t
 
size
);

67 
	#hå_Ãw
(
ty³
, 
numb”
è(Ñy³ *è
	`hå_m®loc
(Ñy³è*‚umb”))

	)

68 
	#hå_Ãw0
(
ty³
, 
numb”
è(Ñy³ *è
	`hå_m®loc0
(Ñy³è*‚umb”))

	)

70 *
hå_¡rdup
 (cÚ¡ *
¡r
);

71 *
hå_¡ºdup
 (cÚ¡ *
¡r
, 
size_t
 
size
);

72 *
	$hå_¡rdup_´štf
 (cÚ¡ *
fÜm©
, ...è
	`HFP_GNUC_PRINTF
(1, 2);

74 
	`hå_ä“
 (*
mem
);

76 
	`hå_logv
 (
HFPLogLev–
 
log_Ëv–
, cÚ¡ *
fÜm©
, 
va_li¡
 
¬gs
);

78 
	$hå_šfo
 (cÚ¡ *
fÜm©
, ...è
	`HFP_GNUC_PRINTF
(1, 2);

79 
	$hå_w¬nšg
 (cÚ¡ *
fÜm©
, ...è
	`HFP_GNUC_PRINTF
(1, 2);

80 
	$hå_ü™iÿl
 (cÚ¡ *
fÜm©
, ...è
	`HFP_GNUC_PRINTF
(1, 2);

83 
	$vŞume_id_log
 (cÚ¡ *
fÜm©
, ...è
	`HFP_GNUC_PRINTF
(1, 2);

85 
boŞ—n
 
	`hå_g‘’v_boŞ
 (cÚ¡ *
v¬ŸbË
);

87 
	`hå_g‘timeofday
 (
timev®
 *
t
);

88 
	`hå_timev®add
 (
timev®
 *
t1
, cÚ¡ timev® *
t2
);

89 
	`hå_timev®sub
 (
timev®
 *
t1
, cÚ¡ timev® *
t2
);

92 
	#hå_timev®cmp
(
t1
, 
t2
, 
cmp
) \

93 (((
t1
)->
tv_£c
 =ğ(
t2
)->tv_sec \

94 ? ((
t1
)->
tv_u£c
 
	`cmp
 (
t2
)->tv_usec) \

95 : ((
t1
)->
tv_£c
 
	`cmp
 (
t2
)->tv_£c)))

	)

	@hald/freebsd/osspec.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

30 
	~"../ids.h
"

31 
	~"../logg”.h
"

32 
	~"../os¥ec.h
"

34 
	~"hf-ut.h
"

35 
	~"hf-os¥ec.h
"

36 
	~"hf-aıi.h
"

37 
	~"hf-©a.h
"

38 
	~"hf-compu‹r.h
"

39 
	~"hf-devd.h
"

40 
	~"hf-devŒ“.h
"

41 
	~"hf-drm.h
"

42 
	~"hf-Ãt.h
"

43 
	~"hf-pci.h
"

44 
	~"hf-scsi.h
"

45 
	~"hf-£rŸl.h
"

46 
	~"hf-sound.h
"

47 
	~"hf-¡Üage.h
"

48 
	~"hf-usb.h
"

49 
	~"hf-vŞume.h
"

52 
HFHªdËr
 *
	ghªdËrs
[] = {

53 &
hf_pci_hªdËr
,

54 &
hf_devŒ“_hªdËr
,

55 &
hf_usb_hªdËr
,

56 &
hf_©a_hªdËr
,

57 &
hf_scsi_hªdËr
,

58 &
hf_¡Üage_hªdËr
,

59 &
hf_vŞume_hªdËr
,

60 &
hf_Ãt_hªdËr
,

61 &
hf_£rŸl_hªdËr
,

62 &
hf_aıi_hªdËr
,

63 &
hf_sound_hªdËr
,

64 &
hf_drm_hªdËr
,

65 &
hf_devd_hªdËr


68 
H®FeMÚ™Ü
 *
	gfe_mÚ™Ü
 = 
NULL
;

70 
H®FeMÚ™Ü
 *

71 
	$os¥ec_g‘_fe_mÚ™Ü
 ()

73  
fe_mÚ™Ü
;

74 
	}
}

77 
	$os¥ec_´iveged_š™
 ()

79 
i
;

81 
fe_mÚ™Ü
 = 
	`h®_fe_mÚ™Ü_Ãw
 ();

82 ià(
fe_mÚ™Ü
 =ğ
NULL
)

84 
	`HAL_INFO
(("Cannot initialize file monitor"));

87 
i
 = 0; i < (è
	`G_N_ELEMENTS
(
hªdËrs
); i++)

88 ià(
hªdËrs
[
i
]->
´iveged_š™
)

89 
hªdËrs
[
i
]->
	`´iveged_š™
();

90 
	}
}

93 
	$os¥ec_š™
 ()

95 
i
;

97 
	`pci_ids_š™
();

99 
i
 = 0; i < (è
	`G_N_ELEMENTS
(
hªdËrs
); i++)

100 ià(
hªdËrs
[
i
]->
š™
)

101 
hªdËrs
[
i
]->
	`š™
();

102 
	}
}

105 
	$os¥ec_´obe
 ()

107 ià(
	`hf_compu‹r_deviû_add
())

109 
i
;

111 
i
 = 0; i < (è
	`G_N_ELEMENTS
(
hªdËrs
); i++)

112 ià(
hªdËrs
[
i
]->
´obe
)

113 
hªdËrs
[
i
]->
	`´obe
();

116 ià(
h®d_is_š™Ÿlisšg
)

117 
	`os¥ec_´obe_dÚe
();

118 
	}
}

120 
gboŞ—n


121 
	$os¥ec_deviû_»sÿn
 (
H®Deviû
 *
d
)

123 
i
;

125 
i
 = 0; i < (è
	`G_N_ELEMENTS
(
hªdËrs
); i++)

126 ià(
hªdËrs
[
i
]->
deviû_»sÿn
 && hªdËrs[i]->
	`deviû_»sÿn
(
d
))

127  
TRUE
;

129  
FALSE
;

130 
	}
}

132 
gboŞ—n


133 
	$os¥ec_deviû_»´obe
 (
H®Deviû
 *
d
)

135 
i
;

137 
i
 = 0; i < (è
	`G_N_ELEMENTS
(
hªdËrs
); i++)

138 ià(
hªdËrs
[
i
]->
deviû_»´obe
 && hªdËrs[i]->
	`deviû_»´obe
(
d
))

139 
’d
;

143 
	`hf_deviû_»move_Œ“
(
d
);

144 
	`os¥ec_´obe
();

146 
’d
:

147  
FALSE
;

148 
	}
}

151 
	$os¥ec_»äesh_mouÁ_¡©e_fÜ_block_deviû
 (
H®Deviû
 *
d
)

153 
	`hf_vŞume_upd©e_mouÁ
(
d
);

154 
	}
}

156 
DBusHªdËrResuÉ


157 
	$os¥ec_f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£r_d©a
)

159  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

160 
	}
}

	@hald/freebsd/probing/freebsd_dvd_rw_utils.c

10 
	~<¡dio.h
>

11 
	~<¡ršg.h
>

12 
	~<¡dlib.h
>

13 
	~<sys/ty³s.h
>

14 
	~<sys/©a.h
>

16 
	~<glib.h
>

18 
	~"ä“bsd_dvd_rw_uts.h
"

21 
	mNONE
 = 
HFP_CDROM_DIRECTION_NONE
,

22 
	mREAD
 = 
HFP_CDROM_DIRECTION_IN
,

23 
	mWRITE
 = 
HFP_CDROM_DIRECTION_OUT


24 } 
	tDœeùiÚ
;

26 
ScsiCommªd
 
	tScsiCommªd
;

28 
	sScsiCommªd
 {

29 
HFPCDROM
 *
	mcdrom
;

30 
	mccb
[16];

31 
	mËn
;

34 
ScsiCommªd
 *

35 
	$scsi_commªd_Ãw_äom_cdrom
 (
HFPCDROM
 *
cdrom
)

37 
ScsiCommªd
 *
cmd
;

39 
cmd
 = 
	`g_Ãw0
 (
ScsiCommªd
, 1);

40 
cmd
->
cdrom
 = cdrom;

42  
cmd
;

43 
	}
}

46 
	$scsi_commªd_ä“
 (
ScsiCommªd
 * 
cmd
)

48 
	`ä“
 (
cmd
);

49 
	}
}

52 
	$scsi_commªd_š™
 (
ScsiCommªd
 * 
cmd
, 
size_t
 
i
, 
¬g
)

54 
cmd
->
ccb
[
i
] = 
¬g
;

55 ià(
i
 =ğ0 || i >ğ
cmd
->
Ën
)

56 
cmd
->
Ën
 = 
i
 + 1;

57 
	}
}

60 
	$scsi_commªd_Œª¥Üt
 (
ScsiCommªd
 * 
cmd
, 
DœeùiÚ
 
dœ
, *
buf
,

61 
size_t
 
sz
)

63 ià(
	`hå_cdrom_£nd_ccb
(
cmd
->
cdrom
, cmd->
ccb
, cmd->
Ën
, 
dœ
, 
buf
, 
sz
, 
NULL
))

67 
	}
}

70 
	$g‘_dvd_r_rw_´ofe
 (
HFPCDROM
 *
cdrom
)

72 
ScsiCommªd
 *
cmd
;

73 
»tv®
 = 0;

74 
·ge
[20];

75 *
li¡
;

76 
i
, 
Ën
;

78 
	`g_»tuº_v®_if_ç
 (
cdrom
 !ğ
NULL
, -1);

80 
cmd
 = 
	`scsi_commªd_Ãw_äom_cdrom
 (
cdrom
);

82 
	`scsi_commªd_š™
 (
cmd
, 0, 0x46);

83 
	`scsi_commªd_š™
 (
cmd
, 1, 2);

84 
	`scsi_commªd_š™
 (
cmd
, 8, 8);

85 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

86 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
·ge
, 8)) {

88 
	`scsi_commªd_ä“
 (
cmd
);

93 
Ën
 = 4 + (
·ge
[0] << 24 |…age[1] << 16 |…age[2] << 8 |…age[3]);

94 ià(
Ën
 > 264) {

95 
	`scsi_commªd_ä“
 (
cmd
);

100 
li¡
 = 
	`g_Ãw
 (, 
Ën
);

102 
	`scsi_commªd_š™
 (
cmd
, 0, 0x46);

103 
	`scsi_commªd_š™
 (
cmd
, 1, 2);

104 
	`scsi_commªd_š™
 (
cmd
, 7, 
Ën
 >> 8);

105 
	`scsi_commªd_š™
 (
cmd
, 8, 
Ën
);

106 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

107 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
li¡
, 
Ën
)) {

109 
	`scsi_commªd_ä“
 (
cmd
);

110 
	`ä“
 (
li¡
);

114 
i
 = 12; i < 
li¡
[11]; i += 4) {

115 
´ofe
 = (
li¡
[
i
] << 8 |†ist[i + 1]);

131 
´ofe
) {

134 
»tv®
 |ğ
DRIVE_CDROM_CAPS_DVDRW
;

137 
»tv®
 |ğ
DRIVE_CDROM_CAPS_DVDPLUSR
;

140 
»tv®
 |ğ
DRIVE_CDROM_CAPS_DVDPLUSRW
;

143 
»tv®
 |ğ
DRIVE_CDROM_CAPS_DVDPLUSRWDL
;

146 
»tv®
 |ğ
DRIVE_CDROM_CAPS_DVDPLUSRDL
;

149 
»tv®
 |ğ
DRIVE_CDROM_CAPS_BDROM
;

153 
»tv®
 |ğ
DRIVE_CDROM_CAPS_BDR
;

156 
»tv®
 |ğ
DRIVE_CDROM_CAPS_BDRE
;

159 
»tv®
 |ğ
DRIVE_CDROM_CAPS_HDDVDROM
;

162 
»tv®
 |ğ
DRIVE_CDROM_CAPS_HDDVDR
;

165 
»tv®
 |ğ
DRIVE_CDROM_CAPS_HDDVDRW
;

172 
	`scsi_commªd_ä“
 (
cmd
);

173 
	`ä“
 (
li¡
);

175  
»tv®
;

177 
	}
}

180 
	$puÎ_·ge2a_äom_cdrom
 (
HFPCDROM
 *
cdrom
)

182 
ScsiCommªd
 *
cmd
;

183 
h—d”
[12], *
·ge2A
;

184 
Ën
, 
bdËn
;

186 
	`g_»tuº_v®_if_ç
 (
cdrom
 !ğ
NULL
, NULL);

188 
cmd
 = 
	`scsi_commªd_Ãw_äom_cdrom
 (
cdrom
);

190 
	`scsi_commªd_š™
 (
cmd
, 0, 0x5A);

191 
	`scsi_commªd_š™
 (
cmd
, 1, 0x08);

192 
	`scsi_commªd_š™
 (
cmd
, 2, 0x2A);

193 
	`scsi_commªd_š™
 (
cmd
, 8,  (
h—d”
));

194 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

196 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
h—d”
,  (header))) {

198 
	`scsi_commªd_ä“
 (
cmd
);

199  
NULL
;

202 
Ën
 = (
h—d”
[0] << 8 | header[1]) + 2;

203 
bdËn
 = 
h—d”
[6] << 8 | header[7];

206 ià(
bdËn
) {

207 ià(
Ën
 < (8 + 
bdËn
 + 30)) {

209 
	`scsi_commªd_ä“
 (
cmd
);

210  
NULL
;

212 } ià(
Ën
 < (8 + 2 + (è
h—d”
[9])) {

214 
Ën
 = 8 + 2 + 
h—d”
[9];

217 
·ge2A
 = 
	`g_Ãw
 (, 
Ën
);

218 ià(
·ge2A
 =ğ
NULL
) {

220 
	`scsi_commªd_ä“
 (
cmd
);

221  
NULL
;

224 
	`scsi_commªd_š™
 (
cmd
, 0, 0x5A);

225 
	`scsi_commªd_š™
 (
cmd
, 1, 0x08);

226 
	`scsi_commªd_š™
 (
cmd
, 2, 0x2A);

227 
	`scsi_commªd_š™
 (
cmd
, 7, 
Ën
 >> 8);

228 
	`scsi_commªd_š™
 (
cmd
, 8, 
Ën
);

229 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

230 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
·ge2A
, 
Ën
)) {

232 
	`scsi_commªd_ä“
 (
cmd
);

233 
	`ä“
 (
·ge2A
);

234  
NULL
;

237 
	`scsi_commªd_ä“
 (
cmd
);

239 
Ën
 -= 2;

241 ià(
Ën
 < ((è
·ge2A
[0] << 8 |…age2A[1])) {

242 
·ge2A
[0] = 
Ën
 >> 8;

243 
·ge2A
[1] = 
Ën
;

246  
·ge2A
;

247 
	}
}

250 
	$št_com·»
 (cÚ¡ *
a
, cÚ¡ *
b
)

253  *((*è
b
è- *((*è
a
);

254 
	}
}

260 
	$g‘_wr™e_¥“ds
 (cÚ¡ *
p
, 
Ëngth
, 
max_¥“d
)

262 *
»suÉ
, *
¡r
;

263 
Ä_»cÜds
;

264 *
tmp¥“ds
;

265 
i
, 
j
;

267 
»suÉ
 = 
NULL
;

270 ià(
Ëngth
 < 32)

271  
NULL
;

273 
Ä_»cÜds
 = 
p
[30] << 8 |…[31];

276 ià(
Ëngth
 < 32 + 4 * 
Ä_»cÜds
)

277  
NULL
;

279 
tmp¥“ds
 = 
	`g_Ãw
 (, 
Ä_»cÜds
);

281 
i
 = 0; i < 
Ä_»cÜds
; i++)

283 
tmp¥“ds
[
i
] = 
p
[4*i + 34] << 8 |…[4*i + 35];

288 ià(
tmp¥“ds
[
i
] == 0)

289 
ä“_tmp¥“ds
;

293 
	`qsÜt
 (
tmp¥“ds
, 
Ä_»cÜds
,  (), 
št_com·»
);

296 
i
 = 
j
 = 0; i < 
Ä_»cÜds
; i++)

298 
tmp¥“ds
[
j
] =mp¥“ds[
i
];

301 ià(
i
 >ğ(
Ä_»cÜds
 - 1è|| 
tmp¥“ds
[i+1] !=mpspeeds[i])

302 
j
++;

306 ià(
j
 == 0)

308 
ä“_tmp¥“ds
;

314 ià(
tmp¥“ds
[0] !ğ
max_¥“d
)

316 
ä“_tmp¥“ds
;

322 
»suÉ
 = 
¡r
 = 
	`g_Ãw
 (, 8 * 
j
);

324 
i
 = 0; i < 
j
; i++)

326 ià(
i
 > 0)

327 *(
¡r
++) = ',';

329 
¡r
 +ğ
	`¥rštf
 (¡r, "%d", 
tmp¥“ds
[
i
]);

332 
ä“_tmp¥“ds
:

333 
	`ä“
 (
tmp¥“ds
);

335  
»suÉ
;

336 
	}
}

339 
	$g‘_»ad_wr™e_¥“d
 (
HFPCDROM
 *
cdrom
, *
»ad_¥“d
, *
wr™e_¥“d
, **
wr™e_¥“ds
)

341 *
·ge2A
;

342 
Ën
, 
hËn
;

343 *
p
;

345 
	`g_»tuº_v®_if_ç
 (
cdrom
 !ğ
NULL
, -1);

347 *
»ad_¥“d
 = 0;

348 *
wr™e_¥“d
 = 0;

349 *
wr™e_¥“ds
 = 
NULL
;

351 
·ge2A
 = 
	`puÎ_·ge2a_äom_cdrom
 (
cdrom
);

352 ià(
·ge2A
 =ğ
NULL
) {

353 
	`´štf
 ("Failedo get Page 2A\n");

358 
Ën
 = (
·ge2A
[0] << 8 |…age2A[1]) + 2;

359 
hËn
 = 8 + (
·ge2A
[6] << 8 |…age2A[7]);

360 
p
 = 
·ge2A
 + 
hËn
;

364 ià(
Ën
 < (
hËn
 + 30è|| 
p
[1] < (30 - 2)) {

367 ià(
Ën
 < (
hËn
 + 20è|| 
p
[1] < (20 - 2))

368 *
wr™e_¥“d
 = 0;

370 *
wr™e_¥“d
 = 
p
[18] << 8 |…[19];

372 *
wr™e_¥“d
 = 
p
[28] << 8 |…[29];

375 ià(
Ën
 >ğ
hËn
+9)

376 *
»ad_¥“d
 = 
p
[8] << 8 |…[9];

378 *
»ad_¥“d
 = 0;

380 *
wr™e_¥“ds
 = 
	`g‘_wr™e_¥“ds
 (
p
, 
Ën
, *
wr™e_¥“d
);

382 
	`ä“
 (
·ge2A
);

385 
	}
}

389 
	$g‘_disc_ÿ·c™y_cd
 (
HFPCDROM
 *
cdrom
, 
gušt64
 *
size
)

391 
ScsiCommªd
 *
cmd
;

392 
»tv®
;

393 
gušt64
 
block_size
;

394 
gušt64
 
num_blocks
;

395 
h—d”
 [8];

397 
	`g_»tuº_v®_if_ç
 (
cdrom
 !ğ
NULL
, -1);

399 
»tv®
 = -1;

401 
cmd
 = 
	`scsi_commªd_Ãw_äom_cdrom
 (
cdrom
);

402 
	`scsi_commªd_š™
 (
cmd
, 0, 0x25);

403 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

404 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
h—d”
, 8)) {

406 
dÚe
;

409 
num_blocks
 = (
h—d”
 [0] << 24) | (header [1] << 16) | (header [2] << 8) | header [3];

410 
num_blocks
++;

411 
block_size
 = 
h—d”
 [4] << 24 | header [5] << 16 | header [6] << 8 | header [7];

413 ià(
size
) {

414 *
size
 = 
num_blocks
 * 
block_size
;

416 
»tv®
 = 0;

418 
dÚe
:

419 
	`scsi_commªd_ä“
 (
cmd
);

421  
»tv®
;

422 
	}
}

425 
	$g‘_disc_ÿ·c™y_cdr
 (
HFPCDROM
 *
cdrom
, 
gušt64
 *
size
)

427 
ScsiCommªd
 *
cmd
;

428 
»tv®
;

429 
gušt64
 
£cs
;

430 
toc
 [8];

431 *
©
;

432 
Ën
;

434 
	`g_»tuº_v®_if_ç
 (
cdrom
 !ğ
NULL
, -1);

436 
»tv®
 = -1;

438 
cmd
 = 
	`scsi_commªd_Ãw_äom_cdrom
 (
cdrom
);

440 
	`scsi_commªd_š™
 (
cmd
, 0, 0x43);

442 
	`scsi_commªd_š™
 (
cmd
, 2, 4 & 0x0F);

443 
	`scsi_commªd_š™
 (
cmd
, 6, 0);

444 
	`scsi_commªd_š™
 (
cmd
, 8, 4);

445 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

447 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
toc
, 4)) {

449 
dÚe
;

452 
Ën
 = 2 + (
toc
 [0] << 8 |oc [1]);

454 
©
 = 
	`g_Ãw
 (, 
Ën
);

456 
	`scsi_commªd_š™
 (
cmd
, 0, 0x43);

457 
	`scsi_commªd_š™
 (
cmd
, 2, 4 & 0x0F);

458 
	`scsi_commªd_š™
 (
cmd
, 6, 0);

459 
	`scsi_commªd_š™
 (
cmd
, 7, 
Ën
 >> 8);

460 
	`scsi_commªd_š™
 (
cmd
, 8, 
Ën
);

461 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

463 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
©
, 
Ën
)) {

465 
	`ä“
 (
©
);

466 
dÚe
;

469 
£cs
 = 
©
 [12] * 60 +‡tip [13] + (atip [14] / 75 + 1);

471 ià(
size
) {

472 *
size
 = (1 + 
£cs
 * 7 / 48) * 1024 * 1024;

474 
»tv®
 = 0;

476 
	`ä“
 (
©
);

477 
dÚe
:

478 
	`scsi_commªd_ä“
 (
cmd
);

480  
»tv®
;

481 
	}
}

484 
	$g‘_disc_ÿ·c™y_dvdr_äom_ty³
 (
HFPCDROM
 *
cdrom
, 
ty³
, 
gušt64
 *
size
)

486 
ScsiCommªd
 *
cmd
;

487 
fÜm©s
 [260];

488 
buf
 [32];

489 
gušt64
 
blocks
;

490 
gušt64
 
nwa
;

491 
i
;

492 
Ën
;

493 
oblig©Üy
;

494 
»tv®
;

495 
Ãxt_Œack
;

497 
	`g_»tuº_v®_if_ç
 (
cdrom
 !ğ
NULL
, -1);

499 
»tv®
 = -1;

500 
blocks
 = 0;

501 
Ãxt_Œack
 = 1;

503 
cmd
 = 
	`scsi_commªd_Ãw_äom_cdrom
 (
cdrom
);

505 
»Œy
:

506 ià(
ty³
 == 0x1A ||ype == 0x14 ||ype == 0x13 ||ype == 0x12) {

509 
	`scsi_commªd_š™
 (
cmd
, 0, 0x23);

510 
	`scsi_commªd_š™
 (
cmd
, 8, 12);

511 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

512 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
fÜm©s
, 12)) {

514 
dÚe
;

517 
Ën
 = 
fÜm©s
 [3];

518 ià(
Ën
 & 7 ||†en < 16) {

520 
dÚe
;

523 
	`scsi_commªd_š™
 (
cmd
, 0, 0x23);

524 
	`scsi_commªd_š™
 (
cmd
, 7, (4 + 
Ën
) >> 8);

525 
	`scsi_commªd_š™
 (
cmd
, 8, (4 + 
Ën
) & 0xFF);

526 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

527 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
fÜm©s
, 4 + 
Ën
)) {

529 
dÚe
;

532 ià(
Ën
 !ğ
fÜm©s
 [3]) {

534 
dÚe
;

538 
oblig©Üy
 = 0x00;

540 
ty³
) {

542 
oblig©Üy
 = 0x26;

545 
i
 = 8, 
Ën
 = 
fÜm©s
 [3]; i <†en; i += 8) {

546 ià((
fÜm©s
 [4 + 
i
 + 4] >> 2è=ğ
oblig©Üy
) {

551 ià(
i
 =ğ
Ën
) {

553 
dÚe
;

556 
blocks
 = 
fÜm©s
 [4 + 
i
 + 0] << 24;

557 
blocks
 |ğ
fÜm©s
 [4 + 
i
 + 1] << 16;

558 
blocks
 |ğ
fÜm©s
 [4 + 
i
 + 2] << 8;

559 
blocks
 |ğ
fÜm©s
 [4 + 
i
 + 3];

560 
nwa
 = 
fÜm©s
 [4 + 5] << 16 | formats [4 + 6] << 8 | formats [4 + 7];

561 ià(
nwa
 > 2048) {

562 
blocks
 *ğ
nwa
 / 2048;

563 } ià(
nwa
 < 2048) {

564 
blocks
 /ğ2048 / 
nwa
;

567 
»tv®
 = 0;

572 
blocks
 = 
fÜm©s
 [4 + 0] << 24;

573 
blocks
 |ğ
fÜm©s
 [4 + 1] << 16;

574 
blocks
 |ğ
fÜm©s
 [4 + 2] << 8;

575 
blocks
 |ğ
fÜm©s
 [4 + 3];

576 
nwa
 = 
fÜm©s
 [4 + 5] << 16 | formats [4 + 6] << 8 | formats [4 + 7];

577 ià(
nwa
 > 2048) {

578 
blocks
 *ğ
nwa
 / 2048;

579 } ià(
nwa
 < 2048) {

580 
blocks
 /ğ2048 / 
nwa
;

583 
»tv®
 = 0;

592 
	`scsi_commªd_š™
 (
cmd
, 0, 0x52);

593 
	`scsi_commªd_š™
 (
cmd
, 1, 1);

594 
	`scsi_commªd_š™
 (
cmd
, 4, 
Ãxt_Œack
 >> 8);

595 
	`scsi_commªd_š™
 (
cmd
, 5, 
Ãxt_Œack
 & 0xFF);

596 
	`scsi_commªd_š™
 (
cmd
, 8,  (
buf
));

597 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

598 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
buf
,  (buf))) {

600 ià(
Ãxt_Œack
 > 0) {

601 
dÚe
;

603 
Ãxt_Œack
 = 1;

604 
»Œy
;

608 
blocks
 = 
buf
 [24] << 24;

609 
blocks
 |ğ
buf
 [25] << 16;

610 
blocks
 |ğ
buf
 [26] << 8;

611 
blocks
 |ğ
buf
 [27];

613 
»tv®
 = 0;

617 
blocks
 = 
fÜm©s
 [4 + 0] << 24;

618 
blocks
 |ğ
fÜm©s
 [4 + 1] << 16;

619 
blocks
 |ğ
fÜm©s
 [4 + 2] << 8;

620 
blocks
 |ğ
fÜm©s
 [4 + 3];

623 
blocks
 = 0;

627 
dÚe
:

628 
	`scsi_commªd_ä“
 (
cmd
);

630 ià(
size
) {

631 *
size
 = 
blocks
 * 2048;

634  
»tv®
;

635 
	}
}

638 
	$g‘_disc_ÿ·c™y_fÜ_ty³
 (
HFPCDROM
 *
cdrom
, 
ty³
, 
gušt64
 *
size
)

640 
»tv®
;

642 
	`g_»tuº_v®_if_ç
 (
cdrom
 !ğ
NULL
, -1);

644 
»tv®
 = -1;

646 
ty³
) {

648 
»tv®
 = 
	`g‘_disc_ÿ·c™y_cd
 (
cdrom
, 
size
);

652 
»tv®
 = 
	`g‘_disc_ÿ·c™y_cdr
 (
cdrom
, 
size
);

655 
»tv®
 = 
	`g‘_disc_ÿ·c™y_cd
 (
cdrom
, 
size
);

666 
»tv®
 = 
	`g‘_disc_ÿ·c™y_dvdr_äom_ty³
 (
cdrom
, 
ty³
, 
size
);

669 
»tv®
 = -1;

672  
»tv®
;

673 
	}
}

676 
	$g‘_disc_ty³
 (
HFPCDROM
 *
cdrom
)

678 
ScsiCommªd
 *
cmd
;

679 
»tv®
 = -1;

680 
h—d”
[8];

682 
	`g_»tuº_v®_if_ç
 (
cdrom
 !ğ
NULL
, -1);

684 
cmd
 = 
	`scsi_commªd_Ãw_äom_cdrom
 (
cdrom
);

686 
	`scsi_commªd_š™
 (
cmd
, 0, 0x46);

687 
	`scsi_commªd_š™
 (
cmd
, 1, 1);

688 
	`scsi_commªd_š™
 (
cmd
, 8, 8);

689 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

690 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
h—d”
, 8)) {

692 
	`scsi_commªd_ä“
 (
cmd
);

696 
»tv®
 = (
h—d”
[6]<<8)|(header[7]);

699 
	`scsi_commªd_ä“
 (
cmd
);

700  
»tv®
;

701 
	}
}

705 
	$disc_is_­³ndabË
 (
HFPCDROM
 *
cdrom
)

707 
ScsiCommªd
 *
cmd
;

708 
»tv®
 = -1;

709 
h—d”
[32];

711 
	`g_»tuº_v®_if_ç
 (
cdrom
 !ğ
NULL
, -1);

713 
cmd
 = 
	`scsi_commªd_Ãw_äom_cdrom
 (
cdrom
);

716 
	`scsi_commªd_š™
 (
cmd
, 0, 0x51);

717 
	`scsi_commªd_š™
 (
cmd
, 8, 32);

718 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

719 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
h—d”
, 32)) {

721 
	`scsi_commªd_ä“
 (
cmd
);

725 
»tv®
 = ((
h—d”
[2]&0x03) == 0x01);

727 
	`scsi_commªd_ä“
 (
cmd
);

728  
»tv®
;

729 
	}
}

732 
	$disc_is_»wr™abË
 (
HFPCDROM
 *
cdrom
)

734 
ScsiCommªd
 *
cmd
;

735 
»tv®
 = -1;

736 
h—d”
[32];

738 
	`g_»tuº_v®_if_ç
 (
cdrom
 !ğ
NULL
, -1);

740 
cmd
 = 
	`scsi_commªd_Ãw_äom_cdrom
 (
cdrom
);

743 
	`scsi_commªd_š™
 (
cmd
, 0, 0x51);

744 
	`scsi_commªd_š™
 (
cmd
, 8, 32);

745 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

746 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
h—d”
, 32)) {

748 
	`scsi_commªd_ä“
 (
cmd
);

752 
»tv®
 = ((
h—d”
[2]&0x10) != 0);

754 
	`scsi_commªd_ä“
 (
cmd
);

755  
»tv®
;

756 
	}
}

	@hald/freebsd/probing/freebsd_dvd_rw_utils.h

9 #iâdeà
FREEBSD_DVD_RW_UTILS_H


10 
	#FREEBSD_DVD_RW_UTILS_H


	)

12 #ifdeà
HAVE_CONFIG_H


13 
	~<cÚfig.h
>

16 
	~<glib.h
>

18 
	~"../lib´obe/hå-cdrom.h
"

20 
	#DRIVE_CDROM_CAPS_DVDRW
 1

	)

21 
	#DRIVE_CDROM_CAPS_DVDPLUSR
 2

	)

22 
	#DRIVE_CDROM_CAPS_DVDPLUSRW
 4

	)

23 
	#DRIVE_CDROM_CAPS_DVDPLUSRWDL
 8

	)

24 
	#DRIVE_CDROM_CAPS_DVDPLUSRDL
 16

	)

25 
	#DRIVE_CDROM_CAPS_BDROM
 32

	)

26 
	#DRIVE_CDROM_CAPS_BDR
 64

	)

27 
	#DRIVE_CDROM_CAPS_BDRE
 128

	)

28 
	#DRIVE_CDROM_CAPS_HDDVDROM
 256

	)

29 
	#DRIVE_CDROM_CAPS_HDDVDR
 512

	)

30 
	#DRIVE_CDROM_CAPS_HDDVDRW
 1024

	)

32 
g‘_dvd_r_rw_´ofe
 (
HFPCDROM
 *
cdrom
);

33 
g‘_»ad_wr™e_¥“d
 (
HFPCDROM
 *
cdrom
, *
»ad_¥“d
, *
wr™e_¥“d
, **
wr™e_¥“ds
);

34 
g‘_disc_ÿ·c™y_fÜ_ty³
 (
HFPCDROM
 *
cdrom
, 
ty³
, 
gušt64
 *
ÿ·c™y
);

35 
g‘_disc_ty³
 (
HFPCDROM
 *
cdrom
);

36 
disc_is_­³ndabË
 (
HFPCDROM
 *
cdrom
);

37 
disc_is_»wr™abË
 (
HFPCDROM
 *
cdrom
);

	@hald/freebsd/probing/probe-hiddev.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<uni¡d.h
>

29 
	~<¡dlib.h
>

30 
	~<fú.h
>

31 
	~<sys/ioùl.h
>

32 
	~<dev/usb/usb.h
>

33 
	~<dev/usb/usbhid.h
>

34 
	~<usbhid.h
>

36 
	~"../lib´obe/hå.h
"

38 
	#HID_COLLECTION_APPLICATION
 1

	)

41 
	$maš
 (
¬gc
, **
¬gv
)

43 *
deviû_fe
;

44 
fd
 = -1;

45 
»pÜt_id
;

46 
»pÜt_desc_t
 
»pÜt_desc
;

47 
hid_d©a
 *
d©a
;

48 
hid_™em_t
 
™em
;

49 
boŞ—n
 
is_keybßrd
 = 
FALSE
;

50 
boŞ—n
 
is_key·d
 = 
FALSE
;

51 
boŞ—n
 
is_mou£
 = 
FALSE
;

52 
boŞ—n
 
is_joy¡ick
 = 
FALSE
;

54 ià(! 
	`hå_š™
(
¬gc
, 
¬gv
))

55 
’d
;

57 
deviû_fe
 = 
	`g‘’v
("HAL_PROP_HIDDEV_DEVICE");

58 ià(! 
deviû_fe
)

59 
’d
;

61 
fd
 = 
	`İ’
(
deviû_fe
, 
O_RDONLY
);

62 ià(
fd
 < 0)

63 
’d
;

66 
	`£roù™Ë
("%s", 
deviû_fe
);

68 ià(
	`ioùl
(
fd
, 
USB_GET_REPORT_ID
, &
»pÜt_id
) < 0)

69 
’d
;

71 
	`hid_š™
(
NULL
);

73 
»pÜt_desc
 = 
	`hid_g‘_»pÜt_desc
(
fd
);

74 ià(! 
»pÜt_desc
)

75 
’d
;

77 
d©a
 = 
	`hid_¡¬t_·r£
(
»pÜt_desc
, ~0, 
»pÜt_id
); 
	`hid_g‘_™em
(d©a, &
™em
);)

78 ià(
™em
.
kšd
 =ğ
hid_cŞËùiÚ
)

80 ià(
™em
.
cŞËùiÚ
 =ğ
HID_COLLECTION_APPLICATION
)

82 cÚ¡ *
·ge
;

83 *
fuÎ_·ge
;

84 
i
;

86 
·ge
 = 
	`hid_u§ge_·ge
(
	`HID_PAGE
(
™em
.
u§ge
));

88 
fuÎ_·ge
 = 
	`hå_¡rdup_´štf
("% Page", 
·ge
);

89 
i
 = 0; 
fuÎ_·ge
[i] != 0; i++)

90 ià(
fuÎ_·ge
[
i
] == '_')

91 
fuÎ_·ge
[
i
] = ' ';

93 
	`libh®_deviû_´İ”ty_¡¾i¡_­³nd
(
hå_ùx
, 
hå_udi
, "hiddev.­¶iÿtiÚ_·ges", 
fuÎ_·ge
, &
hå_”rÜ
);

94 
	`hå_ä“
(
fuÎ_·ge
);

97 
™em
.
u§ge
)

99 
	`HID_USAGE2
(
HUP_GENERIC_DESKTOP
, 
HUG_MOUSE
):

100 
is_mou£
 = 
TRUE
;

103 
	`HID_USAGE2
(
HUP_GENERIC_DESKTOP
, 
HUG_JOYSTICK
):

104 
	`HID_USAGE2
(
HUP_GENERIC_DESKTOP
, 
HUG_GAME_PAD
):

105 
is_joy¡ick
 = 
TRUE
;

108 
	`HID_USAGE2
(
HUP_GENERIC_DESKTOP
, 
HUG_KEYBOARD
):

109 
is_keybßrd
 = 
TRUE
;

112 
	`HID_USAGE2
(
HUP_GENERIC_DESKTOP
, 
HUG_KEYPAD
):

113 
is_key·d
 = 
TRUE
;

117 
	`hid_’d_·r£
(
d©a
);

119 
	`hid_di¥o£_»pÜt_desc
(
»pÜt_desc
);

121 ià(
is_keybßrd
 || 
is_mou£
 || 
is_joy¡ick
)

123 
	`libh®_deviû_add_ÿ·b™y
(
hå_ùx
, 
hå_udi
, "šput", &
hå_”rÜ
);

124 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "šput.deviû", 
deviû_fe
, &
hå_”rÜ
);

126 ià(
is_keybßrd
)

128 
	`libh®_deviû_add_ÿ·b™y
(
hå_ùx
, 
hå_udi
, "šput.keybßrd", &
hå_”rÜ
);

129 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "šfo.ÿ‹gÜy", "šput.keybßrd", &
hå_”rÜ
);

131 ià(
is_key·d
)

132 
	`libh®_deviû_add_ÿ·b™y
(
hå_ùx
, 
hå_udi
, "šput.key·d", &
hå_”rÜ
);

133 ià(
is_keybßrd
 || 
is_key·d
)

134 
	`libh®_deviû_add_ÿ·b™y
(
hå_ùx
, 
hå_udi
, "šput.keys", &
hå_”rÜ
);

135 ià(
is_mou£
)

137 
	`libh®_deviû_add_ÿ·b™y
(
hå_ùx
, 
hå_udi
, "šput.mou£", &
hå_”rÜ
);

138 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "šfo.ÿ‹gÜy", "šput.mou£", &
hå_”rÜ
);

140 ià(
is_joy¡ick
)

142 
	`libh®_deviû_add_ÿ·b™y
(
hå_ùx
, 
hå_udi
, "šput.joy¡ick", &
hå_”rÜ
);

143 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "šfo.ÿ‹gÜy", "šput.joy¡ick", &
hå_”rÜ
);

146 
’d
:

148 
	}
}

	@hald/freebsd/probing/probe-scsi.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<fú.h
>

29 
	~<¡dlib.h
>

30 
	~<¡dio.h
>

31 
	~<sys/ty³s.h
>

32 
	~<uni¡d.h
>

33 
	~<ÿmlib.h
>

35 
	~"../lib´obe/hå.h
"

38 
	$maš
 (
¬gc
, **
¬gv
)

40 
ÿm_deviû
 *
ÿm
;

41 *
deviû_fe
;

43 ià(! 
	`hå_š™
(
¬gc
, 
¬gv
))

44 
’d
;

46 
deviû_fe
 = 
	`g‘’v
("HAL_PROP_BLOCK_DEVICE");

47 ià(! 
deviû_fe
)

48 
’d
;

51 
	`£roù™Ë
("%s", 
deviû_fe
);

54 
ÿm
 = 
	`ÿm_İ’_deviû
(
deviû_fe
, 
O_RDWR
);

55 ià(
ÿm
)

57 ià(
ÿm
->
£rŸl_num_Ën
 > 0)

59 *
£rŸl
;

61 
£rŸl
 = 
	`hå_¡ºdup
(
ÿm
->
£rŸl_num
, cam->
£rŸl_num_Ën
);

62 ià(*
£rŸl
)

63 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "¡Üage.£rŸl", 
£rŸl
, &
hå_”rÜ
);

64 
	`hå_ä“
(
£rŸl
);

66 
	`ÿm_şo£_deviû
(
ÿm
);

69 
’d
:

71 
	}
}

	@hald/freebsd/probing/probe-smbios.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dio.h
>

32 
	~<¡dlib.h
>

33 
	~<¡dšt.h
>

34 
	~<sys/¡©.h
>

35 
	~<fú.h
>

36 
	~<uni¡d.h
>

37 
	~<¡ršg.h
>

38 
	~<ùy³.h
>

40 
	~"../lib´obe/hå.h
"

42 
	#DMIDECODE
 "/u¤/loÿl/sbš/dmidecode"

	)

44 
	#DMIPARSER_STATE_IGNORE
 0

	)

45 
	#DMIPARSER_STATE_BIOS
 1

	)

46 
	#DMIPARSER_STATE_SYSTEM
 2

	)

47 
	#DMIPARSER_STATE_CHASSIS
 3

	)

49 
	#¡rbegš
(
buf
, 
¡r
è(
	`¡ºcmp
 (buf, sŒ, 
	`¡¾’
 (¡r)è=ğ0)

	)

62 
	$£t¡r
 (*
buf
, *
¡r
, *
´İ
)

64 
DBusE¼Ü
 
”rÜ
;

65 *
v®ue
;

67 ià(
	`¡rbegš
 (
buf
, 
¡r
)) {

68 
	`dbus_”rÜ_š™
 (&
”rÜ
);

69 
v®ue
 = 
buf
 + 
	`¡¾’
 (
¡r
) + 1;

70 ià(
	`¡rcmp
 (
v®ue
, "Not Specified") == 0)

71 
out
;

73 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
hå_ùx
, 
hå_udi
, 
´İ
, 
v®ue
, &
hå_”rÜ
);

74 
	`hå_šfo
 ("S‘tšg %s='%s'", 
´İ
, 
v®ue
);

75  
TRUE
;

77 
out
:

78  
FALSE
;

79 
	}
}

82 
	$cİykeyv®
 (*
key
, *
com·t_key
)

84 *
v®ue
;

86 
v®ue
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
hå_ùx
, 
hå_udi
, 
key
, 
NULL
);

87 ià(
v®ue
 !ğ
NULL
) {

88 
	`hå_šfo
 ("Cİyšg % -> %s", 
key
, 
com·t_key
);

89 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
hå_ùx
, 
hå_udi
, 
com·t_key
, 
v®ue
, 
NULL
);

91 
	}
}

102 
	$maš
 (
¬gc
, *
¬gv
[])

104 
»t
;

105 
DBusE¼Ü
 
”rÜ
;

106 
buf
[512];

107 *
nbuf
;

108 
dme
[2];

109 
nuÎfd
;

110 
tmp_»t
;

111 
FILE
 *
f
;

112 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_IGNORE
;

117 
dm¬£r_dÚe_bios
 = 
FALSE
;

118 
dm¬£r_dÚe_sy¡em
 = 
FALSE
;

119 
dm¬£r_dÚe_chassis
 = 
FALSE
;

122 
»t
 = 1;

124 ià(! 
	`hå_š™
 (
¬gc
, 
¬gv
))

125 
out
;

127 
	`dbus_”rÜ_š™
 (&
”rÜ
);

129 
tmp_»t
 = 
	`pe
 (
dme
);

130 
f
 = 
	`fdİ’
 (
dme
[0], "r");

131 
nuÎfd
 = 
	`İ’
 ("/dev/nuÎ", 
O_RDONLY
);

134 
	`fÜk
 ()) {

138 
	`dup2
 (
nuÎfd
, 
STDIN_FILENO
);

139 
	`dup2
 (
dme
[1], 
STDOUT_FILENO
);

140 
	`şo£
 (
dme
[0]);

141 
	`şo£
 (
dme
[1]);

144 
	`exeş
 (
DMIDECODE
, DMIDECODE, 
NULL
);

147 
	`hå_w¬nšg
("çedØexecu‹ " 
DMIDECODE
);

148 
	`ex™
 (1);

151 
	`hå_w¬nšg
("cannot fork");

158 
	`şo£
 (
dme
[1]);

161 
	`fg‘s
 (
buf
, (buf), 
f
è!ğ
NULL
)

163 
i
;

164 
Ën
;

165 
bs
 = 0;

168 
Ën
 = 
	`¡¾’
 (
buf
);

171 ià(
Ën
 >ğ (
buf
))

175 ià(
Ën
 < 3) {

176 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_IGNORE
;

181 ià(
buf
[0] == '\t' && buf[1] == '\t')

182 
bs
 = 2;

183 ià(
buf
[0] == '\t')

184 
bs
 = 1;

186 ià(
bs
 == 2)

191 ià(
bs
 == 0) {

192 ià(!
dm¬£r_dÚe_bios
 && 
	`¡rbegš
 (
buf
, "BIOS Information"))

193 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_BIOS
;

194 ià(!
dm¬£r_dÚe_sy¡em
 && 
	`¡rbegš
 (
buf
, "System Information"))

195 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_SYSTEM
;

196 ià(!
dm¬£r_dÚe_chassis
 && 
	`¡rbegš
 (
buf
, "Chassis Information"))

197 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_CHASSIS
;

203 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_IGNORE
;

208 ià(
dm¬£r_¡©e
 =ğ
DMIPARSER_STATE_IGNORE
)

212 
nbuf
 = &
buf
[1];

215 
i
 = 
Ën
 - 2; 
	`is¥aû
 (
nbuf
[i]) && i >= 0; --i)

216 
nbuf
[
i
] = '\0';

218 ià(
dm¬£r_¡©e
 =ğ
DMIPARSER_STATE_BIOS
) {

219 
	`£t¡r
 (
nbuf
, "Vendor:", "system.firmware.vendor");

220 
	`£t¡r
 (
nbuf
, "Version:", "system.firmware.version");

221 
	`£t¡r
 (
nbuf
, "Release Date:", "system.firmware.release_date");

222 
dm¬£r_dÚe_bios
 = 
TRUE
;

223 } ià(
dm¬£r_¡©e
 =ğ
DMIPARSER_STATE_SYSTEM
) {

224 
	`£t¡r
 (
nbuf
, "Manufacturer:", "system.hardware.vendor");

225 
	`£t¡r
 (
nbuf
, "Product Name:", "system.hardware.product");

226 
	`£t¡r
 (
nbuf
, "Version:", "system.hardware.version");

227 
	`£t¡r
 (
nbuf
, "Serial Number:", "system.hardware.serial");

228 
	`£t¡r
 (
nbuf
, "UUID:", "system.hardware.uuid");

229 
dm¬£r_dÚe_sy¡em
 = 
TRUE
;

230 } ià(
dm¬£r_¡©e
 =ğ
DMIPARSER_STATE_CHASSIS
) {

231 
	`£t¡r
 (
nbuf
, "Manufacturer:", "system.chassis.manufacturer");

232 
	`£t¡r
 (
nbuf
, "Type:", "system.chassis.type");

233 
dm¬£r_dÚe_chassis
 = 
TRUE
;

238 
	`fşo£
 (
f
);

241 
»t
 = 0;

243 
out
:

244  
»t
;

245 
	}
}

	@hald/freebsd/probing/probe-storage.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<fú.h
>

29 
	~<¡ršg.h
>

30 
	~<¡dlib.h
>

31 
	~<uni¡d.h
>

32 
	~<”ºo.h
>

33 
	~<sys/ty³s.h
>

34 
	~<Ãtš‘/š.h
>

35 
	~<glib.h
>

36 
	~<libvŞume_id.h
>

38 
	~"libh®/libh®.h
"

40 
	~"../lib´obe/hå.h
"

41 
	~"../lib´obe/hå-cdrom.h
"

43 
	~"ä“bsd_dvd_rw_uts.h
"

46 
	$hf_´obe_¡Üage_g‘_cdrom_ÿ·b™›s
 (cÚ¡ *
deviû_fe
,

47 cÚ¡ *
·»Á
)

49 
HFPCDROM
 *
cdrom
;

50 
HFPCDROMC­ab™›s
 
ÿps
;

51 
gboŞ—n
 
¡©us
 = 
FALSE
;

52 
i
;

53 
»ad_¥“d
;

54 
wr™e_¥“d
;

55 *
wr™e_¥“ds
;

57 
	`g_»tuº_if_ç
(
deviû_fe
 !ğ
NULL
);

58 
	`g_»tuº_if_ç
(
·»Á
 !ğ
NULL
);

60 
cdrom
 = 
	`hå_cdrom_Ãw
(
deviû_fe
, 
·»Á
);

61 ià(! 
cdrom
)

63 
	`hå_w¬nšg
("uÇbËØİ’ CD-ROM deviû %s", 
deviû_fe
);

68 
i
 = 0; i < 5; i++)

70 
ccb
[16] = { 
HFP_CDROM_MODE_SENSE_BIG
, 0, 
HFP_CDROM_CAP_PAGE
, 0, 0, 0, 0, (
ÿps
) >> 8, (caps) };

71 *
”r
 = 
NULL
;

73 ià(! 
	`hå_cdrom_£nd_ccb
(
cdrom
, 
ccb
, 10, 
HFP_CDROM_DIRECTION_IN
, &
ÿps
, (ÿps), &
”r
))

75 
	`hå_w¬nšg
("%s: uÇbËØg‘ c­ab™›s: %s", 
deviû_fe
, 
”r
);

76 
	`hå_ä“
(
”r
);

79 ià(
ÿps
.
·ge_code
 !ğ
HFP_CDROM_CAP_PAGE
)

81 
	`hå_w¬nšg
("%s: bad…agcod%i", 
deviû_fe
, 
ÿps
.
·ge_code
);

85 
¡©us
 = 
TRUE
;

88 ià(! 
¡©us
)

89 
’d
;

91 ià((
ÿps
.
medŸ
 & 
HFP_CDROM_MST_WRITE_CDR
) != 0)

92 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.cdr", 
TRUE
, &
hå_”rÜ
);

93 ià((
ÿps
.
medŸ
 & 
HFP_CDROM_MST_WRITE_CDRW
) != 0)

94 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.cdrw", 
TRUE
, &
hå_”rÜ
);

95 ià((
ÿps
.
medŸ
 & 
HFP_CDROM_MST_READ_DVDROM
) != 0)

97 
´ofe
;

98 
gboŞ—n
 
r
;

99 
gboŞ—n
 
rw
;

100 
gboŞ—n
 
rdl
;

101 
gboŞ—n
 
rwdl
;

102 
gboŞ—n
 
bd
;

103 
gboŞ—n
 
bdr
;

104 
gboŞ—n
 
bd»
;

105 
gboŞ—n
 
hddvd
;

106 
gboŞ—n
 
hddvdr
;

107 
gboŞ—n
 
hddvdrw
;

109 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.dvd", 
TRUE
, &
hå_”rÜ
);

111 
´ofe
 = 
	`g‘_dvd_r_rw_´ofe
(
cdrom
);

112 
r
 = (
´ofe
 & 
DRIVE_CDROM_CAPS_DVDPLUSR
) != 0;

113 
rw
 = (
´ofe
 & 
DRIVE_CDROM_CAPS_DVDRW
) != 0;

114 
rdl
 = (
´ofe
 & 
DRIVE_CDROM_CAPS_DVDPLUSRDL
) != 0;

115 
rwdl
 = (
´ofe
 & 
DRIVE_CDROM_CAPS_DVDPLUSRWDL
) != 0;

116 
bd
 = (
´ofe
 & 
DRIVE_CDROM_CAPS_BDROM
) != 0;

117 
bdr
 = (
´ofe
 & 
DRIVE_CDROM_CAPS_BDR
) != 0;

118 
bd»
 = (
´ofe
 & 
DRIVE_CDROM_CAPS_BDRE
) != 0;

119 
hddvd
 = (
´ofe
 & 
DRIVE_CDROM_CAPS_HDDVDROM
) != 0;

120 
hddvdr
 = (
´ofe
 & 
DRIVE_CDROM_CAPS_HDDVDR
) != 0;

121 
hddvdrw
 = (
´ofe
 & 
DRIVE_CDROM_CAPS_HDDVDRW
) != 0;

123 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.dvd¶u¤", 
r
, &
hå_”rÜ
);

124 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.dvd¶u¤w", 
rw
, &
hå_”rÜ
);

125 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.dvd¶u¤dl", 
rdl
, &
hå_”rÜ
);

126 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.dvd¶u¤wdl", 
rwdl
, &
hå_”rÜ
);

127 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.bd", 
bd
, &
hå_”rÜ
);

128 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.bdr", 
bdr
, &
hå_”rÜ
);

129 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.bd»", 
bd»
, &
hå_”rÜ
);

130 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.hddvd", 
hddvd
, &
hå_”rÜ
);

131 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.hddvdr", 
hddvdr
, &
hå_”rÜ
);

132 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.hddvdrw", 
hddvdrw
, &
hå_”rÜ
);

134 ià((
ÿps
.
medŸ
 & 
HFP_CDROM_MST_WRITE_DVDR
) != 0)

135 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.dvdr", 
TRUE
, &
hå_”rÜ
);

136 ià((
ÿps
.
medŸ
 & 
HFP_CDROM_MST_WRITE_DVDRAM
) != 0)

137 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.dvd¿m", 
TRUE
, &
hå_”rÜ
);

139 ià(
	`g‘_»ad_wr™e_¥“d
(
cdrom
, &
»ad_¥“d
, &
wr™e_¥“d
, &
wr™e_¥“ds
) >= 0)

141 
	`libh®_deviû_£t_´İ”ty_št
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.»ad_¥“d", 
»ad_¥“d
, &
hå_”rÜ
);

142 ià(
wr™e_¥“d
 > 0)

144 
	`libh®_deviû_£t_´İ”ty_št
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.wr™e_¥“d", 
wr™e_¥“d
, &
hå_”rÜ
);

146 ià(
wr™e_¥“ds
 !ğ
NULL
)

148 **
¥“dv
;

149 
i
;

151 
¥“dv
 = 
	`g_¡r¥l™_£t
(
wr™e_¥“ds
, ",", 0);

152 
	`ä“
(
wr™e_¥“ds
);

154 
i
 = 0; 
¥“dv
[i] !ğ
NULL
; i++)

155 ià(*(
¥“dv
[
i
]))

156 
	`libh®_deviû_´İ”ty_¡¾i¡_­³nd
(
hå_ùx
, 
hå_udi
, "¡Üage.cdrom.wr™e_¥“ds", 
¥“dv
[
i
], &
hå_”rÜ
);

158 
	`g_¡rä“v
(
¥“dv
);

163 
’d
:

164 ià(
cdrom
)

165 
	`hå_cdrom_ä“
(
cdrom
);

166 
	}
}

169 
	$maš
 (
¬gc
, **
¬gv
)

171 *
deviû_fe
;

172 *
drive_ty³
;

173 *
·»Á
;

174 
»t
 = 0;

175 
gboŞ—n
 
has_chd»n
;

176 
gboŞ—n
 
Úly_check_fÜ_medŸ
;

177 
gboŞ—n
 
is_cdrom
;

179 ià(! 
	`hå_š™
(
¬gc
, 
¬gv
))

180 
’d
;

182 
deviû_fe
 = 
	`g‘’v
("HAL_PROP_BLOCK_DEVICE");

183 ià(! 
deviû_fe
)

184 
’d
;

186 
drive_ty³
 = 
	`g‘’v
("HAL_PROP_STORAGE_DRIVE_TYPE");

187 ià(! 
drive_ty³
)

188 
’d
;

190 
·»Á
 = 
	`g‘’v
("HAL_PROP_INFO_PARENT");

191 ià(! 
·»Á
)

192 
’d
;

195 
	`£roù™Ë
("%s", 
deviû_fe
);

197 
has_chd»n
 = 
	`hå_g‘’v_boŞ
("HF_HAS_CHILDREN");

198 
Úly_check_fÜ_medŸ
 = 
	`hå_g‘’v_boŞ
("HF_ONLY_CHECK_FOR_MEDIA");

200 
is_cdrom
 = ! 
	`¡rcmp
(
drive_ty³
, "cdrom");

202 ià(! 
Úly_check_fÜ_medŸ
 && 
is_cdrom
)

203 
	`hf_´obe_¡Üage_g‘_cdrom_ÿ·b™›s
(
deviû_fe
, 
·»Á
);

205 ià(
is_cdrom
)

207 
HFPCDROM
 *
cdrom
;

209 
cdrom
 = 
	`hå_cdrom_Ãw
(
deviû_fe
, 
·»Á
);

210 ià(! 
cdrom
)

211 
’d
;

213 ià(
	`hå_cdrom_‹¡_un™_»ady
(
cdrom
))

214 
»t
 = 2;

216 
	`hå_cdrom_ä“
(
cdrom
);

218 ià(! 
has_chd»n
)

220 
vŞume_id
 *
vid
;

222 
vid
 = 
	`vŞume_id_İ’_node
(
deviû_fe
);

223 ià(! 
vid
)

224 
’d
;

226 ià(
	`vŞume_id_´obe_®l
(
vid
, 0, 0è=ğ0 && vid->
u§ge_id
 =ğ
VOLUME_ID_FILESYSTEM
)

227 
»t
 = 2;

229 
	`vŞume_id_şo£
(
vid
);

232 
’d
:

233  
»t
;

234 
	}
}

	@hald/freebsd/probing/probe-volume.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡dio.h
>

29 
	~<¡ršg.h
>

30 
	~<¡dlib.h
>

31 
	~<lim™s.h
>

32 
	~<š‰y³s.h
>

33 
	~<fú.h
>

34 
	~<uni¡d.h
>

35 
	~<sys/ioùl.h
>

36 
	~<sys/disk.h
>

37 
	~<sys/cdio.h
>

38 
	~<sys/·¿m.h
>

39 
	~<sys/ty³s.h
>

40 
	~<isofs/cd9660/iso.h
>

41 
	~<glib.h
>

42 
	~<libvŞume_id.h
>

44 
	~"libh®/libh®.h
"

46 
	~"../lib´obe/hå.h
"

48 
	~"ä“bsd_dvd_rw_uts.h
"

50 
	#ISO_VOLDESC_SEC
 16

	)

52 
	siso_·th_bË_’Œy


54 
	mÇme_Ën
 [
ISODCL
(1,1)];

55 
	mext_©Œ_Ën
 [
ISODCL
(2,2)];

56 
	mex‹Á
 [
ISODCL
(3,6)];

57 
	m·»Á_no
 [
ISODCL
(7,8)];

58 
	mÇme
[1];

60 
	#ISO_PATH_TABLE_ENTRY_SIZE
 8

	)

62 #ià
__F»eBSD_v”siÚ
 < 600101

63 
ušt32_t


64 
	$isÚum_731
(*
p
)

66  (
p
[0] |…[1] << 8 |…[2] << 16 |…[3] << 24);

67 
	}
}

69 
ušt32_t


70 
	$isÚum_732
(*
p
)

72  (
p
[3] |…[2] << 8 |…[1] << 16 |…[0] << 24);

73 
	}
}

76 
uštmax_t


77 
	$hf_´obe_vŞume_g‘’v_uštmax
 (cÚ¡ *
Çme
)

79 *
¡r
;

81 
	`g_»tuº_v®_if_ç
(
Çme
 !ğ
NULL
, 0);

83 
¡r
 = 
	`g‘’v
(
Çme
);

85  
¡r
 ? 
	`¡¹oumax
(¡r, 
NULL
, 10) : 0;

86 
	}
}

89 
	$hf_´obe_vŞume_g‘’v_št
 (cÚ¡ *
Çme
)

91 *
¡r
;

93 
	`g_»tuº_v®_if_ç
(
Çme
 !ğ
NULL
, 0);

95 
¡r
 = 
	`g‘’v
(
Çme
);

97  
¡r
 ? 
	`©oi
(str) : 0;

98 
	}
}

101 
	$hf_´obe_vŞume_g‘_Ïb–
 (cÚ¡ 
vŞume_id
 *
vid
)

103 *
Ïb–
 = 
NULL
;

105 ià(
vid
 && *vid->
Ïb–
)

107 ià(
	`g_utf8_v®id©e
(
vid
->
Ïb–
, -1, 
NULL
))

108 
Ïb–
 = 
	`g_¡rdup
(
vid
->label);

110 
Ïb–
 = 
	`g_cÚv”t
(
vid
->Ïb–, -1, "UTF-8", "ISO8859-1", 
NULL
, NULL, NULL);

113  
Ïb–
;

114 
	}
}

117 
	$hf_´obe_vŞume_g‘_disc_šfo
 (
fd
,

118 
gboŞ—n
 *
has_audio
,

119 
gboŞ—n
 *
has_d©a
)

121 
ioc_toc_h—d”
 
toc_h—d”
;

122 
n_Œacks
;

123 
cd_toc_’Œy
 *
bufãr
 = 
NULL
;

124 
ioc_»ad_toc_’Œy
 
»ad_toc_’Œy
;

125 
i
;

127 
	`g_»tuº_if_ç
(
has_audio
 !ğ
NULL
);

128 
	`g_»tuº_if_ç
(
has_d©a
 !ğ
NULL
);

130 *
has_audio
 = 
FALSE
;

131 *
has_d©a
 = 
FALSE
;

133 ià(
	`ioùl
(
fd
, 
CDIOREADTOCHEADER
, &
toc_h—d”
) < 0)

136 
n_Œacks
 = 
toc_h—d”
.
’dšg_Œack
 -oc_h—d”.
¡¬tšg_Œack
 + 1;

138 
bufãr
 = 
	`g_Ãw
(
cd_toc_’Œy
, 
n_Œacks
 + 1);

140 
»ad_toc_’Œy
.
add»ss_fÜm©
 = 
CD_MSF_FORMAT
;

141 
»ad_toc_’Œy
.
¡¬tšg_Œack
 = 0;

142 
»ad_toc_’Œy
.
d©a_Ën
 = (
n_Œacks
 + 1è* (
cd_toc_’Œy
);

143 
»ad_toc_’Œy
.
d©a
 = 
bufãr
;

145 ià(
	`ioùl
(
fd
, 
CDIOREADTOCENTRYS
, &
»ad_toc_’Œy
) < 0)

146 
’d
;

148 
i
 = 0; i < 
n_Œacks
; i++)

150 ià((
bufãr
[
i
].
cÚŒŞ
 & 4) != 0)

151 *
has_d©a
 = 
TRUE
;

153 *
has_audio
 = 
TRUE
;

156 
’d
:

157 
	`g_ä“
(
bufãr
);

158 
	}
}

161 
	$hf_´obe_vŞume_advªûd_disc_d‘eù
 (
fd
)

163 
size_t
 
£csz
 = 
ISO_DEFAULT_BLOCK_SIZE
;

164 
»adoff
;

165 
iso_´im¬y_desütÜ
 
desc
;

166 
u_ch¬
 *
±bl
;

167 
±bl_size
, 
±bl_bsize
;

168 
±bl_lbn
;

169 
iso_·th_bË_’Œy
 *
±e
;

170 
±e_Ën
;

171 
Çme_Ën
;

172 
off
;

174 
»adoff
 = 
ISO_VOLDESC_SEC
 * 
£csz
;

177 ià(
	`´—d
(
fd
, &
desc
,  desc, 
»adoff
) !=  desc)

179 
	`hå_w¬nšg
("volume descriptor„eadƒrror");

182 ià(
	`isÚum_711
(
desc
.
ty³
è=ğ
ISO_VD_END
)

184 
»adoff
 +ğ
£csz
;

186 
	`isÚum_711
(
desc
.
ty³
è!ğ
ISO_VD_PRIMARY
);

188 
±bl_size
 = 
	`isÚum_733
(
desc
.
·th_bË_size
);

189 #ià
BYTE_ORDER
 =ğ
LITTLE_ENDIAN


190 
±bl_lbn
 = 
	`isÚum_731
(
desc
.
ty³_l_·th_bË
);

192 
±bl_lbn
 = 
	`isÚum_732
(
desc
.
ty³_m_·th_bË
);

194 
±bl_bsize
 = (
±bl_size
 + 
£csz
 - 1) / secsz * secsz;

195 
±bl
 = 
	`g_m®loc
(
±bl_bsize
);

196 ià(
±bl
 =ğ
NULL
)

198 
	`hå_w¬nšg
("pathable‡llocation failure");

201 
»adoff
 = 
±bl_lbn
 * 
£csz
;

202 ià(
	`´—d
(
fd
, 
±bl
, 
±bl_bsize
, 
»adoff
) !=…tbl_bsize)

204 
	`g_ä“
(
±bl
);

205 
	`hå_w¬nšg
("pathable„eadƒrror");

207 
off
 = 0; ofà< 
±bl_size
; ofà+ğ
±e_Ën
)

209 
±e
 = (
iso_·th_bË_’Œy
 *)(
±bl
 + 
off
);

210 
Çme_Ën
 = *
±e
->name_len;

211 
±e_Ën
 = 
ISO_PATH_TABLE_ENTRY_SIZE
 + 
Çme_Ën
 + (name_len % 2);

212 ià(*(*)
±e
->
·»Á_no
 != 1)

214 ià(
Çme_Ën
 =ğ8 && 
	`¡ºcmp
(
±e
->
Çme
, "VIDEO_TS", 8) == 0)

216 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_videodvd", 
TRUE
, &
hå_”rÜ
);

219 ià(
Çme_Ën
 =ğ3 && 
	`¡ºcmp
(
±e
->
Çme
, "VCD", 8) == 0)

221 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_vcd", 
TRUE
, &
hå_”rÜ
);

224 ià(
Çme_Ën
 =ğ4 && 
	`¡ºcmp
(
±e
->
Çme
, "SVCD", 4) == 0)

226 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_svcd", 
TRUE
, &
hå_”rÜ
);

230 
	`g_ä“
(
±bl
);

231 
	}
}

233 
gboŞ—n


234 
	$hf_´obe_vŞume_g‘_·¹™iÚ_šfo
 (cÚ¡ *
geom_şass
,

235 cÚ¡ *
devfe
,

236 *
numb”
,

237 **
ty³
,

238 **
scheme
,

239 
gušt64
 *
medŸsize
,

240 
gušt64
 *
off£t
)

242 
	`g_»tuº_v®_if_ç
(
geom_şass
 !ğ
NULL
, 
FALSE
);

243 
	`g_»tuº_v®_if_ç
(
devfe
 !ğ
NULL
, 
FALSE
);

244 
	`g_»tuº_v®_if_ç
(
numb”
 !ğ
NULL
, 
FALSE
);

245 
	`g_»tuº_v®_if_ç
(
ty³
 !ğ
NULL
, 
FALSE
);

246 
	`g_»tuº_v®_if_ç
(
scheme
 !ğ
NULL
, 
FALSE
);

247 
	`g_»tuº_v®_if_ç
(
medŸsize
 !ğ
NULL
, 
FALSE
);

248 
	`g_»tuº_v®_if_ç
(
off£t
 !ğ
NULL
, 
FALSE
);

250 ià(
	`¡rcmp
(
geom_şass
, "MBR") &&

251 
	`¡rcmp
(
geom_şass
, "MBREXT") &&

252 
	`¡rcmp
(
geom_şass
, "GPT") &&

253 
	`¡rcmp
(
geom_şass
, "SUN") &&

254 
	`¡rcmp
(
geom_şass
, "APPLE"))

255  
FALSE
;

257 *
medŸsize
 = 
	`hf_´obe_vŞume_g‘’v_uštmax
("HF_VOLUME_SIZE");

258 ià(*
medŸsize
 == 0)

259  
FALSE
;

261 *
off£t
 = 
	`hf_´obe_vŞume_g‘’v_uštmax
("HF_VOLUME_OFFSET");

263 *
numb”
 = 
	`hf_´obe_vŞume_g‘’v_št
("HF_VOLUME_PART_INDEX");

264 ià(*
numb”
 == 0)

266 
size_t
 
Ën
;

267 *
·¹no
;

269 
·¹no
 = 
	`¡¼chr
(
devfe
, 's');

270 ià(! 
·¹no
)

271  
FALSE
;

273 
Ën
 = 
	`¡¾’
(
·¹no
) - 1;

274 ià(
Ën
 > 0 && 
	`¡r¥n
(
·¹no
 + 1, "0123456789") ==†en)

275 *
numb”
 = 
	`©oi
(
·¹no
);

277  
FALSE
;

280 *
scheme
 = 
	`g_ascii_¡rdown
(
geom_şass
, -1);

281 ià(! 
	`¡rcmp
(*
scheme
, "apple"))

283 
	`g_ä“
(*
scheme
);

284 *
scheme
 = 
	`g_¡rdup
("apm");

287 ià(! 
	`¡rcmp
(*
scheme
, "mbrext"))

289 
	`g_ä“
(*
scheme
);

290 *
scheme
 = 
	`g_¡rdup
("embr");

293 ià(! 
	`¡rcmp
(*
scheme
, "mbr") || ! strcmp(*scheme, "embr"))

294 *
ty³
 = 
	`g_¡rdup_´štf
("0x%x",

295 
	`hf_´obe_vŞume_g‘’v_št
("HF_VOLUME_PART_TYPE"));

298 *
·¹ty³
;

300 
·¹ty³
 = 
	`g‘’v
("HF_VOLUME_PART_TYPE");

302 ià(
·¹ty³
)

303 *
ty³
 = 
	`g_¡rdup
(
·¹ty³
);

305 *
ty³
 = 
	`g_¡rdup
("");

308  
TRUE
;

309 
	}
}

312 
	$maš
 (
¬gc
, **
¬gv
)

314 *
deviû_fe
;

315 *
·»Á_udi
;

316 *
g¿nd·»Á_udi
;

317 *
·»Á_drive_ty³
;

318 
fd
 = -1;

319 
vŞume_id
 *
vid
 = 
NULL
;

320 
»t
 = 1;

321 
gboŞ—n
 
has_chd»n
;

322 
gboŞ—n
 
is_sw­
;

323 
gboŞ—n
 
is_cdrom
;

324 
gboŞ—n
 
is_·¹™iÚ
 = 
FALSE
;

325 
gboŞ—n
 
has_audio
 = 
FALSE
;

326 
gboŞ—n
 
has_d©a
 = 
FALSE
;

327 
gboŞ—n
 
is_bÏnk
 = 
FALSE
;

328 cÚ¡ *
u§ge
;

329 *
Ïb–
;

330 
£ùÜ_size
 = 0;

331 
off_t
 
medŸ_size
 = 0;

333 ià(! 
	`hå_š™
(
¬gc
, 
¬gv
))

334 
’d
;

336 
deviû_fe
 = 
	`g‘’v
("HAL_PROP_BLOCK_DEVICE");

337 ià(! 
deviû_fe
)

338 
’d
;

340 
·»Á_udi
 = 
	`g‘’v
("HAL_PROP_INFO_PARENT");

341 ià(! 
·»Á_udi
)

342 
’d
;

345 
	`£roù™Ë
("%s", 
deviû_fe
);

347 
has_chd»n
 = 
	`hå_g‘’v_boŞ
("HF_HAS_CHILDREN");

348 
is_sw­
 = 
	`hå_g‘’v_boŞ
("HF_IS_SWAP");

350 
fd
 = 
	`İ’
(
deviû_fe
, 
O_RDONLY
);

351 ià(
fd
 < 0)

352 
’d
;

354 
·»Á_drive_ty³
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
(
hå_ùx
, 
·»Á_udi
, "¡Üage.drive_ty³", &
hå_”rÜ
);

355 
	`dbus_”rÜ_ä“
(&
hå_”rÜ
);

357 
g¿nd·»Á_udi
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
(
hå_ùx
, 
·»Á_udi
, "šfo.·»Á", &
hå_”rÜ
);

358 
	`dbus_”rÜ_ä“
(&
hå_”rÜ
);

360 
is_cdrom
 = 
·»Á_drive_ty³
 && ! 
	`¡rcmp
(parent_drive_type, "cdrom");

361 
	`g_ä“
(
·»Á_drive_ty³
);

363 ià(
is_cdrom
)

365 
	`hf_´obe_vŞume_g‘_disc_šfo
(
fd
, &
has_audio
, &
has_d©a
);

366 
is_bÏnk
 = (! 
has_audio
 && ! 
has_d©a
);

369 
	`ioùl
(
fd
, 
DIOCGMEDIASIZE
, &
medŸ_size
);

380 ià(! 
has_chd»n
 && ! (
is_cdrom
 && ! 
has_d©a
))

382 
vid
 = 
	`vŞume_id_İ’_fd
(
fd
);

383 ià(
vid
)

385 ià(
	`vŞume_id_´obe_®l
(
vid
, 0, 
medŸ_size
) == 0)

386 
has_d©a
 = 
TRUE
;

389 
	`vŞume_id_şo£
(
vid
);

390 
vid
 = 
NULL
;

395 ià(! 
has_chd»n
 && ! 
is_sw­
 && ! 
has_audio
 && ! 
has_d©a
 && ! 
is_bÏnk
)

396 
’d
;

398 
	`libh®_deviû_add_ÿ·b™y
(
hå_ùx
, 
hå_udi
, "vŞume", &
hå_”rÜ
);

399 ià(
is_cdrom
)

401 
HFPCDROM
 *
cdrom
;

402 
ty³
;

403 
gušt64
 
ÿ·c™y
;

405 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "šfo.ÿ‹gÜy", "vŞume.disc", &
hå_”rÜ
);

406 
	`libh®_deviû_add_ÿ·b™y
(
hå_ùx
, 
hå_udi
, "vŞume.disc", &
hå_”rÜ
);

408 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.has_audio", 
has_audio
, &
hå_”rÜ
);

409 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.has_d©a", 
has_d©a
, &
hå_”rÜ
);

410 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_vcd", 
FALSE
, &
hå_”rÜ
);

411 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_svcd", 
FALSE
, &
hå_”rÜ
);

412 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_videodvd", 
FALSE
, &
hå_”rÜ
);

413 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_­³ndabË", 
FALSE
, &
hå_”rÜ
);

414 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_bÏnk", 
is_bÏnk
, &
hå_”rÜ
);

415 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_»wr™abË", 
FALSE
, &
hå_”rÜ
);

416 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "unknown", &
hå_”rÜ
);

420 
cdrom
 = 
	`hå_cdrom_Ãw_äom_fd
(
fd
, 
deviû_fe
, 
g¿nd·»Á_udi
);

421 ià(
cdrom
)

423 
ty³
 = 
	`g‘_disc_ty³
(
cdrom
);

424 ià(
ty³
 != -1)

425 
ty³
)

428 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "cd_rom", &
hå_”rÜ
);

431 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "cd_r", &
hå_”rÜ
);

434 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "cd_rw", &
hå_”rÜ
);

435 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_»wr™abË", 
TRUE
, &
hå_”rÜ
);

438 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "dvd_rom", &
hå_”rÜ
);

441 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "dvd_r", &
hå_”rÜ
);

444 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "dvd_¿m", &
hå_”rÜ
);

445 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_»wr™abË", 
TRUE
, &
hå_”rÜ
);

448 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "dvd_rw", &
hå_”rÜ
);

449 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_»wr™abË", 
TRUE
, &
hå_”rÜ
);

452 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "dvd_rw", &
hå_”rÜ
);

453 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_»wr™abË", 
TRUE
, &
hå_”rÜ
);

456 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "dvd_¶us_rw", &
hå_”rÜ
);

457 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_»wr™abË", 
TRUE
, &
hå_”rÜ
);

460 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "dvd_¶us_r", &
hå_”rÜ
);

463 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "dvd_¶us_r_dl", &
hå_”rÜ
);

466 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "bd_rom", &
hå_”rÜ
);

469 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "bd_r", &
hå_”rÜ
);

472 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "bd_r", &
hå_”rÜ
);

475 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "bd_»", &
hå_”rÜ
);

476 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_»wr™abË", 
TRUE
, &
hå_”rÜ
);

479 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "hddvd_rom", &
hå_”rÜ
);

482 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "hddvd_r", &
hå_”rÜ
);

485 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ty³", "hddvd_rw", &
hå_”rÜ
);

486 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_»wr™abË", 
TRUE
, &
hå_”rÜ
);

490 ià(
	`g‘_disc_ÿ·c™y_fÜ_ty³
(
cdrom
, 
ty³
, &
ÿ·c™y
) == 0)

491 
	`libh®_deviû_£t_´İ”ty_ušt64
(
hå_ùx
, 
hå_udi
, "vŞume.disc.ÿ·c™y", 
ÿ·c™y
, &
hå_”rÜ
);

497 ià(
	`disc_is_»wr™abË
(
cdrom
))

498 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.disc.is_»wr™abË", 
TRUE
, &
hå_”rÜ
);

499 ià(
	`disc_is_­³ndabË
(
cdrom
))

500 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
hå_ùx
, 
hå_udi
, "vŞume.disc.is_­³ndabË", 
TRUE
, &
hå_”rÜ
);

502 
	`hå_cdrom_ä“
(
cdrom
);

505 ià(
has_d©a
)

506 
	`hf_´obe_vŞume_advªûd_disc_d‘eù
(
fd
);

510 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "šfo.ÿ‹gÜy", "vŞume", &
hå_”rÜ
);

512 ià(
	`libh®_deviû_qu”y_ÿ·b™y
(
hå_ùx
, 
·»Á_udi
, "¡Üage", &
hå_”rÜ
))

514 *
geom_şass
;

515 *
ty³
;

516 *
scheme
;

517 
numb”
;

518 
gušt64
 
medŸsize
;

519 
gušt64
 
off£t
;

521 
geom_şass
 = 
	`g‘’v
("HF_VOLUME_GEOM_CLASS");

523 ià(
geom_şass
)

525 ià(
	`hf_´obe_vŞume_g‘_·¹™iÚ_šfo
(
geom_şass
, 
deviû_fe
, &
numb”
, &
ty³
, &
scheme
, &
medŸsize
, &
off£t
))

527 
is_·¹™iÚ
 = 
TRUE
;

529 
	`libh®_deviû_£t_´İ”ty_št
(
hå_ùx
, 
hå_udi
, "vŞume.·¹™iÚ.numb”", 
numb”
, &
hå_”rÜ
);

530 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.·¹™iÚ.scheme", 
scheme
, &
hå_”rÜ
);

531 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.·¹™iÚ.ty³", 
ty³
, &
hå_”rÜ
);

535 
	`libh®_deviû_£t_´İ”ty_ušt64
(
hå_ùx
, 
hå_udi
, "vŞume.·¹™iÚ.medŸ_size", 
medŸsize
, &
hå_”rÜ
);

536 
	`libh®_deviû_£t_´İ”ty_ušt64
(
hå_ùx
, 
hå_udi
, "vŞume.·¹™iÚ.¡¬t", 
off£t
, &
hå_”rÜ
);

538 ià(! 
	`¡rcmp
(
scheme
, "gpt"))

539 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.·¹™iÚ.uuid", 
ty³
, &
hå_”rÜ
);

541 ià(! 
	`¡rcmp
(
scheme
, "gpt") || ! strcmp(scheme, "apm"))

542 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.·¹™iÚ.Ïb–", "", &
hå_”rÜ
);

544 
	`g_ä“
(
ty³
);

545 
	`g_ä“
(
scheme
);

550 
	`dbus_”rÜ_ä“
(&
hå_”rÜ
);

553 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.is_disc", 
is_cdrom
, &
hå_”rÜ
);

554 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.is_·¹™iÚ", 
is_·¹™iÚ
, &
hå_”rÜ
);

556 
	`libh®_deviû_£t_´İ”ty_boŞ
(
hå_ùx
, 
hå_udi
, "vŞume.ignÜe", 
has_chd»n
 || 
is_sw­
, &
hå_”rÜ
);

558 ià(
has_chd»n
)

559 
u§ge
 = "partitiontable";

560 ià(
is_sw­
)

561 
u§ge
 = "other";

563 
vid
 ? vid->
u§ge_id
 : (
vŞume_id_u§ge
) -1)

565 
VOLUME_ID_FILESYSTEM
: 
u§ge
 = "filesystem"; ;

566 
VOLUME_ID_DISKLABEL
: 
u§ge
 = "disklabel"; ;

567 
VOLUME_ID_OTHER
: 
u§ge
 = "other"; ;

568 
VOLUME_ID_RAID
: 
u§ge
 = "raid"; ;

569 
VOLUME_ID_CRYPTO
: 
u§ge
 = "crypto"; ;

570 
VOLUME_ID_UNUSED
: 
u§ge
 = "unused"; ;

571 : 
u§ge
 = "unknown"; ;

574 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.fsu§ge", 
u§ge
, &
hå_”rÜ
);

575 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.f¡y³", 
vid
 ? vid->
ty³
: "", &
hå_”rÜ
);

576 ià(
vid
 && *vid->
ty³_v”siÚ
)

577 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.fsv”siÚ", 
vid
->
ty³_v”siÚ
, &
hå_”rÜ
);

579 
Ïb–
 = 
	`hf_´obe_vŞume_g‘_Ïb–
(
vid
);

580 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.Ïb–", 
Ïb–
 ?†ab– : "", &
hå_”rÜ
);

581 
	`g_ä“
(
Ïb–
);

583 
	`libh®_deviû_£t_´İ”ty_¡ršg
(
hå_ùx
, 
hå_udi
, "vŞume.uuid", 
vid
 ? vid->
uuid
 : "", &
hå_”rÜ
);

585 
	`ioùl
(
fd
, 
DIOCGSECTORSIZE
, &
£ùÜ_size
);

587 ià(
£ùÜ_size
 != 0)

588 
	`libh®_deviû_£t_´İ”ty_ušt64
(
hå_ùx
, 
hå_udi
, "vŞume.block_size", 
£ùÜ_size
, &
hå_”rÜ
);

589 ià(
medŸ_size
 != 0)

590 
	`libh®_deviû_£t_´İ”ty_ušt64
(
hå_ùx
, 
hå_udi
, "vŞume.size", 
medŸ_size
, &
hå_”rÜ
);

591 ià(
£ùÜ_size
 !ğ0 && 
medŸ_size
 != 0)

592 
	`libh®_deviû_£t_´İ”ty_ušt64
(
hå_ùx
, 
hå_udi
, "vŞume.num_blocks", 
medŸ_size
 / 
£ùÜ_size
, &
hå_”rÜ
);

594 
»t
 = 0;

596 
’d
:

597  
»t
;

598 
	}
}

	@hald/hal-file-monitor.h

23 #iâdeà
HAL_FILE_MONITOR_H


24 
	#HAL_FILE_MONITOR_H


	)

26 
	~<glib-objeù.h
>

28 
	gG_BEGIN_DECLS


30 
	#HAL_TYPE_FILE_MONITOR
 (
	`h®_fe_mÚ™Ü_g‘_ty³
 ())

	)

31 
	#HAL_FILE_MONITOR
(
o
è(
	`G_TYPE_CHECK_INSTANCE_CAST
 ((o), 
HAL_TYPE_FILE_MONITOR
, 
H®FeMÚ™Ü
))

	)

32 
	#HAL_FILE_MONITOR_CLASS
(
k
è(
	`G_TYPE_CHECK_CLASS_CAST
((k), 
HAL_TYPE_FILE_MONITOR
, 
H®FeMÚ™ÜCÏss
))

	)

33 
	#HAL_IS_FILE_MONITOR
(
o
è(
	`G_TYPE_CHECK_INSTANCE_TYPE
 ((o), 
HAL_TYPE_FILE_MONITOR
))

	)

34 
	#HAL_IS_FILE_MONITOR_CLASS
(
k
è(
	`G_TYPE_CHECK_CLASS_TYPE
 ((k), 
HAL_TYPE_FILE_MONITOR
))

	)

35 
	#HAL_FILE_MONITOR_GET_CLASS
(
o
è(
	`G_TYPE_INSTANCE_GET_CLASS
 ((o), 
HAL_TYPE_FILE_MONITOR
, 
H®FeMÚ™ÜCÏss
))

	)

37 
H®FeMÚ™ÜPriv©e
 
	tH®FeMÚ™ÜPriv©e
;

41 
GObjeù
 
	m·»Á
;

42 
H®FeMÚ™ÜPriv©e
 *
	m´iv
;

43 } 
	tH®FeMÚ™Ü
;

47 
GObjeùCÏss
 
	m·»Á_şass
;

48 } 
	tH®FeMÚ™ÜCÏss
;

52 
	mHAL_FILE_MONITOR_EVENT_NONE
 = 1 << 0,

53 
	mHAL_FILE_MONITOR_EVENT_ACCESS
 = 1 << 1,

54 
	mHAL_FILE_MONITOR_EVENT_CREATE
 = 1 << 2,

55 
	mHAL_FILE_MONITOR_EVENT_DELETE
 = 1 << 3,

56 
	mHAL_FILE_MONITOR_EVENT_CHANGE
 = 1 << 4,

57 } 
	tH®FeMÚ™ÜEv’t
;

61 
	mHAL_FILE_MONITOR_ERROR_GENERAL


62 } 
	tH®FeMÚ™ÜE¼Ü
;

64 
	#HAL_FILE_MONITOR_ERROR
 
	`h®_fe_mÚ™Ü_”rÜ_qu¬k
 ()

	)

66 (*
	tH®FeMÚ™ÜNÙifyFunc
è(
	tH®FeMÚ™Ü
 *
	tmÚ™Ü
,

67 
	tH®FeMÚ™ÜEv’t
 
	tev’t
,

68 cÚ¡ *
	t·th
,

69 
	tgpoš‹r
 
	tu£r_d©a
);

71 
GQu¬k
 
	`h®_fe_mÚ™Ü_”rÜ_qu¬k
 ();

72 
GTy³
 
	`h®_fe_mÚ™Ü_g‘_ty³
 ();

74 
H®FeMÚ™Ü
 * 
	`h®_fe_mÚ™Ü_Ãw
 ();

76 
gušt
 
	`h®_fe_mÚ™Ü_add_nÙify
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

77 cÚ¡ *
·th
,

78 
mask
,

79 
H®FeMÚ™ÜNÙifyFunc
 
nÙify_func
,

80 
gpoš‹r
 
d©a
);

81 
	`h®_fe_mÚ™Ü_»move_nÙify
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

82 
gušt
 
id
);

84 
G_END_DECLS


	@hald/hald.c

28 #ifdeà
HAVE_CONFIG_H


29 
	~<cÚfig.h
>

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

35 #ifdeà
HAVE_MALLOPT


36 
	~<m®loc.h
>

39 
	~<¡ršg.h
>

40 
	~<uni¡d.h
>

41 
	~<g‘İt.h
>

42 
	~<pwd.h
>

43 
	~<¡dšt.h
>

44 
	~<sys/¡©.h
>

45 
	~<fú.h
>

46 
	~<”ºo.h
>

47 
	~<sigÇl.h
>

48 
	~<g½.h
>

49 
	~<sy¦og.h
>

50 
	~<sys/time.h
>

51 
	~<sys/»sourû.h
>

52 
	~<dbus/dbus.h
>

53 
	~<dbus/dbus-glib.h
>

54 
	~<dbus/dbus-glib-lowËv–.h
>

58 
	~"logg”.h
"

59 
	~"h®d.h
"

60 
	~"deviû_¡Üe.h
"

61 
	~"deviû_šfo.h
"

62 
	~"os¥ec.h
"

63 
	~"h®d_dbus.h
"

64 
	~"ut.h
"

65 
	~"h®d_ruÂ”.h
"

66 
	~"ut_h–³r.h
"

67 
	~"mm­_ÿche.h
"

69 
	$d–‘e_pid
()

71 
	`uÆšk
(
HALD_PID_FILE
);

72 
	}
}

74 
H®DeviûStÜe
 *
	gglob®_deviû_li¡
 = 
NULL
;

76 
H®DeviûStÜe
 *
	g‹mpÜ¬y_deviû_li¡
 = 
NULL
;

80 
	$addÚ_‹rmš©ed
 (
H®Deviû
 *
deviû
, 
gušt32
 
ex™_ty³
,

81 
gšt
 
»tuº_code
, 
gch¬
 **
”rÜ
,

82 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

84 
	`HAL_INFO
 (("š‡ddÚ_‹rmš©ed fÜ udi=%s", 
	`h®_deviû_g‘_udi
 (
deviû
)));

91 ià(
	`h®_deviû_šc_num_»ady_addÚs
 (
deviû
)) {

92 ià(
	`h®_deviû_¬e_®l_addÚs_»ady
 (
deviû
)) {

93 
	`mªag”_£nd_sigÇl_deviû_added
 (
deviû
);

96 
	}
}

102 
	$gdl_¡Üe_chªged
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
,

103 
gboŞ—n
 
is_added
, 
gpoš‹r
 
u£r_d©a
)

105 ià(
is_added
) {

106 
H®DeviûSŒLi¡I‹r
 
™”
;

108 
	`HAL_INFO
 (("Added deviûØGDL; udi=%s", 
	`h®_deviû_g‘_udi
(
deviû
)));

110 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
deviû
, "šfo.addÚs", &
™”
);

111 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
™”
);

112 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
™”
)) {

113 cÚ¡ 
gch¬
 *
commªd_lše
;

114 
gch¬
 *
exŒa_’v
[2] = {"HALD_ACTION÷ddÚ", 
NULL
};

116 
commªd_lše
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
™”
);

118 ià(
	`h®d_ruÂ”_¡¬t
(
deviû
, 
commªd_lše
, 
exŒa_’v
, 
addÚ_‹rmš©ed
, 
NULL
, NULL)) {

119 
	`HAL_INFO
 (("Started‡ddon %s for udi %s",

120 
commªd_lše
, 
	`h®_deviû_g‘_udi
(
deviû
)));

121 
	`h®_deviû_šc_num_addÚs
 (
deviû
);

123 
	`HAL_ERROR
 (("Cannot start‡ddon %s for udi %s",

124 
commªd_lše
, 
	`h®_deviû_g‘_udi
(
deviû
)));

127 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
deviû
, "šfo.addÚs.sšgËtÚ", &
™”
);

128 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
™”
);

129 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
™”
)) {

130 cÚ¡ 
gch¬
 *
commªd_lše
;

132 
commªd_lše
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
™”
);

134 ià(
	`h®d_sšgËtÚ_deviû_added
 (
commªd_lše
, 
deviû
))

135 
	`h®_deviû_šc_num_addÚs
 (
deviû
);

137 
	`HAL_ERROR
(("Couldn't‡dd deviceo singleton"));

141 
H®DeviûSŒLi¡I‹r
 
™”
;

143 
	`HAL_INFO
 (("Removed deviû from GDL; udi=%s", 
	`h®_deviû_g‘_udi
(
deviû
)));

144 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
deviû
, "šfo.addÚs.sšgËtÚ", &
™”
);

145 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
™”
);

146 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
™”
)) {

147 cÚ¡ 
gch¬
 *
commªd_lše
;

149 
commªd_lše
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
™”
);

151 
	`h®d_sšgËtÚ_deviû_»moved
 (
commªd_lše
, 
deviû
);

154 
	`h®d_ruÂ”_kl_deviû
(
deviû
);

159 ià(
is_added
) {

160 ià(
	`h®_deviû_¬e_®l_addÚs_»ady
 (
deviû
)) {

161 
	`mªag”_£nd_sigÇl_deviû_added
 (
deviû
);

164 ià(
	`h®_deviû_¬e_®l_addÚs_»ady
 (
deviû
)) {

165 
	`mªag”_£nd_sigÇl_deviû_»moved
 (
deviû
);

168 
	}
}

171 
	$gdl_´İ”ty_chªged
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
,

172 cÚ¡ *
key
, 
gboŞ—n
 
added
, gboŞ—À
»moved
,

173 
gpoš‹r
 
u£r_d©a
)

175 ià(
	`h®_deviû_¬e_®l_addÚs_»ady
 (
deviû
)) {

176 
	`deviû_£nd_sigÇl_´İ”ty_modif›d
 (
deviû
, 
key
, 
»moved
, 
added
);

180 ià(
added
 =ğ
FALSE
 && 
»moved
 == FALSE)

182 
	}
}

185 
	$gdl_ÿ·b™y_added
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
,

186 cÚ¡ *
ÿ·b™y
, 
gpoš‹r
 
u£r_d©a
)

188 ià(
	`h®_deviû_¬e_®l_addÚs_»ady
 (
deviû
)) {

189 
	`mªag”_£nd_sigÇl_Ãw_ÿ·b™y
 (
deviû
, 
ÿ·b™y
);

192 
	}
}

195 
	$gdl_lock_acquœed
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
, cÚ¡ *
lock_Çme
, cÚ¡ *
lock_owÃr
)

197 ià(
	`h®_deviû_¬e_®l_addÚs_»ady
 (
deviû
)) {

198 ià(
	`¡ºcmp
 (
lock_Çme
, "Global.", 7) == 0 &&

199 
	`¡rcmp
 (
	`h®_deviû_g‘_udi
 (
deviû
), "/org/freedesktop/Hal/devices/computer") == 0) {

200 
	`mªag”_£nd_sigÇl_š‹rçû_lock_acquœed
 (
lock_Çme
 + 7, 
lock_owÃr
);

202 
	`deviû_£nd_sigÇl_š‹rçû_lock_acquœed
 (
deviû
, 
lock_Çme
, 
lock_owÃr
);

205 
	}
}

208 
	$gdl_lock_»Ëa£d
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
, cÚ¡ *
lock_Çme
, cÚ¡ *
lock_owÃr
)

210 ià(
	`h®_deviû_¬e_®l_addÚs_»ady
 (
deviû
)) {

211 ià(
	`¡ºcmp
 (
lock_Çme
, "Global.", 7) == 0 &&

212 
	`¡rcmp
 (
	`h®_deviû_g‘_udi
 (
deviû
), "/org/freedesktop/Hal/devices/computer") == 0) {

213 
	`mªag”_£nd_sigÇl_š‹rçû_lock_»Ëa£d
 (
lock_Çme
 + 7, 
lock_owÃr
);

215 
	`deviû_£nd_sigÇl_š‹rçû_lock_»Ëa£d
 (
deviû
, 
lock_Çme
, 
lock_owÃr
);

218 
	}
}

220 
H®DeviûStÜe
 *

221 
	$h®d_g‘_gdl
 ()

223 ià(
glob®_deviû_li¡
 =ğ
NULL
) {

224 
glob®_deviû_li¡
 = 
	`h®_deviû_¡Üe_Ãw
 ();

226 
	`g_sigÇl_cÚÃù
 (
glob®_deviû_li¡
,

228 
	`G_CALLBACK
 (
gdl_¡Üe_chªged
), 
NULL
);

229 
	`g_sigÇl_cÚÃù
 (
glob®_deviû_li¡
,

231 
	`G_CALLBACK
 (
gdl_´İ”ty_chªged
), 
NULL
);

232 
	`g_sigÇl_cÚÃù
 (
glob®_deviû_li¡
,

234 
	`G_CALLBACK
 (
gdl_ÿ·b™y_added
), 
NULL
);

235 
	`g_sigÇl_cÚÃù
 (
glob®_deviû_li¡
,

237 
	`G_CALLBACK
 (
gdl_lock_acquœed
), 
NULL
);

238 
	`g_sigÇl_cÚÃù
 (
glob®_deviû_li¡
,

240 
	`G_CALLBACK
 (
gdl_lock_»Ëa£d
), 
NULL
);

243  
glob®_deviû_li¡
;

244 
	}
}

246 
H®DeviûStÜe
 *

247 
	$h®d_g‘_tdl
 ()

249 ià(
‹mpÜ¬y_deviû_li¡
 =ğ
NULL
) {

250 
‹mpÜ¬y_deviû_li¡
 = 
	`h®_deviû_¡Üe_Ãw
 ();

254  
‹mpÜ¬y_deviû_li¡
;

255 
	}
}

258 
	$h®d_compu‹_udi
 (
gch¬
 *
d¡
, 
gsize
 
d¡size
, cÚ¡ gch¬ *
fÜm©
, ...)

260 
i
;

261 
buf
[256];

262 
va_li¡
 
¬gs
;

264 
	`va_¡¬t
 (
¬gs
, 
fÜm©
);

265 
	`h®_ut_compu‹_udi_v®i¡
 (
	`h®d_g‘_gdl
 (), 
d¡
, 
d¡size
, 
fÜm©
, 
¬gs
);

266 
	`va_’d
 (
¬gs
);

268 
	`h®_ut_v®id©e_udi
 (
d¡
, 
d¡size
);

270 ià(
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
d¡
è=ğ
NULL
 &&

271 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
d¡
è=ğ
NULL
)

272 
out
;

274 
i
 = 0; ; i++) {

275 
	`g_¢´štf
 (
buf
, (buf), "%s_%d", 
d¡
, 
i
);

276 ià(
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
buf
è=ğ
NULL
 &&

277 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
buf
è=ğ
NULL
) {

278 
	`g_¡¾ıy
 (
d¡
, 
buf
, 
d¡size
);

279 
out
;

283 
out
:

286 
	}
}

294 
	$u§ge
 ()

296 
	`årštf
 (
¡d”r
, "\n" "usage : hald [--daemon=yes|no] [--verbose=yes|no] [--help]\n");

297 
	`årštf
 (
¡d”r
,

319 
	}
}

322 
dbus_boŞ_t
 
	gİt_become_d«mÚ
 = 
TRUE
;

325 
dbus_boŞ_t
 
	gİt_»š_´iveges
 = 
FALSE
;

328 
dbus_boŞ_t
 
	gh®d_is_v”bo£
 = 
FALSE
;

329 
dbus_boŞ_t
 
	gh®d_u£_sy¦og
 = 
FALSE
;

330 
dbus_boŞ_t
 
	gh®d_debug_ex™_aá”_´obšg
 = 
FALSE
;

332 #ifdeà
HAVE_POLKIT


333 
PŞK™CÚ‹xt
 *
	gpk_cÚ‹xt
;

336 
	gsig‹rm_unix_sigÇl_pe_fds
[2];

337 
GIOChªÃl
 *
	gsig‹rm_iochn
;

340 
	$hªdË_sig‹rm
 (
v®ue
)

342 
ssize_t
 
wr™‹n
;

343 
m¬k”
[1] = {'S'};

351 
wr™‹n
 = 
	`wr™e
 (
sig‹rm_unix_sigÇl_pe_fds
[1], 
m¬k”
, 1);

352 
	}
}

354 
gboŞ—n


355 
	$sig‹rm_iochn_d©a
 (
GIOChªÃl
 *
sourû
,

356 
GIOCÚd™iÚ
 
cÚd™iÚ
,

357 
gpoš‹r
 
u£r_d©a
)

359 
GE¼Ü
 *
”r
 = 
NULL
;

360 
gch¬
 
d©a
[1];

361 
gsize
 
by‹s_»ad
;

364 ià(
G_IO_STATUS_NORMAL
 !=

365 
	`g_io_chªÃl_»ad_ch¬s
 (
sourû
, 
d©a
, 1, &
by‹s_»ad
, &
”r
)) {

366 
	`HAL_ERROR
 (("Errorƒmptying sigterm…ipe: %s",

367 
”r
->
mes§ge
));

368 
	`g_”rÜ_ä“
 (
”r
);

369 
out
;

372 
	`HAL_INFO
 (("Caught SIGTERM, initiating shutdown"));

373 
	`h®d_ruÂ”_kl_®l
();

374 
	`ex™
 (0);

376 
out
:

377  
TRUE
;

378 
	}
}

382 
dbus_boŞ_t
 
	gh®d_is_š™Ÿlisšg
;

384 
	g¡¬tup_d«mÚize_pe
[2];

389 
gboŞ—n
 
	gchd_d›d
 = 
FALSE
;

392 
	$hªdË_sigchld
 (
v®ue
)

394 
chd_d›d
 = 
TRUE
;

395 
	}
}

398 
	$·»Á_wa™_fÜ_chd
 (
gušt
 
timeout
, 
chd_fd
, 
pid_t
 
chd_pid
)

400 
fd_£t
 
rfds
;

401 
fd_£t
 
efds
;

402 
timev®
 
tv
;

403 
»tv®
;

404 
»t
;

406 
	`sigÇl
(
SIGCHLD
, 
hªdË_sigchld
);

421 
	`FD_ZERO
(&
rfds
);

422 
	`FD_SET
(
chd_fd
, &
rfds
);

423 
	`FD_ZERO
(&
efds
);

424 
	`FD_SET
(
chd_fd
, &
efds
);

426 
tv
.
tv_£c
 = 
timeout
;

427 
tv
.
tv_u£c
 = 0;

429 
»tv®
 = 
	`£Ëù
 (
chd_fd
 + 1, &
rfds
, 
NULL
, &
efds
, &
tv
);

431 ià(
chd_d›d
) {

433 
»t
 = 1;

434 
out
;

437 ià(
»tv®
 > 0) {

439 
»t
 = 0;

440 
out
;

444 
	`kl
 (
chd_pid
, 
SIGTERM
);

445 
»t
 = 2;

447 
out
:

448  
»t
;

449 
	}
}

453 #ifdeà
HAVE_POLKIT


455 
gboŞ—n


456 
	$_pŞk™_io_w©ch_have_d©a
 (
GIOChªÃl
 *
chªÃl
, 
GIOCÚd™iÚ
 
cÚd™iÚ
, 
gpoš‹r
 
u£r_d©a
)

458 
fd
;

459 
PŞK™CÚ‹xt
 *
pk_cÚ‹xt
 = 
u£r_d©a
;

460 
fd
 = 
	`g_io_chªÃl_unix_g‘_fd
 (
chªÃl
);

461 
	`pŞk™_cÚ‹xt_io_func
 (
pk_cÚ‹xt
, 
fd
);

462  
TRUE
;

463 
	}
}

466 
	$_pŞk™_io_add_w©ch
 (
PŞK™CÚ‹xt
 *
pk_cÚ‹xt
, 
fd
)

468 
gušt
 
id
 = 0;

469 
GIOChªÃl
 *
chªÃl
;

470 
chªÃl
 = 
	`g_io_chªÃl_unix_Ãw
 (
fd
);

471 ià(
chªÃl
 =ğ
NULL
)

472 
out
;

473 
id
 = 
	`g_io_add_w©ch
 (
chªÃl
, 
G_IO_IN
, 
_pŞk™_io_w©ch_have_d©a
, 
pk_cÚ‹xt
);

474 ià(
id
 == 0) {

475 
	`g_io_chªÃl_uÄef
 (
chªÃl
);

476 
out
;

478 
	`g_io_chªÃl_uÄef
 (
chªÃl
);

479 
out
:

480  
id
;

481 
	}
}

484 
	$_pŞk™_io_»move_w©ch
 (
PŞK™CÚ‹xt
 *
pk_cÚ‹xt
, 
w©ch_id
)

486 
	`g_sourû_»move
 (
w©ch_id
);

487 
	}
}

489 
gušt
 
	g_pŞk™_coŞoff_tim”
 = 0;

491 
gboŞ—n


492 
	$_pŞk™_cÚfig_»®ly_chªged
 (
gpoš‹r
 
u£r_d©a
)

494 
	`HAL_INFO
 (("Acting on PolicyKit config change"));

495 
_pŞk™_coŞoff_tim”
 = 0;

496 
	`»cÚfigu»_®l_pŞicy
 ();

497  
FALSE
;

498 
	}
}

501 
	$_pŞk™_cÚfig_chªged_cb
 (
PŞK™CÚ‹xt
 *
pk_cÚ‹xt
, 
gpoš‹r
 
u£r_d©a
)

503 
	`HAL_INFO
 (("PolicyKit„eportshathe config have changed; starting cool-offimer"));

509 ià(
_pŞk™_coŞoff_tim”
 > 0) {

511 
	`g_sourû_»move
 (
_pŞk™_coŞoff_tim”
);

512 
	`HAL_INFO
 (("restarting cool-offimer"));

514 #ifdeà
HAVE_GLIB_2_14


515 
_pŞk™_coŞoff_tim”
 = 
	`g_timeout_add_£cÚds
 (1,

516 
_pŞk™_cÚfig_»®ly_chªged
,

517 
NULL
);

519 
_pŞk™_coŞoff_tim”
 = 
	`g_timeout_add
 (1000,

520 
_pŞk™_cÚfig_»®ly_chªged
,

521 
NULL
);

523 
	}
}

537 
	$maš
 (
¬gc
, *
¬gv
[])

539 
GMašLoİ
 *
loİ
;

540 
gušt
 
sig‹rm_iochn_li¡’”_sourû_id
;

541 *
·th
;

542 
Ãw·th
[512];

543 
gušt
 
İt_chd_timeout
;

544 #ifdeà
HAVE_POLKIT


545 
PŞK™E¼Ü
 *
p_”rÜ
;

547 
	`İ’log
 ("h®d", 
LOG_PID
, 
LOG_DAEMON
);

549 #ifdeà
HAVE_MALLOPT


551 
	#HAL_MMAP_THRESHOLD
 100

	)

552 
	#HAL_TRIM_THRESHOLD
 100

	)

557 
	`m®lİt
(
M_MMAP_THRESHOLD
, 
HAL_MMAP_THRESHOLD
);

558 
	`m®lİt
(
M_TRIM_THRESHOLD
, 
HAL_TRIM_THRESHOLD
);

562 #ifdeà
HALD_MEMLEAK_DBG


566 
	`g_ty³_š™
 ();

568 ià(
	`g‘’v
 ("HALD_VERBOSE"))

569 
h®d_is_v”bo£
 = 
TRUE
;

571 
h®d_is_v”bo£
 = 
FALSE
;

577 
·th
 = 
	`g‘’v
 ("PATH");

578 ià(
·th
 !ğ
NULL
) {

579 
	`g_¡¾ıy
 (
Ãw·th
, 
·th
,  (newpath));

580 
	`g_¡¾ÿt
 (
Ãw·th
, ":",  (newpath));

583 
Ãw·th
[0] = '\0';

586 
	`g_¡¾ÿt
 (
Ãw·th
, 
PACKAGE_LIBEXEC_DIR
,  (newpath));

587 
	`g_¡¾ÿt
 (
Ãw·th
, ":",  (newpath));

588 
	`g_¡¾ÿt
 (
Ãw·th
, 
PACKAGE_SCRIPT_DIR
,  (newpath));

590 
	`£‹nv
 ("PATH", 
Ãw·th
, 
TRUE
);

593 
İt_chd_timeout
 = 250;

596 
c
;

597 
İtiÚ_šdex
 = 0;

598 cÚ¡ *
İt
;

599 
İtiÚ
 
lÚg_İtiÚs
[] = {

600 {"ex™-aá”-´obšg", 0, 
NULL
, 0},

601 {"d«mÚ", 1, 
NULL
, 0},

602 {"v”bo£", 1, 
NULL
, 0},

603 {"»š-´iveges", 0, 
NULL
, 0},

604 {"chd-timeout", 1, 
NULL
, 0},

605 {"u£-sy¦og", 0, 
NULL
, 0},

606 {"h–p", 0, 
NULL
, 0},

607 {"v”siÚ", 0, 
NULL
, 0},

608 {
NULL
, 0, NULL, 0}

611 
c
 = 
	`g‘İt_lÚg
 (
¬gc
, 
¬gv
, "",

612 
lÚg_İtiÚs
, &
İtiÚ_šdex
);

613 ià(
c
 == -1)

616 
c
) {

618 
İt
 = 
lÚg_İtiÚs
[
İtiÚ_šdex
].
Çme
;

620 ià(
	`¡rcmp
 (
İt
, "help") == 0) {

621 
	`u§ge
 ();

623 } ià(
	`¡rcmp
 (
İt
, "version") == 0) {

624 
	`årštf
 (
¡d”r
, "HAL…ackagv”siÚ: " 
PACKAGE_VERSION
 "\n");

626 } ià(
	`¡rcmp
 (
İt
, "exit-after-probing") == 0) {

627 
h®d_debug_ex™_aá”_´obšg
 = 
TRUE
;

628 } ià(
	`¡rcmp
 (
İt
, "child-timeout") == 0) {

629 
İt_chd_timeout
 = 
	`©oi
 (
İrg
);

630 } ià(
	`¡rcmp
 (
İt
, "daemon") == 0) {

631 ià(
	`¡rcmp
 ("yes", 
İrg
) == 0) {

632 
İt_become_d«mÚ
 = 
TRUE
;

633 } ià(
	`¡rcmp
 ("no", 
İrg
) == 0) {

634 
İt_become_d«mÚ
 = 
FALSE
;

636 
	`u§ge
 ();

639 } ià(
	`¡rcmp
 (
İt
, "verbose") == 0) {

640 ià(
	`¡rcmp
 ("yes", 
İrg
) == 0) {

641 
h®d_is_v”bo£
 = 
TRUE
;

642 } ià(
	`¡rcmp
 ("no", 
İrg
) == 0) {

643 
h®d_is_v”bo£
 = 
FALSE
;

645 
	`u§ge
 ();

648 } ià(
	`¡rcmp
 (
İt
, "retain-privileges") == 0) {

649 
İt_»š_´iveges
 = 
TRUE
;

650 } ià(
	`¡rcmp
 (
İt
, "use-syslog") == 0) {

651 
h®d_u£_sy¦og
 = 
TRUE
;

657 
	`u§ge
 ();

663 ià(
h®d_is_v”bo£
)

664 
	`logg”_’abË
 ();

666 
	`logg”_di§bË
 ();

668 ià(
h®d_u£_sy¦og
)

669 
	`logg”_’abË_sy¦og
 ();

671 
	`logg”_di§bË_sy¦og
 ();

678 
loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

680 
	`HAL_INFO
 ((
PACKAGE_STRING
));

681 
	`HAL_INFO
 (("usšg chdimeouˆ%is", 
İt_chd_timeout
));

683 ià(
İt_become_d«mÚ
) {

684 
chd_pid
;

685 
dev_nuÎ_fd
;

686 
pf
;

687 
ssize_t
 
wr™‹n
;

688 
pid
[9];

690 
	`HAL_INFO
 (("Will daemonize"));

691 
	`HAL_INFO
 (("Becoming‡ daemon"));

693 ià(
	`pe
 (
¡¬tup_d«mÚize_pe
) != 0) {

694 
	`årštf
 (
¡d”r
, "Could‚Ù s‘u°pe: %s\n", 
	`¡»¼Ü
(
”ºo
));

695 
	`ex™
 (1);

699 ià(
	`chdœ
 ("/") < 0) {

700 
	`årštf
 (
¡d”r
, "Could‚Ù chdœØ/: %s\n", 
	`¡»¼Ü
(
”ºo
));

701 
	`ex™
 (1);

704 
chd_pid
 = 
	`fÜk
 ();

705 
chd_pid
) {

707 
	`årštf
 (
¡d”r
, "CªnÙ fÜk(): %s\n", 
	`¡»¼Ü
(
”ºo
));

713 
dev_nuÎ_fd
 = 
	`İ’
 ("/dev/nuÎ", 
O_RDWR
);

715 ià(
dev_nuÎ_fd
 >= 0) {

717 
	`dup2
 (
dev_nuÎ_fd
, 0);

718 
	`dup2
 (
dev_nuÎ_fd
, 1);

719 
	`dup2
 (
dev_nuÎ_fd
, 2);

720 
	`şo£
 (
dev_nuÎ_fd
);

723 
	`umask
 (022);

728 
	`ex™
 (
	`·»Á_wa™_fÜ_chd
 (
İt_chd_timeout
, 
¡¬tup_d«mÚize_pe
[0], 
chd_pid
));

733 
	`£tsid
 ();

736 
	`uÆšk
 (
HALD_PID_FILE
);

739 ià((
pf
ğ
	`İ’
 (
HALD_PID_FILE
, 
O_WRONLY
|
O_CREAT
|
O_TRUNC
|
O_EXCL
, 0644)) > 0) {

740 
	`¢´štf
 (
pid
, Õid), "%lu\n", (è
	`g‘pid
 ());

741 
wr™‹n
 = 
	`wr™e
 (
pf
, 
pid
, 
	`¡¾’
(pid));

742 
	`şo£
 (
pf
);

743 
	`©ex™
 (
d–‘e_pid
);

746 
	`HAL_INFO
 (("Will‚ot daemonize"));

755 ià(
	`pe
 (
sig‹rm_unix_sigÇl_pe_fds
) != 0) {

756 
	`DIE
 (("Could‚Ù s‘u°pe,ƒ¼no=%d", 
”ºo
));

760 
sig‹rm_iochn
 = 
	`g_io_chªÃl_unix_Ãw
 (
sig‹rm_unix_sigÇl_pe_fds
[0]);

761 ià(
sig‹rm_iochn
 =ğ
NULL
)

762 
	`DIE
 (("Could‚ot create GIOChannel"));

765 
sig‹rm_iochn_li¡’”_sourû_id
 = 
	`g_io_add_w©ch
 (

766 
sig‹rm_iochn
, 
G_IO_IN
, 
sig‹rm_iochn_d©a
, 
NULL
);

769 
	`sigÇl
 (
SIGTERM
, 
hªdË_sig‹rm
);

772 ià(!
	`h®d_dbus_loÿl_£rv”_š™
 ())

775 ià(!
	`h®d_dbus_š™_´•robe
 ()) {

780 ià(!
	`h®d_ruÂ”_¡¬t_ruÂ”
 ()) {

785 
	`os¥ec_´iveged_š™
 ();

787 #ifdeà
HAVE_POLKIT


788 
p_”rÜ
 = 
NULL
;

789 
pk_cÚ‹xt
 = 
	`pŞk™_cÚ‹xt_Ãw
 ();

790 ià(
pk_cÚ‹xt
 =ğ
NULL
)

791 
	`DIE
 (("Could‚ot create PolicyKit context"));

792 
	`pŞk™_cÚ‹xt_£t_cÚfig_chªged
 (
pk_cÚ‹xt
,

793 
_pŞk™_cÚfig_chªged_cb
,

794 
NULL
);

795 
	`pŞk™_cÚ‹xt_£t_io_w©ch_funùiÚs
 (
pk_cÚ‹xt
, 
_pŞk™_io_add_w©ch
, 
_pŞk™_io_»move_w©ch
);

796 ià(!
	`pŞk™_cÚ‹xt_š™
 (
pk_cÚ‹xt
, &
p_”rÜ
))

797 
	`DIE
 (("Could‚Ù in™ PŞicyK™ cÚ‹xt: %s", 
	`pŞk™_”rÜ_g‘_”rÜ_mes§ge
 (
p_”rÜ
)));

802 ià(
İt_»š_´iveges
 =ğ
FALSE
) {

803 
	`drİ_´iveges
(0);

806 
h®d_is_š™Ÿlisšg
 = 
TRUE
;

809 
	`di_ÿche_coh”’cy_check
(
TRUE
);

812 
	`os¥ec_š™
 ();

815 
	`di_ruËs_š™
();

818 
	`os¥ec_´obe
 ();

821 
	`g_maš_loİ_run
 (
loİ
);

824 
	}
}

826 #ifdeà
HALD_MEMLEAK_DBG


827 
dbg_h®_deviû_objeù_d–
;

830 
gboŞ—n


831 
	$my_shutdown2
 (
gpoš‹r
 
d©a
)

835 
	`ex™
 (1);

836  
FALSE
;

837 
	}
}

839 
gboŞ—n


840 
	$my_shutdown
 (
gpoš‹r
 
d©a
)

842 
H®DeviûStÜe
 *
gdl
;

844 
	`HAL_INFO
 (("Num deviû š TDL: %d", 
	`g_¦i¡_Ëngth
 ((
	`h®d_g‘_tdl
 ())->
deviûs
)));

845 
	`HAL_INFO
 (("Num deviû š GDL: %d", 
	`g_¦i¡_Ëngth
 ((
	`h®d_g‘_gdl
 ())->
deviûs
)));

847 
gdl
 = 
	`h®d_g‘_gdl
 ();

848 
Ãxt
:

849 ià(
	`g_¦i¡_Ëngth
 (
gdl
->
deviûs
) > 0) {

850 
H®Deviû
 *
d
 = 
	`HAL_DEVICE
(
gdl
->
deviûs
->
d©a
);

851 
	`h®_deviû_¡Üe_»move
 (
gdl
, 
d
);

852 
	`g_objeù_uÄef
 (
d
);

853 
Ãxt
;

856 
	`HAL_INFO
 (("h®_deviû_objeù_d– = %d (should bz”o)", 
dbg_h®_deviû_objeù_d–
));

858 
	`h®d_dbus_loÿl_£rv”_shutdown
 ();

859 
	`h®d_ruÂ”_¡İ_ruÂ”
 ();

861 
	`HAL_INFO
 (("Shutting down in five seconds"));

862 
	`g_timeout_add
 (5 * 1000,

863 
my_shutdown2
,

864 
NULL
);

866  
FALSE
;

867 
	}
}

871 
	$os¥ec_´obe_dÚe
 ()

873 
ssize_t
 
wr™‹n
;

874 
buf
[1] = {0};

876 
	`HAL_INFO
 (("Device…robing completed"));

878 ià(
h®d_debug_ex™_aá”_´obšg
) {

879 
	`HAL_INFO
 (("Exiting on user„equest (--exit-after-probing)"));

880 
	`h®d_ruÂ”_kl_®l
();

881 
	`ex™
 (0);

885 ià(!
	`h®d_dbus_š™
 ()) {

886 
	`h®d_ruÂ”_kl_®l
();

887 
	`ex™
 (1);

891 
wr™‹n
 = 
	`wr™e
 (
¡¬tup_d«mÚize_pe
[1], 
buf
,  (buf));

892 
	`şo£
 (
¡¬tup_d«mÚize_pe
[0]);

893 
	`şo£
 (
¡¬tup_d«mÚize_pe
[1]);

895 
h®d_is_š™Ÿlisšg
 = 
FALSE
;

897 #ifdeà
HALD_MEMLEAK_DBG


898 
	`g_timeout_add
 ((
HALD_MEMLEAK_DBG
) * 1000,

899 
my_shutdown
,

900 
NULL
);

902 
	}
}

	@hald/hald.h

26 #iâdeà
HALD_H


27 
	#HALD_H


	)

29 #iâdeà
DBUS_API_SUBJECT_TO_CHANGE


30 
	#DBUS_API_SUBJECT_TO_CHANGE


	)

33 
	~<¡d¬g.h
>

34 
	~<¡dšt.h
>

35 
	~<dbus/dbus.h
>

36 #ifdeà
HAVE_POLKIT


37 
	~<pŞk™/pŞk™.h
>

40 
	~"deviû_¡Üe.h
"

42 #ifdeà
HAVE_POLKIT


43 
PŞK™CÚ‹xt
 *
pk_cÚ‹xt
;

47 
H®DeviûStÜe
 *
h®d_g‘_gdl
 ();

48 
H®DeviûStÜe
 *
h®d_g‘_tdl
 ();

50 
h®d_compu‹_udi
 (
gch¬
 *
d¡
, 
gsize
 
d¡size
, cÚ¡ gch¬ *
fÜm©
, ...);

52 
´İ”ty_©omic_upd©e_begš
 ();

53 
´İ”ty_©omic_upd©e_’d
 ();

55 
dbus_boŞ_t
 
h®d_is_v”bo£
;

56 
dbus_boŞ_t
 
h®d_u£_sy¦og
;

57 
dbus_boŞ_t
 
h®d_is_š™Ÿlisšg
;

58 
dbus_boŞ_t
 
h®d_is_shu‰šg_down
;

	@hald/hald_dbus.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dlib.h
>

32 
	~<¡dio.h
>

33 
	~<¡ršg.h
>

34 
	~<uni¡d.h
>

35 
	~<¡d¬g.h
>

36 
	~<¡dšt.h
>

37 
	~<sys/time.h
>

38 
	~<glib.h
>

39 
	~<glib/g´štf.h
>

40 
	~<dbus/dbus.h
>

41 
	~<dbus/dbus-glib-lowËv–.h
>

43 
	~"h®d.h
"

44 
	~"h®d_dbus.h
"

45 
	~"deviû.h
"

46 
	~"deviû_¡Üe.h
"

47 
	~"deviû_šfo.h
"

48 
	~"logg”.h
"

49 
	~"os¥ec.h
"

50 
	~"ut.h
"

51 
	~"h®d_ruÂ”.h
"

52 
	~"ci-Œack”.h
"

53 
	~"acûss-check.h
"

55 #ifdeà
HAVE_CONKIT


56 
	~"ck-Œack”.h
"

59 
	#HALD_DBUS_ADDRESS
 "unix:tmpdœ=" 
HALD_SOCKET_DIR


	)

61 
DBusCÚÃùiÚ
 *
	gdbus_cÚÃùiÚ
 = 
NULL
;

62 
CIT¿ck”
 *
	gci_Œack”
 = 
NULL
;

63 #ifdeà
HAVE_CONKIT


64 
CKT¿ck”
 *
	gck_Œack”
 = 
NULL
;

66 
GHashTabË
 *
	gsšgËtÚs
 = 
NULL
;

68 
fÜ—ch_´İ”ty_­³nd
 (
H®Deviû
 *
deviû
,

69 cÚ¡ *
key
,

70 
gpoš‹r
 
u£r_d©a
);

73 
	$¿i£_”rÜ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

74 
DBusMes§ge
 *
š_»¶y_to
,

75 cÚ¡ *
”rÜ_Çme
,

76 *
fÜm©
, ...è
	`__©Œibu‹__
((
	`fÜm©
 (
´štf
, 4, 5)));

88 
	$¿i£_”rÜ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

89 
DBusMes§ge
 *
š_»¶y_to
,

90 cÚ¡ *
”rÜ_Çme
,

91 *
fÜm©
, ...)

93 
buf
[512];

94 
DBusMes§ge
 *
»¶y
;

96 
va_li¡
 
¬gs
;

97 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

98 
	`v¢´štf
(
buf
,  buf, 
fÜm©
, 
¬gs
);

99 
	`va_’d
(
¬gs
);

102 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
š_»¶y_to
, 
”rÜ_Çme
, 
buf
);

103 ià(
»¶y
 =ğ
NULL
)

104 
	`DIE
 (("No memory"));

105 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

106 
	`DIE
 (("No memory"));

107 
	`dbus_mes§ge_uÄef
 (
»¶y
);

108 
	}
}

119 
	$¿i£_no_such_deviû
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

120 
DBusMes§ge
 *
š_»¶y_to
, cÚ¡ *
udi
)

122 
	`¿i£_”rÜ
 (

123 
cÚÃùiÚ
, 
š_»¶y_to
,

126 
udi


128 
	}
}

140 
	$¿i£_no_such_´İ”ty
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

141 
DBusMes§ge
 *
š_»¶y_to
,

142 cÚ¡ *
deviû_id
, cÚ¡ *
key
)

144 
	`¿i£_”rÜ
 (

145 
cÚÃùiÚ
, 
š_»¶y_to
,

148 
key
, 
deviû_id


150 
	}
}

162 
	$¿i£_´İ”ty_ty³_”rÜ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

163 
DBusMes§ge
 *
š_»¶y_to
,

164 cÚ¡ *
deviû_id
, cÚ¡ *
key
)

166 
	`¿i£_”rÜ
 (

167 
cÚÃùiÚ
, 
š_»¶y_to
,

170 
key
, 
deviû_id


172 
	}
}

184 
	$¿i£_syÁax
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

185 
DBusMes§ge
 *
š_»¶y_to
, cÚ¡ *
m‘hod_Çme
)

187 
	`¿i£_”rÜ
 (

188 
cÚÃùiÚ
, 
š_»¶y_to
,

191 
m‘hod_Çme


193 
	}
}

204 
	$¿i£_deviû_nÙ_locked
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

205 
DBusMes§ge
 *
š_»¶y_to
,

206 
H®Deviû
 *
deviû
)

208 
	`¿i£_”rÜ
 (

209 
cÚÃùiÚ
, 
š_»¶y_to
,

212 
	`h®_deviû_g‘_udi
 (
deviû
)

214 
	}
}

225 
	$¿i£_deviû_®»ady_locked
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

226 
DBusMes§ge
 *
š_»¶y_to
,

227 
H®Deviû
 *
deviû
)

229 
DBusMes§ge
 *
»¶y
;

230 cÚ¡ *
»asÚ
;

232 
»asÚ
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
deviû
, "info.locked.reason");

233 ià(
»asÚ
 !ğ
NULL
) {

234 
	`HAL_WARNING
 (("Deviû % i ®»ady†ocked: %s", 
	`h®_deviû_g‘_udi
 (
deviû
), 
»asÚ
));

236 
	`HAL_WARNING
 (("Deviû % i ®»ady†ocked", 
	`h®_deviû_g‘_udi
 (
deviû
)));

240 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
š_»¶y_to
,

242 
»asÚ
 !ğ
NULL
 ?„eason : "Device is‡lready†ocked");

244 ià(
»¶y
 =ğ
NULL
 || !
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
,„eply, NULL))

245 
	`DIE
 (("No memory"));

247 
	`dbus_mes§ge_uÄef
 (
»¶y
);

248 
	}
}

259 
	$¿i£_³rmissiÚ_d’›d
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

260 
DBusMes§ge
 *
š_»¶y_to
,

261 cÚ¡ *
»asÚ
)

263 
	`¿i£_”rÜ
 (

264 
cÚÃùiÚ
, 
š_»¶y_to
,

267 
»asÚ


269 
	}
}

281 
	$¿i£_š‹rçû_locked
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

282 
DBusMes§ge
 *
š_»¶y_to
,

283 cÚ¡ *
š‹rçû
)

285 
	`¿i£_”rÜ
 (
cÚÃùiÚ
, 
š_»¶y_to
,

288 
š‹rçû
);

289 
	}
}

300 
	$¿i£_š‹rçû_®»ady_locked
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

301 
DBusMes§ge
 *
š_»¶y_to
,

302 cÚ¡ *
š‹rçû
)

304 
	`¿i£_”rÜ
 (
cÚÃùiÚ
, 
š_»¶y_to
,

307 
š‹rçû
);

308 
	}
}

319 
	$¿i£_š‹rçû_nÙ_locked
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

320 
DBusMes§ge
 *
š_»¶y_to
,

321 cÚ¡ *
š‹rçû
)

323 
	`¿i£_”rÜ
 (
cÚÃùiÚ
, 
š_»¶y_to
,

326 
š‹rçû
);

327 
	}
}

330 
gboŞ—n


331 
	$fÜ—ch_deviû_g‘_udi
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
,

332 
gpoš‹r
 
u£r_d©a
)

334 
DBusMes§geI‹r
 *
™”
 = 
u£r_d©a
;

335 cÚ¡ *
udi
;

337 
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

338 
	`dbus_mes§ge_™”_­³nd_basic
 (
™”
, 
DBUS_TYPE_STRING
, &
udi
);

340  
TRUE
;

341 
	}
}

343 
gboŞ—n


344 
	$fÜ—ch_deviû_g‘_udi_w™h_´İ”t›s
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
, 
gpoš‹r
 
u£r_d©a
)

346 
DBusMes§geI‹r
 *
™”
 = 
u£r_d©a
;

347 
DBusMes§geI‹r
 
™”_¡ruù
;

348 
DBusMes§geI‹r
 
™”_diù
;

349 cÚ¡ *
udi
;

351 
	`dbus_mes§ge_™”_İ’_cÚš”
 (
™”
,

352 
DBUS_TYPE_STRUCT
,

353 
NULL
,

354 &
™”_¡ruù
);

356 
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

357 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_¡ruù
, 
DBUS_TYPE_STRING
, &
udi
);

359 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”_¡ruù
,

360 
DBUS_TYPE_ARRAY
,

361 
DBUS_DICT_ENTRY_BEGIN_CHAR_AS_STRING


362 
DBUS_TYPE_STRING_AS_STRING


363 
DBUS_TYPE_VARIANT_AS_STRING


364 
DBUS_DICT_ENTRY_END_CHAR_AS_STRING
,

365 &
™”_diù
);

367 
	`h®_deviû_´İ”ty_fÜ—ch
 (
deviû
, 
fÜ—ch_´İ”ty_­³nd
, &
™”_diù
);

369 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”_¡ruù
, &
™”_diù
);

370 
	`dbus_mes§ge_™”_şo£_cÚš”
 (
™”
, &
™”_¡ruù
);

371  
TRUE
;

372 
	}
}

388 
DBusHªdËrResuÉ


389 
	$mªag”_g‘_®l_deviûs_w™h_´İ”t›s
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

390 
DBusMes§ge
 * 
mes§ge
)

392 
DBusMes§ge
 *
»¶y
;

393 
DBusMes§geI‹r
 
™”
;

394 
DBusMes§geI‹r
 
™”_¬¿y
;

396 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

397 ià(
»¶y
 =ğ
NULL
)

398 
	`DIE
 (("No memory"));

400 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

401 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”
,

402 
DBUS_TYPE_ARRAY
,

404 &
™”_¬¿y
);

406 
	`h®_deviû_¡Üe_fÜ—ch
 (
	`h®d_g‘_gdl
 (),

407 
fÜ—ch_deviû_g‘_udi_w™h_´İ”t›s
,

408 &
™”_¬¿y
);

410 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”
, &
™”_¬¿y
);

412 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

413 
	`DIE
 (("No memory"));

415 
	`dbus_mes§ge_uÄef
 (
»¶y
);

417  
DBUS_HANDLER_RESULT_HANDLED
;

418 
	}
}

434 
DBusHªdËrResuÉ


435 
	$mªag”_g‘_®l_deviûs
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

436 
DBusMes§ge
 * 
mes§ge
)

438 
DBusMes§ge
 *
»¶y
;

439 
DBusMes§geI‹r
 
™”
;

440 
DBusMes§geI‹r
 
™”_¬¿y
;

442 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

443 ià(
»¶y
 =ğ
NULL
)

444 
	`DIE
 (("No memory"));

446 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

447 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”
,

448 
DBUS_TYPE_ARRAY
,

449 
DBUS_TYPE_STRING_AS_STRING
,

450 &
™”_¬¿y
);

452 
	`h®_deviû_¡Üe_fÜ—ch
 (
	`h®d_g‘_gdl
 (),

453 
fÜ—ch_deviû_g‘_udi
,

454 &
™”_¬¿y
);

456 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”
, &
™”_¬¿y
);

458 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

459 
	`DIE
 (("No memory"));

461 
	`dbus_mes§ge_uÄef
 (
»¶y
);

463  
DBUS_HANDLER_RESULT_HANDLED
;

464 
	}
}

467 cÚ¡ *
	mkey
;

468 cÚ¡ *
	mv®ue
;

469 
DBusMes§geI‹r
 *
	m™”
;

470 } 
	tDeviûM©chInfo
;

472 
gboŞ—n


473 
	$fÜ—ch_deviû_m©ch_g‘_udi
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
,

474 
gpoš‹r
 
u£r_d©a
)

476 
DeviûM©chInfo
 *
šfo
 = 
u£r_d©a
;

477 cÚ¡ *
dev_v®ue
;

479 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
deviû
,

480 
šfo
->
key
è!ğ
DBUS_TYPE_STRING
)

481  
TRUE
;

483 
dev_v®ue
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
deviû
, 
šfo
->
key
);

485 ià(
dev_v®ue
 !ğ
NULL
 && 
	`¡rcmp
 (dev_v®ue, 
šfo
->
v®ue
) == 0) {

486 cÚ¡ *
udi
;

487 
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

488 
	`dbus_mes§ge_™”_­³nd_basic
 (
šfo
->
™”
,

489 
DBUS_TYPE_STRING
,

490 &
udi
);

493  
TRUE
;

494 
	}
}

496 
gboŞ—n


497 
	$fÜ—ch_deviû_m©ch_g‘_udi_tdl
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
,

498 
gpoš‹r
 
u£r_d©a
)

500 
DeviûM©chInfo
 *
šfo
 = 
u£r_d©a
;

501 cÚ¡ *
dev_v®ue
;

504 ià(
	`¡ºcmp
 (
	`h®_deviû_g‘_udi
 (
deviû
), "/org/freedesktop/Hal/devices/temp",

506  
TRUE
;

508 ià(
	`h®_deviû_´İ”ty_g‘_ty³
 (
deviû
,

509 
šfo
->
key
è!ğ
DBUS_TYPE_STRING
)

510  
TRUE
;

512 
dev_v®ue
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
deviû
, 
šfo
->
key
);

514 ià(
dev_v®ue
 !ğ
NULL
 && 
	`¡rcmp
 (dev_v®ue, 
šfo
->
v®ue
) == 0) {

515 cÚ¡ *
udi
;

516 
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

518 
	`dbus_mes§ge_™”_­³nd_basic
 (
šfo
->
™”
,

519 
DBUS_TYPE_STRING
,

520 &
udi
);

523  
TRUE
;

524 
	}
}

542 
DBusHªdËrResuÉ


543 
	$mªag”_fšd_deviû_¡ršg_m©ch
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

544 
DBusMes§ge
 * 
mes§ge
)

546 
DBusMes§ge
 *
»¶y
;

547 
DBusMes§geI‹r
 
™”
;

548 
DBusMes§geI‹r
 
™”_¬¿y
;

549 
DBusE¼Ü
 
”rÜ
;

550 cÚ¡ *
key
;

551 cÚ¡ *
v®ue
;

552 
DeviûM©chInfo
 
šfo
;

554 
	`HAL_TRACE
 (("entering"));

556 
	`dbus_”rÜ_š™
 (&
”rÜ
);

557 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

558 
DBUS_TYPE_STRING
, &
key
,

559 
DBUS_TYPE_STRING
, &
v®ue
,

560 
DBUS_TYPE_INVALID
)) {

561 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
,

563  
DBUS_HANDLER_RESULT_HANDLED
;

566 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

567 ià(
»¶y
 =ğ
NULL
)

568 
	`DIE
 (("No memory"));

570 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

571 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”
,

572 
DBUS_TYPE_ARRAY
,

573 
DBUS_TYPE_STRING_AS_STRING
,

574 &
™”_¬¿y
);

576 
šfo
.
key
 = key;

577 
šfo
.
v®ue
 = value;

578 
šfo
.
™”
 = &
™”_¬¿y
;

580 
	`h®_deviû_¡Üe_fÜ—ch
 (
	`h®d_g‘_gdl
 (),

581 
fÜ—ch_deviû_m©ch_g‘_udi
,

582 &
šfo
);

585 
	`h®_deviû_¡Üe_fÜ—ch
 (
	`h®d_g‘_tdl
 (),

586 
fÜ—ch_deviû_m©ch_g‘_udi_tdl
,

587 &
šfo
);

589 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”
, &
™”_¬¿y
);

591 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

592 
	`DIE
 (("No memory"));

594 
	`dbus_mes§ge_uÄef
 (
»¶y
);

596  
DBUS_HANDLER_RESULT_HANDLED
;

597 
	}
}

600 cÚ¡ *
	mÿ·b™y
;

601 
DBusMes§geI‹r
 *
	m™”
;

602 } 
	tDeviûC­ab™yInfo
;

604 
gboŞ—n


605 
	$fÜ—ch_deviû_by_ÿ·b™y
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
, 
gpoš‹r
 
u£r_d©a
)

607 
DeviûC­ab™yInfo
 *
šfo
 = (DeviûC­ab™yInfØ*è
u£r_d©a
;

609 ià(
	`h®_deviû_has_ÿ·b™y
 (
deviû
, 
šfo
->
ÿ·b™y
)) {

610 cÚ¡ *
udi
;

611 
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

612 
	`dbus_mes§ge_™”_­³nd_basic
 (
šfo
->
™”
,

613 
DBUS_TYPE_STRING
,

614 &
udi
);

617  
TRUE
;

618 
	}
}

634 
DBusHªdËrResuÉ


635 
	$mªag”_fšd_deviû_by_ÿ·b™y
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

636 
DBusMes§ge
 * 
mes§ge
)

638 
DBusMes§ge
 *
»¶y
;

639 
DBusMes§geI‹r
 
™”
;

640 
DBusMes§geI‹r
 
™”_¬¿y
;

641 
DBusE¼Ü
 
”rÜ
;

642 cÚ¡ *
ÿ·b™y
;

643 
DeviûC­ab™yInfo
 
šfo
;

645 
	`HAL_TRACE
 (("entering"));

647 
	`dbus_”rÜ_š™
 (&
”rÜ
);

648 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

649 
DBUS_TYPE_STRING
, &
ÿ·b™y
,

650 
DBUS_TYPE_INVALID
)) {

651 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
,

653  
DBUS_HANDLER_RESULT_HANDLED
;

656 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

657 ià(
»¶y
 =ğ
NULL
)

658 
	`DIE
 (("No memory"));

660 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

661 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”
,

662 
DBUS_TYPE_ARRAY
,

663 
DBUS_TYPE_STRING_AS_STRING
,

664 &
™”_¬¿y
);

666 
šfo
.
ÿ·b™y
 = capability;

667 
šfo
.
™”
 = &
™”_¬¿y
;

669 
	`h®_deviû_¡Üe_fÜ—ch
 (
	`h®d_g‘_gdl
 (),

670 
fÜ—ch_deviû_by_ÿ·b™y
,

671 &
šfo
);

673 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”
, &
™”_¬¿y
);

675 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

676 
	`DIE
 (("No memory"));

678 
	`dbus_mes§ge_uÄef
 (
»¶y
);

680  
DBUS_HANDLER_RESULT_HANDLED
;

681 
	}
}

698 
DBusHªdËrResuÉ


699 
	$mªag”_deviû_exi¡s
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
)

701 
DBusMes§ge
 *
»¶y
;

702 
DBusMes§geI‹r
 
™”
;

703 
DBusE¼Ü
 
”rÜ
;

704 
H®Deviû
 *
d
;

705 cÚ¡ *
udi
;

706 
dbus_boŞ_t
 
b
;

708 
	`dbus_”rÜ_š™
 (&
”rÜ
);

709 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

710 
DBUS_TYPE_STRING
, &
udi
,

711 
DBUS_TYPE_INVALID
)) {

712 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "Manager.DeviceExists");

713  
DBUS_HANDLER_RESULT_HANDLED
;

716 
	`HAL_TRACE
 (("’‹ršg, udi=%s", 
udi
));

718 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

720 ià(
d
 =ğ
NULL
)

721 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

723 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

724 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

725 
b
 = 
d
 !ğ
NULL
;

726 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
b
);

728 ià(
»¶y
 =ğ
NULL
)

729 
	`DIE
 (("No memory"));

731 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

732 
	`DIE
 (("No memory"));

734 
	`dbus_mes§ge_uÄef
 (
»¶y
);

735  
DBUS_HANDLER_RESULT_HANDLED
;

736 
	}
}

747 
	$mªag”_£nd_sigÇl_deviû_added
 (
H®Deviû
 *
deviû
)

749 cÚ¡ *
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

750 
DBusMes§ge
 *
mes§ge
;

751 
DBusMes§geI‹r
 
™”
;

753 ià(
dbus_cÚÃùiÚ
 =ğ
NULL
 || 
h®d_is_š™Ÿlisšg
)

754 
out
;

756 
	`HAL_TRACE
 (("’‹ršg, udi=%s", 
udi
));

758 
mes§ge
 = 
	`dbus_mes§ge_Ãw_sigÇl
 ("/org/freedesktop/Hal/Manager",

762 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

763 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
udi
);

765 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
dbus_cÚÃùiÚ
, 
mes§ge
, 
NULL
))

766 
	`DIE
 (("error broadcasting message"));

768 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

770 
out
:

772 
	}
}

783 
	$mªag”_£nd_sigÇl_deviû_»moved
 (
H®Deviû
 *
deviû
)

785 cÚ¡ *
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

786 
DBusMes§ge
 *
mes§ge
;

787 
DBusMes§geI‹r
 
™”
;

789 ià(
dbus_cÚÃùiÚ
 =ğ
NULL
 || 
h®d_is_š™Ÿlisšg
)

790 
out
;

792 
	`HAL_TRACE
 (("’‹ršg, udi=%s", 
udi
));

794 
mes§ge
 = 
	`dbus_mes§ge_Ãw_sigÇl
 ("/org/freedesktop/Hal/Manager",

798 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

799 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
udi
);

801 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
dbus_cÚÃùiÚ
, 
mes§ge
, 
NULL
))

802 
	`DIE
 (("error broadcasting message"));

804 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

805 
out
:

807 
	}
}

820 
	$mªag”_£nd_sigÇl_Ãw_ÿ·b™y
 (
H®Deviû
 *
deviû
,

821 cÚ¡ *
ÿ·b™y
)

823 cÚ¡ *
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

824 
DBusMes§ge
 *
mes§ge
;

825 
DBusMes§geI‹r
 
™”
;

827 ià(
dbus_cÚÃùiÚ
 =ğ
NULL
 || 
h®d_is_š™Ÿlisšg
)

828 
out
;

830 
	`HAL_TRACE
 (("’‹ršg, udi=%s, c­=%s", 
udi
, 
ÿ·b™y
));

832 
mes§ge
 = 
	`dbus_mes§ge_Ãw_sigÇl
 ("/org/freedesktop/Hal/Manager",

836 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

837 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
udi
);

838 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
ÿ·b™y
);

840 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
dbus_cÚÃùiÚ
, 
mes§ge
, 
NULL
))

841 
	`DIE
 (("error broadcasting message"));

843 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

844 
out
:

846 
	}
}

849 
	$mªag”_£nd_sigÇl_š‹rçû_lock_acquœed
 (cÚ¡ *
š‹rçû_Çme
, cÚ¡ *
£nd”
)

851 cÚ¡ *
udi
;

852 *
lock_Çme
;

853 
num_locks
;

854 
H®Deviû
 *
d
;

855 
DBusMes§ge
 *
mes§ge
;

856 
DBusMes§geI‹r
 
™”
;

858 ià(
dbus_cÚÃùiÚ
 =ğ
NULL
 || 
h®d_is_š™Ÿlisšg
)

859 
out
;

861 
udi
 = "/org/freedesktop/Hal/devices/computer";

862 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

863 ià(
d
 =ğ
NULL
)

864 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

865 ià(
d
 =ğ
NULL
)

866 
out
;

868 
lock_Çme
 = 
	`g_¡rdup_´štf
 ("Glob®.%s", 
š‹rçû_Çme
);

869 
num_locks
 = 
	`h®_deviû_g‘_num_lock_hŞd”s
 (
d
, 
lock_Çme
);

870 
	`g_ä“
 (
lock_Çme
);

872 
mes§ge
 = 
	`dbus_mes§ge_Ãw_sigÇl
 ("/org/freedesktop/Hal/Manager",

876 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

877 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
š‹rçû_Çme
);

878 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
£nd”
);

879 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_INT32
, &
num_locks
);

881 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
dbus_cÚÃùiÚ
, 
mes§ge
, 
NULL
))

882 
	`DIE
 (("error broadcasting message"));

884 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

885 
out
:

887 
	}
}

890 
	$mªag”_£nd_sigÇl_š‹rçû_lock_»Ëa£d
 (cÚ¡ *
š‹rçû_Çme
, cÚ¡ *
£nd”
)

892 cÚ¡ *
udi
;

893 *
lock_Çme
;

894 
num_locks
;

895 
H®Deviû
 *
d
;

896 
DBusMes§ge
 *
mes§ge
;

897 
DBusMes§geI‹r
 
™”
;

899 ià(
dbus_cÚÃùiÚ
 =ğ
NULL
 || 
h®d_is_š™Ÿlisšg
)

900 
out
;

902 
udi
 = "/org/freedesktop/Hal/devices/computer";

903 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

904 ià(
d
 =ğ
NULL
)

905 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

906 ià(
d
 =ğ
NULL
)

907 
out
;

909 
lock_Çme
 = 
	`g_¡rdup_´štf
 ("Glob®.%s", 
š‹rçû_Çme
);

910 
num_locks
 = 
	`h®_deviû_g‘_num_lock_hŞd”s
 (
d
, 
lock_Çme
);

911 
	`g_ä“
 (
lock_Çme
);

913 
mes§ge
 = 
	`dbus_mes§ge_Ãw_sigÇl
 ("/org/freedesktop/Hal/Manager",

917 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

918 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
š‹rçû_Çme
);

919 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
£nd”
);

920 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_INT32
, &
num_locks
);

922 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
dbus_cÚÃùiÚ
, 
mes§ge
, 
NULL
))

923 
	`DIE
 (("error broadcasting message"));

925 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

926 
out
:

928 
	}
}

931 
	$deviû_£nd_sigÇl_š‹rçû_lock_acquœed
 (
H®Deviû
 *
deviû
, cÚ¡ *
š‹rçû_Çme
, cÚ¡ *
£nd”
)

933 
num_locks
;

934 
DBusMes§ge
 *
mes§ge
;

935 
DBusMes§geI‹r
 
™”
;

937 ià(
dbus_cÚÃùiÚ
 =ğ
NULL
 || 
h®d_is_š™Ÿlisšg
)

938 
out
;

940 
num_locks
 = 
	`h®_deviû_g‘_num_lock_hŞd”s
 (
deviû
, 
š‹rçû_Çme
);

942 
mes§ge
 = 
	`dbus_mes§ge_Ãw_sigÇl
 (
	`h®_deviû_g‘_udi
 (
deviû
),

946 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

947 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
š‹rçû_Çme
);

948 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
£nd”
);

949 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_INT32
, &
num_locks
);

951 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
dbus_cÚÃùiÚ
, 
mes§ge
, 
NULL
))

952 
	`DIE
 (("error broadcasting message"));

954 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

955 
out
:

957 
	}
}

960 
	$deviû_£nd_sigÇl_š‹rçû_lock_»Ëa£d
 (
H®Deviû
 *
deviû
, cÚ¡ *
š‹rçû_Çme
, cÚ¡ *
£nd”
)

962 
num_locks
;

963 
DBusMes§ge
 *
mes§ge
;

964 
DBusMes§geI‹r
 
™”
;

966 ià(
dbus_cÚÃùiÚ
 =ğ
NULL
 || 
h®d_is_š™Ÿlisšg
)

967 
out
;

969 
num_locks
 = 
	`h®_deviû_g‘_num_lock_hŞd”s
 (
deviû
, 
š‹rçû_Çme
);

971 
mes§ge
 = 
	`dbus_mes§ge_Ãw_sigÇl
 (
	`h®_deviû_g‘_udi
 (
deviû
),

975 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

976 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
š‹rçû_Çme
);

977 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
£nd”
);

978 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_INT32
, &
num_locks
);

980 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
dbus_cÚÃùiÚ
, 
mes§ge
, 
NULL
))

981 
	`DIE
 (("error broadcasting message"));

983 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

984 
out
:

986 
	}
}

989 
	$fÜ—ch_´İ”ty_­³nd
 (
H®Deviû
 *
deviû
,

990 cÚ¡ *
key
,

991 
gpoš‹r
 
u£r_d©a
)

993 
DBusMes§geI‹r
 *
™”
;

994 
DBusMes§geI‹r
 
™”_diù_’Œy
;

995 
ty³
;

997 
™”
 = (
DBusMes§geI‹r
 *)
u£r_d©a
;

999 
	`dbus_mes§ge_™”_İ’_cÚš”
 (
™”
,

1000 
DBUS_TYPE_DICT_ENTRY
,

1001 
NULL
,

1002 &
™”_diù_’Œy
);

1004 
ty³
 = 
	`h®_deviû_´İ”ty_g‘_ty³
 (
deviû
, 
key
);

1006 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_diù_’Œy
, 
DBUS_TYPE_STRING
, &
key
);

1008 
ty³
) {

1009 
HAL_PROPERTY_TYPE_STRING
:

1011 
DBusMes§geI‹r
 
™”_v¬
;

1012 cÚ¡ *
v
;

1014 
v
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
deviû
, 
key
);

1016 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”_diù_’Œy
,

1017 
DBUS_TYPE_VARIANT
,

1018 
DBUS_TYPE_STRING_AS_STRING
,

1019 &
™”_v¬
);

1021 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_v¬
,

1022 
DBUS_TYPE_STRING
,

1023 &
v
);

1025 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”_diù_’Œy
,

1026 &
™”_v¬
);

1029 
HAL_PROPERTY_TYPE_INT32
:

1031 
DBusMes§geI‹r
 
™”_v¬
;

1032 
dbus_št32_t
 
v
;

1034 
v
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
deviû
, 
key
);

1036 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”_diù_’Œy
,

1037 
DBUS_TYPE_VARIANT
,

1038 
DBUS_TYPE_INT32_AS_STRING
,

1039 &
™”_v¬
);

1041 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_v¬
,

1042 
DBUS_TYPE_INT32
,

1043 &
v
);

1045 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”_diù_’Œy
,

1046 &
™”_v¬
);

1049 
HAL_PROPERTY_TYPE_UINT64
:

1051 
DBusMes§geI‹r
 
™”_v¬
;

1052 
dbus_ušt64_t
 
v
;

1054 
v
 = 
	`h®_deviû_´İ”ty_g‘_ušt64
 (
deviû
, 
key
);

1056 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”_diù_’Œy
,

1057 
DBUS_TYPE_VARIANT
,

1058 
DBUS_TYPE_UINT64_AS_STRING
,

1059 &
™”_v¬
);

1061 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_v¬
,

1062 
DBUS_TYPE_UINT64
,

1063 &
v
);

1065 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”_diù_’Œy
,

1066 &
™”_v¬
);

1069 
HAL_PROPERTY_TYPE_DOUBLE
:

1071 
DBusMes§geI‹r
 
™”_v¬
;

1072 
v
;

1074 
v
 = 
	`h®_deviû_´İ”ty_g‘_doubË
 (
deviû
, 
key
);

1076 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”_diù_’Œy
,

1077 
DBUS_TYPE_VARIANT
,

1078 
DBUS_TYPE_DOUBLE_AS_STRING
,

1079 &
™”_v¬
);

1081 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_v¬
,

1082 
DBUS_TYPE_DOUBLE
,

1083 &
v
);

1085 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”_diù_’Œy
,

1086 &
™”_v¬
);

1089 
HAL_PROPERTY_TYPE_BOOLEAN
:

1091 
DBusMes§geI‹r
 
™”_v¬
;

1092 
dbus_boŞ_t
 
v
;

1094 
v
 = 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
deviû
, 
key
);

1096 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”_diù_’Œy
,

1097 
DBUS_TYPE_VARIANT
,

1098 
DBUS_TYPE_BOOLEAN_AS_STRING
,

1099 &
™”_v¬
);

1101 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_v¬
,

1102 
DBUS_TYPE_BOOLEAN
,

1103 &
v
);

1105 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”_diù_’Œy
,

1106 &
™”_v¬
);

1109 
HAL_PROPERTY_TYPE_STRLIST
:

1111 
DBusMes§geI‹r
 
™”_v¬
, 
™”_¬¿y
;

1112 
H®DeviûSŒLi¡I‹r
 
hd_™”
;

1114 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”_diù_’Œy
,

1115 
DBUS_TYPE_VARIANT
,

1116 
DBUS_TYPE_ARRAY_AS_STRING


1117 
DBUS_TYPE_STRING_AS_STRING
,

1118 &
™”_v¬
);

1120 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”_v¬
,

1121 
DBUS_TYPE_ARRAY
,

1122 
DBUS_TYPE_STRING_AS_STRING
,

1123 &
™”_¬¿y
);

1125 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
deviû
, 
key
, &
hd_™”
);

1126 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
hd_™”
);

1127 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
hd_™”
)) {

1128 cÚ¡ *
v
;

1129 
v
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
hd_™”
);

1131 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_¬¿y
,

1132 
DBUS_TYPE_STRING
,

1133 &
v
);

1136 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”_v¬
,

1137 &
™”_¬¿y
);

1139 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”_diù_’Œy
,

1140 &
™”_v¬
);

1145 
	`HAL_WARNING
 (("UnknowÀ´İ”tyy³ 0x%04x", 
ty³
));

1149 
	`dbus_mes§ge_™”_şo£_cÚš”
 (
™”
, &
™”_diù_’Œy
);

1150 
	}
}

1170 
DBusHªdËrResuÉ


1171 
	$deviû_g‘_®l_´İ”t›s
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

1172 
DBusMes§ge
 * 
mes§ge
)

1174 
DBusMes§ge
 *
»¶y
;

1175 
DBusMes§geI‹r
 
™”
;

1176 
DBusMes§geI‹r
 
™”_diù
;

1177 
H®Deviû
 *
d
;

1178 cÚ¡ *
udi
;

1180 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

1182 
	`HAL_TRACE
 (("’‹ršg, udi=%s", 
udi
));

1184 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

1185 ià(
d
 =ğ
NULL
)

1186 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

1188 ià(
d
 =ğ
NULL
) {

1189 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

1190  
DBUS_HANDLER_RESULT_HANDLED
;

1193 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

1194 ià(
»¶y
 =ğ
NULL
)

1195 
	`DIE
 (("No memory"));

1197 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

1199 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”
,

1200 
DBUS_TYPE_ARRAY
,

1201 
DBUS_DICT_ENTRY_BEGIN_CHAR_AS_STRING


1202 
DBUS_TYPE_STRING_AS_STRING


1203 
DBUS_TYPE_VARIANT_AS_STRING


1204 
DBUS_DICT_ENTRY_END_CHAR_AS_STRING
,

1205 &
™”_diù
);

1207 
	`h®_deviû_´İ”ty_fÜ—ch
 (
d
,

1208 
fÜ—ch_´İ”ty_­³nd
,

1209 &
™”_diù
);

1211 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”
, &
™”_diù
);

1213 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

1214 
	`DIE
 (("No memory"));

1216 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1218  
DBUS_HANDLER_RESULT_HANDLED
;

1219 
	}
}

1237 
DBusHªdËrResuÉ


1238 
	$deviû_£t_muÉË_´İ”t›s
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

1240 
DBusMes§ge
 *
»¶y
;

1241 
DBusMes§geI‹r
 
™”
;

1242 
DBusMes§geI‹r
 
diù_™”
;

1243 
H®Deviû
 *
d
;

1244 cÚ¡ *
udi
;

1246 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

1248 
	`HAL_TRACE
 (("’‹ršg, udi=%s", 
udi
));

1250 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

1251 ià(
d
 =ğ
NULL
)

1252 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

1254 ià(
d
 =ğ
NULL
) {

1255 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

1256  
DBUS_HANDLER_RESULT_HANDLED
;

1259 ià(!
loÿl_š‹rçû
 && !
	`acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
ci_Œack”
, 
mes§ge
)) {

1260 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "SetProperty:‚ot…rivileged");

1261  
DBUS_HANDLER_RESULT_HANDLED
;

1264 
	`dbus_mes§ge_™”_š™
 (
mes§ge
, &
™”
);

1266 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”
è!ğ
DBUS_TYPE_ARRAY
 &&

1267 
	`dbus_mes§ge_™”_g‘_–em’t_ty³
 (&
™”
è!ğ
DBUS_TYPE_DICT_ENTRY
) {

1268 
	`HAL_ERROR
 (("”rÜ,ƒx³ùšg‡À¬¿y oàdiùƒÁr›s", 
__FILE__
, 
__LINE__
));

1269 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

1270  
DBUS_HANDLER_RESULT_HANDLED
;

1273 
	`dbus_mes§ge_™”_»cur£
 (&
™”
, &
diù_™”
);

1276 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

1278 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
diù_™”
è=ğ
DBUS_TYPE_DICT_ENTRY
)

1280 
DBusMes§geI‹r
 
diù_’Œy_™”
, 
v¬_™”
, 
¬¿y_™”
;

1281 cÚ¡ *
key
;

1282 
chªge_ty³
;

1283 
dbus_boŞ_t
 
rc
;

1285 
	`dbus_mes§ge_™”_»cur£
 (&
diù_™”
, &
diù_’Œy_™”
);

1286 
	`dbus_mes§ge_™”_g‘_basic
 (&
diù_’Œy_™”
, &
key
);

1288 
	`dbus_mes§ge_™”_Ãxt
 (&
diù_’Œy_™”
);

1289 
	`dbus_mes§ge_™”_»cur£
 (&
diù_’Œy_™”
, &
v¬_™”
);

1290 
chªge_ty³
 = 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
v¬_™”
);

1292 
rc
 = 
FALSE
;

1294 
chªge_ty³
) {

1295 
DBUS_TYPE_ARRAY
:

1297 
gboŞ—n
 
_”rÜ
;

1298 
gboŞ—n
 
_added
;

1300 
_”rÜ
 = 
FALSE
;

1301 
_added
 = 
TRUE
;

1303 ià(
	`dbus_mes§ge_™”_g‘_–em’t_ty³
 (&
v¬_™”
è!ğ
DBUS_TYPE_STRING
) {

1306 
	`dbus_mes§ge_™”_»cur£
 (&
v¬_™”
, &
¬¿y_™”
);

1308 ià(
	`h®_deviû_has_´İ”ty
(
d
, 
key
)) {

1309 ià(
	`h®_deviû_´İ”ty_g‘_ty³
(
d
, 
key
è!ğ
HAL_PROPERTY_TYPE_STRLIST
) {

1310 
_”rÜ
 = 
TRUE
;

1312 
_added
 = 
FALSE
;

1315 
	`h®_deviû_´İ”ty_¡¾i¡_ş—r
 (
d
, 
key
, 
TRUE
);

1317 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
¬¿y_™”
è=ğ
DBUS_TYPE_STRING
) {

1318 cÚ¡ *
v
;

1319 
	`dbus_mes§ge_™”_g‘_basic
 (&
¬¿y_™”
, &
v
);

1320 
	`HAL_INFO
 ((" sŒli¡ƒËm % -> %s", 
key
, 
v
));

1321 
rc
 = 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
d
, 
key
, 
v
, 
TRUE
);

1322 
	`dbus_mes§ge_™”_Ãxt
 (&
¬¿y_™”
);

1325 ià(!
_”rÜ
)

1326 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd_fšish_chªge£t
(
d
, 
key
, 
_added
);

1330 
DBUS_TYPE_STRING
:

1332 cÚ¡ *
v
;

1333 
	`dbus_mes§ge_™”_g‘_basic
 (&
v¬_™”
, &
v
);

1334 
	`HAL_INFO
 (("% -> %s", 
key
, 
v
));

1335 
rc
 = 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, 
key
, 
v
);

1338 
DBUS_TYPE_INT32
:

1340 
dbus_št32_t
 
v
;

1341 
	`dbus_mes§ge_™”_g‘_basic
 (&
v¬_™”
, &
v
);

1342 
	`HAL_INFO
 (("% -> %d", 
key
, 
v
));

1343 
rc
 = 
	`h®_deviû_´İ”ty_£t_št
 (
d
, 
key
, 
v
);

1346 
DBUS_TYPE_UINT64
:

1348 
dbus_ušt64_t
 
v
;

1349 
	`dbus_mes§ge_™”_g‘_basic
 (&
v¬_™”
, &
v
);

1350 
	`HAL_INFO
 (("% -> %Îd", 
key
, 
v
));

1351 
rc
 = 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, 
key
, 
v
);

1354 
DBUS_TYPE_DOUBLE
:

1356 
v
;

1357 
	`dbus_mes§ge_™”_g‘_basic
 (&
v¬_™”
, &
v
);

1358 
	`HAL_INFO
 (("% -> %g", 
key
, 
v
));

1359 
rc
 = 
	`h®_deviû_´İ”ty_£t_doubË
 (
d
, 
key
, 
v
);

1362 
DBUS_TYPE_BOOLEAN
:

1364 
gboŞ—n
 
v
;

1365 
	`dbus_mes§ge_™”_g‘_basic
 (&
v¬_™”
, &
v
);

1366 
	`HAL_INFO
 (("% -> %s", 
key
, 
v
 ? "True" : "False"));

1367 
rc
 = 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, 
key
, 
v
);

1377 
	`dbus_mes§ge_™”_Ãxt
 (&
diù_™”
);

1380 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

1383 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

1384 ià(
»¶y
 =ğ
NULL
)

1385 
	`DIE
 (("No memory"));

1387 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

1388 
	`DIE
 (("No memory"));

1390 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1391  
DBUS_HANDLER_RESULT_HANDLED
;

1392 
	}
}

1416 
DBusHªdËrResuÉ


1417 
	$deviû_g‘_´İ”ty
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
)

1419 
DBusMes§ge
 *
»¶y
;

1420 
DBusMes§geI‹r
 
™”
;

1421 
DBusE¼Ü
 
”rÜ
;

1422 
H®Deviû
 *
d
;

1423 cÚ¡ *
udi
;

1424 *
key
;

1425 
ty³
;

1427 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

1429 
	`HAL_TRACE
 (("’‹ršg, udi=%s", 
udi
));

1431 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

1432 ià(
d
 =ğ
NULL
)

1433 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

1435 ià(
d
 =ğ
NULL
) {

1436 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

1437  
DBUS_HANDLER_RESULT_HANDLED
;

1440 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1441 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1442 
DBUS_TYPE_STRING
, &
key
,

1443 
DBUS_TYPE_INVALID
)) {

1444 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "GetProperty");

1445  
DBUS_HANDLER_RESULT_HANDLED
;

1448 ià(!
	`h®_deviû_has_´İ”ty
 (
d
, 
key
)) {

1449 
	`¿i£_no_such_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
, 
key
);

1450  
DBUS_HANDLER_RESULT_HANDLED
;

1453 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

1454 ià(
»¶y
 =ğ
NULL
)

1455 
	`DIE
 (("No memory"));

1457 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

1459 
ty³
 = 
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
key
);

1460 
ty³
) {

1461 
HAL_PROPERTY_TYPE_STRING
:

1463 cÚ¡ *
s
;

1464 
s
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, 
key
);

1465 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
s
);

1468 
HAL_PROPERTY_TYPE_INT32
:

1470 
dbus_št32_t
 
i
;

1471 
i
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, 
key
);

1472 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_INT32
, &
i
);

1475 
HAL_PROPERTY_TYPE_UINT64
:

1477 
dbus_ušt64_t
 
ul
;

1478 
ul
 = 
	`h®_deviû_´İ”ty_g‘_ušt64
 (
d
, 
key
);

1479 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_UINT64
, &
ul
);

1482 
HAL_PROPERTY_TYPE_DOUBLE
:

1484 
vd
;

1485 
vd
 = 
	`h®_deviû_´İ”ty_g‘_doubË
 (
d
, 
key
);

1486 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_DOUBLE
, &
vd
);

1489 
HAL_PROPERTY_TYPE_BOOLEAN
:

1491 
dbus_boŞ_t
 
b
;

1492 
b
 = 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, 
key
);

1493 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
b
);

1496 
HAL_PROPERTY_TYPE_STRLIST
:

1498 
H®DeviûSŒLi¡I‹r
 
¡r™”
;

1499 
DBusMes§geI‹r
 
™”_¬¿y
;

1501 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”
,

1502 
DBUS_TYPE_ARRAY
,

1503 
DBUS_TYPE_STRING_AS_STRING
,

1504 &
™”_¬¿y
);

1506 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
d
, 
key
, &
¡r™”
);

1507 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
¡r™”
);

1508 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
¡r™”
)) {

1509 cÚ¡ *
v
;

1510 
v
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
¡r™”
);

1511 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_¬¿y
, 
DBUS_TYPE_STRING
, &
v
);

1514 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”
, &
™”_¬¿y
);

1519 
	`HAL_WARNING
 (("UnknowÀ´İ”tyy³ %d", 
ty³
));

1523 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

1524 
	`DIE
 (("No memory"));

1526 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1528  
DBUS_HANDLER_RESULT_HANDLED
;

1529 
	}
}

1549 
DBusHªdËrResuÉ


1550 
	$deviû_g‘_´İ”ty_ty³
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

1551 
DBusMes§ge
 * 
mes§ge
)

1553 
DBusMes§ge
 *
»¶y
;

1554 
DBusMes§geI‹r
 
™”
;

1555 
DBusE¼Ü
 
”rÜ
;

1556 
H®Deviû
 *
d
;

1557 cÚ¡ *
udi
;

1558 *
key
;

1559 
dbus_št32_t
 
i
;

1561 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

1563 
	`HAL_TRACE
 (("’‹ršg, udi=%s", 
udi
));

1565 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

1566 ià(
d
 =ğ
NULL
)

1567 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

1569 ià(
d
 =ğ
NULL
) {

1570 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

1571  
DBUS_HANDLER_RESULT_HANDLED
;

1574 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1575 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1576 
DBUS_TYPE_STRING
, &
key
,

1577 
DBUS_TYPE_INVALID
)) {

1578 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "GetPropertyType");

1579  
DBUS_HANDLER_RESULT_HANDLED
;

1582 ià(!
	`h®_deviû_has_´İ”ty
 (
d
, 
key
)) {

1583 
	`¿i£_no_such_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
, 
key
);

1584  
DBUS_HANDLER_RESULT_HANDLED
;

1587 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

1588 ià(
»¶y
 =ğ
NULL
)

1589 
	`DIE
 (("No memory"));

1591 
i
 = 
	`h®_deviû_´İ”ty_g‘_ty³
 (
d
, 
key
);

1592 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

1593 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_INT32
, &
i
);

1595 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

1596 
	`DIE
 (("No memory"));

1598 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1600  
DBUS_HANDLER_RESULT_HANDLED
;

1601 
	}
}

1624 
DBusHªdËrResuÉ


1625 
	$deviû_£t_´İ”ty
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

1627 cÚ¡ *
udi
;

1628 *
key
;

1629 
ty³
;

1630 
dbus_boŞ_t
 
rc
;

1631 
H®Deviû
 *
deviû
;

1632 
DBusMes§geI‹r
 
™”
;

1633 
DBusMes§ge
 *
»¶y
;

1635 
	`HAL_TRACE
 (("entering"));

1637 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

1639 
	`dbus_mes§ge_™”_š™
 (
mes§ge
, &
™”
);

1640 
ty³
 = 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”
);

1641 ià(
ty³
 !ğ
DBUS_TYPE_STRING
) {

1642 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "SetProperty");

1643  
DBUS_HANDLER_RESULT_HANDLED
;

1645 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
key
);

1647 ià(!
loÿl_š‹rçû
 && !
	`acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
ci_Œack”
, 
mes§ge
)) {

1648 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "SetProperty:‚ot…rivileged");

1649  
DBUS_HANDLER_RESULT_HANDLED
;

1652 
	`HAL_DEBUG
 (("udi=%s, key=%s", 
udi
, 
key
));

1654 
deviû
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

1655 ià(
deviû
 =ğ
NULL
)

1656 
deviû
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

1658 ià(
deviû
 =ğ
NULL
) {

1659 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

1660  
DBUS_HANDLER_RESULT_HANDLED
;

1662 
	`dbus_mes§ge_™”_Ãxt
 (&
™”
);

1666 
ty³
 = 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”
);

1667 
rc
 = 
FALSE
;

1669 
ty³
) {

1670 
DBUS_TYPE_STRING
:

1672 cÚ¡ *
v
;

1673 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v
);

1674 
rc
 = 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
deviû
, 
key
, 
v
);

1677 
DBUS_TYPE_INT32
:

1679 
dbus_št32_t
 
v
;

1680 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v
);

1681 
rc
 = 
	`h®_deviû_´İ”ty_£t_št
 (
deviû
, 
key
, 
v
);

1684 
DBUS_TYPE_UINT64
:

1686 
dbus_ušt64_t
 
v
;

1687 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v
);

1688 
rc
 = 
	`h®_deviû_´İ”ty_£t_ušt64
 (
deviû
, 
key
, 
v
);

1691 
DBUS_TYPE_DOUBLE
:

1693 
v
;

1694 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v
);

1695 
rc
 = 
	`h®_deviû_´İ”ty_£t_doubË
 (
deviû
, 
key
, 
v
);

1698 
DBUS_TYPE_BOOLEAN
:

1700 
dbus_boŞ_t
 
v
;

1701 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v
);

1702 
rc
 = 
	`h®_deviû_´İ”ty_£t_boŞ
 (
deviû
, 
key
, 
v
);

1706 
	`HAL_WARNING
 (("UnsuµÜ‹d…rİ”tyy³ %d", 
ty³
));

1710 ià(!
rc
) {

1711 
	`¿i£_´İ”ty_ty³_”rÜ
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
, 
key
);

1712  
DBUS_HANDLER_RESULT_HANDLED
;

1715 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

1716 ià(
»¶y
 =ğ
NULL
)

1717 
	`DIE
 (("No memory"));

1719 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

1720 
	`DIE
 (("No memory"));

1722 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1723  
DBUS_HANDLER_RESULT_HANDLED
;

1724 
	}
}

1756 
DBusHªdËrResuÉ


1757 
	$deviû_add_ÿ·b™y
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

1759 cÚ¡ *
udi
;

1760 cÚ¡ *
ÿ·b™y
;

1761 
H®Deviû
 *
d
;

1762 
DBusMes§ge
 *
»¶y
;

1763 
DBusE¼Ü
 
”rÜ
;

1765 
	`HAL_TRACE
 (("entering"));

1767 ià(!
loÿl_š‹rçû
 && !
	`acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
ci_Œack”
, 
mes§ge
)) {

1768 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "AddCapability:‚ot…rivileged");

1769  
DBUS_HANDLER_RESULT_HANDLED
;

1772 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

1774 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

1775 ià(
d
 =ğ
NULL
)

1776 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

1778 ià(
d
 =ğ
NULL
) {

1779 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

1780  
DBUS_HANDLER_RESULT_HANDLED
;

1783 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1784 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1785 
DBUS_TYPE_STRING
, &
ÿ·b™y
,

1786 
DBUS_TYPE_INVALID
)) {

1787 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "AddCapability");

1788  
DBUS_HANDLER_RESULT_HANDLED
;

1792 
	`h®_deviû_add_ÿ·b™y
 (
d
, 
ÿ·b™y
);

1794 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

1795 ià(
»¶y
 =ğ
NULL
)

1796 
	`DIE
 (("No memory"));

1798 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

1799 
	`DIE
 (("No memory"));

1801 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1802  
DBUS_HANDLER_RESULT_HANDLED
;

1803 
	}
}

1807 
DBusHªdËrResuÉ


1808 
	$deviû_¡ršg_li¡_­³nd_´•’d
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
do_´•’d
)

1810 cÚ¡ *
udi
;

1811 cÚ¡ *
key
;

1812 cÚ¡ *
v®ue
;

1813 
H®Deviû
 *
d
;

1814 
DBusMes§ge
 *
»¶y
;

1815 
DBusE¼Ü
 
”rÜ
;

1816 
gboŞ—n
 
»t
;

1818 
	`HAL_TRACE
 (("entering"));

1820 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

1822 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

1823 ià(
d
 =ğ
NULL
)

1824 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

1826 ià(
d
 =ğ
NULL
) {

1827 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

1828  
DBUS_HANDLER_RESULT_HANDLED
;

1831 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1832 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1833 
DBUS_TYPE_STRING
, &
key
,

1834 
DBUS_TYPE_STRING
, &
v®ue
,

1835 
DBUS_TYPE_INVALID
)) {

1836 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, 
do_´•’d
 ? "StringListPrepend" : "StringListAppend");

1837  
DBUS_HANDLER_RESULT_HANDLED
;

1840 ià(
do_´•’d
)

1841 
»t
 = 
	`h®_deviû_´İ”ty_¡¾i¡_´•’d
 (
d
, 
key
, 
v®ue
);

1843 
»t
 = 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
d
, 
key
, 
v®ue
, 
FALSE
);

1844 ià(!
»t
) {

1845 
	`¿i£_´İ”ty_ty³_”rÜ
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
, 
key
);

1846  
DBUS_HANDLER_RESULT_HANDLED
;

1849 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

1850 ià(
»¶y
 =ğ
NULL
)

1851 
	`DIE
 (("No memory"));

1853 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

1854 
	`DIE
 (("No memory"));

1856 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1857  
DBUS_HANDLER_RESULT_HANDLED
;

1858 
	}
}

1861 
DBusHªdËrResuÉ


1862 
	$deviû_¡ršg_li¡_»move
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
)

1864 cÚ¡ *
udi
;

1865 cÚ¡ *
key
;

1866 cÚ¡ *
v®ue
;

1867 
H®Deviû
 *
d
;

1868 
DBusMes§ge
 *
»¶y
;

1869 
DBusE¼Ü
 
”rÜ
;

1870 
gboŞ—n
 
»t
;

1872 
	`HAL_TRACE
 (("entering"));

1874 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

1876 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

1877 ià(
d
 =ğ
NULL
)

1878 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

1880 ià(
d
 =ğ
NULL
) {

1881 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

1882  
DBUS_HANDLER_RESULT_HANDLED
;

1885 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1886 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1887 
DBUS_TYPE_STRING
, &
key
,

1888 
DBUS_TYPE_STRING
, &
v®ue
,

1889 
DBUS_TYPE_INVALID
)) {

1890 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "StringListRemove");

1891  
DBUS_HANDLER_RESULT_HANDLED
;

1894 
»t
 = 
	`h®_deviû_´İ”ty_¡¾i¡_»move
 (
d
, 
key
, 
v®ue
);

1895 ià(!
»t
) {

1896 
	`¿i£_´İ”ty_ty³_”rÜ
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
, 
key
);

1897  
DBUS_HANDLER_RESULT_HANDLED
;

1900 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

1901 ià(
»¶y
 =ğ
NULL
)

1902 
	`DIE
 (("No memory"));

1904 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

1905 
	`DIE
 (("No memory"));

1907 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1908  
DBUS_HANDLER_RESULT_HANDLED
;

1909 
	}
}

1930 
DBusHªdËrResuÉ


1931 
	$deviû_»move_´İ”ty
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

1933 cÚ¡ *
udi
;

1934 *
key
;

1935 
H®Deviû
 *
d
;

1936 
DBusMes§ge
 *
»¶y
;

1937 
DBusE¼Ü
 
”rÜ
;

1939 
	`HAL_TRACE
 (("entering"));

1941 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

1943 ià(!
loÿl_š‹rçû
 && !
	`acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
ci_Œack”
, 
mes§ge
)) {

1944 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "RemoveProperty:‚ot…rivileged");

1945  
DBUS_HANDLER_RESULT_HANDLED
;

1948 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

1949 ià(
d
 =ğ
NULL
)

1950 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

1952 ià(
d
 =ğ
NULL
) {

1953 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

1954  
DBUS_HANDLER_RESULT_HANDLED
;

1957 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1958 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1959 
DBUS_TYPE_STRING
, &
key
,

1960 
DBUS_TYPE_INVALID
)) {

1961 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "RemoveProperty");

1962  
DBUS_HANDLER_RESULT_HANDLED
;

1965 ià(!
	`h®_deviû_´İ”ty_»move
 (
d
, 
key
)) {

1966 
	`¿i£_no_such_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
, 
key
);

1967  
DBUS_HANDLER_RESULT_HANDLED
;

1971 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

1972 ià(
»¶y
 =ğ
NULL
)

1973 
	`DIE
 (("No memory"));

1975 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

1976 
	`DIE
 (("No memory"));

1978 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1979  
DBUS_HANDLER_RESULT_HANDLED
;

1980 
	}
}

1998 
DBusHªdËrResuÉ


1999 
	$deviû_´İ”ty_exi¡s
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
)

2001 cÚ¡ *
udi
;

2002 *
key
;

2003 
H®Deviû
 *
d
;

2004 
DBusMes§ge
 *
»¶y
;

2005 
DBusE¼Ü
 
”rÜ
;

2006 
DBusMes§geI‹r
 
™”
;

2007 
dbus_boŞ_t
 
b
;

2009 
	`HAL_TRACE
 (("entering"));

2011 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

2013 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

2014 ià(
d
 =ğ
NULL
)

2015 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

2017 ià(
d
 =ğ
NULL
) {

2018 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

2019  
DBUS_HANDLER_RESULT_HANDLED
;

2022 
	`dbus_”rÜ_š™
 (&
”rÜ
);

2023 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

2024 
DBUS_TYPE_STRING
, &
key
,

2025 
DBUS_TYPE_INVALID
)) {

2026 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "RemoveProperty");

2027  
DBUS_HANDLER_RESULT_HANDLED
;

2030 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

2031 ià(
»¶y
 =ğ
NULL
)

2032 
	`DIE
 (("No memory"));

2034 
b
 = 
	`h®_deviû_has_´İ”ty
 (
d
, 
key
);

2035 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

2036 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
b
);

2038 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

2039 
	`DIE
 (("No memory"));

2041 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2042  
DBUS_HANDLER_RESULT_HANDLED
;

2043 
	}
}

2062 
DBusHªdËrResuÉ


2063 
	$deviû_qu”y_ÿ·b™y
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

2064 
DBusMes§ge
 * 
mes§ge
)

2066 
dbus_boŞ_t
 
rc
;

2067 cÚ¡ *
udi
;

2068 
H®DeviûSŒLi¡I‹r
 
¡r™”
;

2069 *
ÿ·b™y
;

2070 
H®Deviû
 *
d
;

2071 
DBusMes§ge
 *
»¶y
;

2072 
DBusE¼Ü
 
”rÜ
;

2073 
DBusMes§geI‹r
 
™”
;

2075 
	`HAL_TRACE
 (("entering"));

2077 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

2079 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

2080 ià(
d
 =ğ
NULL
)

2081 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

2083 ià(
d
 =ğ
NULL
) {

2084 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

2085  
DBUS_HANDLER_RESULT_HANDLED
;

2088 
	`dbus_”rÜ_š™
 (&
”rÜ
);

2089 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

2090 
DBUS_TYPE_STRING
, &
ÿ·b™y
,

2091 
DBUS_TYPE_INVALID
)) {

2092 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "QueryCapability");

2093  
DBUS_HANDLER_RESULT_HANDLED
;

2096 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

2097 ià(
»¶y
 =ğ
NULL
)

2098 
	`DIE
 (("No memory"));

2100 
rc
 = 
FALSE
;

2101 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
d
, "šfo.ÿ·b™›s", &
¡r™”
);

2102 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
¡r™”
);

2103 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
¡r™”
)) {

2104 ià(
	`¡rcmp
 (
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
¡r™”
), 
ÿ·b™y
) == 0) {

2105 
rc
 = 
TRUE
;

2110 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

2111 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
rc
);

2113 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

2114 
	`DIE
 (("No memory"));

2116 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2117  
DBUS_HANDLER_RESULT_HANDLED
;

2118 
	}
}

2121 
DBusHªdËrResuÉ


2122 
	$deviû_acquœe_š‹rçû_lock
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

2124 cÚ¡ *
udi
;

2125 
H®Deviû
 *
d
;

2126 
DBusMes§ge
 *
»¶y
;

2127 
DBusE¼Ü
 
”rÜ
;

2128 *
š‹rçû_Çme
;

2129 cÚ¡ *
£nd”
;

2130 
gboŞ—n
 
exşusive
;

2132 
	`HAL_TRACE
 (("entering"));

2134 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

2136 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

2137 ià(
d
 =ğ
NULL
)

2138 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

2140 ià(
d
 =ğ
NULL
) {

2141 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

2142  
DBUS_HANDLER_RESULT_HANDLED
;

2145 
£nd”
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

2147 
	`dbus_”rÜ_š™
 (&
”rÜ
);

2148 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

2149 
DBUS_TYPE_STRING
, &
š‹rçû_Çme
,

2150 
DBUS_TYPE_BOOLEAN
, &
exşusive
,

2151 
DBUS_TYPE_INVALID
)) {

2152 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "AqcuireInterfaceLock");

2153  
DBUS_HANDLER_RESULT_HANDLED
;

2156 ià(!
loÿl_š‹rçû
) {

2157 ià(!
	`acûss_check_ÿÎ”_have_acûss_to_deviû
 (
ci_Œack”
, 
d
, "Üg.ä“desktİ.h®.lock", 
£nd”
, 
NULL
)) {

2158 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "AcquireInterfaceLock:‚o‡ccesso device");

2159  
DBUS_HANDLER_RESULT_HANDLED
;

2163 ià(!
	`h®_deviû_acquœe_lock
 (
d
, 
š‹rçû_Çme
, 
exşusive
, 
£nd”
)) {

2164 
	`¿i£_š‹rçû_®»ady_locked
 (
cÚÃùiÚ
, 
mes§ge
, 
š‹rçû_Çme
);

2165  
DBUS_HANDLER_RESULT_HANDLED
;

2168 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

2169 ià(
»¶y
 =ğ
NULL
)

2170 
	`DIE
 (("No memory"));

2172 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

2173 
	`DIE
 (("No memory"));

2175 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2176  
DBUS_HANDLER_RESULT_HANDLED
;

2177 
	}
}

2179 
DBusHªdËrResuÉ


2180 
	$deviû_»Ëa£_š‹rçû_lock
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

2182 cÚ¡ *
udi
;

2183 
H®Deviû
 *
d
;

2184 
DBusMes§ge
 *
»¶y
;

2185 
DBusE¼Ü
 
”rÜ
;

2186 cÚ¡ *
£nd”
;

2187 *
š‹rçû_Çme
;

2189 
	`HAL_TRACE
 (("entering"));

2191 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

2193 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

2194 ià(
d
 =ğ
NULL
)

2195 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

2197 ià(
d
 =ğ
NULL
) {

2198 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

2199  
DBUS_HANDLER_RESULT_HANDLED
;

2202 
£nd”
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

2204 
	`dbus_”rÜ_š™
 (&
”rÜ
);

2205 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

2206 
DBUS_TYPE_STRING
, &
š‹rçû_Çme
,

2207 
DBUS_TYPE_INVALID
)) {

2208 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "ReleaseInterfaceLock");

2209  
DBUS_HANDLER_RESULT_HANDLED
;

2214 ià(!
	`h®_deviû_»Ëa£_lock
 (
d
, 
š‹rçû_Çme
, 
£nd”
)) {

2215 
	`¿i£_š‹rçû_nÙ_locked
 (
cÚÃùiÚ
, 
mes§ge
, 
š‹rçû_Çme
);

2216  
DBUS_HANDLER_RESULT_HANDLED
;

2219 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

2220 ià(
»¶y
 =ğ
NULL
)

2221 
	`DIE
 (("No memory"));

2223 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

2224 
	`DIE
 (("No memory"));

2226 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2227  
DBUS_HANDLER_RESULT_HANDLED
;

2228 
	}
}

2230 
DBusHªdËrResuÉ


2231 
	$deviû_is_ÿÎ”_locked_out
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

2233 cÚ¡ *
udi
;

2234 
H®Deviû
 *
d
;

2235 
DBusMes§ge
 *
»¶y
;

2236 
DBusE¼Ü
 
”rÜ
;

2237 cÚ¡ *
£nd”
;

2238 *
š‹rçû_Çme
;

2239 *
ÿÎ”_sysbus_Çme
;

2240 
dbus_boŞ_t
 
»suÉ
;

2241 
DBusMes§geI‹r
 
™”
;

2243 
	`HAL_TRACE
 (("entering"));

2245 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

2247 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

2248 ià(
d
 =ğ
NULL
)

2249 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

2251 ià(
d
 =ğ
NULL
) {

2252 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

2253  
DBUS_HANDLER_RESULT_HANDLED
;

2256 
£nd”
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

2259 ià(!
loÿl_š‹rçû
 && !
	`acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
ci_Œack”
, 
mes§ge
)) {

2260 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "IsCallerLockedOut:‚ot…rivileged");

2261  
DBUS_HANDLER_RESULT_HANDLED
;

2264 
	`dbus_”rÜ_š™
 (&
”rÜ
);

2265 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

2266 
DBUS_TYPE_STRING
, &
š‹rçû_Çme
,

2267 
DBUS_TYPE_STRING
, &
ÿÎ”_sysbus_Çme
,

2268 
DBUS_TYPE_INVALID
)) {

2269 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "IsCallerLockedOut");

2270  
DBUS_HANDLER_RESULT_HANDLED
;

2273 
»suÉ
 = 
	`acûss_check_ÿÎ”_locked_out
 (
ci_Œack”
, 
d
, 
ÿÎ”_sysbus_Çme
, 
š‹rçû_Çme
);

2275 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

2276 ià(
»¶y
 =ğ
NULL
)

2277 
	`DIE
 (("No memory"));

2279 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

2280 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
»suÉ
);

2282 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

2283 
	`DIE
 (("No memory"));

2285 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2286  
DBUS_HANDLER_RESULT_HANDLED
;

2287 
	}
}

2291 #ifdeà
HAVE_POLKIT


2292 
DBusHªdËrResuÉ


2293 
	$deviû_is_ÿÎ”_´iveged
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

2295 cÚ¡ *
udi
;

2296 
H®Deviû
 *
d
;

2297 
DBusMes§ge
 *
»¶y
;

2298 
DBusE¼Ü
 
”rÜ
;

2299 cÚ¡ *
£nd”
;

2300 *
aùiÚ
;

2301 *
ÿÎ”_sysbus_Çme
;

2302 
pŞk™_»suÉ
;

2303 cÚ¡ *
»suÉ
;

2304 
DBusMes§geI‹r
 
™”
;

2306 
	`HAL_TRACE
 (("entering"));

2308 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

2310 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

2311 ià(
d
 =ğ
NULL
)

2312 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

2314 ià(
d
 =ğ
NULL
) {

2315 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

2316  
DBUS_HANDLER_RESULT_HANDLED
;

2319 
£nd”
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

2321 ià(
	`¡rcmp
 (
	`dbus_mes§ge_g‘_sigÇtu»
 (
mes§ge
), "ss") != 0) {

2322 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "IsCallerPrivileged");

2323  
DBUS_HANDLER_RESULT_HANDLED
;

2326 
	`dbus_”rÜ_š™
 (&
”rÜ
);

2327 
	`dbus_mes§ge_™”_š™
 (
mes§ge
, &
™”
);

2328 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
aùiÚ
);

2329 
	`dbus_mes§ge_™”_Ãxt
 (&
™”
);

2330 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
ÿÎ”_sysbus_Çme
);

2333 ià(!
loÿl_š‹rçû
 && !
	`acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
ci_Œack”
, 
mes§ge
)) {

2334 
CIC®ËrInfo
 *
ci_£nd”
;

2335 
CIC®ËrInfo
 *
ci_rg‘
;

2337 ià((
ci_£nd”
 = 
	`ci_Œack”_g‘_šfo
 (
ci_Œack”
, 
£nd”
)è=ğ
NULL
) {

2338 
	`¿i£_”rÜ
 (
cÚÃùiÚ
, 
mes§ge
,

2341  
DBUS_HANDLER_RESULT_HANDLED
;

2343 ià((
ci_rg‘
 = 
	`ci_Œack”_g‘_šfo
 (
ci_Œack”
, 
ÿÎ”_sysbus_Çme
)è=ğ
NULL
) {

2344 
	`¿i£_”rÜ
 (
cÚÃùiÚ
, 
mes§ge
,

2347  
DBUS_HANDLER_RESULT_HANDLED
;

2351 ià(
	`ci_Œack”_ÿÎ”_g‘_uid
 (
ci_£nd”
è!ğci_Œack”_ÿÎ”_g‘_uid (
ci_rg‘
)) {

2352 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
,

2354  
DBUS_HANDLER_RESULT_HANDLED
;

2359 
pŞk™_»suÉ
 = -1;

2360 
	`acûss_check_ÿÎ”_have_acûss_to_deviû
 (

2361 
ci_Œack”
, 
d
, 
aùiÚ
, 
ÿÎ”_sysbus_Çme
, &
pŞk™_»suÉ
);

2362 
»suÉ
 = 
	`pŞk™_»suÉ_to_¡ršg_»´e£Á©iÚ
 (
pŞk™_»suÉ
);

2364 ià(
pŞk™_»suÉ
 < 0 || 
»suÉ
 =ğ
NULL
) {

2365 
	`¿i£_”rÜ
 (
cÚÃùiÚ
, 
mes§ge
,

2368  
DBUS_HANDLER_RESULT_HANDLED
;

2371 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

2372 ià(
»¶y
 =ğ
NULL
)

2373 
	`DIE
 (("No memory"));

2375 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

2376 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
»suÉ
);

2378 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

2379 
	`DIE
 (("No memory"));

2381 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2382  
DBUS_HANDLER_RESULT_HANDLED
;

2383 
	}
}

2385 
DBusHªdËrResuÉ


2386 
	$deviû_is_ÿÎ”_´iveged
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

2389 
	`¿i£_”rÜ
 (
cÚÃùiÚ
, 
mes§ge
,

2392  
DBUS_HANDLER_RESULT_HANDLED
;

2393 
	}
}

2398 
DBusHªdËrResuÉ


2399 
	$deviû_is_locked_by_Ùh”s
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

2401 cÚ¡ *
udi
;

2402 
H®Deviû
 *
d
;

2403 
DBusMes§ge
 *
»¶y
;

2404 
DBusE¼Ü
 
”rÜ
;

2405 cÚ¡ *
£nd”
;

2406 *
š‹rçû_Çme
;

2407 
dbus_boŞ_t
 
»suÉ
;

2408 
DBusMes§geI‹r
 
™”
;

2410 
	`HAL_TRACE
 (("entering"));

2412 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

2414 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

2415 ià(
d
 =ğ
NULL
)

2416 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

2418 ià(
d
 =ğ
NULL
) {

2419 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

2420  
DBUS_HANDLER_RESULT_HANDLED
;

2423 
£nd”
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

2427 
	`dbus_”rÜ_š™
 (&
”rÜ
);

2428 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

2429 
DBUS_TYPE_STRING
, &
š‹rçû_Çme
,

2430 
DBUS_TYPE_INVALID
)) {

2431 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "IsLockedByOthers");

2432  
DBUS_HANDLER_RESULT_HANDLED
;

2435 
»suÉ
 = 
	`acûss_check_locked_by_Ùh”s
 (
ci_Œack”
, 
d
, 
£nd”
, 
š‹rçû_Çme
);

2437 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

2438 ià(
»¶y
 =ğ
NULL
)

2439 
	`DIE
 (("No memory"));

2441 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

2442 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
»suÉ
);

2444 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

2445 
	`DIE
 (("No memory"));

2447 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2448  
DBUS_HANDLER_RESULT_HANDLED
;

2449 
	}
}

2453 
DBusHªdËrResuÉ


2454 
	$deviû_acquœe_glob®_š‹rçû_lock
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

2456 cÚ¡ *
udi
;

2457 
H®Deviû
 *
d
;

2458 
DBusMes§ge
 *
»¶y
;

2459 
DBusE¼Ü
 
”rÜ
;

2460 *
š‹rçû_Çme
;

2461 *
lock_Çme
;

2462 cÚ¡ *
£nd”
;

2463 
gboŞ—n
 
exşusive
;

2465 
	`HAL_TRACE
 (("entering"));

2467 
udi
 = "/org/freedesktop/Hal/devices/computer";

2468 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

2469 ià(
d
 =ğ
NULL
)

2470 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

2472 ià(
d
 =ğ
NULL
) {

2473 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

2474  
DBUS_HANDLER_RESULT_HANDLED
;

2477 
£nd”
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

2489 
	`dbus_”rÜ_š™
 (&
”rÜ
);

2490 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

2491 
DBUS_TYPE_STRING
, &
š‹rçû_Çme
,

2492 
DBUS_TYPE_BOOLEAN
, &
exşusive
,

2493 
DBUS_TYPE_INVALID
)) {

2494 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "AqcuireGlobalInterfaceLock");

2495  
DBUS_HANDLER_RESULT_HANDLED
;

2498 
lock_Çme
 = 
	`g_¡rdup_´štf
 ("Glob®.%s", 
š‹rçû_Çme
);

2499 ià(!
	`h®_deviû_acquœe_lock
 (
d
, 
lock_Çme
, 
exşusive
, 
£nd”
)) {

2500 
	`¿i£_š‹rçû_®»ady_locked
 (
cÚÃùiÚ
, 
mes§ge
, 
š‹rçû_Çme
);

2501 
	`g_ä“
 (
lock_Çme
);

2502  
DBUS_HANDLER_RESULT_HANDLED
;

2504 
	`g_ä“
 (
lock_Çme
);

2506 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

2507 ià(
»¶y
 =ğ
NULL
)

2508 
	`DIE
 (("No memory"));

2510 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

2511 
	`DIE
 (("No memory"));

2513 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2514  
DBUS_HANDLER_RESULT_HANDLED
;

2515 
	}
}

2517 
DBusHªdËrResuÉ


2518 
	$deviû_»Ëa£_glob®_š‹rçû_lock
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

2520 cÚ¡ *
udi
;

2521 
H®Deviû
 *
d
;

2522 
DBusMes§ge
 *
»¶y
;

2523 
DBusE¼Ü
 
”rÜ
;

2524 cÚ¡ *
£nd”
;

2525 *
š‹rçû_Çme
;

2526 *
lock_Çme
;

2528 
	`HAL_TRACE
 (("entering"));

2530 
udi
 = "/org/freedesktop/Hal/devices/computer";

2531 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

2532 ià(
d
 =ğ
NULL
)

2533 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

2535 ià(
d
 =ğ
NULL
) {

2536 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

2537  
DBUS_HANDLER_RESULT_HANDLED
;

2540 
£nd”
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

2552 
	`dbus_”rÜ_š™
 (&
”rÜ
);

2553 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

2554 
DBUS_TYPE_STRING
, &
š‹rçû_Çme
,

2555 
DBUS_TYPE_INVALID
)) {

2556 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "ReleaseGlobalInterfaceLock");

2557  
DBUS_HANDLER_RESULT_HANDLED
;

2560 
lock_Çme
 = 
	`g_¡rdup_´štf
 ("Glob®.%s", 
š‹rçû_Çme
);

2561 ià(!
	`h®_deviû_»Ëa£_lock
 (
d
, 
lock_Çme
, 
£nd”
)) {

2562 
	`¿i£_š‹rçû_nÙ_locked
 (
cÚÃùiÚ
, 
mes§ge
, 
š‹rçû_Çme
);

2563 
	`g_ä“
 (
lock_Çme
);

2564  
DBUS_HANDLER_RESULT_HANDLED
;

2566 
	`g_ä“
 (
lock_Çme
);

2568 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

2569 ià(
»¶y
 =ğ
NULL
)

2570 
	`DIE
 (("No memory"));

2572 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

2573 
	`DIE
 (("No memory"));

2575 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2576  
DBUS_HANDLER_RESULT_HANDLED
;

2577 
	}
}

2581 
GHashTabË
 *
	g£rviûs_w™h_locks
 = 
NULL
;

2584 
	$£rviûs_w™h_locks_add_lock
 (cÚ¡ * 
lock_owÃr
, 
H®Deviû
 *
deviû
) {

2586 
GSLi¡
 *
deviûs
;

2588 
deviûs
 = 
	`g_hash_bË_lookup
 (
£rviûs_w™h_locks
, 
lock_owÃr
);

2590 
deviûs
 = 
	`g_¦i¡_´•’d
 (deviûs, 
deviû
);

2592 
	`g_hash_bË_š£¹
 (
£rviûs_w™h_locks
, 
	`¡rdup
(
lock_owÃr
), 
deviûs
);

2593 
	}
}

2596 
	$£rviûs_w™h_locks_»move_lock
 (cÚ¡ * 
lock_owÃr
, 
H®Deviû
 *
deviû
) {

2598 
GSLi¡
 *
deviûs
;

2600 
deviûs
 = 
	`g_hash_bË_lookup
 (
£rviûs_w™h_locks
, 
lock_owÃr
);

2602 
deviûs
 = 
	`g_¦i¡_»move
 (deviûs, 
deviû
);

2604 
	`g_hash_bË_š£¹
 (
£rviûs_w™h_locks
, 
	`¡rdup
(
lock_owÃr
), 
deviûs
);

2605 
	}
}

2608 
	$£rviûs_w™h_locks_»move_lockowÃr
 (cÚ¡ * 
lock_owÃr
) {

2610 
GSLi¡
 *
deviûs
;

2612 
deviûs
 = 
	`g_hash_bË_lookup
 (
£rviûs_w™h_locks
, 
lock_owÃr
);

2614 ià(
deviûs
 !ğ
NULL
) {

2615 
GSLi¡
 *
™”
;

2617 
™”
 = 
deviûs
; i‹¸!ğ
NULL
; i‹¸ğ™”->
Ãxt
) {

2618 
H®Deviû
 *
d
 = 
™”
->
d©a
;

2619 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.locked");

2620 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.locked.reason");

2621 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.locked.dbus_name");

2624 
	`g_hash_bË_»move
 (
£rviûs_w™h_locks
, 
lock_owÃr
);

2625 
	}
}

2644 
DBusHªdËrResuÉ


2645 
	$deviû_lock
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

2646 
DBusMes§ge
 * 
mes§ge
)

2648 cÚ¡ *
udi
;

2649 
H®Deviû
 *
d
;

2650 
DBusMes§ge
 *
»¶y
;

2651 
dbus_boŞ_t
 
®»ady_locked
;

2652 
DBusE¼Ü
 
”rÜ
;

2653 *
»asÚ
;

2654 cÚ¡ *
£nd”
;

2656 
	`HAL_TRACE
 (("entering"));

2658 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

2660 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

2661 ià(
d
 =ğ
NULL
)

2662 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

2664 ià(
d
 =ğ
NULL
) {

2665 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

2666  
DBUS_HANDLER_RESULT_HANDLED
;

2669 
®»ady_locked
 = 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "info.locked");

2671 ià(
®»ady_locked
) {

2672 
	`¿i£_deviû_®»ady_locked
 (
cÚÃùiÚ
, 
mes§ge
, 
d
);

2673  
DBUS_HANDLER_RESULT_HANDLED
;

2676 
	`dbus_”rÜ_š™
 (&
”rÜ
);

2677 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

2678 
DBUS_TYPE_STRING
, &
»asÚ
,

2679 
DBUS_TYPE_INVALID
)) {

2680 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "Lock");

2681  
DBUS_HANDLER_RESULT_HANDLED
;

2684 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

2685 ià(
»¶y
 =ğ
NULL
)

2686 
	`DIE
 (("No memory"));

2688 
£nd”
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

2690 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "šfo.locked", 
TRUE
);

2691 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.locked.»asÚ", 
»asÚ
);

2692 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.locked.dbus_name",

2693 
£nd”
);

2695 ià(
£rviûs_w™h_locks
 =ğ
NULL
) {

2696 
£rviûs_w™h_locks
 =

2697 
	`g_hash_bË_Ãw_fuÎ
 (
g_¡r_hash
,

2698 
g_¡r_equ®
,

2699 
g_ä“
,

2700 
g_objeù_uÄef
);

2703 
	`£rviûs_w™h_locks_add_lock
 (
£nd”
, 
d
);

2705 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

2706 
	`DIE
 (("No memory"));

2708 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2709  
DBUS_HANDLER_RESULT_HANDLED
;

2710 
	}
}

2729 
DBusHªdËrResuÉ


2730 
	$deviû_uÆock
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

2731 
DBusMes§ge
 *
mes§ge
)

2733 
dbus_boŞ_t
 
rc
;

2734 cÚ¡ *
udi
;

2735 
H®Deviû
 *
d
;

2736 
DBusMes§ge
 *
»¶y
;

2737 
DBusE¼Ü
 
”rÜ
;

2738 cÚ¡ *
£nd”
;

2740 
	`HAL_TRACE
 (("entering"));

2742 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

2744 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

2745 ià(
d
 =ğ
NULL
)

2746 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

2748 ià(
d
 =ğ
NULL
) {

2749 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

2750  
DBUS_HANDLER_RESULT_HANDLED
;

2753 
	`dbus_”rÜ_š™
 (&
”rÜ
);

2754 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

2755 
DBUS_TYPE_INVALID
)) {

2756 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "Unlock");

2757  
DBUS_HANDLER_RESULT_HANDLED
;

2760 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

2761 ià(
»¶y
 =ğ
NULL
)

2762 
	`DIE
 (("No memory"));

2764 
rc
 = 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "info.locked");

2766 ià(!
rc
) {

2767 
	`¿i£_deviû_nÙ_locked
 (
cÚÃùiÚ
, 
mes§ge
, 
d
);

2768  
DBUS_HANDLER_RESULT_HANDLED
;

2771 
£nd”
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

2773 ià(
	`¡rcmp
 (
£nd”
, 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (

2774 
d
, "info.locked.dbus_name")) != 0) {

2775 *
»asÚ
;

2777 
»asÚ
 = 
	`g_¡rdup_´štf
 ("Service '%s' does‚ot ownhe "

2778 "lock oÀ%s", 
£nd”
,

2779 
	`h®_deviû_g‘_udi
 (
d
));

2781 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, 
»asÚ
);

2783 
	`g_ä“
 (
»asÚ
);

2785  
DBUS_HANDLER_RESULT_HANDLED
;

2788 ià(
	`g_hash_bË_lookup
 (
£rviûs_w™h_locks
, 
£nd”
)) {

2789 
	`£rviûs_w™h_locks_»move_lock
 (
£nd”
, 
d
);

2791 
	`HAL_WARNING
 (("Service '%s' was‚ot inhe†ist of services "

2792 "w™h†ocks!", 
£nd”
));

2795 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.locked");

2796 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.locked.reason");

2797 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.locked.dbus_name");

2800 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

2801 
	`DIE
 (("No memory"));

2803 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2804  
DBUS_HANDLER_RESULT_HANDLED
;

2805 
	}
}

2808 
	g©omic_couÁ
 = 0;

2811 
	gnum_³ndšg_upd©es
 = 0;

2814 
	sP’dšgUpd©e_s
 {

2815 *
	mudi
;

2816 *
	mkey
;

2817 
dbus_boŞ_t
 
	m»moved
;

2818 
dbus_boŞ_t
 
	madded
;

2819 
P’dšgUpd©e_s
 *
	mÃxt
;

2820 } 
	tP’dšgUpd©e
;

2822 
P’dšgUpd©e
 *
	g³ndšg_upd©es_h—d
 = 
NULL
;

2833 
	$deviû_´İ”ty_©omic_upd©e_begš
 ()

2835 
©omic_couÁ
++;

2836 
	}
}

2846 
	$deviû_´İ”ty_©omic_upd©e_’d
 ()

2848 
P’dšgUpd©e
 *
pu_™”
 = 
NULL
;

2849 
P’dšgUpd©e
 *
pu_™”_Ãxt
 = 
NULL
;

2850 
P’dšgUpd©e
 *
pu_™”2
 = 
NULL
;

2852 --
©omic_couÁ
;

2854 ià(
©omic_couÁ
 < 0) {

2855 
	`HAL_WARNING
 (("***‡tomic_couÁ = %d < 0 !!", 
©omic_couÁ
));

2856 
©omic_couÁ
 = 0;

2859 ià(
©omic_couÁ
 =ğ0 && 
num_³ndšg_upd©es
 > 0) {

2860 
DBusMes§ge
 *
mes§ge
;

2861 
DBusMes§geI‹r
 
™”
;

2862 
DBusMes§geI‹r
 
™”_¬¿y
;

2864 
pu_™”
 = 
³ndšg_upd©es_h—d
;

2865 
pu_™”
 !ğ
NULL
;…u_™” = 
pu_™”_Ãxt
) {

2866 
num_upd©es_this
;

2868 
pu_™”_Ãxt
 = 
pu_™”
->
Ãxt
;

2871 ià(
pu_™”
->
udi
 =ğ
NULL
)

2872 
®»ady_´oûs£d
;

2875 
num_upd©es_this
 = 0;

2876 
pu_™”2
 = 
pu_™”
;…u_™”2 !ğ
NULL
;…u_™”2 =…u_™”2->
Ãxt
) {

2877 ià(
	`¡rcmp
 (
pu_™”2
->
udi
, 
pu_™”
->udi) == 0)

2878 
num_upd©es_this
++;

2882 
mes§ge
 = 
	`dbus_mes§ge_Ãw_sigÇl
 (
pu_™”
->
udi
,

2885 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2886 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_INT32
,

2887 &
num_upd©es_this
);

2889 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”
,

2890 
DBUS_TYPE_ARRAY
,

2891 
DBUS_STRUCT_BEGIN_CHAR_AS_STRING


2892 
DBUS_TYPE_STRING_AS_STRING


2893 
DBUS_TYPE_BOOLEAN_AS_STRING


2894 
DBUS_TYPE_BOOLEAN_AS_STRING


2895 
DBUS_STRUCT_END_CHAR_AS_STRING
,

2896 &
™”_¬¿y
);

2898 
pu_™”2
 = 
pu_™”
;…u_™”2 !ğ
NULL
;

2899 
pu_™”2
 =…u_™”2->
Ãxt
) {

2900 ià(
	`¡rcmp
 (
pu_™”2
->
udi
, 
pu_™”
->udi) == 0) {

2901 
DBusMes§geI‹r
 
™”_¡ruù
;

2902 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”_¬¿y
,

2903 
DBUS_TYPE_STRUCT
,

2904 
NULL
,

2905 &
™”_¡ruù
);

2906 
dbus_mes§ge_™”_­³nd_basic


2907 (&
™”_¡ruù
,

2908 
DBUS_TYPE_STRING
,

2909 &(
pu_™”2
->
key
));

2910 
dbus_mes§ge_™”_­³nd_basic


2911 (&
™”_¡ruù
,

2912 
DBUS_TYPE_BOOLEAN
,

2913 &(
pu_™”2
->
»moved
));

2914 
dbus_mes§ge_™”_­³nd_basic


2915 (&
™”_¡ruù
,

2916 
DBUS_TYPE_BOOLEAN
,

2917 &(
pu_™”2
->
added
));

2919 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”_¬¿y
, &
™”_¡ruù
);

2922 
	`g_ä“
 (
pu_™”2
->
key
);

2923 ià(
pu_™”2
 !ğ
pu_™”
) {

2924 
	`g_ä“
 (
pu_™”2
->
udi
);

2925 
pu_™”2
->
udi
 = 
NULL
;

2930 
	`g_ä“
 (
pu_™”
->
udi
);

2931 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”
, &
™”_¬¿y
);

2933 ià(
dbus_cÚÃùiÚ
 !ğ
NULL
) {

2934 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
dbus_cÚÃùiÚ
, 
mes§ge
, 
NULL
))

2935 
	`DIE
 (("error broadcasting message"));

2938 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2940 
®»ady_´oûs£d
:

2941 
	`g_ä“
 (
pu_™”
);

2945 
num_³ndšg_upd©es
 = 0;

2946 
³ndšg_upd©es_h—d
 = 
NULL
;

2948 
	}
}

2953 
	$deviû_£nd_sigÇl_´İ”ty_modif›d
 (
H®Deviû
 *
deviû
, cÚ¡ *
key
,

2954 
dbus_boŞ_t
 
added
, dbus_boŞ_ˆ
»moved
)

2956 cÚ¡ *
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

2957 
DBusMes§ge
 *
mes§ge
;

2958 
DBusMes§geI‹r
 
™”
;

2968 ià(
©omic_couÁ
 > 0) {

2969 
P’dšgUpd©e
 *
pu
;

2971 
pu
 = 
	`g_Ãw0
 (
P’dšgUpd©e
, 1);

2972 
pu
->
udi
 = 
	`g_¡rdup
 (udi);

2973 
pu
->
key
 = 
	`g_¡rdup
 (key);

2974 
pu
->
»moved
 =„emoved;

2975 
pu
->
added
 =‡dded;

2976 
pu
->
Ãxt
 = 
³ndšg_upd©es_h—d
;

2978 
³ndšg_upd©es_h—d
 = 
pu
;

2979 
num_³ndšg_upd©es
++;

2981 
dbus_št32_t
 
i
;

2982 
DBusMes§geI‹r
 
™”_¡ruù
;

2983 
DBusMes§geI‹r
 
™”_¬¿y
;

2985 ià(
dbus_cÚÃùiÚ
 =ğ
NULL
 || 
h®d_is_š™Ÿlisšg
)

2986 
out
;

2988 
mes§ge
 = 
	`dbus_mes§ge_Ãw_sigÇl
 (
udi
,

2992 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2993 
i
 = 1;

2994 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_INT32
, &
i
);

2996 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”
,

2997 
DBUS_TYPE_ARRAY
,

2998 
DBUS_STRUCT_BEGIN_CHAR_AS_STRING


2999 
DBUS_TYPE_STRING_AS_STRING


3000 
DBUS_TYPE_BOOLEAN_AS_STRING


3001 
DBUS_TYPE_BOOLEAN_AS_STRING


3002 
DBUS_STRUCT_END_CHAR_AS_STRING
,

3003 &
™”_¬¿y
);

3005 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”_¬¿y
,

3006 
DBUS_TYPE_STRUCT
,

3007 
NULL
,

3008 &
™”_¡ruù
);

3010 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_¡ruù
, 
DBUS_TYPE_STRING
, &
key
);

3011 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_¡ruù
, 
DBUS_TYPE_BOOLEAN
, &
»moved
);

3012 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_¡ruù
, 
DBUS_TYPE_BOOLEAN
, &
added
);

3014 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”_¬¿y
, &
™”_¡ruù
);

3015 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”
, &
™”_¬¿y
);

3017 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
dbus_cÚÃùiÚ
, 
mes§ge
, 
NULL
))

3018 
	`DIE
 (("error broadcasting message"));

3020 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

3022 
out
:

3024 
	}
}

3045 
	$deviû_£nd_sigÇl_cÚd™iÚ
 (
H®Deviû
 *
deviû
, cÚ¡ *
cÚd™iÚ_Çme
, cÚ¡ *
cÚd™iÚ_d‘as
)

3047 cÚ¡ *
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

3048 
DBusMes§ge
 *
mes§ge
;

3049 
DBusMes§geI‹r
 
™”
;

3051 ià(
dbus_cÚÃùiÚ
 =ğ
NULL
 || 
h®d_is_š™Ÿlisšg
)

3052 
out
;

3054 
mes§ge
 = 
	`dbus_mes§ge_Ãw_sigÇl
 (
udi
,

3057 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

3058 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
,

3059 
DBUS_TYPE_STRING
,

3060 &
cÚd™iÚ_Çme
);

3061 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
,

3062 
DBUS_TYPE_STRING
,

3063 &
cÚd™iÚ_d‘as
);

3065 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
dbus_cÚÃùiÚ
, 
mes§ge
, 
NULL
))

3066 
	`DIE
 (("error broadcasting message"));

3068 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

3069 
out
:

3071 
	}
}

3075 
gboŞ—n


3076 
	$»š™_dbus
 (
gpoš‹r
 
u£r_d©a
)

3078 
	`HAL_INFO
 (("entering!"));

3079 ià(
dbus_cÚÃùiÚ
 =ğ
NULL
)

3080 
	`h®d_dbus_š™_´•robe
 ();

3081 ià(
	`h®d_dbus_š™
 ())

3082  
FALSE
;

3084  
TRUE
;

3085 
	}
}

3087 
DBusHªdËrResuÉ


3088 
	$deviû_»sÿn
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

3090 cÚ¡ *
udi
;

3091 
H®Deviû
 *
deviû
;

3092 
DBusMes§ge
 *
»¶y
;

3093 
DBusMes§geI‹r
 
™”
;

3094 
gboŞ—n
 
»s
;

3096 
	`HAL_INFO
 (("’‹ršg,†oÿl_š‹rçû=%d", 
loÿl_š‹rçû
));

3098 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

3100 ià(!
loÿl_š‹rçû
 && !
	`acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
ci_Œack”
, 
mes§ge
)) {

3101 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "Rescan:‚ot…rivileged");

3102  
DBUS_HANDLER_RESULT_HANDLED
;

3105 
	`HAL_DEBUG
 (("udi=%s", 
udi
));

3107 
deviû
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

3108 ià(
deviû
 =ğ
NULL
)

3109 
deviû
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

3111 ià(
deviû
 =ğ
NULL
) {

3112 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

3113  
DBUS_HANDLER_RESULT_HANDLED
;

3116 
»s
 = 
	`os¥ec_deviû_»sÿn
 (
deviû
);

3118 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

3119 ià(
»¶y
 =ğ
NULL
)

3120 
	`DIE
 (("No memory"));

3121 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

3122 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
»s
);

3124 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

3125 
	`DIE
 (("No memory"));

3127 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3128  
DBUS_HANDLER_RESULT_HANDLED
;

3129 
	}
}

3131 
DBusHªdËrResuÉ


3132 
	$deviû_»´obe
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

3134 cÚ¡ *
udi
;

3135 
H®Deviû
 *
deviû
;

3136 
DBusMes§geI‹r
 
™”
;

3137 
DBusMes§ge
 *
»¶y
;

3138 
gboŞ—n
 
»s
;

3140 
	`HAL_TRACE
 (("entering"));

3142 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

3144 ià(!
loÿl_š‹rçû
 && !
	`acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
ci_Œack”
, 
mes§ge
)) {

3145 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "Reprobe:‚ot…rivileged");

3146  
DBUS_HANDLER_RESULT_HANDLED
;

3149 
	`HAL_DEBUG
 (("udi=%s", 
udi
));

3151 
deviû
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

3152 ià(
deviû
 =ğ
NULL
)

3153 
deviû
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

3155 ià(
deviû
 =ğ
NULL
) {

3156 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

3157  
DBUS_HANDLER_RESULT_HANDLED
;

3160 
»s
 = 
	`os¥ec_deviû_»´obe
 (
deviû
);

3162 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

3163 ià(
»¶y
 =ğ
NULL
)

3164 
	`DIE
 (("No memory"));

3165 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

3166 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
»s
);

3168 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

3169 
	`DIE
 (("No memory"));

3171 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3172  
DBUS_HANDLER_RESULT_HANDLED
;

3173 
	}
}

3176 
DBusHªdËrResuÉ


3177 
	$deviû_em™_cÚd™iÚ
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

3179 cÚ¡ *
udi
;

3180 
H®Deviû
 *
deviû
;

3181 
DBusMes§geI‹r
 
™”
;

3182 
DBusMes§ge
 *
»¶y
;

3183 
DBusE¼Ü
 
”rÜ
;

3184 cÚ¡ *
cÚd™iÚ_Çme
;

3185 cÚ¡ *
cÚd™iÚ_d‘as
;

3186 
dbus_boŞ_t
 
»s
;

3188 
	`HAL_TRACE
 (("entering"));

3190 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

3192 ià(!
loÿl_š‹rçû
) {

3193 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "EmitCondition: only‡llowed for helpers");

3194  
DBUS_HANDLER_RESULT_HANDLED
;

3197 
	`HAL_DEBUG
 (("udi=%s", 
udi
));

3199 
	`dbus_”rÜ_š™
 (&
”rÜ
);

3200 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

3201 
DBUS_TYPE_STRING
, &
cÚd™iÚ_Çme
,

3202 
DBUS_TYPE_STRING
, &
cÚd™iÚ_d‘as
,

3203 
DBUS_TYPE_INVALID
)) {

3204 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "EmitCondition");

3205  
DBUS_HANDLER_RESULT_HANDLED
;

3209 
deviû
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

3210 ià(
deviû
 =ğ
NULL
)

3211 
deviû
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

3213 ià(
deviû
 =ğ
NULL
) {

3214 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

3215  
DBUS_HANDLER_RESULT_HANDLED
;

3218 
	`deviû_£nd_sigÇl_cÚd™iÚ
 (
deviû
, 
cÚd™iÚ_Çme
, 
cÚd™iÚ_d‘as
);

3220 
»s
 = 
TRUE
;

3222 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

3223 ià(
»¶y
 =ğ
NULL
)

3224 
	`DIE
 (("No memory"));

3225 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

3226 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
»s
);

3228 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

3229 
	`DIE
 (("No memory"));

3231 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3232  
DBUS_HANDLER_RESULT_HANDLED
;

3233 
	}
}

3237 
DBusCÚÃùiÚ
 *
	mcÚÃùiÚ
;

3238 *
	mš‹rçû_Çme
;

3239 *
	mšŒo¥eùiÚ_xml
;

3240 *
	mudi
;

3241 } 
	tH–³rIÁ”çûHªdËr
;

3243 
GSLi¡
 *
	gh–³r_š‹rçû_hªdËrs
 = 
NULL
;

3245 
DBusHªdËrResuÉ


3246 
	$deviû_şaim_š‹rçû
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

3248 cÚ¡ *
udi
;

3249 
H®Deviû
 *
deviû
;

3250 
DBusMes§geI‹r
 
™”
;

3251 
DBusMes§ge
 *
»¶y
;

3252 
DBusE¼Ü
 
”rÜ
;

3253 cÚ¡ *
š‹rçû_Çme
;

3254 cÚ¡ *
šŒo¥eùiÚ_xml
;

3255 
H–³rIÁ”çûHªdËr
 *
hih
;

3256 
dbus_boŞ_t
 
»s
;

3258 
	`HAL_TRACE
 (("entering"));

3260 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

3262 ià(!
loÿl_š‹rçû
) {

3263 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "ClaimInterface: only‡llowed for helpers");

3264  
DBUS_HANDLER_RESULT_HANDLED
;

3267 
	`HAL_DEBUG
 (("udi=%s", 
udi
));

3269 
	`dbus_”rÜ_š™
 (&
”rÜ
);

3270 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

3271 
DBUS_TYPE_STRING
, &
š‹rçû_Çme
,

3272 
DBUS_TYPE_STRING
, &
šŒo¥eùiÚ_xml
,

3273 
DBUS_TYPE_INVALID
)) {

3274 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "ClaimInterface");

3275  
DBUS_HANDLER_RESULT_HANDLED
;

3278 
deviû
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

3279 ià(
deviû
 =ğ
NULL
)

3280 
deviû
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

3282 ià(
deviû
 =ğ
NULL
) {

3283 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

3284  
DBUS_HANDLER_RESULT_HANDLED
;

3287 
»s
 = 
TRUE
;

3289 
	`HAL_INFO
 (("Local connection 0x%xo handle interface '%s' on udi '%s'",

3290 
cÚÃùiÚ
,

3291 
š‹rçû_Çme
,

3292 
udi
));

3294 
	`h®_deviû_´İ”ty_¡¾i¡_add
 (
deviû
, "šfo.š‹rçûs", 
š‹rçû_Çme
);

3296 
hih
 = 
	`g_Ãw0
 (
H–³rIÁ”çûHªdËr
, 1);

3297 
hih
->
cÚÃùiÚ
 = connection;

3298 
hih
->
š‹rçû_Çme
 = 
	`g_¡rdup
 (interface_name);

3299 
hih
->
šŒo¥eùiÚ_xml
 = 
	`g_¡rdup
 (introspection_xml);

3300 
hih
->
udi
 = 
	`g_¡rdup
 (udi);

3301 
h–³r_š‹rçû_hªdËrs
 = 
	`g_¦i¡_­³nd
 (h–³r_š‹rçû_hªdËrs, 
hih
);

3304 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

3305 ià(
»¶y
 =ğ
NULL
)

3306 
	`DIE
 (("No memory"));

3307 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

3308 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
»s
);

3310 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

3311 
	`DIE
 (("No memory"));

3313 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3314  
DBUS_HANDLER_RESULT_HANDLED
;

3315 
	}
}

3319 
DBusHªdËrResuÉ


3320 
	$addÚ_is_»ady
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

3322 cÚ¡ *
udi
;

3323 
H®Deviû
 *
deviû
;

3324 
DBusMes§geI‹r
 
™”
;

3325 
DBusMes§ge
 *
»¶y
;

3326 
DBusE¼Ü
 
”rÜ
;

3327 
dbus_boŞ_t
 
»s
;

3329 
	`HAL_TRACE
 (("entering"));

3331 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

3333 ià(!
loÿl_š‹rçû
) {

3334 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "AddonIsReady: only‡llowed for helpers");

3335  
DBUS_HANDLER_RESULT_HANDLED
;

3338 
	`HAL_DEBUG
 (("udi=%s", 
udi
));

3340 
	`dbus_”rÜ_š™
 (&
”rÜ
);

3341 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

3342 
DBUS_TYPE_INVALID
)) {

3343 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "AddonIsReady");

3344  
DBUS_HANDLER_RESULT_HANDLED
;

3347 
deviû
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

3348 ià(
deviû
 =ğ
NULL
)

3349 
deviû
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

3351 ià(
deviû
 =ğ
NULL
) {

3352 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

3353  
DBUS_HANDLER_RESULT_HANDLED
;

3356 ià(
	`h®_deviû_šc_num_»ady_addÚs
 (
deviû
)) {

3357 ià(
	`h®_deviû_¬e_®l_addÚs_»ady
 (
deviû
)) {

3358 
	`mªag”_£nd_sigÇl_deviû_added
 (
deviû
);

3362 
»s
 = 
TRUE
;

3364 
	`HAL_INFO
 (("AddÚIsR—dy oÀud˜'%s'", 
udi
));

3366 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

3367 ià(
»¶y
 =ğ
NULL
)

3368 
	`DIE
 (("No memory"));

3369 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

3370 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
»s
);

3372 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

3373 
	`DIE
 (("No memory"));

3375 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3376  
DBUS_HANDLER_RESULT_HANDLED
;

3377 
	}
}

3379 
_SšgËtÚInfo
 
	tSšgËtÚInfo
;

3380 
	s_SšgËtÚInfo


3382 
DBusCÚÃùiÚ
 *
	mcÚÃùiÚ
;

3383 
GLi¡
 *
	mdeviûs
;

3387 
	$sšgËtÚ_šfo_de¡roy
 (
SšgËtÚInfo
 *
šfo
)

3389 ià(
šfo
->
deviûs
) {

3390 
	`HAL_ERROR
 (("Singleton '%s'ƒxited with devices stillo handle"));

3392 
	`g_li¡_ä“
 (
šfo
->
deviûs
);

3394 
	`g_ä“
(
šfo
);

3395 
	}
}

3397 
gboŞ—n


3398 
	$sšgËtÚ_»move_by_cÚÃùiÚ
 (*
udi
,

3399 
SšgËtÚInfo
 *
šfo
,

3400 
DBusCÚÃùiÚ
 *
cÚÃùiÚ
)

3402 ià(
šfo
->
cÚÃùiÚ
 == connection)

3403  
TRUE
;

3405  
FALSE
;

3406 
	}
}

3408 
_SšgËtÚDeviûChªgedInfo
 
	tSšgËtÚDeviûChªgedInfo
;

3409 
	s_SšgËtÚDeviûChªgedInfo


3411 
gboŞ—n
 
	madded
;

3412 
H®Deviû
 *
	mdeviû
;

3415 
SšgËtÚDeviûChªgedInfo
* 
	$Ãw_sdci
 (
gboŞ—n
 
added
, 
H®Deviû
 *
deviû
)

3417 
SšgËtÚDeviûChªgedInfo
* 
sdci
;

3418 
sdci
 = 
	`g_Ãw
 (
SšgËtÚDeviûChªgedInfo
, 1);

3419 
sdci
->
added
 =‡dded;

3420 
sdci
->
deviû
 = device;

3421 
	`g_objeù_add_w—k_poš‹r
 (
	`G_OBJECT
 (
deviû
), (
gpoš‹r
è&(
sdci
->device));

3422  
sdci
;

3423 
	}
}

3426 
	$d–_sdci
 (
SšgËtÚDeviûChªgedInfo
 *
sdci
)

3428 ià(
sdci
->
deviû
)

3429 
	`g_objeù_»move_w—k_poš‹r
 (
	`G_OBJECT
 (
sdci
->
deviû
),

3430 (
gpoš‹r
)&(
sdci
->
deviû
));

3431 
	`g_ä“
 (
sdci
);

3432 
	}
}

3435 
»¶y_äom_sšgËtÚ_deviû_chªged
 (
DBusP’dšgC®l
 *
³ndšg_ÿÎ
,

3436 *
u£r_d©a
);

3439 
	$sšgËtÚ_sigÇl_deviû_chªged
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
H®Deviû
 *
deviû
, 
gboŞ—n
 
added
)

3441 
DBusE¼Ü
 
”rÜ
;

3442 
DBusMes§ge
 *
mes§ge
;

3443 
DBusMes§geI‹r
 
™”
, 
™”_diù
;

3444 
DBusP’dšgC®l
 *
³ndšg_ÿÎ
;

3445 cÚ¡ *
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

3447 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 (
NULL
,

3450 
added
 ? "DeviceAdded" : "DeviceRemoved");

3452 ià(
mes§ge
 =ğ
NULL
)

3453 
	`DIE
 (("No memory"));

3454 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

3456 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
,

3457 &
udi
);

3459 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”
,

3460 
DBUS_TYPE_ARRAY
,

3461 
DBUS_DICT_ENTRY_BEGIN_CHAR_AS_STRING


3462 
DBUS_TYPE_STRING_AS_STRING


3463 
DBUS_TYPE_VARIANT_AS_STRING


3464 
DBUS_DICT_ENTRY_END_CHAR_AS_STRING
,

3465 &
™”_diù
);

3467 
	`h®_deviû_´İ”ty_fÜ—ch
 (
deviû
,

3468 
fÜ—ch_´İ”ty_­³nd
,

3469 &
™”_diù
);

3471 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”
, &
™”_diù
);

3473 
	`HAL_DEBUG
 (("% abouˆtØ£nd mes§gtØcÚÃùiÚ %p", 
G_STRFUNC
, 
cÚÃùiÚ
));

3474 
	`dbus_”rÜ_š™
 (&
”rÜ
);

3476 ià(
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y
 (
cÚÃùiÚ
,

3477 
mes§ge
,

3478 &
³ndšg_ÿÎ
,

3481 
	`dbus_³ndšg_ÿÎ_£t_nÙify
 (
³ndšg_ÿÎ
,

3482 
»¶y_äom_sšgËtÚ_deviû_chªged
,

3483 (*è
	`Ãw_sdci
 (
added
, 
deviû
),

3484 (
DBusF»eFunùiÚ
è
d–_sdci
);

3487 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

3488 
	}
}

3491 
	$»¶y_äom_sšgËtÚ_deviû_chªged
 (
DBusP’dšgC®l
 *
³ndšg_ÿÎ
,

3492 *
u£r_d©a
)

3494 
DBusMes§ge
 *
»¶y
;

3495 
DBusE¼Ü
 
”rÜ
;

3496 
SšgËtÚDeviûChªgedInfo
 *
d©a
 = (SšgËtÚDeviûChªgedInfo*è
u£r_d©a
;

3498 
»¶y
 = 
	`dbus_³ndšg_ÿÎ_¡—l_»¶y
 (
³ndšg_ÿÎ
);

3500 ià(
	`dbus_mes§ge_g‘_ty³
 (
»¶y
è=ğ
DBUS_MESSAGE_TYPE_ERROR
) {

3501 
	`dbus_£t_”rÜ_äom_mes§ge
 (&
”rÜ
, 
»¶y
);

3503 
	`HAL_ERROR
 (("Error calling %s for %s on singleton: %s: %s",

3504 
d©a
->
added
 ? "DeviceAdded" : "DeviceRemoved",

3505 
d©a
->
deviû
 ? 
	`h®_deviû_g‘_udi
 (data->device)

3507 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

3509 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

3510 
out
;

3514 ià(
d©a
->
added
 && d©a->
deviû
) {

3515 
	`HAL_DEBUG
 (("incrementing„eady‡ddons for device"));

3516 ià(
	`h®_deviû_šc_num_»ady_addÚs
 (
d©a
->
deviû
)) {

3517 ià(
	`h®_deviû_¬e_®l_addÚs_»ady
 (
d©a
->
deviû
)) {

3518 
	`mªag”_£nd_sigÇl_deviû_added
 (
d©a
->
deviû
);

3523 
out
:

3524 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3525 
	`dbus_³ndšg_ÿÎ_uÄef
 (
³ndšg_ÿÎ
);

3526 
	}
}

3537 
gboŞ—n


3538 
	$h®d_sšgËtÚ_deviû_added
 (cÚ¡ * 
commªd_lše
,

3539 
H®Deviû
 *
deviû
)

3541 
SšgËtÚInfo
 *
šfo
;

3542 
gch¬
 *
exŒa_’v
[2] = {
NULL
, NULL};

3544 ià(!
sšgËtÚs
)

3545 
sšgËtÚs
 = 
	`g_hash_bË_Ãw_fuÎ
 (

3546 
g_¡r_hash
, 
g_¡r_equ®
,

3547 
g_ä“
,

3548 (
GDe¡royNÙify
è
sšgËtÚ_šfo_de¡roy
);

3549 
šfo
 = 
	`g_hash_bË_lookup
 (
sšgËtÚs
, 
commªd_lše
);

3551 ià(!
šfo
) {

3552 
exŒa_’v
[0] = 
	`g_m®loc
 (
	`¡¾’
 (
commªd_lše
) + 26);

3553 
	`g_¥rštf
 (
exŒa_’v
[0], "SINGLETON_COMMAND_LINE=%s", 
commªd_lše
);

3554 ià(
	`h®d_ruÂ”_¡¬t_sšgËtÚ
 (
commªd_lše
, 
exŒa_’v
, 
NULL
, NULL, NULL)) {

3555 
	`HAL_INFO
 (("Started singleton‡ddon %s for udi %s",

3556 
commªd_lše
, 
	`h®_deviû_g‘_udi
(
deviû
)));

3558 
	`HAL_ERROR
 (("Cannot start singleton‡ddon %s for udi %s",

3559 
commªd_lše
, 
	`h®_deviû_g‘_udi
(
deviû
)));

3560  
FALSE
;

3562 
	`g_ä“
 (
exŒa_’v
[0]);

3563 
šfo
 = 
	`g_Ãw0
 (
SšgËtÚInfo
, 1);

3564 
	`g_hash_bË_š£¹
 (
sšgËtÚs
, 
	`g_¡rdup
(
commªd_lše
), 
šfo
);

3567 
šfo
->
deviûs
 = 
	`g_li¡_´•’d
 (šfo->deviûs, 
deviû
);

3569 ià(
šfo
->
cÚÃùiÚ
) {

3570 
	`sšgËtÚ_sigÇl_deviû_chªged
 (
šfo
->
cÚÃùiÚ
, 
deviû
, 
TRUE
);

3572 
	`HAL_DEBUG
 (("singleton‚ot initialised yet"));

3575  
TRUE
;

3576 
	}
}

3587 
gboŞ—n


3588 
	$h®d_sšgËtÚ_deviû_»moved
 (cÚ¡ * 
commªd_lše
,

3589 
H®Deviû
 *
deviû
)

3591 
SšgËtÚInfo
 *
šfo
;

3592 
GLi¡
 *
Í
;

3594 ià(
	`G_UNLIKELY
 (!
sšgËtÚs
)) {

3595 
	`HAL_ERROR
 (("Singletonable is‚ot initialied"));

3596  
FALSE
;

3599 
šfo
 = 
	`g_hash_bË_lookup
 (
sšgËtÚs
, 
commªd_lše
);

3601 ià(
	`G_UNLIKELY
 (!
šfo
)) {

3602 
	`HAL_WARNING
 (("A‰em±šgØ»mov¨deviû from‡ÀunknowÀsšgËtÚ %s", 
commªd_lše
));

3603  
FALSE
;

3606 
Í
 = 
	`g_li¡_fšd
 (
šfo
->
deviûs
, 
deviû
);

3607 ià(
	`G_UNLIKELY
 (!
Í
)) {

3608 
	`HAL_WARNING
 (("Deviû wa nÙ iÀu£ byhi sšgËtÚ: %s", 
commªd_lše
));

3609  
FALSE
;

3612 
šfo
->
deviûs
 = 
	`g_li¡_»move_lšk
 (šfo->deviûs, 
Í
);

3613 
	`g_li¡_ä“_1
 (
Í
);

3615 ià(
	`G_LIKELY
 (
šfo
->
cÚÃùiÚ
)) {

3616 
	`sšgËtÚ_sigÇl_deviû_chªged
 (
šfo
->
cÚÃùiÚ
, 
deviû
, 
FALSE
);

3619  
TRUE
;

3620 
	}
}

3622 
DBusHªdËrResuÉ


3623 
	$sšgËtÚ_addÚ_is_»ady
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

3625 
H®Deviû
 *
deviû
;

3626 
SšgËtÚInfo
 *
šfo
;

3627 
DBusMes§ge
 *
»¶y
;

3628 
DBusE¼Ü
 
”rÜ
;

3629 cÚ¡ *
commªd_lše
;

3630 
GLi¡
 *
Í
;

3632 
	`HAL_TRACE
 (("entering"));

3633 
	`HAL_DEBUG
 (("singleton_addon_is_ready"));

3635 ià(!
loÿl_š‹rçû
) {

3636 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "SingletonAddonIsReady: only‡llowed for helpers");

3637  
DBUS_HANDLER_RESULT_HANDLED
;

3640 
	`dbus_”rÜ_š™
 (&
”rÜ
);

3641 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

3642 
DBUS_TYPE_STRING
, &
commªd_lše
,

3643 
DBUS_TYPE_INVALID
)) {

3644 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "SingletonAddonIsReady");

3645  
DBUS_HANDLER_RESULT_HANDLED
;

3648 ià(
	`G_UNLIKELY
 (!
sšgËtÚs
)) {

3649 
	`HAL_ERROR
 (("Got SingletonIsReady with‚o known singletons"));

3650  
DBUS_HANDLER_RESULT_HANDLED
;

3653 
šfo
 = 
	`g_hash_bË_lookup
 (
sšgËtÚs
, 
commªd_lše
);

3655 ià(
	`G_UNLIKELY
 (!
šfo
)) {

3656 
	`HAL_ERROR
 (("Got SingletonIsReady from unknown singleton"));

3657  
DBUS_HANDLER_RESULT_HANDLED
;

3660 
	`HAL_INFO
 (("SšgËtÚAddÚIsR—dy„ec›ved fÜ '%s'", 
commªd_lše
));

3662 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

3663 ià(
»¶y
 =ğ
NULL
)

3664 
	`DIE
 (("No memory"));

3666 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

3667 
	`DIE
 (("No memory"));

3669 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3671 
šfo
->
cÚÃùiÚ
 = connection;

3673 
	`HAL_DEBUG
 (("Signalling device‡dded for queued devices"));

3674 
Í
 = 
šfo
->
deviûs
;†p;†°ğÍ->
Ãxt
) {

3675 
deviû
 = 
Í
->
d©a
;

3677 
	`HAL_DEBUG
 (("deviû‡dded fÜ '%s'", 
	`h®_deviû_g‘_udi
 (
deviû
)));

3678 
	`sšgËtÚ_sigÇl_deviû_chªged
 (
cÚÃùiÚ
, 
deviû
, 
TRUE
);

3683  
DBUS_HANDLER_RESULT_HANDLED
;

3684 
	}
}

3690 
DBusHªdËrResuÉ


3691 
	$mªag”_Ãw_deviû
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

3693 
DBusMes§ge
 *
»¶y
;

3694 
DBusMes§geI‹r
 
™”
;

3695 
DBusE¼Ü
 
”rÜ
;

3696 
H®Deviû
 *
d
;

3697 
gch¬
 *
udi
;

3698 
i
;

3699 
timev®
 
tv
;

3701 
	`dbus_”rÜ_š™
 (&
”rÜ
);

3703 ià(!
loÿl_š‹rçû
 && !
	`acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
ci_Œack”
, 
mes§ge
)) {

3704 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "NewDevice:‚ot…rivileged");

3705  
DBUS_HANDLER_RESULT_HANDLED
;

3708 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

3709 ià(
»¶y
 =ğ
NULL
)

3710 
	`DIE
 (("No memory"));

3712 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

3713 
d
 = 
	`h®_deviû_Ãw
 ();

3715 
	`g‘timeofday
(&
tv
, 
NULL
);

3716 
i
 = 0; i < 1000000 ; i++) {

3717 
udi
 = 
	`g_¡rdup_´štf
 ("/Üg/ä“desktİ/H®/deviûs/tmp%05x", ((è
tv
.
tv_u£c
 & 0xfffff)è+ 
i
;

3718 ià(!
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
)) ;

3719 
	`g_ä“
 (
udi
);

3720 
udi
 = 
NULL
;

3723 ià(!
udi
) {

3724 
	`¿i£_”rÜ
 (
cÚÃùiÚ
, 
mes§ge
, "org.freedesktop.Hal.NoSpace", "NewDevice:‚o space for device");

3725  
DBUS_HANDLER_RESULT_HANDLED
;

3728 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

3729 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
d
);

3730 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
udi
);

3731 
	`g_ä“
 (
udi
);

3733 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

3734 
	`DIE
 (("No memory"));

3736 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3738  
DBUS_HANDLER_RESULT_HANDLED
;

3739 
	}
}

3746 
	$mªag”_»move_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

3748 
	`HAL_INFO
 (("RemovÿÎout com¶‘ed udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

3750 ià(!
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_gdl
 (), 
d
)) {

3751 
	`HAL_WARNING
 (("Error„emoving device"));

3753 
	}
}

3759 
DBusHªdËrResuÉ


3760 
	$mªag”_»move
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

3762 
DBusMes§ge
 *
»¶y
;

3763 
DBusMes§geI‹r
 
™”
;

3764 
DBusE¼Ü
 
”rÜ
;

3765 
H®Deviû
 *
d
;

3766 *
udi
;

3767 
š_tdl
 = 0;

3769 
	`dbus_”rÜ_š™
 (&
”rÜ
);

3771 ià(!
loÿl_š‹rçû
 && !
	`acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
ci_Œack”
, 
mes§ge
)) {

3772 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "Remove:‚ot…rivileged");

3773  
DBUS_HANDLER_RESULT_HANDLED
;

3776 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

3777 
DBUS_TYPE_STRING
, &
udi
,

3778 
DBUS_TYPE_INVALID
)) {

3779 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "Remove");

3780  
DBUS_HANDLER_RESULT_HANDLED
;

3783 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

3784 ià(
»¶y
 =ğ
NULL
)

3785 
	`DIE
 (("No memory"));

3787 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

3789 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

3790 ià(
d
 =ğ
NULL
) {

3791 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

3792 
š_tdl
 = 1;

3794 ià(
d
 =ğ
NULL
) {

3795 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
udi
);

3796  
DBUS_HANDLER_RESULT_HANDLED
;

3805 ià(!
š_tdl
) {

3806 
	`h®_ut_ÿÎout_deviû_»move
 (
d
, 
mªag”_»move_dÚe
, 
NULL
, NULL);

3809 
	`h®_deviû_¡Üe_»move
 (
š_tdl
 ? 
	`h®d_g‘_tdl
 (è: 
	`h®d_g‘_gdl
 (), 
d
);

3810 
	`g_objeù_uÄef
 (
d
);

3812 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

3813 
	`DIE
 (("No memory"));

3815 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3817  
DBUS_HANDLER_RESULT_HANDLED
;

3818 
	}
}

3825 
	$mªag”_comm™_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

3827 
	`HAL_INFO
 (("Add c®lout com¶‘ed udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

3828 
	}
}

3834 
	$mªag”_comm™_´•robšg_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

3836 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "info.ignore")) {

3840 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.category");

3841 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.capabilities");

3842 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.udi", "/org/freedesktop/Hal/devices/ignored-device");

3843 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Ignored Device");

3845 
	`HAL_INFO
 (("Preprobing merged info.ignore==TRUE"));

3850 
	`h®_ut_ÿÎout_deviû_add
 (
d
, 
mªag”_comm™_dÚe
, 
NULL
, NULL);

3853 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_INFORMATION
);

3854 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_POLICY
);

3855 
	}
}

3861 
DBusHªdËrResuÉ


3862 
	$mªag”_comm™_to_gdl
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

3864 
DBusMes§ge
 *
»¶y
;

3865 
DBusMes§geI‹r
 
™”
;

3866 
DBusE¼Ü
 
”rÜ
;

3867 
H®Deviû
 *
d
;

3868 
udi
[256], *
udi0
, *
tmp_udi
;

3870 
	`dbus_”rÜ_š™
 (&
”rÜ
);

3872 ià(!
loÿl_š‹rçû
 && !
	`acûss_check_mes§ge_ÿÎ”_is_roÙ_Ü_h®
 (
ci_Œack”
, 
mes§ge
)) {

3873 
	`¿i£_³rmissiÚ_d’›d
 (
cÚÃùiÚ
, 
mes§ge
, "CommitToGdl:‚ot…rivileged");

3874  
DBUS_HANDLER_RESULT_HANDLED
;

3877 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

3878 
DBUS_TYPE_STRING
, &
tmp_udi
,

3879 
DBUS_TYPE_STRING
, &
udi0
,

3880 
DBUS_TYPE_INVALID
)) {

3881 
	`¿i£_syÁax
 (
cÚÃùiÚ
, 
mes§ge
, "CommitToGdl");

3882  
DBUS_HANDLER_RESULT_HANDLED
;

3885 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

3886 ià(
»¶y
 =ğ
NULL
)

3887 
	`DIE
 (("No memory"));

3889 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

3893 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
tmp_udi
);

3894 ià(
d
 =ğ
NULL
) {

3895 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
tmp_udi
);

3896  
DBUS_HANDLER_RESULT_HANDLED
;

3900 
	`h®_ut_make_udi_unique
 (
	`h®d_g‘_gdl
 (), 
udi
,  udi, 
udi0
);

3902 ià(
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
)) {

3904 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

3905 
	`g_objeù_uÄef
 (
d
);

3906 
	`¿i£_”rÜ
 (
cÚÃùiÚ
, 
mes§ge
, "Üg.ä“desktİ.H®.DeviûExi¡s", "Comm™ToGdl: Deviûƒxi¡s: %s", 
udi
);

3907  
DBUS_HANDLER_RESULT_HANDLED
;

3911 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.udi");

3912 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

3927 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_PREPROBE
);

3928 
	`h®_ut_ÿÎout_deviû_´•robe
 (
d
, 
mªag”_comm™_´•robšg_dÚe
, 
NULL
, NULL);

3931 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

3932 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

3934 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

3935 
	`DIE
 (("No memory"));

3937 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3939  
DBUS_HANDLER_RESULT_HANDLED
;

3940 
	}
}

3943 *
	mudi
;

3944 *
	mexeı©h
;

3945 **
	mexŒa_’v
;

3946 *
	mm¡dš
;

3947 *
	mmemb”
;

3948 *
	mš‹rçû
;

3949 
DBusMes§ge
 *
	mmes§ge
;

3950 
DBusCÚÃùiÚ
 *
	mcÚÃùiÚ
;

3951 } 
	tM‘hodInvoÿtiÚ
;

3954 
h®d_exec_m‘hod_cb
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
,

3955 
gšt
 
»tuº_code
, 
gch¬
 **
”rÜ
,

3956 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
);

3960 
	$h®d_exec_m‘hod_ä“_mi
 (
M‘hodInvoÿtiÚ
 *
mi
)

3963 
	`g_ä“
 (
mi
->
udi
);

3964 
	`g_ä“
 (
mi
->
exeı©h
);

3965 
	`g_¡rä“v
 (
mi
->
exŒa_’v
);

3966 
	`g_ä“
 (
mi
->
m¡dš
);

3967 
	`g_ä“
 (
mi
->
memb”
);

3968 
	`g_ä“
 (
mi
->
š‹rçû
);

3969 
	`g_ä“
 (
mi
);

3970 
	}
}

3973 
gboŞ—n


3974 
	$h®d_exec_m‘hod_do_švoÿtiÚ
 (
M‘hodInvoÿtiÚ
 *
mi
)

3976 
gboŞ—n
 
»t
;

3977 
H®Deviû
 *
d
;

3979 
»t
 = 
FALSE
;

3981 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
mi
->
udi
);

3982 ià(
d
 =ğ
NULL
)

3983 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
mi
->
udi
);

3985 ià(
d
 !ğ
NULL
) {

3987 
	`h®d_ruÂ”_run_m‘hod
(
d
,

3988 
mi
->
exeı©h
,

3989 
mi
->
exŒa_’v
,

3990 
mi
->
m¡dš
,

3991 
TRUE
,

3993 
h®d_exec_m‘hod_cb
,

3994 (
gpoš‹r
è
mi
->
mes§ge
,

3995 (
gpoš‹r
è
mi
->
cÚÃùiÚ
);

3997 
»t
 = 
TRUE
;

3999 
	`HAL_WARNING
 (("In-queue method call on‚on-existant device"));

4001 
	`¿i£_no_such_deviû
 (
mi
->
cÚÃùiÚ
, mi->
mes§ge
, mi->
udi
);

4004  
»t
;

4005 
	}
}

4008 
GHashTabË
 *
	gudi_to_m‘hod_queue
 = 
NULL
;

4011 
gboŞ—n


4012 
	$deviû_is_executšg_m‘hod
 (
H®Deviû
 *
d
, cÚ¡ *
š‹rçû_Çme
, cÚ¡ *
m‘hod_Çme
)

4014 
gpoš‹r
 
Üigkey
;

4015 
gboŞ—n
 
»t
;

4016 
GLi¡
 *
queue
;

4018 
»t
 = 
FALSE
;

4020 ià(
udi_to_m‘hod_queue
 =ğ
NULL
) {

4021 
out
;

4024 ià(
	`g_hash_bË_lookup_ex‹nded
 (
udi_to_m‘hod_queue
, 
	`h®_deviû_g‘_udi
 (
d
), &
Üigkey
, (
gpoš‹r
è&
queue
)) {

4026 ià(
queue
 !ğ
NULL
) {

4027 
M‘hodInvoÿtiÚ
 *
mi
;

4028 
mi
 = (
M‘hodInvoÿtiÚ
 *è
queue
->
d©a
;

4029 ià((
	`¡rcmp
 (
mi
->
š‹rçû
, 
š‹rçû_Çme
) == 0) &&

4030 (
	`¡rcmp
 (
mi
->
memb”
, 
m‘hod_Çme
) == 0)) {

4031 
»t
 = 
TRUE
;

4035 
»t
 = 
TRUE
;

4037 
out
:

4038  
»t
;

4039 
	}
}

4042 
h®d_exec_m‘hod_´oûss_queue
 (cÚ¡ *
udi
);

4045 
	$h®d_exec_m‘hod_’queue
 (
M‘hodInvoÿtiÚ
 *
mi
)

4047 
gpoš‹r
 
Üigkey
;

4048 
GLi¡
 *
queue
;

4050 ià(
udi_to_m‘hod_queue
 =ğ
NULL
) {

4051 
udi_to_m‘hod_queue
 = 
	`g_hash_bË_Ãw_fuÎ
 (
g_¡r_hash
,

4052 
g_¡r_equ®
,

4053 
g_ä“
,

4054 
NULL
);

4057 ià(
	`g_hash_bË_lookup_ex‹nded
 (
udi_to_m‘hod_queue
, 
mi
->
udi
, &
Üigkey
, (
gpoš‹r
è&
queue
)) {

4058 
	`HAL_INFO
 (("enqueue"));

4059 
queue
 = 
	`g_li¡_­³nd
 (queue, 
mi
);

4060 
	`g_hash_bË_»¶aû
 (
udi_to_m‘hod_queue
, 
	`g_¡rdup
 (
mi
->
udi
), 
queue
);

4062 
	`HAL_INFO
 (("no‚eedoƒnqueue"));

4063 
queue
 = 
	`g_li¡_­³nd
 (
NULL
, 
mi
);

4064 
	`g_hash_bË_š£¹
 (
udi_to_m‘hod_queue
, 
	`g_¡rdup
 (
mi
->
udi
), 
queue
);

4066 
	`h®d_exec_m‘hod_do_švoÿtiÚ
 (
mi
);

4068 
	}
}

4072 
	$h®d_exec_m‘hod_´oûss_queue
 (cÚ¡ *
udi
)

4074 
gpoš‹r
 
Üigkey
;

4075 
GLi¡
 *
queue
;

4076 
M‘hodInvoÿtiÚ
 *
mi
;

4078 ià(
	`g_hash_bË_lookup_ex‹nded
 (
udi_to_m‘hod_queue
, 
udi
, &
Üigkey
, (
gpoš‹r
è&
queue
)) {

4081 ià(
queue
 !ğ
NULL
) {

4082 
mi
 = (
M‘hodInvoÿtiÚ
 *è
queue
->
d©a
;

4083 
queue
 = 
	`g_li¡_d–‘e_lšk
 (queue, queue);

4084 ià(
queue
 =ğ
NULL
) {

4085 
	`g_hash_bË_»move
 (
udi_to_m‘hod_queue
, 
udi
);

4086 
	`HAL_INFO
 (("No more methods in queue"));

4090 ià(
	`¡rcmp
 (
mi
->
š‹rçû
, "org.freedesktop.Hal.Device.Volume") == 0 &&

4091 
	`¡rcmp
 (
mi
->
memb”
, "Unmount") == 0) {

4092 
H®Deviû
 *
d
;

4094 
	`HAL_INFO
 (("Reäeshšg mouÁ s‹ fÜ % sšû UnmouÁ(ècom¶‘ed", 
mi
->
udi
));

4096 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
mi
->
udi
);

4097 ià(
d
 =ğ
NULL
) {

4098 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
mi
->
udi
);

4101 ià(
d
 !ğ
NULL
) {

4102 
	`os¥ec_»äesh_mouÁ_¡©e_fÜ_block_deviû
 (
d
);

4104 
	`HAL_WARNING
 ((" CªnÙ fšd deviû objeù fÜ %s", 
mi
->
udi
));

4108 
	`h®d_exec_m‘hod_ä“_mi
 (
mi
);

4112 ià(
queue
 !ğ
NULL
) {

4113 
	`HAL_INFO
 (("Execing‚ext method in queue"));

4114 
	`g_hash_bË_»¶aû
 (
udi_to_m‘hod_queue
, 
	`g_¡rdup
 (
udi
), 
queue
);

4116 
mi
 = (
M‘hodInvoÿtiÚ
 *è
queue
->
d©a
;

4117 ià(!
	`h®d_exec_m‘hod_do_švoÿtiÚ
 (
mi
)) {

4119 
	`h®d_exec_m‘hod_´oûss_queue
 (
mi
->
udi
);

4123 
	}
}

4126 
	$h®d_exec_m‘hod_cb
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
,

4127 
gšt
 
»tuº_code
, 
gch¬
 **
”rÜ
,

4128 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

4130 
dbus_št32_t
 
»suÉ
;

4131 
DBusMes§ge
 *
»¶y
 = 
NULL
;

4132 
DBusMes§ge
 *
mes§ge
;

4133 
DBusMes§geI‹r
 
™”
;

4134 
DBusCÚÃùiÚ
 *
cÚn
;

4135 
gch¬
 *
exp_Çme
 = 
NULL
;

4136 
gch¬
 *
exp_d‘a
 = 
NULL
;

4138 
	`h®d_exec_m‘hod_´oûss_queue
 (
	`h®_deviû_g‘_udi
 (
d
));

4140 
mes§ge
 = (
DBusMes§ge
 *è
d©a1
;

4141 
cÚn
 = (
DBusCÚÃùiÚ
 *è
d©a2
;

4143 ià(
ex™_ty³
 =ğ
HALD_RUN_SUCCESS
 && 
”rÜ
 !ğ
NULL
 &&

4144 
”rÜ
[0] !ğ
NULL
 &&ƒrror[1] != NULL) {

4145 
exp_Çme
 = 
”rÜ
[0];

4146 ià(
”rÜ
[0] !ğ
NULL
) {

4147 
exp_d‘a
 = 
	`g_¡rdup
 (
”rÜ
[1]);

4149 
	`HAL_INFO
 (("çed w™h '%s' '%s'", 
exp_Çme
, 
exp_d‘a
));

4152 ià(
ex™_ty³
 !ğ
HALD_RUN_SUCCESS
) {

4153 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
, "org.freedesktop.Hal.Device.UnknownError", "An unknownƒrror occured");

4154 ià(
cÚn
 !ğ
NULL
) {

4155 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚn
, 
»¶y
, 
NULL
))

4156 
	`DIE
 (("No memory"));

4158 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4159 } ià(
exp_Çme
 !ğ
NULL
 && 
exp_d‘a
 != NULL) {

4160 ià(!
	`is_v®id_š‹rçû_Çme
 (
exp_Çme
)) {

4161 
gch¬
 *
Şd_d‘a
 = 
exp_d‘a
;

4163 
exp_d‘a
 = 
	`g_¡rcÚÿt
 (
exp_Çme
, " \À", 
Şd_d‘a
, 
NULL
);

4164 
exp_Çme
 = "org.freedesktop.Hal.Device.UnknownError";

4166 
	`g_ä“
 (
Şd_d‘a
);

4168 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
, 
exp_Çme
, 
exp_d‘a
);

4169 ià(
»¶y
 =ğ
NULL
) {

4170 
	`DIE
 (("No memory"));

4172 ià(
cÚn
 !ğ
NULL
) {

4173 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚn
, 
»¶y
, 
NULL
))

4174 
	`DIE
 (("No memory"));

4176 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4179 
»suÉ
 = (
dbus_št32_t
è
»tuº_code
;

4181 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

4182 ià(
»¶y
 =ğ
NULL
)

4183 
	`DIE
 (("No memory"));

4185 
	`dbus_mes§ge_™”_š™_­³nd
 (
»¶y
, &
™”
);

4186 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_INT32
, &
»suÉ
);

4188 ià(
cÚn
 !ğ
NULL
) {

4189 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚn
, 
»¶y
, 
NULL
))

4190 
	`DIE
 (("No memory"));

4193 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4196 
	`g_ä“
(
exp_d‘a
);

4197 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

4198 
	}
}

4200 
DBusHªdËrResuÉ


4201 
	$h®d_exec_m‘hod
 (
H®Deviû
 *
d
, 
CIC®ËrInfo
 *
ci
, 
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
dbus_boŞ_t
 
loÿl_š‹rçû
,

4202 
DBusMes§ge
 *
mes§ge
, cÚ¡ *
exeı©h
)

4204 
ty³
;

4205 
GSŒšg
 *
¡dš_¡r
 = 
NULL
;

4206 
DBusMes§geI‹r
 
™”
;

4207 *
exŒa_’v
[6];

4208 
uid_expÜt
[256];

4209 
£nd”_expÜt
[256];

4210 #ifdeà
HAVE_CONKIT


4211 
pid_expÜt
[256];

4212 
£lšux_cÚ‹xt_expÜt
[256];

4213 
ck_£ssiÚ_·th_expÜt
[256];

4215 
M‘hodInvoÿtiÚ
 *
mi
;

4218 
exŒa_’v
[0] = 
NULL
;

4219 
exŒa_’v
[1] = 
NULL
;

4220 
exŒa_’v
[2] = 
NULL
;

4221 
exŒa_’v
[3] = 
NULL
;

4222 
exŒa_’v
[4] = 
NULL
;

4223 
exŒa_’v
[5] = 
NULL
;

4224 ià(
loÿl_š‹rçû
) {

4225 
exŒa_’v
[0] = "HAL_METHOD_INVOKED_BY_UID=0";

4227 
n
;

4228 #ifdeà
HAVE_CONKIT


4229 cÚ¡ *
£lšux_cÚ‹xt
;

4230 cÚ¡ *
ck_£ssiÚ_·th
;

4233 
n
 = 0;

4234 
	`¥rštf
 (
uid_expÜt
, "HAL_METHOD_INVOKED_BY_UID=%u", 
	`ci_Œack”_ÿÎ”_g‘_uid
 (
ci
));

4235 
exŒa_’v
[
n
++] = 
uid_expÜt
;

4236 
	`¢´štf
 (
£nd”_expÜt
,  (sender_export),

4238 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
));

4239 
exŒa_’v
[
n
++] = 
£nd”_expÜt
;

4240 #ifdeà
HAVE_CONKIT


4241 
	`¥rštf
 (
pid_expÜt
, "HAL_METHOD_INVOKED_BY_PID=%u", 
	`ci_Œack”_ÿÎ”_g‘_pid
 (
ci
));

4242 
exŒa_’v
[
n
++] = 
pid_expÜt
;

4243 
£lšux_cÚ‹xt
 = 
	`ci_Œack”_ÿÎ”_g‘_£lšux_cÚ‹xt
 (
ci
);

4244 ià(
£lšux_cÚ‹xt
 !ğ
NULL
) {

4245 
	`¥rštf
 (
£lšux_cÚ‹xt_expÜt
, "HAL_METHOD_INVOKED_BY_SELINUX_CONTEXT=%s", 
£lšux_cÚ‹xt
);

4246 
exŒa_’v
[
n
++] = 
£lšux_cÚ‹xt_expÜt
;

4250 
ck_£ssiÚ_·th
 = 
	`ci_Œack”_ÿÎ”_g‘_ck_£ssiÚ_·th
 (
ci
);

4251 ià(
ck_£ssiÚ_·th
 !ğ
NULL
) {

4252 
	`¥rštf
 (
ck_£ssiÚ_·th_expÜt
, "HAL_METHOD_INVOKED_BY_SESSION=%s",

4253 
	`g_ba£Çme
 (
ck_£ssiÚ_·th
));

4254 
exŒa_’v
[
n
++] = 
ck_£ssiÚ_·th_expÜt
;

4260 
¡dš_¡r
 = 
	`g_¡ršg_sized_Ãw
 (256);

4261 
	`dbus_mes§ge_™”_š™
 (
mes§ge
, &
™”
);

4262 (
ty³
 = 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”
)è!ğ
DBUS_TYPE_INVALID
) {

4263 
ty³
) {

4264 
DBUS_TYPE_BYTE
:

4266 
v®ue
;

4267 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v®ue
);

4268 
	`g_¡ršg_­³nd_´štf
 (
¡dš_¡r
, "%u", 
v®ue
);

4271 
DBUS_TYPE_INT16
:

4273 
dbus_št16_t
 
v®ue
;

4274 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v®ue
);

4275 
	`g_¡ršg_­³nd_´štf
 (
¡dš_¡r
, "%d", 
v®ue
);

4278 
DBUS_TYPE_UINT16
:

4280 
dbus_ušt16_t
 
v®ue
;

4281 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v®ue
);

4282 
	`g_¡ršg_­³nd_´štf
 (
¡dš_¡r
, "%u", 
v®ue
);

4285 
DBUS_TYPE_INT32
:

4287 
dbus_št32_t
 
v®ue
;

4288 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v®ue
);

4289 
	`g_¡ršg_­³nd_´štf
 (
¡dš_¡r
, "%d", 
v®ue
);

4292 
DBUS_TYPE_UINT32
:

4294 
dbus_ušt32_t
 
v®ue
;

4295 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v®ue
);

4296 
	`g_¡ršg_­³nd_´štf
 (
¡dš_¡r
, "%u", 
v®ue
);

4299 
DBUS_TYPE_INT64
:

4301 
dbus_št64_t
 
v®ue
;

4302 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v®ue
);

4303 
	`g_¡ršg_­³nd_´štf
 (
¡dš_¡r
, "%Îd", (è
v®ue
);

4306 
DBUS_TYPE_UINT64
:

4308 
dbus_ušt64_t
 
v®ue
;

4309 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v®ue
);

4310 
	`g_¡ršg_­³nd_´štf
 (
¡dš_¡r
, "%Îu", (è
v®ue
);

4313 
DBUS_TYPE_DOUBLE
:

4315 
v®ue
;

4316 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v®ue
);

4317 
	`g_¡ršg_­³nd_´štf
 (
¡dš_¡r
, "%g", 
v®ue
);

4320 
DBUS_TYPE_BOOLEAN
:

4322 
dbus_boŞ_t
 
v®ue
;

4323 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v®ue
);

4324 
	`g_¡ršg_­³nd
 (
¡dš_¡r
, 
v®ue
 ? "true" : "false");

4327 
DBUS_TYPE_STRING
:

4329 *
v®ue
;

4330 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v®ue
);

4331 
	`g_¡ršg_­³nd
 (
¡dš_¡r
, 
v®ue
);

4335 
DBUS_TYPE_ARRAY
:

4337 
DBusMes§geI‹r
 
™”_¡¾i¡
;

4338 ià(
	`dbus_mes§ge_™”_g‘_–em’t_ty³
 (&
™”
è!ğ
DBUS_TYPE_STRING
)

4339 
”rÜ
;

4341 
	`dbus_mes§ge_™”_»cur£
 (&
™”
, &
™”_¡¾i¡
);

4342 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”_¡¾i¡
è=ğ
DBUS_TYPE_STRING
) {

4343 cÚ¡ *
v®ue
;

4344 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”_¡¾i¡
, &
v®ue
);

4345 
	`g_¡ršg_­³nd
 (
¡dš_¡r
, 
v®ue
);

4346 
	`g_¡ršg_­³nd
 (
¡dš_¡r
, "\t");

4347 
	`dbus_mes§ge_™”_Ãxt
(&
™”_¡¾i¡
);

4353 
”rÜ
;

4356 
	`g_¡ršg_­³nd_c
 (
¡dš_¡r
, '\n');

4357 
	`dbus_mes§ge_™”_Ãxt
 (&
™”
);

4360 
mi
 = 
	`g_Ãw0
 (
M‘hodInvoÿtiÚ
, 1);

4361 
mi
->
udi
 = 
	`g_¡rdup
 (
	`h®_deviû_g‘_udi
 (
d
));

4362 
mi
->
exeı©h
 = 
	`g_¡rdup
 (execpath);

4363 
mi
->
exŒa_’v
 = 
	`g_¡rdupv
 (extra_env);

4364 
mi
->
m¡dš
 = 
	`g_¡rdup
 (
¡dš_¡r
->
¡r
);

4365 
mi
->
mes§ge
 = message;

4366 
mi
->
cÚÃùiÚ
 = connection;

4367 
mi
->
memb”
 = 
	`g_¡rdup
 (
	`dbus_mes§ge_g‘_memb”
 (
mes§ge
));

4368 
mi
->
š‹rçû
 = 
	`g_¡rdup
 (
	`dbus_mes§ge_g‘_š‹rçû
 (
mes§ge
));

4369 
	`h®d_exec_m‘hod_’queue
 (
mi
);

4371 
	`dbus_mes§ge_»f
 (
mes§ge
);

4372 
	`g_¡ršg_ä“
 (
¡dš_¡r
, 
TRUE
);

4373  
DBUS_HANDLER_RESULT_HANDLED
;

4375 
”rÜ
:

4376 
	`g_¡ršg_ä“
 (
¡dš_¡r
, 
TRUE
);

4377  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

4378 
	}
}

4380 
gboŞ—n


4381 
	$fÜ—ch_deviû_g‘_xml_node
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
deviû
,

4382 
gpoš‹r
 
u£r_d©a
)

4384 
GSŒšg
 *
xml
 = 
u£r_d©a
;

4385 cÚ¡ *
udi
, *
Çme
;

4387 
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

4388 
Çme
 = 
	`¡¼chr
(
udi
, '/')+1;

4390 
xml
 = 
	`g_¡ršg_­³nd
(xml, " <node‚ame=\"");

4391 
xml
 = 
	`g_¡ršg_­³nd
(xml, 
Çme
);

4392 
xml
 = 
	`g_¡ršg_­³nd
(xml, "\"/>\n");

4394  
TRUE
;

4395 
	}
}

4397 
DBusHªdËrResuÉ


4398 
	$do_šŒo¥eù
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

4399 
DBusMes§ge
 *
mes§ge
,

4400 
dbus_boŞ_t
 
loÿl_š‹rçû
)

4402 cÚ¡ *
·th
;

4403 
DBusMes§ge
 *
»¶y
;

4404 
GSŒšg
 *
xml
;

4405 *
xml_¡ršg
;

4407 
	`HAL_TRACE
 (("entering do_introspect"));

4409 
·th
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

4411 
xml
 = 
	`g_¡ršg_Ãw
 ("<!DOCTYPE‚ode PUBLIC \"-//freedesktop//DTD D-BUS Object Introspection 1.0//EN\"\n"

4420 ià(
	`¡rcmp
 (
·th
, "/") == 0) {

4422 
xml
 = 
	`g_¡ršg_­³nd
 (xml,

4425 } ià(
	`¡rcmp
 (
·th
, "/org") == 0) {

4427 
xml
 = 
	`g_¡ršg_­³nd
 (xml,

4430 } ià(
	`¡rcmp
 (
·th
, "/org/freedesktop") == 0) {

4432 
xml
 = 
	`g_¡ršg_­³nd
 (xml,

4435 } ià(
	`¡rcmp
 (
·th
, "/org/freedesktop/Hal") == 0) {

4437 
xml
 = 
	`g_¡ršg_­³nd
 (xml,

4441 } ià(
	`¡rcmp
 (
·th
, "/org/freedesktop/Hal/devices") == 0) {

4443 
	`h®_deviû_¡Üe_fÜ—ch
 (
	`h®d_g‘_gdl
 (),

4444 
fÜ—ch_deviû_g‘_xml_node
,

4445 
xml
);

4447 } ià(
	`¡rcmp
 (
·th
, "/org/freedesktop/Hal/Manager") == 0) {

4449 
xml
 = 
	`g_¡ršg_­³nd
 (xml,

4514 
H®Deviû
 *
d
;

4515 
H®DeviûSŒLi¡I‹r
 
if_™”
;

4517 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
·th
);

4518 ià(
d
 =ğ
NULL
)

4519 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
·th
);

4521 ià(
d
 =ğ
NULL
) {

4522 
	`¿i£_no_such_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
·th
);

4523  
DBUS_HANDLER_RESULT_HANDLED
;

4526 
xml
 = 
	`g_¡ršg_­³nd
 (xml,

4609 
xml
 = 
	`g_¡ršg_­³nd
 (xml,

4689 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
d
, "šfo.š‹rçûs", &
if_™”
);

4690 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
if_™”
);

4691 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
if_™”
)) {

4692 cÚ¡ *
iâame
;

4693 *
m‘hod_Çme_´İ
;

4694 *
m‘hod_sign_´İ
;

4695 *
m‘hod_¬gn_´İ
;

4696 
GSLi¡
 *
i
;

4697 
H®DeviûSŒLi¡I‹r
 
Çme_™”
;

4698 
H®DeviûSŒLi¡I‹r
 
sign_™”
;

4699 
H®DeviûSŒLi¡I‹r
 
¬gn_™”
;

4701 
iâame
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
if_™”
);

4703 
	`g_¡ršg_­³nd_´štf
 (
xml
, " <š‹rçû‚ame=\"%s\">\n", 
iâame
);

4705 
m‘hod_Çme_´İ
 = 
	`g_¡rdup_´štf
 ("%s.m‘hod_Çmes", 
iâame
);

4706 
m‘hod_sign_´İ
 = 
	`g_¡rdup_´štf
 ("%s.m‘hod_sigÇtu»s", 
iâame
);

4707 
m‘hod_¬gn_´İ
 = 
	`g_¡rdup_´štf
 ("%s.m‘hod_¬gÇmes", 
iâame
);

4710 
i
 = 
h–³r_š‹rçû_hªdËrs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

4711 
H–³rIÁ”çûHªdËr
 *
hih
 = 
i
->
d©a
;

4712 ià(
	`¡rcmp
 (
hih
->
udi
, 
·th
) == 0 &&

4713 
	`¡rcmp
 (
hih
->
š‹rçû_Çme
, 
iâame
) == 0) {

4714 
xml
 = 
	`g_¡ršg_­³nd
 (xml, 
hih
->
šŒo¥eùiÚ_xml
);

4718 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
d
, 
m‘hod_Çme_´İ
, &
Çme_™”
),

4719 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
d
, 
m‘hod_sign_´İ
, &
sign_™”
),

4720 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
d
, 
m‘hod_¬gn_´İ
, &
¬gn_™”
);

4721 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
Çme_™”
) &&

4722 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
sign_™”
) &&

4723 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
¬gn_™”
);

4724 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
Çme_™”
),

4725 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
sign_™”
),

4726 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
¬gn_™”
)) {

4727 cÚ¡ *
Çme
;

4728 cÚ¡ *
sig
;

4729 cÚ¡ *
¬gÇmes
;

4730 
gch¬
 **
¬gs
;

4731 
n
;

4732 
m
;

4734 
Çme
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
Çme_™”
);

4735 
sig
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
sign_™”
);

4736 
¬gÇmes
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
¬gn_™”
);

4738 
¬gs
 = 
	`g_¡r¥l™
 (
¬gÇmes
, " ", 0);

4740 
	`g_¡ršg_­³nd_´štf
 (
xml
, " <m‘hod‚ame=\"%s\">\n", 
Çme
);

4742 
n
 = 0, 
m
 = 0;‚ < 
	`¡¾’
 (
sig
è&& 
¬gs
[m] !ğ
NULL
;‚++, m++) {

4743 
sig
[
n
]) {

4745 ià(
n
 =ğ
	`¡¾’
 (
sig
) - 1) {

4746 
	`HAL_WARNING
 (("Broken signature for method %s "

4748 
Çme
, 
iâame
, 
·th
));

4751 
	`g_¡ršg_­³nd_´štf
 (

4752 
xml
,

4754 
¬gs
[
m
], 
sig
[
n
 + 1]);

4755 
n
++;

4759 
	`g_¡ršg_­³nd_´štf
 (

4760 
xml
,

4762 
¬gs
[
m
], 
sig
[
n
]);

4766 
xml
 = 
	`g_¡ršg_­³nd
 (

4767 
xml
,

4769 
xml
 = 
	`g_¡ršg_­³nd
 (

4770 
xml
,

4773 
	`g_¡rä“v
(
¬gs
);

4777 
xml
 = 
	`g_¡ršg_­³nd
 (xml, " </interface>\n");

4779 
	`g_ä“
 (
m‘hod_Çme_´İ
);

4780 
	`g_ä“
 (
m‘hod_sign_´İ
);

4781 
	`g_ä“
 (
m‘hod_¬gn_´İ
);

4786 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

4788 
xml
 = 
	`g_¡ršg_­³nd
 (xml, "</node>\n");

4789 
xml_¡ršg
 = 
	`g_¡ršg_ä“
 (
xml
, 
FALSE
);

4791 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

4792 
DBUS_TYPE_STRING
, &
xml_¡ršg
,

4793 
DBUS_TYPE_INVALID
);

4795 
	`g_ä“
 (
xml_¡ršg
);

4797 ià(
»¶y
 =ğ
NULL
)

4798 
	`DIE
 (("No memory"));

4800 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

4801 
	`DIE
 (("No memory"));

4803 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4804  
DBUS_HANDLER_RESULT_HANDLED
;

4805 
	}
}

4808 
	$»¶y_äom_fwd_mes§ge
 (
DBusP’dšgC®l
 *
³ndšg_ÿÎ
,

4809 *
u£r_d©a
)

4811 
DBusMes§ge
 *
»¶y_äom_addÚ
;

4812 
DBusMes§ge
 *
m‘hod_äom_ÿÎ”
;

4813 
DBusMes§ge
 *
»¶y
;

4817 
m‘hod_äom_ÿÎ”
 = (
DBusMes§ge
 *è
u£r_d©a
;

4818 
»¶y_äom_addÚ
 = 
	`dbus_³ndšg_ÿÎ_¡—l_»¶y
 (
³ndšg_ÿÎ
);

4820 
»¶y
 = 
	`dbus_mes§ge_cİy
 (
»¶y_äom_addÚ
);

4821 ià(
»¶y
 !ğ
NULL
) {

4822 
	`dbus_mes§ge_£t_de¡š©iÚ
 (
»¶y
, 
	`dbus_mes§ge_g‘_£nd”
 (
m‘hod_äom_ÿÎ”
));

4823 
	`dbus_mes§ge_£t_»¶y_£rŸl
 (
»¶y
, 
	`dbus_mes§ge_g‘_£rŸl
 (
m‘hod_äom_ÿÎ”
));

4825 ià(
dbus_cÚÃùiÚ
 !ğ
NULL
)

4826 
	`dbus_cÚÃùiÚ_£nd
 (
dbus_cÚÃùiÚ
, 
»¶y
, 
NULL
);

4829 
	`dbus_mes§ge_uÄef
 (
»¶y_äom_addÚ
);

4830 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4831 
	`dbus_mes§ge_uÄef
 (
m‘hod_äom_ÿÎ”
);

4832 
	`dbus_³ndšg_ÿÎ_uÄef
 (
³ndšg_ÿÎ
);

4833 
	}
}

4835 
DBusHªdËrResuÉ


4836 
	$h®d_dbus_f‹r_hªdË_m‘hods
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

4837 *
u£r_d©a
, 
dbus_boŞ_t
 
loÿl_š‹rçû
)

4846 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4849 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

4851  
	`mªag”_g‘_®l_deviûs
 (
cÚÃùiÚ
, 
mes§ge
);

4852 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4855 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

4857  
	`mªag”_g‘_®l_deviûs_w™h_´İ”t›s
 (
cÚÃùiÚ
, 
mes§ge
);

4858 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4861 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

4863  
	`mªag”_deviû_exi¡s
 (
cÚÃùiÚ
, 
mes§ge
);

4864 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4867 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

4869  
	`mªag”_fšd_deviû_¡ršg_m©ch
 (
cÚÃùiÚ
,

4870 
mes§ge
);

4871 } ià(
dbus_mes§ge_is_m‘hod_ÿÎ


4872 (
mes§ge
, "org.freedesktop.Hal.Manager",

4874 && 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

4876  
	`mªag”_fšd_deviû_by_ÿ·b™y
 (
cÚÃùiÚ
,

4877 
mes§ge
);

4878 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4881 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

4883  
	`mªag”_Ãw_deviû
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4884 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4887 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

4889  
	`mªag”_»move
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4890 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4893 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

4895  
	`mªag”_comm™_to_gdl
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4897 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4900 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
), "/org/freedesktop/Hal/Manager") == 0) {

4901  
	`deviû_acquœe_glob®_š‹rçû_lock
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4902 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4905 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
), "/org/freedesktop/Hal/Manager") == 0) {

4906  
	`deviû_»Ëa£_glob®_š‹rçû_lock
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4907 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4910 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

4912  
	`sšgËtÚ_addÚ_is_»ady
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4914 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4917  
	`deviû_acquœe_š‹rçû_lock
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4918 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4921  
	`deviû_»Ëa£_š‹rçû_lock
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4922 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4925  
	`deviû_is_ÿÎ”_locked_out
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4926 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4929  
	`deviû_is_ÿÎ”_´iveged
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4930 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4933  
	`deviû_is_locked_by_Ùh”s
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4934 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4937  
	`deviû_g‘_®l_´İ”t›s
 (
cÚÃùiÚ
, 
mes§ge
);

4938 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4941  
	`deviû_£t_muÉË_´İ”t›s
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4942 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4945  
	`deviû_g‘_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
);

4946 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4949  
	`deviû_g‘_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
);

4950 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4953  
	`deviû_g‘_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
);

4954 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4957  
	`deviû_g‘_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
);

4958 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4961  
	`deviû_g‘_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
);

4962 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4965  
	`deviû_g‘_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
);

4966 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4969  
	`deviû_£t_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4970 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4973  
	`deviû_£t_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4974 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4977  
	`deviû_£t_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4978 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4981  
	`deviû_£t_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4982 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4985  
	`deviû_£t_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4986 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4989  
	`deviû_»move_´İ”ty
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

4990 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4993  
	`deviû_g‘_´İ”ty_ty³
 (
cÚÃùiÚ
, 
mes§ge
);

4994 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

4997  
	`deviû_´İ”ty_exi¡s
 (
cÚÃùiÚ
, 
mes§ge
);

4998 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5001  
	`deviû_add_ÿ·b™y
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

5002 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5005  
	`deviû_qu”y_ÿ·b™y
 (
cÚÃùiÚ
, 
mes§ge
);

5006 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5009  
	`deviû_lock
 (
cÚÃùiÚ
, 
mes§ge
);

5010 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5013  
	`deviû_uÆock
 (
cÚÃùiÚ
, 
mes§ge
);

5014 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5017  
	`deviû_¡ršg_li¡_­³nd_´•’d
 (
cÚÃùiÚ
, 
mes§ge
, 
FALSE
);

5018 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5021  
	`deviû_¡ršg_li¡_­³nd_´•’d
 (
cÚÃùiÚ
, 
mes§ge
, 
TRUE
);

5022 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5025  
	`deviû_¡ršg_li¡_»move
 (
cÚÃùiÚ
, 
mes§ge
);

5026 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5029  
	`deviû_»sÿn
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

5030 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5033  
	`deviû_»´obe
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

5034 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5037  
	`deviû_em™_cÚd™iÚ
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

5038 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5041  
	`deviû_şaim_š‹rçû
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

5043 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5046  
	`deviû_»Ëa£_š‹rçû
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

5048 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5051  
	`addÚ_is_»ady
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

5052 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

5055  
	`do_šŒo¥eù
 (
cÚÃùiÚ
, 
mes§ge
, 
loÿl_š‹rçû
);

5057 cÚ¡ *
š‹rçû
;

5058 cÚ¡ *
udi
;

5059 cÚ¡ *
m‘hod
;

5060 cÚ¡ *
sigÇtu»
;

5061 cÚ¡ *
ÿÎ”
;

5062 
H®Deviû
 *
d
;

5063 
GSLi¡
 *
i
;

5064 
H®DeviûSŒLi¡I‹r
 
if_™”
;

5065 
CIC®ËrInfo
 *
ci
;

5069 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

5070 
š‹rçû
 = 
	`dbus_mes§ge_g‘_š‹rçû
 (
mes§ge
);

5071 
m‘hod
 = 
	`dbus_mes§ge_g‘_memb”
 (
mes§ge
);

5072 
sigÇtu»
 = 
	`dbus_mes§ge_g‘_sigÇtu»
 (
mes§ge
);

5074 ià(
udi
 =ğ
NULL
 || 
m‘hod
 =ğNULL || 
sigÇtu»
 =ğNULL || 
š‹rçû
 == NULL)

5075 
out
;

5077 
ÿÎ”
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

5078 ià(
loÿl_š‹rçû
) {

5079 
ci
 = 
NULL
;

5081 
ci
 = 
	`ci_Œack”_g‘_šfo
 (
ci_Œack”
, 
ÿÎ”
);

5082 ià(
ci
 =ğ
NULL
) {

5083 
	`HAL_ERROR
 (("CªnÙ g‘ c®Ë¸šfØfÜ %s", 
ÿÎ”
));

5084 
out
;

5088 
d
 = 
NULL
;

5089 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi
);

5090 ià(
d
 =ğ
NULL
)

5091 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi
);

5092 ià(
d
 =ğ
NULL
)

5093 
out
;

5106 ià(
	`acûss_check_ÿÎ”_locked_out
 (
ci_Œack”
, 
d
, 
ÿÎ”
, 
š‹rçû
)) {

5107 
	`¿i£_š‹rçû_locked
 (
cÚÃùiÚ
, 
mes§ge
, 
š‹rçû
);

5108  
DBUS_HANDLER_RESULT_HANDLED
;

5112 
i
 = 
h–³r_š‹rçû_hªdËrs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

5113 
H–³rIÁ”çûHªdËr
 *
hih
 = 
i
->
d©a
;

5114 ià(
	`¡rcmp
 (
hih
->
udi
, udi) == 0 &&

5115 
	`¡rcmp
 (
hih
->
š‹rçû_Çme
, 
š‹rçû
) == 0) {

5116 
DBusP’dšgC®l
 *
³ndšg_ÿÎ
;

5117 
DBusMes§ge
 *
cİy
;

5121 
	`dbus_mes§ge_»f
 (
mes§ge
);

5124 
cİy
 = 
	`dbus_mes§ge_cİy
 (
mes§ge
);

5125 ià(!
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y
 (
hih
->
cÚÃùiÚ
,

5126 
cİy
,

5127 &
³ndšg_ÿÎ
,

5132 
	`dbus_³ndšg_ÿÎ_£t_nÙify
 (
³ndšg_ÿÎ
,

5133 
»¶y_äom_fwd_mes§ge
,

5134 (*è
mes§ge
,

5135 
NULL
);

5138 
	`dbus_mes§ge_uÄef
 (
cİy
);

5139  
DBUS_HANDLER_RESULT_HANDLED
;

5144 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
d
, "šfo.š‹rçûs", &
if_™”
);

5145 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
if_™”
);

5146 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
if_™”
)) {

5147 cÚ¡ *
iâame
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
if_™”
);

5149 ià(
	`¡rcmp
 (
iâame
, 
š‹rçû
) == 0) {

5150 
gušt
 
num
;

5151 
H®DeviûSŒLi¡I‹r
 
Çme_™”
;

5152 *
s
;

5154 
s
 = 
	`g_¡rdup_´štf
 ("%s.m‘hod_Çmes", 
š‹rçû
);

5155 
	`h®_deviû_´İ”ty_¡¾i¡_™”_š™
 (
d
, 
s
, &
Çme_™”
);

5156 
	`g_ä“
 (
s
);

5157 
num
 = 0;

5158 
	`h®_deviû_´İ”ty_¡¾i¡_™”_is_v®id
 (&
Çme_™”
);

5159 
	`h®_deviû_´İ”ty_¡¾i¡_™”_Ãxt
 (&
Çme_™”
), 
num
++) {

5160 cÚ¡ *
m‘hodÇme
;

5161 
m‘hodÇme
 = 
	`h®_deviû_´İ”ty_¡¾i¡_™”_g‘_v®ue
 (&
Çme_™”
);

5162 ià(
	`¡rcmp
 (
m‘hodÇme
, 
m‘hod
) == 0) {

5163 cÚ¡ *
exeı©h
;

5164 cÚ¡ *
sig
;

5166 
s
 = 
	`g_¡rdup_´štf
 ("%s.m‘hod_exeı©hs", 
š‹rçû
);

5167 
exeı©h
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡_–em
 (
d
, 
s
, 
num
);

5168 
	`g_ä“
 (
s
);

5169 
s
 = 
	`g_¡rdup_´štf
 ("%s.m‘hod_sigÇtu»s", 
š‹rçû
);

5170 
sig
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡_–em
 (
d
, 
s
, 
num
);

5171 
	`g_ä“
 (
s
);

5173 ià(
exeı©h
 !ğ
NULL
 && 
sig
 != NULL &&

5174 
	`¡rcmp
 (
sig
, 
sigÇtu»
) == 0) {

5176 
	`HAL_INFO
 (("OK fÜ m‘hod '%s' w™h sigÇtu» '%s' oÀš‹rçû '%s' fÜ UDI '%s'‡ndƒxeı©h '%s'", 
m‘hod
, 
sigÇtu»
, 
š‹rçû
, 
udi
, 
exeı©h
));

5178  
	`h®d_exec_m‘hod
 (
d
, 
ci
, 
cÚÃùiÚ
,

5179 
loÿl_š‹rçû
,

5180 
mes§ge
, 
exeı©h
);

5188 
out
:

5189  
	`os¥ec_f‹r_funùiÚ
 (
cÚÃùiÚ
, 
mes§ge
, 
u£r_d©a
);

5190 
	}
}

5204 
DBusHªdËrResuÉ


5205 
	$h®d_dbus_f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

5206 
DBusMes§ge
 * 
mes§ge
, *
u£r_d©a
)

5208 ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, 
DBUS_INTERFACE_LOCAL
, "Disconnected") &&

5209 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
), 
DBUS_PATH_LOCAL
) == 0) {

5213 
	`HAL_INFO
 (("Got disconnected fromhe system message bus; "

5215 
	`dbus_cÚÃùiÚ_uÄef
 (
dbus_cÚÃùiÚ
);

5216 
dbus_cÚÃùiÚ
 = 
NULL
;

5218 #ifdeà
HAVE_GLIB_2_14


5219 
	`g_timeout_add_£cÚds
 (3, 
»š™_dbus
, 
NULL
);

5221 
	`g_timeout_add
 (3000, 
»š™_dbus
, 
NULL
);

5223 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, 
DBUS_INTERFACE_DBUS
, "NameAcquired")){

5225  
DBUS_HANDLER_RESULT_HANDLED
;

5226 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
,

5227 
DBUS_INTERFACE_DBUS
,

5229 *
Çme
;

5230 *
Şd_£rviû_Çme
;

5231 *
Ãw_£rviû_Çme
;

5233 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, 
NULL
,

5234 
DBUS_TYPE_STRING
, &
Çme
,

5235 
DBUS_TYPE_STRING
, &
Şd_£rviû_Çme
,

5236 
DBUS_TYPE_STRING
, &
Ãw_£rviû_Çme
,

5237 
DBUS_TYPE_INVALID
)) {

5238 
	`HAL_ERROR
 (("Invalid NameOwnerChanged signal from bus!"));

5239 
out
;

5244 
	`ci_Œack”_Çme_owÃr_chªged
 (
ci_Œack”
, 
Çme
, 
Şd_£rviû_Çme
, 
Ãw_£rviû_Çme
);

5246 ià(
£rviûs_w™h_locks
 !ğ
NULL
)

5247 
	`£rviûs_w™h_locks_»move_lockowÃr
(
Şd_£rviû_Çme
);

5249 ià(
	`¡¾’
 (
Şd_£rviû_Çme
) > 0)

5250 
	`h®_deviû_ş›Á_discÚÃùed
 (
Şd_£rviû_Çme
);

5252 #ifdeà
HAVE_CONKIT


5253 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
,

5256 
gboŞ—n
 
is_aùive
;

5257 cÚ¡ *
£ssiÚ_obj·th
;

5259 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, 
NULL
,

5260 
DBUS_TYPE_BOOLEAN
, &
is_aùive
,

5261 
DBUS_TYPE_INVALID
)) {

5262 
	`HAL_ERROR
 (("Invalid ActiveChanged signal from ConsoleKit!"));

5263 
out
;

5266 
£ssiÚ_obj·th
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

5268 
	`HAL_INFO
 (("aùive=%d fÜ sessiÚ %s", 
is_aùive
, 
£ssiÚ_obj·th
));

5269 
	`ci_Œack”_aùive_chªged
 (
ci_Œack”
, 
£ssiÚ_obj·th
, 
is_aùive
);

5273 #ifdeà
HAVE_CONKIT


5275 ià(
ck_Œack”
 !ğ
NULL
) {

5276 
	`ck_Œack”_´oûss_sy¡em_bus_mes§ge
 (
ck_Œack”
, 
mes§ge
);

5279  
	`h®d_dbus_f‹r_hªdË_m‘hods
 (
cÚÃùiÚ
, 
mes§ge
, 
u£r_d©a
, 
FALSE
);

5282 
out
:

5284 #ifdeà
HAVE_CONKIT


5286 ià(
ck_Œack”
 !ğ
NULL
) {

5287 
	`ck_Œack”_´oûss_sy¡em_bus_mes§ge
 (
ck_Œack”
, 
mes§ge
);

5291  
DBUS_HANDLER_RESULT_HANDLED
;

5292 
	}
}

5295 
DBusHªdËrResuÉ


5296 
	$loÿl_£rv”_mes§ge_hªdËr
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

5297 
DBusMes§ge
 *
mes§ge
,

5298 *
u£r_d©a
)

5306 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
, "org.freedesktop.DBus", "AddMatch")) {

5307 
DBusMes§ge
 *
»¶y
;

5310 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

5311 ià(
»¶y
 =ğ
NULL
)

5312 
	`DIE
 (("No memory"));

5313 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

5314 
	`DIE
 (("No memory"));

5315 
	`dbus_mes§ge_uÄef
 (
»¶y
);

5316  
DBUS_HANDLER_RESULT_HANDLED
;

5317 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, 
DBUS_INTERFACE_LOCAL
, "Disconnected") &&

5318 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
), 
DBUS_PATH_LOCAL
) == 0) {

5319 
GSLi¡
 *
i
;

5320 
GSLi¡
 *
j
;

5326 
i
 = 
h–³r_š‹rçû_hªdËrs
; i !ğ
NULL
; i = 
j
) {

5327 
H–³rIÁ”çûHªdËr
 *
hih
 = 
i
->
d©a
;

5329 
j
 = 
	`g_¦i¡_Ãxt
 (
i
);

5331 ià(
hih
->
cÚÃùiÚ
 == connection) {

5332 
	`g_ä“
 (
hih
->
š‹rçû_Çme
);

5333 
	`g_ä“
 (
hih
->
šŒo¥eùiÚ_xml
);

5334 
	`g_ä“
 (
hih
->
udi
);

5335 
	`g_ä“
 (
hih
);

5336 
h–³r_š‹rçû_hªdËrs
 = 
	`g_¦i¡_»move_lšk
 (h–³r_š‹rçû_hªdËrs, 
i
);

5340 ià(
sšgËtÚs
)

5341 
	`g_hash_bË_fÜ—ch_»move
 (
sšgËtÚs
, (
GHRFunc
è
sšgËtÚ_»move_by_cÚÃùiÚ
, 
cÚÃùiÚ
);

5343 
	`dbus_cÚÃùiÚ_uÄef
 (
cÚÃùiÚ
);

5344  
DBUS_HANDLER_RESULT_HANDLED
;

5345 } ià(
	`dbus_mes§ge_g‘_ty³
 (
mes§ge
è=ğ
DBUS_MESSAGE_TYPE_SIGNAL
) {

5346 
DBusMes§ge
 *
cİy
;

5349 
cİy
 = 
	`dbus_mes§ge_cİy
 (
mes§ge
);

5350 ià(
dbus_cÚÃùiÚ
 !ğ
NULL
) {

5351 
	`dbus_cÚÃùiÚ_£nd
 (
dbus_cÚÃùiÚ
, 
cİy
, 
NULL
);

5353 
	`dbus_mes§ge_uÄef
 (
cİy
);

5355 
DBusHªdËrResuÉ
 
»t
;

5356 
»t
 = 
	`h®d_dbus_f‹r_hªdË_m‘hods
 (
cÚÃùiÚ
, 
mes§ge
, 
u£r_d©a
, 
TRUE
);

5357  
»t
;

5360  
DBUS_HANDLER_RESULT_HANDLED
;

5361 
	}
}

5364 
	$loÿl_£rv”_uÄegi¡”_hªdËr
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, *
u£r_d©a
)

5369 
	}
}

5372 
	$loÿl_£rv”_hªdË_cÚÃùiÚ
 (
DBusS”v”
 *
£rv”
,

5373 
DBusCÚÃùiÚ
 *
Ãw_cÚÃùiÚ
,

5374 *
d©a
)

5376 
DBusObjeùP©hVTabË
 
vbË
 = { &
loÿl_£rv”_uÄegi¡”_hªdËr
,

5377 &
loÿl_£rv”_mes§ge_hªdËr
,

5378 
NULL
, NULL, NULL, NULL};

5386 
	`dbus_cÚÃùiÚ_»gi¡”_çÎback
 (
Ãw_cÚÃùiÚ
,

5388 &
vbË
,

5389 
NULL
);

5390 
	`dbus_cÚÃùiÚ_»f
 (
Ãw_cÚÃùiÚ
);

5391 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
Ãw_cÚÃùiÚ
, 
NULL
);

5392 
	}
}

5395 
DBusS”v”
 *
	gloÿl_£rv”
 = 
NULL
;

5396 *
	gloÿl_£rv”_add»ss
 = 
NULL
;

5399 
	$h®d_dbus_loÿl_£rv”_addr
 ()

5401  
loÿl_£rv”_add»ss
;

5402 
	}
}

5404 
gboŞ—n


5405 
	$h®d_dbus_loÿl_£rv”_š™
 ()

5407 
gboŞ—n
 
»t
;

5408 
DBusE¼Ü
 
”rÜ
;

5410 
»t
 = 
FALSE
;

5415 
	`dbus_”rÜ_š™
 (&
”rÜ
);

5416 ià((
loÿl_£rv”
 = 
	`dbus_£rv”_li¡’
 (
HALD_DBUS_ADDRESS
, &
”rÜ
)è=ğ
NULL
) {

5417 
	`HAL_ERROR
 (("Cannot create D-BUS server"));

5418 
out
;

5420 
loÿl_£rv”_add»ss
 = 
	`dbus_£rv”_g‘_add»ss
 (
loÿl_£rv”
);

5421 
	`HAL_INFO
 (("loÿÈ£rv” i li¡’šg‡ˆ%s", 
loÿl_£rv”_add»ss
));

5422 
	`dbus_£rv”_£tup_w™h_g_maš
 (
loÿl_£rv”
, 
NULL
);

5423 
	`dbus_£rv”_£t_Ãw_cÚÃùiÚ_funùiÚ
 (
loÿl_£rv”
, 
loÿl_£rv”_hªdË_cÚÃùiÚ
, 
NULL
, NULL);

5425 
»t
 = 
TRUE
;

5427 
out
:

5428  
»t
;

5429 
	}
}

5432 
	$h®d_dbus_loÿl_£rv”_shutdown
 ()

5434 ià(
loÿl_£rv”
 !ğ
NULL
) {

5435 
	`HAL_INFO
 (("Shutting down†ocal server"));

5436 
	`dbus_£rv”_discÚÃù
 (
loÿl_£rv”
);

5437 
	`dbus_£rv”_uÄef
 (
loÿl_£rv”
);

5438 
loÿl_£rv”
 = 
NULL
;

5439 
	`dbus_ä“
 (
loÿl_£rv”_add»ss
);

5440 
loÿl_£rv”_add»ss
 = 
NULL
;

5442 
	}
}

5444 #ifdeà
HAVE_CONKIT


5447 
	$h®d_dbus_£©_added
 (
CKT¿ck”
 *
Œack”
, 
CKS—t
 *
£©
, *
u£r_d©a
)

5450 
	}
}

5453 
	$h®d_dbus_£©_»moved
 (
CKT¿ck”
 *
Œack”
, 
CKS—t
 *
£©
, *
u£r_d©a
)

5456 
	}
}

5458 
gboŞ—n


5459 
	$v®id©e_lock_fÜ_deviû
 (
H®DeviûStÜe
 *
¡Üe
,

5460 
H®Deviû
 *
deviû
,

5461 
gpoš‹r
 
u£r_d©a
)

5463 
n
, 
m
;

5464 **
hŞd”s
;

5465 **
locked_š‹rçûs
;

5467 
locked_š‹rçûs
 = 
	`h®_deviû_´İ”ty_dup_¡¾i¡_as_¡rv
 (
deviû
, "info.named_locks");

5468 ià(
locked_š‹rçûs
 =ğ
NULL
)

5469 
out
;

5471 
n
 = 0; 
locked_š‹rçûs
[n] !ğ
NULL
;‚++) {

5472 
hŞd”s
 = 
	`h®_deviû_g‘_lock_hŞd”s
 (
deviû
, 
locked_š‹rçûs
[
n
]);

5473 ià(
hŞd”s
 =ğ
NULL
)

5476 
m
 = 0; 
hŞd”s
[m] !ğ
NULL
; m++) {

5478 
	`HAL_INFO
 (("Validating†ock holder '%s' on interface '%s' on udi '%s'",

5479 
hŞd”s
[
m
], 
locked_š‹rçûs
[
n
], 
	`h®_deviû_g‘_udi
 (
deviû
)));

5481 ià(!
	`acûss_check_ÿÎ”_have_acûss_to_deviû
 (

5482 
ci_Œack”
, 
deviû
, "Üg.ä“desktİ.h®.lock", 
hŞd”s
[
m
], 
NULL
)) {

5483 
	`HAL_INFO
 (("Kicking out†ock holder '%s' on interface '%s' on udi '%s' "

5485 
hŞd”s
[
m
], 
locked_š‹rçûs
[
n
], 
	`h®_deviû_g‘_udi
 (
deviû
)));

5486 
	`h®_deviû_»Ëa£_lock
 (
deviû
, 
locked_š‹rçûs
[
n
], 
hŞd”s
[
m
]);

5489 
	`g_¡rä“v
 (
hŞd”s
);

5492 
	`g_¡rä“v
 (
locked_š‹rçûs
);

5493 
out
:

5494  
TRUE
;

5495 
	}
}

5498 
	$v®id©e_locks
 ()

5500 
	`h®_deviû_¡Üe_fÜ—ch
 (
	`h®d_g‘_tdl
 (), 
v®id©e_lock_fÜ_deviû
, 
NULL
);

5501 
	`h®_deviû_¡Üe_fÜ—ch
 (
	`h®d_g‘_gdl
 (), 
v®id©e_lock_fÜ_deviû
, 
NULL
);

5502 
	}
}

5505 
	$»cÚfigu»_aş
 ()

5507 #ifdeà
HAVE_ACLMGMT


5508 
H®Deviû
 *
d
;

5509 *
exŒa_’v
[1] = {
NULL
};

5511 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/org/freedesktop/Hal/devices/computer");

5512 ià(
d
 =ğ
NULL
) {

5513 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/org/freedesktop/Hal/devices/computer");

5515 ià(
d
 =ğ
NULL
) {

5516 
	`HAL_ERROR
 (("No computer object?!?"));

5517 
out
;

5520 
	`h®d_ruÂ”_run
 (
d
,

5522 
exŒa_’v
,

5523 
HAL_HELPER_TIMEOUT
,

5524 
NULL
,

5525 
NULL
 ,

5526 
NULL
 );

5527 
out
:

5530 
	}
}

5534 
	$»cÚfigu»_®l_pŞicy
 ()

5536 
	`HAL_INFO
 (("Reconfiguring‡ll…olicy"));

5539 
	`v®id©e_locks
 ();

5542 
	`»cÚfigu»_aş
 ();

5543 
	}
}

5547 
H®Deviû
 *
	md
;

5548 **
	m´og¿ms
;

5549 **
	mexŒa_’v
;

5550 } 
	tSessiÚChªgesEÁry
;

5552 
GLi¡
 *
	g£ssiÚ_chªges_queue
 = 
NULL
;

5553 
gboŞ—n
 
	g£ssiÚ_chªges_is_ruÂšg
 = 
FALSE
;

5555 
£ssiÚ_chªges_´oûss_queue
 ();

5558 
	$£ssiÚ_chªges_dÚe_cb
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

5560 
SessiÚChªgesEÁry
 *
’Œy
 = 
u£rd©a1
;

5562 
	`HAL_INFO
 (("session_changes_done_cb"));

5564 
	`g_as£¹
 (
’Œy
->
d
 == d);

5567 
	`g_objeù_uÄef
 (
’Œy
->
d
);

5568 
	`g_¡rä“v
 (
’Œy
->
exŒa_’v
);

5569 
	`g_ä“
 (
’Œy
);

5571 
£ssiÚ_chªges_is_ruÂšg
 = 
FALSE
;

5573 
	`£ssiÚ_chªges_´oûss_queue
 ();

5574 
	}
}

5577 
	$£ssiÚ_chªges_´oûss_queue
 ()

5579 
SessiÚChªgesEÁry
 *
’Œy
;

5581 
	`HAL_INFO
 (("session_changes_process_queue"));

5584 ià(
£ssiÚ_chªges_queue
 =ğ
NULL
)

5588 ià(
£ssiÚ_chªges_is_ruÂšg
)

5591 
	`HAL_INFO
 (("„unningƒlement in queue"));

5594 
’Œy
 = 
£ssiÚ_chªges_queue
->
d©a
;

5595 
£ssiÚ_chªges_queue
 = 
	`g_li¡_»move
 (£ssiÚ_chªges_queue, 
’Œy
);

5597 
	`h®_ÿÎout_deviû
 (
’Œy
->
d
,

5598 
£ssiÚ_chªges_dÚe_cb
,

5599 
’Œy
,

5600 
NULL
,

5601 
’Œy
->
´og¿ms
,

5602 
’Œy
->
exŒa_’v
);

5604 
£ssiÚ_chªges_is_ruÂšg
 = 
TRUE
;

5605 
	}
}

5608 
	$£ssiÚ_chªges_push
 (
H®Deviû
 *
d
, **
´og¿ms
, **
exŒa_’v
)

5610 
SessiÚChªgesEÁry
 *
’Œy
;

5612 
	`HAL_INFO
 (("session_changes_push"));

5614 
’Œy
 = 
	`g_Ãw0
 (
SessiÚChªgesEÁry
, 1);

5615 
’Œy
->
d
 = 
	`g_objeù_»f
 (d);

5616 
’Œy
->
´og¿ms
 = 
	`g_¡rdupv
 (programs);

5617 
’Œy
->
exŒa_’v
 = 
	`g_¡rdupv
 (extra_env);

5620 
£ssiÚ_chªges_queue
 = 
	`g_li¡_­³nd
 (£ssiÚ_chªges_queue, 
’Œy
);

5623 
	`£ssiÚ_chªges_´oûss_queue
 ();

5624 
	}
}

5627 
	$h®d_dbus_£ssiÚ_aùive_chªged
 (
CKT¿ck”
 *
Œack”
, 
CKSessiÚ
 *
£ssiÚ
, *
u£r_d©a
)

5629 
H®Deviû
 *
d
;

5630 **
´og¿ms
;

5631 *
exŒa_’v
[5] = {"HALD_ACTION=session_active_changed",

5632 
NULL
 ,

5633 
NULL
 ,

5634 
NULL
 ,

5635 
NULL
};

5637 
	`HAL_INFO
 (("In hald_dbus_session_active_changed for session '%s': %s",

5638 
	`ck_£ssiÚ_g‘_id
 (
£ssiÚ
),

5639 
	`ck_£ssiÚ_is_aùive
 (
£ssiÚ
) ? "ACTIVE" : "INACTIVE"));

5642 
	`v®id©e_locks
 ();

5644 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/org/freedesktop/Hal/devices/computer");

5645 ià(
d
 =ğ
NULL
) {

5646 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/org/freedesktop/Hal/devices/computer");

5648 ià(
d
 =ğ
NULL
) {

5649 
out
;

5652 
´og¿ms
 = 
	`h®_deviû_´İ”ty_dup_¡¾i¡_as_¡rv
 (
d
,

5653 
	`ck_£ssiÚ_is_aùive
 (
£ssiÚ
) ?

5656 ià(
´og¿ms
 =ğ
NULL
) {

5657 
out
;

5660 
exŒa_’v
[1] = 
	`g_¡rdup_´štf
 ("HALD_SESSION_ACTIVE_CHANGED_SESSION_ID=%s", 
	`ck_£ssiÚ_g‘_id
 (
£ssiÚ
));

5661 
exŒa_’v
[2] = 
	`g_¡rdup_´štf
 ("HALD_SESSION_ACTIVE_CHANGED_SESSION_UID=%u", 
	`ck_£ssiÚ_g‘_u£r
 (
£ssiÚ
));

5662 
exŒa_’v
[3] = 
	`g_¡rdup_´štf
 ("HALD_SESSION_ACTIVE_CHANGED_SESSION_IS_ACTIVE=%s",

5663 
	`ck_£ssiÚ_is_aùive
 (
£ssiÚ
) ? "true" : "false");

5665 
	`£ssiÚ_chªges_push
 (
d
, 
´og¿ms
, 
exŒa_’v
);

5667 
	`g_ä“
 (
exŒa_’v
[1]);

5668 
	`g_ä“
 (
exŒa_’v
[2]);

5669 
	`g_ä“
 (
exŒa_’v
[3]);

5670 
out
:

5672 
	}
}

5675 
	$h®d_dbus_£ssiÚ_added
 (
CKT¿ck”
 *
Œack”
, 
CKSessiÚ
 *
£ssiÚ
, *
u£r_d©a
)

5677 
H®Deviû
 *
d
;

5678 **
´og¿ms
;

5679 *
exŒa_’v
[5] = {"HALD_ACTION=session_add",

5680 
NULL
 ,

5681 
NULL
 ,

5682 
NULL
 ,

5683 
NULL
};

5685 
	`HAL_INFO
 (("In hald_dbus_session_added for session '%s' on seat '%s'",

5686 
	`ck_£ssiÚ_g‘_id
 (
£ssiÚ
),

5687 
	`ck_£ssiÚ_g‘_£©
 (
£ssiÚ
è!ğ
NULL
 ? 
	`ck_£©_g‘_id
 (ck_session_get_seat (session)) : "(NONE)"));

5689 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/org/freedesktop/Hal/devices/computer");

5690 ià(
d
 =ğ
NULL
) {

5691 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/org/freedesktop/Hal/devices/computer");

5693 ià(
d
 =ğ
NULL
) {

5694 
out
;

5697 
´og¿ms
 = 
	`h®_deviû_´İ”ty_dup_¡¾i¡_as_¡rv
 (
d
, "info.callouts.session_add");

5698 ià(
´og¿ms
 =ğ
NULL
) {

5699 
out
;

5702 
exŒa_’v
[1] = 
	`g_¡rdup_´štf
 ("HALD_SESSION_ADD_SESSION_ID=%s", 
	`ck_£ssiÚ_g‘_id
 (
£ssiÚ
));

5703 
exŒa_’v
[2] = 
	`g_¡rdup_´štf
 ("HALD_SESSION_ADD_SESSION_UID=%u", 
	`ck_£ssiÚ_g‘_u£r
 (
£ssiÚ
));

5704 
exŒa_’v
[3] = 
	`g_¡rdup_´štf
 ("HALD_SESSION_ADD_SESSION_IS_ACTIVE=%s",

5705 
	`ck_£ssiÚ_is_aùive
 (
£ssiÚ
) ? "true" : "false");

5707 
	`£ssiÚ_chªges_push
 (
d
, 
´og¿ms
, 
exŒa_’v
);

5709 
	`g_ä“
 (
exŒa_’v
[1]);

5710 
	`g_ä“
 (
exŒa_’v
[2]);

5711 
	`g_ä“
 (
exŒa_’v
[3]);

5712 
out
:

5714 
	}
}

5717 
	$h®d_dbus_£ssiÚ_»moved
 (
CKT¿ck”
 *
Œack”
, 
CKSessiÚ
 *
£ssiÚ
, *
u£r_d©a
)

5719 
H®Deviû
 *
d
;

5720 **
´og¿ms
;

5721 *
exŒa_’v
[5] = {"HALD_ACTION=session_remove",

5722 
NULL
 ,

5723 
NULL
 ,

5724 
NULL
 ,

5725 
NULL
};

5727 
	`HAL_INFO
 (("In hald_dbus_session_removed for session '%s' on seat '%s'",

5728 
	`ck_£ssiÚ_g‘_id
 (
£ssiÚ
),

5729 
	`ck_£ssiÚ_g‘_£©
 (
£ssiÚ
è!ğ
NULL
 ? 
	`ck_£©_g‘_id
 (ck_session_get_seat (session)) : "(NONE)"));

5731 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/org/freedesktop/Hal/devices/computer");

5732 ià(
d
 =ğ
NULL
) {

5733 
d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/org/freedesktop/Hal/devices/computer");

5735 ià(
d
 =ğ
NULL
) {

5736 
out
;

5739 
´og¿ms
 = 
	`h®_deviû_´İ”ty_dup_¡¾i¡_as_¡rv
 (
d
, "info.callouts.session_remove");

5740 ià(
´og¿ms
 =ğ
NULL
) {

5741 
out
;

5744 
exŒa_’v
[1] = 
	`g_¡rdup_´štf
 ("HALD_SESSION_REMOVE_SESSION_ID=%s", 
	`ck_£ssiÚ_g‘_id
 (
£ssiÚ
));

5745 
exŒa_’v
[2] = 
	`g_¡rdup_´štf
 ("HALD_SESSION_REMOVE_SESSION_UID=%d", 
	`ck_£ssiÚ_g‘_u£r
 (
£ssiÚ
));

5746 
exŒa_’v
[3] = 
	`g_¡rdup_´štf
 ("HALD_SESSION_REMOVE_SESSION_IS_ACTIVE=%s",

5747 
	`ck_£ssiÚ_is_aùive
 (
£ssiÚ
) ? "true" : "false");

5749 
	`£ssiÚ_chªges_push
 (
d
, 
´og¿ms
, 
exŒa_’v
);

5751 
	`g_ä“
 (
exŒa_’v
[1]);

5752 
	`g_ä“
 (
exŒa_’v
[2]);

5753 
	`g_ä“
 (
exŒa_’v
[3]);

5754 
out
:

5756 
	}
}

5759 
	$h®d_dbus_ck_di§µ—»d
 (
CKT¿ck”
 *
Œack”
, *
u£r_d©a
)

5761 
	`HAL_INFO
 (("In hald_dbus_ck_disappeared"));

5762 
	`»cÚfigu»_aş
 ();

5763 
	}
}

5766 
	$h®d_dbus_ck_­³¬ed
 (
CKT¿ck”
 *
Œack”
, *
u£r_d©a
)

5768 
	`HAL_INFO
 (("In hald_dbus_ck_appeared"));

5769 
	`»cÚfigu»_aş
 ();

5770 
	}
}

5774 
gboŞ—n


5775 
	$h®d_dbus_š™_´•robe
 ()

5777 
gboŞ—n
 
»t
;

5778 
DBusE¼Ü
 
dbus_”rÜ
;

5780 
»t
 = 
FALSE
;

5782 
	`dbus_cÚÃùiÚ_£t_chªge_sigpe
 (
TRUE
);

5784 
	`dbus_”rÜ_š™
 (&
dbus_”rÜ
);

5785 
dbus_cÚÃùiÚ
 = 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
dbus_”rÜ
);

5786 ià(
dbus_cÚÃùiÚ
 =ğ
NULL
) {

5787 
	`HAL_ERROR
 (("dbus_bus_g‘(): %s", 
dbus_”rÜ
.
mes§ge
));

5788 
out
;

5791 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
dbus_cÚÃùiÚ
, 
NULL
);

5792 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
 (
dbus_cÚÃùiÚ
, 
FALSE
);

5794 
	`dbus_cÚÃùiÚ_add_f‹r
 (
dbus_cÚÃùiÚ
, 
h®d_dbus_f‹r_funùiÚ
, 
NULL
, NULL);

5797 
	`dbus_bus_add_m©ch
 (
dbus_cÚÃùiÚ
,

5799 ",š‹rçû='"
DBUS_INTERFACE_DBUS
"'"

5800 ",£nd”='"
DBUS_SERVICE_DBUS
"'"

5802 
NULL
);

5804 #ifdeà
HAVE_CONKIT


5805 
	`dbus_bus_add_m©ch
 (
dbus_cÚÃùiÚ
,

5810 
NULL
);

5811 
	`dbus_bus_add_m©ch
 (
dbus_cÚÃùiÚ
,

5816 
NULL
);

5817 
	`dbus_bus_add_m©ch
 (
dbus_cÚÃùiÚ
,

5822 
NULL
);

5823 
	`dbus_bus_add_m©ch
 (
dbus_cÚÃùiÚ
,

5828 
NULL
);

5829 
	`dbus_bus_add_m©ch
 (
dbus_cÚÃùiÚ
,

5834 
NULL
);

5836 
ck_Œack”
 = 
	`ck_Œack”_Ãw
 ();

5837 
	`ck_Œack”_£t_sy¡em_bus_cÚÃùiÚ
 (
ck_Œack”
, 
dbus_cÚÃùiÚ
);

5838 
	`ck_Œack”_£t_£©_added_cb
 (
ck_Œack”
, 
h®d_dbus_£©_added
);

5839 
	`ck_Œack”_£t_£©_»moved_cb
 (
ck_Œack”
, 
h®d_dbus_£©_»moved
);

5840 
	`ck_Œack”_£t_£ssiÚ_added_cb
 (
ck_Œack”
, 
h®d_dbus_£ssiÚ_added
);

5841 
	`ck_Œack”_£t_£ssiÚ_»moved_cb
 (
ck_Œack”
, 
h®d_dbus_£ssiÚ_»moved
);

5842 
	`ck_Œack”_£t_£ssiÚ_aùive_chªged_cb
 (
ck_Œack”
, 
h®d_dbus_£ssiÚ_aùive_chªged
);

5843 
	`ck_Œack”_£t_£rviû_di§µ—»d_cb
 (
ck_Œack”
, 
h®d_dbus_ck_di§µ—»d
);

5844 
	`ck_Œack”_£t_£rviû_­³¬ed_cb
 (
ck_Œack”
, 
h®d_dbus_ck_­³¬ed
);

5845 ià(!
	`ck_Œack”_š™
 (
ck_Œack”
)) {

5846 
	`HAL_WARNING
 (("Could‚ot initialize seats‡nd sessions from ConsoleKit"));

5851 
ci_Œack”
 = 
	`ci_Œack”_Ãw
 ();

5852 
	`ci_Œack”_£t_sy¡em_bus_cÚÃùiÚ
 (
ci_Œack”
, 
dbus_cÚÃùiÚ
);

5853 
	`ci_Œack”_š™
 (
ci_Œack”
);

5855 
»t
 = 
TRUE
;

5857 
out
:

5858  
»t
;

5859 
	}
}

5861 #ifdeà
HAVE_CONKIT


5862 
CKT¿ck”
 *

5863 
	$h®d_dbus_g‘_ck_Œack”
 ()

5865  
ck_Œack”
;

5866 
	}
}

5869 
gboŞ—n


5870 
	$h®d_dbus_š™
 ()

5872 
DBusE¼Ü
 
dbus_”rÜ
;

5874 
	`HAL_INFO
 (("entering"));

5876 ià(
dbus_cÚÃùiÚ
 =ğ
NULL
) {

5877 
	`HAL_ERROR
(("not connectedo system bus"));

5878  
FALSE
;

5881 
	`dbus_”rÜ_š™
 (&
dbus_”rÜ
);

5882 
	`dbus_bus_»que¡_Çme
 (
dbus_cÚÃùiÚ
, "Üg.ä“desktİ.H®", 0, &
dbus_”rÜ
);

5883 ià(
	`dbus_”rÜ_is_£t
 (&
dbus_”rÜ
)) {

5884 
	`HAL_ERROR
 (("dbus_bus_request_name(): %s",

5885 
dbus_”rÜ
.
mes§ge
));

5886  
FALSE
;

5889  
TRUE
;

5890 
	}
}

	@hald/hald_dbus.h

26 #iâdeà
HAL_DBUS_H


27 
	#HAL_DBUS_H


	)

29 
	~<dbus/dbus.h
>

31 
	~"deviû.h
"

33 
DBusHªdËrResuÉ
 
mªag”_g‘_®l_deviûs
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

34 
DBusMes§ge
 *
mes§ge
);

35 
DBusHªdËrResuÉ
 
mªag”_g‘_®l_deviûs_w™h_´İ”t›s
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

36 
DBusMes§ge
 *
mes§ge
);

37 
DBusHªdËrResuÉ
 
mªag”_fšd_deviû_¡ršg_m©ch
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

38 
DBusMes§ge
 *
mes§ge
);

39 
DBusHªdËrResuÉ
 
mªag”_fšd_deviû_by_ÿ·b™y
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

40 
DBusMes§ge
 *
mes§ge
);

41 
DBusHªdËrResuÉ
 
mªag”_deviû_exi¡s
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

42 
DBusMes§ge
 *
mes§ge
);

43 
DBusHªdËrResuÉ
 
deviû_g‘_®l_´İ”t›s
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

44 
DBusMes§ge
 *
mes§ge
);

45 
DBusHªdËrResuÉ
 
deviû_g‘_´İ”ty
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

46 
DBusMes§ge
 *
mes§ge
);

47 
DBusHªdËrResuÉ
 
deviû_g‘_´İ”ty_ty³
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

48 
DBusMes§ge
 *
mes§ge
);

49 
DBusHªdËrResuÉ
 
deviû_£t_´İ”ty
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

50 
DBusMes§ge
 *
mes§ge
,

51 
dbus_boŞ_t
 
loÿl_š‹rçû
);

52 
DBusHªdËrResuÉ
 
deviû_add_ÿ·b™y
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

53 
DBusMes§ge
 *
mes§ge
,

54 
dbus_boŞ_t
 
loÿl_š‹rçû
);

55 
DBusHªdËrResuÉ
 
deviû_»move_ÿ·b™y
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

56 
DBusMes§ge
 *
mes§ge
,

57 
dbus_boŞ_t
 
loÿl_š‹rçû
);

58 
DBusHªdËrResuÉ
 
deviû_»move_´İ”ty
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

59 
DBusMes§ge
 *
mes§ge
,

60 
dbus_boŞ_t
 
loÿl_š‹rçû
);

61 
DBusHªdËrResuÉ
 
deviû_´İ”ty_exi¡s
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

62 
DBusMes§ge
 *
mes§ge
);

63 
DBusHªdËrResuÉ
 
deviû_qu”y_ÿ·b™y
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

64 
DBusMes§ge
 *
mes§ge
);

65 
DBusHªdËrResuÉ
 
deviû_lock
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

66 
DBusMes§ge
 *
mes§ge
);

67 
DBusHªdËrResuÉ
 
deviû_uÆock
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

68 
DBusMes§ge
 *
mes§ge
);

69 
DBusHªdËrResuÉ
 
mªag”_Ãw_deviû
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

70 
DBusMes§ge
 *
mes§ge
,

71 
dbus_boŞ_t
 
loÿl_š‹rçû
);

72 
DBusHªdËrResuÉ
 
mªag”_comm™_to_gdl
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

73 
DBusMes§ge
 *
mes§ge
,

74 
dbus_boŞ_t
 
loÿl_š‹rçû
);

75 
DBusHªdËrResuÉ
 
mªag”_»move
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

76 
DBusMes§ge
 *
mes§ge
,

77 
dbus_boŞ_t
 
loÿl_š‹rçû
);

78 
DBusHªdËrResuÉ
 
m”ge_´İ”t›s
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

79 
DBusMes§ge
 *
mes§ge
);

80 
DBusHªdËrResuÉ
 
deviû_m©ches
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

81 
DBusMes§ge
 *
mes§ge
);

83 
mªag”_£nd_sigÇl_deviû_added
 (
H®Deviû
 *
deviû
);

84 
mªag”_£nd_sigÇl_deviû_»moved
 (
H®Deviû
 *
deviû
);

85 
mªag”_£nd_sigÇl_Ãw_ÿ·b™y
 (
H®Deviû
 *
deviû
,

86 cÚ¡ *
ÿ·b™y
);

88 
mªag”_£nd_sigÇl_š‹rçû_lock_acquœed
 (cÚ¡ *
š‹rçû_Çme
, cÚ¡ *
£nd”
);

89 
mªag”_£nd_sigÇl_š‹rçû_lock_»Ëa£d
 (cÚ¡ *
š‹rçû_Çme
, cÚ¡ *
£nd”
);

91 
deviû_£nd_sigÇl_š‹rçû_lock_acquœed
 (
H®Deviû
 *
deviû
, cÚ¡ *
š‹rçû_Çme
, cÚ¡ *
£nd”
);

92 
deviû_£nd_sigÇl_š‹rçû_lock_»Ëa£d
 (
H®Deviû
 *
deviû
, cÚ¡ *
š‹rçû_Çme
, cÚ¡ *
£nd”
);

94 
deviû_£nd_sigÇl_´İ”ty_modif›d
 (
H®Deviû
 *
deviû
,

95 cÚ¡ *
key
,

96 
dbus_boŞ_t
 
added
,

97 
dbus_boŞ_t
 
»moved
);

98 
deviû_£nd_sigÇl_cÚd™iÚ
 (
H®Deviû
 *
deviû
,

99 cÚ¡ *
cÚd™iÚ_Çme
,

100 cÚ¡ *
cÚd™iÚ_d‘as
);

102 
deviû_´İ”ty_©omic_upd©e_begš
 ();

103 
deviû_´İ”ty_©omic_upd©e_’d
 ();

105 
»cÚfigu»_®l_pŞicy
 ();

107 
gboŞ—n
 
h®d_dbus_š™_´•robe
 ();

109 
gboŞ—n
 
h®d_dbus_š™
 ();

111 
gboŞ—n
 
h®d_dbus_loÿl_£rv”_š™
 ();

112 
h®d_dbus_loÿl_£rv”_shutdown
 ();

114 
DBusHªdËrResuÉ
 
h®d_dbus_f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, *
u£r_d©a
);

116 *
h®d_dbus_loÿl_£rv”_addr
 ();

118 
gboŞ—n
 
deviû_is_executšg_m‘hod
 (
H®Deviû
 *
d
, cÚ¡ *
š‹rçû_Çme
, cÚ¡ *
m‘hod_Çme
);

121 
gboŞ—n
 
h®d_sšgËtÚ_deviû_added
 (cÚ¡ * 
commªdlše
, 
H®Deviû
 *
deviû
);

122 
gboŞ—n
 
h®d_sšgËtÚ_deviû_»moved
 (cÚ¡ * 
commªdlše
, 
H®Deviû
 *
deviû
);

123 #ifdeà
HAVE_CONKIT


124 
	~"ck-Œack”.h
"

126 
CKT¿ck”
 *
h®d_dbus_g‘_ck_Œack”
 ();

	@hald/hald_runner.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<sys/ut¢ame.h
>

32 
	~<¡dio.h
>

34 
	~<glib.h
>

35 
	~<dbus/dbus.h
>

36 
	~<dbus/dbus-glib-lowËv–.h
>

37 
	~<¡ršg.h
>

39 
	~<sys/ty³s.h
>

40 
	~<sigÇl.h
>

42 
	~"h®d.h
"

43 
	~"ut.h
"

44 
	~"logg”.h
"

45 
	~"h®d_dbus.h
"

46 
	~"h®d_ruÂ”.h
"

48 #ifdeà
HAVE_CONKIT


49 
	~"ck-Œack”.h
"

53 
H®Deviû
 *
	md
;

54 
H®RunT”mš©edCB
 
	mcb
;

55 
gpoš‹r
 
	md©a1
;

56 
gpoš‹r
 
	md©a2
;

57 } 
	tH–³rD©a
;

59 
	#DBUS_SERVER_ADDRESS
 "unix:tmpdœ=" 
HALD_SOCKET_DIR


	)

61 
DBusCÚÃùiÚ
 *
	gruÂ”_cÚÃùiÚ
 = 
NULL
;

62 
H®dRuÂ”RunNÙify
 
	gm‘hod_run_nÙify
 = 
NULL
;

63 
gpoš‹r
 
	gm‘hod_run_nÙify_u£rd©a
 = 
NULL
;

66 
GPid
 
	mpid
;

67 
H®Deviû
 *
	mdeviû
;

68 
H®RunT”mš©edCB
 
	mcb
;

69 
gboŞ—n
 
	mis_sšgËtÚ
;

70 
gpoš‹r
 
	md©a1
;

71 
gpoš‹r
 
	md©a2
;

72 } 
	tRuÂšgProûss
;

75 
GSLi¡
 *
	gruÂšg_´oûs£s
 = 
NULL
;

78 
	$ruÂšg_´oûs£s_»move_deviû
 (
H®Deviû
 * 
deviû
)

80 
GSLi¡
 *
i
;

81 
GSLi¡
 *
j
;

83 
i
 = 
ruÂšg_´oûs£s
; i !ğ
NULL
; i = 
j
) {

84 
RuÂšgProûss
 *
½
;

86 
j
 = 
	`g_¦i¡_Ãxt
 (
i
);

87 
½
 = 
i
->
d©a
;

89 ià(
½
->
deviû
 == device) {

90 
	`g_ä“
 (
½
);

91 
ruÂšg_´oûs£s
 =

92 
	`g_¦i¡_d–‘e_lšk
 (
ruÂšg_´oûs£s
, 
i
);

96 
	}
}

99 
	$ruÂ”_deviû_fš®ized
 (
H®Deviû
 * 
deviû
)

101 
	`ruÂšg_´oûs£s_»move_deviû
 (
deviû
);

102 
	}
}

105 
DBusHªdËrResuÉ


106 
	$ruÂ”_£rv”_mes§ge_hªdËr
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

107 
DBusMes§ge
 * 
mes§ge
, *
u£r_d©a
)

110 
	`HAL_INFO
 (("ruÂ”_£rv”_mes§ge_hªdËr: de¡š©iÚ=% obj_·th=% š‹rçû=% m‘hod=%s", 
	`dbus_mes§ge_g‘_de¡š©iÚ
 (
mes§ge
), 
	`dbus_mes§ge_g‘_·th
 (mes§ge), 
	`dbus_mes§ge_g‘_š‹rçû
 (mes§ge), 
	`dbus_mes§ge_g‘_memb”
 (message)));

111 ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
,

114 
dbus_ušt64_t
 
dpid
;

115 
DBusE¼Ü
 
”rÜ
;

116 
	`dbus_”rÜ_š™
 (&
”rÜ
);

117 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

118 
DBUS_TYPE_INT64
, &
dpid
,

119 
DBUS_TYPE_INVALID
)) {

120 
GSLi¡
 *
i
;

121 
GPid
 
pid
;

123 
pid
 = (
GPid
è
dpid
;

125 
	`HAL_INFO
 (("P»viou¦y s¹ed…roûs w™h…id %dƒx™ed", 
pid
));

127 
i
 = 
ruÂšg_´oûs£s
; i !ğ
NULL
;

128 
i
 = 
	`g_¦i¡_Ãxt
 (i)) {

129 
RuÂšgProûss
 *
½
;

131 
½
 = 
i
->
d©a
;

133 ià(
½
->
pid
 ==…id) {

134 
½
->
	`cb
 (½->
deviû
, 0, 0, 
NULL
,

135 
½
->
d©a1
,„p->
d©a2
);

136 
	`g_ä“
 (
½
);

137 
ruÂšg_´oûs£s
 =

138 
g_¦i¡_d–‘e_lšk


139 (
ruÂšg_´oûs£s
, 
i
);

144 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
,

145 
DBUS_INTERFACE_LOCAL
,

147 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

148 
DBUS_PATH_LOCAL
) == 0) {

149 
	`HAL_INFO
 (("runner…rocess disconnected"));

150 
	`dbus_cÚÃùiÚ_uÄef
 (
cÚÃùiÚ
);

153  
DBUS_HANDLER_RESULT_HANDLED
;

154 
	}
}

157 
	$ruÂ”_£rv”_uÄegi¡”_hªdËr
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

158 *
u£r_d©a
)

160 
	`HAL_INFO
 (("========================================"));

161 
	`HAL_INFO
 (("runner_server_unregister_handler"));

162 
	`HAL_INFO
 (("========================================"));

163 
	}
}

167 
	$hªdË_cÚÃùiÚ
 (
DBusS”v”
 * 
£rv”
,

168 
DBusCÚÃùiÚ
 * 
Ãw_cÚÃùiÚ
, *
d©a
)

171 ià(
ruÂ”_cÚÃùiÚ
 =ğ
NULL
) {

172 
DBusObjeùP©hVTabË
 
vbË
 =

173 { &
ruÂ”_£rv”_uÄegi¡”_hªdËr
,

174 &
ruÂ”_£rv”_mes§ge_hªdËr
,

175 
NULL
, NULL, NULL, NULL

178 
ruÂ”_cÚÃùiÚ
 = 
Ãw_cÚÃùiÚ
;

179 
	`dbus_cÚÃùiÚ_»f
 (
Ãw_cÚÃùiÚ
);

180 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
Ãw_cÚÃùiÚ
, 
NULL
);

182 
	`HAL_INFO
 (("ruÂ” cÚÃùiÚ i %p", 
Ãw_cÚÃùiÚ
));

184 
	`dbus_cÚÃùiÚ_»gi¡”_çÎback
 (
Ãw_cÚÃùiÚ
,

186 &
vbË
, 
NULL
);

191 
	}
}

193 
GPid
 
	gruÂ”_pid
;

194 
DBusS”v”
 *
	gruÂ”_£rv”
 = 
NULL
;

195 
gušt
 
	gruÂ”_w©ch
;

199 
	$ruÂ”_d›d
 (
GPid
 
pid
, 
gšt
 
¡©us
, 
gpoš‹r
 
d©a
)

201 
	`g_¥awn_şo£_pid
 (
pid
);

202 
	`DIE
 (("Runner died"));

203 
	}
}

206 
	$h®d_ruÂ”_¡İ_ruÂ”
 ()

208 ià(
ruÂ”_£rv”
 !ğ
NULL
) {

209 
DBusMes§ge
 *
msg
;

213 
	`HAL_INFO
 (("running_processes %p,‚um = %d",

214 
ruÂšg_´oûs£s
,

215 
	`g_¦i¡_Ëngth
 (
ruÂšg_´oûs£s
)));

217 
	`g_¦i¡_fÜ—ch
 (
ruÂšg_´oûs£s
, (
GFunc
è
g_ä“
, 
NULL
);

218 
	`g_¦i¡_ä“
 (
ruÂšg_´oûs£s
);

219 
ruÂšg_´oûs£s
 = 
NULL
;

221 
	`HAL_INFO
 (("Klšg„uÂ” w™h…id %d", 
ruÂ”_pid
));

223 
	`g_sourû_»move
 (
ruÂ”_w©ch
);

224 
	`g_¥awn_şo£_pid
 (
ruÂ”_pid
);

226 
msg
 =

227 
dbus_mes§ge_Ãw_m‘hod_ÿÎ


231 ià(
msg
 =ğ
NULL
)

232 
	`DIE
 (("No memory"));

233 
	`dbus_cÚÃùiÚ_£nd
 (
ruÂ”_cÚÃùiÚ
, 
msg
, 
NULL
);

234 
	`dbus_mes§ge_uÄef
 (
msg
);

236 
	`dbus_£rv”_discÚÃù
 (
ruÂ”_£rv”
);

237 
	`dbus_£rv”_uÄef
 (
ruÂ”_£rv”
);

238 
ruÂ”_£rv”
 = 
NULL
;

241 
	}
}

243 
gboŞ—n


244 
	$h®d_ruÂ”_¡¬t_ruÂ”
 ()

246 
DBusE¼Ü
 
”r
;

247 
GE¼Ü
 *
”rÜ
 = 
NULL
;

248 *
¬gv
[] = { 
NULL
, NULL };

249 *
’v
[] = { 
NULL
, NULL, NULL, NULL };

250 cÚ¡ *
h®d_ruÂ”_·th
;

251 *
£rv”_add»ss
;

253 
ruÂšg_´oûs£s
 = 
NULL
;

255 
	`dbus_”rÜ_š™
 (&
”r
);

256 
ruÂ”_£rv”
 = 
	`dbus_£rv”_li¡’
 (
DBUS_SERVER_ADDRESS
, &
”r
);

257 ià(
ruÂ”_£rv”
 =ğ
NULL
) {

258 
	`HAL_ERROR
 (("Cannot create D-BUS server forhe„unner"));

259 
”rÜ
;

262 
	`dbus_£rv”_£tup_w™h_g_maš
 (
ruÂ”_£rv”
, 
NULL
);

263 
	`dbus_£rv”_£t_Ãw_cÚÃùiÚ_funùiÚ
 (
ruÂ”_£rv”
,

264 
hªdË_cÚÃùiÚ
, 
NULL
,

265 
NULL
);

268 
¬gv
[0] = "hald-runner";

269 
£rv”_add»ss
 = 
	`dbus_£rv”_g‘_add»ss
 (
ruÂ”_£rv”
);

270 
’v
[0] = 
	`g_¡rdup_´štf
 ("HALD_RUNNER_DBUS_ADDRESS=%s",

271 
£rv”_add»ss
);

272 
	`dbus_ä“
 (
£rv”_add»ss
);

273 
h®d_ruÂ”_·th
 = 
	`g_g‘’v
 ("HALD_RUNNER_PATH");

274 ià(
h®d_ruÂ”_·th
 !ğ
NULL
) {

275 
’v
[1] =

276 
	`g_¡rdup_´štf
 ("PATH=%s:" 
PACKAGE_LIBEXEC_DIR
 ":"

277 
PACKAGE_SCRIPT_DIR
 ":"

278 
PACKAGE_BIN_DIR
, 
h®d_ruÂ”_·th
);

280 
’v
[1] =

281 
	`g_¡rdup_´štf
 ("PATH=" 
PACKAGE_LIBEXEC_DIR
 ":"

282 
PACKAGE_SCRIPT_DIR
 ":"

283 
PACKAGE_BIN_DIR
);

289 ià(!
g_¥awn_async


290 (
NULL
, 
¬gv
, 
’v
,

291 
G_SPAWN_DO_NOT_REAP_CHILD
 | 
G_SPAWN_SEARCH_PATH
, 
NULL
, NULL,

292 &
ruÂ”_pid
, &
”rÜ
)) {

293 
	`HAL_ERROR
 (("Could‚ot spawn„unner : '%s'",

294 
”rÜ
->
mes§ge
));

295 
	`g_”rÜ_ä“
 (
”rÜ
);

296 
”rÜ
;

298 
	`g_ä“
 (
’v
[0]);

299 
	`g_ä“
 (
’v
[1]);

301 
	`HAL_INFO
 (("RuÂ” ha pid %d", 
ruÂ”_pid
));

303 
ruÂ”_w©ch
 = 
	`g_chd_w©ch_add
 (
ruÂ”_pid
, 
ruÂ”_d›d
, 
NULL
);

304 
ruÂ”_cÚÃùiÚ
 =ğ
NULL
) {

306 
	`g_maš_cÚ‹xt_™”©iÚ
 (
NULL
, 
TRUE
);

308  
TRUE
;

310 
”rÜ
:

311 ià(
ruÂ”_£rv”
 !ğ
NULL
)

312 
	`dbus_£rv”_uÄef
 (
ruÂ”_£rv”
);

313  
FALSE
;

314 
	}
}

317 
	$add_´İ”ty_to_msg
 (
H®Deviû
 * 
deviû
,

318 cÚ¡ *
key
, 
gpoš‹r
 
u£r_d©a
)

320 *
´İ_uµ”
, *
v®ue
;

321 *
c
;

322 
gch¬
 *
’v
;

323 
DBusMes§geI‹r
 *
™”
 = (DBusMes§geI‹¸*è
u£r_d©a
;

325 
´İ_uµ”
 = 
	`g_ascii_¡rup
 (
key
, -1);

329 
c
 = 
´İ_uµ”
; *c; c++) {

330 ià(*
c
 == '.')

331 *
c
 = '_';

334 
v®ue
 = 
	`h®_deviû_´İ”ty_to_¡ršg
 (
deviû
, 
key
);

335 
’v
 = 
	`g_¡rdup_´štf
 ("HAL_PROP_%s=%s", 
´İ_uµ”
, 
v®ue
);

336 
	`dbus_mes§ge_™”_­³nd_basic
 (
™”
, 
DBUS_TYPE_STRING
, &
’v
);

338 
	`g_ä“
 (
’v
);

339 
	`g_ä“
 (
v®ue
);

340 
	`g_ä“
 (
´İ_uµ”
);

341 
	}
}

344 
	$add_’v
 (
DBusMes§geI‹r
 * 
™”
, cÚ¡ 
gch¬
 * 
key
, cÚ¡ gch¬ * 
v®ue
)

346 ià(
v®ue
 !ğ
NULL
) {

347 
gch¬
 *
’v
;

348 
’v
 = 
	`g_¡rdup_´štf
 ("%s=%s", 
key
, 
v®ue
);

349 
	`dbus_mes§ge_™”_­³nd_basic
 (
™”
, 
DBUS_TYPE_STRING
, &
’v
);

350 
	`g_ä“
 (
’v
);

352 
	}
}

355 
	$add_basic_’v
 (
DBusMes§geI‹r
 * 
™”
, cÚ¡ 
gch¬
 * 
udi
)

357 
ut¢ame
 
un
;

358 #ifdeà
HAVE_CONKIT


359 
CKT¿ck”
 *
ck_Œack”
;

362 ià(
h®d_is_v”bo£
) {

363 
	`add_’v
 (
™”
, "HALD_VERBOSE", "1");

365 ià(
h®d_is_š™Ÿlisšg
) {

366 
	`add_’v
 (
™”
, "HALD_STARTUP", "1");

368 ià(
h®d_u£_sy¦og
) {

369 
	`add_’v
 (
™”
, "HALD_USE_SYSLOG", "1");

371 ià(
udi
)

372 
	`add_’v
 (
™”
, "UDI", 
udi
);

373 
	`add_’v
 (
™”
, "HALD_DIRECT_ADDR", 
	`h®d_dbus_loÿl_£rv”_addr
 ());

377 
	`add_’v
 (
™”
, "LD_LIBRARY_PATH", 
	`g‘’v
 ("LD_LIBRARY_PATH"));

378 #ifdeà
HAVE_POLKIT


379 
	`add_’v
 (
™”
, "HAVE_POLKIT", "1");

380 
	`add_’v
 (
™”
, "POLKIT_POLICY_DIR", 
	`g‘’v
 ("POLKIT_POLICY_DIR"));

381 
	`add_’v
 (
™”
, "POLKIT_DEBUG", 
	`g‘’v
 ("POLKIT_DEBUG"));

385 #ifdeà
HAVE_CONKIT


386 
ck_Œack”
 = 
	`h®d_dbus_g‘_ck_Œack”
 ();

387 ià(
ck_Œack”
 !ğ
NULL
) {

388 
GSLi¡
 *
i
;

389 
GSLi¡
 *
£©s
;

390 
GSŒšg
 *
£©s_¡ršg
;

391 *
s
;

392 *
p
;

393 
num_£©s
;

394 
num_£ssiÚs_tÙ®
;

396 
£©s_¡ršg
 = 
	`g_¡ršg_Ãw
 ("");

398 
£©s
 = 
	`ck_Œack”_g‘_£©s
 (
ck_Œack”
);

399 
num_£©s
 = 
	`g_¦i¡_Ëngth
 (
£©s
);

400 
num_£ssiÚs_tÙ®
 = 0;

401 
i
 = 
£©s
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

402 
GSLi¡
 *
j
;

403 
CKS—t
 *
£©
;

404 
GSLi¡
 *
£ssiÚs
;

405 cÚ¡ *
£©_id
;

406 
GSŒšg
 *
£ssiÚs_¡ršg
;

407 
num_£ssiÚs
;

409 
£ssiÚs_¡ršg
 = 
	`g_¡ršg_Ãw
 ("");

411 
£©
 = 
i
->
d©a
;

414 
£©_id
 = 
	`ck_£©_g‘_id
 (
£©
);

417 ià(
£©s_¡ršg
->
Ën
 > 0) {

418 
	`g_¡ršg_­³nd_c
 (
£©s_¡ršg
, '\t');

420 
	`g_¡ršg_­³nd
 (
£©s_¡ršg
, 
£©_id
);

422 
£ssiÚs
 = 
	`ck_£©_g‘_£ssiÚs
 (
£©
);

423 
num_£ssiÚs
 = 
	`g_¦i¡_Ëngth
 (
£ssiÚs
);

424 
num_£ssiÚs_tÙ®
 +ğ
num_£ssiÚs
;

425 
j
 = 
£ssiÚs
; j !ğ
NULL
; j = 
	`g_¦i¡_Ãxt
 (j)) {

426 
CKSessiÚ
 *
£ssiÚ
;

427 cÚ¡ *
£ssiÚ_id
;

428 cÚ¡ *
q
;

430 
£ssiÚ
 = 
j
->
d©a
;

432 
£ssiÚ_id
 = 
	`ck_£ssiÚ_g‘_id
 (
£ssiÚ
);

434 ià(
£ssiÚs_¡ršg
->
Ën
 > 0) {

435 
	`g_¡ršg_­³nd_c
 (
£ssiÚs_¡ršg
, '\t');

437 
	`g_¡ršg_­³nd
 (
£ssiÚs_¡ršg
, 
£ssiÚ_id
);

447 
s
 = 
	`g_¡rdup_´štf
 ("CK_SESSION_SEAT_%s", 
£ssiÚ_id
);

448 
	`add_’v
 (
™”
, 
s
, 
£©_id
);

449 
	`g_ä“
 (
s
);

450 
s
 = 
	`g_¡rdup_´štf
 ("CK_SESSION_IS_ACTIVE_%s", 
£ssiÚ_id
);

451 
	`add_’v
 (
™”
, 
s
, 
	`ck_£ssiÚ_is_aùive
 (
£ssiÚ
) ? "true" : "false");

452 
	`g_ä“
 (
s
);

453 
s
 = 
	`g_¡rdup_´štf
 ("CK_SESSION_UID_%s", 
£ssiÚ_id
);

454 
p
 = 
	`g_¡rdup_´štf
 ("%u", 
	`ck_£ssiÚ_g‘_u£r
 (
£ssiÚ
));

455 
	`add_’v
 (
™”
, 
s
, 
p
);

456 
	`g_ä“
 (
s
);

457 
	`g_ä“
 (
p
);

458 
s
 = 
	`g_¡rdup_´štf
 ("CK_SESSION_IS_LOCAL_%s", 
£ssiÚ_id
);

459 
	`add_’v
 (
™”
, 
s
, 
	`ck_£ssiÚ_is_loÿl
 (
£ssiÚ
) ? "true" : "false");

460 
	`g_ä“
 (
s
);

461 
q
 = 
	`ck_£ssiÚ_g‘_ho¡Çme
 (
£ssiÚ
);

462 ià(
q
 !ğ
NULL
 && 
	`¡¾’
 (q) > 0) {

463 
s
 = 
	`g_¡rdup_´štf
 ("CK_SESSION_HOSTNAME_%s", 
£ssiÚ_id
);

464 
	`add_’v
 (
™”
, 
s
, 
q
);

465 
	`g_ä“
 (
s
);

474 
s
 = 
	`g_¡rdup_´štf
 ("CK_SEAT_%s", 
£©_id
);

475 
	`add_’v
 (
™”
, 
s
, 
£ssiÚs_¡ršg
->
¡r
);

476 
	`g_¡ršg_ä“
 (
£ssiÚs_¡ršg
, 
TRUE
);

477 
	`g_ä“
 (
s
);

479 
s
 = 
	`g_¡rdup_´štf
 ("CK_SEAT_NUM_SESSIONS_%s", 
£©_id
);

480 
p
 = 
	`g_¡rdup_´štf
 ("%d", 
num_£ssiÚs
);

481 
	`add_’v
 (
™”
, 
s
, 
p
);

482 
	`g_ä“
 (
p
);

483 
	`g_ä“
 (
s
);

491 
	`add_’v
 (
™”
, "CK_SEATS", 
£©s_¡ršg
->
¡r
);

492 
	`g_¡ršg_ä“
 (
£©s_¡ršg
, 
TRUE
);

498 
p
 = 
	`g_¡rdup_´štf
 ("%d", 
num_£ssiÚs_tÙ®
);

499 
	`add_’v
 (
™”
, "CK_NUM_SESSIONS", 
p
);

500 
	`g_ä“
 (
p
);

506 
p
 = 
	`g_¡rdup_´štf
 ("%d", 
num_£©s
);

507 
	`add_’v
 (
™”
, "CK_NUM_SEATS", 
p
);

508 
	`g_ä“
 (
p
);

513 ià(
	`uÇme
 (&
un
) >= 0) {

514 *
sy¢ame
;

516 
sy¢ame
 = 
	`g_ascii_¡rdown
 (
un
.sysname, -1);

517 
	`add_’v
 (
™”
, "HALD_UNAME_S", 
sy¢ame
);

518 
	`g_ä“
 (
sy¢ame
);

520 
	}
}

523 
	$add_exŒa_’v
 (
DBusMes§geI‹r
 * 
™”
, 
gch¬
 ** 
’v
)

525 
i
;

526 ià(
’v
 !ğ
NULL
)

527 
i
 = 0; 
’v
[i] !ğ
NULL
; i++) {

528 
	`dbus_mes§ge_™”_­³nd_basic
 (
™”
,

529 
DBUS_TYPE_STRING
,

530 &
’v
[
i
]);

532 
	}
}

534 
gboŞ—n


535 
	$add_commªd
 (
DBusMes§geI‹r
 * 
™”
, cÚ¡ 
gch¬
 * 
commªd_lše
)

537 
gšt
 
¬gc
;

538 
gšt
 
x
;

539 **
¬gv
;

540 
GE¼Ü
 *
”r
 = 
NULL
;

541 
DBusMes§geI‹r
 
¬¿y_™”
;

543 ià(!
	`g_sh–l_·r£_¬gv
 (
commªd_lše
, &
¬gc
, &
¬gv
, &
”r
)) {

544 
	`HAL_ERROR
 (("Error…arsing commandline '%s': %s",

545 
commªd_lše
, 
”r
->
mes§ge
));

546 
	`g_”rÜ_ä“
 (
”r
);

547  
FALSE
;

549 ià(!
	`dbus_mes§ge_™”_İ’_cÚš”
 (
™”
,

550 
DBUS_TYPE_ARRAY
,

551 
DBUS_TYPE_STRING_AS_STRING
,

552 &
¬¿y_™”
))

553 
	`DIE
 (("No memory"));

554 
x
 = 0; 
¬gv
[x] !ğ
NULL
; x++) {

555 
	`dbus_mes§ge_™”_­³nd_basic
 (&
¬¿y_™”
,

556 
DBUS_TYPE_STRING
,

557 &
¬gv
[
x
]);

559 
	`dbus_mes§ge_™”_şo£_cÚš”
 (
™”
, &
¬¿y_™”
);

561 
	`g_¡rä“v
 (
¬gv
);

562  
TRUE
;

563 
	}
}

566 
	$add_udi
 (
DBusMes§geI‹r
 * 
™”
, 
H®Deviû
 * 
deviû
)

568 cÚ¡ *
udi
;

570 ià(
deviû
 !ğ
NULL
)

571 
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

573 
udi
 = "";

575 
	`dbus_mes§ge_™”_­³nd_basic
 (
™”
, 
DBUS_TYPE_STRING
, &
udi
);

576 
	}
}

578 
gboŞ—n


579 
	$add_’vœÚm’t
 (
DBusMes§geI‹r
 * 
™”
, 
H®Deviû
 * 
deviû
,

580 cÚ¡ 
gch¬
 * 
commªd_lše
, **
exŒa_’v
)

582 
DBusMes§geI‹r
 
¬¿y_™”
;

583 
	`dbus_mes§ge_™”_İ’_cÚš”
 (
™”
,

584 
DBUS_TYPE_ARRAY
,

585 
DBUS_TYPE_STRING_AS_STRING
,

586 &
¬¿y_™”
);

587 ià(
deviû
 !ğ
NULL
)

588 
	`h®_deviû_´İ”ty_fÜ—ch
 (
deviû
, 
add_´İ”ty_to_msg
,

589 &
¬¿y_™”
);

590 
	`add_basic_’v
 (&
¬¿y_™”
, 
deviû
 ? 
	`h®_deviû_g‘_udi
 (deviû): 
NULL
);

591 
	`add_exŒa_’v
 (&
¬¿y_™”
, 
exŒa_’v
);

592 
	`dbus_mes§ge_™”_şo£_cÚš”
 (
™”
, &
¬¿y_™”
);

594 ià(!
	`add_commªd
 (
™”
, 
commªd_lše
)) {

595  
FALSE
;

597  
TRUE
;

598 
	}
}

601 
gboŞ—n


602 
	$ruÂ”_¡¬t
 (
H®Deviû
 * 
deviû
, cÚ¡ 
gch¬
 * 
commªd_lše
,

603 **
exŒa_’v
, 
gboŞ—n
 
sšgËtÚ
,

604 
H®RunT”mš©edCB
 
cb
, 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

606 
DBusMes§ge
 *
msg
, *
»¶y
;

607 
DBusE¼Ü
 
”rÜ
;

608 
DBusMes§geI‹r
 
™”
;

610 
	`dbus_”rÜ_š™
 (&
”rÜ
);

611 
msg
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.HalRunner",

614 
sšgËtÚ
 ? "StartSingleton" : "Start");

615 ià(
msg
 =ğ
NULL
)

616 
	`DIE
 (("No memory"));

617 
	`dbus_mes§ge_™”_š™_­³nd
 (
msg
, &
™”
);

619 ià(!
sšgËtÚ
)

620 
	`add_udi
 (&
™”
, 
deviû
);

622 ià(!
	`add_’vœÚm’t
 (&
™”
, 
deviû
, 
commªd_lše
, 
exŒa_’v
)) {

623 
	`HAL_ERROR
 (("Error‡ddingƒnvironment, device =%p, singleton=%d",

624 
deviû
, 
sšgËtÚ
));

625 
”rÜ
;

629 
»¶y
 =

630 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ruÂ”_cÚÃùiÚ
,

631 
msg
, -1, &
”rÜ
);

632 ià(
»¶y
) {

633 
gboŞ—n
 
»t
 =

634 (
	`dbus_mes§ge_g‘_ty³
 (
»¶y
) ==

635 
DBUS_MESSAGE_TYPE_METHOD_RETURN
);

637 ià(
»t
) {

638 
dbus_št64_t
 
pid_äom_ruÂ”
;

639 ià(
	`dbus_mes§ge_g‘_¬gs
 (
»¶y
, &
”rÜ
,

640 
DBUS_TYPE_INT64
,

641 &
pid_äom_ruÂ”
,

642 
DBUS_TYPE_INVALID
)) {

643 ià(
cb
 !ğ
NULL
) {

644 
RuÂšgProûss
 *
½
;

645 
½
 = 
	`g_Ãw0
 (
RuÂšgProûss
, 1);

646 
½
->
pid
 = (
GPid
è
pid_äom_ruÂ”
;

647 
½
->
cb
 = cb;

648 
½
->
is_sšgËtÚ
 = 
sšgËtÚ
;

649 ià(
sšgËtÚ
)

650 
½
->
deviû
 = 
NULL
;

652 
½
->
deviû
 = device;

653 
½
->
d©a1
 = data1;

654 
½
->
d©a2
 = data2;

656 
ruÂšg_´oûs£s
 =

657 
g_¦i¡_´•’d


658 (
ruÂšg_´oûs£s
, 
½
);

659 
	`HAL_INFO
 (("ruÂšg_´oûs£ %p,‚um = %d", 
ruÂšg_´oûs£s
, 
	`g_¦i¡_Ëngth
 (running_processes)));

662 
	`HAL_ERROR
 (("Errorƒxtracting out_pid from„unner's Start()"));

666 
	`dbus_mes§ge_uÄef
 (
»¶y
);

667 
	`dbus_mes§ge_uÄef
 (
msg
);

668  
»t
;

670 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

671 
	`HAL_ERROR
 (("E¼Ü„uÂšg '%s': %s: %s", 
commªd_lše
, 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

675 
”rÜ
:

676 
	`dbus_mes§ge_uÄef
 (
msg
);

677  
FALSE
;

678 
	}
}

680 
gboŞ—n


681 
	$h®d_ruÂ”_¡¬t
 (
H®Deviû
 * 
deviû
, cÚ¡ 
gch¬
 * 
commªd_lše
,

682 **
exŒa_’v
, 
H®RunT”mš©edCB
 
cb
,

683 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

685  
	`ruÂ”_¡¬t
 (
deviû
, 
commªd_lše
, 
exŒa_’v
, 
FALSE
, 
cb
, 
d©a1
, 
d©a2
);

686 
	}
}

688 
gboŞ—n


689 
	$h®d_ruÂ”_¡¬t_sšgËtÚ
 (cÚ¡ 
gch¬
 * 
commªd_lše
,

690 **
exŒa_’v
, 
H®RunT”mš©edCB
 
cb
,

691 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

693  
	`ruÂ”_¡¬t
 (
NULL
, 
commªd_lše
, 
exŒa_’v
, 
TRUE
, 
cb
, 
d©a1
, 
d©a2
);

694 
	}
}

698 
	$´oûss_»¶y
 (
DBusMes§ge
 *
m
, 
H–³rD©a
 *
hb
)

700 
dbus_ušt32_t
 
ex™t
 = 
HALD_RUN_SUCCESS
;

701 
dbus_št32_t
 
»tuº_code
 = 0;

702 
GA¼ay
 *
”rÜ
 = 
NULL
;

703 
DBusMes§geI‹r
 
™”
;

705 
”rÜ
 = 
	`g_¬¿y_Ãw
 (
TRUE
, 
FALSE
,  (*));

707 ià(
	`dbus_mes§ge_g‘_ty³
 (
m
è!ğ
DBUS_MESSAGE_TYPE_METHOD_RETURN
)

708 
m®fÜmed
;

710 ià(!
	`dbus_mes§ge_™”_š™
 (
m
, &
™”
) ||

711 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”
è!ğ
DBUS_TYPE_UINT32
)

712 
m®fÜmed
;

713 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
ex™t
);

715 ià(!
	`dbus_mes§ge_™”_Ãxt
 (&
™”
) ||

716 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”
è!ğ
DBUS_TYPE_INT32
)

717 
m®fÜmed
;

718 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
»tuº_code
);

720 
	`dbus_mes§ge_™”_Ãxt
 (&
™”
) &&

721 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”
) ==

722 
DBUS_TYPE_STRING
) {

723 cÚ¡ *
v®ue
;

724 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
v®ue
);

725 
	`g_¬¿y_­³nd_v®s
 (
”rÜ
, &
v®ue
, 1);

728 ià(
hb
->
cb
 !ğ
NULL
) {

729 
hb
->
	`cb
 (hb->
d
, 
ex™t
, 
»tuº_code
,

730 (
gch¬
 **è
”rÜ
->
d©a
, 
hb
->
d©a1
, hb->
d©a2
);

733 ià(
hb
->
d
 !ğ
NULL
)

734 
	`g_objeù_uÄef
 (
hb
->
d
);

736 
	`dbus_mes§ge_uÄef
 (
m
);

737 
	`g_¬¿y_ä“
 (
”rÜ
, 
TRUE
);

739 
	`g_ä“
 (
hb
);

741 
out
;

743 
m®fÜmed
:

745 
	`HAL_ERROR
 (("Malformed or unexpected„eply message"));

746 ià(
hb
->
cb
 !ğ
NULL
) {

747 
hb
->
	`cb
 (hb->
d
, 
HALD_RUN_FAILED
, 
»tuº_code
, 
NULL
, hb->
d©a1
,

748 
hb
->
d©a2
);

751 ià(
hb
->
d
 !ğ
NULL
)

752 
	`g_objeù_uÄef
 (
hb
->
d
);

754 
	`dbus_mes§ge_uÄef
 (
m
);

755 
	`g_¬¿y_ä“
 (
”rÜ
, 
TRUE
);

757 
	`g_ä“
 (
hb
);

759 
out
:

760 ià(
m‘hod_run_nÙify
)

761 
	`m‘hod_run_nÙify
 (
m‘hod_run_nÙify_u£rd©a
);

762 
	}
}

766 
	$ÿÎ_nÙify
 (
DBusP’dšgC®l
 * 
³ndšg
, *
u£r_d©a
)

768 
H–³rD©a
 *
hb
 = (H–³rD©¨*è
u£r_d©a
;

769 
DBusMes§ge
 *
m
;

771 
m
 = 
	`dbus_³ndšg_ÿÎ_¡—l_»¶y
 (
³ndšg
);

772 
	`´oûss_»¶y
 (
m
, 
hb
);

773 
	`dbus_³ndšg_ÿÎ_uÄef
 (
³ndšg
);

775 
	}
}

780 
	$h®d_ruÂ”_run_m‘hod
 (
H®Deviû
 * 
deviû
,

781 cÚ¡ 
gch¬
 * 
commªd_lše
, **
exŒa_’v
,

782 
gch¬
 * 
šput
, 
gboŞ—n
 
”rÜ_Ú_¡d”r
,

783 
gušt32
 
timeout
,

784 
H®RunT”mš©edCB
 
cb
,

785 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

787 
DBusMes§ge
 *
msg
;

788 
DBusMes§geI‹r
 
™”
;

789 
DBusP’dšgC®l
 *
ÿÎ
;

790 
H–³rD©a
 *
hd
 = 
NULL
;

792 
msg
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.HalRunner",

796 ià(
msg
 =ğ
NULL
)

797 
	`DIE
 (("No memory"));

798 
	`dbus_mes§ge_™”_š™_­³nd
 (
msg
, &
™”
);

800 
	`add_udi
 (&
™”
, 
deviû
);

801 ià(!
	`add_’vœÚm’t
 (&
™”
, 
deviû
, 
commªd_lše
, 
exŒa_’v
))

802 
”rÜ
;

804 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
šput
);

805 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
,

806 &
”rÜ_Ú_¡d”r
);

807 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_UINT32
, &
timeout
);

809 ià(!
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y
 (
ruÂ”_cÚÃùiÚ
,

810 
msg
, &
ÿÎ
, 
INT_MAX
))

811 
	`DIE
 (("No memory"));

817 ià(
ÿÎ
 =ğ
NULL
)

818 
”rÜ
;

820 
hd
 = 
	`g_Ãw0
 (
H–³rD©a
, 1);

821 
hd
->
d
 = 
deviû
;

822 
hd
->
cb
 = cb;

823 
hd
->
d©a1
 = data1;

824 
hd
->
d©a2
 = data2;

826 ià(
deviû
 !ğ
NULL
)

827 
	`g_objeù_»f
 (
deviû
);

829 
	`dbus_³ndšg_ÿÎ_£t_nÙify
 (
ÿÎ
, 
ÿÎ_nÙify
, 
hd
, 
NULL
);

830 
	`dbus_mes§ge_uÄef
 (
msg
);

832 
”rÜ
:

833 
	`dbus_mes§ge_uÄef
 (
msg
);

834 
	`g_ä“
 (
hd
);

835 
	`cb
 (
deviû
, 
HALD_RUN_FAILED
, 0, 
NULL
, 
d©a1
, 
d©a2
);

836 
	}
}

839 
	$h®d_ruÂ”_run
 (
H®Deviû
 * 
deviû
,

840 cÚ¡ 
gch¬
 * 
commªd_lše
, **
exŒa_’v
,

841 
gušt
 
timeout
,

842 
H®RunT”mš©edCB
 
cb
, 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

844 
	`h®d_ruÂ”_run_m‘hod
 (
deviû
, 
commªd_lše
, 
exŒa_’v
,

845 "", 
FALSE
, 
timeout
, 
cb
, 
d©a1
, 
d©a2
);

846 
	}
}

849 
	$h®d_ruÂ”_run_sync
 (
H®Deviû
 * 
deviû
,

850 cÚ¡ 
gch¬
 * 
commªd_lše
, **
exŒa_’v
,

851 
gušt
 
timeout
,

852 
H®RunT”mš©edCB
 
cb
, 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

854 
DBusMes§ge
 *
msg
;

855 
DBusMes§ge
 *
»¶y
;

856 
DBusMes§geI‹r
 
™”
;

857 
H–³rD©a
 *
hd
 = 
NULL
;

858 cÚ¡ *
šput
 = "";

859 
gboŞ—n
 
”rÜ_Ú_¡d”r
 = 
FALSE
;

860 
DBusE¼Ü
 
”rÜ
;

862 
msg
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.HalRunner",

866 ià(
msg
 =ğ
NULL
)

867 
	`DIE
 (("No memory"));

868 
	`dbus_mes§ge_™”_š™_­³nd
 (
msg
, &
™”
);

870 
	`add_udi
 (&
™”
, 
deviû
);

871 ià(!
	`add_’vœÚm’t
 (&
™”
, 
deviû
, 
commªd_lše
, 
exŒa_’v
))

872 
”rÜ
;

874 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
šput
);

875 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
”rÜ_Ú_¡d”r
);

876 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_UINT32
, &
timeout
);

878 
	`dbus_”rÜ_š™
 (&
”rÜ
);

879 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ruÂ”_cÚÃùiÚ
, 
msg
, 
INT_MAX
, &
”rÜ
);

880 ià(
»¶y
 =ğ
NULL
) {

881 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

882 
	`HAL_ERROR
 (("E¼Ü„uÂšg '%s': %s: %s", 
commªd_lše
, 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

884 
”rÜ
;

887 
hd
 = 
	`g_Ãw0
 (
H–³rD©a
, 1);

888 
hd
->
d
 = 
deviû
;

889 
hd
->
cb
 = cb;

890 
hd
->
d©a1
 = data1;

891 
hd
->
d©a2
 = data2;

896 
	`´oûss_»¶y
 (
»¶y
, 
hd
);

898 
	`dbus_mes§ge_uÄef
 (
msg
);

901 
”rÜ
:

902 
	`dbus_mes§ge_uÄef
 (
msg
);

903 
	`g_ä“
 (
hd
);

904 
	`cb
 (
deviû
, 
HALD_RUN_FAILED
, 0, 
NULL
, 
d©a1
, 
d©a2
);

905 
	}
}

909 
	$h®d_ruÂ”_kl_deviû
 (
H®Deviû
 * 
deviû
)

911 
DBusMes§ge
 *
msg
, *
»¶y
;

912 
DBusE¼Ü
 
”r
;

913 
DBusMes§geI‹r
 
™”
;

914 cÚ¡ *
udi
;

916 
	`ruÂšg_´oûs£s_»move_deviû
 (
deviû
);

918 
msg
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.HalRunner",

922 ià(
msg
 =ğ
NULL
)

923 
	`DIE
 (("No memory"));

924 
	`dbus_mes§ge_™”_š™_­³nd
 (
msg
, &
™”
);

925 
udi
 = 
	`h®_deviû_g‘_udi
 (
deviû
);

926 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
udi
);

929 
	`dbus_”rÜ_š™
 (&
”r
);

930 
»¶y
 =

931 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ruÂ”_cÚÃùiÚ
,

932 
msg
, -1, &
”r
);

933 ià(
»¶y
) {

934 
	`dbus_mes§ge_uÄef
 (
»¶y
);

937 
	`dbus_mes§ge_uÄef
 (
msg
);

938 
	}
}

941 
	$h®d_ruÂ”_kl_®l
 ()

943 
DBusMes§ge
 *
msg
, *
»¶y
;

944 
DBusE¼Ü
 
”r
;

946 
msg
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.HalRunner",

950 ià(
msg
 =ğ
NULL
)

951 
	`DIE
 (("No memory"));

954 
	`dbus_”rÜ_š™
 (&
”r
);

955 
»¶y
 =

956 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ruÂ”_cÚÃùiÚ
,

957 
msg
, -1, &
”r
);

958 ià(
»¶y
) {

959 
	`dbus_mes§ge_uÄef
 (
»¶y
);

962 
	`dbus_mes§ge_uÄef
 (
msg
);

963 
	}
}

966 
	$h®d_ruÂ”_£t_m‘hod_run_nÙify
 (
H®dRuÂ”RunNÙify
 
cb
,

967 
gpoš‹r
 
u£r_d©a
)

969 
m‘hod_run_nÙify
 = 
cb
;

970 
m‘hod_run_nÙify_u£rd©a
 = 
u£r_d©a
;

971 
	}
}

	@hald/hald_runner.h

28 #iâdeà
HALD_RUNNER_H


29 
	#HALD_RUNNER_H


	)

31 
	~"deviû.h
"

34 
	#HALD_RUN_SUCCESS
 0x0

	)

36 
	#HALD_RUN_TIMEOUT
 0x1

	)

38 
	#HALD_RUN_FAILED
 0x2

	)

40 
	#HALD_RUN_KILLED
 0x4

	)

43 
	#HAL_HELPER_TIMEOUT
 20000

	)

45 (*
	tH®RunT”mš©edCB
è(
	tH®Deviû
 *
	td
, 
	tgušt32
 
	tex™_ty³
,

46 
	tgšt
 
	t»tuº_code
, 
	tgch¬
 **
	t”rÜ
,

47 
	tgpoš‹r
 
	td©a1
, gpoš‹¸
	td©a2
);

50 
gboŞ—n


51 
	`h®d_ruÂ”_¡¬t_ruÂ”
();

55 
	`h®d_ruÂ”_¡İ_ruÂ”
();

61 
gboŞ—n


62 
	`h®d_ruÂ”_¡¬t
 (
H®Deviû
 *
deviû
, cÚ¡ 
gch¬
 *
commªd_lše
, **
exŒa_’v
,

63 
H®RunT”mš©edCB
 
cb
, 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
);

65 
gboŞ—n


66 
	`h®d_ruÂ”_¡¬t_sšgËtÚ
 (cÚ¡ 
gch¬
 * 
commªd_lše
,

67 **
exŒa_’v
, 
H®RunT”mš©edCB
 
cb
,

68 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
);

73 
	`h®d_ruÂ”_run
 (
H®Deviû
 *
deviû
,

74 cÚ¡ 
gch¬
 *
commªd_lše
, **
exŒa_’v
,

75 
gušt32
 
timeout
,

76 
H®RunT”mš©edCB
 
cb
,

77 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
);

80 
	`h®d_ruÂ”_run_sync
 (
H®Deviû
 *
deviû
,

81 cÚ¡ 
gch¬
 *
commªd_lše
, **
exŒa_’v
,

82 
gušt32
 
timeout
,

83 
H®RunT”mš©edCB
 
cb
,

84 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
);

87 
	`h®d_ruÂ”_run_m‘hod
(
H®Deviû
 *
deviû
,

88 cÚ¡ 
gch¬
 *
commªd_lše
, **
exŒa_’v
,

89 
gch¬
 *
šput
, 
gboŞ—n
 
”rÜ_Ú_¡d”r
,

90 
gušt32
 
timeout
,

91 
H®RunT”mš©edCB
 
cb
,

92 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
);

94 
	`h®d_ruÂ”_kl_deviû
(
H®Deviû
 *
deviû
);

95 
	`h®d_ruÂ”_kl_®l
();

98 
	`ruÂ”_deviû_fš®ized
 (
H®Deviû
 *
deviû
);

100 (*
	tH®dRuÂ”RunNÙify
)(
	tgpoš‹r
 
	tu£r_d©a
);

101 
	`h®d_ruÂ”_£t_m‘hod_run_nÙify
 (
H®dRuÂ”RunNÙify
 
cb
, 
gpoš‹r
 
u£r_d©a
);

	@hald/hald_test.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<g‘İt.h
>

35 
	~<pwd.h
>

36 
	~<¡dšt.h
>

37 
	~<sys/¡©.h
>

38 
	~<fú.h
>

39 
	~<”ºo.h
>

40 
	~<sigÇl.h
>

41 
	~<sys/´ùl.h
>

42 
	~<sys/ÿ·b™y.h
>

43 
	~<g½.h
>

44 
	~<sy¦og.h
>

46 
	~<dbus/dbus.h
>

47 
	~<dbus/dbus-glib-lowËv–.h
>

49 
	~"logg”.h
"

50 
	~"h®d.h
"

51 
	~"deviû_¡Üe.h
"

52 
	~"deviû_šfo.h
"

54 
H®DeviûStÜe
 *
	gglob®_deviû_li¡
 = 
NULL
;

56 
H®DeviûStÜe
 *
	g‹mpÜ¬y_deviû_li¡
 = 
NULL
;

59 
dbus_boŞ_t
 
	gh®d_is_š™Ÿlisšg
;

62 
dbus_boŞ_t
 
	gh®d_is_shu‰šg_down
;

65 
dbus_boŞ_t
 
	gh®d_is_v”bo£
 = 
FALSE
;

67 
H®DeviûStÜe
 *

68 
	$h®d_g‘_gdl
 ()

70 ià(
glob®_deviû_li¡
 =ğ
NULL
) {

71 
glob®_deviû_li¡
 = 
	`h®_deviû_¡Üe_Ãw
 ();

73 
	`g_sigÇl_cÚÃù
 (
glob®_deviû_li¡
,

75 
	`G_CALLBACK
 (
gdl_¡Üe_chªged
), 
NULL
);

76 
	`g_sigÇl_cÚÃù
 (
glob®_deviû_li¡
,

78 
	`G_CALLBACK
 (
gdl_´İ”ty_chªged
), 
NULL
);

79 
	`g_sigÇl_cÚÃù
 (
glob®_deviû_li¡
,

81 
	`G_CALLBACK
 (
gdl_ÿ·b™y_added
), 
NULL
);

85  
glob®_deviû_li¡
;

86 
	}
}

88 
H®DeviûStÜe
 *

89 
	$h®d_g‘_tdl
 ()

91 ià(
‹mpÜ¬y_deviû_li¡
 =ğ
NULL
) {

92 
‹mpÜ¬y_deviû_li¡
 = 
	`h®_deviû_¡Üe_Ãw
 ();

96  
‹mpÜ¬y_deviû_li¡
;

97 
	}
}

101 
gboŞ—n


102 
	$check_´İ”t›s
 ()

104 
H®Deviû
 *
d
;

105 
GSLi¡
 *
s
;

107 
	`´štf
 ("Checking HalDevice…roperties\n");

109 
d
 = 
	`h®_deviû_Ãw
 ();

110 ià(
d
 =ğ
NULL
) {

111 
	`´štf
 ("Cannot‡llocate HalDevice object\n");

112 
out
;

115 
	`´štf
 ("int: ");

116 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "test.int", 42);

117 ià(
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "test.int") != 42) {

118 
	`´štf
 ("FAILED\n");

119 
out
;

121 
	`´štf
 ("PASSED\n");

123 
	`´štf
 ("uint64: ");

124 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "‹¡.ušt64", ((((
dbus_ušt64_t
)1)<<35) + 5));

125 ià(
	`h®_deviû_´İ”ty_g‘_ušt64
 (
d
, "‹¡.ušt64"è!ğ((((
dbus_ušt64_t
)1)<<35) + 5)) {

126 
	`´štf
 ("FAILED\n");

127 
out
;

129 
	`´štf
 ("PASSED\n");

132 
v®
 = 0.53434343;

133 
v®2
;

135 
	`´štf
 ("double: ");

136 
	`h®_deviû_´İ”ty_£t_doubË
 (
d
, "‹¡.doubË", 
v®
);

137 
v®2
 = 
	`h®_deviû_´İ”ty_g‘_doubË
 (
d
, "test.double");

138 ià(
	`memcmp
 (&
v®
, &
v®2
,  ()) != 0) {

139 
	`´štf
 ("FAILED\n");

140 
out
;

142 
	`´štf
 ("PASSED\n");

145 
	`´štf
 ("string (ASCII): ");

146 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "test.string", "fooooobar22");

147 ià(
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "test.string"), "fooooobar22") != 0) {

148 
	`´štf
 ("FAILED\n");

149 
out
;

151 
	`´štf
 ("PASSED\n");

153 
	`´štf
 ("string (UTF-8): ");

154 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "test.string2", "fooÃ¸Ø©×");

155 ià(
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "test.string2"), "fooÃ¸Ø©×") != 0) {

156 
	`´štf
 ("FAILED\n");

157 
out
;

159 
	`´štf
 ("PASSED\n");

161 
	`´štf
 ("bool: ");

162 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "‹¡.boŞ", 
TRUE
);

163 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "‹¡.boŞ"è!ğ
TRUE
) {

164 
	`´štf
 ("FAILED\n");

165 
out
;

167 
	`´štf
 ("PASSED\n");

169 
	`´štf
 ("strlist: ");

170 ià(!
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
d
, "‹¡.¡¾i¡", "foo¡¾i¡0", 
FALSE
)) {

171 
	`´štf
 ("FAILED00\n");

172 
out
;

174 ià((
s
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
d
, "‹¡.¡¾i¡")è=ğ
NULL
) {

175 
	`´štf
 ("FAILED01\n");

176 
out
;

178 ià(
	`g_¦i¡_Ëngth
 (
s
) != 1) {

179 
	`´štf
 ("FAILED02\n");

180 
out
;

182 ià(
	`¡rcmp
 (
s
->
d©a
, "foostrlist0") != 0) {

183 
	`´štf
 ("FAILED03\n");

184 
out
;

187 ià(!
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
d
, "‹¡.¡¾i¡", "foo¡¾i¡1", 
FALSE
)) {

188 
	`´štf
 ("FAILED10\n");

189 
out
;

191 ià((
s
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
d
, "‹¡.¡¾i¡")è=ğ
NULL
) {

192 
	`´štf
 ("FAILED11\n");

193 
out
;

195 ià(
	`g_¦i¡_Ëngth
 (
s
) != 2) {

196 
	`´štf
 ("FAILED12\n");

197 
out
;

199 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist0") != 0) {

200 
	`´štf
 ("FAILED13\n");

201 
out
;

203 
s
 = s->
Ãxt
;

204 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist1") != 0) {

205 
	`´štf
 ("FAILED14\n");

206 
out
;

209 ià(!
	`h®_deviû_´İ”ty_¡¾i¡_´•’d
 (
d
, "test.strlist", "foostrlist2")) {

210 
	`´štf
 ("FAILED20\n");

211 
out
;

213 ià((
s
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
d
, "‹¡.¡¾i¡")è=ğ
NULL
) {

214 
	`´štf
 ("FAILED21\n");

215 
out
;

217 ià(
	`g_¦i¡_Ëngth
 (
s
) != 3) {

218 
	`´štf
 ("FAILED22\n");

219 
out
;

221 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist2") != 0) {

222 
	`´štf
 ("FAILED23\n");

223 
out
;

225 
s
 = s->
Ãxt
;

226 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist0") != 0) {

227 
	`´štf
 ("FAILED24\n");

228 
out
;

230 
s
 = s->
Ãxt
;

231 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist1") != 0) {

232 
	`´štf
 ("FAILED25\n");

233 
out
;

237 ià(!
	`h®_deviû_´İ”ty_¡¾i¡_»move_–em
 (
d
, "test.strlist", 1)) {

238 
	`´štf
 ("FAILED30\n");

239 
out
;

241 ià((
s
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
d
, "‹¡.¡¾i¡")è=ğ
NULL
) {

242 
	`´štf
 ("FAILED31\n");

243 
out
;

245 ià(
	`g_¦i¡_Ëngth
 (
s
) != 2) {

246 
	`´štf
 ("FAILED32\n");

247 
out
;

249 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist2") != 0) {

250 
	`´štf
 ("FAILED33\n");

251 
out
;

253 
s
 = s->
Ãxt
;

254 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist1") != 0) {

255 
	`´štf
 ("FAILED34\n");

256 
out
;

260 ià(
	`h®_deviû_´İ”ty_¡¾i¡_add
 (
d
, "test.strlist", "foostrlist2")) {

261 
	`´štf
 ("FAILED40\n");

262 
out
;

264 ià((
s
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
d
, "‹¡.¡¾i¡")è=ğ
NULL
) {

265 
	`´štf
 ("FAILED31\n");

266 
out
;

268 ià(
	`g_¦i¡_Ëngth
 (
s
) != 2) {

269 
	`´štf
 ("FAILED42\n");

270 
out
;

272 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist2") != 0) {

273 
	`´štf
 ("FAILED43\n");

274 
out
;

276 
s
 = s->
Ãxt
;

277 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist1") != 0) {

278 
	`´štf
 ("FAILED44\n");

279 
out
;

283 ià(!
	`h®_deviû_´İ”ty_¡¾i¡_add
 (
d
, "test.strlist", "foostrlist3")) {

284 
	`´štf
 ("FAILED50\n");

285 
out
;

287 ià((
s
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
d
, "‹¡.¡¾i¡")è=ğ
NULL
) {

288 
	`´štf
 ("FAILED51\n");

289 
out
;

291 ià(
	`g_¦i¡_Ëngth
 (
s
) != 3) {

292 
	`´štf
 ("FAILED52\n");

293 
out
;

295 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist2") != 0) {

296 
	`´štf
 ("FAILED53\n");

297 
out
;

299 
s
 = s->
Ãxt
;

300 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist1") != 0) {

301 
	`´štf
 ("FAILED54\n");

302 
out
;

304 
s
 = s->
Ãxt
;

305 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist3") != 0) {

306 
	`´štf
 ("FAILED55\n");

307 
out
;

313 ià(!
	`h®_deviû_´İ”ty_¡¾i¡_»move
 (
d
, "test.strlist", "foostrlist1")) {

314 
	`´štf
 ("FAILED60\n");

315 
out
;

317 ià((
s
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
d
, "‹¡.¡¾i¡")è=ğ
NULL
) {

318 
	`´štf
 ("FAILED61\n");

319 
out
;

321 ià(
	`g_¦i¡_Ëngth
 (
s
) != 2) {

322 
	`´štf
 ("FAILED62\n");

323 
out
;

325 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist2") != 0) {

326 
	`´štf
 ("FAILED63\n");

327 
out
;

329 
s
 = s->
Ãxt
;

330 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist3") != 0) {

331 
	`´štf
 ("FAILED65\n");

332 
out
;

336 ià(!
	`h®_deviû_´İ”ty_¡¾i¡_»move
 (
d
, "test.strlist", "foostrlist1")) {

337 
	`´štf
 ("FAILED70\n");

338 
out
;

340 ià((
s
 = 
	`h®_deviû_´İ”ty_g‘_¡¾i¡
 (
d
, "‹¡.¡¾i¡")è=ğ
NULL
) {

341 
	`´štf
 ("FAILED71\n");

342 
out
;

344 ià(
	`g_¦i¡_Ëngth
 (
s
) != 2) {

345 
	`´štf
 ("FAILED72\n");

346 
out
;

348 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist2") != 0) {

349 
	`´štf
 ("FAILED73\n");

350 
out
;

352 
s
 = s->
Ãxt
;

353 ià(
s
 =ğ
NULL
 || 
	`¡rcmp
 (s->
d©a
, "foostrlist3") != 0) {

354 
	`´štf
 ("FAILED75\n");

355 
out
;

357 
	`´štf
 ("PASSED\n");

359 
	`´štf
 ("propertyƒxistence: ");

360 ià(!
	`h®_deviû_has_´İ”ty
 (
d
, "test.int") ||

361 !
	`h®_deviû_has_´İ”ty
 (
d
, "test.uint64") ||

362 !
	`h®_deviû_has_´İ”ty
 (
d
, "test.double") ||

363 !
	`h®_deviû_has_´İ”ty
 (
d
, "test.bool") ||

364 !
	`h®_deviû_has_´İ”ty
 (
d
, "test.string") ||

365 !
	`h®_deviû_has_´İ”ty
 (
d
, "test.string2") ||

366 !
	`h®_deviû_has_´İ”ty
 (
d
, "test.strlist")) {

367 
	`´štf
 ("FAILED80\n");

368 
out
;

370 ià(
	`h®_deviû_has_´İ”ty
 (
d
, "moe") ||

371 
	`h®_deviû_has_´İ”ty
 (
d
, "joe") ||

372 
	`h®_deviû_has_´İ”ty
 (
d
, "woo")) {

373 
	`´štf
 ("FAILED81\n");

374 
out
;

376 
	`´štf
 ("PASSED\n");

378 
	`h®_deviû_£t_udi
 (
d
, "/org/freedesktop/Hal/devices/testobj1");

381 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

383  
TRUE
;

384 
out
:

385  
FALSE
;

386 
	}
}

388 
gboŞ—n
 
check_libh®
 (cÚ¡ *
£rv”_addr
);

392 
DBusHªdËrResuÉ


393 
	$£rv”_f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

394 
DBusMes§ge
 * 
mes§ge
, *
u£r_d©a
)

396 
	`´štf
 ("server_filter_function: obj_path=%s interface=%s method=%s destination=%s",

397 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

398 
	`dbus_mes§ge_g‘_š‹rçû
 (
mes§ge
),

399 
	`dbus_mes§ge_g‘_memb”
 (
mes§ge
),

400 
	`dbus_mes§ge_g‘_de¡š©iÚ
 (
mes§ge
));

401 
	}
}

403 
	gnum_‹¡s_dÚe
;

404 
gboŞ—n
 
	gnum_‹¡s_dÚe_Ï¡_»suÉ
;

406 
DBusHªdËrResuÉ


407 
	$£rv”_mes§ge_hªdËr
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

408 
DBusMes§ge
 *
mes§ge
,

409 *
u£r_d©a
)

419 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
, "org.freedesktop.Hal.Tests", "TestsDone")) {

420 
DBusE¼Ü
 
”rÜ
;

421 
dbus_boŞ_t
 
·s£d
;

422 
DBusMes§ge
 *
»¶y
;

424 
	`dbus_”rÜ_š™
 (&
”rÜ
);

425 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

426 
DBUS_TYPE_BOOLEAN
, &
·s£d
,

427 
DBUS_TYPE_INVALID
)) {

429 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
, "org.freedesktop.Hal.SyntaxError", "Syntax Error");

430 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

431 
	`dbus_mes§ge_uÄef
 (
»¶y
);

432 
·s£d
 = 
FALSE
;

435 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

436 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

437 
	`dbus_mes§ge_uÄef
 (
»¶y
);

440 
num_‹¡s_dÚe
++;

441 
num_‹¡s_dÚe_Ï¡_»suÉ
 = 
·s£d
;

443  
DBUS_HANDLER_RESULT_HANDLED
;

445 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
, "org.freedesktop.DBus", "AddMatch")) {

446 
DBusMes§ge
 *
»¶y
;

450 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
, "org.freedesktop.Hal.Error",

452 ià(
»¶y
 =ğ
NULL
)

453 
	`DIE
 (("No memory"));

454 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
))

455 
	`DIE
 (("No memory"));

456 
	`dbus_mes§ge_uÄef
 (
»¶y
);

457  
DBUS_HANDLER_RESULT_HANDLED
;

460  
	`h®d_dbus_f‹r_funùiÚ
 (
cÚÃùiÚ
, 
mes§ge
, 
u£r_d©a
);

461 
	}
}

463 
DBusHªdËrResuÉ


464 
	$os¥ec_f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£r_d©a
)

466  
DBUS_HANDLER_RESULT_HANDLED
;

467 
	}
}

470 
	$£rv”_uÄegi¡”_hªdËr
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, *
u£r_d©a
)

472 
	`´štf
 ("unregistered\n");

473 
	}
}

476 
	$£rv”_hªdË_cÚÃùiÚ
 (
DBusS”v”
 *
£rv”
,

477 
DBusCÚÃùiÚ
 *
Ãw_cÚÃùiÚ
,

478 *
d©a
)

480 
DBusObjeùP©hVTabË
 
vbË
 = { &
£rv”_uÄegi¡”_hªdËr
,

481 &
£rv”_mes§ge_hªdËr
,

482 
NULL
, NULL, NULL, NULL};

484 
	`´štf
 ("%d: GÙ‡ cÚÃùiÚ\n", 
	`g‘pid
 ());

485 
	`´štf
 ("dbus_cÚÃùiÚ_g‘_is_cÚÃùed = %d\n", 
	`dbus_cÚÃùiÚ_g‘_is_cÚÃùed
 (
Ãw_cÚÃùiÚ
));

489 
	`dbus_cÚÃùiÚ_»gi¡”_çÎback
 (
Ãw_cÚÃùiÚ
,

491 &
vbË
,

492 
NULL
);

493 
	`dbus_cÚÃùiÚ_»f
 (
Ãw_cÚÃùiÚ
);

494 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
Ãw_cÚÃùiÚ
, 
NULL
);

495 
	}
}

498 
gboŞ—n


499 
	$wa™_fÜ_ex‹º®_‹¡
 ()

501 
num_‹¡s_dÚe_´e
;

505 
num_‹¡s_dÚe_´e
 = 
num_‹¡s_dÚe
;

506 
num_‹¡s_dÚe_´e
 =ğ
num_‹¡s_dÚe
) {

507 
	`g_maš_cÚ‹xt_™”©iÚ
 (
NULL
, 
TRUE
);

508 ià(!
	`g_maš_cÚ‹xt_³ndšg
 (
NULL
))

509 
	`u¦“p
 (100*1000);

512  
num_‹¡s_dÚe_Ï¡_»suÉ
;

513 
	}
}

516 
	$maš
 (
¬gc
, *
¬gv
[])

518 
num_‹¡s_çed
;

519 
DBusS”v”
 *
£rv”
;

520 
DBusE¼Ü
 
”rÜ
;

521 
GMašLoİ
 *
loİ
;

523 
num_‹¡s_çed
 = 0;

525 
	`g_ty³_š™
 ();

527 
loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

529 
	`´štf
 ("=============================\n");

534 
	`dbus_”rÜ_š™
 (&
”rÜ
);

535 ià((
£rv”
 = 
	`dbus_£rv”_li¡’
 ("unix:tmpdœ=h®d-‹¡", &
”rÜ
)è=ğ
NULL
) {

536 
	`´štf
 ("Cannot create D-BUS server\n");

537 
num_‹¡s_çed
++;

538 
out
;

540 
	`´štf
 ("£rv” i li¡’šg‡ˆ%s\n", 
	`dbus_£rv”_g‘_add»ss
 (
£rv”
));

541 
	`dbus_£rv”_£tup_w™h_g_maš
 (
£rv”
, 
NULL
);

543 
	`dbus_£rv”_£t_Ãw_cÚÃùiÚ_funùiÚ
 (
£rv”
, 
£rv”_hªdË_cÚÃùiÚ
, 
NULL
, NULL);

546 ià(!
	`check_´İ”t›s
 ())

547 
num_‹¡s_çed
++;

557 
	`´štf
 ("=============================\n");

559 
	`´štf
 ("TÙ®‚umb” oà‹¡ çed: %d\n", 
num_‹¡s_çed
);

561 
out
:

562  
num_‹¡s_çed
;

563 
	}
}

565 
gboŞ—n
 
	$os¥ec_deviû_»sÿn
 (
H®Deviû
 *
d
)

567  
FALSE
;

568 
	}
}

570 
gboŞ—n
 
	$os¥ec_deviû_»´obe
 (
H®Deviû
 *
d
)

572  
FALSE
;

573 
	}
}

	@hald/hald_test_libhal.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<g‘İt.h
>

35 
	~<pwd.h
>

36 
	~<¡dšt.h
>

37 
	~<sys/¡©.h
>

38 
	~<fú.h
>

39 
	~<”ºo.h
>

40 
	~<sigÇl.h
>

41 
	~<sys/´ùl.h
>

42 
	~<sys/ÿ·b™y.h
>

43 
	~<g½.h
>

44 
	~<sy¦og.h
>

46 
	~<dbus/dbus.h
>

47 
	~<dbus/dbus-glib-lowËv–.h
>

49 
	~"libh®/libh®.h
"

52 
	$£nd_‹¡s_dÚe
 (
DBusCÚÃùiÚ
 *
cÚn
, 
dbus_boŞ_t
 
·s£d
)

54 
i
;

55 
DBusMes§ge
 *
mes§ge
;

56 
DBusMes§ge
 *
»¶y
;

57 
DBusMes§geI‹r
 
™”
;

58 
DBusE¼Ü
 
”rÜ
;

60 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

64 ià(
mes§ge
 =ğ
NULL
) {

65 
	`årštf
 (
¡d”r
, "% %d : Couldn'ˆ®loÿ‹ D-BUS mes§ge\n", 
__FILE__
, 
__LINE__
);

66 
out
;

69 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

70 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
·s£d
);

72 
	`dbus_”rÜ_š™
 (&
”rÜ
);

73 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
cÚn
, 
mes§ge
, -1, &
”rÜ
);

74 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

75 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

76 
	`årštf
 (
¡d”r
, "%s %d : Error sending message: %s: %s\n",

77 
__FILE__
, 
__LINE__
, 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

81 ià(
»¶y
 =ğ
NULL
) {

82 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

83 
	`årštf
 (
¡d”r
, "% %d : NØ»¶y!\n", 
__FILE__
, 
__LINE__
);

87 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

88 
	`dbus_mes§ge_uÄef
 (
»¶y
);

89 
out
:

91 
	}
}

95 
gboŞ—n


96 
	$check_libh®
 (cÚ¡ *
£rv”_addr
)

98 
pid_t
 
chd_pid
;

100 
chd_pid
 = 
	`fÜk
 ();

101 ià(
chd_pid
 == -1) {

102 
	`´štf
 ("Cannot fork\n");

103 
	`ex™
 (1);

104 } ià(
chd_pid
 == 0) {

105 
DBusE¼Ü
 
”rÜ
;

106 
DBusCÚÃùiÚ
 *
cÚn
;

107 
LibH®CÚ‹xt
 *
ùx
;

108 
dbus_boŞ_t
 
·s£d
;

110 
	`´štf
 ("£rv”‡dd»ss='%s'\n", 
£rv”_addr
);

112 
	`dbus_”rÜ_š™
 (&
”rÜ
);

113 ià((
cÚn
 = 
	`dbus_cÚÃùiÚ_İ’
 (
£rv”_addr
, &
”rÜ
)è=ğ
NULL
) {

114 
	`´štf
 ("E¼Ü cÚÃùšgØ£rv”: %s\n", 
”rÜ
.
mes§ge
);

118 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚn
, 
NULL
);

120 ià((
ùx
 = 
	`libh®_ùx_Ãw
 ()è=ğ
NULL
) {

121 
	`´štf
 ("Error getting†ibhal context\n");

126 
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
ùx
, 
cÚn
);

128 
	`libh®_ùx_š™
 (
ùx
, &
”rÜ
);

130 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

131 
	`´štf
 ("FAILED98: %s\n", 
”rÜ
.
mes§ge
);

132 
ç
;

134 
	`´štf
 ("SUCCESS98\n");

136 
	`libh®_deviû_´št
 (
ùx
, "/Üg/ä“desktİ/H®/deviûs/‹¡obj1", &
”rÜ
);

139 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

140 
	`´štf
 ("FAILED99: %s\n", 
”rÜ
.
mes§ge
);

141 
ç
;

143 
	`´štf
 ("SUCCESS99\n");

145 
·s£d
 = 
FALSE
;

148 *
v®
;

150 
v®
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
ùx
, "/Üg/ä“desktİ/H®/deviûs/‹¡obj1", "‹¡.¡ršg", &
”rÜ
);

152 ià(
v®
 =ğ
NULL
 || 
	`¡rcmp
 (v®, "fooooob¬22"è!ğ0 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

153 
	`libh®_ä“_¡ršg
 (
v®
);

154 
	`´štf
 ("FAILED100\n");

155 
ç
;

157 
	`´štf
 ("SUCCESS100\n");

158 
	`libh®_ä“_¡ršg
 (
v®
);

162 *
v®
;

163 
v®
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
ùx
, "/Üg/ä“desktİ/H®/deviûs/‹¡obj1", "‹¡.¡ršg2", &
”rÜ
);

164 ià(
v®
 =ğ
NULL
 || 
	`¡rcmp
 (v®, "fooÃ¸Ø©×"è!ğ0 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

165 
	`libh®_ä“_¡ršg
 (
v®
);

166 
	`´štf
 ("FAILED101: %s\n", 
”rÜ
.
mes§ge
);

167 
ç
;

169 
	`libh®_ä“_¡ršg
 (
v®
);

170 
	`´štf
 ("SUCCESS101\n");

174 
dbus_boŞ_t
 
b
;

175 
b
 = 
	`libh®_deviû_g‘_´İ”ty_boŞ
 (

176 
ùx
, "/org/freedesktop/Hal/devices/testobj1",

177 "‹¡.boŞ", &
”rÜ
);

179 ià(!
b
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

180 
	`´štf
 ("FAILED102: %s, %i\n", 
”rÜ
.
mes§ge
, 
b
);

181 
ç
;

183 
	`´štf
 ("SUCCESS102\n");

187 
v®
;

188 
ex³ùed_v®
 = 0.53434343;

190 
v®
 = 
	`libh®_deviû_g‘_´İ”ty_doubË
 (
ùx
, "/org/freedesktop/Hal/devices/testobj1",

191 "‹¡.doubË", &
”rÜ
);

192 iàĞ
	`memcmp
 (&
v®
, &
ex³ùed_v®
,  ()è!ğ0 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

193 
	`´štf
 ("FAILED103\n");

194 
ç
;

196 
	`´štf
 ("SUCCESS103\n");

199 ià(
	`libh®_deviû_g‘_´İ”ty_ušt64
 (

200 
ùx
, "/Üg/ä“desktİ/H®/deviûs/‹¡obj1", "‹¡.ušt64", &
”rÜ
) !=

201 ((((
dbus_ušt64_t
)1)<<35) + 5) ||

202 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

203 
	`´štf
 ("FAILED104: %s\n", 
”rÜ
.
mes§ge
);

204 
ç
;

206 
	`´štf
 ("SUCCESS104\n");

209 **
v®
;

210 
v®
 = 
	`libh®_deviû_g‘_´İ”ty_¡¾i¡
 (
ùx
, "/Üg/ä“desktİ/H®/deviûs/‹¡obj1", "‹¡.¡¾i¡", &
”rÜ
);

211 ià(
v®
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

212 
	`libh®_ä“_¡ršg_¬¿y
 (
v®
);

213 
	`´štf
 ("FAILED105: %s\n", 
”rÜ
.
mes§ge
);

214 
ç
;

216 
	`´štf
 ("SUCCESS105\n");

218 ià(
	`libh®_¡ršg_¬¿y_Ëngth
 (
v®
) != 2) {

219 
	`libh®_ä“_¡ršg_¬¿y
 (
v®
);

220 
	`´štf
 ("FAILED106\n");

221 
ç
;

223 
	`´štf
 ("SUCCESS106\n");

225 ià(
	`¡rcmp
 (
v®
[0], "foostrlist2") != 0 ||

226 
	`¡rcmp
 (
v®
[1], "foostrlist3") != 0) {

227 
	`libh®_ä“_¡ršg_¬¿y
 (
v®
);

228 
	`´štf
 ("FAILED107\n");

229 
ç
;

231 
	`´štf
 ("SUCCESS107\n");

233 
	`libh®_ä“_¡ršg_¬¿y
 (
v®
);

236 ià(
	`libh®_deviû_g‘_´İ”ty_št
 (

237 
ùx
, "/Üg/ä“desktİ/H®/deviûs/‹¡obj1", "‹¡.št", &
”rÜ
) != 42 ||

238 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

239 
	`´štf
 ("FAILED108\n");

240 
ç
;

242 
	`´štf
 ("SUCCESS108\n");

246 
ty³
;

247 *
key
;

248 
LibH®Prİ”tyS‘
 *
p£t
;

249 
LibH®Prİ”tyS‘I‹¿tÜ
 
™
;

250 
psi_num_·s£d
;

251 
psi_num_–ems
;

253 ià((
p£t
 = 
	`libh®_deviû_g‘_®l_´İ”t›s
 (
ùx
, "/org/freedesktop/Hal/devices/testobj1",

254 &
”rÜ
)è=ğ
NULL
)

255  
FALSE
;

256 
	`´štf
 ("SUCCESS110\n");

258 
psi_num_·s£d
 = 0;

259 
psi_num_–ems
 = 
	`libh®_´İ”ty_£t_g‘_num_–ems
 (
p£t
);

261 
	`libh®_psi_š™
 (&
™
, 
p£t
); 
	`libh®_psi_has_mÜe
 (&™); 
	`libh®_psi_Ãxt
 (&it)) {

262 
ty³
 = 
	`libh®_psi_g‘_ty³
 (&
™
);

263 
key
 = 
	`libh®_psi_g‘_key
 (&
™
);

265 
ty³
) {

266 
LIBHAL_PROPERTY_TYPE_STRING
:

267 ià(
	`¡rcmp
 (
key
, "info.udi") == 0) {

268 ià(
	`¡rcmp
 (
	`libh®_psi_g‘_¡ršg
 (&
™
),

270 
psi_num_·s£d
++;

272 
	`´štf
 ("ç oÀ%s\n", 
key
);

274 } ià(
	`¡rcmp
 (
key
, "test.string") == 0) {

275 ià(
	`¡rcmp
 (
	`libh®_psi_g‘_¡ršg
 (&
™
),

277 
psi_num_·s£d
++;

279 
	`´štf
 ("ç oÀ%s\n", 
key
);

281 } ià(
	`¡rcmp
 (
key
, "test.string2") == 0) {

282 ià(
	`¡rcmp
 (
	`libh®_psi_g‘_¡ršg
 (&
™
),

284 
psi_num_·s£d
++;

286 
	`´štf
 ("ç oÀ%s\n", 
key
);

291 
LIBHAL_PROPERTY_TYPE_INT32
:

292 ià(
	`¡rcmp
 (
key
, "test.int") == 0) {

293 ià(
	`libh®_psi_g‘_št
 (&
™
) == 42)

294 
psi_num_·s£d
++;

296 
	`´štf
 ("ç oÀ%s\n", 
key
);

300 
LIBHAL_PROPERTY_TYPE_UINT64
:

301 ià(
	`¡rcmp
 (
key
, "test.uint64") == 0) {

302 ià(
	`libh®_psi_g‘_ušt64
 (&
™
è=ğ((((
dbus_ušt64_t
)1)<<35) + 5))

303 
psi_num_·s£d
++;

305 
	`´štf
 ("ç oÀ%s\n", 
key
);

309 
LIBHAL_PROPERTY_TYPE_BOOLEAN
:

310 ià(
	`¡rcmp
 (
key
, "test.bool") == 0) {

311 ià(
	`libh®_psi_g‘_boŞ
 (&
™
è=ğ
TRUE
)

312 
psi_num_·s£d
++;

314 
	`´štf
 ("ç oÀ%s\n", 
key
);

318 
LIBHAL_PROPERTY_TYPE_DOUBLE
:

319 ià(
	`¡rcmp
 (
key
, "test.double") == 0) {

320 
v®
 = 0.53434343;

321 
v®2
;

323 
v®2
 = 
	`libh®_psi_g‘_doubË
 (&
™
);

324 ià(
	`memcmp
 (&
v®
, &
v®2
,  ()) == 0)

325 
psi_num_·s£d
++;

327 
	`´štf
 ("ç oÀ%s\n", 
key
);

331 
LIBHAL_PROPERTY_TYPE_STRLIST
:

332 ià(
	`¡rcmp
 (
key
, "test.strlist") == 0) {

333 **
v®
;

335 
v®
 = 
	`libh®_psi_g‘_¡¾i¡
 (&
™
);

336 ià(
	`libh®_¡ršg_¬¿y_Ëngth
 (
v®
) == 2 &&

337 
	`¡rcmp
 (
v®
[0], "foostrlist2") == 0 &&

338 
	`¡rcmp
 (
v®
[1], "foostrlist3") == 0 &&

339 
v®
[2] =ğ
NULL
)

340 
psi_num_·s£d
++;

342 
	`´štf
 ("ç oÀ%s\n", 
key
);

347 
	`´štf
 (" *** unknowÀty³ fÜ key %s\n", 
key
);

351 
	`libh®_ä“_´İ”ty_£t
 (
p£t
);

353 ià(
psi_num_·s£d
 !ğ
psi_num_–ems
) {

354 
	`´štf
 ("FAILED111\n");

355 
ç
;

357 
	`´štf
 ("SUCCESS111\n");

363 
	`´štf
 ("Passed‡ll†ibhalests\n");

364 
·s£d
 = 
TRUE
;

366 
ç
:

368 
	`£nd_‹¡s_dÚe
 (
cÚn
, 
·s£d
);

369 
	`ex™
 (1);

372 
	`´štf
 ("chd…id=%d\n", 
chd_pid
);

374  
TRUE
;

375 
	}
}

	@hald/ids.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<ùy³.h
>

31 
	~<¡dšt.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<sys/ty³s.h
>

35 
	~<sys/¡©.h
>

36 
	~<sys/mmª.h
>

37 
	~<fú.h
>

38 
	~<”ºo.h
>

40 
	~<dbus/dbus.h
>

41 
	~<dbus/dbus-glib.h
>

43 
	~"logg”.h
"

45 
	~"ids.h
"

47 #ifdeà
USE_PCI_IDS


49 *
	gpci_ids
 = 
NULL
;

52 
size_t
 
	gpci_ids_Ën
;

55 
size_t
 
	gpci_ids_™”_pos
;

59 
	$pci_ids_lše_™”_š™
 ()

61 
pci_ids_™”_pos
 = 0;

62 
	}
}

65 
	#PCI_IDS_MAX_LINE_LEN
 512

	)

77 
	$pci_ids_lše_™”_g‘_lše
 (*
lše_Ën
)

79 
i
;

80 
lše
[
PCI_IDS_MAX_LINE_LEN
];

82 
i
 = 0;

83 
pci_ids_™”_pos
 < 
pci_ids_Ën
 &&

84 
i
 < 
PCI_IDS_MAX_LINE_LEN
 - 1 &&

85 
pci_ids
[
pci_ids_™”_pos
] !ğ'\n'; 
i
++,…ci_ids_iter_pos++) {

86 
lše
[
i
] = 
pci_ids
[
pci_ids_™”_pos
];

89 
lše
[
i
] = '\0';

90 ià(
lše_Ën
 !ğ
NULL
)

91 *
lše_Ën
 = 
i
;

93 
pci_ids_™”_pos
++;

95  
lše
;

96 
	}
}

105 
dbus_boŞ_t


106 
	$pci_ids_lše_™”_has_mÜe
 ()

108  
pci_ids_™”_pos
 < 
pci_ids_Ën
;

109 
	}
}

129 
	$ids_fšd_pci
 (
v’dÜ_id
, 
´oduù_id
,

130 
subsys_v’dÜ_id
, 
subsys_´oduù_id
,

131 **
v’dÜ_Çme
, **
´oduù_Çme
,

132 **
subsys_v’dÜ_Çme
, **
subsys_´oduù_Çme
)

134 *
lše
;

135 
i
;

136 
lše_Ën
;

137 
num_bs
;

138 
»p_vi
[8];

139 
»p_pi
[8];

140 
»p_svi
[8];

141 
»p_¥i
[8];

142 
dbus_boŞ_t
 
v’dÜ_m©ched
 = 
FALSE
;

143 
dbus_boŞ_t
 
´oduù_m©ched
 = 
FALSE
;

144 
¡Üe_vn
[
PCI_IDS_MAX_LINE_LEN
];

145 
¡Üe_²
[
PCI_IDS_MAX_LINE_LEN
];

146 
¡Üe_svn
[
PCI_IDS_MAX_LINE_LEN
];

147 
¡Üe_¥n
[
PCI_IDS_MAX_LINE_LEN
];

149 
	`¢´štf
 (
»p_vi
, 8, "%04x", 
v’dÜ_id
);

150 
	`¢´štf
 (
»p_pi
, 8, "%04x", 
´oduù_id
);

151 
	`¢´štf
 (
»p_svi
, 8, "%04x", 
subsys_v’dÜ_id
);

152 
	`¢´štf
 (
»p_¥i
, 8, "%04x", 
subsys_´oduù_id
);

154 *
v’dÜ_Çme
 = 
NULL
;

155 *
´oduù_Çme
 = 
NULL
;

156 *
subsys_v’dÜ_Çme
 = 
NULL
;

157 *
subsys_´oduù_Çme
 = 
NULL
;

159 
	`pci_ids_lše_™”_š™
 (); 
	`pci_ids_lše_™”_has_mÜe
 ();) {

160 
lše
 = 
	`pci_ids_lše_™”_g‘_lše
 (&
lše_Ën
);

163 ià(
lše_Ën
 < 4)

167 ià(
lše
[0] == '#')

171 
num_bs
 = 0;

172 
i
 = 0; i < 
lše_Ën
; i++) {

173 ià(
lše
[
i
] != '\t')

175 
num_bs
++;

178 
num_bs
) {

181 
v’dÜ_m©ched
 = 
FALSE
;

185 ià(*
subsys_v’dÜ_Çme
 =ğ
NULL


186 && 
subsys_v’dÜ_id
 != 0) {

187 ià((*((
dbus_ušt32_t
 *è
lše
)) ==

188 (*((
dbus_ušt32_t
 *è
»p_svi
))) {

190 
i
 = 4; i < 
lše_Ën
; i++) {

191 ià(!
	`is¥aû
 (
lše
[
i
]))

194 
	`¡ºıy
 (
¡Üe_svn
, 
lše
 + 
i
,

195 
PCI_IDS_MAX_LINE_LEN
);

196 *
subsys_v’dÜ_Çme
 = 
¡Üe_svn
;

201 ià(
v’dÜ_id
 != 0) {

202 ià(
	`memcmp
 (
lše
, 
»p_vi
, 4) == 0) {

204 
v’dÜ_m©ched
 = 
TRUE
;

206 
i
 = 4; i < 
lše_Ën
; i++) {

207 ià(!
	`is¥aû
 (
lše
[
i
]))

210 
	`¡ºıy
 (
¡Üe_vn
, 
lše
 + 
i
,

211 
PCI_IDS_MAX_LINE_LEN
);

212 *
v’dÜ_Çme
 = 
¡Üe_vn
;

219 
´oduù_m©ched
 = 
FALSE
;

222 ià(!
v’dÜ_m©ched
)

226 ià(
´oduù_id
 != 0) {

227 ià(
	`memcmp
 (
lše
 + 1, 
»p_pi
, 4) == 0) {

230 
´oduù_m©ched
 = 
TRUE
;

232 
i
 = 5; i < 
lše_Ën
; i++) {

233 ià(!
	`is¥aû
 (
lše
[
i
]))

236 
	`¡ºıy
 (
¡Üe_²
, 
lše
 + 
i
,

237 
PCI_IDS_MAX_LINE_LEN
);

238 *
´oduù_Çme
 = 
¡Üe_²
;

245 ià(!
v’dÜ_m©ched
 || !
´oduù_m©ched
)

249 ià(
subsys_v’dÜ_id
 != 0

250 && 
subsys_´oduù_id
 != 0) {

251 ià(
	`memcmp
 (
lše
 + 2, 
»p_svi
, 4) == 0

252 && 
	`memcmp
 (
lše
 + 7, 
»p_¥i
,

255 
i
 = 11; i < 
lše_Ën
; i++) {

256 ià(!
	`is¥aû
 (
lše
[
i
]))

259 
	`¡ºıy
 (
¡Üe_¥n
, 
lše
 + 
i
,

260 
PCI_IDS_MAX_LINE_LEN
);

261 *
subsys_´oduù_Çme
 = 
¡Üe_¥n
;

272 
	}
}

284 
dbus_boŞ_t


285 
	$pci_ids_lßd
 (cÚ¡ *
·th
)

287 
fd
;

288 
¡©
 
¡©buf
;

289 
gboŞ—n
 
»t
;

291 
»t
 = 
FALSE
;

293 ià(
	`¡©
 (
·th
, &
¡©buf
) != 0) {

294 
	`HAL_WARNING
 (("Couldn'ˆ¡©…ci.id f'%s',ƒ¼no=%d: %s", 
·th
, 
”ºo
, 
	`¡»¼Ü
 (errno)));

295 
out
;

297 
pci_ids_Ën
 = 
¡©buf
.
¡_size
;

299 
fd
 = 
	`İ’
 (
·th
, 
O_RDONLY
);

300 ià(
fd
 < 0) {

301 
	`HAL_WARNING
 (("Couldn'ˆİ’…ci.id f'%s',ƒ¼no=%d: %s", 
·th
, 
”ºo
, 
	`¡»¼Ü
 (errno)));

302 
out
;

305 
pci_ids
 = 
	`mm­
 (
NULL
, 
pci_ids_Ën
, 
PROT_READ
, 
MAP_SHARED
, 
fd
, 0);

306 ià(
pci_ids
 =ğ
MAP_FAILED
) {

307 
	`HAL_WARNING
 (("Couldn'ˆmm­…ci.id f'%s',ƒ¼no=%d: %s", 
·th
, 
”ºo
, 
	`¡»¼Ü
 (errno)));

308 
	`şo£
 (
fd
);

309 
out
;

312 
»t
 = 
TRUE
;

314 
	`şo£
 (
fd
);

315 
out
:

316  
»t
;

317 
	}
}

320 
	$pci_ids_š™
 ()

323 
	`pci_ids_lßd
 (
PCI_IDS_DIR
 "/pci.ids");

324 
	}
}

330 #ifdeà
USE_USB_IDS


332 *
	gusb_ids
 = 
NULL
;

335 
size_t
 
	gusb_ids_Ën
;

338 
size_t
 
	gusb_ids_™”_pos
;

342 
	$usb_ids_lše_™”_š™
 ()

344 
usb_ids_™”_pos
 = 0;

345 
	}
}

348 
	#USB_IDS_MAX_LINE_LEN
 512

	)

360 
	$usb_ids_lše_™”_g‘_lše
 (*
lše_Ën
)

362 
i
;

363 
lše
[
USB_IDS_MAX_LINE_LEN
];

365 
i
 = 0;

366 
usb_ids_™”_pos
 < 
usb_ids_Ën
 &&

367 
i
 < 
USB_IDS_MAX_LINE_LEN
 - 1 &&

368 
usb_ids
[
usb_ids_™”_pos
] !ğ'\n'; 
i
++, usb_ids_iter_pos++) {

369 
lše
[
i
] = 
usb_ids
[
usb_ids_™”_pos
];

372 
lše
[
i
] = '\0';

373 ià(
lše_Ën
 !ğ
NULL
)

374 *
lše_Ën
 = 
i
;

376 
usb_ids_™”_pos
++;

378  
lše
;

379 
	}
}

388 
dbus_boŞ_t


389 
	$usb_ids_lše_™”_has_mÜe
 ()

391  
usb_ids_™”_pos
 < 
usb_ids_Ën
;

392 
	}
}

407 
	$ids_fšd_usb
 (
v’dÜ_id
, 
´oduù_id
,

408 **
v’dÜ_Çme
, **
´oduù_Çme
)

410 *
lše
;

411 
i
;

412 
lše_Ën
;

413 
num_bs
;

414 
»p_vi
[8];

415 
»p_pi
[8];

416 
¡Üe_vn
[
USB_IDS_MAX_LINE_LEN
];

417 
¡Üe_²
[
USB_IDS_MAX_LINE_LEN
];

418 
dbus_boŞ_t
 
v’dÜ_m©ched
 = 
FALSE
;

420 
	`¢´štf
 (
»p_vi
, 8, "%04x", 
v’dÜ_id
);

421 
	`¢´štf
 (
»p_pi
, 8, "%04x", 
´oduù_id
);

423 *
v’dÜ_Çme
 = 
NULL
;

424 *
´oduù_Çme
 = 
NULL
;

426 
	`usb_ids_lše_™”_š™
 (); 
	`usb_ids_lše_™”_has_mÜe
 ();) {

427 
lše
 = 
	`usb_ids_lše_™”_g‘_lše
 (&
lše_Ën
);

430 ià(
lše_Ën
 < 4)

434 ià(
lše
[0] == '#')

438 
num_bs
 = 0;

439 
i
 = 0; i < 
lše_Ën
; i++) {

440 ià(
lše
[
i
] != '\t')

442 
num_bs
++;

445 
num_bs
) {

448 
v’dÜ_m©ched
 = 
FALSE
;

451 ià(
v’dÜ_id
 != 0) {

452 ià(
	`memcmp
 (
lše
, 
»p_vi
, 4) == 0) {

454 
v’dÜ_m©ched
 = 
TRUE
;

456 
i
 = 4; i < 
lše_Ën
; i++) {

457 ià(!
	`is¥aû
 (
lše
[
i
]))

460 
	`¡ºıy
 (
¡Üe_vn
, 
lše
 + 
i
,

461 
USB_IDS_MAX_LINE_LEN
);

462 *
v’dÜ_Çme
 = 
¡Üe_vn
;

469 ià(!
v’dÜ_m©ched
)

473 ià(
´oduù_id
 != 0) {

474 ià(
	`memcmp
 (
lše
 + 1, 
»p_pi
, 4) == 0) {

476 
i
 = 5; i < 
lše_Ën
; i++) {

477 ià(!
	`is¥aû
 (
lše
[
i
]))

480 
	`¡ºıy
 (
¡Üe_²
, 
lše
 + 
i
,

481 
USB_IDS_MAX_LINE_LEN
);

482 *
´oduù_Çme
 = 
¡Üe_²
;

495 
	}
}

505 
dbus_boŞ_t


506 
	$usb_ids_lßd
 (cÚ¡ *
·th
)

508 
fd
;

509 
¡©
 
¡©buf
;

510 
gboŞ—n
 
»t
;

512 
»t
 = 
FALSE
;

514 ià(
	`¡©
 (
·th
, &
¡©buf
) != 0) {

515 
	`HAL_WARNING
 (("Couldn'ˆ¡© usb.id f'%s',ƒ¼no=%d: %s", 
·th
, 
”ºo
, 
	`¡»¼Ü
 (errno)));

516 
out
;

518 
usb_ids_Ën
 = 
¡©buf
.
¡_size
;

520 
fd
 = 
	`İ’
 (
·th
, 
O_RDONLY
);

521 ià(
fd
 < 0) {

522 
	`HAL_WARNING
 (("Couldn'ˆİ’ usb.id f'%s',ƒ¼no=%d: %s", 
·th
, 
”ºo
, 
	`¡»¼Ü
 (errno)));

523 
out
;

526 
usb_ids
 = 
	`mm­
 (
NULL
, 
usb_ids_Ën
, 
PROT_READ
, 
MAP_SHARED
, 
fd
, 0);

527 ià(
usb_ids
 =ğ
MAP_FAILED
) {

528 
	`HAL_WARNING
 (("Couldn'ˆmm­ usb.id f'%s',ƒ¼no=%d: %s", 
·th
, 
”ºo
, 
	`¡»¼Ü
 (errno)));

529 
	`şo£
 (
fd
);

530 
out
;

533 
»t
 = 
TRUE
;

535 
	`şo£
 (
fd
);

536 
out
:

537  
»t
;

538 
	}
}

541 
	$usb_ids_š™
 ()

544 
	`usb_ids_lßd
 (
USB_IDS_DIR
 "/usb.ids");

545 
	}
}

551 #ifdeà
USE_PNP_IDS


559 
	s²p_id
 {

560 cÚ¡ *
	mid
;

561 cÚ¡ *
	mdesc
;

562 } cÚ¡ 
	g²p_ids_li¡
[] = {

972 
	$ids_comp_²p
(cÚ¡ *
id1
, cÚ¡ *
id2
) {

973 
²p_id
 *
²p_id1
 = (²p_id *è
id1
;

974 
²p_id
 *
²p_id2
 = (²p_id *è
id2
;

975  
	`¡rÿ£cmp
(
²p_id1
->
id
, 
²p_id2
->id);

976 
	}
}

979 
	$ids_fšd_²p
 (cÚ¡ *
²p_id
, **
²p_desütiÚ
)

981 
²p_id
 
£¬ch
, *
»s
;

983 
£¬ch
.
id
 = (*è
²p_id
;

984 
»s
 = 
	`b£¬ch
(&
£¬ch
, 
²p_ids_li¡
, (pnp_ids_list)/(pnp_ids_list[0]),

985 (
²p_id
), 
ids_comp_²p
);

987 ià(
»s
 !ğ
NULL
)

988 *
²p_desütiÚ
 = (*è
»s
->
desc
;

990 *
²p_desütiÚ
 = 
NULL
;

992 
	}
}

999 
	$ids_š™
 ()

1001 
	`pci_ids_š™
 ();

1002 
	`usb_ids_š™
 ();

1003 
	}
}

	@hald/ids.h

26 #iâdeà
IDS_H


27 
	#IDS_H


	)

29 
	~<glib.h
>

31 #ifdeà
USE_PCI_IDS


33 
pci_ids_š™
 ();

36 
ids_fšd_pci
 (
v’dÜ_id
, 
´oduù_id
,

37 
subsys_v’dÜ_id
, 
subsys_´oduù_id
,

38 **
v’dÜ_Çme
, **
´oduù_Çme
,

39 **
subsys_v’dÜ_Çme
, **
subsys_´oduù_Çme
);

42 
šlše
 
	$pci_ids_š™
 (è{;
	}
};

44 
šlše
 

45 
	$ids_fšd_pci
 (
v’dÜ_id
, 
´oduù_id
,

46 
subsys_v’dÜ_id
, 
subsys_´oduù_id
,

47 **
v’dÜ_Çme
, **
´oduù_Çme
,

48 **
subsys_v’dÜ_Çme
, **
subsys_´oduù_Çme
) {

49 *
v’dÜ_Çme
 = 
NULL
;

50 *
´oduù_Çme
 = 
NULL
;

51 *
subsys_v’dÜ_Çme
 = 
NULL
;

52 *
subsys_´oduù_Çme
 = 
NULL
;

54 
	}
}

57 #ifdeà
USE_PNP_IDS


60 
ids_fšd_²p
 (cÚ¡ *
²p_id
, **
²p_desütiÚ
);

63 
šlše
 

64 
	$ids_fšd_²p
 (cÚ¡ *
²p_id
, **
²p_desütiÚ
) {

65 *
²p_desütiÚ
 = 
NULL
;

67 
	}
}

70 #ifdeà
USE_USB_IDS


72 
usb_ids_š™
 ();

75 
ids_fšd_usb
 (
v’dÜ_id
, 
´oduù_id
,

76 **
v’dÜ_Çme
, **
´oduù_Çme
);

79 
šlše
 
	$usb_ids_š™
 (è{;
	}
}

80 
šlše
 

81 
	$ids_fšd_usb
 (
v’dÜ_id
, 
´oduù_id
,

82 **
v’dÜ_Çme
, **
´oduù_Çme
) {

83 *
v’dÜ_Çme
 = 
NULL
;

84 *
´oduù_Çme
 = 
NULL
;

86 
	}
}

89 
ids_š™
 ();

	@hald/linux/acpi.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

30 
	~"../deviû_šfo.h
"

31 
	~"../deviû_pm.h
"

32 
	~"../h®d_dbus.h
"

33 
	~"../logg”.h
"

34 
	~"../ut.h
"

35 
	~"../ut_pm.h
"

37 
	~"os¥ec_lšux.h
"

39 
	~"aıi.h
"

40 
	~"deviû.h
"

43 
	mACPI_TYPE_BATTERY
,

44 
	mACPI_TYPE_PROCESSOR
,

45 
	mACPI_TYPE_FAN
,

46 
	mACPI_TYPE_AC_ADAPTER
,

47 
	mACPI_TYPE_TOSHIBA_DISPLAY
,

48 
	mACPI_TYPE_ASUS_DISPLAY
,

49 
	mACPI_TYPE_IBM_DISPLAY
,

50 
	mACPI_TYPE_PANASONIC_DISPLAY
,

51 
	mACPI_TYPE_SONY_DISPLAY
,

52 
	mACPI_TYPE_OMNIBOOK_DISPLAY
,

53 
	mACPI_TYPE_SONYPI_DISPLAY
,

54 
	mACPI_TYPE_BUTTON


57 
	#ACPI_POLL_INTERVAL
 30

	)

59 
	sACPIDevHªdËr_s


61 
	maıi_ty³
;

62 
	mH®Deviû
 *(*
	madd
è(cÚ¡ 
gch¬
 *
	maıi_·th
, 
H®Deviû
 *
	m·»Á
, 
ACPIDevHªdËr_s
 *
	mhªdËr
);

63 
gboŞ—n
 (*
compu‹_udi
è(
H®Deviû
 *
	md
, 
ACPIDevHªdËr_s
 *
	mhªdËr
);

64 
gboŞ—n
 (*
»move
è(
H®Deviû
 *
	md
, 
ACPIDevHªdËr_s
 *
	mhªdËr
);

65 
gboŞ—n
 (*
»äesh
è(
H®Deviû
 *
	md
, 
ACPIDevHªdËr_s
 *
	mhªdËr
, gboŞ—À
	mfÜû_fuÎ_»äesh
);

66 } 
	tACPIDevHªdËr
;

75 
	$ac_ad­‹r_»äesh_pŞl
 (
H®Deviû
 *
d
)

77 cÚ¡ *
·th
;

78 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.acpi_path");

79 ià(
·th
 =ğ
NULL
)

81 
	`h®_ut_£t_boŞ_–em_äom_fe
 (
d
, "ac_ad­‹r.´e£Á", 
·th
, "¡©e", "¡©e", 0, "Ú-lše", 
FALSE
);

82 
	}
}

85 
	$b©‹ry_»äesh_pŞl
 (
H®Deviû
 *
d
)

87 cÚ¡ *
·th
;

88 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.acpi_path");

89 ià(
·th
 =ğ
NULL
)

92 
	`h®_ut_£t_boŞ_–em_äom_fe
 (
d
, "b©‹ry.»ch¬g—bË.is_ch¬gšg", 
·th
,

93 "¡©e", "ch¬gšg s‹", 0, "ch¬gšg", 
TRUE
);

94 
	`h®_ut_£t_boŞ_–em_äom_fe
 (
d
, "b©‹ry.»ch¬g—bË.is_disch¬gšg", 
·th
,

95 "¡©e", "ch¬gšg s‹", 0, "disch¬gšg", 
TRUE
);

96 
	`h®_ut_£t_¡ršg_–em_äom_fe
 (
d
, "b©‹ry.ch¬ge_Ëv–.ÿ·c™y_¡©e", 
·th
,

97 "¡©e", "ÿ·c™y s‹", 0, 
TRUE
);

102 ià(!
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "b©‹ry.»pÜtšg.cu¼’t", 
·th
,

103 "¡©e", "»maššg c­ac™y", 0, 10, 
TRUE
))

104 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "battery.reporting.current", 0);

105 ià(!
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "b©‹ry.»pÜtšg.¿‹", 
·th
,

106 "¡©e", "´e£Á„©e", 0, 10, 
TRUE
))

107 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "battery.reporting.rate", 0);

112 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "b©‹ry.vŞge.cu¼’t", 
·th
,

113 "¡©e", "´e£Á vŞge", 0, 10, 
TRUE
);

118 
	`deviû_pm_ab¡¿ù_´İs
 (
d
);

121 
	`deviû_pm_ÿlcuÏ‹_³rûÁage
 (
d
);

124 
	`deviû_pm_ÿlcuÏ‹_time
 (
d
);

125 
	}
}

137 
gboŞ—n


138 
	$b©‹ry_pŞl_šäequ’y
 (
gpoš‹r
 
d©a
) {

140 
GSLi¡
 *
i
;

141 
GSLi¡
 *
b©‹ry_deviûs
;

142 
H®Deviû
 *
d
;

143 cÚ¡ *
·th
;

145 
b©‹ry_deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

149 
i
 = 
b©‹ry_deviûs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

150 
d
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

151 ià(
	`h®_deviû_has_´İ”ty
 (
d
, "linux.acpi_type") &&

152 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "battery.present")) {

153 
	`h®_ut_g»p_disÿrd_exi¡šg_d©a
 ();

154 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

155 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.acpi_path");

156 ià(
·th
 !ğ
NULL
)

157 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "b©‹ry.»pÜtšg.Ï¡_fuÎ", 
·th
,

158 "šfo", "Ï¡ fuÎ c­ac™y", 0, 10, 
TRUE
);

159 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

163 
	`g_¦i¡_ä“
 (
b©‹ry_deviûs
);

164  
TRUE
;

165 
	}
}

177 
gboŞ—n


178 
	$aıi_pŞl_b©‹ry
 ()

180 
GSLi¡
 *
i
;

181 
GSLi¡
 *
b©‹ry_deviûs
;

182 
H®Deviû
 *
d
;

184 
b©‹ry_deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

191 
i
 = 
b©‹ry_deviûs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

192 
d
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

193 ià(
	`h®_deviû_has_´İ”ty
 (
d
, "linux.acpi_type") &&

194 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "battery.present")) {

195 
	`h®_ut_g»p_disÿrd_exi¡šg_d©a
 ();

196 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

197 
	`b©‹ry_»äesh_pŞl
 (
d
);

198 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

202 
	`g_¦i¡_ä“
 (
b©‹ry_deviûs
);

203  
TRUE
;

204 
	}
}

215 
gboŞ—n


216 
	$aıi_pŞl_aÿd­
 ()

218 
GSLi¡
 *
i
;

219 
GSLi¡
 *
aÿd­_deviûs
;

220 
H®Deviû
 *
d
;

222 
aÿd­_deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

229 
i
 = 
aÿd­_deviûs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

230 
d
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

231 ià(
	`h®_deviû_has_´İ”ty
 (
d
, "linux.acpi_type")) {

232 
	`h®_ut_g»p_disÿrd_exi¡šg_d©a
 ();

233 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

234 
	`ac_ad­‹r_»äesh_pŞl
 (
d
);

235 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

238 
	`g_¦i¡_ä“
 (
aÿd­_deviûs
);

239  
TRUE
;

240 
	}
}

253 
gboŞ—n


254 
	$aıi_pŞl
 (
gpoš‹r
 
d©a
)

260 
	`aıi_pŞl_aÿd­
 ();

261 
	`aıi_pŞl_b©‹ry
 ();

262  
TRUE
;

263 
	}
}

265 
gboŞ—n


266 
	$ac_ad­‹r_»äesh
 (
H®Deviû
 *
d
, 
ACPIDevHªdËr
 *
hªdËr
, 
gboŞ—n
 
fÜû_fuÎ_»äesh
)

268 cÚ¡ *
·th
;

269 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.acpi_path");

270 ià(
·th
 =ğ
NULL
)

271  
FALSE
;

273 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

275 ià(!
	`h®_deviû_has_ÿ·b™y
 (
d
, "ac_adapter")){

276 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "AC Adapter");

277 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "ac_adapter");

278 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ac_adapter");

281 
	`ac_ad­‹r_»äesh_pŞl
 (
d
);

282 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

285 
	`b©‹ry_pŞl_šäequ’y
 (
NULL
);

293 
	`aıi_pŞl_b©‹ry
 ();

295  
TRUE
;

296 
	}
}

305 
gboŞ—n


306 
	$b©‹ry_»äesh_add
 (
H®Deviû
 *
d
, cÚ¡ *
·th
)

308 
»pÜtšg_design
;

309 
»pÜtšg_w¬nšg
;

310 
»pÜtšg_low
;

311 
»pÜtšg_g¿n1
;

312 
»pÜtšg_g¿n2
;

313 
vŞge_design
;

315 cÚ¡ *
»pÜtšg_un™
;

316 cÚ¡ *
‹chnŞogy
;

318 
	`h®_ut_£t_¡ršg_–em_äom_fe
 (
d
, "b©‹ry.v’dÜ", 
·th
, "info",

319 "OEM info", 0, 
TRUE
);

320 
	`h®_ut_£t_¡ršg_–em_äom_fe
 (
d
, "b©‹ry.mod–", 
·th
, "info",

321 "mod–‚umb”", 
G_MAXUINT
, 
TRUE
);

322 
	`h®_ut_£t_¡ršg_–em_äom_fe
 (
d
, "b©‹ry.£rŸl", 
·th
, "info",

323 "£rŸÈnumb”", 0, 
TRUE
);

324 
	`h®_ut_£t_¡ršg_–em_äom_fe
 (
d
, "b©‹ry.v’dÜ", 
·th
, "info",

325 "OEM info", 0, 
TRUE
);

329 
‹chnŞogy
 = 
	`h®_ut_g»p_¡ršg_–em_äom_fe
 (
·th
, "info",

330 "b©‹ryy³", 0, 
TRUE
);

331 ià(
‹chnŞogy
 !ğ
NULL
) {

332 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.reporting.technology",

333 
‹chnŞogy
);

334 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.technology",

335 
	`ut_g‘_b©‹ry_‹chnŞogy
 (
‹chnŞogy
));

340 
	`h®_ut_£t_¡ršg_–em_äom_fe
 (
d
, "b©‹ry.»pÜtšg.un™", 
·th
,

341 "šfo", "desigÀÿ·c™y", 1, 
TRUE
);

342 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "b©‹ry.»pÜtšg.Ï¡_fuÎ", 
·th
,

343 "šfo", "Ï¡ fuÎ c­ac™y", 0, 10, 
TRUE
);

344 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "b©‹ry.»pÜtšg.design", 
·th
,

345 "šfo", "desigÀÿ·c™y", 0, 10, 
TRUE
);

346 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "b©‹ry.»pÜtšg.w¬nšg", 
·th
,

347 "šfo", "desigÀÿ·c™y w¬nšg", 0, 10, 
TRUE
);

348 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "b©‹ry.»pÜtšg.low", 
·th
,

349 "šfo", "desigÀÿ·c™y†ow", 0, 10, 
TRUE
);

350 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "b©‹ry.»pÜtšg.g¿nuÏr™y_1", 
·th
,

351 "šfo", "ÿ·c™y g¿nuÏr™y 1", 0, 10, 
TRUE
);

352 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "b©‹ry.»pÜtšg.g¿nuÏr™y_2", 
·th
,

353 "šfo", "ÿ·c™y g¿nuÏr™y 2", 0, 10, 
TRUE
);

355 
	`h®_ut_£t_¡ršg_–em_äom_fe
 (
d
, "b©‹ry.vŞge.un™", 
·th
, "info",

356 "desigÀvŞge", 1, 
TRUE
);

357 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "b©‹ry.vŞge.design", 
·th
,

358 "šfo", "desigÀvŞge", 0, 10, 
TRUE
);

363 
»pÜtšg_un™
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "battery.reporting.unit");

364 
»pÜtšg_design
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.reporting.design");

365 
»pÜtšg_w¬nšg
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.reporting.warning");

366 
»pÜtšg_low
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.reporting.low");

367 
»pÜtšg_g¿n1
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.reporting.granularity_1");

368 
»pÜtšg_g¿n2
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.reporting.granularity_2");

370 ià(
»pÜtšg_un™
 && 
	`¡rcmp
 (reporting_unit, "mAh") == 0) {

371 
vŞge_design
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "battery.voltage.design");

374 ià(
vŞge_design
 <= 0)

375 
vŞge_design
 = 1000; ;

378 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "battery.charge_level.design",

379 (
»pÜtšg_design
 * 
vŞge_design
) / 1000);

380 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "battery.charge_level.warning",

381 (
»pÜtšg_w¬nšg
 * 
vŞge_design
) / 1000);

382 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "battery.charge_level.low",

383 (
»pÜtšg_low
 * 
vŞge_design
) / 1000);

384 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "battery.charge_level.granularity_1",

385 (
»pÜtšg_g¿n1
 * 
vŞge_design
) / 1000);

386 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "battery.charge_level.granularity_2",

387 (
»pÜtšg_g¿n2
 * 
vŞge_design
) / 1000);

390 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.charge_level.unit", "mWh");

394 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.design", 
»pÜtšg_design
);

395 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.w¬nšg", 
»pÜtšg_w¬nšg
);

396 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.low", 
»pÜtšg_low
);

397 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.g¿nuÏr™y_1", 
»pÜtšg_g¿n1
);

398 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.g¿nuÏr™y_2", 
»pÜtšg_g¿n2
);

401 ià(
»pÜtšg_un™
 && 
	`¡rcmp
 (reporting_unit, "mWh") == 0) {

402 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.charge_level.unit", "mWh");

405 
	`HAL_WARNING
 (("Unknown ACPI Unit!"));

406 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.charge_level.unit", "unknown");

411 ià(
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "b©‹ry.®¬m.design", 
·th
,

412 "®¬m", "®¬m", 0, 10, 
TRUE
))

413 
	`h®_ut_£t_¡ršg_–em_äom_fe
 (
d
, "b©‹ry.®¬m.un™", 
·th
, "alarm",

414 "®¬m", 1, 
TRUE
);

417 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.is_»ch¬g—bË", 
TRUE
);

420 
	`deviû_pm_ab¡¿ù_´İs
 (
d
);

422  
TRUE
;

423 
	}
}

434 
gboŞ—n


435 
	$b©‹ry_»äesh
 (
H®Deviû
 *
d
, 
ACPIDevHªdËr
 *
hªdËr
, 
gboŞ—n
 
fÜû_fuÎ_»äesh
)

437 cÚ¡ *
·th
;

439 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.acpi_path");

440 ià(
·th
 =ğ
NULL
)

441  
FALSE
;

443 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Battery Bay");

444 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.type", "primary");

445 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "battery");

446 
	`h®_deviû_add_ÿ·b™y
 (
d
, "battery");

449 
	`h®_ut_g»p_disÿrd_exi¡šg_d©a
 ();

451 
	`h®_ut_£t_boŞ_–em_äom_fe
 (
d
, "b©‹ry.´e£Á", 
·th
, "¡©e", "´e£Á", 0, "yes", 
TRUE
);

452 ià(!
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "battery.present")) {

454 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

455 
	`deviû_pm_»move_İtiÚ®_´İs
 (
d
);

456 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

459 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

465 ià(
fÜû_fuÎ_»äesh
 || !
	`h®_deviû_has_´İ”ty
 (
d
, "battery.vendor")) {

467 
	`b©‹ry_»äesh_add
 (
d
, 
·th
);

471 
	`b©‹ry_»äesh_pŞl
 (
d
);

473 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

476 
	`aıi_pŞl_aÿd­
 ();

479  
TRUE
;

480 
	}
}

490 
gch¬
 *

491 
	$g‘_´oûssÜ_mod–_Çme
 (
gšt
 
´oc_num
)

493 
gch¬
 *
mod–_Çme
;

495 
gch¬
 *
cÚ‹Ás
 = 
NULL
;

496 
GE¼Ü
 *
”rÜ
 = 
NULL
;

498 
gch¬
 **
lšes
;

500 
gšt
 
´oc_num_i
;

502 
gch¬
 *
cursÜ
;

503 
gšt
 
i
;

506 ià(
	`g_fe_g‘_cÚ‹Ás
 ("/´oc/ıušfo", & 
cÚ‹Ás
, 
NULL
, & 
”rÜ
)) {

507 
lšes
 = 
	`g_¡r¥l™
 (
cÚ‹Ás
, "\n", 0);

509 
i
 = 0; 
lšes
 [i]; ++i) {

510 ià(
	`¡r¡r
 (
lšes
 [
i
], "processor\t:")) {

511 
cursÜ
 = 
	`¡r¡r
 (
lšes
 [
i
], ":");

513 
´oc_num_i
 = 
	`©oi
 (
cursÜ
 + 1);

515 ià(
´oc_num_i
 =ğ
´oc_num
) {

516 ; 
lšes
 [
i
]; ++i) {

517 ià(
	`¡r¡r
 (
lšes
 [
i
], "model‚ame\t:")) {

518 
cursÜ
 = 
	`¡r¡r
 (
lšes
 [
i
], ":");

520 
	`g_¡r¡r
 (++ 
cursÜ
);

522 
mod–_Çme
 = 
	`g_¡rdup
 (
cursÜ
);

524 
	`g_¡rä“v
 (
lšes
);

525 
	`g_ä“
 (
cÚ‹Ás
);

527  
mod–_Çme
;

534 ià(
lšes
) {

535 
	`g_¡rä“v
 (
lšes
);

539 
	`HAL_ERROR
 (("Couldn'ˆİ’ /´oc/ıušfo: %s", 
”rÜ
->
mes§ge
));

541 
	`g_”rÜ_ä“
 (
”rÜ
);

544  
NULL
;

545 
	}
}

547 
gboŞ—n


548 
	$´oûssÜ_»äesh
 (
H®Deviû
 *
d
, 
ACPIDevHªdËr
 *
hªdËr
, 
gboŞ—n
 
fÜû_fuÎ_»äesh
)

550 cÚ¡ *
·th
;

552 
gch¬
 *
mod–_Çme
;

553 
gšt
 
´oc_num
;

555 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.acpi_path");

556 ià(
·th
 =ğ
NULL
)

557  
FALSE
;

559 
´oc_num
 = 
	`h®_ut_g»p_št_–em_äom_fe
 (

560 
·th
, "šfo", "´oûssÜ id", 0, 10, 
FALSE


563 ià((
mod–_Çme
 = 
	`g‘_´oûssÜ_mod–_Çme
 (
´oc_num
))) {

564 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
mod–_Çme
);

566 
	`g_ä“
 (
mod–_Çme
);

569 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Unknown Processor");

571 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "processor");

572 
	`h®_deviû_add_ÿ·b™y
 (
d
, "processor");

573 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "´oûssÜ.numb”", 
·th
,

574 "šfo", "´oûssÜ id", 0, 10, 
FALSE
);

575 
	`h®_ut_£t_boŞ_–em_äom_fe
 (
d
, "´oûssÜ.ÿn_thrÙe", 
·th
,

576 "šfo", "thrÙšg cÚŒŞ", 0, "yes", 
FALSE
);

578  
TRUE
;

579 
	}
}

581 
gboŞ—n


582 
	$çn_»äesh
 (
H®Deviû
 *
d
, 
ACPIDevHªdËr
 *
hªdËr
, 
gboŞ—n
 
fÜû_fuÎ_»äesh
)

584 cÚ¡ *
·th
;

586 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.acpi_path");

587 ià(
·th
 =ğ
NULL
)

588  
FALSE
;

590 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Fan");

591 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "fan");

592 
	`h®_deviû_add_ÿ·b™y
 (
d
, "fan");

593 
	`h®_ut_£t_boŞ_–em_äom_fe
 (
d
, "çn.’abËd", 
·th
,

594 "¡©e", "¡©us", 0, "Ú", 
FALSE
);

595  
TRUE
;

596 
	}
}

603 
gboŞ—n


604 
	$Ï±İ_·Ãl_»äesh
 (
H®Deviû
 *
d
, 
ACPIDevHªdËr
 *
hªdËr
, 
gboŞ—n
 
fÜû_fuÎ_»äesh
)

606 cÚ¡ *
·th
;

607 
aıi_ty³
;

608 *
ty³
 = 
NULL
;

609 *
desc
 = 
NULL
;

610 
br_Ëv–s
 = -1;

612 ià((
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (),

613 "/Üg/ä“desktİ/H®/deviûs/compu‹r_backlight")è!ğ
NULL
)

614  
FALSE
;

616 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.acpi_path");

617 ià(
·th
 =ğ
NULL
)

618  
FALSE
;

620 
aıi_ty³
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.acpi_type");

621 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "laptop_panel");

622 ià(
aıi_ty³
 =ğ
ACPI_TYPE_TOSHIBA_DISPLAY
) {

623 
ty³
 = "toshiba";

624 
desc
 = "Toshiba LCD Panel";

625 
br_Ëv–s
 = 8;

626 } ià(
aıi_ty³
 =ğ
ACPI_TYPE_ASUS_DISPLAY
) {

627 
ty³
 = "asus";

628 
desc
 = "ASUS LCD Panel";

629 
br_Ëv–s
 = 16;

630 } ià(
aıi_ty³
 =ğ
ACPI_TYPE_IBM_DISPLAY
) {

631 
ty³
 = "ibm";

632 
desc
 = "IBM LCD Panel";

633 
br_Ëv–s
 = 8;

634 } ià(
aıi_ty³
 =ğ
ACPI_TYPE_PANASONIC_DISPLAY
) {

635 
ty³
 = "panasonic";

636 
desc
 = "Panasonic LCD Panel";

637 
br_Ëv–s
 = 16;

638 } ià(
aıi_ty³
 =ğ
ACPI_TYPE_SONY_DISPLAY
) {

639 
ty³
 = "sony";

640 
desc
 = "Sony LCD Panel";

641 
br_Ëv–s
 = 8;

642 } ià(
aıi_ty³
 =ğ
ACPI_TYPE_OMNIBOOK_DISPLAY
) {

643 
gch¬
 *
´oc_lcd
;

644 
cu¼’t
 = -1;

645 
max
 = -1;

647 
ty³
 = "omnibook";

648 
desc
 = "Omnibook LCD Panel";

653 
´oc_lcd
 = 
	`h®_ut_g»p_fe
("/´oc/omnibook", "lcd", "LCD brighŠess:", 
FALSE
);

654 
´oc_lcd
 = 
	`g_¡r¡r
 (proc_lcd);

655 ià(
	`ssÿnf
 (
´oc_lcd
, "%d (max v®ue: %d)", &
cu¼’t
, &
max
) == 2) {

656 
br_Ëv–s
 = 
max
 + 1;

658 
br_Ëv–s
 = 11;

660 } ià(
aıi_ty³
 =ğ
ACPI_TYPE_SONYPI_DISPLAY
) {

661 
ty³
 = "sonypi";

662 
desc
 = "Sony LCD Panel";

663 
br_Ëv–s
 = 256;

665 
ty³
 = "unknown";

666 
desc
 = "Unknown LCD Panel";

667 
br_Ëv–s
 = 0;

668 
	`HAL_WARNING
 (("acpi_type‚ot„ecognised!"));

671 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
desc
);

676 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "Ï±İ_·Ãl.acûss_m‘hod", 
ty³
);

681 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "Ï±İ_·Ãl.num_Ëv–s", 
br_Ëv–s
);

682 
	`h®_deviû_add_ÿ·b™y
 (
d
, "laptop_panel");

683  
TRUE
;

684 
	}
}

686 
gboŞ—n


687 
	$bu‰Ú_»äesh
 (
H®Deviû
 *
d
, 
ACPIDevHªdËr
 *
hªdËr
, 
gboŞ—n
 
fÜû_fuÎ_»äesh
)

689 cÚ¡ *
·th
;

690 
gch¬
 *
·»Á_·th
;

691 cÚ¡ 
gch¬
 *
bu‰Ú_ty³
;

693 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.acpi_path");

694 ià(
·th
 =ğ
NULL
)

695  
FALSE
;

697 
·»Á_·th
 = 
	`h®_ut_g‘_·»Á_·th
 (
·th
);

698 
bu‰Ú_ty³
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
·»Á_·th
);

700 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "bu‰Ú.ty³", 
bu‰Ú_ty³
);

702 ià(
	`¡rcmp
 (
bu‰Ú_ty³
, "power") == 0)

703 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Power Button");

704 ià(
	`¡rcmp
 (
bu‰Ú_ty³
, "lid") == 0)

705 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Lid Switch");

706 ià(
	`¡rcmp
 (
bu‰Ú_ty³
, "sleep") == 0)

707 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Sleep Button");

709 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "button");

710 
	`h®_deviû_add_ÿ·b™y
 (
d
, "button");

711 ià(!
	`h®_ut_£t_boŞ_–em_äom_fe
 (
d
, "bu‰Ú.¡©e.v®ue", 
·th
, "¡©e", "¡©e", 0, "şo£d", 
FALSE
)) {

712 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "bu‰Ú.has_¡©e", 
FALSE
);

714 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "bu‰Ú.has_¡©e", 
TRUE
);

717 
	`g_ä“
 (
·»Á_·th
);

719  
TRUE
;

720 
	}
}

730 
	$aıi_syÁhesize_™em
 (cÚ¡ 
gch¬
 *
fuÎ·th
, 
aıi_ty³
)

732 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

733 
	`HAL_INFO
 (("Proûssšg %s", 
fuÎ·th
));

734 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

735 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

736 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_ACPI
;

737 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
aıi
.
aıi_·th
, 
fuÎ·th
,  (hotplug_event->acpi.acpi_path));

738 
hÙ¶ug_ev’t
->
aıi
.
aıi_ty³
 =‡cpi_type;

739 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

740 
	}
}

753 
	$aıi_syÁhesize
 (cÚ¡ 
gch¬
 *
·th
, 
aıi_ty³
, 
gboŞ—n
 
syÁhesize
)

755 cÚ¡ 
gch¬
 *
f
;

756 
gboŞ—n
 
is_Ï±İ
 = 
FALSE
;

757 
GDœ
 *
dœ
;

758 
GE¼Ü
 *
”rÜ
 = 
NULL
;

760 
dœ
 = 
	`g_dœ_İ’
 (
·th
, 0, &
”rÜ
);

761 ià(
dœ
 =ğ
NULL
) {

762 
	`HAL_ERROR
 (("Couldn'ˆİ’ %s: %s", 
·th
, 
”rÜ
->
mes§ge
));

763 
	`g_”rÜ_ä“
 (
”rÜ
);

768 (
f
 = 
	`g_dœ_»ad_Çme
 (
dœ
)è!ğ
NULL
) {

769 
gch¬
 
buf
[
HAL_PATH_MAX
];

772 ià(!
is_Ï±İ
) {

773 iàĞ
aıi_ty³
 =ğ
ACPI_TYPE_BATTERY
 ) {

774 
is_Ï±İ
 = 
TRUE
;

775 } iàĞ
aıi_ty³
 =ğ
ACPI_TYPE_BUTTON
 ) {

776 iàĞ
	`¡rcmp
 (
·th
, "/proc/acpi/button/lid") == 0 )

777 
is_Ï±İ
 = 
TRUE
;

778 } ià(
_have_sysfs_lid_bu‰Ú
) {

779 
is_Ï±İ
 = 
TRUE
;

783 iàĞ
is_Ï±İ
 ) {

784 
H®Deviû
 *
compu‹r
;

786 ià((
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/Üg/ä“desktİ/H®/deviûs/compu‹r")è=ğ
NULL
 &&

787 (
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/Üg/ä“desktİ/H®/deviûs/compu‹r")è=ğ
NULL
) {

788 
	`HAL_ERROR
 (("No computer object?"));

790 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
compu‹r
, "system.formfactor", "laptop");

794 ià(
syÁhesize
) {

795 
	`¢´štf
 (
buf
,  (buf), "%s/%s", 
·th
, 
f
);

796 
	`aıi_syÁhesize_™em
 (
buf
, 
aıi_ty³
);

801 
	`g_dœ_şo£
 (
dœ
);

802 
	}
}

814 
	$aıi_syÁhesize_di¥Ïy
 (*
v’dÜ
, *
di¥Ïy
, 
m‘hod
)

816 
gch¬
 
·th
[
HAL_PATH_MAX
];

817 
	`¢´štf
 (
·th
,  (·th), "/´oc/%s/%s", 
v’dÜ
, 
di¥Ïy
);

822 ià(
	`g_fe_‹¡
 (
·th
, 
G_FILE_TEST_EXISTS
))

823 
	`aıi_syÁhesize_™em
 (
·th
, 
m‘hod
);

824 
	}
}

826 
	gsÚypi_œq_li¡
[] = { 11, 10, 9, 6, 5 };

834 
	$aıi_syÁhesize_sÚypi_di¥Ïy
 ()

836 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

837 
gboŞ—n
 
found
 = 
FALSE
;

838 
gušt
 
i
;

839 
gch¬
 *
·th
;

841 
	`HAL_INFO
 (("Processing sonypi display"));

845 ià(
	`g_fe_‹¡
 ("/´oc/aıi/sÚy/brighŠess", 
G_FILE_TEST_EXISTS
))

850 
i
 = 0; i < 
	`G_N_ELEMENTS
 (
sÚypi_œq_li¡
); i++) {

851 
·th
 = 
	`g_¡rdup_´štf
 ("/´oc/œq/%d/sÚypi", 
sÚypi_œq_li¡
[
i
]);

852 ià(
	`g_fe_‹¡
 (
·th
, 
G_FILE_TEST_IS_DIR
)) {

853 
found
 = 
TRUE
;

856 
	`g_ä“
 (
·th
);

859 ià(!
found
)

862 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

863 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

864 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_ACPI
;

865 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
aıi
.
aıi_·th
, 
·th
,  (hotplug_event->acpi.acpi_path));

866 
hÙ¶ug_ev’t
->
aıi
.
aıi_ty³
 = 
ACPI_TYPE_SONYPI_DISPLAY
;

867 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

869 
	`g_ä“
 (
·th
);

870 
	}
}

881 
gboŞ—n


882 
	$aıi_syÁhesize_hÙ¶ug_ev’ts
 ()

884 
H®Deviû
 *
compu‹r
;

886 ià(!
	`g_fe_‹¡
 ("/´oc/aıi/", 
G_FILE_TEST_IS_DIR
))

887  
FALSE
;

889 ià((
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/Üg/ä“desktİ/H®/deviûs/compu‹r")è=ğ
NULL
 &&

890 (
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/Üg/ä“desktİ/H®/deviûs/compu‹r")è=ğ
NULL
) {

891 
	`HAL_ERROR
 (("No computer object?"));

892  
TRUE
;

896 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
compu‹r
, "power_management.type", "acpi");

897 ià(
	`g_fe_‹¡
 ("/´oc/aıi/šfo", 
G_FILE_TEST_EXISTS
)) {

898 
	`h®_ut_£t_¡ršg_–em_äom_fe
 (
compu‹r
, "power_management.acpi.linux.version",

899 "/´oc/aıi", "šfo", "v”siÚ", 0, 
FALSE
);

901 ià(!
	`h®_ut_£t_¡ršg_äom_fe
 (
compu‹r
, "power_management.acpi.linux.version",

904 
	`h®_ut_£t_¡ršg_–em_äom_fe
 (
compu‹r
, "power_management.acpi.linux.version",

905 "/sys/fœmw¬e/aıi", "šfo", "v”siÚ", 0, 
FALSE
);

909 
	`aıi_syÁhesize
 ("/´oc/aıi/b©‹ry", 
ACPI_TYPE_BATTERY
, 
TRUE
);

911 
	`aıi_syÁhesize
 ("/´oc/aıi/´oûssÜ", 
ACPI_TYPE_PROCESSOR
, 
TRUE
);

913 
	`aıi_syÁhesize
 ("/´oc/aıi/çn", 
ACPI_TYPE_FAN
, 
TRUE
);

915 
	`aıi_syÁhesize
 ("/´oc/aıi/ac_ad­‹r", 
ACPI_TYPE_AC_ADAPTER
, 
TRUE
);

918 
	`aıi_syÁhesize
 ("/´oc/aıi/bu‰Ú/lid", 
ACPI_TYPE_BUTTON
, 
TRUE
);

919 
	`aıi_syÁhesize
 ("/´oc/aıi/bu‰Ú/pow”", 
ACPI_TYPE_BUTTON
, 
TRUE
);

920 
	`aıi_syÁhesize
 ("/´oc/aıi/bu‰Ú/¦“p", 
ACPI_TYPE_BUTTON
, 
TRUE
);

929 
	`aıi_syÁhesize_di¥Ïy
 ("aıi/toshiba", "lcd", 
ACPI_TYPE_TOSHIBA_DISPLAY
);

930 
	`aıi_syÁhesize_di¥Ïy
 ("aıi/asus", "bº", 
ACPI_TYPE_ASUS_DISPLAY
);

931 
	`aıi_syÁhesize_di¥Ïy
 ("aıi/pcc", "brighŠess", 
ACPI_TYPE_PANASONIC_DISPLAY
);

932 
	`aıi_syÁhesize_di¥Ïy
 ("aıi/ibm", "brighŠess", 
ACPI_TYPE_IBM_DISPLAY
);

933 
	`aıi_syÁhesize_di¥Ïy
 ("aıi/sÚy", "brighŠess", 
ACPI_TYPE_SONY_DISPLAY
);

935 
	`aıi_syÁhesize_di¥Ïy
 ("omnibook", "lcd", 
ACPI_TYPE_OMNIBOOK_DISPLAY
);

937 
	`aıi_syÁhesize_sÚypi_di¥Ïy
 ();

940 #ifdeà
HAVE_GLIB_2_14


941 
	`g_timeout_add_£cÚds
 (
ACPI_POLL_INTERVAL
,

942 
aıi_pŞl
,

943 
NULL
);

945 
	`g_timeout_add
 (1000 * 
ACPI_POLL_INTERVAL
,

946 
aıi_pŞl
,

947 
NULL
);

956 
	`g_timeout_add
 (1000 * 
ACPI_POLL_INTERVAL
 * 120,

957 
b©‹ry_pŞl_šäequ’y
,

958 
NULL
);

960  
TRUE
;

961 
	}
}

963 
H®Deviû
 *

964 
	$aıi_g’”ic_add
 (cÚ¡ 
gch¬
 *
aıi_·th
, 
H®Deviû
 *
·»Á
, 
ACPIDevHªdËr
 *
hªdËr
)

966 
H®Deviû
 *
d
;

968 ià(((
hªdËr
->
aıi_ty³
 =ğ
ACPI_TYPE_BATTERY
è|| (hªdËr->aıi_ty³ =ğ
ACPI_TYPE_AC_ADAPTER
)è&& 
_have_sysfs_pow”_suµly
)

969  
NULL
;

971 
d
 = 
	`h®_deviû_Ãw
 ();

972 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.aıi_·th", 
aıi_·th
);

973 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "lšux.aıi_ty³", 
hªdËr
->
aıi_ty³
);

975 ià(
·»Á
 !ğ
NULL
)

976 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á
));

978 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

980 ià(
hªdËr
->
»äesh
 =ğ
NULL
 || !hªdËr->
	`»äesh
 (
d
, hªdËr, 
FALSE
)) {

981 
	`g_objeù_uÄef
 (
d
);

982 
d
 = 
NULL
;

984  
d
;

985 
	}
}

987 
H®Deviû
 *

988 
	$aıi_bu‰Ú_add
 (cÚ¡ 
gch¬
 *
aıi_·th
, 
H®Deviû
 *
·»Á
, 
ACPIDevHªdËr
 *
hªdËr
)

990 *
·»Á_·th
;

991 cÚ¡ *
bu‰Ú_ty³
;

993 
·»Á_·th
 = 
	`h®_ut_g‘_·»Á_·th
 (
aıi_·th
);

994 
bu‰Ú_ty³
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
·»Á_·th
);

995 ià(
	`¡rcmp
 (
bu‰Ú_ty³
, "lid"è=ğ0 && 
_have_sysfs_lid_bu‰Ú
)

996 
out
;

997 ià(
	`¡rcmp
 (
bu‰Ú_ty³
, "pow”"è=ğ0 && 
_have_sysfs_pow”_bu‰Ú
)

998 
out
;

999 ià(
	`¡rcmp
 (
bu‰Ú_ty³
, "¦“p"è=ğ0 && 
_have_sysfs_¦“p_bu‰Ú
)

1000 
out
;

1002 
	`g_ä“
 (
·»Á_·th
);

1003  
	`aıi_g’”ic_add
 (
aıi_·th
, 
·»Á
, 
hªdËr
);

1005 
out
:

1006  
NULL
;

1007 
	}
}

1009 
gboŞ—n


1010 
	$aıi_g’”ic_compu‹_udi
 (
H®Deviû
 *
d
, 
ACPIDevHªdËr
 *
hªdËr
)

1012 
gch¬
 
udi
[256];

1013 
	`h®d_compu‹_udi
 (
udi
,  (udi),

1015 
	`h®_ut_g‘_Ï¡_–em’t
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.acpi_path")));

1016 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

1017  
TRUE
;

1018 
	}
}

1020 
gboŞ—n


1021 
	$aıi_g’”ic_»move
 (
H®Deviû
 *
d
, 
ACPIDevHªdËr
 *
hªdËr
)

1023  
TRUE
;

1024 
	}
}

1027 
ACPIDevHªdËr
 
	gaıidev_hªdËr_b©‹ry
 = {

1028 .
aıi_ty³
 = 
ACPI_TYPE_BATTERY
,

1029 .
	gadd
 = 
aıi_g’”ic_add
,

1030 .
	gcompu‹_udi
 = 
aıi_g’”ic_compu‹_udi
,

1031 .
	g»äesh
 = 
b©‹ry_»äesh
,

1032 .
	g»move
 = 
aıi_g’”ic_»move


1035 
ACPIDevHªdËr
 
	gaıidev_hªdËr_´oûssÜ
 = {

1036 .
aıi_ty³
 = 
ACPI_TYPE_PROCESSOR
,

1037 .
	gadd
 = 
aıi_g’”ic_add
,

1038 .
	gcompu‹_udi
 = 
aıi_g’”ic_compu‹_udi
,

1039 .
	g»äesh
 = 
´oûssÜ_»äesh
,

1040 .
	g»move
 = 
aıi_g’”ic_»move


1043 
ACPIDevHªdËr
 
	gaıidev_hªdËr_çn
 = {

1044 .
aıi_ty³
 = 
ACPI_TYPE_FAN
,

1045 .
	gadd
 = 
aıi_g’”ic_add
,

1046 .
	gcompu‹_udi
 = 
aıi_g’”ic_compu‹_udi
,

1047 .
	g»äesh
 = 
çn_»äesh
,

1048 .
	g»move
 = 
aıi_g’”ic_»move


1051 
ACPIDevHªdËr
 
	gaıidev_hªdËr_Ï±İ_·Ãl_toshiba
 = {

1052 .
aıi_ty³
 = 
ACPI_TYPE_TOSHIBA_DISPLAY
,

1053 .
	gadd
 = 
aıi_g’”ic_add
,

1054 .
	gcompu‹_udi
 = 
aıi_g’”ic_compu‹_udi
,

1055 .
	g»äesh
 = 
Ï±İ_·Ãl_»äesh
,

1056 .
	g»move
 = 
aıi_g’”ic_»move


1059 
ACPIDevHªdËr
 
	gaıidev_hªdËr_Ï±İ_·Ãl_asus
 = {

1060 .
aıi_ty³
 = 
ACPI_TYPE_ASUS_DISPLAY
,

1061 .
	gadd
 = 
aıi_g’”ic_add
,

1062 .
	gcompu‹_udi
 = 
aıi_g’”ic_compu‹_udi
,

1063 .
	g»äesh
 = 
Ï±İ_·Ãl_»äesh
,

1064 .
	g»move
 = 
aıi_g’”ic_»move


1067 
ACPIDevHªdËr
 
	gaıidev_hªdËr_Ï±İ_·Ãl_·ÇsÚic
 = {

1068 .
aıi_ty³
 = 
ACPI_TYPE_PANASONIC_DISPLAY
,

1069 .
	gadd
 = 
aıi_g’”ic_add
,

1070 .
	gcompu‹_udi
 = 
aıi_g’”ic_compu‹_udi
,

1071 .
	g»äesh
 = 
Ï±İ_·Ãl_»äesh
,

1072 .
	g»move
 = 
aıi_g’”ic_»move


1075 
ACPIDevHªdËr
 
	gaıidev_hªdËr_Ï±İ_·Ãl_ibm
 = {

1076 .
aıi_ty³
 = 
ACPI_TYPE_IBM_DISPLAY
,

1077 .
	gadd
 = 
aıi_g’”ic_add
,

1078 .
	gcompu‹_udi
 = 
aıi_g’”ic_compu‹_udi
,

1079 .
	g»äesh
 = 
Ï±İ_·Ãl_»äesh
,

1080 .
	g»move
 = 
aıi_g’”ic_»move


1083 
ACPIDevHªdËr
 
	gaıidev_hªdËr_Ï±İ_·Ãl_sÚy
 = {

1084 .
aıi_ty³
 = 
ACPI_TYPE_SONY_DISPLAY
,

1085 .
	gadd
 = 
aıi_g’”ic_add
,

1086 .
	gcompu‹_udi
 = 
aıi_g’”ic_compu‹_udi
,

1087 .
	g»äesh
 = 
Ï±İ_·Ãl_»äesh
,

1088 .
	g»move
 = 
aıi_g’”ic_»move


1091 
ACPIDevHªdËr
 
	gaıidev_hªdËr_Ï±İ_·Ãl_omnibook
 = {

1092 .
aıi_ty³
 = 
ACPI_TYPE_OMNIBOOK_DISPLAY
,

1093 .
	gadd
 = 
aıi_g’”ic_add
,

1094 .
	gcompu‹_udi
 = 
aıi_g’”ic_compu‹_udi
,

1095 .
	g»äesh
 = 
Ï±İ_·Ãl_»äesh
,

1096 .
	g»move
 = 
aıi_g’”ic_»move


1099 
ACPIDevHªdËr
 
	gaıidev_hªdËr_Ï±İ_·Ãl_sÚypi
 = {

1100 .
aıi_ty³
 = 
ACPI_TYPE_SONYPI_DISPLAY
,

1101 .
	gadd
 = 
aıi_g’”ic_add
,

1102 .
	gcompu‹_udi
 = 
aıi_g’”ic_compu‹_udi
,

1103 .
	g»äesh
 = 
Ï±İ_·Ãl_»äesh
,

1104 .
	g»move
 = 
aıi_g’”ic_»move


1107 
ACPIDevHªdËr
 
	gaıidev_hªdËr_bu‰Ú
 = {

1108 .
aıi_ty³
 = 
ACPI_TYPE_BUTTON
,

1109 .
	gadd
 = 
aıi_bu‰Ú_add
,

1110 .
	gcompu‹_udi
 = 
aıi_g’”ic_compu‹_udi
,

1111 .
	g»äesh
 = 
bu‰Ú_»äesh
,

1112 .
	g»move
 = 
aıi_g’”ic_»move


1115 
ACPIDevHªdËr
 
	gaıidev_hªdËr_ac_ad­‹r
 = {

1116 .
aıi_ty³
 = 
ACPI_TYPE_AC_ADAPTER
,

1117 .
	gadd
 = 
aıi_g’”ic_add
,

1118 .
	gcompu‹_udi
 = 
aıi_g’”ic_compu‹_udi
,

1119 .
	g»äesh
 = 
ac_ad­‹r_»äesh
,

1120 .
	g»move
 = 
aıi_g’”ic_»move


1123 
ACPIDevHªdËr
 *
	gaıi_hªdËrs
[] = {

1124 &
aıidev_hªdËr_b©‹ry
,

1125 &
aıidev_hªdËr_´oûssÜ
,

1126 &
aıidev_hªdËr_çn
,

1127 &
aıidev_hªdËr_bu‰Ú
,

1128 &
aıidev_hªdËr_ac_ad­‹r
,

1129 &
aıidev_hªdËr_Ï±İ_·Ãl_toshiba
,

1130 &
aıidev_hªdËr_Ï±İ_·Ãl_ibm
,

1131 &
aıidev_hªdËr_Ï±İ_·Ãl_·ÇsÚic
,

1132 &
aıidev_hªdËr_Ï±İ_·Ãl_asus
,

1133 &
aıidev_hªdËr_Ï±İ_·Ãl_sÚy
,

1134 &
aıidev_hªdËr_Ï±İ_·Ãl_omnibook
,

1135 &
aıidev_hªdËr_Ï±İ_·Ãl_sÚypi
,

1136 
NULL


1140 
	$aıi_ÿÎouts_add_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

1142 *
’d_tok’
 = (*è
u£rd©a1
;

1144 
	`HAL_INFO
 (("Add c®lout com¶‘ed udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1147 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

1148 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

1150 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1151 
	}
}

1154 
	$aıi_ÿÎouts_»move_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

1156 *
’d_tok’
 = (*è
u£rd©a1
;

1158 
	`HAL_INFO
 (("RemovÿÎout com¶‘ed udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1160 ià(!
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_gdl
 (), 
d
)) {

1161 
	`HAL_WARNING
 (("Error„emoving device"));

1164 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1165 
	}
}

1168 
	$hÙ¶ug_ev’t_begš_add_aıi
 (cÚ¡ 
gch¬
 *
aıi_·th
, 
aıi_ty³
, 
H®Deviû
 *
·»Á
, *
’d_tok’
)

1170 
gušt
 
i
;

1172 
	`HAL_INFO
 (("aıi_add:‡ıi_·th=% aıi_ty³=%d,…¬’t=0x%08x", 
aıi_·th
, 
aıi_ty³
, 
·»Á
));

1174 
i
 = 0; 
aıi_hªdËrs
 [i] !ğ
NULL
; i++) {

1175 
ACPIDevHªdËr
 *
hªdËr
;

1177 
hªdËr
 = 
aıi_hªdËrs
[
i
];

1178 ià(
hªdËr
->
aıi_ty³
 ==‡cpi_type) {

1179 
H®Deviû
 *
d
;

1181 
d
 = 
hªdËr
->
	`add
 (
aıi_·th
, 
·»Á
, handler);

1182 ià(
d
 =ğ
NULL
) {

1184 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1188 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "lšux.hÙ¶ug_ty³", 
HOTPLUG_EVENT_ACPI
);

1191 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
d
);

1194 ià(!
hªdËr
->
	`compu‹_udi
 (
d
, handler)) {

1195 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

1196 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1201 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_INFORMATION
);

1202 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_POLICY
);

1205 
	`h®_ut_ÿÎout_deviû_add
 (
d
, 
aıi_ÿÎouts_add_dÚe
, 
’d_tok’
, 
NULL
);

1211 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1212 
	}
}

1215 
	$hÙ¶ug_ev’t_begš_»move_aıi
 (cÚ¡ 
gch¬
 *
aıi_·th
, 
aıi_ty³
, *
’d_tok’
)

1217 
gušt
 
i
;

1218 
H®Deviû
 *
d
;

1220 
	`HAL_INFO
 (("aıi_»m:‡ıi_·th=% aıi_ty³=%d", 
aıi_·th
, 
aıi_ty³
));

1222 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "lšux.aıi_·th", 
aıi_·th
);

1223 ià(
d
 =ğ
NULL
) {

1224 
	`HAL_WARNING
 (("Couldn'ˆ»movdeviû w™h‡ı˜·th % -‚Ù found", 
aıi_·th
));

1225 
out
;

1228 
i
 = 0; 
aıi_hªdËrs
 [i] !ğ
NULL
; i++) {

1229 
ACPIDevHªdËr
 *
hªdËr
;

1231 
hªdËr
 = 
aıi_hªdËrs
[
i
];

1232 ià(
hªdËr
->
aıi_ty³
 ==‡cpi_type) {

1233 ià(
hªdËr
->
	`»move
 (
d
, handler)) {

1234 
	`h®_ut_ÿÎout_deviû_»move
 (
d
, 
aıi_ÿÎouts_»move_dÚe
, 
’d_tok’
, 
NULL
);

1235 
out2
;

1239 
out
:

1241 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1242 
out2
:

1244 
	}
}

1246 
gboŞ—n


1247 
	$aıi_»sÿn_deviû
 (
H®Deviû
 *
d
)

1249 
gušt
 
i
;

1250 
aıi_ty³
;

1252 
aıi_ty³
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.acpi_type");

1254 
i
 = 0; 
aıi_hªdËrs
 [i] !ğ
NULL
; i++) {

1255 
ACPIDevHªdËr
 *
hªdËr
;

1257 
hªdËr
 = 
aıi_hªdËrs
[
i
];

1258 ià(
hªdËr
->
aıi_ty³
 ==‡cpi_type) {

1259  
hªdËr
->
	`»äesh
 (
d
, hªdËr, 
TRUE
);

1263 
	`HAL_WARNING
 (("Didn'ˆfšd‡„esÿÀhªdË¸fÜ ud˜%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1264  
TRUE
;

1265 
	}
}

1267 
HÙ¶ugEv’t
 *

1268 
	$aıi_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
)

1270 
aıi_ty³
;

1271 cÚ¡ *
aıi_·th
;

1272 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

1274 
aıi_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.acpi_path");

1275 
aıi_ty³
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.acpi_type");

1277 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

1278 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

1279 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_ACPI
;

1280 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
aıi
.
aıi_·th
,‡cpi_path,  (hotplug_event->acpi.acpi_path));

1281 
hÙ¶ug_ev’t
->
aıi
.
aıi_ty³
 =‡cpi_type;

1282  
hÙ¶ug_ev’t
;

1283 
	}
}

1285 
HÙ¶ugEv’t
 *

1286 
	$aıi_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
)

1288 
aıi_ty³
;

1289 cÚ¡ *
aıi_·th
;

1290 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

1292 
aıi_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.acpi_path");

1293 
aıi_ty³
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.acpi_type");

1295 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

1296 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_REMOVE
;

1297 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_ACPI
;

1298 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
aıi
.
aıi_·th
,‡cpi_path,  (hotplug_event->acpi.acpi_path));

1299 
hÙ¶ug_ev’t
->
aıi
.
aıi_ty³
 =‡cpi_type;

1300  
hÙ¶ug_ev’t
;

1301 
	}
}

1304 
	$aıi_check_is_Ï±İ
 (cÚ¡ 
gch¬
 *
aıi_ty³
)

1306 ià(
aıi_ty³
 !ğ
NULL
) {

1308 ià(
	`¡rcmp
 (
aıi_ty³
, "BATTERY") == 0) {

1309 
	`aıi_syÁhesize
 ("/´oc/aıi/b©‹ry", 
ACPI_TYPE_BATTERY
, 
FALSE
);

1310 } ià(
	`¡rcmp
 (
aıi_ty³
, "LID") == 0) {

1311 
	`aıi_syÁhesize
 ("/´oc/aıi/bu‰Ú/lid", 
ACPI_TYPE_BUTTON
, 
FALSE
);

1314 
	}
}

	@hald/linux/acpi.h

23 #iâdeà
ACPI_H


24 
	#ACPI_H


	)

26 
	~"../h®d.h
"

27 
	~"hÙ¶ug.h
"

29 #ifdeà
HAVE_ACPI


30 
gboŞ—n
 
aıi_syÁhesize_hÙ¶ug_ev’ts
 ();

31 
hÙ¶ug_ev’t_begš_add_aıi
 (cÚ¡ 
gch¬
 *
aıi_·th
, 
aıi_ty³
, 
H®Deviû
 *
·»Á
, *
’d_tok’
);

32 
hÙ¶ug_ev’t_begš_»move_aıi
 (cÚ¡ 
gch¬
 *
aıi_·th
, 
aıi_ty³
, *
’d_tok’
);

33 
gboŞ—n
 
aıi_»sÿn_deviû
 (
H®Deviû
 *
d
);

34 
HÙ¶ugEv’t
 *
aıi_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
);

35 
HÙ¶ugEv’t
 *
aıi_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
);

36 
aıi_check_is_Ï±İ
 (cÚ¡ 
gch¬
 *
aıi_ty³
);

38 
šlše
 
gboŞ—n
 
	$aıi_syÁhesize_hÙ¶ug_ev’ts
 (è{ 
FALSE
;
	}
}

39 
šlše
 
	$hÙ¶ug_ev’t_begš_add_aıi
 (cÚ¡ 
gch¬
 *
aıi_·th
, 
aıi_ty³
, 
H®Deviû
 *
·»Á
, *
’d_tok’
è{;
	}
}

40 
šlše
 
	$hÙ¶ug_ev’t_begš_»move_aıi
 (cÚ¡ 
gch¬
 *
aıi_·th
, 
aıi_ty³
, *
’d_tok’
è{;
	}
}

41 
šlše
 
gboŞ—n
 
	$aıi_»sÿn_deviû
 (
H®Deviû
 *
d
è{ 
FALSE
;
	}
}

42 
šlše
 
HÙ¶ugEv’t
 *
	$aıi_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
è{ 
NULL
;
	}
}

43 
šlše
 
HÙ¶ugEv’t
 *
	$aıi_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
è{ 
NULL
;
	}
}

44 
šlše
 
	$aıi_check_is_Ï±İ
 (cÚ¡ 
gch¬
 *
aıi_ty³
è{;
	}
}

	@hald/linux/addons/addon-acpi-buttons-toshiba.c

28 #ifdeà
HAVE_CONFIG_H


29 
	~<cÚfig.h
>

32 
	~"../šput_loÿl.h
"

34 
	~<¡dio.h
>

35 
	~<¡dlib.h
>

36 
	~<¡ršg.h
>

37 
	~<uni¡d.h
>

39 
	~<glib/gmaš.h
>

41 
	~"libh®/libh®.h
"

42 
	~"../../logg”.h
"

45 
	#TOSHIBA_ACPI_KEYS
 "/´oc/aıi/toshiba/keys"

	)

48 
	#TOSHIBA_POLL_FREQ
 250

	)

50 
LibH®CÚ‹xt
 *
	gùx
 = 
NULL
;

51 * 
	gudi
;

59 
	$toshiba_key_æush
 ()

61 
hÙkey_»ady
 = 1;

62 
v®ue
;

63 
FILE
 *
å
 = 
	`fİ’
 (
TOSHIBA_ACPI_KEYS
, "r+");

64 ià(!
å
) {

65 
	`HAL_DEBUG
 (("Could‚Ù o³À%s!", 
TOSHIBA_ACPI_KEYS
));

68 
hÙkey_»ady
) {

69 
	`årštf
 (
å
, "hotkey_ready:0\n");

70 
	`fşo£
 (
å
);

71 
å
 = 
	`fİ’
 (
TOSHIBA_ACPI_KEYS
, "r+");

72 ià(
	`fsÿnf
 (
å
, "hÙkey_»ady: %d\nhÙkey: 0x%4x", &
hÙkey_»ady
, &
v®ue
) < 2)

73 
	`HAL_WARNING
(("W¬nšg: fau» wh·r£ %s", 
TOSHIBA_ACPI_KEYS
));

75 ià(
å
)

76 
	`fşo£
 (
å
);

77 
	}
}

87 
gboŞ—n


88 
	$toshiba_key_»ady
 (*
v®ue
)

90 
FILE
 *
å
 = 
	`fİ’
 (
TOSHIBA_ACPI_KEYS
, "r+");

91 
hÙkey_»ady
 = -1;

93 ià(!
å
)

94  
FALSE
;

96 ià(
	`fsÿnf
 (
å
, "hÙkey_»ady: %1d\nhÙkey: 0x%4x", &
hÙkey_»ady
, 
v®ue
) < 2)

97 
	`HAL_WARNING
 (("W¬nšg: fau» wh·r£ %s", 
TOSHIBA_ACPI_KEYS
));

99 ià(
hÙkey_»ady
) {

100 
	`årštf
 (
å
, "hotkey_ready:0\n");

101 
	`fşo£
 (
å
);

102  
TRUE
;

104 
	`fşo£
 (
å
);

105  
FALSE
;

106 
	}
}

115 
gboŞ—n


116 
	$toshiba_key_pŞl
 ()

118 *
»suÉ
;

119 
v®ue
;

120 
DBusE¼Ü
 
”rÜ
;

121 
	`dbus_”rÜ_š™
 (&
”rÜ
);

124 
	`toshiba_key_»ady
 (&
v®ue
è=ğ
TRUE
) {

125 
»suÉ
 = 
NULL
;

126 ià(
v®ue
 == 0x101)

127 
»suÉ
 = "mute";

128 ià(
v®ue
 == 0x13b)

129 
»suÉ
 = "lock";

130 ià(
v®ue
 == 0x13c)

131 
»suÉ
 = "search";

132 ià(
v®ue
 == 0x13d)

133 
»suÉ
 = "suspend";

134 ià(
v®ue
 == 0x13e)

135 
»suÉ
 = "hibernate";

136 ià(
v®ue
 == 0x140)

137 
»suÉ
 = "brightness-down";

138 ià(
v®ue
 == 0x141)

139 
»suÉ
 = "brightness-up";

140 ià(
v®ue
 == 0x142)

141 
»suÉ
 = "wifi-power";

143 ià(
»suÉ
) {

144 
	`HAL_DEBUG
 (("S’dšg cÚd™iÚ '%s'", 
»suÉ
));

145 
	`libh®_deviû_em™_cÚd™iÚ
 (
ùx
, 
udi
, "Bu‰ÚP»s£d", 
»suÉ
, &
”rÜ
);

146 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

147 
	`HAL_ERROR
 (("FaedØ£nd cÚd™iÚ: %s", 
”rÜ
.
mes§ge
));

148 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

149  
FALSE
;

153  
TRUE
;

154 
	}
}

158 
	$maš
 (
¬gc
, **
¬gv
)

160 
GMašLoİ
 *
loİ
 = 
NULL
;

161 
DBusE¼Ü
 
”rÜ
;

162 
FILE
 *
å
;

164 
	`£tup_logg”
 ();

166 
udi
 = 
	`g‘’v
 ("UDI");

167 ià(
udi
 =ğ
NULL
) {

168 
	`HAL_ERROR
 (("Failedo get UDI"));

171 
	`dbus_”rÜ_š™
 (&
”rÜ
);

172 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

173 
	`HAL_ERROR
 (("UÇbËØš™Ÿli£†ibh® cÚ‹xt: %s", 
”rÜ
.
mes§ge
));

177 
	`dbus_”rÜ_š™
 (&
”rÜ
);

178 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
ùx
, 
udi
, &
”rÜ
)) {

183 
å
 = 
	`fİ’
 (
TOSHIBA_ACPI_KEYS
, "r+");

184 ià(!
å
) {

185 
	`HAL_ERROR
 (("Could‚Ù o³À%s! AbÜtšg.", 
TOSHIBA_ACPI_KEYS
));

188 
	`fşo£
 (
å
);

191 
	`toshiba_key_æush
 ();

194 
	`g_timeout_add
 (
TOSHIBA_POLL_FREQ
, (
GSourûFunc
è
toshiba_key_pŞl
, 
NULL
);

196 
loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

197 
	`g_maš_loİ_run
 (
loİ
);

199 
	}
}

	@hald/linux/addons/addon-acpi.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<”ºo.h
>

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ršg.h
>

33 
	~<sys/sock‘.h
>

34 
	~<sys/ty³s.h
>

35 
	~<sys/un.h
>

36 
	~<uni¡d.h
>

38 
	~"libh®/libh®.h
"

40 
	~"../../logg”.h
"

41 
	~"../../ut_h–³r.h
"

43 #ifdeà
ACPI_PROC


44 
FILE
 *

45 
	$aıi_g‘_ev’t_å_k”Ãl
 ()

47 
FILE
 *
å
 = 
NULL
;

49 
å
 = 
	`fİ’
 ("/proc/acpi/event", "r");

51 ià(
å
 =ğ
NULL
)

52 
	`HAL_ERROR
 (("CªnÙ o³À/´oc/aıi/ev’t: %s", 
	`¡»¼Ü
 (
”ºo
)));

54  
å
;

55 
	}
}

58 #ifdeà
ACPI_ACPID


59 
FILE
 *

60 
	$aıi_g‘_ev’t_å_aıid
 ()

62 
FILE
 *
å
 = 
NULL
;

64 
sockaddr_un
 
addr
;

65 
fd
;

67 ifĞ(
fd
 = 
	`sock‘
 (
AF_UNIX
, 
SOCK_STREAM
, 0)) < 0 ) {

68 
	`HAL_ERROR
 (("CªnÙ c»©sock‘: %s", 
	`¡»¼Ü
 (
”ºo
)));

69  
NULL
;

72 
	`mem£t
 (&
addr
, 0, ‡ddr);

73 
addr
.
sun_çmy
 = 
AF_UNIX
;

74 
	`¡ºıy
 (
addr
.
sun_·th
, "/var/run/acpid.socket", ‡ddr.sun_path);

76 ià(
	`cÚÃù
 (
fd
, (
sockaddr
 *è&
addr
, ‡ddr) < 0) {

77 
	`HAL_ERROR
 (("CªnÙ cÚÃùØaıid sock‘: %s", 
	`¡»¼Ü
 (
”ºo
)));

78 
	`şo£
 (
fd
);

80 
å
 = 
	`fdİ’
 (
fd
, "r");

82 ià(
å
 =ğ
NULL
) {

83 
	`HAL_ERROR
 (("fdİ’ faed: %s", 
	`¡»¼Ü
 (
”ºo
)));

84 
	`şo£
 (
fd
);

88  
å
;

89 
	}
}

92 #ifdeà
BUILD_ACPI_IBM


94 
	$hªdË_ibm_aıi_ev’ts
 (
LibH®CÚ‹xt
 *
ùx
, 
ty³
, 
ev’t
)

96 
DBusE¼Ü
 
”rÜ
;

97 
udi
[256];

98 *
bu‰Ú
;

100 
	`dbus_”rÜ_š™
 (&
”rÜ
);

101 
bu‰Ú
 = 
NULL
;

102 
	`¢´štf
 (
udi
,  (udi), "/org/freedesktop/Hal/devices/computer");

104 ià(
ty³
 == 128) {

105 
ev’t
) {

107 
bu‰Ú
 = "Fn+F1";

110 
bu‰Ú
 = "Fn+F2";

113 
bu‰Ú
 = "display_off";

116 
bu‰Ú
 = "sleep";

119 
bu‰Ú
 = "wifi-power";

122 
bu‰Ú
 = "Fn+F6";

125 
bu‰Ú
 = "display_switch";

128 
bu‰Ú
 = "Fn+F8";

131 
bu‰Ú
 = "undock";

134 
bu‰Ú
 = "Fn+F10";

137 
bu‰Ú
 = "Fn+F11";

140 
bu‰Ú
 = "hibernate";

143 
bu‰Ú
 = "Fn+Backspace";

146 
bu‰Ú
 = "Fn+Insert";

149 
bu‰Ú
 = "Fn+Delete";

152 
bu‰Ú
 = "zoom";

155 
bu‰Ú
 = "ThinkPad";

158 
bu‰Ú
 = "tabletpc_rotate_180";

161 
bu‰Ú
 = "tabletpc_rotate_normal";

164 
bu‰Ú
 = "killswitch";

171 ià(
bu‰Ú
) {

172 
	`libh®_deviû_em™_cÚd™iÚ
 (
ùx
, 
udi
, "ButtonPressed",

173 
bu‰Ú
, &
”rÜ
);

174 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
))

175 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

178 
	}
}

182 
	$maš_loİ
 (
LibH®CÚ‹xt
 *
ùx
, 
FILE
 *
ev’tå
)

184 
aıi_num1
;

185 
aıi_num2
;

186 
aıi_·th
[256];

187 
aıi_Çme
[256];

188 
DBusE¼Ü
 
”rÜ
;

189 
ev’t
[256];

191 
	`dbus_”rÜ_š™
 (&
”rÜ
);

193 
	`fg‘s
 (
ev’t
, ƒv’t, 
ev’tå
))

195 
	`HAL_DEBUG
 (("ev’ˆi '%s'", 
ev’t
));

197 ià(
	`ssÿnf
 (
ev’t
, "% % %x %x", 
aıi_·th
, 
aıi_Çme
, &
aıi_num1
, &
aıi_num2
) == 4) {

198 
udi
[256];

200 
	`¢´štf
 (
udi
,  (udi), "/Üg/ä“desktİ/H®/deviûs/aıi_%s", 
aıi_Çme
);

202 #ifdeà
BUILD_ACPI_IBM


203 ià(
	`¡ºcmp
 (
aıi_·th
, "ibm/hotkey",  ("ibm/hotkey") -1) == 0) {

205 
	`hªdË_ibm_aıi_ev’ts
(
ùx
, 
aıi_num1
, 
aıi_num2
);

209 ià(
	`libh®_deviû_exi¡s
(
ùx
, 
udi
, &
”rÜ
)) {

211 ià(
	`¡ºcmp
 (
aıi_·th
, "button",  ("button") - 1) == 0) {

212 *
ty³
;

214 
	`HAL_DEBUG
 (("buttonƒvent"));

217 ià(
	`libh®_deviû_»sÿn
 (
ùx
, 
udi
, &
”rÜ
)) {

218 
ty³
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
(
ùx
, 
udi
,

220 &
”rÜ
);

221 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

222 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

225 ià(
ty³
 !ğ
NULL
) {

226 
	`libh®_deviû_em™_cÚd™iÚ
 (
ùx
, 
udi
, "ButtonPressed",

227 
ty³
, &
”rÜ
);

228 
	`libh®_ä“_¡ršg
(
ty³
);

230 
	`libh®_deviû_em™_cÚd™iÚ
 (
ùx
, 
udi
, "Bu‰ÚP»s£d", "", &
”rÜ
);

233 } ià(
	`¡ºcmp
 (
aıi_·th
, "ac_adapter",  ("ac_adapter") - 1) == 0) {

234 
	`HAL_DEBUG
 (("ac_adapterƒvent"));

235 
	`libh®_deviû_»sÿn
 (
ùx
, 
udi
, &
”rÜ
);

236 } ià(
	`¡ºcmp
 (
aıi_·th
, "battery",  ("battery") - 1) == 0) {

237 
	`HAL_DEBUG
 (("batteryƒvent"));

238 
	`libh®_deviû_»sÿn
 (
ùx
, 
udi
, &
”rÜ
);

243 
	`HAL_DEBUG
 (("cannot…arseƒvent"));

246 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

249 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

253 
	`fşo£
 (
ev’tå
);

254 
	}
}

257 
	$maš
 (
¬gc
, **
¬gv
)

259 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

260 
DBusE¼Ü
 
”rÜ
;

261 
FILE
 *
ev’tå
;

263 
	`h®_£t_´oc_t™Ë_š™
 (
¬gc
, 
¬gv
);

267 #iâdeà
ACPI_PROC


268 
	`drİ_´iveges
 (0);

271 
	`£tup_logg”
 ();

273 
	`dbus_”rÜ_š™
 (&
”rÜ
);

274 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

275 
	`HAL_ERROR
 (("UÇbËØš™Ÿli£†ibh® cÚ‹xt: %s", 
”rÜ
.
mes§ge
));

279 
	`dbus_”rÜ_š™
 (&
”rÜ
);

280 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
ùx
, 
	`g‘’v
 ("UDI"), &
”rÜ
)) {

284 #ifdeà
ACPI_PROC


286 
ev’tå
 = 
	`aıi_g‘_ev’t_å_k”Ãl
 ();

287 
	`drİ_´iveges
 (0);

289 ià(
ev’tå
) {

290 
	`h®_£t_´oc_t™Ë
 ("hald-addon-acpi:†istening on‡cpi kernel interface /proc/acpi/event");

291 
	`maš_loİ
 (
ùx
, 
ev’tå
);

292 
	`HAL_ERROR
 (("Lost connectiono kernel‡cpiƒvent source -ƒxiting"));

299 #ifdeà
ACPI_ACPID


301 ià((
ev’tå
 = 
	`aıi_g‘_ev’t_å_aıid
 ())) {

302 
	`h®_£t_´oc_t™Ë
 ("hald-addon-acpi:†istening on‡cpid socket /var/run/acpid.socket");

303 
	`maš_loİ
 (
ùx
, 
ev’tå
);

304 
	`HAL_DEBUG
 (("Cannot connecto‡cpidƒvent socket -„etry connect"));

310 
	`¦“p
 (5);

312 
	}
}

	@hald/linux/addons/addon-als.c

24 
	#_ISOC99_SOURCE
 1

	)

28 #ifdeà
HAVE_CONFIG_H


29 
	~<cÚfig.h
>

32 
	~<¡dio.h
>

33 
	~<¡d¬g.h
>

34 
	~<¡ršg.h
>

35 
	~<”ºo.h
>

36 
	~<uni¡d.h
>

38 
	~<glib.h
>

39 
	~<dbus/dbus-glib-lowËv–.h
>

41 
	~"libh®/libh®.h
"

42 
	~"../../logg”.h
"

45 
	#ALS_OBJECT
 "/Üg/ä“desktİ/H®/deviûs/®s"

	)

46 
	#ALS_IFACE
 "Üg.ä“desktİ.H®.Deviû.LightS’sÜ"

	)

49 
	#DBUS_BRIGHTNESS_T
 
DBUS_TYPE_INT32


	)

50 
	#BRIGHTNESS_SCAN_CONVERSION_SPECIFIER
 "%d"

	)

51 
	tbrighŠess_t
;

55 cÚ¡ *
	gALS_SYSFS_BRIGHTNESS_TMPL
 =

57 cÚ¡ *
	gALS_SYSFS_BRIGHTNESS_FILE
;

60 
gboŞ—n


61 
	$sÿn_fe
 (cÚ¡ *
f’ame
, cÚ¡ *
fÜm©
, 
ex³ùed_™ems
, ...)

63 
FILE
 *
å
;

64 
sÿÂed_™ems
;

65 
va_li¡
 
­
;

67 
å
 = 
	`fİ’
(
f’ame
, "r");

68 ià(
å
 =ğ
NULL
) {

69 
	`HAL_WARNING
 (("Could‚Ù o³À'%s': %s", 
f’ame
, 
	`¡»¼Ü
(
”ºo
)));

70  
FALSE
;

73 
	`va_¡¬t
 (
­
, 
ex³ùed_™ems
);

74 
sÿÂed_™ems
 = 
	`vfsÿnf
 (
å
, 
fÜm©
, 
­
);

75 
	`va_’d
 (
­
);

77 
	`fşo£
 (
å
);

79  
sÿÂed_™ems
 =ğ
ex³ùed_™ems
;

80 
	}
}

82 
gboŞ—n


83 
	$is_suµÜ‹d
 ()

85 
i
;

86 
f’ame
[100];

88 
i
 = 0; i < 10; i++) {

89 
	`¥rštf
 (
f’ame
, 
ALS_SYSFS_BRIGHTNESS_TMPL
, 
i
);

90 ià(
	`acûss
 (
f’ame
, 
F_OK
) == 0) {

91 
ALS_SYSFS_BRIGHTNESS_FILE
 = 
	`g_¡rdup
(
f’ame
);

92  
TRUE
;

96  
FALSE
;

97 
	}
}

99 
gboŞ—n


100 
	$g‘_brighŠess
 (
brighŠess_t
 *
brighŠess
)

102  
	`sÿn_fe
 (
ALS_SYSFS_BRIGHTNESS_FILE
,

103 
BRIGHTNESS_SCAN_CONVERSION_SPECIFIER
,

104 1, 
brighŠess
);

105 
	}
}

107 
gboŞ—n


108 
	$£nd_dbus_m‘hod_»tuº
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

109 
DBusMes§ge
 *
m‘hod_ÿÎ
,

110 
dbus_ty³
,

111 *
d©a
)

113 
DBusMes§ge
 *
m‘hod_»tuº
;

115 
m‘hod_»tuº
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
m‘hod_ÿÎ
);

116 ià(
m‘hod_»tuº
 =ğ
NULL
) {

117 
	`HAL_WARNING
 (("Out of memory"));

118  
FALSE
;

121 ià(
d©a
 !ğ
NULL
) {

122 
	`dbus_mes§ge_­³nd_¬gs
 (
m‘hod_»tuº
, 
dbus_ty³
, 
d©a
,

123 
DBUS_TYPE_INVALID
);

126 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
m‘hod_»tuº
, 
NULL
)) {

127 
	`HAL_WARNING
(("Could‚ot send method„eturn"));

128  
FALSE
;

131 
	`dbus_cÚÃùiÚ_æush
 (
cÚÃùiÚ
);

132 
	`dbus_mes§ge_uÄef
 (
m‘hod_»tuº
);

134  
TRUE
;

135 
	}
}

137 
DBusHªdËrResuÉ


138 
	$f‹r_dbus
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

139 
DBusMes§ge
 *
mes§ge
,

140 *
u£r_d©a
)

142 
DBusE¼Ü
 
”rÜ
;

143 
DBusHªdËrResuÉ
 
»suÉ
 = 
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

145 
	`dbus_”rÜ_š™
 (&
”rÜ
);

147 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
, 
ALS_IFACE
, "GetBrightness")) {

148 
brighŠess_t
 
brighŠess
;

150 ià(
	`g‘_brighŠess
 (&
brighŠess
)) {

151 
	`£nd_dbus_m‘hod_»tuº
 (
cÚÃùiÚ
, 
mes§ge
,

152 
DBUS_BRIGHTNESS_T
,

153 &
brighŠess
);

154 
»suÉ
 = 
DBUS_HANDLER_RESULT_HANDLED
;

158  
»suÉ
;

159 
	}
}

161 
gboŞ—n


162 
	$š™Ÿlize
 ()

164 
DBusCÚÃùiÚ
 *
cÚÃùiÚ
;

165 
DBusE¼Ü
 
”rÜ
;

166 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

167 cÚ¡ *
udi
;

169 
	`£tup_logg”
 ();

171 
	`dbus_”rÜ_š™
 (&
”rÜ
);

173 
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
);

174 ià(
ùx
 =ğ
NULL
) {

175 
	`HAL_WARNING
 (("Cannot connecto hald"));

176 
»tuº_”rÜ
;

179 
cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
ùx
);

180 ià(
cÚÃùiÚ
 =ğ
NULL
) {

181 
	`HAL_WARNING
 (("Cannot get DBus connection"));

182 
»tuº_”rÜ
;

185 
udi
 = 
	`g‘’v
 ("UDI");

186 ià(
udi
 =ğ
NULL
) {

187 
	`HAL_WARNING
 (("No device specified"));

188 
»tuº_”rÜ
;

191 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
ùx
,

192 
ALS_OBJECT
,

193 
ALS_IFACE
,

197 &
”rÜ
)) {

198 
	`HAL_WARNING
 (("Cannot claim interface"));

199 
»tuº_”rÜ
;

202 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
ùx
, 
udi
, &
”rÜ
)) {

203 
	`HAL_WARNING
 (("Addon‚ot„eady"));

204 
»tuº_”rÜ
;

207 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚÃùiÚ
, 
NULL
);

208 
	`dbus_cÚÃùiÚ_add_f‹r
 (
cÚÃùiÚ
, 
f‹r_dbus
, 
NULL
, NULL);

209 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
 (
cÚÃùiÚ
, 0);

211  
TRUE
;

213 
»tuº_”rÜ
:

214 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

216  
FALSE
;

217 
	}
}

220 
	$maš
 (
¬gc
, * 
¬gv
[])

222 
GMašLoİ
* 
maš_loİ
;

224 ià(!
	`is_suµÜ‹d
 ()) {

225 
	`HAL_ERROR
 (("ALS‚ot supported. Exiting."));

226  
EXIT_FAILURE
;

229 ià(!
	`š™Ÿlize
 ()) {

230  
EXIT_FAILURE
;

233 
maš_loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

234 
	`g_maš_loİ_run
 (
maš_loİ
);

236  
EXIT_SUCCESS
;

237 
	}
}

	@hald/linux/addons/addon-cpufreq-userspace.c

27 
	~<¡dio.h
>

28 
	~<¡dlib.h
>

29 
	~<¡ršg.h
>

30 
	~<”ºo.h
>

31 
	~<uni¡d.h
>

33 
	~"addÚ-ıuäeq.h
"

34 
	~"addÚ-ıuäeq-u£r¥aû.h
"

35 
	~"../../logg”.h
"

39 
	#JUMP_CPUFREQ_LIMIT_MIN
 20

	)

43 
	#THRESHOLD_JUMP_LIMIT_RELATION
 0.625

	)

45 
	#HYSTERESIS
 5

	)

46 
	#DEFAULT_CONSIDER_NICE
 
FALSE


	)

47 
	#PROC_STAT_FILE
 "/´oc/¡©"

	)

49 cÚ¡ 
	gSYSFS_SCALING_SETSPEED_FILE
[] =

52 cÚ¡ 
	gSYSFS_SCALING_AVAILABLE_FREQS_FILE
[] =

56 
	#g_a_i
(
a
,
i
è
	`g_¬¿y_šdex
×, , i)

	)

58 
	su£r¥aû_cÚfig
 {

59 
	mup_th»shŞd
;

60 
	mıu_high_lim™
;

61 
	mcÚsid”_niû
;

62 
	m³rfÜmªû
;

65 
u£r¥aû_cÚfig
 
	gcÚfig
 = { 
UP_THRESHOLD_MAX
,

66 
JUMP_CPUFREQ_LIMIT_MIN
,

67 
DEFAULT_CONSIDER_NICE
,

68 
DEFAULT_PERFORMANCE
 };

71 
	sıulßd_d©a
 {

72 
	mnum_ıus
;

73 *
	mlßd
;

74 *
	mÏ¡_tÙ®_time
;

75 *
	mÏ¡_wÜkšg_time
;

77 
ıulßd_d©a
 
	gıulßd
 = { -1,

78 
NULL
,

79 
NULL
,

80 
NULL
 };

87 
	$ä“_ıu_lßd_d©a
()

89 ià(
ıulßd
.
num_ıus
 != -1) {

90 
	`ä“
(
ıulßd
.
Ï¡_wÜkšg_time
);

91 
	`ä“
(
ıulßd
.
Ï¡_tÙ®_time
);

92 
	`ä“
(
ıulßd
.
lßd
);

93 
ıulßd
.
num_ıus
 = -1;

94 
ıulßd
.
lßd
 = 
NULL
;

95 
ıulßd
.
Ï¡_tÙ®_time
 = 
NULL
;

96 
ıulßd
.
Ï¡_wÜkšg_time
 = 
NULL
;

98 
	}
}

108 
	$ÿlc_ıu_lßd
(cÚ¡ 
cÚsid”_niû
)

110 
tÙ®_–­£d
, 
wÜkšg_–­£d
;

111 
wh©
[32];

112 
u£r_time
, 
niû_time
, 
sy¡em_time
, 
idË_time
;

113 
tÙ®_time
, 
iowa™_time
;

114 
sÿn_»t
;

115 
lše
[256];

116 
ıu_¡ršg
[7];

117 
FILE
 *
å
;

118 
Ãw_num_ıus
, 
i
;

120 
Ãw_num_ıus
 = 
	`syscÚf
(
_SC_NPROCESSORS_CONF
);

121 ià(
Ãw_num_ıus
 =ğ-1 ||‚ew_num_ıu !ğ
ıulßd
.
num_ıus
) {

122 
	`ä“_ıu_lßd_d©a
();

123 
ıulßd
.
num_ıus
 = 
Ãw_num_ıus
;

124 ià(
ıulßd
.
num_ıus
 <= 0) {

125 
”ºo
 = 
ENODEV
;

129 
ıulßd
.
Ï¡_tÙ®_time
 = (*)
	`ÿÎoc
(ıulßd.
num_ıus
 + 1,

131 
ıulßd
.
Ï¡_wÜkšg_time
 = (*)
	`ÿÎoc
(ıulßd.
num_ıus
 + 1,

133 
ıulßd
.
lßd
 = (*)
	`ÿÎoc
(ıulßd.
num_ıus
 + 1, ());

136 ià((
å
 = 
	`fİ’
(
PROC_STAT_FILE
, "r")è=ğ
NULL
) {

137 
	`HAL_DEBUG
(("Could‚Ù o³À%s: %s", 
PROC_STAT_FILE
, 
	`¡»¼Ü
(
”ºo
)));

143 
	`¥rštf
(
ıu_¡ršg
, "cpu ");

145 
i
 = 0; i <ğ
ıulßd
.
num_ıus
 - (cpuload.num_cpus == 1); i++) {

146 
wÜkšg_time
;

148 ià(
	`fg‘s
(
lše
,255,
å
è=ğ
NULL
) {

149 
	`HAL_WARNING
(("% toØshÜˆ(%s)", 
PROC_STAT_FILE
, 
ıu_¡ršg
));

150 
	`fşo£
(
å
);

153 ià(
	`memcmp
(
lše
, 
ıu_¡ršg
, 
	`¡¾’
(cpu_string))) {

154 
	`HAL_WARNING
(("no '%s' string in %s†ine %d",

155 
ıu_¡ršg
, 
PROC_STAT_FILE
, 
i
));

156 
	`fşo£
(
å
);

160 
iowa™_time
 = 0;

161 
sÿn_»t
 = 
	`ssÿnf
(
lše
, "% %lu %lu %lu %lu %lu", 
wh©
, &
u£r_time
, &
niû_time
,

162 &
sy¡em_time
, &
idË_time
, &
iowa™_time
);

163 ià(
sÿn_»t
 < 5) {

164 
	`HAL_WARNING
(("only %d values in %s. Please„eport.",

165 
sÿn_»t
, 
PROC_STAT_FILE
));

166 
	`fşo£
(
å
);

170 ià(
cÚsid”_niû
) {

171 
wÜkšg_time
 = 
u£r_time
 + 
sy¡em_time
 + 
niû_time
;

172 
idË_time
 +ğ
iowa™_time
;

174 
wÜkšg_time
 = 
u£r_time
 + 
sy¡em_time
;

175 
idË_time
 +ğ(
niû_time
 + 
iowa™_time
);

177 
tÙ®_time
 = 
wÜkšg_time
 + 
idË_time
;

178 
tÙ®_–­£d
 = 
tÙ®_time
 - 
ıulßd
.
Ï¡_tÙ®_time
[
i
];

179 
wÜkšg_–­£d
 = 
wÜkšg_time
 - 
ıulßd
.
Ï¡_wÜkšg_time
[
i
];

180 
ıulßd
.
Ï¡_wÜkšg_time
[
i
] = 
wÜkšg_time
;

181 
ıulßd
.
Ï¡_tÙ®_time
[
i
] = 
tÙ®_time
;

183 ià(!
tÙ®_–­£d
) {

185 ià(!
i
)

186 
	`HAL_DEBUG
(("% nÙ upd©ed y‘,…ŞÈ¦ow”.", 
PROC_STAT_FILE
));

188 
ıulßd
.
lßd
[
i
] = 
wÜkšg_–­£d
 * 100 / 
tÙ®_–­£d
;

190 
	`¥rštf
(
ıu_¡ršg
, "ıu%d ", 
i
);

193 ià(
ıulßd
.
num_ıus
 == 1)

194 
ıulßd
.
lßd
[1] = cpuload.load[0];

196 
	`fşo£
(
å
);

199 
	}
}

209 
	$g‘_ıu_lßd
(cÚ¡ 
ıu_id
)

211 ià(
ıu_id
 < -1) {

212 
”ºo
 = 
EINVAL
;

216 ià(
ıulßd
.
lßd
 =ğ
NULL
) {

217 
	`HAL_WARNING
(("cpuload.load uninitialized"));

218 
”ºo
 = 
EFAULT
;

222 ià(
ıu_id
 >ğ
ıulßd
.
num_ıus
) {

223 
”ºo
 = 
ENODEV
;

227  
ıulßd
.
lßd
[
ıu_id
 + 1];

228 
	}
}

232 
gboŞ—n
 
	$wr™e_¥“d
(
kHz
, 
ıu_id
)

234 *
¥“d_fe
 = 
NULL
;

236 ià(!
	`ıu_Úlše
(
ıu_id
))

237  
FALSE
;

239 
¥“d_fe
 = 
	`g_¡rdup_´štf
(
SYSFS_SCALING_SETSPEED_FILE
, 
ıu_id
);

240 if(!
	`wr™e_lše
(
¥“d_fe
, "%u", 
kHz
)){

241 
	`HAL_WARNING
(("Could‚Ù s‘ s³edo: %u kHz; %s", 
kHz
, 
	`¡»¼Ü
(
”ºo
)));

242 
	`g_ä“
(
¥“d_fe
);

243  
FALSE
;

245 
	`g_ä“
(
¥“d_fe
);

246 
	`HAL_DEBUG
(("S³ed s‘o: %uKHz fÜ CPU %d", 
kHz
, 
ıu_id
));

248  
TRUE
;

249 
	}
}

251 
	$»š™_¥“d
(
u£r¥aû_š‹rçû
 *
içû
, 
cu¼’t_¥“d
)

253 ià(!
	`ıu_Úlše
(
içû
->
ba£_ıu
))

256 
	`wr™e_¥“d
(
	`g_a_i
(
içû
->
¥“ds_kHz
, 
cu¼’t_¥“d
), içû->
ba£_ıu
);

257 
	`HAL_DEBUG
(("fÜûd s³edØ%d kHz", 
	`g_a_i
(
içû
->
¥“ds_kHz
, 
cu¼’t_¥“d
)));

258 
	}
}

269 
	$£t_¥“d
(
u£r¥aû_š‹rçû
 *
içû
, 
rg‘_¥“d
)

271 
d–
;

272 
cu¼’t_¥“d
 = 
içû
->current_speed;

274 ià(
cu¼’t_¥“d
 =ğ
rg‘_¥“d
)

277 ià(
cu¼’t_¥“d
 > 
rg‘_¥“d
)

278 
d–
 = -1;

280 
d–
 = 1;

283 
cu¼’t_¥“d
 +ğ
d–
;

284 
	`wr™e_¥“d
(
	`g_a_i
(
içû
->
¥“ds_kHz
, 
cu¼’t_¥“d
), içû->
ba£_ıu
);

285 } 
cu¼’t_¥“d
 !ğ
rg‘_¥“d
);

287  
cu¼’t_¥“d
;

288 
	}
}

301 
	$šü—£_¥“d
(
u£r¥aû_š‹rçû
 *
içû
)

303 
Ãw_¥“d
 = 
içû
->
cu¼’t_¥“d
;

304 
cu¼’t_¥“d
 = 
içû
->current_speed;

306 ià(
cu¼’t_¥“d
 != 0)

307 
Ãw_¥“d
--;

309  
cu¼’t_¥“d
;

310 ià(
cu¼’t_¥“d
 !ğ
Ãw_¥“d
) {

311 
	`HAL_DEBUG
(("cu¼’t: %u‚ew: %u", 
	`g_a_i
(
içû
->
¥“ds_kHz
, 
cu¼’t_¥“d
),

312 
	`g_a_i
(
içû
->
¥“ds_kHz
, 
Ãw_¥“d
)));

313 
	`£t_¥“d
(
içû
, 
Ãw_¥“d
);

315  
Ãw_¥“d
;

316 
	}
}

326 
	$deü—£_¥“d
(
u£r¥aû_š‹rçû
 *
içû
)

328 
Ãw_¥“d
 = 
içû
->
cu¼’t_¥“d
;

329 
cu¼’t_¥“d
 = 
içû
->current_speed;

332 ià(
	`g_a_i
(
içû
->
¥“ds_kHz
, 
Ãw_¥“d
 + 1) != 0)

333 
Ãw_¥“d
++;

335  
cu¼’t_¥“d
;

336 ià(
cu¼’t_¥“d
 !ğ
Ãw_¥“d
) {

337 
	`HAL_DEBUG
(("cu¼’t: %u‚ew: %u", 
	`g_a_i
(
içû
->
¥“ds_kHz
, 
cu¼’t_¥“d
),

338 
	`g_a_i
(
içû
->
¥“ds_kHz
, 
Ãw_¥“d
)));

339 
	`£t_¥“d
(
içû
, 
Ãw_¥“d
);

341  
Ãw_¥“d
;

342 
	}
}

352 
gboŞ—n
 
	$adju¡_¥“d
(
u£r¥aû_š‹rçû
 *
içû
)

354 
GSLi¡
 *
ıus
 = (GSLi¡*)
içû
->cpus;

355 
GSLi¡
 *
™
 = 
NULL
;

356 
ıu_lßd
 = 0;

358 
™
 = 
ıus
; iˆ!ğ
NULL
; iˆğ
	`g_¦i¡_Ãxt
(it)) {

359 
	`HAL_DEBUG
(("checking cpu %d: cpu_core: %d",

360 
	`GPOINTER_TO_INT
(
™
->
d©a
), GPOINTER_TO_INT(it->data)));

361 ià(
	`g‘_ıu_lßd
(
	`GPOINTER_TO_INT
(
™
->
d©a
)è> 
ıu_lßd
)

362 
ıu_lßd
 = 
	`g‘_ıu_lßd
(
	`GPOINTER_TO_INT
(
™
->
d©a
));

365 
	`HAL_DEBUG
(("cpu_max: %d cpu_high_limit: %d consider_nice: %d",

366 
cÚfig
.
up_th»shŞd
, cÚfig.
ıu_high_lim™
,

367 
cÚfig
.
cÚsid”_niû
));

368 
	`HAL_DEBUG
(("Current: %u; current speed: %u MHz",

369 
içû
->
cu¼’t_¥“d
, 
	`g_a_i
(içû->
¥“ds_kHz
, iface->current_speed)));

370 
	`HAL_DEBUG
(("CPU†oad: %d, Previous CPU†oad %d, cpu_load diff: %d,†ast_step: %d, demotion: %u",

371 
ıu_lßd
, 
içû
->
´ev_ıu_lßd
, cpu_lßd - içû->´ev_ıu_lßd, içû->
Ï¡_¡•
,

372 
	`g_a_i
(
içû
->
demÙiÚ
, içû->
cu¼’t_¥“d
)));

375 ià(
cÚfig
.
ıu_high_lim™
 &&

376 (
ıu_lßd
 - 
içû
->
´ev_ıu_lßd
è> 
cÚfig
.
ıu_high_lim™
) {

377 ià(
içû
->
cu¼’t_¥“d
 != 0) {

378 
	`£t_¥“d
(
içû
, 0);

379 
içû
->
cu¼’t_¥“d
 = 0;

380 
	`HAL_DEBUG
(("jumpedo max (%d kHz)",

381 
	`g_a_i
(
içû
->
¥“ds_kHz
, içû->
cu¼’t_¥“d
)));

383 } ià(
ıu_lßd
 > 
cÚfig
.
up_th»shŞd
 && 
içû
->
cu¼’t_¥“d
 > 0) {

384 
içû
->
cu¼’t_¥“d
 = 
	`šü—£_¥“d
(iface);

385 
	`HAL_DEBUG
(("šü—£dØ%d kHz", 
	`g_a_i
(
içû
->
¥“ds_kHz
, içû->
cu¼’t_¥“d
)));

386 } ià(
ıu_lßd
 < ()
	`g_a_i
(
içû
->
demÙiÚ
, içû->
cu¼’t_¥“d
) &&

387 
içû
->
cu¼’t_¥“d
 < içû->
Ï¡_¡•
) {

388 
içû
->
cu¼’t_¥“d
 = 
	`deü—£_¥“d
(iface);

389 
	`HAL_DEBUG
(("deü—£dØ%d kHz", 
	`g_a_i
(
içû
->
¥“ds_kHz
, içû->
cu¼’t_¥“d
)));

391 
	`HAL_DEBUG
(("Speed‚ot changed"));

394 
içû
->
´ev_ıu_lßd
 = 
ıu_lßd
;

395  
TRUE
;

396 
	}
}

399 
	$ü—‹_hy¡”esis_¬¿y
(
u£r¥aû_š‹rçû
 *
içû
)

401 
i
;

403 
	`g_¬¿y_ä“
(
içû
->
demÙiÚ
, 
TRUE
);

404 
içû
->
demÙiÚ
 = 
	`g_¬¿y_Ãw
(
TRUE
, TRUE, ());

406 ià(
içû
->
Ï¡_¡•
 > 0) {

407 
i
 = 0; i < 
içû
->
Ï¡_¡•
; i++) {

408 
demÙiÚ
 = (
cÚfig
.
up_th»shŞd
 - 
HYSTERESIS
) *

409 
	`g_a_i
(
içû
->
¥“ds_kHz
, 
i
 + 1) /

410 
	`g_a_i
(
içû
->
¥“ds_kHz
, 
i
);

411 
	`g_¬¿y_­³nd_v®
(
içû
->
demÙiÚ
, demotion);

412 
	`HAL_DEBUG
(("S³ed: %2u, kHz: %9u, demÙiÚ: %3u %%", 
i
,

413 
	`g_a_i
(
içû
->
¥“ds_kHz
, 
i
), g_a_i(içû->
demÙiÚ
, i)));

416 
	}
}

418 
gboŞ—n
 
	$»ad_äequ’c›s
(
u£r¥aû_š‹rçû
 *
içû
)

420 
num_¥“ds
 = 0;

421 
GSLi¡
 *
™
 = 
NULL
;

422 
GSLi¡
 *
avaabË_äeqs
 = 
NULL
;

423 *
avaabË_äequ’c›s_fe
 = 
NULL
;

425 ià(!
	`ıu_Úlše
(
içû
->
ba£_ıu
))

426  
FALSE
;

428 
avaabË_äequ’c›s_fe
 = 
	`g_¡rdup_´štf
(
SYSFS_SCALING_AVAILABLE_FREQS_FILE
,

429 
içû
->
ba£_ıu
);

430 ià(!
	`»ad_lše_št_¥l™
(
avaabË_äequ’c›s_fe
, " ", &
avaabË_äeqs
)) {

431 
	`g_ä“
(
avaabË_äequ’c›s_fe
);

432  
FALSE
;

434 
	`g_ä“
(
avaabË_äequ’c›s_fe
);

436 ià(
avaabË_äeqs
 =ğ
NULL
) {

437 
içû
->
Ï¡_¡•
 = 0;

438  
FALSE
;

441 
num_¥“ds
 = 0, 
™
 = 
avaabË_äeqs
; iˆ!ğ
NULL
;

442 
num_¥“ds
++, 
™
 = 
	`g_¦i¡_Ãxt
(it)) {

444 
šdex
 = 
	`GPOINTER_TO_UINT
(
™
->
d©a
);

445 
	`g_¬¿y_­³nd_v®
(
içû
->
¥“ds_kHz
, 
šdex
);

447 
	`g_¦i¡_ä“
(
avaabË_äeqs
);

449 
içû
->
Ï¡_¡•
 = 
num_¥“ds
 - 1;

450 
	`HAL_DEBUG
(("Numb” oà¥“ds: %d,†a¡_¡•: %d", 
num_¥“ds
, 
içû
->
Ï¡_¡•
));

452 
	`»š™_¥“d
(
içû
, 0);

454 
	`HAL_DEBUG
(("Available speeds:"));

455 
num_¥“ds
 = 0; 
	`g_a_i
(
içû
->
¥“ds_kHz
,‚um_speeds);‚um_speeds++) {

456 
	`HAL_DEBUG
((" %2u: %9uKHz", 
num_¥“ds
, 
	`g_a_i
(
içû
->
¥“ds_kHz
,‚um_speeds)));

459  
TRUE
;

460 
	}
}

470 
gboŞ—n
 
	$u£r¥aû_adju¡_¥“ds
(
GSLi¡
 *
ıuäeq_objs
)

472 
GSLi¡
 *
™
 = 
NULL
;

474 
	`HAL_DEBUG
(("Adjusting speeds..."));

476 ià((
	`ÿlc_ıu_lßd
(
DEFAULT_CONSIDER_NICE
) < 0)) {

477 
	`HAL_DEBUG
(("calc_cpu_load failed. Cannot‡djust speeds"));

478  
TRUE
;

481 
™
 = 
ıuäeq_objs
; iˆ!ğ
NULL
; iˆğ
	`g_¦i¡_Ãxt
(it)) {

482 
ıuäeq_obj
 *
obj
 = 
™
->
d©a
;

483 
	`adju¡_¥“d
(
obj
->
içû
);

486  
TRUE
;

487 
	}
}

499 
gboŞ—n
 
	$u£r¥aû_š™
(
u£r¥aû_š‹rçû
 *
içû
, 
GSLi¡
 *
ıus
)

501 ià(
içû
 =ğ
NULL
)

502  
FALSE
;

504 
içû
->
demÙiÚ
 = 
	`g_¬¿y_Ãw
(
TRUE
, TRUE, ());

505 
içû
->
¥“ds_kHz
 = 
	`g_¬¿y_Ãw
(
TRUE
, TRUE, ());

506 
içû
->
Ï¡_¡•
 = -1;

507 
içû
->
cu¼’t_¥“d
 = 0;

508 
içû
->
ıus
 = cpus;

509 
içû
->
´ev_ıu_lßd
 = 50;

510 
içû
->
ba£_ıu
 = 
	`GPOINTER_TO_INT
(
ıus
->
d©a
);

512 ià(!
	`wr™e_gov”nÜ
(
USERSPACE_STRING
, 
	`GPOINTER_TO_INT
(
ıus
->
d©a
))) {

513 
	`HAL_WARNING
(("Could‚ot set userspace governor."));

514  
FALSE
;

517 ià(!
	`»ad_äequ’c›s
(
içû
)) {

518 
	`HAL_WARNING
(("Could‚ot„ead‡vailable frequencies"));

519  
FALSE
;

522  
TRUE
;

523 
	}
}

531 
	$u£r¥aû_ä“
(*
d©a
)

533 
u£r¥aû_š‹rçû
 *
içû
 = 
d©a
;

534 
	`ä“_ıu_lßd_d©a
();

535 
	`g_¬¿y_ä“
(
içû
->
¥“ds_kHz
, 
TRUE
);

536 
	`g_¬¿y_ä“
(
içû
->
demÙiÚ
, 
TRUE
);

537 
	}
}

548 
gboŞ—n
 
	$u£r¥aû_£t_³rfÜmªû
(*
d©a
, 
up_th»shŞd
)

550 
u£r¥aû_š‹rçû
 *
içû
 = 
d©a
;

552 
cÚfig
.
up_th»shŞd
 = up_threshold;

554 
cÚfig
.
ıu_high_lim™
 = ()(
up_th»shŞd
 * 
THRESHOLD_JUMP_LIMIT_RELATION
);

555 ià(
cÚfig
.
ıu_high_lim™
 < 
JUMP_CPUFREQ_LIMIT_MIN
)

556 
cÚfig
.
ıu_high_lim™
 = 
JUMP_CPUFREQ_LIMIT_MIN
;

558 
	`HAL_DEBUG
(("cpu_max seto %d, cpu_high_limit seto %d",

559 
cÚfig
.
up_th»shŞd
, cÚfig.
ıu_high_lim™
));

561 
	`ü—‹_hy¡”esis_¬¿y
(
içû
);

563  
TRUE
;

564 
	}
}

573 
	$u£r¥aû_g‘_³rfÜmªû
()

575  
cÚfig
.
up_th»shŞd
;

576 
	}
}

587 
gboŞ—n
 
	$u£r¥aû_£t_cÚsid”_niû
(*
d©a
, 
gboŞ—n
 
cÚsid”
)

589 
	`HAL_DEBUG
(("cÚsid”‚iû s‘Ø%d fÜ u£r¥aû", 
cÚsid”
));

590 
cÚfig
.
cÚsid”_niû
 = 
cÚsid”
;

591  
TRUE
;

592 
	}
}

601 
gboŞ—n
 
	$u£r¥aû_g‘_cÚsid”_niû
()

603  
cÚfig
.
cÚsid”_niû
;

604 
	}
}

	@hald/linux/addons/addon-cpufreq-userspace.h

25 #iâdeà
ADDON_CPUFREQ_USERSPACE_H


26 
	#ADDON_CPUFREQ_USERSPACE_H


	)

28 
	#USERSPACE_STRING
 "u£r¥aû"

	)

29 
	#USERSPACE_POLL_INTERVAL
 333

	)

31 
	su£r¥aû_š‹rçû
 {

32 
	mba£_ıu
;

33 
	mÏ¡_¡•
;

34 
	mcu¼’t_¥“d
;

35 
	mg_sourû_id
;

36 
	m´ev_ıu_lßd
;

37 
GSLi¡
 *
	mıus
;

38 
GA¼ay
 *
	m¥“ds_kHz
;

39 
GA¼ay
 *
	mdemÙiÚ
;

42 
gboŞ—n
 
u£r¥aû_adju¡_¥“ds
 (
GSLi¡
 *
ıuäeq_objs
);

44 
gboŞ—n
 
u£r¥aû_š™
 (
u£r¥aû_š‹rçû
 *
içû
,

45 
GSLi¡
 *
ıus
);

47 
gboŞ—n
 
u£r¥aû_£t_³rfÜmªû
 (*
d©a
,

48 
up_th»shŞd
);

50 
u£r¥aû_g‘_³rfÜmªû
 ();

52 
gboŞ—n
 
u£r¥aû_£t_cÚsid”_niû
 (*
d©a
,

53 
gboŞ—n
 
cÚsid”
);

55 
gboŞ—n
 
u£r¥aû_g‘_cÚsid”_niû
 ();

57 
u£r¥aû_ä“
 (*
d©a
);

59 
ä“_ıu_lßd_d©a
 ();

	@hald/linux/addons/addon-cpufreq.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<glib.h
>

30 
	~<¡ršg.h
>

31 
	~<”ºo.h
>

32 
	~<uni¡d.h
>

33 
	~<sigÇl.h
>

34 
	~<g‘İt.h
>

35 
	~<glib/g´štf.h
>

37 
	~"addÚ-ıuäeq.h
"

38 
	~"addÚ-ıuäeq-u£r¥aû.h
"

39 
	~"libh®/libh®.h
"

40 
	~"../../logg”.h
"

41 
	~"../../ut_h–³r_´iv.h
"

43 
	#MAX_LINE_SIZE
 255

	)

44 
	#CPUFREQ_POLKIT_PRIVILEGE
 "Üg.ä“desktİ.h®.pow”-mªagem’t.ıuäeq"

	)

45 
	#DBUS_INTERFACE
 "Üg.ä“desktİ.H®.Deviû.CPUF»q"

	)

47 
	#CPUFREQ_ERROR_GENERAL
 "G’”®E¼Ü"

	)

48 
	#CPUFREQ_ERROR_UNKNOWN_GOVERNOR
 "UnknownGov”nÜ"

	)

49 
	#CPUFREQ_ERROR_PERMISSION_DENIED
 "P”missiÚD’›d"

	)

50 
	#CPUFREQ_ERROR_NO_SUITABLE_GOVERNOR
 "NoSu™abËGov”nÜ"

	)

51 
	#CPUFREQ_ERROR_GOVERNOR_INIT_FAILED
 "Gov”nÜIn™Faed"

	)

53 cÚ¡ 
	gSYSFS_GOVERNOR_FILE
[] =

56 cÚ¡ 
	gSYSFS_AVAILABLE_GOVERNORS_FILE
[] =

59 cÚ¡ 
	gONDEMAND_UP_THRESHOLD_FILE
[] =

62 cÚ¡ 
	gSYSFS_AFFECTED_CPUS_FILE
[] =

65 cÚ¡ 
	gSYSFS_CPU_ONLINE_FILE
[] =

68 cÚ¡ 
	gONDEMAND_IGNORE_NICE_LOAD_FILE
[] =

71 
gboŞ—n
 
dbus_¿i£_”rÜ
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

72 cÚ¡ *
”rÜ_Çme
, *
fÜm©
, ...);

74 
gboŞ—n
 
dbus_¿i£_no_su™abË_gov”nÜ
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

75 
DBusMes§ge
 *
mes§ge
,

76 *
m‘hod
);

78 
gboŞ—n
 
dbus_¿i£_gov”nÜ_š™_çed
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

79 
DBusMes§ge
 *
mes§ge
,

80 *
gov”nÜ
);

83 
GSLi¡
 *
	gıuäeq_objs
 = 
NULL
;

85 
LibH®CÚ‹xt
 *
	gh®ùx
 = 
NULL
;

87 *
	gudi
 = 
NULL
;

92 
gboŞ—n
 
	$»ad_lše_št
(cÚ¡ *
f’ame
, *
v®
)

94 
lše
[
MAX_LINE_SIZE
 + 1];

96 ià(!
	`»ad_lše
(
f’ame
, 
lše
, 
MAX_LINE_SIZE
)) {

97 
	`HAL_WARNING
(("Could‚Ù„—d from %s", 
f’ame
));

98  
FALSE
;

102 
lše
[
	`¡¾’
(line) - 1] = '\0';

103 *
v®
 = 
	`©oi
(
lše
);

105  
TRUE
;

106 
	}
}

109 
gboŞ—n
 
	$»ad_lše
(cÚ¡ *
f’ame
, *
lše
, 
Ën
)

111 
FILE
 *
å
 = 
	`fİ’
(
f’ame
, "r");

112 ià(!
å
) {

113 
	`HAL_WARNING
(("Could‚Ù o³À'%s': %s", 
f’ame
, 
	`¡»¼Ü
(
”ºo
)));

114  
FALSE
;

116 ià((!
	`fg‘s
(
lše
, 
Ën
, 
å
))) {

117 
	`HAL_WARNING
(("Could‚Ù„—d from '%s': %s", 
f’ame
, 
	`¡»¼Ü
(
”ºo
)));

118 
	`fşo£
(
å
);

119  
FALSE
;

121 
	`fşo£
(
å
);

122  
TRUE
;

123 
	}
}

126 
gboŞ—n
 
	$wr™e_lše
(cÚ¡ *
f’ame
, cÚ¡ *
fmt
, ...)

128 
va_li¡
 
­
;

129 
FILE
 *
å
;

130 
l
;

132 
å
 = 
	`fİ’
(
f’ame
, "w+");

133 ià(!
å
) {

134 
	`HAL_WARNING
(("Could‚Ù o³ÀffÜ wr™šg: %s; %s", 
f’ame
,

135 
	`¡»¼Ü
(
”ºo
)));

136  
FALSE
;

139 
	`va_¡¬t
(
­
, 
fmt
);

140 
l
 = 
	`vårštf
(
å
, 
fmt
, 
­
);

141 
	`va_’d
(
­
);

143 
	`fşo£
(
å
);

145 ià(
l
 < 0) {

146 
	`HAL_WARNING
(("Could‚Ù wr™tØfe: %s", 
f’ame
));

147  
FALSE
;

150  
TRUE
;

151 
	}
}

163 
gch¬
 **
	$»ad_lše_¡r_¥l™
(*
f’ame
, 
gch¬
 *
d–im
)

165 
gch¬
 
lše
[
MAX_LINE_SIZE
];

166 
i
;

167 
gch¬
 **
l
;

169 if(!
	`»ad_lše
(
f’ame
, 
lše
, 
MAX_LINE_SIZE
)) {

170 
	`´štf
("returning NULL from str split\n");

171  
NULL
;

175 
lše
[
	`¡¾’
(line)-1] = '\0';

177 
l
 = 
	`g_¡r¥l™
(
lše
, 
d–im
, 
MAX_LINE_SIZE
);

179 ià(
l
[0] =ğ
NULL
)

180  
NULL
;

182 
i
 = 0; 
l
[i] !ğ
NULL
; i++) {

183 ià(
	`g_¡rÿ£cmp
(
l
[
i
], "") == 0) {

184 
	`ä“
(
l
[
i
]);

185 
l
[
i
] = 
NULL
;

188  
l
;

189 
	}
}

202 
gboŞ—n
 
	$»ad_lše_št_¥l™
(*
f’ame
, 
gch¬
 *
d–im
, 
GSLi¡
 **
li¡
)

204 
gch¬
 **
l
;

205 
i
;

207 
l
 = 
	`»ad_lše_¡r_¥l™
(
f’ame
, 
d–im
);

209 ià(
l
 =ğ
NULL
)

210  
FALSE
;

212 
i
 = 0; 
l
[i] !ğ
NULL
; i++) {

213 
v®ue
 = 
	`©oi
(
l
[
i
]);

214 *
li¡
 = 
	`g_¦i¡_­³nd
(*li¡, 
	`GINT_TO_POINTER
(
v®ue
));

216 
	`g_¡rä“v
(
l
);

217  
TRUE
;

218 
	}
}

221 
	$ıu_li¡_unique
(
gpoš‹r
 
d©a
, gpoš‹¸
whŞe_li¡
)

223 
GSLi¡
 **
li¡
 = (GSLi¡**)
whŞe_li¡
;

224 
GSLi¡
 *
cu¼’t
 = (GSLi¡*)
d©a
;

225 
GSLi¡
 *
™
 = 
NULL
;

227 
™
 = *
li¡
; iˆ!ğ
NULL
; iˆğ
	`g_¦i¡_Ãxt
(it)) {

228 
gboŞ—n
 
equ®
 = 
TRUE
;

229 
GSLi¡
 *
li¡_™
 = 
NULL
;

230 
GSLi¡
 *
cu¼’t_™
 = 
NULL
;

232 ià(
cu¼’t
 =ğ
™
->
d©a
)

235 
li¡_™
 = 
™
->
d©a
, 
cu¼’t_™
 = 
cu¼’t
;

236 
li¡_™
 !ğ
NULL
 && 
cu¼’t_™
 != NULL;

237 
li¡_™
 = 
	`g_¦i¡_Ãxt
Öi¡_™), 
cu¼’t_™
 = g_slist_next(current_it)) {

239 
	`HAL_DEBUG
(("com·ršg %d w™h %d", 
	`GPOINTER_TO_INT
(
cu¼’t_™
->
d©a
),

240 
	`GPOINTER_TO_INT
(
li¡_™
->
d©a
)));

241 ià(
	`GPOINTER_TO_INT
(
cu¼’t_™
->
d©a
è!ğGPOINTER_TO_INT(
li¡_™
->data))

242 
equ®
 = 
FALSE
;

245 
	`HAL_DEBUG
(("equ®? %s, %d", 
equ®
 ? "yes" : "no",ƒqual));

246 ià(
equ®
) {

247 
	`HAL_DEBUG
(("»move: %d", 
	`g_¦i¡_Ëngth
(*
li¡
)));

248 *
li¡
 = 
	`g_¦i¡_»move
(*li¡, 
cu¼’t
);

249 
	`HAL_DEBUG
(("»move_2: %d", 
	`g_¦i¡_Ëngth
(*
li¡
)));

253 
	}
}

256 
gboŞ—n
 
	$g‘_ıu_d•’d’c›s
(
GSLi¡
 **
ıu_li¡
, 
num_ıus
)

258 
i
;

260 
i
 = 0; i < 
num_ıus
; i++) {

261 
GSLi¡
 *
št_ıus
 = 
NULL
;

262 
GSLi¡
 *
afãùed_ıus
 = 
NULL
;

263 
GSLi¡
 *
™
 = 
NULL
;

264 *
afãùed_ıus_fe
 = 
NULL
;

266 
afãùed_ıus_fe
 = 
	`g_¡rdup_´štf
(
SYSFS_AFFECTED_CPUS_FILE
, 
i
);

268 ià(!
	`»ad_lše_št_¥l™
(
afãùed_ıus_fe
, " ", &
afãùed_ıus
)) {

269 
	`g_ä“
(
afãùed_ıus_fe
);

270  
FALSE
;

272 
	`g_ä“
(
afãùed_ıus_fe
);

274 ià(
afãùed_ıus
 =ğ
NULL
)

275  
FALSE
;

277 
™
 = 
afãùed_ıus
; iˆ!ğ
NULL
; iˆğ
	`g_¦i¡_Ãxt
(it)) {

278 
št_ıus
 = 
	`g_¦i¡_­³nd
(int_cpus,

279 
	`GINT_TO_POINTER
(
afãùed_ıus
->
d©a
));

281 
	`g_¦i¡_ä“
(
afãùed_ıus
);

283 ià(!
	`g_¦i¡_Ëngth
(
št_ıus
)) {

284 
	`HAL_WARNING
(("çedØg‘‡fãùed_ıu fÜ cpu %d", 
i
));

288 *
ıu_li¡
 = 
	`g_¦i¡_­³nd
(*ıu_li¡, 
št_ıus
);

291 
	`HAL_DEBUG
(("Numb” oàCPU befÜuniqušg cpu_li¡: %d", 
	`g_¦i¡_Ëngth
(*
ıu_li¡
)));

292 
	`g_¦i¡_fÜ—ch
(*
ıu_li¡
, (
GFunc
)
ıu_li¡_unique
, cpu_list);

293 
	`HAL_DEBUG
(("Numb” oàCPU aá” uniqušg cpu_li¡: %d", 
	`g_¦i¡_Ëngth
(*
ıu_li¡
)));

295 ià(
	`g_¦i¡_Ëngth
(*
ıu_li¡
) == 0)

296  
FALSE
;

297  
TRUE
;

298 
	}
}

301 
gboŞ—n
 
	$ıu_Úlše
(
ıu_id
)

303 
gboŞ—n
 
Úlše
;

304 
Úlše_¡r
[2];

305 *
Úlše_fe
;

307 
Úlše_fe
 = 
	`g_¡rdup_´štf
(
SYSFS_CPU_ONLINE_FILE
, 
ıu_id
);

309 ià(
	`acûss
(
Úlše_fe
, 
F_OK
) < 0) {

310 
Úlše
 = 
TRUE
;

311 
Out
;

314 ià(!
	`»ad_lše
(
Úlše_fe
, 
Úlše_¡r
, 2)) {

315 
	`HAL_WARNING
(("UÇbËØİ’ fe: %s", 
Úlše_fe
));

316 
Úlše
 = 
FALSE
;

317 
Out
;

320 
Úlše
 = 
	`©oi
(
Úlše_¡r
);

322 ià(!
Úlše
)

323 
Úlše
 = 
FALSE
;

324 
Out
:

325 
	`g_ä“
(
Úlše_fe
);

326  
Úlše
;

327 
	}
}

330 
gboŞ—n
 
	$wr™e_gov”nÜ
(*
Ãw_gov”nÜ
, 
ıu_id
)

332 
gboŞ—n
 
»t
 = 
TRUE
;

333 *
gov”nÜ_fe
 = 
NULL
;

334 
gov”nÜ
[
MAX_LINE_SIZE
 + 1];

336 ià(!
	`ıu_Úlše
(
ıu_id
))

337 
Out
;

339 
gov”nÜ_fe
 = 
	`g_¡rdup_´štf
(
SYSFS_GOVERNOR_FILE
, 
ıu_id
);

340 
	`HAL_DEBUG
(("TryšgØwr™gov”nÜ %s", 
Ãw_gov”nÜ
));

342 ià(!
	`wr™e_lše
(
gov”nÜ_fe
, "%s", 
Ãw_gov”nÜ
)) {

343 
»t
 = 
FALSE
;

344 
Out
;

348 
	`»ad_lše
(
gov”nÜ_fe
, 
gov”nÜ
, 
MAX_LINE_SIZE
);

349 ià(
	`¡r¡r
(
gov”nÜ
, 
Ãw_gov”nÜ
))

350 
»t
 = 
TRUE
;

352 
»t
 = 
FALSE
;

353 
Out
:

354 
	`g_ä“
(
gov”nÜ_fe
);

355  
»t
;

356 
	}
}

360 
	#ONDEMAND_STRING
 "Údemªd"

	)

362 
	sÚdemªd_š‹rçû
 {

363 
	mba£_ıu
;

366 
gboŞ—n
 
	$Údemªd_£t_³rfÜmªû
(*
d©a
, 
³rfÜmªû
)

368 
Údemªd_š‹rçû
 *
içû
 = 
d©a
;

369 *
up_th»shŞd_fe
 = 
NULL
;

371 
up_th»shŞd_fe
 = 
	`g_¡rdup_´štf
(
ONDEMAND_UP_THRESHOLD_FILE
,

372 
içû
->
ba£_ıu
);

374 if(!
	`wr™e_lše
(
up_th»shŞd_fe
, "%u", 
³rfÜmªû
)){

375 
	`HAL_WARNING
(("Could‚Ù s‘ up_th»shŞdØ%u kHz; %s", 
³rfÜmªû
,

376 
	`¡»¼Ü
(
”ºo
)));

377 
	`g_ä“
(
up_th»shŞd_fe
);

378  
FALSE
;

380 
	`g_ä“
(
up_th»shŞd_fe
);

381 
	`HAL_DEBUG
(("U°th»shŞd s‘Ø%d fÜ ondemªd", 
³rfÜmªû
));

383  
TRUE
;

384 
	}
}

386 
	$Údemªd_g‘_³rfÜmªû
()

388 *
gov”nÜ_fe
;

389 
³rfÜmªû
 = -1;

391 
gov”nÜ_fe
 = 
	`g_¡rdup_´štf
(
ONDEMAND_UP_THRESHOLD_FILE
, 0);

393 ià(!
	`»ad_lše_št
(
gov”nÜ_fe
, &
³rfÜmªû
)) {

394 
	`HAL_WARNING
(("Could‚ot„ead up_threshold"));

395 
	`g_ä“
(
gov”nÜ_fe
);

398 
	`g_ä“
(
gov”nÜ_fe
);

400  
³rfÜmªû
;

401 
	}
}

403 
gboŞ—n
 
	$Údemªd_£t_cÚsid”_niû
(*
d©a
, 
gboŞ—n
 
cÚsid”
)

405 
Údemªd_š‹rçû
 *
içû
 = 
d©a
;

406 *
cÚsid”_fe
;

408 
cÚsid”_fe
 = 
	`g_¡rdup_´štf
(
ONDEMAND_IGNORE_NICE_LOAD_FILE
, 
içû
->
ba£_ıu
);

410 if(!
	`wr™e_lše
(
cÚsid”_fe
, "%u", !
cÚsid”
)){

411 
	`HAL_WARNING
(("Could‚Ù s‘ ignÜe_niû_lßdo: %u kHz; %s", 
cÚsid”
,

412 
	`¡»¼Ü
(
”ºo
)));

413 
	`g_ä“
(
cÚsid”_fe
);

414  
FALSE
;

416 
	`g_ä“
(
cÚsid”_fe
);

417 
	`HAL_DEBUG
(("S‘ cÚsid”‚iûØ%d fÜ ondemªd", 
cÚsid”
));

419  
TRUE
;

420 
	}
}

422 
gboŞ—n
 
	$Údemªd_g‘_cÚsid”_niû
()

424 *
gov”nÜ_fe
;

425 
gboŞ—n
 
cÚsid”
 = -1;

428 
gov”nÜ_fe
 = 
	`g_¡rdup_´štf
(
ONDEMAND_IGNORE_NICE_LOAD_FILE
, 0);

430 ià(!
	`»ad_lše_št
(
gov”nÜ_fe
, &
cÚsid”
)) {

431 
	`HAL_WARNING
(("Could‚ot„ead ignore_nice_load file"));

432 
	`g_ä“
(
gov”nÜ_fe
);

435 
	`g_ä“
(
gov”nÜ_fe
);

437  !
cÚsid”
;

438 
	}
}

440 
gboŞ—n
 
	$Údemªd_š™
(
Údemªd_š‹rçû
 *
içû
, 
GSLi¡
 *
cÜes
)

442 ià(
içû
 =ğ
NULL
)

443  
FALSE
;

445 ià(!
	`wr™e_gov”nÜ
(
ONDEMAND_STRING
, 
	`GPOINTER_TO_INT
(
cÜes
->
d©a
))) {

446 
	`HAL_WARNING
(("Could‚ot set ondemand governor."));

447  
FALSE
;

450 
içû
->
ba£_ıu
 = 
	`GPOINTER_TO_INT
(
cÜes
->
d©a
);

452  
TRUE
;

453 
	}
}

455 
	$Údemªd_ä“
(*
d©a
)

458 
	}
}

476 
gboŞ—n
 
	$£t_³rfÜmªû
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

477 
³rfÜmªû
)

479 
¡•s
;

480 
up_th»shŞd
;

481 
GSLi¡
 *
™
 = 
NULL
;

483 ià(
ıuäeq_objs
 =ğ
NULL
) {

484 
	`dbus_¿i£_no_su™abË_gov”nÜ
(
cÚÃùiÚ
, 
mes§ge
,

486  
FALSE
;

489 ià(
³rfÜmªû
 < 1)

490 
³rfÜmªû
 = 1;

491 ià(
³rfÜmªû
 > 100)

492 
³rfÜmªû
 = 100;

494 ià(
³rfÜmªû
 >= 50) {

495 
¡•s
 = 
UP_THRESHOLD_BASE
 - 
UP_THRESHOLD_MIN
 + 1;

496 
up_th»shŞd
 = (
UP_THRESHOLD_BASE
è- ((()
³rfÜmªû
 - 50.0) *

497 (
¡•s
 / 51.0));

498 
³rfÜmªû
 = ()
up_th»shŞd
;

499 } ià(
³rfÜmªû
 < 50) {

500 
¡•s
 = 
UP_THRESHOLD_MAX
 - 
UP_THRESHOLD_BASE
;

501 
up_th»shŞd
 = (
UP_THRESHOLD_MAX
 + 1è- (()
³rfÜmªû
 *

502 (
¡•s
 / 49.0));

503 
³rfÜmªû
 = ()
up_th»shŞd
;

506 
™
 = 
ıuäeq_objs
; iˆ!ğ
NULL
; iˆğ
	`g_¦i¡_Ãxt
(it)) {

507 
ıuäeq_obj
 *
obj
 = 
™
->
d©a
;

508 
obj
->
	`£t_³rfÜmªû
(obj->
içû
, 
³rfÜmªû
);

510  
TRUE
;

511 
	}
}

525 
gboŞ—n
 
	$g‘_³rfÜmªû
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

526 *
³rfÜmªû
)

528 
ıuäeq_obj
 *
obj
;

529 
¡•s
;

530 
³rf
;

531 
up_th»shŞd
;

533 ià(
ıuäeq_objs
 =ğ
NULL
) {

534 
	`dbus_¿i£_no_su™abË_gov”nÜ
(
cÚÃùiÚ
, 
mes§ge
,

536  
FALSE
;

539 
obj
 = 
ıuäeq_objs
->
d©a
;

541 
up_th»shŞd
 = 
obj
->
	`g‘_³rfÜmªû
();

542 ià(
up_th»shŞd
 < 0) {

543 
	`dbus_¿i£_”rÜ
(
cÚÃùiÚ
, 
mes§ge
, 
CPUFREQ_ERROR_GENERAL
,

545  
FALSE
;

548 ià(
up_th»shŞd
 < 
UP_THRESHOLD_BASE
) {

549 
¡•s
 = 
UP_THRESHOLD_BASE
 - 
UP_THRESHOLD_MIN
 + 1;

550 
³rf
 = (((
UP_THRESHOLD_BASE
è- 
up_th»shŞd
) /

551 (
¡•s
 / 51.0)) + 50.0;

552 } ià(
up_th»shŞd
 >ğ
UP_THRESHOLD_BASE
) {

553 
¡•s
 = 
UP_THRESHOLD_MAX
 - 
UP_THRESHOLD_BASE
;

554 
³rf
 = ((
UP_THRESHOLD_MAX
 + 1è- 
up_th»shŞd
) /

555 (
¡•s
 / 49.0);

558 *
³rfÜmªû
 = ()
³rf
;

560  
TRUE
;

561 
	}
}

575 
gboŞ—n
 
	$£t_cÚsid”_niû
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

576 
gboŞ—n
 
cÚsid”
)

578 
GSLi¡
 *
™
 = 
NULL
;

580 ià(
ıuäeq_objs
 =ğ
NULL
) {

581 
	`dbus_¿i£_no_su™abË_gov”nÜ
(
cÚÃùiÚ
, 
mes§ge
,

583  
FALSE
;

586 
™
 = 
ıuäeq_objs
; iˆ!ğ
NULL
; iˆğ
	`g_¦i¡_Ãxt
(it)) {

587 
ıuäeq_obj
 *
obj
ğ
™
->
d©a
;

588 
obj
->
	`£t_cÚsid”_niû
(obj->
içû
, 
cÚsid”
);

590  
TRUE
;

591 
	}
}

605 
gboŞ—n
 
	$g‘_cÚsid”_niû
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

606 *
cÚsid”
)

608 
ıuäeq_obj
 *
obj
;

610 ià(
ıuäeq_objs
 =ğ
NULL
) {

611 
	`dbus_¿i£_no_su™abË_gov”nÜ
(
cÚÃùiÚ
, 
mes§ge
,

613  
FALSE
;

615 
obj
 = 
ıuäeq_objs
->
d©a
;

617 *
cÚsid”
 = 
obj
->
	`g‘_cÚsid”_niû
();

619  
TRUE
;

620 
	}
}

634 
gboŞ—n
 
	$g‘_avaabË_gov”nÜs
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

635 
gch¬
 ***
gov”nÜs
)

637 *
agovs_fe
;

639 
agovs_fe
 = 
	`g_¡rdup_´štf
(
SYSFS_AVAILABLE_GOVERNORS_FILE
, 0);

640 *
gov”nÜs
 = 
	`»ad_lše_¡r_¥l™
(
agovs_fe
, " ");

641 
	`g_ä“
(
agovs_fe
);

643 ià(*
gov”nÜs
 =ğ
NULL
) {

644 
	`dbus_¿i£_”rÜ
(
cÚÃùiÚ
, 
mes§ge
, 
CPUFREQ_ERROR_GENERAL
,

646  
FALSE
;

649  
TRUE
;

650 
	}
}

664 
gboŞ—n
 
	$£t_gov”nÜs
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

665 cÚ¡ *
gov”nÜ
)

667 
GSLi¡
 *
ıus
 = 
NULL
;

668 
GSLi¡
 *
™
 = 
NULL
;

669 
g_sourû_id
 = -1;

670 
gboŞ—n
 
have_gov”nÜ
 = 
FALSE
;

671 
i
;

672 
num_ıus
;

673 
gch¬
 **
avaabË_gov”nÜs
;

675 ià(!
	`g‘_avaabË_gov”nÜs
(
cÚÃùiÚ
, 
mes§ge
, &
avaabË_gov”nÜs
))

676  
FALSE
;

678 
i
 = 0; 
avaabË_gov”nÜs
[i] !ğ
NULL
; i++) {

679 ià(
	`¡rcmp
(
avaabË_gov”nÜs
[
i
], 
gov”nÜ
) == 0) {

680 
have_gov”nÜ
 = 
TRUE
;

684 
	`g_¡rä“v
(
avaabË_gov”nÜs
);

686 ià(!
have_gov”nÜ
) {

687 
	`dbus_¿i£_”rÜ
(
cÚÃùiÚ
, 
mes§ge
,

688 
CPUFREQ_ERROR_UNKNOWN_GOVERNOR
,

689 "NØgov”nÜ '%s'‡vaabË", 
gov”nÜ
);

690  
FALSE
;

694 ià(
	`g_¦i¡_Ëngth
(
ıuäeq_objs
) > 0) {

695 
GSLi¡
 *
™”
 = 
NULL
;

696 
™”
 = 
ıuäeq_objs
; i‹¸!ğ
NULL
; i‹¸ğ
	`g_¦i¡_Ãxt
(iter)) {

697 
ıuäeq_obj
 *
obj
 = 
™”
->
d©a
;

698 
obj
->
	`ä“
(obj->
içû
);

699 
	`ä“
(
obj
->
içû
);

700 
	`ä“
(
obj
);

702 
	`g_¦i¡_ä“
(
ıuäeq_objs
);

703 
ıuäeq_objs
 = 
NULL
;

704 
	`g_sourû_»move
(
g_sourû_id
);

705 
g_sourû_id
 = -1;

708 
num_ıus
 = 
	`syscÚf
(
_SC_NPROCESSORS_CONF
);

709 ià(
num_ıus
 < 0) {

710 
	`dbus_¿i£_”rÜ
(
cÚÃùiÚ
, 
mes§ge
, 
CPUFREQ_ERROR_GENERAL
,

712 
	`HAL_WARNING
(("No CPUs found in system"));

713  
FALSE
;

716 ià(!
	`g‘_ıu_d•’d’c›s
(&
ıus
, 
num_ıus
)) {

717 
	`dbus_¿i£_”rÜ
(
cÚÃùiÚ
, 
mes§ge
, 
CPUFREQ_ERROR_GENERAL
,

719 
	`HAL_WARNING
(("Could‚ot figure out cpu core dependencies"));

720  
FALSE
;

723 ià(!
	`¡rcmp
(
gov”nÜ
, 
USERSPACE_STRING
)) {

724 
ıuäeq_obj
 *cpufreq_obj;

725 
u£r¥aû_š‹rçû
 *
içû
;

727 
™
 = 
ıus
; iˆ!ğ
NULL
; iˆğ
	`g_¦i¡_Ãxt
(it)) {

728 
ıuäeq_obj
 = 
	`m®loc
((cpufreq_obj));

729 
içû
 = 
	`m®loc
((
u£r¥aû_š‹rçû
));

731 ià(
	`u£r¥aû_š™
(
içû
, 
™
->
d©a
)) {

732 
ıuäeq_obj
->
içû
 = iface;

733 
ıuäeq_obj
->
£t_³rfÜmªû
 = 
u£r¥aû_£t_³rfÜmªû
;

734 
ıuäeq_obj
->
g‘_³rfÜmªû
 = 
u£r¥aû_g‘_³rfÜmªû
;

735 
ıuäeq_obj
->
£t_cÚsid”_niû
 = 
u£r¥aû_£t_cÚsid”_niû
;

736 
ıuäeq_obj
->
g‘_cÚsid”_niû
 = 
u£r¥aû_g‘_cÚsid”_niû
;

737 
ıuäeq_obj
->
ä“
 = 
u£r¥aû_ä“
;

738 
ıuäeq_objs
 = 
	`g_¦i¡_­³nd
(ıuäeq_objs, 
ıuäeq_obj
);

739 
	`HAL_DEBUG
(("added userspace interface"));

741 
	`dbus_¿i£_gov”nÜ_š™_çed
(
cÚÃùiÚ
, 
mes§ge
,

742 (*)
gov”nÜ
);

743  
FALSE
;

746 
g_sourû_id
 = 
	`g_timeout_add
(
USERSPACE_POLL_INTERVAL
,

747 (
GSourûFunc
)
u£r¥aû_adju¡_¥“ds
,

748 
ıuäeq_objs
);

750 } ià(!
	`¡rcmp
(
gov”nÜ
, 
ONDEMAND_STRING
)) {

751 
ıuäeq_obj
 *cpufreq_obj;

752 
Údemªd_š‹rçû
 *
içû
;

754 
™
 = 
ıus
; iˆ!ğ
NULL
; iˆğ
	`g_¦i¡_Ãxt
(it)) {

755 
ıuäeq_obj
 = 
	`m®loc
((cpufreq_obj));

756 
içû
 = 
	`m®loc
((
Údemªd_š‹rçû
));

758 ià(
	`Údemªd_š™
(
içû
, 
™
->
d©a
)) {

759 
ıuäeq_obj
->
içû
 = iface;

760 
ıuäeq_obj
->
£t_³rfÜmªû
 = 
Údemªd_£t_³rfÜmªû
;

761 
ıuäeq_obj
->
g‘_³rfÜmªû
 = 
Údemªd_g‘_³rfÜmªû
;

762 
ıuäeq_obj
->
£t_cÚsid”_niû
 = 
Údemªd_£t_cÚsid”_niû
;

763 
ıuäeq_obj
->
g‘_cÚsid”_niû
 = 
Údemªd_g‘_cÚsid”_niû
;

764 
ıuäeq_obj
->
ä“
 = 
Údemªd_ä“
;

765 
ıuäeq_objs
 = 
	`g_¦i¡_­³nd
(ıuäeq_objs, 
ıuäeq_obj
);

766 
	`HAL_DEBUG
(("added ondemand interface"));

768 
	`dbus_¿i£_gov”nÜ_š™_çed
(
cÚÃùiÚ
, 
mes§ge
,

769 (*)
gov”nÜ
);

770  
FALSE
;

774 
™
 = 
ıus
; iˆ!ğ
NULL
; iˆğ
	`g_¦i¡_Ãxt
(it)) {

775 ià(!
	`wr™e_gov”nÜ
((*)
gov”nÜ
,

776 
	`GPOINTER_TO_INT
(((
GSLi¡
*)
™
->
d©a
)->data))) {

777 
	`dbus_¿i£_gov”nÜ_š™_çed
(
cÚÃùiÚ
, 
mes§ge
,

778 (*)
gov”nÜ
);

779 
	`HAL_WARNING
(("Could‚Ù s‘ % gov”nÜ.", 
gov”nÜ
));

780  
FALSE
;

785 
	`£t_³rfÜmªû
(
NULL
, NULL, 
DEFAULT_PERFORMANCE
);

787  
TRUE
;

788 
	}
}

802 
gboŞ—n
 
	$g‘_gov”nÜs
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

803 *
gov”nÜ
)

805 *
gov”nÜ_fe
;

806 
ıu_id
 = 0;

808 
gov”nÜ_fe
 = 
	`g_¡rdup_´štf
(
SYSFS_GOVERNOR_FILE
, 
ıu_id
);

810 ià(!
	`»ad_lše
(
gov”nÜ_fe
, 
gov”nÜ
, 
MAX_LINE_SIZE
)) {

811 
	`dbus_¿i£_”rÜ
(
cÚÃùiÚ
, 
mes§ge
, 
CPUFREQ_ERROR_GENERAL
,

813 
	`g_ä“
(
gov”nÜ_fe
);

814  
FALSE
;

816 
	`g_ä“
(
gov”nÜ_fe
);

819 
gov”nÜ
[
	`¡¾’
(governor)-1] = '\0';

821  
TRUE
;

822 
	}
}

838 
gboŞ—n
 
	$dbus_¿i£_no_su™abË_gov”nÜ
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

839 
DBusMes§ge
 *
mes§ge
,

840 *
m‘hod
)

842  
	`dbus_¿i£_”rÜ
(
cÚÃùiÚ
, 
mes§ge
,

843 
CPUFREQ_ERROR_NO_SUITABLE_GOVERNOR
,

845 
m‘hod
);

846 
	}
}

859 
gboŞ—n
 
	$dbus_¿i£_gov”nÜ_š™_çed
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

860 
DBusMes§ge
 *
mes§ge
,

861 *
gov”nÜ
)

863  
	`dbus_¿i£_”rÜ
(
cÚÃùiÚ
, 
mes§ge
,

864 
CPUFREQ_ERROR_GOVERNOR_INIT_FAILED
,

866 
gov”nÜ
);

867 
	}
}

881 
gboŞ—n
 
	$dbus_¿i£_”rÜ
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

882 cÚ¡ *
”rÜ_Çme
, *
fÜm©
, ...)

884 
buf
[2 * 
MAX_LINE_SIZE
];

885 
DBusMes§ge
 *
»¶y
;

886 
va_li¡
 
¬gs
;

887 *
”rÜ
 = 
NULL
;

889 ià(
cÚÃùiÚ
 =ğ
NULL
 || 
mes§ge
 == NULL)

890  
FALSE
;

892 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

893 
	`v¢´štf
(
buf
,  buf, 
fÜm©
, 
¬gs
);

894 
	`va_’d
(
¬gs
);

896 
”rÜ
 = 
	`g_¡rdup_´štf
("%s.%s", 
DBUS_INTERFACE
, 
”rÜ_Çme
);

897 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
(
mes§ge
, 
”rÜ
, 
buf
);

898 
	`g_ä“
(
”rÜ
);

899 ià(
»¶y
 =ğ
NULL
) {

900 
	`HAL_WARNING
(("No memory"));

901  
FALSE
;

904 ià(!
	`dbus_cÚÃùiÚ_£nd
(
cÚÃùiÚ
, 
»¶y
, 
NULL
)) {

905 
	`HAL_WARNING
(("No memory"));

906 
	`dbus_mes§ge_uÄef
(
»¶y
);

907  
FALSE
;

909 
	`dbus_mes§ge_uÄef
(
»¶y
);

911  
TRUE
;

912 
	}
}

926 
gboŞ—n
 
	$dbus_£nd_»¶y
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

927 
dbus_ty³
, *
d©a
)

929 
DBusMes§ge
 *
»¶y
;

931 ià((
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
(
mes§ge
)è=ğ
NULL
) {

932 
	`HAL_WARNING
(("Could‚ot‡llocate memory forhe DBus„eply"));

933  
FALSE
;

936 ià(
d©a
 !ğ
NULL
)

937 
	`dbus_mes§ge_­³nd_¬gs
(
»¶y
, 
dbus_ty³
, 
d©a
, 
DBUS_TYPE_INVALID
);

939 ià(!
	`dbus_cÚÃùiÚ_£nd
(
cÚÃùiÚ
, 
»¶y
, 
NULL
)) {

940 
	`HAL_WARNING
(("Could‚ot sent„eply"));

941  
FALSE
;

943 
	`dbus_cÚÃùiÚ_æush
(
cÚÃùiÚ
);

944 
	`dbus_mes§ge_uÄef
(
»¶y
);

946  
TRUE
;

947 
	}
}

959 
gboŞ—n
 
	$dbus_£nd_»¶y_¡¾i¡
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

960 
gch¬
 **
li¡
)

962 
DBusMes§ge
 *
»¶y
;

963 
DBusMes§geI‹r
 
™”
;

964 
DBusMes§geI‹r
 
™”_¬¿y
;

965 
i
;

967 ià((
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
(
mes§ge
)è=ğ
NULL
) {

968 
	`HAL_WARNING
(("Could‚ot‡llocate memory forhe DBus„eply"));

969  
FALSE
;

972 
	`dbus_mes§ge_™”_š™_­³nd
(
»¶y
, &
™”
);

973 
	`dbus_mes§ge_™”_İ’_cÚš”
(&
™”
,

974 
DBUS_TYPE_ARRAY
,

975 
DBUS_TYPE_STRING_AS_STRING
,

976 &
™”_¬¿y
);

978 
i
 = 0; 
li¡
[i] !ğ
NULL
; i++)

979 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”_¬¿y
, 
DBUS_TYPE_STRING
, &
li¡
[
i
]);

981 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”
, &
™”_¬¿y
);

983 ià(!
	`dbus_cÚÃùiÚ_£nd
(
cÚÃùiÚ
, 
»¶y
, 
NULL
)) {

984 
	`HAL_WARNING
(("Could‚ot sent„eply"));

985  
FALSE
;

988 
	`dbus_cÚÃùiÚ_æush
(
cÚÃùiÚ
);

989 
	`dbus_mes§ge_uÄef
(
»¶y
);

991  
TRUE
;

992 
	}
}

1006 
gboŞ—n
 
	$dbus_g‘_¬gum’t
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
,

1007 
DBusE¼Ü
 *
dbus_”rÜ
, 
dbus_ty³
, *
¬g
)

1009 
	`dbus_mes§ge_g‘_¬gs
(
mes§ge
, 
dbus_”rÜ
, 
dbus_ty³
, 
¬g
,

1010 
DBUS_TYPE_INVALID
);

1011 ià(
	`dbus_”rÜ_is_£t
(
dbus_”rÜ
)) {

1012 
	`HAL_WARNING
(("Could‚ot get‡rgument of DBus message: %s",

1013 
dbus_”rÜ
->
mes§ge
));

1014 
	`dbus_”rÜ_ä“
(
dbus_”rÜ
);

1015  
FALSE
;

1017  
TRUE
;

1018 
	}
}

1020 
DBusHªdËrResuÉ
 
	$dbus_f‹r_funùiÚ_loÿl
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

1021 
DBusMes§ge
 *
mes§ge
,

1022 *
u£r_d©a
)

1024 ià(
	`dbus_mes§ge_is_sigÇl
(
mes§ge
, 
DBUS_INTERFACE_LOCAL
,

1026 
	`HAL_DEBUG
(("DBus daemon disconnected. Tryingo„econnect..."));

1027 
	`dbus_cÚÃùiÚ_uÄef
(
cÚÃùiÚ
);

1028 
	`g_timeout_add
(5000, (
GSourûFunc
)
dbus_š™_loÿl
, 
NULL
);

1030  
DBUS_HANDLER_RESULT_HANDLED
;

1031 
	}
}

1045 
DBusHªdËrResuÉ
 
	$dbus_f‹r_funùiÚ
(
DBusCÚÃùiÚ
 *
cÚÃùiÚ
,

1046 
DBusMes§ge
 *
mes§ge
,

1047 *
u£r_d©a
)

1049 
DBusE¼Ü
 
dbus_”rÜ
;

1050 cÚ¡ *
memb”
 = 
	`dbus_mes§ge_g‘_memb”
(
mes§ge
);

1051 cÚ¡ *
·th
 = 
	`dbus_mes§ge_g‘_·th
(
mes§ge
);

1053 
	`HAL_DEBUG
(("Reûived DBu mes§gw™h memb” %s", 
memb”
));

1054 
	`HAL_DEBUG
(("Reûived DBu mes§gw™h…©h %s", 
·th
));

1056 
	`dbus_”rÜ_š™
(&
dbus_”rÜ
);

1060 ià(!
	`dbus_mes§ge_has_š‹rçû
(
mes§ge
, 
DBUS_INTERFACE
))

1061  
DBUS_HANDLER_RESULT_HANDLED
;

1063 #ifdeà
HAVE_POLKIT


1064 ià(!
	`check_´iv
 (
h®ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
	`dbus_mes§ge_g‘_·th
 (mes§ge), 
CPUFREQ_POLKIT_PRIVILEGE
))

1065  
DBUS_HANDLER_RESULT_HANDLED
;

1068 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
mes§ge
, 
DBUS_INTERFACE
,

1070 *
¬g
;

1072 ià(!
	`dbus_g‘_¬gum’t
(
cÚÃùiÚ
, 
mes§ge
, &
dbus_”rÜ
,

1073 
DBUS_TYPE_STRING
, &
¬g
)) {

1074  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1076 
	`HAL_DEBUG
(("Reûived‡rgum’t: %s", 
¬g
));

1078 ià(
	`£t_gov”nÜs
(
cÚÃùiÚ
, 
mes§ge
, 
¬g
))

1079 
	`dbus_£nd_»¶y
(
cÚÃùiÚ
, 
mes§ge
, 
DBUS_TYPE_INVALID
, 
NULL
);

1081 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
mes§ge
, 
DBUS_INTERFACE
,

1083 
¬g
;

1085 ià(!
	`dbus_g‘_¬gum’t
(
cÚÃùiÚ
, 
mes§ge
, &
dbus_”rÜ
,

1086 
DBUS_TYPE_INT32
, &
¬g
)) {

1087  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1089 
	`HAL_DEBUG
(("Reûived‡rgum’t: %d", 
¬g
));

1091 ià(
	`£t_³rfÜmªû
(
cÚÃùiÚ
, 
mes§ge
, 
¬g
))

1092 
	`dbus_£nd_»¶y
(
cÚÃùiÚ
, 
mes§ge
, 
DBUS_TYPE_INVALID
, 
NULL
);

1094 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
mes§ge
, 
DBUS_INTERFACE
,

1096 
gboŞ—n
 
¬g
;

1098 ià(!
	`dbus_g‘_¬gum’t
(
cÚÃùiÚ
, 
mes§ge
, &
dbus_”rÜ
,

1099 
DBUS_TYPE_BOOLEAN
, &
¬g
)) {

1100  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1102 
	`HAL_DEBUG
(("Reûived‡rgum’t: %d", 
¬g
));

1104 ià(
	`£t_cÚsid”_niû
(
cÚÃùiÚ
, 
mes§ge
, 
¬g
))

1105 
	`dbus_£nd_»¶y
(
cÚÃùiÚ
, 
mes§ge
, 
DBUS_TYPE_INVALID
, 
NULL
);

1107 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
mes§ge
, 
DBUS_INTERFACE
,

1109 
gov”nÜ
[
MAX_LINE_SIZE
 + 1];

1110 *
gov
 = 
gov”nÜ
;

1112 ià(
	`g‘_gov”nÜs
(
cÚÃùiÚ
, 
mes§ge
, 
gov”nÜ
))

1113 
	`dbus_£nd_»¶y
(
cÚÃùiÚ
, 
mes§ge
, 
DBUS_TYPE_STRING
, &
gov
);

1115 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
mes§ge
, 
DBUS_INTERFACE
,

1117 
³rfÜmªû
 = -1;

1119 ià(
	`g‘_³rfÜmªû
(
cÚÃùiÚ
, 
mes§ge
, &
³rfÜmªû
))

1120 
	`dbus_£nd_»¶y
(
cÚÃùiÚ
, 
mes§ge
, 
DBUS_TYPE_INT32
, &
³rfÜmªû
);

1122 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
mes§ge
, 
DBUS_INTERFACE
,

1124 
cÚsid”
 = -1;

1126 ià(
	`g‘_cÚsid”_niû
(
cÚÃùiÚ
, 
mes§ge
, &
cÚsid”
))

1127 
	`dbus_£nd_»¶y
(
cÚÃùiÚ
, 
mes§ge
, 
DBUS_TYPE_BOOLEAN
, &
cÚsid”
);

1129 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
(
mes§ge
, 
DBUS_INTERFACE
,

1131 
gch¬
 **
gov”nÜs
 = 
NULL
;

1133 ià(
	`g‘_avaabË_gov”nÜs
(
cÚÃùiÚ
, 
mes§ge
, &
gov”nÜs
))

1134 
	`dbus_£nd_»¶y_¡¾i¡
(
cÚÃùiÚ
, 
mes§ge
, 
gov”nÜs
);

1135 
	`g_¡rä“v
(
gov”nÜs
);

1138  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1141  
DBUS_HANDLER_RESULT_HANDLED
;

1142 
	}
}

1144 
gboŞ—n
 
	$is_suµÜ‹d
()

1146 *
gov”nÜ_fe
 = 
NULL
;

1148 
gov”nÜ_fe
 = 
	`g_¡rdup_´štf
(
SYSFS_GOVERNOR_FILE
, 0);

1149 ià(
	`acûss
(
gov”nÜ_fe
, 
F_OK
) != 0) {

1150 
	`g_ä“
(
gov”nÜ_fe
);

1151  
FALSE
;

1153 
	`g_ä“
(
gov”nÜ_fe
);

1154  
TRUE
;

1155 
	}
}

1158 
gboŞ—n
 
	$dbus_š™_loÿl
()

1160 
DBusCÚÃùiÚ
 *
dbus_cÚÃùiÚ
;

1161 
DBusE¼Ü
 
dbus_”rÜ
;

1163 
	`dbus_”rÜ_š™
(&
dbus_”rÜ
);

1165 
dbus_cÚÃùiÚ
 = 
	`dbus_bus_g‘
(
DBUS_BUS_SYSTEM
, &
dbus_”rÜ
);

1166 ià(
	`dbus_”rÜ_is_£t
(&
dbus_”rÜ
)) {

1167 
	`HAL_WARNING
(("Cannot get D-Bus connection"));

1168  
TRUE
;

1171 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
(
dbus_cÚÃùiÚ
, 
NULL
);

1172 
	`dbus_cÚÃùiÚ_add_f‹r
(
dbus_cÚÃùiÚ
, 
dbus_f‹r_funùiÚ_loÿl
,

1173 
NULL
, NULL);

1174 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
(
dbus_cÚÃùiÚ
, 0);

1175  
FALSE
;

1176 
	}
}

1178 
gboŞ—n
 
	$dbus_š™
()

1180 
DBusE¼Ü
 
dbus_”rÜ
;

1181 
DBusCÚÃùiÚ
 *
dbus_cÚÃùiÚ
;

1183 
udi
 = 
	`g‘’v
("UDI");

1185 
	`dbus_”rÜ_š™
(&
dbus_”rÜ
);

1187 ià((
h®ùx
 = 
	`libh®_ùx_š™_dœeù
(&
dbus_”rÜ
)è=ğ
NULL
) {

1188 
	`HAL_WARNING
(("Cannot connecto hald"));

1189 
E¼Ü
;

1192 ià((
dbus_cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
(
h®ùx
)è=ğ
NULL
) {

1193 
	`HAL_WARNING
(("Cannot get DBus connection"));

1194 
E¼Ü
;

1197 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
h®ùx
, 
udi
, &
dbus_”rÜ
)) {

1198 
E¼Ü
;

1201 ià(!
	`libh®_deviû_şaim_š‹rçû
(
h®ùx
, 
udi
,

1224 &
dbus_”rÜ
)) {

1226 
	`HAL_WARNING
(("CªnÙ cÏim iÁ”çû: %s", 
dbus_”rÜ
.
mes§ge
));

1227 
	`årštf
(
¡d”r
, "dœeù CªnÙ cÏim iÁ”çû: %s", 
dbus_”rÜ
.
mes§ge
);

1228 
E¼Ü
;

1231 
	`libh®_deviû_add_ÿ·b™y
(
h®ùx
,

1234 &
dbus_”rÜ
);

1236 ià(
	`dbus_”rÜ_is_£t
(&
dbus_”rÜ
)) {

1237 
	`HAL_WARNING
(("CªnÙ‡dd c­ab™y cpuäeq_cÚŒŞ: %s", 
dbus_”rÜ
.
mes§ge
));

1238 
E¼Ü
;

1241 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
(
dbus_cÚÃùiÚ
, 
NULL
);

1242 
	`dbus_cÚÃùiÚ_add_f‹r
(
dbus_cÚÃùiÚ
, 
dbus_f‹r_funùiÚ
, 
NULL
, NULL);

1243 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
(
dbus_cÚÃùiÚ
, 0);

1244  
TRUE
;

1246 
E¼Ü
:

1247 
	`dbus_”rÜ_ä“
(&
dbus_”rÜ
);

1248  
FALSE
;

1249 
	}
}

1252 
	$ex™_hªdËr
(
i
)

1254 
GSLi¡
 *
™
 = 
NULL
;

1256 
™
 = 
ıuäeq_objs
; iˆ!ğ
NULL
; iˆğ
	`g_¦i¡_Ãxt
(it)) {

1257 
ıuäeq_obj
 *
obj
 = 
™
->
d©a
;

1258 
obj
->
	`ä“
(obj->
içû
);

1259 
	`ä“
(
obj
->
içû
);

1260 
	`ä“
(
obj
);

1262 
	`g_¦i¡_ä“
(
ıuäeq_objs
);

1264 
	`HAL_DEBUG
(("exit"));

1265 
	`ex™
(
EXIT_SUCCESS
);

1266 
	}
}

1268 
	$maš
(
¬gc
, *
¬gv
[])

1270 
sigaùiÚ
 
sigÇl_aùiÚ
;

1271 
GMašLoİ
 *
gmaš
;

1273 
	`mem£t
(&
sigÇl_aùiÚ
, 0, (signal_action));

1274 
	`sigadd£t
(&
sigÇl_aùiÚ
.
§_mask
, 
SIGTERM
);

1275 
sigÇl_aùiÚ
.
§_æags
 = 
SA_RESTART
 || 
SA_NOCLDSTOP
;

1276 
sigÇl_aùiÚ
.
§_hªdËr
 = 
ex™_hªdËr
;

1277 
	`sigaùiÚ
(
SIGINT
, &
sigÇl_aùiÚ
, 
NULL
);

1278 
	`sigaùiÚ
(
SIGQUIT
, &
sigÇl_aùiÚ
, 
NULL
);

1279 
	`sigaùiÚ
(
SIGTERM
, &
sigÇl_aùiÚ
, 
NULL
);

1281 
	`£tup_logg”
 ();

1283 ià(!
	`is_suµÜ‹d
()) {

1284 
	`HAL_WARNING
(("CPUFreq‚ot supported. Exiting..."));

1285 
	`ex™
(
EXIT_FAILURE
);

1288 ià(!
	`dbus_š™
(è|| 
	`dbus_š™_loÿl
())

1289 
	`ex™
(
EXIT_FAILURE
);

1291 
gmaš
 = 
	`g_maš_loİ_Ãw
(
NULL
, 
FALSE
);

1292 
	`g_maš_loİ_run
(
gmaš
);

1295 
	}
}

	@hald/linux/addons/addon-cpufreq.h

25 #iâdeà
ADDON_CPUFREQ_H


26 
	#ADDON_CPUFREQ_H


	)

28 #ifdeà
HAVE_CONFIG_H


29 
	~<cÚfig.h
>

32 
	~<dbus/dbus-glib.h
>

33 
	~<dbus/dbus-glib-lowËv–.h
>

34 
	~<glib.h
>

35 
	~<¡dio.h
>

36 
	~<¡dlib.h
>

39 
	#UP_THRESHOLD_MAX
 99

	)

40 
	#UP_THRESHOLD_MIN
 11

	)

42 
	#UP_THRESHOLD_BASE
 80

	)

43 
	#DEFAULT_PERFORMANCE
 50

	)

45 
	sıuäeq_obj
 {

46 *
	miçû
;

47 
gboŞ—n
 (*
£t_³rfÜmªû
è(*
	md©a
, );

48 
gboŞ—n
 (*
£t_cÚsid”_niû
è(*
	md©a
, 
	mgboŞ—n
);

49 (*
	mg‘_³rfÜmªû
) ();

50 
gboŞ—n
 (*
g‘_cÚsid”_niû
) ();

51 (*
	mä“
è(*
	md©a
);

54 
gboŞ—n
 
wr™e_lše
 (cÚ¡ *
f’ame
,

55 cÚ¡ *
fmt
, ...);

57 
gboŞ—n
 
»ad_lše
 (cÚ¡ *
f’ame
,

58 *
lše
,

59 
Ën
);

61 
gboŞ—n
 
»ad_lše_št_¥l™
 (*
f’ame
,

62 
gch¬
 *
d–im
,

63 
GSLi¡
 **
li¡
);

65 
gboŞ—n
 
ıu_Úlše
 (
ıu_id
);

67 
gboŞ—n
 
wr™e_gov”nÜ
 (*
Ãw_gov”nÜ
,

68 
ıu_id
);

70 
gboŞ—n
 
dbus_š™
 ();

72 
gboŞ—n
 
dbus_š™_loÿl
 ();

	@hald/linux/addons/addon-dell-backlight.cpp

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<¡ršg.h
>

32 
	~<glib/gmaš.h
>

33 
	~<dbus/dbus-glib.h
>

34 
	~<dbus/dbus-glib-lowËv–.h
>

36 
	~"libh®/libh®.h
"

37 
	~"../../logg”.h
"

39 
	~"smbios/ISmi.h
"

40 
	~"smbios/ITok’.h
"

42 
LibH®CÚ‹xt
 *
	gh®ùx
 = 
NULL
;

43 
GMašLoİ
 *
	gmaš_loİ
;

44 *
	gudi
;

45 
DBusCÚÃùiÚ
 *
	gcÚn
;

46 cÚ¡ 
	gDELL_LCD_BRIGHTNESS_TOKEN
 = 0x007d;

48 
u32
 
	gmšV®ue
 = 0;

49 
u32
 
	gmaxV®ue
 = 0;

51 #ifdeà
HAVE_SMBIOS_2_0_3


52 
boŞ
 
	ghasPass
 = 
çl£
;

55 
usšg
 
Çme¥aû
 
	g¡d
;

56 
usšg
 
Çme¥aû
 
	gsmi
;

58 
	$u32
 (*
	t»adâ
)(
	tu32
 
	tloÿtiÚ
, u32 *
	tmšV®ue
, u32 *
	tmaxV®ue
);

59 
	$u32
 (*
	twr™eâ
)(cÚ¡ 
	t¡ršg
 &
	t·sswÜd
, 
	tu32
 
	tloÿtiÚ
, u32 
	tv®ue
, u32 *
	tmšV®ue
, u32 *
	tmaxV®ue
);

61 
u32


62 
	$»ad_backlight
 (
dbus_boŞ_t
 
ÚAC
)

64 
u8
 
loÿtiÚ
 = 0;

65 
u32
 
curV®ue
;

66 
»adâ
 
»adFunùiÚ
;

68 ià(
ÚAC
)

69 
»adFunùiÚ
 = &
smi
::
»adACModeS‘tšg
;

71 
»adFunùiÚ
 = &
smi
::
»adB©‹ryModeS‘tšg
;

73 
smbios
::
Tok’TabËFaùÜy
 *
‰FaùÜy
 = smbios::Tok’TabËFaùÜy::
	`g‘FaùÜy
 () ;

74 
smbios
::
ITok’TabË
 *
tok’TabË
 = 
‰FaùÜy
->
	`g‘SšgËtÚ
 ();

75 
smbios
::
ITok’
 *
tok’
 = &(*((*
tok’TabË
)[ 
DELL_LCD_BRIGHTNESS_TOKEN
 ]));

76 
dyÇmic_ÿ¡
< 
smbios
::
ISmiTok’
 * >(
tok’
)->
	`g‘SmiD‘as
 (
¡©ic_ÿ¡
<
u16
*>(0), stic_ÿ¡<
u8
*>(0), &
loÿtiÚ
);

78 
Œy


80 
curV®ue
 = 
	`»adFunùiÚ
 (
loÿtiÚ
, &
mšV®ue
, &
maxV®ue
);

82 
	`ÿtch
 (cÚ¡ 
exû±iÚ
 &
e
)

84 
	`HAL_ERROR
 (("Could‚ot‡ccesshe dcdbas kernel module. Please make sure it is†oaded"));

85  
maxV®ue
;

88 ià(
ÚAC
)

89 
	`HAL_DEBUG
 (("R—dšg %d fromhAC backlighˆ»gi¡”", 
curV®ue
));

91 
	`HAL_DEBUG
 (("R—dšg %d fromhBAT backlighˆ»gi¡”", 
curV®ue
));

93  
curV®ue
;

94 
	}
}

96 #ifdeà
HAVE_SMBIOS_2_0_3


98 
	$check_bios_·sswÜd
()

100 ià(
smi
::
	`g‘PasswÜdStus
((
u16
)9) || smi::getPasswordStatus((u16)10))

101 
hasPass
=
Œue
;

102 
	}
}

106 
	$wr™e_backlight
 (
u32
 
ÃwBacklightV®ue
, 
dbus_boŞ_t
 
ÚAC
)

108 
u8
 
loÿtiÚ
 = 0;

109 
u32
 
curV®ue
;

110 
wr™eâ
 
wr™eFunùiÚ
;

111 
¡ršg
 
	`·sswÜd
("");

113 #ifdeà
HAVE_SMBIOS_2_0_3


114 ià(
hasPass
) {

115 
	`HAL_WARNING
(("Setting brightness via SMI is‚ot supported with‡ BIOS…assword"));

120 ià(
ÚAC
)

121 
wr™eFunùiÚ
 = &
smi
::
wr™eACModeS‘tšg
;

123 
wr™eFunùiÚ
 = &
smi
::
wr™eB©‹ryModeS‘tšg
;

125 
smbios
::
Tok’TabËFaùÜy
 *
‰FaùÜy
 = smbios::Tok’TabËFaùÜy::
	`g‘FaùÜy
 ();

126 
smbios
::
ITok’TabË
 *
tok’TabË
 = 
‰FaùÜy
->
	`g‘SšgËtÚ
 ();

127 
smbios
::
ITok’
 *
tok’
 = &(*((*
tok’TabË
)[ 
DELL_LCD_BRIGHTNESS_TOKEN
 ]));

128 
dyÇmic_ÿ¡
< 
smbios
::
ISmiTok’
 * >(
tok’
)->
	`g‘SmiD‘as
 ( 
¡©ic_ÿ¡
<
u16
*>(0), stic_ÿ¡<
u8
*>(0), &
loÿtiÚ
 );

130 
Œy


132 
curV®ue
 = 
	`wr™eFunùiÚ
(
·sswÜd
, 
loÿtiÚ
, 
ÃwBacklightV®ue
, &
mšV®ue
, &
maxV®ue
);

134 
	`ÿtch
 (cÚ¡ 
exû±iÚ
 &
e
)

136 
	`HAL_ERROR
 (("Could‚ot‡ccesshe dcdbas kernel module. Please make sure it is†oaded"));

140 ià(
ÚAC
)

141 
	`HAL_DEBUG
 (("WrÙ%dØthAC backlight", 
curV®ue
));

143 
	`HAL_DEBUG
 (("WrÙ%dØthBAT backlight", 
curV®ue
));

144 
	}
}

146 
gboŞ—n


147 
	$check_´iv
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, cÚ¡ *
udi
, cÚ¡ *
aùiÚ
)

148 #ifdeà
HAVE_POLKIT


150 
gboŞ—n
 
»t
;

151 *
pŞk™_»suÉ
;

152 cÚ¡ *
švoked_by_syscÚ_Çme
;

153 
DBusMes§ge
 *
»¶y
;

154 
DBusE¼Ü
 
”rÜ
;

156 
»t
 = 
FALSE
;

157 
pŞk™_»suÉ
 = 
NULL
;

159 
švoked_by_syscÚ_Çme
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

161 
	`dbus_”rÜ_š™
 (&
”rÜ
);

162 
pŞk™_»suÉ
 = 
	`libh®_deviû_is_ÿÎ”_´iveged
 (
h®ùx
,

163 
udi
,

164 
aùiÚ
,

165 
švoked_by_syscÚ_Çme
,

166 &
”rÜ
);

167 ià(
pŞk™_»suÉ
 =ğ
NULL
) {

168 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ_´štf
 (
mes§ge
,

171 
aùiÚ
, 
pŞk™_»suÉ
);

172 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

173 
out
;

175 ià(
	`¡rcmp
 (
pŞk™_»suÉ
, "yes") != 0) {

177 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ_´štf
 (
mes§ge
,

180 
aùiÚ
, 
pŞk™_»suÉ
);

181 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

182 
out
;

185 
»t
 = 
TRUE
;

187 
out
:

188 ià(
pŞk™_»suÉ
 !ğ
NULL
)

189 
	`libh®_ä“_¡ršg
 (
pŞk™_»suÉ
);

190  
»t
;

191 
	}
}

194  
	gTRUE
;

198 
DBusHªdËrResuÉ


199 
	$f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£rd©a
)

201 
DBusE¼Ü
 
”r
;

202 
DBusMes§ge
 *
»¶y
 = 
NULL
;

203 
dbus_boŞ_t
 
AC
;

204 **
udis
;

205 
i
, 
num_deviûs
;

207 
	`dbus_”rÜ_š™
 (&
”r
);

209 ià(!
	`check_´iv
 (
cÚÃùiÚ
, 
mes§ge
, 
	`dbus_mes§ge_g‘_·th
 (message), "org.freedesktop.hal.power-management.lcd-panel")) {

210  
DBUS_HANDLER_RESULT_HANDLED
;

214 
AC
 = 
TRUE
;

216 ià((
udis
 = 
	`libh®_fšd_deviû_by_ÿ·b™y
(
h®ùx
, "ac_ad­‹r", &
num_deviûs
, &
”r
)è!ğ
NULL
) {

217 
i
 = 0; 
udis
[i] !ğ
NULL
; i++) {

218 ià(
	`dbus_”rÜ_is_£t
(&
”r
))

219 
	`dbus_”rÜ_ä“
 (&
”r
);

221 ià(
	`libh®_deviû_´İ”ty_exi¡s
 (
h®ùx
, 
udis
[
i
], "ac_ad­‹r.´e£Á", &
”r
)) {

222 
AC
 = 
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
h®ùx
, 
udis
[
i
], "ac_ad­‹r.´e£Á", &
”r
);

226 
	`libh®_ä“_¡ršg_¬¿y
(
udis
);

229 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

232 
brighŠess
;

234 
	`HAL_DEBUG
 (("Received SetBrightness DBus call"));

236 ià(
	`dbus_”rÜ_is_£t
(&
”r
))

237 
	`dbus_”rÜ_ä“
 (&
”r
);

239 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

240 &
”r
,

241 
DBUS_TYPE_INT32
, &
brighŠess
,

242 
DBUS_TYPE_INVALID
)) {

243 ià(
brighŠess
 < (è
mšV®ue
 || brighŠes > (è
maxV®ue
) {

244 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
,

249 
»tuº_code
;

251 
	`wr™e_backlight
 (
brighŠess
, 
AC
);

253 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

254 ià(
»¶y
 =ğ
NULL
)

255 
”rÜ
;

257 
»tuº_code
 = 0;

259 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

260 
DBUS_TYPE_INT32
, &
»tuº_code
,

261 
DBUS_TYPE_INVALID
);

264 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

267 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

270 
	`HAL_DEBUG
 (("Received GetBrightness DBUS call"));

272 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

273 &
”r
,

274 
DBUS_TYPE_INVALID
)) {

275 
brighŠess
 = 
	`»ad_backlight
 (
AC
);

277 ià(
brighŠess
 < (è
mšV®ue
)

278 
brighŠess
 = 
mšV®ue
;

279 ià(
brighŠess
 > (è
maxV®ue
)

280 
brighŠess
 = 
maxV®ue
;

282 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

283 ià(
»¶y
 =ğ
NULL
)

284 
”rÜ
;

286 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

287 
DBUS_TYPE_INT32
, &
brighŠess
,

288 
DBUS_TYPE_INVALID
);

289 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

292 
”rÜ
:

293 ià(
»¶y
 !ğ
NULL
)

294 
	`dbus_mes§ge_uÄef
 (
»¶y
);

296  
DBUS_HANDLER_RESULT_HANDLED
;

297 
	}
}

300 
	$maš
 (
¬gc
, *
¬gv
[])

302 
DBusE¼Ü
 
”r
;

304 
	`£tup_logg”
 ();

306 
udi
 = 
	`g‘’v
 ("UDI");

308 
	`HAL_DEBUG
 (("udi=%s", 
udi
));

309 ià(
udi
 =ğ
NULL
) {

310 
	`HAL_ERROR
 (("No device specified"));

314 
	`dbus_”rÜ_š™
 (&
”r
);

315 ià((
h®ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”r
)è=ğ
NULL
) {

316 
	`HAL_ERROR
 (("Cannot connecto hald"));

320 
	`dbus_”rÜ_š™
 (&
”r
);

321 ià(!
	`libh®_deviû_addÚ_is_»ady
(
h®ùx
, 
udi
, &
”r
)) {

325 
cÚn
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
h®ùx
);

326 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚn
, 
NULL
);

328 
	`dbus_cÚÃùiÚ_add_f‹r
 (
cÚn
, 
f‹r_funùiÚ
, 
NULL
, NULL);

330 
	`»ad_backlight
 (
TRUE
);

332 #ifdeà
HAVE_SMBIOS_2_0_3


333 
	`check_bios_·sswÜd
();

336 ià(
maxV®ue
 == 0) {

337 
	`HAL_ERROR
 (("This machine don't support set brightness."));

341 ià(!
	`libh®_deviû_£t_´İ”ty_št
 (
h®ùx
,

344 
maxV®ue
 + 1,

345 &
”r
)) {

346 
	`HAL_ERROR
 (("Could‚Ù s‘ 'Ï±İ_·Ãl.numËv–s'Ø%d", 
maxV®ue
));

349 
	`HAL_DEBUG
 (("Ï±İ_·Ãl.numËv– i £ˆtØ%d", 
maxV®ue
 + 1));

352 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
h®ùx
,

362 &
”r
)) {

363 
	`HAL_ERROR
 (("Cannot claim interface 'org.freedesktop.Hal.Device.LaptopPanel'"));

367 
maš_loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

368 
	`g_maš_loİ_run
 (
maš_loİ
);

370 
	}
}

	@hald/linux/addons/addon-generic-backlight.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<”ºo.h
>

30 
	~<fú.h
>

31 
	~<¡dio.h
>

33 
	~<¡ršg.h
>

34 
	~<sys/ty³s.h
>

35 
	~<sys/¡©.h
>

36 
	~<uni¡d.h
>

38 
	~<glib/gmaš.h
>

39 
	~<dbus/dbus-glib.h
>

40 
	~<dbus/dbus-glib-lowËv–.h
>

42 
	~"libh®/libh®.h
"

43 
	~"../../logg”.h
"

44 
	~"../../ut_h–³r.h
"

45 
	~"../../ut_h–³r_´iv.h
"

47 
GMašLoİ
 *
	gmaš_loİ
;

48 
LibH®CÚ‹xt
 *
	gh®ùx
 = 
NULL
;

49 
DBusCÚÃùiÚ
 *
	gcÚn
;

51 cÚ¡ *
	gudi
 = 
NULL
;

52 cÚ¡ *
	g·th
 = 
NULL
;

53 
	gËv–s
 = 0;

57 
	$g‘_backlight
 ()

59 
FILE
 *
f
;

60 
v®ue
;

61 
buf
[64];

62 
gch¬
 
sysfs_·th
[512];

64 
f
 = 
NULL
;

65 
v®ue
 = -1;

67 
	`g_¢´štf
 (
sysfs_·th
,  (sysfs_·th), "%s/brighŠess", 
·th
);

69 
f
 = 
	`fİ’
 (
sysfs_·th
, "rb");

70 ià(
f
 =ğ
NULL
) {

71 
	`HAL_WARNING
(("Could‚Ù„—d brighŠes äom '%s'", 
sysfs_·th
));

75 ià(
	`fg‘s
 (
buf
,  (buf), 
f
è=ğ
NULL
) {

76 
	`HAL_ERROR
 (("CªnÙ„—d from '%s'", 
sysfs_·th
));

77 
out
;

80 
”ºo
 = 0;

81 
v®ue
 = 
	`¡¹Ş
 (
buf
, 
NULL
, 10);

82 ià(
”ºo
 != 0) {

83 
v®ue
 = -1;

86 
out
:

87 ià(
f
 !ğ
NULL
)

88 
	`fşo£
 (
f
);

90  
v®ue
;

91 
	}
}

95 
	$£t_backlight
 (
Ëv–
)

97 
fd
, 
l
, 
»t
;

98 
gch¬
 
sysfs_·th
[512];

100 
buf
[5];

103 ià(
Ëv–
 > 
Ëv–s
-1)

104 
Ëv–
 = 
Ëv–s
-1;

106 ià(
Ëv–
 < 0)

107 
Ëv–
 = 0;

109 
»t
 = -1;

111 
	`g_¢´štf
 (
sysfs_·th
,  (sysfs_·th), "%s/brighŠess", 
·th
);

113 
fd
 = 
	`İ’
 (
sysfs_·th
, 
O_WRONLY
);

114 ià(
fd
 < 0) {

115 
	`HAL_WARNING
(("Could‚Ù o³À'%s'", 
sysfs_·th
));

116 
out
;

119 ià((
l
 = 
	`¢´štf
 (
buf
, 4, "%d", 
Ëv–
)) < 4) {

120 ià(
	`wr™e
 (
fd
, 
buf
, 
l
) < 0) {

121 
	`HAL_WARNING
(("Could‚Ù wr™'%s'Ø'%s'", 
buf
 , 
sysfs_·th
));

124 
»t
 = 
Ëv–
;

128 
out
:

129 ià(
fd
 >= 0)

130 
	`şo£
 (
fd
);

132  
»t
;

133 
	}
}

136 
DBusHªdËrResuÉ


137 
	$f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£rd©a
)

139 
DBusE¼Ü
 
”r
;

140 
DBusMes§ge
 *
»¶y
;

142 ià(!
	`check_´iv
 (
h®ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
	`dbus_mes§ge_g‘_·th
 (message),

144  
DBUS_HANDLER_RESULT_HANDLED
;

147 
»¶y
 = 
NULL
;

149 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

152 
brighŠess
;

154 
	`dbus_”rÜ_š™
 (&
”r
);

155 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

156 &
”r
,

157 
DBUS_TYPE_INT32
, &
brighŠess
,

158 
DBUS_TYPE_INVALID
)) {

159 ià(
brighŠess
 < 0 || brighŠes > 
Ëv–s
 -1) {

160 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
,

164 
»tuº_code
;

165 
£t
;

167 
£t
 = 
	`£t_backlight
 (
brighŠess
);

169 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

170 ià(
»¶y
 =ğ
NULL
)

171 
”rÜ
;

173 ià(
£t
 =ğ
brighŠess
)

174 
»tuº_code
 = 0;

176 
»tuº_code
 = 1;

178 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

179 
DBUS_TYPE_INT32
, &
»tuº_code
,

180 
DBUS_TYPE_INVALID
);

183 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

185 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

188 
brighŠess
;

190 
	`dbus_”rÜ_š™
 (&
”r
);

191 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

192 &
”r
,

193 
DBUS_TYPE_INVALID
)) {

194 
brighŠess
 = 
	`g‘_backlight
();

196 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

197 ià(
»¶y
 =ğ
NULL
)

198 
”rÜ
;

200 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

201 
DBUS_TYPE_INT32
, &
brighŠess
,

202 
DBUS_TYPE_INVALID
);

203 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

207 
”rÜ
:

208 ià(
»¶y
 !ğ
NULL
)

209 
	`dbus_mes§ge_uÄef
 (
»¶y
);

211  
DBUS_HANDLER_RESULT_HANDLED
;

212 
	}
}

215 
	$maš
 (
¬gc
, *
¬gv
[])

217 
DBusE¼Ü
 
”r
;

218 * 
Ëv–_¡r
;

220 
	`£tup_logg”
 ();

221 
udi
 = 
	`g‘’v
 ("UDI");

222 
·th
 = 
	`g‘’v
 ("HAL_PROP_LINUX_SYSFS_PATH");

224 
	`HAL_DEBUG
 (("udi='%s',…©h='%s'", 
udi
, 
·th
));

225 ià(
udi
 =ğ
NULL
) {

226 
	`HAL_ERROR
 (("No device specified"));

229 ià(
·th
 =ğ
NULL
) {

230 
	`HAL_ERROR
 (("No sysfs…ath specified"));

234 
Ëv–_¡r
 = 
	`g‘’v
 ("HAL_PROP_LAPTOP_PANEL_NUM_LEVELS");

235 ià(
Ëv–_¡r
 !ğ
NULL
) {

236 
Ëv–s
 = 
	`©oi
 (
Ëv–_¡r
);

238 
	`HAL_ERROR
 (("No†aptop_panel.num_levels defined"));

241 
	`dbus_”rÜ_š™
 (&
”r
);

242 ià((
h®ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”r
)è=ğ
NULL
) {

243 
	`HAL_ERROR
 (("Cannot connecto hald"));

247 
cÚn
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
h®ùx
);

248 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚn
, 
NULL
);

250 
	`dbus_cÚÃùiÚ_add_f‹r
 (
cÚn
, 
f‹r_funùiÚ
, 
NULL
, NULL);

252 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
h®ùx
,

253 
udi
,

262 &
”r
)) {

263 
	`HAL_ERROR
 (("Cannot claim interface 'org.freedesktop.Hal.Device.LaptopPanel'"));

267 
	`dbus_”rÜ_š™
 (&
”r
);

268 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
h®ùx
, 
udi
, &
”r
)) {

272 
maš_loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

273 
	`g_maš_loİ_run
 (
maš_loİ
);

275 
	}
}

	@hald/linux/addons/addon-hid-ups.c

33 #ifdeà
HAVE_CONFIG_H


34 
	~<cÚfig.h
>

38 
	~<asm/ty³s.h
>

39 
	~<”ºo.h
>

40 
	~<fú.h
>

41 
	~<lšux/hiddev.h
>

42 
	~<¡dšt.h
>

43 
	~<¡dio.h
>

44 
	~<¡dlib.h
>

45 
	~<¡ršg.h
>

46 
	~<sys/ioùl.h
>

47 
	~<uni¡d.h
>

49 
	~<glib.h
>

51 
	~"libh®/libh®.h
"

53 
	~"../../ut_h–³r.h
"

54 
	~"../../ut_pm.h
"

55 
	~"../../logg”.h
"

57 
	#UPS_USAGE
 0x840000

	)

58 
	#UPS_SERIAL
 0x8400ã

	)

59 
	#UPS_CHEMISTRY
 0x850089

	)

60 
	#UPS_CAPACITY_MODE
 0x85002c

	)

61 
	#UPS_BATTERY_VOLTAGE
 0x840030

	)

62 
	#UPS_BELOW_RCL
 0x840042

	)

63 
	#UPS_SHUTDOWN_IMMINENT
 0x840069

	)

64 
	#UPS_PRODUCT
 0x8400ã

	)

65 
	#UPS_SERIALNUMBER
 0x8400ff

	)

66 
	#UPS_CHARGING
 0x850044

	)

67 
	#UPS_DISCHARGING
 0x850045

	)

68 
	#UPS_REMAINING_CAPACITY
 0x850066

	)

69 
	#UPS_RUNTIME_TO_EMPTY
 0x850068

	)

70 
	#UPS_AC_PRESENT
 0x8500d0

	)

71 
	#UPS_BATTERYPRESENT
 0x8500d1

	)

72 
	#UPS_DESIGNCAPACITY
 0x850083

	)

73 
	#UPS_DEVICENAME
 0x850088

	)

74 
	#UPS_DEVICECHEMISTRY
 0x850089

	)

75 
	#UPS_RECHARGEABLE
 0x85008b

	)

76 
	#UPS_OEMINFORMATION
 0x85008f

	)

78 
	#STATE_NORMAL
 0

	)

79 
	#STATE_DEBOUNCE
 1

	)

80 
	#STATE_BATTERY
 2

	)

82 
dbus_boŞ_t


83 
	$is_ups
 (
fd
)

85 
i
;

86 
dbus_boŞ_t
 
»t
;

87 
hiddev_devšfo
 
deviû_šfo
;

89 
»t
 = 
FALSE
;

91 ià(
	`ioùl
 (
fd
, 
HIDIOCGDEVINFO
, &
deviû_šfo
) < 0)

92 
out
;

94 
i
 = 0; i < 
deviû_šfo
.
num_­¶iÿtiÚs
; i++) {

95 ià((
	`ioùl
(
fd
, 
HIDIOCAPPLICATION
, 
i
è& 0xff0000è=ğ
UPS_USAGE
) {

96 
»t
 = 
TRUE
;

97 
out
;

101 
out
:

102  
»t
;

103 
	}
}

106 
	$ups_g‘_¡ršg
 (
fd
, 
sšdex
)

108 
hiddev_¡ršg_desütÜ
 
sdesc
;

110 ià(
sšdex
 == 0) {

113 
sdesc
.
šdex
 = 
sšdex
;

114 ià(
	`ioùl
 (
fd
, 
HIDIOCGSTRING
, &
sdesc
) < 0) {

117 
	`HAL_DEBUG
 (("foo: '%s'", 
sdesc
.
v®ue
));

118  
sdesc
.
v®ue
;

119 
	}
}

122 
dbus_boŞ_t


123 
	$ups_g‘_¡©ic
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
fd
,

124 
dbus_št32_t
 *
´İ_»maššg
,

125 
dbus_št32_t
 *
´İ_ruÁime
,

126 
dbus_boŞ_t
 *
´İ_ch¬gšg
,

127 
dbus_boŞ_t
 *
´İ_disch¬gšg
)

129 
»t
;

130 
hiddev_»pÜt_šfo
 
ršfo
;

131 
hiddev_f›ld_šfo
 
fšfo
;

132 
hiddev_u§ge_»f
 
u»f
;

133 
¹y³
;

134 
i
, 
j
;

135 *
ty³
;

136 
DBusE¼Ü
 
”rÜ
;

137 
LibH®ChªgeS‘
 *
cs
;

140 
»t
 = 
FALSE
;

142 
cs
 = 
	`libh®_deviû_Ãw_chªge£t
 (
udi
);

143 ià(
cs
 =ğ
NULL
) {

144 
	`HAL_ERROR
 (("Cannot initialize changeset"));

145 
out
;

149 ià(!
	`is_ups
 (
fd
))

150 
out
;

152 
¹y³
 = 
HID_REPORT_TYPE_MIN
;„ty³ <ğ
HID_REPORT_TYPE_MAX
;„type++) {

153 
ršfo
.
»pÜt_ty³
 = 
¹y³
;

154 
ršfo
.
»pÜt_id
 = 
HID_REPORT_ID_FIRST
;

155 
	`ioùl
 (
fd
, 
HIDIOCGREPORTINFO
, &
ršfo
) >= 0) {

156 
i
 = 0; i < 
ršfo
.
num_f›lds
; i++) {

157 
	`mem£t
 (&
fšfo
, 0,  (finfo));

158 
fšfo
.
»pÜt_ty³
 = 
ršfo
.report_type;

159 
fšfo
.
»pÜt_id
 = 
ršfo
.report_id;

160 
fšfo
.
f›ld_šdex
 = 
i
;

161 
	`ioùl
 (
fd
, 
HIDIOCGFIELDINFO
, &
fšfo
);

163 
	`mem£t
 (&
u»f
, 0,  (uref));

164 
j
 = 0; j < 
fšfo
.
maxu§ge
; j++) {

165 
u»f
.
»pÜt_ty³
 = 
fšfo
.report_type;

166 
u»f
.
»pÜt_id
 = 
fšfo
.report_id;

167 
u»f
.
f›ld_šdex
 = 
i
;

168 
u»f
.
u§ge_šdex
 = 
j
;

169 
	`ioùl
 (
fd
, 
HIDIOCGUCODE
, &
u»f
);

170 
	`ioùl
 (
fd
, 
HIDIOCGUSAGE
, &
u»f
);

172 
u»f
.
u§ge_code
) {

174 
UPS_REMAINING_CAPACITY
:

175 
	`libh®_chªge£t_£t_´İ”ty_št
 (

176 
cs
, "b©‹ry.ch¬ge_Ëv–.cu¼’t", 
u»f
.
v®ue
);

177 
	`libh®_chªge£t_£t_´İ”ty_št
 (

178 
cs
, "b©‹ry.ch¬ge_Ëv–.³rûÁage", 
u»f
.
v®ue
);

179 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (

180 
cs
, "battery.charge_level.unit", "percent");

181 
	`libh®_chªge£t_£t_´İ”ty_št
 (

182 
cs
, "b©‹ry.»pÜtšg.cu¼’t", 
u»f
.
v®ue
);

183 
	`libh®_chªge£t_£t_´İ”ty_št
 (

184 
cs
, "b©‹ry.»pÜtšg.³rûÁage", 
u»f
.
v®ue
);

185 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (

186 
cs
, "battery.reporting.unit", "percent");

187 *
´İ_»maššg
 = 
u»f
.
v®ue
;

190 
UPS_RUNTIME_TO_EMPTY
:

191 
	`libh®_chªge£t_£t_´İ”ty_št
 (

192 
cs
, "b©‹ry.»maššg_time", 
u»f
.
v®ue
);

193 *
´İ_ruÁime
 = 
u»f
.
v®ue
;

196 
UPS_CHARGING
:

197 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (

198 
cs
, "b©‹ry.»ch¬g—bË.is_ch¬gšg", 
u»f
.
v®ue
 != 0);

199 *
´İ_ch¬gšg
 = 
u»f
.
v®ue
 != 0;

202 
UPS_DISCHARGING
:

203 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (

204 
cs
, "b©‹ry.»ch¬g—bË.is_disch¬gšg", 
u»f
.
v®ue
 != 0);

205 *
´İ_disch¬gšg
 = 
u»f
.
v®ue
 != 0;

208 
UPS_BATTERYPRESENT
:

209 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (

210 
cs
, "b©‹ry.´e£Á", 
u»f
.
v®ue
 != 0);

213 
UPS_DEVICENAME
:

214 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (

215 
cs
, "foo",

216 
	`ups_g‘_¡ršg
 (
fd
, 
u»f
.
v®ue
));

219 
UPS_CHEMISTRY
:

220 
ty³
 = 
	`ups_g‘_¡ršg
 (
fd
, 
u»f
.
v®ue
);

221 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (

222 
cs
, "battery.reporting.technology",

223 
ty³
);

224 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (

225 
cs
, "battery.technology",

226 
	`ut_g‘_b©‹ry_‹chnŞogy
 (
ty³
));

229 
UPS_RECHARGEABLE
:

230 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (

231 
cs
, "b©‹ry.is_»ch¬g—bË", 
u»f
.
v®ue
 != 0);

234 
UPS_OEMINFORMATION
:

235 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (

236 
cs
, "battery.vendor",

237 
	`ups_g‘_¡ršg
 (
fd
, 
u»f
.
v®ue
));

240 
UPS_PRODUCT
:

241 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (

242 
cs
, "battery.model",

243 
	`ups_g‘_¡ršg
 (
fd
, 
u»f
.
v®ue
));

246 
UPS_SERIALNUMBER
:

247 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (

248 
cs
, "battery.serial",

249 
	`ups_g‘_¡ršg
 (
fd
, 
u»f
.
v®ue
));

252 
UPS_DESIGNCAPACITY
:

253 
	`libh®_chªge£t_£t_´İ”ty_št
 (

254 
cs
, "b©‹ry.ch¬ge_Ëv–.design", 
u»f
.
v®ue
);

255 
	`libh®_chªge£t_£t_´İ”ty_št
 (

256 
cs
, "b©‹ry.ch¬ge_Ëv–.Ï¡_fuÎ", 
u»f
.
v®ue
);

257 
	`libh®_chªge£t_£t_´İ”ty_št
 (

258 
cs
, "b©‹ry.»pÜtšg.design", 
u»f
.
v®ue
);

259 
	`libh®_chªge£t_£t_´İ”ty_št
 (

260 
cs
, "b©‹ry.»pÜtšg.Ï¡_fuÎ", 
u»f
.
v®ue
);

268 
ršfo
.
»pÜt_id
 |ğ
HID_REPORT_ID_NEXT
;

272 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "b©‹ry.´e£Á", 
TRUE
);

273 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "battery.type", "ups");

275 
	`dbus_”rÜ_š™
 (&
”rÜ
);

276 
	`libh®_deviû_comm™_chªge£t
 (
ùx
, 
cs
, &
”rÜ
);

278 
	`dbus_”rÜ_š™
 (&
”rÜ
);

279 
	`libh®_deviû_add_ÿ·b™y
 (
ùx
, 
udi
, "b©‹ry", &
”rÜ
);

281 
»t
 = 
TRUE
;

283 
out
:

284 
	`libh®_deviû_ä“_chªge£t
 (
cs
);

286  
»t
;

287 
	}
}

290 
	$maš
 (
¬gc
, *
¬gv
[])

292 
fd
;

293 *
udi
;

294 *
deviû_fe
;

295 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

296 
DBusE¼Ü
 
”rÜ
;

297 
i
;

298 
fd_£t
 
fd£t
;

299 
hiddev_ev’t
 
ev
[64];

300 
rd
;

301 
dbus_št32_t
 
´İ_»maššg
 = 0;

302 
dbus_št32_t
 
´İ_ruÁime
 = 0;

303 
dbus_boŞ_t
 
´İ_ch¬gšg
 = 
FALSE
;

304 
dbus_boŞ_t
 
´İ_disch¬gšg
 = 
FALSE
;

306 
	`h®_£t_´oc_t™Ë_š™
 (
¬gc
, 
¬gv
);

308 
	`£tup_logg”
 ();

310 
udi
 = 
	`g‘’v
 ("UDI");

311 ià(
udi
 =ğ
NULL
)

312 
out
;

314 
	`dbus_”rÜ_š™
 (&
”rÜ
);

315 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
)

316 
out
;

318 
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_HIDDEV_DEVICE");

319 ià(
deviû_fe
 =ğ
NULL
)

320 
out
;

322 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
);

323 ià(
fd
 < 0)

324 
out
;

326 ià(!
	`ups_g‘_¡©ic
 (
ùx
, 
udi
, 
fd
, &
´İ_»maššg
, &
´İ_ruÁime
, &
´İ_ch¬gšg
, &
´İ_disch¬gšg
))

327 
out
;

329 
	`h®_£t_´oc_t™Ë
 ("h®d-addÚ-hid-ups:†i¡’šg oÀ%s", 
deviû_fe
);

331 
	`dbus_”rÜ_š™
 (&
”rÜ
);

332 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
ùx
, 
udi
, &
”rÜ
)) {

333 
out
;

336 
	`FD_ZERO
(&
fd£t
);

338 
	`FD_SET
(
fd
, &
fd£t
);

339 
rd
 = 
	`£Ëù
(
fd
+1, &
fd£t
, 
NULL
, NULL, NULL);

342 ià(
rd
 > 0) {

343 
LibH®ChªgeS‘
 *
cs
;

345 
rd
 = 
	`»ad
(
fd
, 
ev
, (ev));

346 ià(
rd
 < (è(
ev
[0])) {

347 
	`şo£
(
fd
);

348 
out
;

351 
cs
 = 
	`libh®_deviû_Ãw_chªge£t
 (
udi
);

352 ià(
cs
 =ğ
NULL
) {

353 
	`HAL_ERROR
 (("Cannot initialize changeset"));

354 
out
;

357 
i
 = 0; i < 
rd
 / (
ev
[0]); i++) {

358 
ev
[
i
].
hid
) {

359 
UPS_REMAINING_CAPACITY
:

360 ià(
ev
[
i
].
v®ue
 !ğ
´İ_»maššg
) {

361 
´İ_»maššg
 = 
ev
[
i
].
v®ue
;

362 
	`libh®_chªge£t_£t_´İ”ty_št
 (

363 
cs
, "b©‹ry.ch¬ge_Ëv–.cu¼’t", 
ev
[
i
].
v®ue
);

364 
	`libh®_chªge£t_£t_´İ”ty_št
 (

365 
cs
, "b©‹ry.ch¬ge_Ëv–.³rûÁage", 
ev
[
i
].
v®ue
);

366 
	`libh®_chªge£t_£t_´İ”ty_št
 (

367 
cs
, "b©‹ry.»pÜtšg.cu¼’t", 
ev
[
i
].
v®ue
);

368 
	`libh®_chªge£t_£t_´İ”ty_št
 (

369 
cs
, "b©‹ry.»pÜtšg.³rûÁage", 
ev
[
i
].
v®ue
);

373 
UPS_RUNTIME_TO_EMPTY
:

374 ià(
ev
[
i
].
v®ue
 !ğ
´İ_ruÁime
) {

375 
´İ_ruÁime
 = 
ev
[
i
].
v®ue
;

376 
	`libh®_chªge£t_£t_´İ”ty_št
 (

377 
cs
, "b©‹ry.»maššg_time", 
ev
[
i
].
v®ue
);

381 
UPS_CHARGING
:

382 ià((
ev
[
i
].
v®ue
 !ğ0è!ğ
´İ_ch¬gšg
) {

383 
´İ_ch¬gšg
 = (
ev
[
i
].
v®ue
 != 0);

384 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (

385 
cs
, "b©‹ry.»ch¬g—bË.is_ch¬gšg", 
ev
[
i
].
v®ue
 != 0);

389 
UPS_DISCHARGING
:

390 ià((
ev
[
i
].
v®ue
 !ğ0è!ğ
´İ_disch¬gšg
) {

391 
´İ_disch¬gšg
 = (
ev
[
i
].
v®ue
 != 0);

392 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (

393 
cs
, "b©‹ry.»ch¬g—bË.is_disch¬gšg", 
ev
[
i
].
v®ue
 != 0);

402 
	`dbus_”rÜ_š™
 (&
”rÜ
);

404 
	`libh®_deviû_comm™_chªge£t
 (
ùx
, 
cs
, &
”rÜ
);

405 
	`libh®_deviû_ä“_chªge£t
 (
cs
);

410 
out
:

412 
	}
}

	@hald/linux/addons/addon-imac-backlight.c

23 #ifdeà
HAVE_CONFIG_H


24 
	~<cÚfig.h
>

27 
	~<¡ršg.h
>

28 
	~<¡dio.h
>

29 
	~<¡dlib.h
>

30 
	~<sys/io.h
>

32 
	~<glib/gmaš.h
>

33 
	~<dbus/dbus-glib.h
>

34 
	~<dbus/dbus-glib-lowËv–.h
>

36 
	~"libh®/libh®.h
"

37 
	~"../../logg”.h
"

38 
	~"../../ut_h–³r_´iv.h
"

40 
LibH®CÚ‹xt
 *
	gh®ùx
 = 
NULL
;

43 
	$backlight_£t
(
v®ue
)

45 
	`outb
(0x04 | (
v®ue
 << 4), 0xB3);

46 
	`outb
(0xBF, 0xB2);

47 
	}
}

50 
	$backlight_g‘
()

52 
	`outb
(0x03, 0xB3);

53 
	`outb
(0xBF, 0xB2);

54  
	`šb
(0xB3) >> 4;

55 
	}
}

57 
	#BACKLIGHT_OBJECT
 \

58 "/Üg/ä“desktİ/H®/deviûs/imac_backlight"

	)

59 
	#BACKLIGHT_IFACE
 \

60 "Üg.ä“desktİ.H®.Deviû.L­tİPª–"

	)

61 
	#INTERFACE_DESCRIPTION
 \

68 " </m‘hod>\n"

	)

70 
DBusHªdËrResuÉ


71 
	$f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, *
u£rd©a
)

73 
DBusMes§ge
 *
»¶y
;

74 
DBusE¼Ü
 
”r
;

75 
Ëv–
;

76 
»t
;

78 ià(!
	`check_´iv
 (
h®ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
	`dbus_mes§ge_g‘_·th
 (message), "org.freedesktop.hal.power-management.lcd-panel")) {

79  
DBUS_HANDLER_RESULT_HANDLED
;

82 
»¶y
 = 
NULL
;

83 
»t
 = 0;

85 
	`dbus_”rÜ_š™
 (&
”r
);

87 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
, 
BACKLIGHT_IFACE
, "SetBrightness")) {

89 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”r
, 
DBUS_TYPE_INT32
,

90 &
Ëv–
, 
DBUS_TYPE_INVALID
)) {

91 ià(
Ëv–
 < 0 ||†evel > 15) {

92 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
,

97 
	`backlight_£t
 (
Ëv–
);

99 ià((
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
)))

100 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
, 
DBUS_TYPE_INT32
,

101 &
»t
, 
DBUS_TYPE_INVALID
);

104 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
, 
BACKLIGHT_IFACE
, "GetBrightness")) {

105 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”r
, 
DBUS_TYPE_INVALID
)) {

106 
Ëv–
 = 
	`backlight_g‘
();

107 ià(
Ëv–
 < 0)

108 
Ëv–
 = 0;

109 ià(
Ëv–
 > 15)

110 
Ëv–
 = 15;

112 ià((
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
)))

113 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
, 
DBUS_TYPE_INT32
,

114 &
Ëv–
, 
DBUS_TYPE_INVALID
);

118 ià(
»¶y
) {

119 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

120  
DBUS_HANDLER_RESULT_HANDLED
;

123  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

124 
	}
}

127 
	$maš
 (
¬gc
, **
¬gv
)

129 
DBusCÚÃùiÚ
 *
cÚn
;

130 
GMašLoİ
 *
maš_loİ
;

131 cÚ¡ *
udi
;

132 
DBusE¼Ü
 
”r
;

134 
	`£tup_logg”
 ();

135 
udi
 = 
	`g‘’v
 ("UDI");

137 
	`HAL_DEBUG
 (("udi=%s", 
udi
));

138 ià(
udi
 =ğ
NULL
)

140 
	`HAL_ERROR
 (("No device specified"));

144 
	`dbus_”rÜ_š™
 (&
”r
);

145 ià((
h®ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”r
)è=ğ
NULL
)

147 
	`HAL_ERROR
 (("Cannot connecto hald"));

151 
	`dbus_”rÜ_š™
 (&
”r
);

152 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
h®ùx
, 
udi
, &
”r
))

155 ià(
	`iİ”m
(0xB2, 0xB3, 1) < 0)

157 
	`HAL_ERROR
 (("ioperm failed (you should be„oot)."));

158 
	`ex™
(1);

161 
cÚn
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
h®ùx
);

162 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚn
, 
NULL
);

164 
	`dbus_cÚÃùiÚ_add_f‹r
 (
cÚn
, 
f‹r_funùiÚ
, 
NULL
, NULL);

166 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
h®ùx
, 
BACKLIGHT_OBJECT
,

167 
BACKLIGHT_IFACE
, 
INTERFACE_DESCRIPTION
, &
”r
))

169 
	`HAL_ERROR
 (("Cannot claim interface 'org.freedesktop.Hal.Device.LaptopPanel'"));

173 
maš_loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

174 
	`g_maš_loİ_run
 (
maš_loİ
);

176 
	}
}

	@hald/linux/addons/addon-input.c

28 #ifdeà
HAVE_CONFIG_H


29 
	~<cÚfig.h
>

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<uni¡d.h
>

35 
	~<¡ršg.h
>

36 
	~<sys/ty³s.h
>

37 
	~<sys/¡©.h
>

38 
	~<fú.h
>

40 
	~"../šput_loÿl.h
"

42 
	~<glib/gmaš.h
>

43 
	~<glib/g´štf.h
>

44 
	~<dbus/dbus-glib-lowËv–.h
>

46 
	~"libh®/libh®.h
"

48 
	~"../../logg”.h
"

49 
	~"../../ut_h–³r.h
"

52 *
	gkey_Çme
[
KEY_MAX
 + 1] = {

53 [0 ... 
KEY_MAX
] = 
NULL
,

54 [
KEY_STOP
] = "stop",

55 [
KEY_AGAIN
] = "again",

56 [
KEY_PROPS
] = "props",

57 [
KEY_UNDO
] = "undo",

58 [
KEY_FRONT
] = "front",

59 [
KEY_COPY
] = "copy",

60 [
KEY_OPEN
] = "open",

61 [
KEY_PASTE
] = "paste",

62 [
KEY_FIND
] = "find",

63 [
KEY_CUT
] = "cut",

64 [
KEY_HELP
] = "help",

65 [
KEY_MENU
] = "menu",

66 [
KEY_CALC
] = "calc",

67 [
KEY_SETUP
] = "setup",

68 [
KEY_SLEEP
] = "sleep",

69 [
KEY_WAKEUP
] = "wake-up",

70 [
KEY_FILE
] = "file",

71 [
KEY_SENDFILE
] = "send-file",

72 [
KEY_DELETEFILE
] = "delete-file",

73 [
KEY_XFER
] = "xfer",

74 [
KEY_PROG1
] = "prog1",

75 [
KEY_PROG2
] = "prog2",

76 [
KEY_WWW
] = "www",

77 [
KEY_MSDOS
] = "msdos",

78 [
KEY_COFFEE
] = "coffee",

79 [
KEY_DIRECTION
] = "direction",

80 [
KEY_CYCLEWINDOWS
] = "cycle-windows",

81 [
KEY_MAIL
] = "mail",

82 [
KEY_BOOKMARKS
] = "bookmarks",

83 [
KEY_COMPUTER
] = "computer",

84 [
KEY_BACK
] = "back",

85 [
KEY_FORWARD
] = "forward",

86 [
KEY_CLOSECD
] = "close-cd",

87 [
KEY_EJECTCD
] = "eject-cd",

88 [
KEY_EJECTCLOSECD
] = "eject-close-cd",

89 [
KEY_NEXTSONG
] = "next-song",

90 [
KEY_PLAYPAUSE
] = "play-pause",

91 [
KEY_PREVIOUSSONG
] = "previous-song",

92 [
KEY_STOPCD
] = "stop-cd",

93 [
KEY_RECORD
] = "record",

94 [
KEY_REWIND
] = "rewind",

95 [
KEY_PHONE
] = "phone",

96 [
KEY_ISO
] = "iso",

97 [
KEY_CONFIG
] = "config",

98 [
KEY_HOMEPAGE
] = "homepage",

99 [
KEY_REFRESH
] = "refresh",

100 [
KEY_EXIT
] = "exit",

101 [
KEY_MOVE
] = "move",

102 [
KEY_EDIT
] = "edit",

103 [
KEY_SCROLLUP
] = "scroll-up",

104 [
KEY_SCROLLDOWN
] = "scroll-down",

105 [
KEY_KPLEFTPAREN
] = "kp-left-paren",

106 [
KEY_KPRIGHTPAREN
] = "kp-right-paren",

107 [
KEY_F13
] = "f13",

108 [
KEY_F14
] = "f14",

109 [
KEY_F15
] = "f15",

110 [
KEY_F16
] = "f16",

111 [
KEY_F17
] = "f17",

112 [
KEY_F18
] = "f18",

113 [
KEY_F19
] = "f19",

114 [
KEY_F20
] = "f20",

115 [
KEY_F21
] = "f21",

116 [
KEY_F22
] = "f22",

117 [
KEY_F23
] = "f23",

118 [
KEY_F24
] = "f24",

119 [
KEY_PLAYCD
] = "play-cd",

120 [
KEY_PAUSECD
] = "pause-cd",

121 [
KEY_PROG3
] = "prog3",

122 [
KEY_PROG4
] = "prog4",

123 [
KEY_SUSPEND
] = "hibernate",

124 [
KEY_CLOSE
] = "close",

125 [
KEY_PLAY
] = "play",

126 [
KEY_FASTFORWARD
] = "fast-forward",

127 [
KEY_BASSBOOST
] = "bass-boost",

128 [
KEY_PRINT
] = "print",

129 [
KEY_HP
] = "hp",

130 [
KEY_CAMERA
] = "camera",

131 [
KEY_SOUND
] = "sound",

132 [
KEY_QUESTION
] = "question",

133 [
KEY_EMAIL
] = "email",

134 [
KEY_CHAT
] = "chat",

135 [
KEY_SEARCH
] = "search",

136 [
KEY_CONNECT
] = "connect",

137 [
KEY_FINANCE
] = "finance",

138 [
KEY_SPORT
] = "sport",

139 [
KEY_SHOP
] = "shop",

140 [
KEY_ALTERASE
] = "alt-erase",

141 [
KEY_CANCEL
] = "cancel",

142 [
KEY_BRIGHTNESSDOWN
] = "brightness-down",

143 [
KEY_BRIGHTNESSUP
] = "brightness-up",

144 [
KEY_MEDIA
] = "media",

145 [
KEY_POWER
] = "power",

146 [
KEY_MUTE
] = "mute",

147 [
KEY_VOLUMEDOWN
] = "volume-down",

148 [
KEY_VOLUMEUP
] = "volume-up",

149 [
KEY_SWITCHVIDEOMODE
] = "switch-videomode",

150 [
KEY_KBDILLUMTOGGLE
] = "kbd-illum-toggle",

151 [
KEY_KBDILLUMDOWN
] = "kbd-illum-down",

152 [
KEY_KBDILLUMUP
] = "kbd-illum-up",

153 [
KEY_BATTERY
] = "battery",

154 [
KEY_BLUETOOTH
] = "bluetooth",

155 [
KEY_WLAN
] = "wlan"

159 
	#BITS_PER_LONG
 ((è* 8)

	)

160 
	#NBITS
(
x
è((((x)-1)/
BITS_PER_LONG
)+1)

	)

161 
	#OFF
(
x
è((x)%
BITS_PER_LONG
)

	)

162 
	#BIT
(
x
è(1UL<<
	`OFF
(x))

	)

163 
	#LONG
(
x
è((x)/
BITS_PER_LONG
)

	)

164 
	#‹¡_b™
(
b™
, 
¬¿y
è(×¼ay[
	`LONG
(b™)] >> 
	`OFF
(b™)è& 1)

	)

166 
_IÅutD©a
 
	tIÅutD©a
;

167 
	s_IÅutD©a


169 *
	mbu‰Ú_ty³
;

170 
gboŞ—n
 
	mbu‰Ú_has_¡©e
;

171 
gboŞ—n
 
	mbu‰Ú_¡©e
;

172 
gboŞ—n
 
	mbu‰Ú_Ãw_¡©e
;

173 
gboŞ—n
 
	mis_jack
;

174 
	mudi
[1];

177 
LibH®CÚ‹xt
 *
	gùx
 = 
NULL
;

178 
GMašLoİ
 *
	ggmaš
 = 
NULL
;

179 
GHashTabË
 *
	gšputs
 = 
NULL
;

180 
GLi¡
 *
	gdeviûs
 = 
NULL
;

183 
	$em™_sw™ch_cÚd™iÚ
 (
IÅutD©a
 *
šput_d©a
)

185 ià(
šput_d©a
->
bu‰Ú_Ãw_¡©e
 !ğšput_d©a->
bu‰Ú_¡©e
) {

186 
DBusE¼Ü
 
”rÜ
;

188 
šput_d©a
->
bu‰Ú_¡©e
 = iÅut_d©a->
bu‰Ú_Ãw_¡©e
;

189 
šput_d©a
->
bu‰Ú_Ãw_¡©e
 = 0;

191 
	`dbus_”rÜ_š™
 (&
”rÜ
);

192 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
šput_d©a
->
udi
, "button.state.value",

193 
šput_d©a
->
bu‰Ú_¡©e
, &
”rÜ
);

195 
	`dbus_”rÜ_š™
 (&
”rÜ
);

196 
	`libh®_deviû_em™_cÚd™iÚ
 (
ùx
, 
šput_d©a
->
udi
,

198 
šput_d©a
->
bu‰Ú_ty³
,

199 &
”rÜ
);

200 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

202 
	}
}

205 
	$£t_jack_sw™ch_ty³
 (cÚ¡ *
udi
, cÚ¡ *
Çme
, 
gboŞ—n
 
¡©e
)

207 
DBusE¼Ü
 
”rÜ
;

209 
	`dbus_”rÜ_š™
 (&
”rÜ
);

210 ià(
¡©e
)

211 
	`libh®_deviû_´İ”ty_¡¾i¡_­³nd
 (
ùx
, 
udi
, "šput.jack.ty³", 
Çme
, &
”rÜ
);

213 
	`libh®_deviû_´İ”ty_¡¾i¡_»move
 (
ùx
, 
udi
, "šput.jack.ty³", 
Çme
, &
”rÜ
);

214 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

215 
	}
}

217 
gboŞ—n


218 
	$ev’t_io
 (
GIOChªÃl
 *
chªÃl
, 
GIOCÚd™iÚ
 
cÚd™iÚ
, 
gpoš‹r
 
d©a
)

220 
IÅutD©a
 *
šput_d©a
 = (IÅutD©a*è
d©a
;

221 
šput_ev’t
 
ev’t
;

222 
DBusE¼Ü
 
”rÜ
;

223 
GE¼Ü
 *
g”rÜ
 = 
NULL
;

224 
gsize
 
»ad_by‹s
;

226 ià(
cÚd™iÚ
 & (
G_IO_HUP
 | 
G_IO_ERR
 | 
G_IO_NVAL
))

227  
FALSE
;

230 
	`g_io_chªÃl_»ad_ch¬s
 (
chªÃl
,

231 ((
gch¬
 *)&
ev’t
),  (
šput_ev’t
),

232 &
»ad_by‹s
, &
g”rÜ
è=ğ
G_IO_STATUS_NORMAL
) {

234 ià(
»ad_by‹s
 <  (
šput_ev’t
)) {

235 
	`HAL_ERROR
 (("incomplete inputƒvent„ead"));

236  
FALSE
;

239 ià(
šput_d©a
->
bu‰Ú_has_¡©e
 &&

240 
ev’t
.
ty³
 =ğ
EV_SW
) {

241 
b™mask
[
	`NBITS
(
SW_MAX
)];

243 
	`HAL_INFO
 (("%s:ƒvent.value=%d ;ƒvent.code=%d (0x%02x)",

244 
šput_d©a
->
udi
,

245 
ev’t
.
v®ue
,ƒv’t.
code
,ƒvent.code));

247 
ev’t
.
code
) {

248 
SW_LID
:

249 
SW_TABLET_MODE
:

250 
SW_RFKILL_ALL
:

275 ià(
	`ioùl
 (
	`g_io_chªÃl_unix_g‘_fd
(
chªÃl
), 
	`EVIOCGSW
( (
b™mask
)), bitmask) < 0) {

276 
	`HAL_DEBUG
 (("ioctl EVIOCGSW failed"));

278 
šput_d©a
->
bu‰Ú_Ãw_¡©e
 = 
	`‹¡_b™
 (
ev’t
.
code
, 
b™mask
);

279 
	`em™_sw™ch_cÚd™iÚ
 (
šput_d©a
);

282 
SW_HEADPHONE_INSERT
:

283 
šput_d©a
->
bu‰Ú_Ãw_¡©e
 |ğ
ev’t
.
v®ue
;

284 
	`£t_jack_sw™ch_ty³
 (
šput_d©a
->
udi
, "h—dphÚe", 
ev’t
.
v®ue
);

286 
SW_MICROPHONE_INSERT
:

287 
šput_d©a
->
bu‰Ú_Ãw_¡©e
 |ğ
ev’t
.
v®ue
;

288 
	`£t_jack_sw™ch_ty³
 (
šput_d©a
->
udi
, "miüİhÚe", 
ev’t
.
v®ue
);

290 
SW_LINEOUT_INSERT
:

291 
šput_d©a
->
bu‰Ú_Ãw_¡©e
 |ğ
ev’t
.
v®ue
;

292 
	`£t_jack_sw™ch_ty³
 (
šput_d©a
->
udi
, "lše-out", 
ev’t
.
v®ue
);

294 
SW_VIDEOOUT_INSERT
:

295 
šput_d©a
->
bu‰Ú_Ãw_¡©e
 |ğ
ev’t
.
v®ue
;

296 
	`£t_jack_sw™ch_ty³
 (
šput_d©a
->
udi
, "video-out", 
ev’t
.
v®ue
);

298 
SW_JACK_PHYSICAL_INSERT
:

301 
šput_d©a
->
bu‰Ú_Ãw_¡©e
 |ğ
ev’t
.
v®ue
;

304 } ià(
ev’t
.
ty³
 =ğ
EV_SYN
 && 
šput_d©a
->
is_jack
) {

305 
	`em™_sw™ch_cÚd™iÚ
 (
šput_d©a
);

306 } ià(
ev’t
.
ty³
 =ğ
EV_KEY
 && 
key_Çme
[ev’t.
code
] !ğ
NULL
 &&ƒv’t.
v®ue
) {

307 
	`dbus_”rÜ_š™
 (&
”rÜ
);

308 
	`libh®_deviû_em™_cÚd™iÚ
 (
ùx
, 
šput_d©a
->
udi
,

310 
key_Çme
[
ev’t
.
code
],

311 &
”rÜ
);

312 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

316  
TRUE
;

317 
	}
}

320 
	$de¡roy_d©a
 (
IÅutD©a
 *
d©a
)

322 
	`HAL_DEBUG
 (("IÅuˆdeviû '%s' de¡royed, f»d©a.", 
d©a
->
udi
));

324 
	`g_ä“
 (
d©a
->
bu‰Ú_ty³
);

325 
	`g_ä“
 (
d©a
);

326 
	}
}

330 
	$upd©e_´oc_t™Ë
 ()

332 
GLi¡
 *
Í
;

333 
gch¬
 *
Ãw_commªd_lše
, *
p
;

334 
gšt
 
Ën
 = 0;

336 
Í
 = 
deviûs
;†p;†°ğÍ->
Ãxt
)

337 
Ën
 =†’ + 
	`¡¾’
 (
Í
->
d©a
) + 1;

339 
Ën
 +ğ
	`¡¾’
 ("hald-addon-input: Listening on");

341 
Ãw_commªd_lše
 = 
	`g_m®loc
 (
Ën
 + 1);

342 
p
 = 
Ãw_commªd_lše
;

343 
p
 +ğ
	`g_¥rštf
 (
Ãw_commªd_lše
, "hald-addon-input: Listening on");

345 
Í
 = 
	`g_li¡_Ï¡
(
deviûs
);†p;†°ğ
	`g_li¡_´evious
(lp))

347 
p
 +ğ
	`g_¥rštf
 (p, " %s", (
gch¬
*è
Í
->
d©a
);

350 
	`h®_£t_´oc_t™Ë
 (
Ãw_commªd_lše
);

351 
	`g_ä“
 (
Ãw_commªd_lše
);

352 
	}
}

355 
	$add_deviû
 (
LibH®CÚ‹xt
 *
ùx
,

356 cÚ¡ *
udi
,

357 cÚ¡ 
LibH®Prİ”tyS‘
 *
´İ”t›s
)

359 
ev’tå
;

360 
GIOChªÃl
 *
chªÃl
;

361 
IÅutD©a
 *
d©a
;

362 
Ën
 = 
	`¡¾’
 (
udi
);

363 cÚ¡ * 
deviû_fe
;

364 cÚ¡ *
bu‰Ú_ty³
;

365 
b™mask
[
	`NBITS
(
SW_MAX
)];

367 
d©a
 = (
IÅutD©a
*è
	`g_m®loc
 ( (IÅutD©aè+ 
Ën
);

369 
	`memıy
 (&(
d©a
->
udi
), udi, 
Ën
+1);

371 ià((
deviû_fe
 = 
	`libh®_ps_g‘_¡ršg
 (
´İ”t›s
, "šput.deviû")è=ğ
NULL
) {

372 
	`HAL_ERROR
(("% ha nØ´İ”ty iÅut.deviû", 
udi
));

373 
	`g_ä“
 (
d©a
);

377 
bu‰Ú_ty³
 = 
	`libh®_ps_g‘_¡ršg
 (
´İ”t›s
, "button.type");

378 ià(!
bu‰Ú_ty³
)

379 
bu‰Ú_ty³
 = "unknown";

380 
d©a
->
bu‰Ú_ty³
 = 
	`g_¡rdup
 (button_type);

382 
d©a
->
is_jack
 = 
	`¡rcmp
 (d©a->
bu‰Ú_ty³
, "jack_insert") == 0;

385 
d©a
->
bu‰Ú_has_¡©e
 = 
	`libh®_ps_g‘_boŞ
 (
´İ”t›s
, "button.has_state");

386 ià(
d©a
->
bu‰Ú_has_¡©e
)

387 
d©a
->
bu‰Ú_¡©e
 = 
	`libh®_ps_g‘_boŞ
 (
´İ”t›s
, "button.state.value");

389 
ev’tå
 = 
	`İ’
(
deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
);

390 ià(!
ev’tå
) {

391 
	`HAL_ERROR
(("UÇbËØİ’ % fÜ„—dšg", 
deviû_fe
));

392 
	`g_ä“
 (
d©a
);

396 ià(
d©a
->
is_jack
 &&

397 
	`ioùl
 (
ev’tå
, 
	`EVIOCGSW
 ( (
b™mask
)), bitmask) >= 0) {

398 
	`£t_jack_sw™ch_ty³
 (
udi
, "h—dphÚe", 
	`‹¡_b™
 (
SW_HEADPHONE_INSERT
, 
b™mask
));

399 
	`£t_jack_sw™ch_ty³
 (
udi
, "miüİhÚe", 
	`‹¡_b™
 (
SW_MICROPHONE_INSERT
, 
b™mask
));

400 
	`£t_jack_sw™ch_ty³
 (
udi
, "lše-out", 
	`‹¡_b™
 (
SW_LINEOUT_INSERT
, 
b™mask
));

401 
	`£t_jack_sw™ch_ty³
 (
udi
, "video-out", 
	`‹¡_b™
 (
SW_VIDEOOUT_INSERT
, 
b™mask
));

404 
	`HAL_DEBUG
 (("%s: Li¡’šg oÀ%s", 
udi
, 
deviû_fe
));

406 
deviûs
 = 
	`g_li¡_´•’d
 (deviûs, 
	`g_¡rdup
 (
deviû_fe
));

407 
	`upd©e_´oc_t™Ë
 ();

409 
chªÃl
 = 
	`g_io_chªÃl_unix_Ãw
 (
ev’tå
);

410 
	`g_io_chªÃl_£t_’codšg
 (
chªÃl
, 
NULL
, NULL);

412 
	`g_hash_bË_š£¹
 (
šputs
, 
	`g_¡rdup
(
udi
), 
chªÃl
);

413 
	`g_io_add_w©ch_fuÎ
 (
chªÃl
,

414 
G_PRIORITY_DEFAULT
, 
G_IO_IN
 | 
G_IO_ERR
 | 
G_IO_HUP
 | 
G_IO_NVAL
,

415 
ev’t_io
, 
d©a
, (
GDe¡royNÙify
è
de¡roy_d©a
);

416 
	}
}

420 
	$»move_deviû
 (
LibH®CÚ‹xt
 *
ùx
,

421 cÚ¡ *
udi
,

422 cÚ¡ 
LibH®Prİ”tyS‘
 *
´İ”t›s
)

425 
GIOChªÃl
 *
chªÃl
, **
p_chªÃl
 = &channel;

426 cÚ¡ 
gch¬
 *
deviû_fe
;

427 
GLi¡
 *
Í
;

428 
gboŞ—n
 
hªdlšg_udi
;

430 
	`HAL_DEBUG
 (("Removšg chªÃÈfÜ '%s'", 
udi
));

432 
hªdlšg_udi
 = 
	`g_hash_bË_lookup_ex‹nded
 (
šputs
, 
udi
, 
NULL
, (
gpoš‹r
 *)
p_chªÃl
);

434 ià(!
hªdlšg_udi
) {

435 
	`HAL_ERROR
(("DeviûRemovÿÎed fÜ unknowÀdeviû: '%s'.", 
udi
));

439 ià(
chªÃl
) {

440 
	`g_io_chªÃl_shutdown
(
chªÃl
, 
FALSE
, 
NULL
);

441 
	`g_io_chªÃl_uÄef
 (
chªÃl
);

444 
	`g_hash_bË_»move
 (
šputs
, 
udi
);

446 ià((
deviû_fe
 = 
	`libh®_ps_g‘_¡ršg
 (
´İ”t›s
, "šput.deviû")è=ğ
NULL
) {

447 
	`HAL_ERROR
(("% ha nØ´İ”ty iÅut.deviû", 
udi
));

451 
Í
 = 
	`g_li¡_fšd_cu¡om
 (
deviûs
, 
deviû_fe
, (
GCom·»Func
è
¡rcmp
);

452 ià(
Í
) {

453 
deviûs
 = 
	`g_li¡_»move_lšk
 (deviûs, 
Í
);

454 
	`g_ä“
 (
Í
->
d©a
);

455 
	`g_li¡_ä“_1
 (
Í
);

456 
	`upd©e_´oc_t™Ë
 ();

459 ià(
	`g_hash_bË_size
 (
šputs
) == 0) {

460 
	`HAL_INFO
(("no more devices,ƒxiting"));

461 
	`g_maš_loİ_qu™
 (
gmaš
);

465 
	}
}

468 
	$maš
 (
¬gc
, **
¬gv
)

470 
DBusCÚÃùiÚ
 *
dbus_cÚÃùiÚ
;

471 
DBusE¼Ü
 
”rÜ
;

472 cÚ¡ *
commªdlše
;

474 
	`h®_£t_´oc_t™Ë_š™
 (
¬gc
, 
¬gv
);

476 
	`£tup_logg”
 ();

478 
	`dbus_”rÜ_š™
 (&
”rÜ
);

479 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

480 
	`HAL_WARNING
 (("Unableo init†ibhal context"));

481 
out
;

484 ià((
dbus_cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
(
ùx
)è=ğ
NULL
) {

485 
	`HAL_WARNING
 (("Cannot get DBus connection"));

486 
out
;

489 ià((
commªdlše
 = 
	`g‘’v
 ("SINGLETON_COMMAND_LINE")è=ğ
NULL
) {

490 
	`HAL_WARNING
 (("SINGLETON_COMMAND_LINE‚ot set"));

491 
out
;

494 
	`libh®_ùx_£t_sšgËtÚ_deviû_added
 (
ùx
, 
add_deviû
);

495 
	`libh®_ùx_£t_sšgËtÚ_deviû_»moved
 (
ùx
, 
»move_deviû
);

497 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
dbus_cÚÃùiÚ
, 
NULL
);

498 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
 (
dbus_cÚÃùiÚ
, 0);

500 
	`dbus_”rÜ_š™
 (&
”rÜ
);

502 ià(!
	`libh®_deviû_sšgËtÚ_addÚ_is_»ady
 (
ùx
, 
commªdlše
, &
”rÜ
)) {

503 
out
;

512 
šputs
 = 
	`g_hash_bË_Ãw_fuÎ
 (
g_¡r_hash
, 
g_¡r_equ®
, 
g_ä“
, 
NULL
);

514 
gmaš
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

515 
	`g_maš_loİ_run
 (
gmaš
);

519 
out
:

520 
	`HAL_DEBUG
 (("Anƒrror occured,ƒxiting cleanly"));

521 ià(
ùx
 !ğ
NULL
) {

522 
	`dbus_”rÜ_š™
 (&
”rÜ
);

523 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

524 
	`libh®_ùx_ä“
 (
ùx
);

528 
	}
}

	@hald/linux/addons/addon-ipw-killswitch.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<”ºo.h
>

30 
	~<fú.h
>

31 
	~<¡dio.h
>

33 
	~<¡ršg.h
>

34 
	~<sys/ty³s.h
>

35 
	~<sys/¡©.h
>

36 
	~<uni¡d.h
>

38 
	~<glib.h
>

39 
	~<glib/gmaš.h
>

40 
	~<glib/g¡dio.h
>

41 
	~<dbus/dbus-glib.h
>

42 
	~<dbus/dbus-glib-lowËv–.h
>

44 
	~"libh®/libh®.h
"

45 
	~"../../logg”.h
"

46 
	~"../../ut_h–³r.h
"

47 
	~"../../ut_h–³r_´iv.h
"

49 
GMašLoİ
 *
	gmaš_loİ
;

50 
LibH®CÚ‹xt
 *
	gh®ùx
 = 
NULL
;

51 
DBusCÚÃùiÚ
 *
	gcÚn
;

53 cÚ¡ *
	gudi
 = 
NULL
;

54 cÚ¡ *
	g·th
 = 
NULL
;

56 
gboŞ—n


57 
	$š™_klsw™ch
 ()

59 
DBusE¼Ü
 
”rÜ
;

60 *
·»Á
;

61 *
içû
;

62 *
_·th
;

63 **
udis
;

64 
i
, 
num_udis
;

65 
gboŞ—n
 
»t
;

67 
»t
 = 
FALSE
;

69 
	`dbus_”rÜ_š™
 (&
”rÜ
);

71 
·»Á
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
h®ùx
, 
udi
, "šfo.·»Á", &
”rÜ
);

72 
udis
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
h®ùx
, "šfo.·»Á", 
·»Á
, &
num_udis
, &
”rÜ
);

74 
i
 = 0; i < 
num_udis
; i++) {

76 ià(
	`¡rcmp
 (
udis
[
i
], 
udi
) == 0)

79 
içû
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
h®ùx
, 
udis
[
i
], "Ãt.š‹rçû", &
”rÜ
);

80 ià(
içû
 !ğ
NULL
) {

81 
_·th
 = 
	`g_¡rdup_´štf
 ("/sys/şass/Ãt/%s/deviû/rf_kl", 
içû
);

84 if(
	`g_fe_‹¡
(
_·th
, 
G_FILE_TEST_EXISTS
è&& g_fe_‹¡(_·th, 
G_FILE_TEST_IS_REGULAR
)) {

85 
·th
 = 
	`g_¡rdup
 (
_·th
);

86 
»t
 = 
TRUE
;

89 
	`g_ä“
 (
_·th
);

90 
	`libh®_ä“_¡ršg
 (
içû
);

94 
	`libh®_ä“_¡ršg
 (
·»Á
);

95 
	`libh®_ä“_¡ršg_¬¿y
 (
udis
);

97  
»t
;

98 
	}
}

102 
	$g‘_klsw™ch
 ()

104 
FILE
 *
f
;

105 
buf
[64];

106 
kl_¡©us
;

107 
»t
 = -1;

109 
f
 = 
NULL
;

111 ià((
f
 = 
	`fİ’
 (
·th
, "r")è=ğ
NULL
) {

112 
	`HAL_WARNING
(("Could‚Ù„—d klsw™ch stu äom '%s'", 
·th
));

116 ià(
	`fg‘s
 (
buf
,  (buf), 
f
è=ğ
NULL
) {

117 
	`HAL_ERROR
 (("CªnÙ„—d from '%s'", 
·th
));

118 
out
;

121 
”ºo
 = 0;

122 
kl_¡©us
 = 
	`¡¹Ş
 (
buf
, 
NULL
, 10);

123 ià(
”ºo
 == 0) {

124 
kl_¡©us
) {

126 
»t
 = 1;

131 
»t
 = 0;

138 
out
:

139 ià(
f
 !ğ
NULL
)

140 
	`fşo£
 (
f
);

142  
»t
;

143 
	}
}

147 
	$£t_klsw™ch
 (
gboŞ—n
 
¡©us
)

149 
FILE
 *
f
;

150 
»t
;

152 ià((
f
 = 
	`fİ’
 (
·th
, "w")è=ğ
NULL
) {

153 
	`HAL_WARNING
(("Could‚Ù o³À'%s'", 
·th
));

157 ià(
¡©us
) {

158 
»t
 = 
	`åuts
 ("0", 
f
);

160 
»t
 = 
	`åuts
 ("1", 
f
);

163 ià(
»t
 =ğ
EOF
) {

164 
	`HAL_WARNING
(("Could wr™¡©u tØ'%s'", 
·th
));

165 
»t
 = -1;

167 
»t
 = 0;

170 ià(
f
 !ğ
NULL
)

171 
	`fşo£
 (
f
);

173  
»t
;

174 
	}
}

177 
DBusHªdËrResuÉ


178 
	$f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£rd©a
)

180 
DBusE¼Ü
 
”r
;

181 
DBusMes§ge
 *
»¶y
;

183 ià(!
	`check_´iv
 (
h®ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
	`dbus_mes§ge_g‘_·th
 (message),

185  
DBUS_HANDLER_RESULT_HANDLED
;

188 
»¶y
 = 
NULL
;

190 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

193 
gboŞ—n
 
¡©us
;

195 
	`dbus_”rÜ_š™
 (&
”r
);

196 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

197 &
”r
,

198 
DBUS_TYPE_BOOLEAN
, &
¡©us
,

199 
DBUS_TYPE_INVALID
)) {

200 
»tuº_code
 = 0;

201 
£t
;

203 
£t
 = 
	`£t_klsw™ch
 (
¡©us
);

205 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

206 ià(
»¶y
 =ğ
NULL
)

207 
”rÜ
;

209 ià(
£t
 != 0)

210 
»tuº_code
 = 1;

212 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

213 
DBUS_TYPE_INT32
, &
»tuº_code
,

214 
DBUS_TYPE_INVALID
);

216 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

218 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

221 
¡©us
;

223 
	`dbus_”rÜ_š™
 (&
”r
);

224 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

225 &
”r
,

226 
DBUS_TYPE_INVALID
)) {

227 
¡©us
 = 
	`g‘_klsw™ch
();

229 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

230 ià(
»¶y
 =ğ
NULL
)

231 
”rÜ
;

233 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

234 
DBUS_TYPE_INT32
, &
¡©us
,

235 
DBUS_TYPE_INVALID
);

236 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

240 
”rÜ
:

241 ià(
»¶y
 !ğ
NULL
)

242 
	`dbus_mes§ge_uÄef
 (
»¶y
);

244  
DBUS_HANDLER_RESULT_HANDLED
;

245 
	}
}

248 
	$maš
 (
¬gc
, *
¬gv
[])

250 
DBusE¼Ü
 
”r
;

251 *
m‘hod
;

253 
	`£tup_logg”
 ();

254 
udi
 = 
	`g‘’v
 ("UDI");

255 
m‘hod
 = 
	`g‘’v
 ("HAL_PROP_KILLSWITCH_ACCESS_METHOD");

257 
	`HAL_DEBUG
 (("udi='%s'", 
udi
));

258 ià(
udi
 =ğ
NULL
) {

259 
	`HAL_ERROR
 (("No device specified"));

263 ià(
	`¡rcmp
 (
m‘hod
, "ipw") != 0) {

264 
	`HAL_ERROR
 (("WrÚg klsw™ch.acûss_m‘hod '%s', should b'w'", 
m‘hod
));

268 
	`dbus_”rÜ_š™
 (&
”r
);

269 ià((
h®ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”r
)è=ğ
NULL
) {

270 
	`HAL_ERROR
 (("Cannot connecto hald"));

274 
cÚn
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
h®ùx
);

275 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚn
, 
NULL
);

277 
	`dbus_cÚÃùiÚ_add_f‹r
 (
cÚn
, 
f‹r_funùiÚ
, 
NULL
, NULL);

279 ià(!
	`š™_klsw™ch
())

282 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
h®ùx
,

283 
udi
,

292 &
”r
)) {

293 
	`HAL_ERROR
 (("Cannot claim interface 'org.freedesktop.Hal.Device.KillSwitch'"));

297 
	`dbus_”rÜ_š™
 (&
”r
);

298 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
h®ùx
, 
udi
, &
”r
)) {

302 
maš_loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

303 
	`g_maš_loİ_run
 (
maš_loİ
);

305 
	}
}

	@hald/linux/addons/addon-leds.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<”ºo.h
>

30 
	~<fú.h
>

31 
	~<¡dio.h
>

33 
	~<¡ršg.h
>

34 
	~<sys/ty³s.h
>

35 
	~<sys/¡©.h
>

36 
	~<uni¡d.h
>

38 
	~<glib.h
>

39 
	~<glib/gmaš.h
>

40 
	~<glib/g¡dio.h
>

41 
	~<dbus/dbus-glib.h
>

42 
	~<dbus/dbus-glib-lowËv–.h
>

44 
	~"libh®/libh®.h
"

45 
	~"../../logg”.h
"

46 
	~"../../ut_h–³r.h
"

47 
	~"../../ut_h–³r_´iv.h
"

49 
GMašLoİ
 *
	ggmaš
 = 
NULL
;

50 
LibH®CÚ‹xt
 *
	gùx
 = 
NULL
;

51 
GHashTabË
 *
	gËds
 = 
NULL
;

55 
	$g‘_Ëds_brighŠess
 (cÚ¡ *
udi
)

57 
FILE
 *
f
;

58 
buf
[64];

59 
·th
[256];

60 *
sysfs_·th
;

61 
brighŠess
;

63 
f
 = 
NULL
;

65 ià(!
	`g_hash_bË_lookup_ex‹nded
 (
Ëds
, 
udi
, 
NULL
, (
gpoš‹r
è&
sysfs_·th
)) {

69 
	`¢´štf
 (
·th
,  (·th), "%s/brighŠess", 
sysfs_·th
);

71 ià((
f
 = 
	`fİ’
 (
·th
, "rb")è=ğ
NULL
) {

72 
	`HAL_WARNING
(("Could‚Ù„—d brighŠes äom '%s' fÜ deviû '%s'", 
·th
, 
udi
));

76 ià(
	`fg‘s
 (
buf
,  (buf), 
f
è=ğ
NULL
) {

77 
	`HAL_ERROR
 (("CªnÙ„—d from '%s' fÜ deviû '%s'", 
·th
, 
udi
));

78 
out
;

81 
”ºo
 = 0;

82 
brighŠess
 = 
	`¡¹Ş
 (
buf
, 
NULL
, 10);

83 ià(
”ºo
 != 0) {

84 
brighŠess
 = -1;

87 
out
:

88 ià(
f
 !ğ
NULL
)

89 
	`fşo£
 (
f
);

91  
brighŠess
;

92 
	}
}

96 
	$£t_Ëds_brighŠess
 (cÚ¡ *
udi
, 
Ëv–
)

98 
fd
, 
l
, 
»t
;

99 
·th
[256];

100 
buf
[5];

101 *
sysfs_·th
;

103 
»t
 = -1;

105 ià(!
	`g_hash_bË_lookup_ex‹nded
 (
Ëds
, 
udi
, 
NULL
, (
gpoš‹r
è&
sysfs_·th
)) {

109 
	`¢´štf
 (
·th
,  (·th), "%s/brighŠess", 
sysfs_·th
);

111 
fd
 = 
	`İ’
 (
·th
, 
O_WRONLY
);

112 ià(
fd
 < 0) {

113 
	`HAL_WARNING
(("Could‚Ù o³À'%s' fÜ '%s',ƒ¼Ü='%s'", 
sysfs_·th
, 
udi
, 
	`¡»¼Ü
(
”ºo
)));

114 
out
;

117 ià((
l
 = 
	`¢´štf
 (
buf
, 4, "%d", 
Ëv–
)) < 4) {

118 ià(
	`wr™e
 (
fd
, 
buf
, 
l
) < 0) {

119 
	`HAL_WARNING
(("Could‚Ù wr™'%s'Ø'%s'", 
buf
 , 
sysfs_·th
));

122 
»t
 = 
Ëv–
;

126 
out
:

127 ià(
fd
 >= 0)

128 
	`şo£
 (
fd
);

130  
»t
;

131 
	}
}

134 
DBusHªdËrResuÉ


135 
	$f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£rd©a
)

137 
DBusE¼Ü
 
”r
;

138 
DBusMes§ge
 *
»¶y
;

139 cÚ¡ *
_udi
;

140 *
sysfs_·th
;

142 ià((
_udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
)è=ğ
NULL
) {

143 
	`HAL_DEBUG
 (("Couldn't gethe udi forhis call, ignore it."));

144  
DBUS_HANDLER_RESULT_HANDLED
;

146 if(!
	`g_hash_bË_lookup_ex‹nded
 (
Ëds
, 
_udi
, 
NULL
, (
gpoš‹r
 *è&
sysfs_·th
)) {

147 
	`HAL_DEBUG
 (("Thi deviû (%sèi¢'ˆy‘ hªdËd byhaddÚ.", 
_udi
));

148  
DBUS_HANDLER_RESULT_HANDLED
;

152 
	`dbus_”rÜ_š™
 (&
”r
);

154 ià(!
	`check_´iv
 (
ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
	`dbus_mes§ge_g‘_·th
 (message), "org.freedesktop.hal.leds.brightness")) {

155 
	`HAL_DEBUG
(("User don't havehe…ermissionso callhe interface"));

156  
DBUS_HANDLER_RESULT_HANDLED
;

159 
»¶y
 = 
NULL
;

161 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

164 
brighŠess
;

166 
	`dbus_”rÜ_š™
 (&
”r
);

167 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

168 &
”r
,

169 
DBUS_TYPE_INT32
, &
brighŠess
,

170 
DBUS_TYPE_INVALID
)) {

171 
»tuº_code
 = 0;

172 
£t
;

174 
£t
 = 
	`£t_Ëds_brighŠess
 (
_udi
, 
brighŠess
);

176 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

177 ià(
»¶y
 =ğ
NULL
)

178 
”rÜ
;

180 ià(
£t
 =ğ
brighŠess
)

181 
»tuº_code
 = 0;

183 
»tuº_code
 = 1;

185 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

186 
DBUS_TYPE_INT32
, &
»tuº_code
,

187 
DBUS_TYPE_INVALID
);

189 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

191 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

194 
brighŠess
;

196 
	`dbus_”rÜ_š™
 (&
”r
);

197 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

198 &
”r
,

199 
DBUS_TYPE_INVALID
)) {

200 
brighŠess
 = 
	`g‘_Ëds_brighŠess
(
_udi
);

202 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

203 ià(
»¶y
 =ğ
NULL
)

204 
”rÜ
;

206 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

207 
DBUS_TYPE_INT32
, &
brighŠess
,

208 
DBUS_TYPE_INVALID
);

209 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

213 
”rÜ
:

214 ià(
»¶y
 !ğ
NULL
)

215 
	`dbus_mes§ge_uÄef
 (
»¶y
);

217  
DBUS_HANDLER_RESULT_HANDLED
;

218 
	}
}

221 
	$add_deviû
 (
LibH®CÚ‹xt
 *
ùx
,

222 cÚ¡ *
udi
,

223 cÚ¡ 
LibH®Prİ”tyS‘
 *
´İ”t›s
)

225 
DBusE¼Ü
 
”r
;

226 
DBusCÚÃùiÚ
 *
dbus_cÚÃùiÚ
;

227 cÚ¡ * 
sysfs_·th
;

228 
gboŞ—n
 
š™Ÿlized
 = 
FALSE
;

230 ià((
sysfs_·th
 = 
	`libh®_ps_g‘_¡ršg
 (
´İ”t›s
, "lšux.sysfs_·th")è=ğ
NULL
) {

231 
	`HAL_ERROR
(("% ha nØ´İ”ty†šux.sysfs_·th", 
udi
));

237 ià((
dbus_cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
(
ùx
)è=ğ
NULL
) {

238 
	`HAL_WARNING
 (("Cannot get DBus connection"));

242 ià(!
š™Ÿlized
) {

243 
	`dbus_cÚÃùiÚ_add_f‹r
 (
dbus_cÚÃùiÚ
, 
f‹r_funùiÚ
, 
NULL
, NULL);

244 
š™Ÿlized
 = 
TRUE
;

247 
	`dbus_”rÜ_š™
 (&
”r
);

249 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
ùx
,

250 
udi
,

259 &
”r
)) {

260 
	`HAL_ERROR
 (("Cannot claim interface 'org.freedesktop.Hal.Device.Leds'"));

264 
	`g_hash_bË_š£¹
 (
Ëds
, 
	`g_¡rdup
(
udi
), g_¡rdup(
sysfs_·th
));

265 
	}
}

268 
	$»move_deviû
 (
LibH®CÚ‹xt
 *
ùx
,

269 cÚ¡ *
udi
,

270 cÚ¡ 
LibH®Prİ”tyS‘
 *
´İ”t›s
)

272 
gpoš‹r
 
sysfs_·th
;

273 
gboŞ—n
 
hªdlšg_udi
;

275 
	`HAL_DEBUG
 (("Removšg chªÃÈfÜ '%s'", 
udi
));

277 
hªdlšg_udi
 = 
	`g_hash_bË_lookup_ex‹nded
 (
Ëds
, 
udi
, 
NULL
, &
sysfs_·th
);

279 ià(!
hªdlšg_udi
) {

280 
	`HAL_ERROR
(("DeviûRemovÿÎed fÜ unknowÀdeviû: '%s'.", 
udi
));

284 
	`g_hash_bË_»move
 (
Ëds
, 
udi
);

286 ià(
	`g_hash_bË_size
 (
Ëds
) == 0) {

287 
	`HAL_INFO
(("no more devices,ƒxiting"));

288 
	`g_maš_loİ_qu™
 (
gmaš
);

290 
	}
}

293 
	$maš
 (
¬gc
, *
¬gv
[])

295 
DBusCÚÃùiÚ
 *
dbus_cÚÃùiÚ
;

296 
DBusE¼Ü
 
”rÜ
;

297 cÚ¡ *
commªdlše
;

299 
	`h®_£t_´oc_t™Ë_š™
 (
¬gc
, 
¬gv
);

301 
	`£tup_logg”
 ();

303 
	`dbus_”rÜ_š™
 (&
”rÜ
);

304 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

305 
	`HAL_WARNING
 (("Unableo init†ibhal context"));

306 
out
;

309 ià((
dbus_cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
(
ùx
)è=ğ
NULL
) {

310 
	`HAL_WARNING
 (("Cannot get DBus connection"));

311 
out
;

314 ià((
commªdlše
 = 
	`g‘’v
 ("SINGLETON_COMMAND_LINE")è=ğ
NULL
) {

315 
	`HAL_WARNING
 (("SINGLETON_COMMAND_LINE‚ot set"));

316 
out
;

319 
	`libh®_ùx_£t_sšgËtÚ_deviû_added
 (
ùx
, 
add_deviû
);

320 
	`libh®_ùx_£t_sšgËtÚ_deviû_»moved
 (
ùx
, 
»move_deviû
);

322 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
dbus_cÚÃùiÚ
, 
NULL
);

323 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
 (
dbus_cÚÃùiÚ
, 0);

325 
	`dbus_”rÜ_š™
 (&
”rÜ
);

327 ià(!
	`libh®_deviû_sšgËtÚ_addÚ_is_»ady
 (
ùx
, 
commªdlše
, &
”rÜ
)) {

328 
out
;

331 
Ëds
 = 
	`g_hash_bË_Ãw_fuÎ
 (
g_¡r_hash
, 
g_¡r_equ®
, 
g_ä“
, 
NULL
);

333 
gmaš
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

334 
	`g_maš_loİ_run
 (
gmaš
);

338 
out
:

339 
	`HAL_DEBUG
 (("Anƒrror occured,ƒxiting cleanly"));

340 ià(
ùx
 !ğ
NULL
) {

341 
	`dbus_”rÜ_š™
 (&
”rÜ
);

342 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

343 
	`libh®_ùx_ä“
 (
ùx
);

347 
	}
}

	@hald/linux/addons/addon-macbook-backlight.c

51 #ifdeà
HAVE_CONFIG_H


52 
	~<cÚfig.h
>

55 
	~<pci/pci.h
>

57 
	~<glib.h
>

59 
	~<fú.h
>

60 
	~<¡dio.h
>

61 
	~<¡dlib.h
>

62 
	~<¡ršg.h
>

63 
	~<sys/mmª.h
>

64 
	~<uni¡d.h
>

66 
	#DBUS_API_SUBJECT_TO_CHANGE


	)

68 
	~<dbus/dbus-glib.h
>

69 
	~<dbus/dbus-glib-lowËv–.h
>

70 
	~"libh®/libh®.h
"

71 
	~"../../logg”.h
"

72 
	~"../../ut_h–³r.h
"

73 
	~"../../ut_h–³r_´iv.h
"

75 
	#REGISTER_OFFSET
 0x00061254

	)

76 
	#PAGE_SIZE
 4096

	)

77 
	#PAGE_MASK
 (
PAGE_SIZE
 - 1)

	)

79 
	#ACCESS_OFFSET
 (
REGISTER_OFFSET
 & 
PAGE_MASK
)

	)

80 
	#ACCESS_INDEX
 (
ACCESS_OFFSET
 >> 2)

	)

82 *
	g»gi¡”_·ge
;

83 
LibH®CÚ‹xt
 *
	gh®ùx
 = 
NULL
;

86 
	$d‘”mše_video_ba£_add»ss
 ()

88 
pci_acûss
 *
·cc
;

89 
pci_dev
 *
pdev
;

90 
add»ss
;

91 
i
;

93 
add»ss
 = 0;

95 
·cc
 = 
	`pci_®loc
 ();

96 
	`pci_š™
 (
·cc
);

97 
	`pci_sÿn_bus
 (
·cc
);

99 
pdev
 = 
·cc
->
deviûs
;…dev;…dev =…dev->
Ãxt
) {

100 
	`pci_fl_šfo
 (
pdev
, 
PCI_FILL_IDENT
 | 
PCI_FILL_BASES
);

102 ià(
pdev
->
v’dÜ_id
 =ğ0x8086 &&…dev->
deviû_id
 == 0x27a2)

103 
i
 = 0; i < (è
	`G_N_ELEMENTS
 (
pdev
->
ba£_addr
); i++) {

104 ià(
pdev
->
size
[
i
] == 512 * 1024) {

105 
add»ss
 = 
pdev
->
ba£_addr
[
i
];

106 
’d
;

111 
’d
:

112 
	`pci_ş—nup
 (
·cc
);

114  
add»ss
;

115 
	}
}

117 
gboŞ—n


118 
	$m­_»gi¡”_·ge
 ()

120 
add»ss
;

121 
fd
;

123 
add»ss
 = 
	`d‘”mše_video_ba£_add»ss
 ();

125 ià(
add»ss
 == 0) {

126 
	`HAL_ERROR
 (("Unableo†ocate video base‡ddress"));

127  
FALSE
;

130 
fd
 = 
	`İ’
 ("/dev/mem", 
O_RDWR
);

132 ià(
fd
 < 0) {

133 
	`HAL_ERROR
 (("failedo open /dev/mem"));

134  
FALSE
;

137 
»gi¡”_·ge
 = 
	`mm­
 (
NULL
, 
PAGE_SIZE
, 
PROT_READ
 | 
PROT_WRITE
,

138 
MAP_SHARED
, 
fd
, (
add»ss
 + 
REGISTER_OFFSET
è& ~
PAGE_MASK
);

140 
	`şo£
 (
fd
);

142 
	`drİ_´iveges
 (
FALSE
);

144 ià(
»gi¡”_·ge
 =ğ
MAP_FAILED
) {

145 
	`HAL_ERROR
 (("failedo mmap"));

146  
FALSE
;

149  
TRUE
;

150 
	}
}

153 
	$»gi¡”_g‘
 ()

155  
»gi¡”_·ge
[
ACCESS_INDEX
];

156 
	}
}

159 
	$»gi¡”_£t
 (
v®ue
)

161 
»gi¡”_·ge
[
ACCESS_INDEX
] = 
v®ue
;

162 
	}
}

164 
gboŞ—n


165 
	$backlight_£t
 (
v®ue
)

167 
max
;

169 
max
 = 
	`»gi¡”_g‘
 () >> 17;

172 ià(
max
 == 0x00)

173 
max
 = 0x94;

176 ià(
max
 != 0x94)

177  
FALSE
;

179 
v®ue
 = 
	`CLAMP
 (v®ue, 0x1f, 
max
);

181 
	`»gi¡”_£t
 ((
max
 << 17è| (
v®ue
 << 1));

183  
TRUE
;

184 
	}
}

187 
	$backlight_g‘
 ()

189  (
	`»gi¡”_g‘
 () >> 1) & 0x7fff;

190 
	}
}

193 
	#BACKLIGHT_OBJECT
 \

194 "/Üg/ä“desktİ/H®/deviûs/macbook_backlight"

	)

195 
	#BACKLIGHT_IFACE
 \

196 "Üg.ä“desktİ.H®.Deviû.L­tİPª–"

	)

197 
	#INTERFACE_DESCRIPTION
 \

204 " </m‘hod>\n"

	)

206 
DBusHªdËrResuÉ


207 
	$f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
, 
DBusMes§ge
 * 
mes§ge
, *
u£rd©a
)

209 
DBusMes§ge
 *
»¶y
;

210 
DBusE¼Ü
 
”r
;

211 
Ëv–
;

212 
»t
;

214 ià(!
	`check_´iv
 (
h®ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
	`dbus_mes§ge_g‘_·th
 (message), "org.freedesktop.hal.power-management.lcd-panel")) {

215  
DBUS_HANDLER_RESULT_HANDLED
;

218 
»¶y
 = 
NULL
;

219 
»t
 = 0;

221 
	`dbus_”rÜ_š™
 (&
”r
);

223 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
, 
BACKLIGHT_IFACE
, "SetBrightness")) {

225 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”r
, 
DBUS_TYPE_INT32
,

226 &
Ëv–
, 
DBUS_TYPE_INVALID
)) {

227 
	`backlight_£t
 (
Ëv–
 + 0x1f);

229 ià((
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
)))

230 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
, 
DBUS_TYPE_INT32
,

231 &
»t
, 
DBUS_TYPE_INVALID
);

233 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
, 
BACKLIGHT_IFACE
, "GetBrightness")) {

234 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”r
, 
DBUS_TYPE_INVALID
)) {

235 
Ëv–
 = 
	`backlight_g‘
 () - 0x1f;

236 
Ëv–
 = 
	`CLAMP
 (level, 0, 117);

238 ià((
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
)))

239 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
, 
DBUS_TYPE_INT32
,

240 &
Ëv–
, 
DBUS_TYPE_INVALID
);

244 ià(
»¶y
) {

245 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

246  
DBUS_HANDLER_RESULT_HANDLED
;

249  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

250 
	}
}

253 
	$maš
 (
¬gc
, **
¬gv
)

255 
DBusCÚÃùiÚ
 *
cÚn
;

256 
GMašLoİ
 *
maš_loİ
;

257 cÚ¡ *
udi
;

258 
DBusE¼Ü
 
”r
;

260 
	`£tup_logg”
 ();

261 
udi
 = 
	`g‘’v
 ("UDI");

263 ià(
udi
 =ğ
NULL
)

264 
	`HAL_ERROR
 (("no device specified"));

266 
	`dbus_”rÜ_š™
 (&
”r
);

267 ià((
h®ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”r
)è=ğ
NULL
)

268 
	`HAL_ERROR
 (("cannot connecto hald"));

270 
	`dbus_”rÜ_š™
 (&
”r
);

271 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
h®ùx
, 
udi
, &
”r
)) {

272 
	`HAL_ERROR
 (("libhal_device_addon_is_ready„eturned false,ƒxit‚ow"));

276 ià(!
	`m­_»gi¡”_·ge
 ()) {

277 
	`HAL_ERROR
 (("failedo gain‡ccessohe video card"));

280 
cÚn
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
h®ùx
);

281 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚn
, 
NULL
);

282 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
 (
cÚn
, 0);

284 
	`dbus_cÚÃùiÚ_add_f‹r
 (
cÚn
, 
f‹r_funùiÚ
, 
NULL
, NULL);

286 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
h®ùx
, 
BACKLIGHT_OBJECT
,

287 
BACKLIGHT_IFACE
, 
INTERFACE_DESCRIPTION
, &
”r
))

288 
	`HAL_ERROR
 (("cannot claim interface"));

290 
maš_loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

291 
	`g_maš_loİ_run
 (
maš_loİ
);

294 
	}
}

	@hald/linux/addons/addon-macbookpro-backlight.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<fú.h
>

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<¡ršg.h
>

35 
	~<sys/io.h
>

36 
	~<sys/mmª.h
>

37 
	~<sys/time.h
>

38 
	~<sys/ty³s.h
>

39 
	~<pci/pci.h
>

40 
	~<uni¡d.h
>

42 
	~<glib/gmaš.h
>

43 
	~<dbus/dbus-glib.h
>

44 
	~<dbus/dbus-glib-lowËv–.h
>

46 
	~"libh®/libh®.h
"

47 
	~"../../logg”.h
"

48 
	~"../../ut_h–³r_´iv.h
"

50 
LibH®CÚ‹xt
 *
	gh®ùx
 = 
NULL
;

51 
GMašLoİ
 *
	gmaš_loİ
;

52 *
	gudi
;

53 
DBusCÚÃùiÚ
 *
	gcÚn
;

55 * 
	gmemÜy
;

57 
šlše
 
	$»adl
(cÚ¡ vŞ©*
addr
)

59  *(vŞ©*è
addr
;

60 
	}
}

62 
šlše
 
	$wr™–
(
b
, vŞ©*
addr
)

64 *(vŞ©*è
addr
 = 
b
;

65 
	}
}

67 
	#INREG
(
addr
è
	`»adl
(
memÜy
+addr)

	)

68 
	#OUTREG
(
addr
,
v®
è
	`wr™–
(v®, 
memÜy
+addr)

	)

71 
	$»ad_backlight
 ()

73  
	`INREG
(0x7af8) >> 8;

74 
	}
}

77 
	$wr™e_backlight
 (
v®ue
)

79 
	`OUTREG
(0x7af8, 0x00000001 | (()
v®ue
 << 8));

80 
	}
}

83 
	#LIGHT_SENSOR_LEFT_KEY
 "ALV0"

84 
	#LIGHT_SENSOR_RIGHT_KEY
 "ALV1"

85 
	#BACKLIGHT_KEY
 "LKSB"

86 

	)

87 
	gdebug
 = 0;

89 
timev®
 
	gÏ¡tv
;

90 
timev®
 
	gÃwtv
;

94 
	$s¦“p
 (cÚ¡ 
u£c
)

96 
	`g‘timeofday
(&
Ï¡tv
, 
NULL
);

98 
	`g‘timeofday
(&
Ãwtv
, 
NULL
);

99 ià(((
Ãwtv
.
tv_u£c
 - 
Ï¡tv
.tv_u£cè+ (Òewtv.
tv_£c
 -†a¡tv.tv_£c)*1000000)è> 
u£c
) {

103 
	}
}

106 
	$g‘_¡©us
 ()

108  
	`šb
(0x304);

109 
	}
}

112 
	$wa™ä“
 (
num
)

114 
c
, 
pc
 = -1;

115 
»Œy
 = 100;

116 ((
c
 = 
	`g‘_¡©us
())&0x0Fè!ğ
num
 && 
»Œy
) {

117 
	`s¦“p
(10);

118 
»Œy
--;

119 ià(
pc
 !ğ
c
) {

121 
pc
 = 
c
;

124 ià(
»Œy
 == 0) {

125 
	`´štf
("Wa™ä“ faed %x !ğ%x.\n", 
c
, 
num
);

132 
	}
}

136 
	$wr™ekey
 (* 
key
, 
Ën
, * 
bufãr
)

138 
i
;

140 
	`outb
(0x11, 0x304);

141 ià(!
	`wa™ä“
(0x0c))  0;

143 
i
 = 0; i < 4; i++) {

144 
	`outb
(
key
[
i
], 0x300);

145 ià(!
	`wa™ä“
(0x04))  0;

147 ià(
debug
è
	`´štf
(">%s", 
key
);

149 
	`outb
(
Ën
, 0x300);

150 ià(
debug
è
	`´štf
(">%x", 
Ën
);

152 
i
 = 0; i < 
Ën
; i++) {

153 ià(!
	`wa™ä“
(0x04))  0;

154 
	`outb
(
bufãr
[
i
], 0x300);

155 ià(
debug
è
	`´štf
(">%x", 
bufãr
[
i
]);

157 ià(
debug
è
	`´štf
("\n");

159 
	}
}

162 
	$»adkey
 (* 
key
, 
Ën
, * 
bufãr
)

164 
i
; 
c
;

166 
	`outb
(0x10, 0x304);

167 ià(!
	`wa™ä“
(0x0c))  0;

169 
i
 = 0; i < 4; i++) {

170 
	`outb
(
key
[
i
], 0x300);

171 ià(!
	`wa™ä“
(0x04))  0;

173 ià(
debug
è
	`´štf
("<%s", 
key
);

175 
	`outb
(
Ën
, 0x300);

176 ià(
debug
è
	`´štf
(">%x", 
Ën
);

178 
i
 = 0; i < 
Ën
; i++) {

179 ià(!
	`wa™ä“
(0x05))  0;

180 
c
 = 
	`šb
(0x300);

181 
bufãr
[
i
] = 
c
;

182 ià(
debug
è
	`´štf
("<%x", 
c
);

184 ià(
debug
è
	`´štf
("\n");

186 
	}
}

189 
	$»ad_light_£nsÜ
 (
gboŞ—n
 
Ëá
)

191 
bufãr
[6];

193 ià(
	`»adkey
 (
Ëá
 ? 
LIGHT_SENSOR_LEFT_KEY
 : 
LIGHT_SENSOR_RIGHT_KEY
, 6, 
bufãr
))

194  
bufãr
[2];

197 
	}
}

200 
	$£t_keybßrd_backlight
 (
v®ue
)

202 
bufãr
[2];

203 
bufãr
[0] = 
v®ue
;

204 
bufãr
[1] = 0x00;

205  
	`wr™ekey
 (
BACKLIGHT_KEY
, 2, 
bufãr
);

206 
	}
}

211 
	$»ad_keybßrd_backlight
 ()

213 
bufãr
[6];

215 ià(
	`»adkey
 (
BACKLIGHT_KEY
, 6, 
bufãr
))

216  
bufãr
[2];

219 
	}
}

223 
	gÏ¡_keybßrd_brighŠess
 = -1;

225 
DBusHªdËrResuÉ


226 
	$f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£rd©a
)

228 
DBusE¼Ü
 
”r
;

229 
DBusMes§ge
 *
»¶y
;

230 cÚ¡ *
udi
;

232 
udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

241 
»¶y
 = 
NULL
;

243 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

246 
brighŠess
;

248 ià(!
	`check_´iv
 (
h®ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
udi
, "org.freedesktop.hal.power-management.lcd-panel"))

249 
”rÜ
;

251 
	`dbus_”rÜ_š™
 (&
”r
);

252 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

253 &
”r
,

254 
DBUS_TYPE_INT32
, &
brighŠess
,

255 
DBUS_TYPE_INVALID
)) {

257 ià(
brighŠess
 < 0 || brightness > 228) {

258 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
,

263 
»tuº_code
;

265 
	`wr™e_backlight
 (
brighŠess
 + 27);

267 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

268 ià(
»¶y
 =ğ
NULL
)

269 
”rÜ
;

271 
»tuº_code
 = 0;

272 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

273 
DBUS_TYPE_INT32
, &
»tuº_code
,

274 
DBUS_TYPE_INVALID
);

277 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

280 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

283 
brighŠess
;

285 ià(!
	`check_´iv
 (
h®ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
udi
, "org.freedesktop.hal.power-management.lcd-panel"))

286 
”rÜ
;

288 
	`dbus_”rÜ_š™
 (&
”r
);

289 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

290 &
”r
,

291 
DBUS_TYPE_INVALID
)) {

293 
brighŠess
 = 
	`»ad_backlight
 () - 27;

294 ià(
brighŠess
 < 0)

295 
brighŠess
 = 0;

296 ià(
brighŠess
 > 228)

297 
brighŠess
 = 228;

301 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

302 ià(
»¶y
 =ğ
NULL
)

303 
”rÜ
;

305 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

306 
DBUS_TYPE_INT32
, &
brighŠess
,

307 
DBUS_TYPE_INVALID
);

308 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

311 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

314 
brighŠess
[2];

316 ià(!
	`check_´iv
 (
h®ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
udi
, "org.freedesktop.hal.power-management.light-sensor"))

317 
”rÜ
;

319 
brighŠess
[0] = 
	`»ad_light_£nsÜ
 (
FALSE
);

320 
brighŠess
[1] = 
	`»ad_light_£nsÜ
 (
TRUE
);

322 ià(
brighŠess
[0] == -1 || brightness[1] == -1) {

323 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
,

326 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

328 (*
pb
)[] = &
brighŠess
;

330 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

331 ià(
»¶y
 =ğ
NULL
)

332 
”rÜ
;

334 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

335 
DBUS_TYPE_ARRAY
, 
DBUS_TYPE_INT32
, &
pb
, 2,

336 
DBUS_TYPE_INVALID
);

337 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

339 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

343 ià(!
	`check_´iv
 (
h®ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
udi
, "org.freedesktop.hal.power-management.keyboard-backlight"))

344 
”rÜ
;

347 ià(
Ï¡_keybßrd_brighŠess
 == -1 ) {

348 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
,

351 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

353 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

354 ià(
»¶y
 =ğ
NULL
)

355 
”rÜ
;

357 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

358 
DBUS_TYPE_INT32
, &
Ï¡_keybßrd_brighŠess
,

359 
DBUS_TYPE_INVALID
);

360 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

363 
brighŠess
;

365 
brighŠess
 = 
	`»ad_keybßrd_backlight
 ();

367 ià(
brighŠess
 == -1) {

368 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
,

371 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

373 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

374 ià(
»¶y
 =ğ
NULL
)

375 
”rÜ
;

377 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

378 
DBUS_TYPE_INT32
, &
brighŠess
,

379 
DBUS_TYPE_INVALID
);

380 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

383 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

386 
brighŠess
;

388 ià(!
	`check_´iv
 (
h®ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
udi
, "org.freedesktop.hal.power-management.keyboard-backlight"))

389 
”rÜ
;

391 
	`dbus_”rÜ_š™
 (&
”r
);

392 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

393 &
”r
,

394 
DBUS_TYPE_INT32
, &
brighŠess
,

395 
DBUS_TYPE_INVALID
)) {

397 ià(
brighŠess
 < 0 || brightness > 255) {

398 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
,

403 
	`£t_keybßrd_backlight
 (
brighŠess
);

404 
Ï¡_keybßrd_brighŠess
 = 
brighŠess
;

406 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

407 ià(
»¶y
 =ğ
NULL
)

408 
”rÜ
;

411 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

416 
”rÜ
:

417 ià(
»¶y
 !ğ
NULL
)

418 
	`dbus_mes§ge_uÄef
 (
»¶y
);

420  
DBUS_HANDLER_RESULT_HANDLED
;

421 
	}
}

424 
	$maš
 (
¬gc
, *
¬gv
[])

426 
off_t
 
add»ss
 = 0;

427 
size_t
 
Ëngth
 = 0;

428 
fd
;

429 
¡©e
;

430 
pci_acûss
 *
·cc
;

431 
pci_dev
 *
dev
;

433 
DBusE¼Ü
 
”r
;

435 
	`£tup_logg”
 ();

436 
udi
 = 
	`g‘’v
 ("UDI");

438 
	`HAL_DEBUG
 (("udi=%s", 
udi
));

439 ià(
udi
 =ğ
NULL
) {

440 
	`HAL_ERROR
 (("No device specified"));

444 
	`dbus_”rÜ_š™
 (&
”r
);

445 ià((
h®ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”r
)è=ğ
NULL
) {

446 
	`HAL_ERROR
 (("Cannot connecto hald"));

450 
	`dbus_”rÜ_š™
 (&
”r
);

451 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
h®ùx
, 
udi
, &
”r
)) {

456 
cÚn
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
h®ùx
);

457 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚn
, 
NULL
);

458 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
 (
cÚn
, 0);

460 
	`dbus_cÚÃùiÚ_add_f‹r
 (
cÚn
, 
f‹r_funùiÚ
, 
NULL
, NULL);

467 
·cc
 = 
	`pci_®loc
();

468 
	`pci_š™
(
·cc
);

469 
	`pci_sÿn_bus
(
·cc
);

470 
dev
=
·cc
->
deviûs
; dev; dev=dev->
Ãxt
) {

471 
	`pci_fl_šfo
(
dev
, 
PCI_FILL_IDENT
 | 
PCI_FILL_BASES
);

472 ià((
dev
->
v’dÜ_id
 =ğ0x1002è&& (dev->
deviû_id
 == 0x71c5)) {

473 
add»ss
 = 
dev
->
ba£_addr
[2];

474 
Ëngth
 = 
dev
->
size
[2];

477 
	`pci_ş—nup
(
·cc
);

479 
	`HAL_DEBUG
 (("add¸0x%x†’=%d", 
add»ss
, 
Ëngth
));

481 ià(!
add»ss
) {

482 
	`HAL_DEBUG
 (("Failedo detect ATI X1600,‡borting..."));

486 
fd
 = 
	`İ’
 ("/dev/mem", 
O_RDWR
);

488 ià(
fd
 < 0) {

489 
	`HAL_DEBUG
 (("cannot open /dev/mem"));

493 
memÜy
 = 
	`mm­
 (
NULL
, 
Ëngth
, 
PROT_READ
|
PROT_WRITE
, 
MAP_SHARED
, 
fd
, 
add»ss
);

495 ià(
memÜy
 =ğ
MAP_FAILED
) {

496 
	`HAL_ERROR
 (("mmap failed"));

501 
	`OUTREG
(0x4dc, 0x00000005);

502 
¡©e
 = 
	`INREG
(0x7ae4);

503 
	`OUTREG
(0x7«4, 
¡©e
);

505 ià(
	`iİ”m
 (0x300, 0x304, 1) < 0) {

506 
	`HAL_ERROR
 (("ioperm failed (you should be„oot)."));

507 
	`ex™
(1);

511 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
h®ùx
,

521 &
”r
)) {

522 
	`HAL_ERROR
 (("Cannot claim interface 'org.freedesktop.Hal.Device.LaptopPanel'"));

525 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
h®ùx
,

531 &
”r
)) {

532 
	`HAL_ERROR
 (("Cannot claim interface 'org.freedesktop.Hal.Device.LightSensor'"));

535 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
h®ùx
,

544 &
”r
)) {

545 
	`HAL_ERROR
 (("Cannot claim interface 'org.freedesktop.Hal.Device.KeyboardBacklight'"));

549 
maš_loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

550 
	`g_maš_loİ_run
 (
maš_loİ
);

552 
	}
}

	@hald/linux/addons/addon-mmc.c

23 #ifdeà
HAVE_CONFIG_H


24 
	~<cÚfig.h
>

27 
	~<¡dio.h
>

28 
	~<¡dlib.h
>

29 
	~<¡ršg.h
>

30 
	~<uni¡d.h
>

32 
	~<glib.h
>

34 
	~"libh®/libh®.h
"

35 
	~"../../logg”.h
"

36 
	~"../../ut_h–³r.h
"

39 
gch¬
 *
	gsw™ch_ty³_¡©es
[2] =

44 
_Sw™chDesc
 
	tSw™chDesc
;

45 
	s_Sw™chDesc


47 
gch¬
 *
	mudi
;

48 
gch¬
 *
	mty³
;

49 
gboŞ—n
 
	m¡©e
;

52 
LibH®CÚ‹xt
 *
	gùx
 = 
NULL
;

54 
gšt


55 
	$£tup_sysfs_pŞl
 (cÚ¡ *
fe
, 
GIOFunc
 
sysfs_fe_cb
, 
Sw™chDesc
 *
desc
)

57 
GIOChªÃl
 *
gioch
;

58 
GE¼Ü
 *
”rÜ
 = 
NULL
;

59 
gsize
 
Ën
;

60 
gch¬
 *
dump
 = 
NULL
;

61 
GIOStus
 
»t
;

63 
gioch
 = 
	`g_io_chªÃl_Ãw_fe
 (
fe
, "r", &
”rÜ
);

64 ià(
gioch
 =ğ
NULL
) {

65 
	`HAL_ERROR
 (("g_io_chªÃl_Ãw_fe(èfÜ % çed: %s", 
fe
,

66 
”rÜ
->
mes§ge
));

67 
	`g_”rÜ_ä“
 (
”rÜ
);

72 
»t
 = 
	`g_io_chªÃl_»ad_to_’d
 (
gioch
, &
dump
, &
Ën
, &
”rÜ
);

73 ià(
»t
 =ğ
G_IO_STATUS_NORMAL
) {

74 
	`g_ä“
 (
dump
);

76 ià(
”rÜ
 !ğ
NULL
) {

77 
	`HAL_ERROR
 (("g_io_chªÃl_»ad_to_’d(): %s", 
”rÜ
->
mes§ge
));

78 
	`g_”rÜ_ä“
 (
”rÜ
);

81 
	`g_io_chªÃl_£ek_pos™iÚ
 (
gioch
, 0, 
G_SEEK_SET
, &
”rÜ
);

82 ià(
”rÜ
 !ğ
NULL
) {

83 
	`HAL_ERROR
 (("g_io_chªÃl_£ek_pos™iÚ(): %s", 
”rÜ
->
mes§ge
));

84 
	`g_”rÜ_ä“
 (
”rÜ
);

87  
	`g_io_add_w©ch
 (
gioch
, 
G_IO_IN
 | 
G_IO_PRI
 | 
G_IO_ERR
,

88 
sysfs_fe_cb
, (
gpoš‹r
)
desc
);

89 
	}
}

91 
gboŞ—n


92 
	$´oûss_sw™ch_¡©e
 (
Sw™chDesc
 *
desc
, 
gch¬
 *
¡©e_¡r
, 
gsize
 
Ën
)

94 
gboŞ—n
 
Ãw_¡©e
;

95 
gch¬
 *
¡r
;

97 
¡r
 = 
	`g_¡rchomp
 (
¡©e_¡r
);

98 ià(0 =ğ
	`¡ºcmp
 (
¡r
, 
sw™ch_ty³_¡©es
[1], 
Ën
))

99 
Ãw_¡©e
 = 
TRUE
;

100 ià(0 =ğ
	`¡ºcmp
 (
¡r
, 
sw™ch_ty³_¡©es
[0], 
Ën
))

101 
Ãw_¡©e
 = 
FALSE
;

103 
	`HAL_ERROR
 (("unknowÀsw™ch s‹ %s", 
¡r
));

104  
TRUE
;

107 
	`HAL_DEBUG
 (("Ãw_¡©e=%d", 
Ãw_¡©e
));

108 ià(
Ãw_¡©e
 !ğ
desc
->
¡©e
) {

109 
DBusE¼Ü
 
”rÜ
;

111 
	`dbus_”rÜ_š™
 (&
”rÜ
);

112 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
desc
->
udi
,

113 "bu‰Ú.¡©e.v®ue", 
Ãw_¡©e
,

114 &
”rÜ
);

116 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

117 
	`HAL_ERROR
 (("Failedo set…roperty: %s",

118 
”rÜ
.
mes§ge
));

119 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

120  
FALSE
;

123 
	`dbus_”rÜ_š™
 (&
”rÜ
);

124 
	`libh®_deviû_em™_cÚd™iÚ
 (
ùx
, 
desc
->
udi
,

125 "Bu‰ÚP»s£d", 
desc
->
ty³
,

126 &
”rÜ
);

127 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

128 
	`HAL_ERROR
 (("Failedo send condition: %s",

129 
”rÜ
.
mes§ge
));

130 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

131  
FALSE
;

133 
desc
->
¡©e
 = 
Ãw_¡©e
;

135 
	`g_ä“
 (
¡r
);

137  
TRUE
;

138 
	}
}

140 
gboŞ—n


141 
	$sw™ch_¡©e_chªged
 (
GIOChªÃl
 *
sourû
,

142 
GIOCÚd™iÚ
 
cÚd™iÚ
,

143 
gpoš‹r
 
d©a
)

145 
Sw™chDesc
 *
desc
 = (Sw™chDesc*è
d©a
;

146 
GIOStus
 
»t
;

148 
	`HAL_DEBUG
 (("% ¡©chªged, cÚd™iÚ=%d", 
desc
->
udi
, 
cÚd™iÚ
));

149 ià(
cÚd™iÚ
 & 
G_IO_IN
 || cÚd™iÚ & 
G_IO_PRI
) {

150 
gch¬
 *
¡©e_¡r
 = 
NULL
;

151 
gsize
 
Ën
;

152 
GE¼Ü
 *
g”rÜ
 = 
NULL
;

154 
	`HAL_DEBUG
 (("Reading†ine"));

155 
»t
 = 
	`g_io_chªÃl_»ad_lše
 (
sourû
, &
¡©e_¡r
, &
Ën
, 
NULL
,

156 &
g”rÜ
);

158 
	`HAL_DEBUG
 (("»ad†še: sŒ=%s,†’=%d", 
¡©e_¡r
, 
Ën
));

159 
	`g_io_chªÃl_£ek_pos™iÚ
 (
sourû
, 0, 
G_SEEK_SET
, &
g”rÜ
);

160 ià(
¡©e_¡r
)

161  
	`´oûss_sw™ch_¡©e
 (
desc
, 
¡©e_¡r
, 
Ën
);

162 } ià(
cÚd™iÚ
 & 
G_IO_ERR
) {

163 
	`HAL_ERROR
 (("E¼Ü oÀ%s", 
desc
->
udi
));

164 
	`g_io_chªÃl_uÄef
 (
sourû
);

165  
FALSE
;

167 
	`HAL_ERROR
 (("unknowÀGIOCÚd™iÚ: %d", 
cÚd™iÚ
));

168 
	`g_io_chªÃl_uÄef
 (
sourû
);

169  
FALSE
;

172  
TRUE
;

173 
	}
}

176 
	$maš
 (
¬gc
, **
¬gv
)

178 
DBusE¼Ü
 
”rÜ
;

179 
LibH®ChªgeS‘
 *
cs
;

180 
GMašLoİ
 *
maš_loİ
;

181 
gch¬
 *
udi
, *
sysfs_·th
, *
¡©e_·th
;

182 
gch¬
 
¡©e
[32];

183 
Sw™chDesc
 *
desc
;

184 
FILE
 *
å
;

186 
	`h®_£t_´oc_t™Ë_š™
 (
¬gc
, 
¬gv
);

188 
	`£tup_logg”
();

190 
	`HAL_INFO
 (("addon-mmc„unning"));

192 
udi
 = 
	`g‘’v
("UDI");

193 ià(!
udi
) {

194 
	`HAL_ERROR
 (("Failedo get UDI"));

198 
	`dbus_”rÜ_š™
 (&
”rÜ
);

199 
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
);

200 ià(
ùx
 =ğ
NULL
) {

201 
	`HAL_ERROR
 (("Unableo initialise†ibhal context: %s",

202 
”rÜ
.
mes§ge
));

206 
	`dbus_”rÜ_š™
 (&
”rÜ
);

207 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
ùx
, 
udi
, &
”rÜ
)) {

208 
	`HAL_INFO
 (("Deviû % nÙ„—dy y‘: %s", 
udi
, 
”rÜ
.
mes§ge
));

212 
sysfs_·th
 = 
	`g‘’v
 ("HAL_PROP_LINUX_SYSFS_PATH");

213 ià(!
sysfs_·th
) {

214 
	`HAL_ERROR
 (("Property†inux.sysfs_path‚ot set for device"));

218 
	`HAL_INFO
 (("sysfs_·th=%s", 
sysfs_·th
));

219 
desc
 = 
	`g_Ãw
 (
Sw™chDesc
, 1);

221 
desc
->
udi
 = udi;

222 
desc
->
ty³
 = "cover";

224 
	`HAL_INFO
 (("ty³=%d", 
desc
->
ty³
));

225 
¡©e_·th
 = 
	`g_¡rcÚÿt
 (
sysfs_·th
, "/cov”_sw™ch", 
NULL
);

226 
å
 = 
	`fİ’
 (
¡©e_·th
, "r");

227 ià(!
å
) {

228 
	`HAL_ERROR
 (("FaedØİ’ %s", 
¡©e_·th
));

232 ià(
	`fsÿnf
 (
å
, "%31s", 
¡©e
) == 0) {

233 
	`HAL_ERROR
 (("UÇbËØd‘”mšsw™ch s‹ fÜ %s", 
udi
));

237 ià(0 =ğ
	`¡rcmp
 (
¡©e
, 
sw™ch_ty³_¡©es
[1]))

238 
desc
->
¡©e
 = 
TRUE
;

239 ià(0 =ğ
	`¡rcmp
 (
¡©e
, 
sw™ch_ty³_¡©es
[0]))

240 
desc
->
¡©e
 = 
FALSE
;

242 
	`HAL_ERROR
(("unknowÀsw™ch s‹ %s", 
¡©e
));

246 
	`fşo£
 (
å
);

248 
	`HAL_INFO
 (("deviûy³=%s, s‹=%d", 
desc
->
ty³
, desc->
¡©e
));

250 
cs
 = 
	`libh®_deviû_Ãw_chªge£t
 (
desc
->
udi
);

251 ià(
cs
 =ğ
NULL
) {

252 
	`HAL_ERROR
 (("Cannot initialize changeset"));

256 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "bu‰Ú.ty³", 
desc
->
ty³
);

257 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "bu‰Ú.has_¡©e", 
TRUE
);

258 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "bu‰Ú.¡©e.v®ue", 
desc
->
¡©e
);

260 
	`libh®_deviû_comm™_chªge£t
 (
ùx
, 
cs
, &
”rÜ
);

261 
	`libh®_deviû_ä“_chªge£t
 (
cs
);

263 
	`drİ_´iveges
 (0);

265 
	`h®_£t_´oc_t™Ë
 ("h®d-addÚ-mmc:†i¡’šg oÀ%s", 
¡©e_·th
);

267 
	`£tup_sysfs_pŞl
 (
¡©e_·th
, 
sw™ch_¡©e_chªged
, 
desc
);

269 
	`g_ä“
 (
¡©e_·th
);

271 
maš_loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

272 
	`g_maš_loİ_run
 (
maš_loİ
);

275 
	}
}

	@hald/linux/addons/addon-omap-backlight.c

28 #ifdeà
HAVE_CONFIG_H


29 
	~<cÚfig.h
>

32 
	~<fú.h
>

33 
	~<¡dio.h
>

34 
	~<¡dlib.h
>

35 
	~<¡ršg.h
>

36 
	~<sys/io.h
>

37 
	~<sys/mmª.h
>

38 
	~<sys/time.h
>

39 
	~<sys/ty³s.h
>

40 
	~<sys/¡©.h
>

41 
	~<fú.h
>

42 
	~<uni¡d.h
>

44 
	~<glib/gmaš.h
>

45 
	~<dbus/dbus-glib.h
>

46 
	~<dbus/dbus-glib-lowËv–.h
>

48 
	~"libh®/libh®.h
"

49 
	~"../../logg”.h
"

50 
	~"../../ut_h–³r.h
"

51 
	~"../../ut_h–³r_´iv.h
"

53 
GMašLoİ
 *
	gmaš_loİ
;

54 
LibH®CÚ‹xt
 *
	gh®ùx
 = 
NULL
;

55 *
	gudi
;

56 
DBusCÚÃùiÚ
 *
	gcÚn
;

58 
	#NUM_BUF_LEN
 11

	)

60 
	gbufãr
[
NUM_BUF_LEN
];

62 
	sbacklight


64 (*
	m£t_backlight_Ëv–
è(
backlight
 *
	mbl
, 
	mi
);

65 (*
	mg‘_backlight_Ëv–
è(
backlight
 *
	mbl
);

66 (*
	mbacklight_š™
è(
backlight
 *
	mbl
);

67 
	mbl_mš
;

68 
	mbl_max
;

71 
backlight
 
	gbl_d©a
;

75 
	$»ad_backlight
 (
backlight
 * 
bl
)

77 
fd
, 
»t
;

79 
fd
 = 
	`İ’
 ("/sys/deviûs/¶©fÜm/om­fb/·Ãl/backlight_Ëv–", 
O_RDONLY
);

80 ià(
fd
 < 0)

83 
»t
 = 
	`»ad
 (
fd
, 
bufãr
, 
NUM_BUF_LEN
);

84 
	`şo£
 (
fd
);

86 ià(
»t
 >= 0)

87  
	`©oi
 (
bufãr
);

90 
	}
}

98 
	$backlight_š™
 (
backlight
 * 
bl
)

100 
fd
, 
»t
;

103 
fd
 = 
	`İ’
 ("/sys/deviûs/¶©fÜm/om­fb/·Ãl/backlight_max", 
O_RDONLY
);

104 ià(
fd
 < 0)

107 
»t
 = 
	`»ad
(
fd
, 
bufãr
, 
NUM_BUF_LEN
 - 1);

108 
	`şo£
(
fd
);

110 ià(
»t
 >= 0)

111 
bl
->
bl_max
 = 
	`©oi
 (
bufãr
);

112 
	}
}

116 
	$wr™e_backlight
 (
backlight
 * 
bl
, 
Ëv–
)

118 
fd
, 
l
, 
»t
;

121 ià(
Ëv–
 > 
bl
->
bl_max
)

122 
Ëv–
 = 
bl
->
bl_max
;

124 ià(
Ëv–
 < 
bl
->
bl_mš
)

125 
Ëv–
 = 
bl
->
bl_mš
;

127 
fd
 = 
	`İ’
 ("/sys/deviûs/¶©fÜm/om­fb/·Ãl/backlight_Ëv–", 
O_WRONLY
);

128 ià(
fd
 < 0)

131 
l
 = 
	`¢´štf
 (
bufãr
, 
NUM_BUF_LEN
 - 1, "%d", 
Ëv–
);

133 ià(
l
 < (
NUM_BUF_LEN
 - 1))

134 
	`wr™e
 (
fd
, 
bufãr
, 
l
);

136 
	`şo£
 (
fd
);

137 
	}
}

141 
DBusHªdËrResuÉ


142 
	$f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£rd©a
)

144 
DBusE¼Ü
 
”r
;

145 
DBusMes§ge
 *
»¶y
;

147 ià(!
	`check_´iv
 (
h®ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
	`dbus_mes§ge_g‘_·th
 (message),

149  
DBUS_HANDLER_RESULT_HANDLED
;

152 #ifdeà
DEBUG_OMAP_BL


153 
	`dbg
 ("filter_function: sender=%s destination=%s obj_path=%s interface=%s method=%s",

154 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
),

155 
	`dbus_mes§ge_g‘_de¡š©iÚ
 (
mes§ge
),

156 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

157 
	`dbus_mes§ge_g‘_š‹rçû
 (
mes§ge
),

158 
	`dbus_mes§ge_g‘_memb”
 (
mes§ge
));

160 
»¶y
 = 
NULL
;

162 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

165 
brighŠess
;

167 
	`dbus_”rÜ_š™
 (&
”r
);

168 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

169 &
”r
,

170 
DBUS_TYPE_INT32
, &
brighŠess
,

171 
DBUS_TYPE_INVALID
)) {

172 ià(
brighŠess
 < 0 || brightness > 228) {

173 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ
 (
mes§ge
,

177 
»tuº_code
;

179 
bl_d©a
.
	`£t_backlight_Ëv–
 (&bl_d©a, 
brighŠess
);

181 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

182 ià(
»¶y
 =ğ
NULL
)

183 
”rÜ
;

185 
»tuº_code
 = 0;

186 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

187 
DBUS_TYPE_INT32
, &
»tuº_code
,

188 
DBUS_TYPE_INVALID
);

191 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

193 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

196 
brighŠess
;

198 
	`dbus_”rÜ_š™
 (&
”r
);

199 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

200 &
”r
,

201 
DBUS_TYPE_INVALID
)) {

203 
brighŠess
 = 
bl_d©a
.
	`g‘_backlight_Ëv–
 (&bl_data);

204 ià(
brighŠess
 < 
bl_d©a
.
bl_mš
)

205 
brighŠess
 = 
bl_d©a
.
bl_mš
;

206 ià(
brighŠess
 > 
bl_d©a
.
bl_max
)

207 
brighŠess
 = 
bl_d©a
.
bl_max
;

211 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

212 ià(
»¶y
 =ğ
NULL
)

213 
”rÜ
;

215 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

216 
DBUS_TYPE_INT32
, &
brighŠess
,

217 
DBUS_TYPE_INVALID
);

218 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

222 
”rÜ
:

223 ià(
»¶y
 !ğ
NULL
)

224 
	`dbus_mes§ge_uÄef
 (
»¶y
);

226  
DBUS_HANDLER_RESULT_HANDLED
;

227 
	}
}

231 
	$£tup_cb
 ()

233 
	`mem£t
 (&
bl_d©a
, 0,  (
backlight
));

234 
bl_d©a
.
backlight_š™
 = backlight_init;

235 
bl_d©a
.
g‘_backlight_Ëv–
 = 
»ad_backlight
;

236 
bl_d©a
.
£t_backlight_Ëv–
 = 
wr™e_backlight
;

237 
	}
}

240 
	$maš
 (
¬gc
, *
¬gv
[])

242 
DBusE¼Ü
 
”r
;

244 
	`£tup_logg”
 ();

245 
	`£tup_cb
 ();

246 
udi
 = 
	`g‘’v
 ("UDI");

248 
	`HAL_DEBUG
 (("udi=%s", 
udi
));

249 ià(
udi
 =ğ
NULL
) {

250 
	`HAL_ERROR
 (("No device specified"));

254 
	`dbus_”rÜ_š™
 (&
”r
);

255 ià((
h®ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”r
)è=ğ
NULL
) {

256 
	`HAL_ERROR
 (("Cannot connecto hald"));

260 
cÚn
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
h®ùx
);

261 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚn
, 
NULL
);

263 
	`dbus_cÚÃùiÚ_add_f‹r
 (
cÚn
, 
f‹r_funùiÚ
, 
NULL
, NULL);

265 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
h®ùx
,

275 &
”r
)) {

276 
	`HAL_ERROR
 (("Cannot claim interface 'org.freedesktop.Hal.Device.LaptopPanel'"));

280 
	`dbus_”rÜ_š™
 (&
”r
);

281 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
h®ùx
, 
udi
, &
”r
)) {

285 
bl_d©a
.
	`backlight_š™
 (&bl_data);

286 
maš_loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

287 
	`g_maš_loİ_run
 (
maš_loİ
);

289 
	}
}

	@hald/linux/addons/addon-omap-gpio.c

23 #ifdeà
HAVE_CONFIG_H


24 
	~<cÚfig.h
>

27 
	~<¡dio.h
>

28 
	~<¡dlib.h
>

29 
	~<¡ršg.h
>

30 
	~<uni¡d.h
>

31 
	~<fú.h
>

33 
	~<glib.h
>

34 
	~<glib/g´štf.h
>

35 
	~<dbus/dbus-glib-lowËv–.h
>

37 
	~"libh®/libh®.h
"

39 
	~"../../logg”.h
"

40 
	~"../../ut_h–³r.h
"

45 
	mSWITCH_TYPE_UNKNOWN
 = 0,

46 
	mSWITCH_TYPE_COVER
,

47 
	mSWITCH_TYPE_CONNECTION
,

48 
	mSWITCH_TYPE_ACTIVITY
,

51 
gch¬
 *
	gsw™ch_ty³_Çmes
[] =

59 
gch¬
 *
	gsw™ch_ty³_¡©es
[][2] =

67 
_Sw™chDesc
 
	tSw™chDesc
;

68 
	s_Sw™chDesc


70 
gšt
 
	mty³
;

71 
gboŞ—n
 
	m¡©e
;

72 
gch¬
 
	mudi
[1];

75 
LibH®CÚ‹xt
 *
	gùx
 = 
NULL
;

76 
GMašLoİ
 *
	gmaš_loİ
;

77 
GHashTabË
 *
	gsw™ches
 = 
NULL
;

78 
GLi¡
 *
	gdeviûs
 = 
NULL
;

81 
	$gpio_sw™ch_¡r_to_boŞ
 (
gšt
 
ty³
, 
gch¬
 *
¡©e_¡r
, 
gboŞ—n
 *
¡©e_boŞ
)

83 
”rÜ
 = 0;

84 
gch¬
 *
¡r
;

86 
¡r
 = 
	`g_¡rchomp
 (
¡©e_¡r
);

87 ià(0 =ğ
	`¡rcmp
 (
¡r
, 
sw™ch_ty³_¡©es
[
ty³
][1]))

88 *
¡©e_boŞ
 = 
TRUE
;

89 ià(0 =ğ
	`¡rcmp
 (
¡r
, 
sw™ch_ty³_¡©es
[
ty³
][0]))

90 *
¡©e_boŞ
 = 
FALSE
;

92 
	`HAL_ERROR
 (("unknowÀsw™ch s‹ %s", 
¡r
));

93 
”rÜ
 = 1;

96  
”rÜ
;

97 
	}
}

99 
gboŞ—n


100 
	$gpio_´oûss_sw™ch
 (
Sw™chDesc
 *
desc
, 
gch¬
 *
¡©e_¡r
, 
gsize
 
Ën
)

102 
gboŞ—n
 
Ãw_¡©e
;

104 ià(
	`gpio_sw™ch_¡r_to_boŞ
 (
desc
->
ty³
, 
¡©e_¡r
, &
Ãw_¡©e
))

105  
TRUE
;

107 
	`HAL_DEBUG
 (("Ãw_¡©e=%d", 
Ãw_¡©e
));

108 ià(
Ãw_¡©e
 !ğ
desc
->
¡©e
) {

109 
DBusE¼Ü
 
”rÜ
;

111 
	`dbus_”rÜ_š™
 (&
”rÜ
);

112 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
desc
->
udi
,

113 "bu‰Ú.¡©e.v®ue", 
Ãw_¡©e
,

114 &
”rÜ
);

116 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

117 
	`HAL_ERROR
 (("Failedo set…roperty: %s",

118 
”rÜ
.
mes§ge
));

119 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

120  
FALSE
;

123 
	`dbus_”rÜ_š™
 (&
”rÜ
);

124 
	`libh®_deviû_em™_cÚd™iÚ
 (
ùx
, 
desc
->
udi
,

125 "Bu‰ÚP»s£d", 
sw™ch_ty³_Çmes
[
desc
->
ty³
],

126 &
”rÜ
);

127 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

128 
	`HAL_ERROR
 (("Failedo send condition: %s",

129 
”rÜ
.
mes§ge
));

130 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

131  
FALSE
;

133 
desc
->
¡©e
 = 
Ãw_¡©e
;

136  
TRUE
;

137 
	}
}

139 
gboŞ—n


140 
	$gpio_¡©e_chªged
 (
GIOChªÃl
 *
sourû
,

141 
GIOCÚd™iÚ
 
cÚd™iÚ
,

142 
gpoš‹r
 
d©a
)

144 
Sw™chDesc
 *
desc
 = (Sw™chDesc*è
d©a
;

145 
GIOStus
 
»t
;

147 
	`HAL_DEBUG
 (("% ¡©chªged, cÚd™iÚ=%d", 
desc
->
udi
, 
cÚd™iÚ
));

148 ià(
cÚd™iÚ
 & 
G_IO_IN
 || cÚd™iÚ & 
G_IO_PRI
) {

149 
gch¬
 *
¡©e_¡r
 = 
NULL
;

150 
gsize
 
Ën
;

151 
GE¼Ü
 *
g”rÜ
 = 
NULL
;

153 
	`HAL_DEBUG
 (("Reading†ine"));

154 
»t
 = 
	`g_io_chªÃl_»ad_lše
 (
sourû
, &
¡©e_¡r
, &
Ën
, 
NULL
,

155 &
g”rÜ
);

157 
	`HAL_DEBUG
 (("»ad†še: sŒ=%s,†’=%d", 
¡©e_¡r
, 
Ën
));

158 
	`g_io_chªÃl_£ek_pos™iÚ
 (
sourû
, 0, 
G_SEEK_SET
, &
g”rÜ
);

159 ià(
¡©e_¡r
)

160  
	`gpio_´oûss_sw™ch
 (
desc
, 
¡©e_¡r
, 
Ën
);

161 } ià(
cÚd™iÚ
 & 
G_IO_ERR
) {

162 
	`HAL_ERROR
 (("E¼Ü oÀ%s", 
desc
->
udi
));

163 
	`g_io_chªÃl_uÄef
 (
sourû
);

164  
FALSE
;

166 
	`HAL_ERROR
 (("unknowÀGIOCÚd™iÚ: %d", 
cÚd™iÚ
));

167 
	`g_io_chªÃl_uÄef
 (
sourû
);

168  
FALSE
;

171  
TRUE
;

172 
	}
}

175 
	$upd©e_´oc_t™Ë
 ()

177 
GLi¡
 *
Í
;

178 
gch¬
 *
Ãw_commªd_lše
, *
p
;

179 
gšt
 
Ën
 = 0;

181 
Í
 = 
deviûs
;†p;†°ğÍ->
Ãxt
)

182 
Ën
 =†’ + 
	`¡¾’
 (
Í
->
d©a
) + 1;

184 
Ën
 +ğ
	`¡¾’
 ("hald-addon-gpio:†istening on");

186 
Ãw_commªd_lše
 = 
	`g_m®loc
 (
Ën
 + 1);

187 
p
 = 
Ãw_commªd_lše
;

188 
p
 +ğ
	`g_¥rštf
 (
Ãw_commªd_lše
, "hald-addon-gpio:†istening on");

190 
Í
 = 
	`g_li¡_Ï¡
 (
deviûs
);†p;†°ğ
	`g_li¡_´evious
 (lp))

191 
p
 +ğ
	`g_¥rštf
 (p, " %s", (
gch¬
*è
Í
->
d©a
);

193 
	`h®_£t_´oc_t™Ë
 (
Ãw_commªd_lše
);

194 
	`g_ä“
 (
Ãw_commªd_lše
);

195 
	}
}

198 
	$de¡roy_d©a
 (
Sw™chDesc
 *
desc
)

200 
	`HAL_DEBUG
 (("GPIO deviû '%s' de¡royed, f»d©a.", 
desc
->
udi
));

202 
	`g_ä“
 (
desc
);

203 
	}
}

206 
	$»ad_lše_bufãr
 (cÚ¡ *
f’ame
, *
buf
, 
Ën
)

208 
FILE
 *
å
;

209 
r
;

211 
å
 = 
	`fİ’
 (
f’ame
, "r");

212 ià(!
å
) {

213 
	`HAL_ERROR
 (("FaedØİ’ '%s'", 
f’ame
));

217 
r
 = 
	`fsÿnf
 (
å
, "%31s", 
buf
);

218 
	`fşo£
 (
å
);

220 ià(
r
 == 0) {

221 
	`HAL_ERROR
 (("FaedØ»ad f'%s' cÚ‹Ás", 
f’ame
));

226 
	}
}

229 
	$add_deviû
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
,

230 cÚ¡ 
LibH®Prİ”tyS‘
 *
´İ”t›s
)

232 
GIOChªÃl
 *
chªÃl
;

233 
GIOStus
 
»t
;

234 
GE¼Ü
 *
g”rÜ
 = 
NULL
;

235 
DBusE¼Ü
 
”rÜ
;

236 
Sw™chDesc
 *
desc
;

237 
udi_Ën
 = 
	`¡¾’
 (
udi
);

238 cÚ¡ *
sysfs_·th
;

239 *
ty³_·th
, *
deviû_fe
;

240 
ty³
[32], 
¡©e
[32];

241 
size_t
 
dump_Ën
;

242 *
dump
 = 
NULL
;

244 
desc
 = (
Sw™chDesc
 *è
	`g_m®loc
 ( (Sw™chDescè+ 
udi_Ën
);

246 
	`memıy
 (&(
desc
->
udi
), udi, 
udi_Ën
 + 1);

248 
sysfs_·th
 = 
	`libh®_ps_g‘_¡ršg
 (
´İ”t›s
, "linux.sysfs_path");

249 ià(!
sysfs_·th
) {

250 
	`HAL_ERROR
 (("% ha nØ´İ”ty†šux.sysfs_·th", 
udi
));

254 
	`HAL_INFO
 (("sysfs_·th=%s", 
sysfs_·th
));

257 
ty³_·th
 = 
	`g_¡rcÚÿt
 (
sysfs_·th
, "/ty³", 
NULL
);

258 ià(
	`»ad_lše_bufãr
 (
ty³_·th
, 
ty³
,  (type) - 1)) {

259 
	`HAL_ERROR
 (("UÇbËØd‘”mšsw™chy³ fÜ %s", 
udi
));

260 
	`g_ä“
 (
ty³_·th
);

261 
	`g_ä“
 (
desc
);

264 
	`g_ä“
 (
ty³_·th
);

266 ià(0 =ğ
	`¡rcmp
 (
ty³
, "activity"))

267 
desc
->
ty³
 = 
SWITCH_TYPE_ACTIVITY
;

268 ià(0 =ğ
	`¡rcmp
 (
ty³
, "connection"))

269 
desc
->
ty³
 = 
SWITCH_TYPE_CONNECTION
;

270 ià(0 =ğ
	`¡rcmp
 (
ty³
, "cover"))

271 
desc
->
ty³
 = 
SWITCH_TYPE_COVER
;

273 
	`HAL_ERROR
 (("UnknowÀsw™chy³ %s", 
ty³
));

274 
	`g_ä“
 (
desc
);

278 
	`HAL_INFO
 (("ty³ = %d", 
desc
->
ty³
));

281 
	`dbus_”rÜ_š™
 (&
”rÜ
);

282 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
ùx
, 
desc
->
udi
,

283 "bu‰Ú.ty³", 
ty³
, &
”rÜ
);

284 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
desc
->
udi
,

285 "bu‰Ú.has_¡©e", 
TRUE
, &
”rÜ
);

288 
deviû_fe
 = 
	`g_¡rcÚÿt
 (
sysfs_·th
, "/¡©e", 
NULL
);

290 ià(
	`»ad_lše_bufãr
 (
deviû_fe
, 
¡©e
,  (state) - 1)) {

291 
	`HAL_ERROR
 (("UÇbËØd‘”mšsw™chy³ fÜ %s", 
udi
));

292 
	`g_ä“
 (
deviû_fe
);

293 
	`g_ä“
 (
desc
);

296 ià(
	`gpio_sw™ch_¡r_to_boŞ
 (
desc
->
ty³
, 
¡©e
, &desc->state)) {

297 
	`g_ä“
 (
deviû_fe
);

298 
	`g_ä“
 (
desc
);

302 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
desc
->
udi
,

303 "bu‰Ú.¡©e.v®ue", 
desc
->
¡©e
, &
”rÜ
);

305 
	`HAL_DEBUG
 (("%s:†i¡’šg oÀ%s", 
udi
, 
deviû_fe
));

307 
deviûs
 = 
	`g_li¡_´•’d
 (deviûs, 
	`g_¡rdup
 (
deviû_fe
));

308 
	`upd©e_´oc_t™Ë
 ();

310 
chªÃl
 = 
	`g_io_chªÃl_Ãw_fe
 (
deviû_fe
, "r", &
g”rÜ
);

311 ià(
chªÃl
 =ğ
NULL
) {

312 
	`HAL_ERROR
 (("g_io_channel_new_file() for %s failed: %s",

313 
deviû_fe
, 
g”rÜ
->
mes§ge
));

314 
	`g_”rÜ_ä“
 (
g”rÜ
);

315 
	`g_ä“
 (
deviû_fe
);

316 
	`g_ä“
 (
desc
);

319 
	`g_ä“
 (
deviû_fe
);

321 
	`g_io_chªÃl_£t_’codšg
 (
chªÃl
, 
NULL
, NULL);

324 
»t
 = 
	`g_io_chªÃl_»ad_to_’d
 (
chªÃl
, &
dump
, &
dump_Ën
, &
g”rÜ
);

325 ià(
»t
 =ğ
G_IO_STATUS_NORMAL
)

326 
	`g_ä“
 (
dump
);

327 ià(
g”rÜ
 !ğ
NULL
) {

328 
	`HAL_ERROR
 (("g_io_chªÃl_»ad_to_’d(): %s", 
g”rÜ
->
mes§ge
));

329 
	`g_”rÜ_ä“
 (
g”rÜ
);

332 
	`g_io_chªÃl_£ek_pos™iÚ
 (
chªÃl
, 0, 
G_SEEK_SET
, &
g”rÜ
);

333 ià(
g”rÜ
 !ğ
NULL
) {

334 
	`HAL_ERROR
 (("g_io_chªÃl_£ek_pos™iÚ(): %s", 
g”rÜ
->
mes§ge
));

335 
	`g_”rÜ_ä“
 (
g”rÜ
);

339 
	`g_hash_bË_š£¹
 (
sw™ches
, 
	`g_¡rdup
 (
udi
), 
chªÃl
);

340 
	`g_io_add_w©ch_fuÎ
 (
chªÃl
, 
G_PRIORITY_DEFAULT
,

341 
G_IO_IN
 | 
G_IO_PRI
 | 
G_IO_ERR
,

342 
gpio_¡©e_chªged
, 
desc
,

343 (
GDe¡royNÙify
è
de¡roy_d©a
);

344 
	}
}

347 
	$»move_deviû
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
,

348 cÚ¡ 
LibH®Prİ”tyS‘
 *
´İ”t›s
)

350 
GIOChªÃl
 *
chªÃl
, **
p_chªÃl
 = &channel;

351 
GLi¡
 *
Í
;

352 
gboŞ—n
 
hªdlšg_udi
;

353 cÚ¡ *
sysfs_·th
;

354 *
deviû_fe
;

356 
	`HAL_DEBUG
 (("Removšg chªÃÈfÜ '%s'", 
udi
));

358 
hªdlšg_udi
 = 
	`g_hash_bË_lookup_ex‹nded
 (
sw™ches
, 
udi
, 
NULL
, (
gpoš‹r
 *)
p_chªÃl
);

360 ià(!
hªdlšg_udi
) {

361 
	`HAL_ERROR
(("DeviûRemovÿÎed fÜ unknowÀdeviû: '%s'.", 
udi
));

365 ià(
chªÃl
) {

366 
	`g_io_chªÃl_shutdown
 (
chªÃl
, 
FALSE
, 
NULL
);

367 
	`g_io_chªÃl_uÄef
 (
chªÃl
);

370 
	`g_hash_bË_»move
 (
sw™ches
, 
udi
);

372 
sysfs_·th
 = 
	`libh®_ps_g‘_¡ršg
 (
´İ”t›s
, "linux.sysfs_path");

373 ià(!
sysfs_·th
) {

374 
	`HAL_ERROR
 (("% ha nØ´İ”ty†šux.sysfs_·th", 
udi
));

378 
deviû_fe
 = 
	`g_¡rcÚÿt
 (
sysfs_·th
, "/¡©e", 
NULL
);

380 
Í
 = 
	`g_li¡_fšd_cu¡om
 (
deviûs
, 
deviû_fe
, (
GCom·»Func
è
¡rcmp
);

381 ià(
Í
) {

382 
deviûs
 = 
	`g_li¡_»move_lšk
 (deviûs, 
Í
);

383 
	`g_ä“
 (
Í
->
d©a
);

384 
	`g_li¡_ä“_1
 (
Í
);

385 
	`upd©e_´oc_t™Ë
 ();

388 ià(
	`g_hash_bË_size
 (
sw™ches
) == 0) {

389 
	`HAL_INFO
 (("no more devices,ƒxiting"));

390 
	`g_maš_loİ_qu™
 (
maš_loİ
);

392 
	}
}

395 
	$maš
 (
¬gc
, **
¬gv
)

397 
DBusCÚÃùiÚ
 *
dbus_cÚÃùiÚ
;

398 
DBusE¼Ü
 
”rÜ
;

399 cÚ¡ *
commªdlše
;

401 
	`h®_£t_´oc_t™Ë_š™
 (
¬gc
, 
¬gv
);

403 
	`£tup_logg”
 ();

405 
	`HAL_INFO
 (("addon-omap-gpio„unning"));

407 
	`dbus_”rÜ_š™
 (&
”rÜ
);

408 
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
);

409 ià(
ùx
 =ğ
NULL
) {

410 
	`HAL_ERROR
 (("Unableo initialise†ibhal context: %s",

411 
”rÜ
.
mes§ge
));

415 ià((
dbus_cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
ùx
)è=ğ
NULL
) {

416 
	`HAL_WARNING
 (("Cannot get DBus connection"));

420 ià((
commªdlše
 = 
	`g‘’v
 ("SINGLETON_COMMAND_LINE")è=ğ
NULL
) {

421 
	`HAL_WARNING
 (("SINGLETON_COMMAND_LINE‚ot set"));

425 
	`libh®_ùx_£t_sšgËtÚ_deviû_added
 (
ùx
, 
add_deviû
);

426 
	`libh®_ùx_£t_sšgËtÚ_deviû_»moved
 (
ùx
, 
»move_deviû
);

428 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
dbus_cÚÃùiÚ
, 
NULL
);

429 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
 (
dbus_cÚÃùiÚ
, 0);

431 
	`dbus_”rÜ_š™
 (&
”rÜ
);

432 ià(!
	`libh®_deviû_sšgËtÚ_addÚ_is_»ady
 (
ùx
, 
commªdlše
, &
”rÜ
)) {

433 
	`HAL_INFO
 (("SšgËtÚ % nÙ„—dy y‘: %s", 
commªdlše
, 
”rÜ
.
mes§ge
));

437 
	`drİ_´iveges
 (0);

439 
sw™ches
 = 
	`g_hash_bË_Ãw_fuÎ
 (
g_¡r_hash
, 
g_¡r_equ®
, 
g_ä“
, 
NULL
);

441 
maš_loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

442 
	`g_maš_loİ_run
 (
maš_loİ
);

445 
	}
}

	@hald/linux/addons/addon-pmu.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<”ºo.h
>

29 
	~<fú.h
>

30 
	~<lšux/adb.h
>

31 
	~<lšux/pmu.h
>

32 
	~<¡dšt.h
>

33 
	~<¡dio.h
>

34 
	~<¡dlib.h
>

35 
	~<¡ršg.h
>

36 
	~<uni¡d.h
>

38 
	~"libh®/libh®.h
"

40 
	~"../../logg”.h
"

41 
	~"../../ut_h–³r.h
"

44 
	$maš
 (
¬gc
, *
¬gv
[])

46 
fd
;

47 *
udi
;

48 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

49 
DBusE¼Ü
 
”rÜ
;

50 
rd
;

51 
buf
[256];

52 
¡©e
;

53 
Ãw_¡©e
;

54 *
¡r¡©e
;

56 
fd
 = -1;

58 
	`£tup_logg”
 ();

60 
udi
 = 
	`g‘’v
 ("UDI");

61 ià(
udi
 =ğ
NULL
)

62 
out
;

64 
	`dbus_”rÜ_š™
 (&
”rÜ
);

66 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
)

67 
out
;

69 
	`dbus_”rÜ_š™
 (&
”rÜ
);

70 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
ùx
, 
udi
, &
”rÜ
)) {

71 
out
;

76 ià((
¡r¡©e
 = 
	`g‘’v
 ("HAL_PROP_BUTTON_STATE_VALUE")è=ğ
NULL
) {

77 
	`HAL_ERROR
 (("Cannot get HAL_PROP_BUTTON_STATE_VALUE"));

78 
out
;

80 ià(
	`¡rcmp
 (
¡r¡©e
, "true") == 0)

81 
¡©e
 = 
TRUE
;

83 
¡©e
 = 
FALSE
;

85 ià((
fd
 = 
	`İ’
 ("/dev/adb", 
O_RDWR
)) < 0) {

86 
	`HAL_ERROR
 (("Cannot open /dev/adb"));

87 
out
;

90 
	`drİ_´iveges
 (0);

93 
n
;

95 
buf
[0] = 
PMU_PACKET
;

96 
buf
[1] = 
PMU_GET_COVER
;

98 
n
 = 
	`wr™e
 (
fd
, 
buf
, 2);

99 ià(
n
 == 2) {

100 
rd
 = 
	`»ad
 (
fd
, 
buf
,  (buf));

101 ià(
rd
 <= 0) {

102 
	`HAL_ERROR
 (("E¼Ü„—dšg from fd;„—d„‘uºed %d;ƒ¼=%s", 
”ºo
, 
	`¡»¼Ü
 (errno)));

103 
out
;

107 
i
;

109 
	`HAL_DEBUG
 (("R—d 0x%02x by‹s", 
rd
));

110 
i
 = 0; i < 
rd
; i++) {

111 
	`dbg
 ("%02x : 0x%02x", 
i
, 
buf
[i]);

115 ià(
rd
 >= 2) {

116 
Ãw_¡©e
 = (((
buf
[1]) & 0x01) != 0);

118 ià(
Ãw_¡©e
 !ğ
¡©e
) {

119 
	`HAL_DEBUG
 (("lid s‹ chªge: %d", 
Ãw_¡©e
));

120 
	`dbus_”rÜ_š™
 (&
”rÜ
);

121 
	`libh®_deviû_£t_´İ”ty_boŞ
 (

122 
ùx
, 
udi
, "bu‰Ú.¡©e.v®ue", 
Ãw_¡©e
, &
”rÜ
);

123 
	`dbus_”rÜ_š™
 (&
”rÜ
);

124 
	`libh®_deviû_em™_cÚd™iÚ
 (
ùx
, 
udi
, "Bu‰ÚP»s£d", "", &
”rÜ
);

127 
¡©e
 = 
Ãw_¡©e
;

132 
	`u¦“p
 (1000 * 1000);

138 
out
:

139 ià(
fd
 >= 0)

140 
	`şo£
 (
fd
);

143 
	}
}

	@hald/linux/addons/addon-rfkill-killswitch.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<”ºo.h
>

30 
	~<fú.h
>

31 
	~<¡dio.h
>

33 
	~<¡ršg.h
>

34 
	~<sys/ty³s.h
>

35 
	~<sys/¡©.h
>

36 
	~<uni¡d.h
>

38 
	~<glib.h
>

39 
	~<glib/gmaš.h
>

40 
	~<glib/g¡dio.h
>

41 
	~<dbus/dbus-glib.h
>

42 
	~<dbus/dbus-glib-lowËv–.h
>

44 
	~"libh®/libh®.h
"

45 
	~"../../logg”.h
"

46 
	~"../../ut_h–³r.h
"

47 
	~"../../ut_h–³r_´iv.h
"

49 
GMašLoİ
 *
	ggmaš
 = 
NULL
;

50 
LibH®CÚ‹xt
 *
	gùx
 = 
NULL
;

51 
GHashTabË
 *
	grfkls
 = 
NULL
;

55 
	$g‘_klsw™ch
 (cÚ¡ *
udi
)

57 
FILE
 *
f
;

58 
buf
[64];

59 
·th
[256];

60 *
sysfs_·th
;

61 
kl_¡©us
;

62 
»t
 = -1;

64 
f
 = 
NULL
;

66 ià(!
	`g_hash_bË_lookup_ex‹nded
 (
rfkls
, 
udi
, 
NULL
, (
gpoš‹r
è&
sysfs_·th
)) {

70 
	`¢´štf
 (
·th
,  (·th), "%s/¡©e", 
sysfs_·th
);

72 ià((
f
 = 
	`fİ’
 (
·th
, "r")è=ğ
NULL
) {

73 
	`HAL_WARNING
(("Could‚Ù„—d klsw™ch stu äom '%s' fÜ deviû '%s'", 
·th
, 
udi
));

77 ià(
	`fg‘s
 (
buf
,  (buf), 
f
è=ğ
NULL
) {

78 
	`HAL_ERROR
 (("CªnÙ„—d from '%s' fÜ deviû '%s'", 
·th
, 
udi
));

79 
out
;

82 
”ºo
 = 0;

83 
kl_¡©us
 = 
	`¡¹Ş
 (
buf
, 
NULL
, 10);

84 ià(
”ºo
 == 0) {

85 
	`HAL_DEBUG
 (("GÙ '%d' from sysf š‹rçû fÜ deviû '%s'.", 
kl_¡©us
, 
udi
));

87 
kl_¡©us
) {

89 
»t
 = 1;

93 
»t
 = 0;

100 
out
:

101 ià(
f
 !ğ
NULL
)

102 
	`fşo£
 (
f
);

104  
»t
;

105 
	}
}

109 
	$£t_klsw™ch
 (cÚ¡ *
udi
, 
gboŞ—n
 
¡©us
)

111 
FILE
 *
f
;

112 
»t
;

113 
·th
[256];

114 *
sysfs_·th
;

116 ià(!
	`g_hash_bË_lookup_ex‹nded
 (
rfkls
, 
udi
, 
NULL
, (
gpoš‹r
è&
sysfs_·th
)) {

120 
	`¢´štf
 (
·th
,  (·th), "%s/¡©e", 
sysfs_·th
);

122 ià((
f
 = 
	`fİ’
 (
·th
, "w")è=ğ
NULL
) {

123 
	`HAL_WARNING
(("Could‚Ù o³À'%s' fÜ deviû '%s'", 
·th
, 
udi
));

127 ià(
¡©us
) {

128 
»t
 = 
	`åuts
 ("1", 
f
);

130 
»t
 = 
	`åuts
 ("0", 
f
);

133 ià(
f
 !ğ
NULL
)

134 
	`fşo£
 (
f
);

136 ià(
»t
 =ğ
EOF
) {

137 
	`HAL_WARNING
(("Couldn'ˆwr™¡©u tØ'%s' fÜ deviû '%s'", 
·th
, 
udi
));

138 
»t
 = -1;

140 
cu¼’t_¡©e
 = 
	`g‘_klsw™ch
(
udi
);

141 ià((
¡©us
 && 
cu¼’t_¡©e
) || (!status && !current_state)) {

142 
»t
 = 0;

144 
	`HAL_DEBUG
 (("Could‚Ù s‘h¡©(%dètØsysf fÜ deviû '%s', cu¼’ˆ¡©i %d.", 
¡©us
, 
udi
, 
cu¼’t_¡©e
));

145 
»t
 = -1;

149  
»t
;

150 
	}
}

153 
DBusHªdËrResuÉ


154 
	$f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£rd©a
)

156 
DBusE¼Ü
 
”r
;

157 
DBusMes§ge
 *
»¶y
;

158 cÚ¡ *
_udi
;

159 *
ty³
;

160 *
aùiÚ
;

161 *
sysfs_·th
;

163 ià((
_udi
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
)è=ğ
NULL
) {

164 
	`HAL_DEBUG
 (("Couldn't gethe udi forhis call, ignore it."));

165  
DBUS_HANDLER_RESULT_HANDLED
;

167 if(!
	`g_hash_bË_lookup_ex‹nded
 (
rfkls
, 
_udi
, 
NULL
, (
gpoš‹r
 *è&
sysfs_·th
)) {

168 
	`HAL_DEBUG
 (("Thi deviû (%sèi¢'ˆy‘ hªdËd byhaddÚ.", 
_udi
));

169  
DBUS_HANDLER_RESULT_HANDLED
;

173 
	`dbus_”rÜ_š™
 (&
”r
);

175 ià((
ty³
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
ùx
, 
_udi
, "klsw™ch.ty³", &
”r
)è=ğ
NULL
) {

176 
	`HAL_DEBUG
 (("Couldn'ˆg‘hty³ oàthklsw™ch deviû (%s). IgnÜÿÎ.", 
_udi
));

177  
DBUS_HANDLER_RESULT_HANDLED
;

180 
aùiÚ
 = 
	`g_¡rdup_´štf
 ("Üg.ä“desktİ.h®.klsw™ch.%s", 
ty³
);

182 ià(!
	`check_´iv
 (
ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
	`dbus_mes§ge_g‘_·th
 (mes§ge), 
aùiÚ
)) {

183 
	`HAL_DEBUG
(("User don't havehe…ermissionso callhe interface"));

184  
DBUS_HANDLER_RESULT_HANDLED
;

187 
»¶y
 = 
NULL
;

189 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

192 
gboŞ—n
 
¡©us
;

194 
	`dbus_”rÜ_š™
 (&
”r
);

195 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

196 &
”r
,

197 
DBUS_TYPE_BOOLEAN
, &
¡©us
,

198 
DBUS_TYPE_INVALID
)) {

199 
»tuº_code
 = 0;

200 
£t
;

202 
£t
 = 
	`£t_klsw™ch
 (
_udi
, 
¡©us
);

204 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

205 ià(
»¶y
 =ğ
NULL
)

206 
”rÜ
;

208 ià(
£t
 != 0)

209 
»tuº_code
 = 1;

211 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

212 
DBUS_TYPE_INT32
, &
»tuº_code
,

213 
DBUS_TYPE_INVALID
);

215 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

217 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

220 
¡©us
;

222 
	`dbus_”rÜ_š™
 (&
”r
);

223 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
,

224 &
”r
,

225 
DBUS_TYPE_INVALID
)) {

226 
¡©us
 = 
	`g‘_klsw™ch
(
_udi
);

228 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

229 ià(
»¶y
 =ğ
NULL
)

230 
”rÜ
;

232 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

233 
DBUS_TYPE_INT32
, &
¡©us
,

234 
DBUS_TYPE_INVALID
);

235 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

239 
”rÜ
:

240 ià(
»¶y
 !ğ
NULL
)

241 
	`dbus_mes§ge_uÄef
 (
»¶y
);

243  
DBUS_HANDLER_RESULT_HANDLED
;

244 
	}
}

247 
	$add_deviû
 (
LibH®CÚ‹xt
 *
ùx
,

248 cÚ¡ *
udi
,

249 cÚ¡ 
LibH®Prİ”tyS‘
 *
´İ”t›s
)

251 
DBusE¼Ü
 
”r
;

252 
DBusCÚÃùiÚ
 *
dbus_cÚÃùiÚ
;

253 cÚ¡ * 
sysfs_·th
;

254 
gboŞ—n
 
š™Ÿlized
 = 
FALSE
;

256 ià((
sysfs_·th
 = 
	`libh®_ps_g‘_¡ršg
 (
´İ”t›s
, "lšux.sysfs_·th")è=ğ
NULL
) {

257 
	`HAL_ERROR
(("% ha nØ´İ”ty†šux.sysfs_·th", 
udi
));

263 ià((
dbus_cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
(
ùx
)è=ğ
NULL
) {

264 
	`HAL_WARNING
 (("Cannot get DBus connection"));

268 ià(!
š™Ÿlized
) {

269 
	`dbus_cÚÃùiÚ_add_f‹r
 (
dbus_cÚÃùiÚ
, 
f‹r_funùiÚ
, 
NULL
, NULL);

270 
š™Ÿlized
 = 
TRUE
;

273 
	`dbus_”rÜ_š™
 (&
”r
);

275 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
ùx
,

276 
udi
,

285 &
”r
)) {

286 
	`HAL_ERROR
 (("Cannot claim interface 'org.freedesktop.Hal.Device.KillSwitch'"));

290 
	`g_hash_bË_š£¹
 (
rfkls
, 
	`g_¡rdup
(
udi
), g_¡rdup(
sysfs_·th
));

291 
	}
}

294 
	$»move_deviû
 (
LibH®CÚ‹xt
 *
ùx
,

295 cÚ¡ *
udi
,

296 cÚ¡ 
LibH®Prİ”tyS‘
 *
´İ”t›s
)

298 
gpoš‹r
 
sysfs_·th
;

299 
gboŞ—n
 
hªdlšg_udi
;

301 
	`HAL_DEBUG
 (("Removšg chªÃÈfÜ '%s'", 
udi
));

303 
hªdlšg_udi
 = 
	`g_hash_bË_lookup_ex‹nded
 (
rfkls
, 
udi
, 
NULL
, &
sysfs_·th
);

305 ià(!
hªdlšg_udi
) {

306 
	`HAL_ERROR
(("DeviûRemovÿÎed fÜ unknowÀdeviû: '%s'.", 
udi
));

310 
	`g_hash_bË_»move
 (
rfkls
, 
udi
);

312 ià(
	`g_hash_bË_size
 (
rfkls
) == 0) {

313 
	`HAL_INFO
(("no more devices,ƒxiting"));

314 
	`g_maš_loİ_qu™
 (
gmaš
);

316 
	}
}

319 
	$maš
 (
¬gc
, *
¬gv
[])

321 
DBusCÚÃùiÚ
 *
dbus_cÚÃùiÚ
;

322 
DBusE¼Ü
 
”rÜ
;

323 cÚ¡ *
commªdlše
;

325 
	`h®_£t_´oc_t™Ë_š™
 (
¬gc
, 
¬gv
);

327 
	`£tup_logg”
 ();

329 
	`dbus_”rÜ_š™
 (&
”rÜ
);

330 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

331 
	`HAL_WARNING
 (("Unableo init†ibhal context"));

332 
out
;

335 ià((
dbus_cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
(
ùx
)è=ğ
NULL
) {

336 
	`HAL_WARNING
 (("Cannot get DBus connection"));

337 
out
;

340 ià((
commªdlše
 = 
	`g‘’v
 ("SINGLETON_COMMAND_LINE")è=ğ
NULL
) {

341 
	`HAL_WARNING
 (("SINGLETON_COMMAND_LINE‚ot set"));

342 
out
;

345 
	`libh®_ùx_£t_sšgËtÚ_deviû_added
 (
ùx
, 
add_deviû
);

346 
	`libh®_ùx_£t_sšgËtÚ_deviû_»moved
 (
ùx
, 
»move_deviû
);

348 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
dbus_cÚÃùiÚ
, 
NULL
);

349 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
 (
dbus_cÚÃùiÚ
, 0);

351 
	`dbus_”rÜ_š™
 (&
”rÜ
);

353 ià(!
	`libh®_deviû_sšgËtÚ_addÚ_is_»ady
 (
ùx
, 
commªdlše
, &
”rÜ
)) {

354 
out
;

357 
rfkls
 = 
	`g_hash_bË_Ãw_fuÎ
 (
g_¡r_hash
, 
g_¡r_equ®
, 
g_ä“
, 
NULL
);

359 
gmaš
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

360 
	`g_maš_loİ_run
 (
gmaš
);

364 
out
:

365 
	`HAL_DEBUG
 (("Anƒrror occured,ƒxiting cleanly"));

366 ià(
ùx
 !ğ
NULL
) {

367 
	`dbus_”rÜ_š™
 (&
”rÜ
);

368 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

369 
	`libh®_ùx_ä“
 (
ùx
);

373 
	}
}

	@hald/linux/addons/addon-storage.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<”ºo.h
>

31 
	~<fú.h
>

32 
	~<lšux/cdrom.h
>

33 
	~<lšux/fs.h
>

34 
	~<mÁ’t.h
>

35 
	~<scsi/sg.h
>

36 
	~<¡dšt.h
>

37 
	~<¡dio.h
>

38 
	~<¡dlib.h
>

39 
	~<¡ršg.h
>

40 
	~<sys/ioùl.h
>

41 
	~<uni¡d.h
>

42 
	~<glib/gmaš.h
>

43 
	~<dbus/dbus-glib.h
>

44 
	~<dbus/dbus-glib-lowËv–.h
>

46 
	~"libh®/libh®.h
"

48 
	~"../../logg”.h
"

49 
	~"../../ut_h–³r.h
"

52 *
	gudi
;

53 *
	gdeviû_fe
;

54 
	gmedŸ_¡©us
;

55 
	gis_cdrom
;

56 
	gsuµÜt_medŸ_chªged
;

57 
LibH®CÚ‹xt
 *
	gùx
 = 
NULL
;

58 
DBusCÚÃùiÚ
 *
	gcÚ
 = 
NULL
;

59 
gušt
 
	gpŞl_tim”
 = -1;

60 
GMašLoİ
 *
	gloİ
;

61 
gboŞ—n
 
	gsy¡em_is_idË
 = 
FALSE
;

62 
gboŞ—n
 
	gcheck_lock_¡©e
 = 
TRUE
;

64 
gboŞ—n
 
	gpŞlšg_di§bËd
 = 
FALSE
;

67 
	$fÜû_unmouÁ
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
)

69 
DBusE¼Ü
 
”rÜ
;

70 
DBusMes§ge
 *
msg
 = 
NULL
;

71 
DBusMes§ge
 *
»¶y
 = 
NULL
;

72 **
İtiÚs
 = 
NULL
;

73 
num_İtiÚs
 = 0;

74 
DBusCÚÃùiÚ
 *
dbus_cÚÃùiÚ
;

75 *
deviû_fe
;

77 
dbus_cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
ùx
);

79 
msg
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

82 ià(
msg
 =ğ
NULL
) {

83 
	`HAL_ERROR
 (("Could‚Ù c»©dbu mes§gfÜ %s", 
udi
));

84 
out
;

88 
İtiÚs
 = 
	`ÿÎoc
 (1,  (*));

89 ià(
İtiÚs
 =ğ
NULL
) {

90 
	`HAL_ERROR
 (("Could‚ot‡llocate options‡rray"));

91 
out
;

94 
İtiÚs
[0] = "lazy";

95 
num_İtiÚs
 = 1;

97 
deviû_fe
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
ùx
, 
udi
, "block.deviû", 
NULL
);

98 ià(
deviû_fe
 !ğ
NULL
) {

99 
	`HAL_INFO
(("fÜcibly‡‰em±šgØÏzy unmouÁ % a medŸ wa »moved", 
deviû_fe
));

100 
	`libh®_ä“_¡ršg
 (
deviû_fe
);

103 ià(!
	`dbus_mes§ge_­³nd_¬gs
 (
msg
,

104 
DBUS_TYPE_ARRAY
, 
DBUS_TYPE_STRING
, &
İtiÚs
, 
num_İtiÚs
,

105 
DBUS_TYPE_INVALID
)) {

106 
	`HAL_ERROR
 (("Could‚Ù‡µ’d‡rg tØdbu mes§gfÜ %s", 
udi
));

107 
out
;

110 
	`dbus_”rÜ_š™
 (&
”rÜ
);

111 ià(!(
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
dbus_cÚÃùiÚ
, 
msg
, -1, &
”rÜ
))) {

112 
	`HAL_ERROR
 (("UnmouÁ faed fÜ %s: % : %s\n", 
udi
, 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

113 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

114 
out
;

117 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

118 
	`HAL_ERROR
 (("UnmouÁ faed fÜ %s\n% : %s\n", 
udi
, 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

119 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

120 
out
;

123 
	`HAL_DEBUG
 (("SucûsfuÎy unmouÁed ud˜'%s'", 
udi
));

125 
out
:

126 ià(
İtiÚs
 !ğ
NULL
)

127 
	`ä“
 (
İtiÚs
);

128 ià(
msg
 !ğ
NULL
)

129 
	`dbus_mes§ge_uÄef
 (
msg
);

130 ià(
»¶y
 !ğ
NULL
)

131 
	`dbus_mes§ge_uÄef
 (
»¶y
);

132 
	}
}

134 
dbus_boŞ_t


135 
	$unmouÁ_ş—¹ext_deviûs
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
)

137 
DBusE¼Ü
 
”rÜ
;

138 **
ş—r_deviûs
;

139 
num_ş—r_deviûs
;

140 
dbus_boŞ_t
 
»t
;

142 
»t
 = 
FALSE
;

145 
	`dbus_”rÜ_š™
 (&
”rÜ
);

146 
ş—r_deviûs
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
ùx
,

148 
udi
,

149 &
num_ş—r_deviûs
,

150 &
”rÜ
);

152 ià(
ş—r_deviûs
 !ğ
NULL
 && 
num_ş—r_deviûs
 > 0) {

153 
i
;

155 
»t
 = 
TRUE
;

157 
i
 = 0; i < 
num_ş—r_deviûs
; i++) {

158 *
ş—r_udi
;

159 
ş—r_udi
 = 
ş—r_deviûs
[
i
];

160 
	`dbus_”rÜ_š™
 (&
”rÜ
);

161 ià(
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
ùx
, 
ş—r_udi
, "vŞume.is_mouÁed", &
”rÜ
)) {

162 
	`HAL_DEBUG
 (("FÜcšg unmouÁ oàchd '%s' (üy±o)", 
ş—r_udi
));

163 
	`fÜû_unmouÁ
 (
ùx
, 
ş—r_udi
);

166 
	`libh®_ä“_¡ršg_¬¿y
 (
ş—r_deviûs
);

169  
»t
;

170 
	}
}

173 
	$unmouÁ_chds
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
)

175 
num_vŞumes
;

176 **
vŞumes
;

177 
DBusE¼Ü
 
”rÜ
;

180 
	`dbus_”rÜ_š™
 (&
”rÜ
);

181 ià((
vŞumes
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (

182 
ùx
, "block.¡Üage_deviû", 
udi
, &
num_vŞumes
, &
”rÜ
)è!ğ
NULL
) {

183 
i
;

185 
i
 = 0; i < 
num_vŞumes
; i++) {

186 *
vŞ_udi
;

188 
vŞ_udi
 = 
vŞumes
[
i
];

189 
	`dbus_”rÜ_š™
 (&
”rÜ
);

190 ià(
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
ùx
, 
vŞ_udi
, "block.is_vŞume", &
”rÜ
)) {

191 
dbus_boŞ_t
 
is_üy±o
;

194 
is_üy±o
 = 
	`unmouÁ_ş—¹ext_deviûs
 (
ùx
, 
vŞ_udi
);

196 
	`dbus_”rÜ_š™
 (&
”rÜ
);

197 ià(
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
ùx
, 
vŞ_udi
, "vŞume.is_mouÁed", &
”rÜ
)) {

198 
	`HAL_DEBUG
 (("FÜcšg unmouÁ oàchd '%s'", 
vŞ_udi
));

199 
	`fÜû_unmouÁ
 (
ùx
, 
vŞ_udi
);

203 ià(
is_üy±o
) {

204 
DBusMes§ge
 *
msg
 = 
NULL
;

205 
DBusMes§ge
 *
»¶y
 = 
NULL
;

208 
	`HAL_DEBUG
 (("T—rdowÀüy±ØfÜ '%s'", 
vŞ_udi
));

210 
msg
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
vŞ_udi
,

213 ià(
msg
 =ğ
NULL
) {

214 
	`HAL_ERROR
 (("Could‚Ù c»©dbu mes§gfÜ %s", 
vŞ_udi
));

215 
‹¬down_çed
;

218 
	`dbus_”rÜ_š™
 (&
”rÜ
);

219 ià(!(
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (

220 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
ùx
), 
msg
, -1, &
”rÜ
)) ||

221 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

222 
	`HAL_DEBUG
 (("Teardown failed for %s: %s : %s\n",

223 
udi
, 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

224 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

227 
‹¬down_çed
:

228 ià(
msg
 !ğ
NULL
)

229 
	`dbus_mes§ge_uÄef
 (
msg
);

230 ià(
»¶y
 !ğ
NULL
)

231 
	`dbus_mes§ge_uÄef
 (
»¶y
);

237 
	`libh®_ä“_¡ršg_¬¿y
 (
vŞumes
);

239 
	}
}

247 
dbus_boŞ_t


248 
	$is_mouÁed
 (cÚ¡ *
deviû_fe
)

250 
FILE
 *
f
;

251 
dbus_boŞ_t
 
rc
;

252 
mÁ’t
 
mÁ
;

253 
buf
[512];

255 
rc
 = 
FALSE
;

257 ià((
f
 = 
	`£tmÁ’t
 ("/‘c/mb", "r")è=ğ
NULL
)

258 
out
;

260 
	`g‘mÁ’t_r
 (
f
, &
mÁ
, 
buf
, (buf)è!ğ
NULL
) {

261 ià(
	`¡rcmp
 (
deviû_fe
, 
mÁ
.
mÁ_f¢ame
) == 0) {

262 
rc
 = 
TRUE
;

263 
out1
;

267 
out1
:

268 
	`’dmÁ’t
 (
f
);

269 
out
:

270  
rc
;

271 
	}
}

275 
	mMEDIA_STATUS_UNKNOWN
 = 0,

276 
	mMEDIA_STATUS_GOT_MEDIA
 = 1,

277 
	mMEDIA_STATUS_NO_MEDIA
 = 2

280 
gboŞ—n
 
pŞl_fÜ_medŸ
 (
gpoš‹r
 
u£r_d©a
);

281 
gboŞ—n
 
pŞl_fÜ_medŸ_fÜû
 ();

283 
	gš‹rv®_š_£cÚds
 = 2;

285 
gboŞ—n
 
	gis_locked_by_h®
 = 
FALSE
;

286 
gboŞ—n
 
	gis_locked_vŸ_o_exş
 = 
FALSE
;

289 
	$upd©e_´oc_t™Ë
 ()

292 ià(
pŞlšg_di§bËd
) {

293 
	`h®_£t_´oc_t™Ë
 ("h®d-addÚ-¡Üage:‚ØpŞlšg oÀ% beÿu£ iˆi ex¶ic™ly di§bËd", 
deviû_fe
);

294 } ià(
is_locked_by_h®
) {

295 ià(
is_locked_vŸ_o_exş
) {

296 
	`h®_£t_´oc_t™Ë
 ("h®d-addÚ-¡Üage:‚ØpŞlšg beÿu£ % i locked vŸ HAL‡nd O_EXCL", 
deviû_fe
);

298 
	`h®_£t_´oc_t™Ë
 ("h®d-addÚ-¡Üage:‚ØpŞlšg beÿu£ % i locked vŸ HAL", 
deviû_fe
);

300 } ià(
is_locked_vŸ_o_exş
) {

301 
	`h®_£t_´oc_t™Ë
 ("h®d-addÚ-¡Üage:‚ØpŞlšg beÿu£ % i locked vŸ O_EXCL", 
deviû_fe
);

303 
	`h®_£t_´oc_t™Ë
 ("h®d-addÚ-¡Üage:…Şlšg % Óv”y %d sec)", 
deviû_fe
, 
š‹rv®_š_£cÚds
);

305 
	}
}

308 
	$upd©e_pŞlšg_š‹rv®
 ()

328 ià(
sy¡em_is_idË
)

329 
š‹rv®_š_£cÚds
 = 16;

331 
š‹rv®_š_£cÚds
 = 2;

333 ià(
pŞl_tim”
 > 0)

334 
	`g_sourû_»move
 (
pŞl_tim”
);

336 #ifdeà
HAVE_GLIB_2_14


337 
pŞl_tim”
 = 
	`g_timeout_add_£cÚds
 (
š‹rv®_š_£cÚds
, 
pŞl_fÜ_medŸ
, 
NULL
);

339 
pŞl_tim”
 = 
	`g_timeout_add
 (
š‹rv®_š_£cÚds
 * 1000, 
pŞl_fÜ_medŸ
, 
NULL
);

342 
	`upd©e_´oc_t™Ë
 ();

343 
	}
}

345 
gboŞ—n


346 
	$pŞl_fÜ_medŸ
 (
gpoš‹r
 
u£r_d©a
)

348 ià(
check_lock_¡©e
) {

349 
DBusE¼Ü
 
”rÜ
;

350 
dbus_boŞ_t
 
should_pŞl
;

352 
check_lock_¡©e
 = 
FALSE
;

354 
	`HAL_INFO
 (("Checkšg wh‘h” deviû % i locked oÀHAL", 
deviû_fe
));

355 
	`dbus_”rÜ_š™
 (&
”rÜ
);

356 ià(
	`libh®_deviû_is_locked_by_Ùh”s
 (
ùx
, 
udi
, "Üg.ä“desktİ.H®.Deviû.StÜage", &
”rÜ
)) {

357 
	`HAL_INFO
 (("... deviû % i locked oÀHAL", 
deviû_fe
));

358 
is_locked_by_h®
 = 
TRUE
;

359 
	`upd©e_´oc_t™Ë
 ();

360 
sk_check
;

362 
	`HAL_INFO
 (("... deviû % i nÙ†ocked oÀHAL", 
deviû_fe
));

363 
is_locked_by_h®
 = 
FALSE
;

366 
	`dbus_”rÜ_š™
 (&
”rÜ
);

367 
should_pŞl
 = 
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
ùx
, 
udi
, "¡Üage.medŸ_check_’abËd", &
”rÜ
);

368 
pŞlšg_di§bËd
 = !
should_pŞl
;

369 
	`upd©e_´oc_t™Ë
 ();

373 ià(
is_locked_by_h®
 || 
pŞlšg_di§bËd
)

374 
sk_check
;

376 
	`pŞl_fÜ_medŸ_fÜû
 ();

378 
sk_check
:

379  
TRUE
;

380 
	}
}

383 
gboŞ—n


384 
	$pŞl_fÜ_medŸ_fÜû
 ()

386 
fd
;

387 
gÙ_medŸ
;

388 
Şd_medŸ_¡©us
;

390 
gÙ_medŸ
 = 
FALSE
;

392 
Şd_medŸ_¡©us
 = 
medŸ_¡©us
;

393 ià(
is_cdrom
) {

394 
drive
;

396 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
 | 
O_EXCL
);

398 ià(
fd
 < 0 && 
”ºo
 =ğ
EBUSY
) {

407 ià(!
	`is_mouÁed
 (
deviû_fe
)) {

408 ià(!
is_locked_vŸ_o_exş
) {

409 
is_locked_vŸ_o_exş
 = 
TRUE
;

410 
	`upd©e_´oc_t™Ë
 ();

412 
is_locked_vŸ_o_exş
 = 
TRUE
;

414 
sk_check
;

417 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
);

420 ià(
fd
 < 0) {

421 
	`HAL_ERROR
 (("İ’ faed fÜ %s: %s", 
deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

422 
sk_check
;

425 ià(
is_locked_vŸ_o_exş
) {

426 
is_locked_vŸ_o_exş
 = 
FALSE
;

427 
	`upd©e_´oc_t™Ë
 ();

435 
drive
 = 
	`ioùl
 (
fd
, 
CDROM_DRIVE_STATUS
, 
CDSL_CURRENT
);

436 
drive
) {

437 
CDS_NO_INFO
:

438 
CDS_NO_DISC
:

439 
CDS_TRAY_OPEN
:

440 
CDS_DRIVE_NOT_READY
:

443 
CDS_DISC_OK
:

448 ià(
suµÜt_medŸ_chªged
 &&

449 
	`ioùl
 (
fd
, 
CDROM_MEDIA_CHANGED
, 
CDSL_CURRENT
) &&

450 
	`ioùl
 (
fd
, 
CDROM_MEDIA_CHANGED
, 
CDSL_CURRENT
)) {

452 
gÙ_medŸ
 = 
TRUE
;

457 
	`HAL_ERROR
 (("CDROM_DRIVE_STATUS faed: %s\n", 
	`¡»¼Ü
(
”ºo
)));

465 ià(
gÙ_medŸ
) {

466 
cdb
[10] = { 0x4a, 1, 0, 0, 16, 0, 0, 0, 8, 0};

467 
bufãr
[8];

468 
sg_io_hdr
 
sg_h
;

469 
»tv®
;

471 
	`mem£t
(
bufãr
, 0, (buffer));

472 
	`mem£t
(&
sg_h
, 0, (
sg_io_hdr
));

473 
sg_h
.
š‹rçû_id
 = 'S';

474 
sg_h
.
cmd_Ën
 = (
cdb
);

475 
sg_h
.
dxãr_dœeùiÚ
 = 
SG_DXFER_FROM_DEV
;

476 
sg_h
.
dxãr_Ën
 = (
bufãr
);

477 
sg_h
.
dxã½
 = 
bufãr
;

478 
sg_h
.
cmdp
 = 
cdb
;

479 
sg_h
.
timeout
 = 5000;

480 
»tv®
 = 
	`ioùl
(
fd
, 
SG_IO
, &
sg_h
);

481 ià(
»tv®
 =ğ0 && 
sg_h
.
¡©us
 =ğ0 && (
bufãr
[4] & 0x0f) == 0x01) {

482 
DBusE¼Ü
 
”rÜ
;

485 
	`dbus_”rÜ_š™
 (&
”rÜ
);

486 
	`libh®_deviû_em™_cÚd™iÚ
 (
ùx
, 
udi
, "EjeùP»s£d", "", &
”rÜ
);

489 
	`şo£
 (
fd
);

491 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
);

492 ià(
fd
 < 0 && 
”ºo
 =ğ
ENOMEDIUM
) {

493 
gÙ_medŸ
 = 
FALSE
;

494 } ià(
fd
 >= 0) {

495 
gÙ_medŸ
 = 
TRUE
;

496 
	`şo£
 (
fd
);

498 
	`HAL_ERROR
 (("İ’ faed fÜ %s: %s", 
deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

499 
sk_check
;

504 ià(
medŸ_¡©us
 =ğ
MEDIA_STATUS_UNKNOWN
) {

505 ià(
gÙ_medŸ
)

506 
medŸ_¡©us
 = 
MEDIA_STATUS_NO_MEDIA
;

508 
medŸ_¡©us
 = 
MEDIA_STATUS_GOT_MEDIA
;

511 
medŸ_¡©us
) {

512 
MEDIA_STATUS_GOT_MEDIA
:

513 ià(!
gÙ_medŸ
) {

514 
DBusE¼Ü
 
”rÜ
;

516 
	`HAL_DEBUG
 (("MedŸ„emov® d‘eùed oÀ%s", 
deviû_fe
));

517 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
udi
, "¡Üage.»movabË.medŸ_avaabË", 
FALSE
, 
NULL
);

518 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
ùx
, 
udi
, "¡Üage.·¹™iÚšg_scheme", "", 
NULL
);

522 
	`unmouÁ_chds
 (
ùx
, 
udi
);

525 
	`dbus_”rÜ_š™
 (&
”rÜ
);

526 
	`libh®_deviû_»sÿn
 (
ùx
, 
udi
, &
”rÜ
);

529 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
);

530 ià(
fd
 >= 0) {

531 
	`ioùl
 (
fd
, 
BLKRRPART
);

532 
	`şo£
 (
fd
);

537 
MEDIA_STATUS_NO_MEDIA
:

538 ià(
gÙ_medŸ
) {

539 
DBusE¼Ü
 
”rÜ
;

541 
	`HAL_DEBUG
 (("MedŸ in£¹iÚ d‘eùed oÀ%s", 
deviû_fe
));

544 
	`libh®_deviû_£t_´İ”ty_boŞ
 (

545 
ùx
, 
udi
, "¡Üage.»movabË.medŸ_avaabË", 
TRUE
, 
NULL
);

548 
	`dbus_”rÜ_š™
 (&
”rÜ
);

549 
	`libh®_deviû_»sÿn
 (
ùx
, 
udi
, &
”rÜ
);

554 
MEDIA_STATUS_UNKNOWN
:

560 ià(
gÙ_medŸ
)

561 
medŸ_¡©us
 = 
MEDIA_STATUS_GOT_MEDIA
;

563 
medŸ_¡©us
 = 
MEDIA_STATUS_NO_MEDIA
;

567 
sk_check
:

568  
Şd_medŸ_¡©us
 !ğ
medŸ_¡©us
;

569 
	}
}

571 #ifdeà
HAVE_CONKIT


572 
gboŞ—n


573 
	$g‘_sy¡em_idË_äom_ck
 ()

575 
gboŞ—n
 
»t
;

576 
DBusE¼Ü
 
”rÜ
;

577 
DBusMes§ge
 *
mes§ge
;

578 
DBusMes§ge
 *
»¶y
;

580 
»t
 = 
FALSE
;

582 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.ConsoleKit",

586 
	`dbus_”rÜ_š™
 (&
”rÜ
);

587 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
cÚ
, 
mes§ge
, -1, &
”rÜ
);

588 ià(
»¶y
 =ğ
NULL
 || 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

589 
	`HAL_ERROR
 (("E¼Ü došg Mªag”.G‘Sy¡emIdËHšˆÚ CÚsŞeK™: %s: %s", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

590 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

591 ià(
»¶y
 !ğ
NULL
)

592 
	`dbus_mes§ge_uÄef
 (
»¶y
);

593 
”rÜ
;

595 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
»¶y
, 
NULL
,

596 
DBUS_TYPE_BOOLEAN
, &(
sy¡em_is_idË
),

597 
DBUS_TYPE_INVALID
)) {

598 
	`HAL_ERROR
 (("Invalid GetSystemIdleHint„eply from CK"));

599 
”rÜ
;

601 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

602 
	`dbus_mes§ge_uÄef
 (
»¶y
);

604 
»t
 = 
TRUE
;

606 
”rÜ
:

607  
»t
;

608 
	}
}

612 
DBusHªdËrResuÉ


613 
	$dœeù_f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£r_d©a
)

615 ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

618 
DBusMes§ge
 *
»¶y
;

619 
dbus_boŞ_t
 
ÿÎ_had_sid“fãù
;

621 
	`HAL_INFO
 (("Forcing…oll for media becusse CheckForMedia() was called"));

623 
ÿÎ_had_sid“fãù
 = 
	`pŞl_fÜ_medŸ_fÜû
 ();

625 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
mes§ge
);

626 
	`dbus_mes§ge_­³nd_¬gs
 (
»¶y
,

627 
DBUS_TYPE_BOOLEAN
, &
ÿÎ_had_sid“fãù
,

628 
DBUS_TYPE_INVALID
);

629 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

630 
	`dbus_mes§ge_uÄef
 (
»¶y
);

633  
DBUS_HANDLER_RESULT_HANDLED
;

634 
	}
}

636 
DBusHªdËrResuÉ


637 
	$dbus_f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£r_d©a
)

639 #ifdeà
HAVE_CONKIT


640 
gboŞ—n
 
sy¡em_is_idË_Ãw
;

642 ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
,

645 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, 
NULL
,

646 
DBUS_TYPE_BOOLEAN
, &
sy¡em_is_idË_Ãw
,

647 
DBUS_TYPE_INVALID
)) {

648 
	`HAL_ERROR
 (("Invalid SystemIdleHintChanged signal from CK"));

649 
out
;

652 ià(
sy¡em_is_idË_Ãw
 !ğ
sy¡em_is_idË
) {

653 
sy¡em_is_idË
 = 
sy¡em_is_idË_Ãw
;

654 
	`upd©e_pŞlšg_š‹rv®
 ();

658 
out
:

673 
check_lock_¡©e
 = 
TRUE
;

675  
DBUS_HANDLER_RESULT_HANDLED
;

676 
	}
}

679 
	$maš
 (
¬gc
, *
¬gv
[])

681 
DBusE¼Ü
 
”rÜ
;

682 
LibH®CÚ‹xt
 *
ùx_dœeù
;

683 
DBusCÚÃùiÚ
 *
cÚ_dœeù
;

684 *
bus
;

685 *
drive_ty³
;

686 *
suµÜt_medŸ_chªged_¡r
;

687 *
¡r
;

689 
	`h®_£t_´oc_t™Ë_š™
 (
¬gc
, 
¬gv
);

696 ià((
udi
 = 
	`g‘’v
 ("UDI")è=ğ
NULL
)

697 
out
;

698 ià((
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_DEVICE")è=ğ
NULL
)

699 
out
;

700 ià((
bus
 = 
	`g‘’v
 ("HAL_PROP_STORAGE_BUS")è=ğ
NULL
)

701 
out
;

702 ià((
drive_ty³
 = 
	`g‘’v
 ("HAL_PROP_STORAGE_DRIVE_TYPE")è=ğ
NULL
)

703 
out
;

705 
	`£tup_logg”
 ();

707 
suµÜt_medŸ_chªged_¡r
 = 
	`g‘’v
 ("HAL_PROP_STORAGE_CDROM_SUPPORT_MEDIA_CHANGED");

708 ià(
suµÜt_medŸ_chªged_¡r
 !ğ
NULL
 && 
	`¡rcmp
 (support_media_changed_str, "true") == 0)

709 
suµÜt_medŸ_chªged
 = 
TRUE
;

711 
suµÜt_medŸ_chªged
 = 
FALSE
;

713 
	`dbus_”rÜ_š™
 (&
”rÜ
);

714 
cÚ
 = 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
);

715 ià(
cÚ
 =ğ
NULL
) {

716 
	`HAL_ERROR
 (("Cannot connecto system bus"));

717 
out
;

719 
loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

720 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚ
, 
NULL
);

721 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
 (
cÚ
, 0);

723 
	`dbus_”rÜ_š™
 (&
”rÜ
);

724 ià((
ùx_dœeù
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

725 
	`HAL_ERROR
 (("Cannot connecto hald"));

726 
out
;

728 
	`dbus_”rÜ_š™
 (&
”rÜ
);

729 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
ùx_dœeù
, 
udi
, &
”rÜ
)) {

730 
out
;

732 
cÚ_dœeù
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
ùx_dœeù
);

733 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚ_dœeù
, 
NULL
);

734 
	`dbus_cÚÃùiÚ_£t_ex™_Ú_discÚÃù
 (
cÚ_dœeù
, 0);

735 
	`dbus_cÚÃùiÚ_add_f‹r
 (
cÚ_dœeù
, 
dœeù_f‹r_funùiÚ
, 
NULL
, NULL);

738 
	`dbus_”rÜ_š™
 (&
”rÜ
);

739 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
)

740 
out
;

742 
	`dbus_”rÜ_š™
 (&
”rÜ
);

743 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
ùx
, 
udi
, &
”rÜ
)) {

744 
out
;

747 
	`HAL_DEBUG
 (("**************************************************"));

748 
	`HAL_DEBUG
 (("Došg‡ddÚ-¡ÜagfÜ % (bu %sè(drive_ty³ %sè(ud˜%s)", 
deviû_fe
, 
bus
, 
drive_ty³
, 
udi
));

749 
	`HAL_DEBUG
 (("**************************************************"));

751 ià(
	`¡rcmp
 (
drive_ty³
, "cdrom") == 0)

752 
is_cdrom
 = 1;

754 
is_cdrom
 = 0;

756 
medŸ_¡©us
 = 
MEDIA_STATUS_UNKNOWN
;

759 #ifdeà
HAVE_CONKIT


764 
	`g‘_sy¡em_idË_äom_ck
 ();

766 
	`dbus_bus_add_m©ch
 (
cÚ
,

771 
NULL
);

772 
	`dbus_bus_add_m©ch
 (
cÚ
,

777 
NULL
);

784 
	`dbus_bus_add_m©ch
 (
cÚ
,

788 
NULL
);

789 
	`dbus_bus_add_m©ch
 (
cÚ
,

793 
NULL
);

794 
¡r
 = 
	`g_¡rdup_´štf
 ("type='signal'"

798 
udi
);

799 
	`dbus_bus_add_m©ch
 (
cÚ
,

800 
¡r
,

801 
NULL
);

802 
	`g_ä“
 (
¡r
);

803 
	`dbus_cÚÃùiÚ_add_f‹r
 (
cÚ
, 
dbus_f‹r_funùiÚ
, 
NULL
, NULL);

805 ià(!
	`libh®_deviû_şaim_š‹rçû
 (
ùx
,

806 
udi
,

811 &
”rÜ
)) {

812 
	`HAL_ERROR
 (("Cannot claim interface 'org.freedesktop.Hal.Device.Storage.Removable'"));

813 
out
;

817 
	`upd©e_pŞlšg_š‹rv®
 ();

818 
	`g_maš_loİ_run
 (
loİ
);

820 
out
:

821 ià(
ùx
 !ğ
NULL
) {

822 
	`dbus_”rÜ_š™
 (&
”rÜ
);

823 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

824 
	`libh®_ùx_ä“
 (
ùx
);

828 
	}
}

	@hald/linux/addons/addon-usb-cable.c

24 
	#_GNU_SOURCE


	)

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<fú.h
>

35 
	~<”rÜ.h
>

36 
	~<pŞl.h
>

38 
	~<glib.h
>

40 
	~"libh®/libh®.h
"

41 
	~"../../ut_h–³r.h
"

42 
	~"../../logg”.h
"

44 
LibH®CÚ‹xt
 *
	gùx
;

45 *
	gudi
;

46 *
	gbu‰Ú_ty³
;

49 
	$em™_¡©e
 (*
usb_mode
)

51 
DBusE¼Ü
 
”rÜ
;

52 
LibH®ChªgeS‘
 *
cs
;

53 *
ÿbË_ty³
;

54 
ÿbË_cÚÃùed
;

56 
cs
 = 
	`libh®_deviû_Ãw_chªge£t
 (
udi
);

57 ià(
cs
 =ğ
NULL
) {

58 
	`HAL_ERROR
 (("Cannot initialize changeset"));

63 ià(
	`¡rcmp
(
usb_mode
, "a_host") == 0 ||

64 
	`¡rcmp
(
usb_mode
, "a_suspend") == 0) {

65 
ÿbË_ty³
 = "Mini-A";

66 
ÿbË_cÚÃùed
 = 
TRUE
;

67 } ià(
	`¡rcmp
(
usb_mode
, "b_peripheral") == 0) {

68 
ÿbË_ty³
 = "Mini-B";

69 
ÿbË_cÚÃùed
 = 
TRUE
;

71 
ÿbË_ty³
 = "disconnected";

72 
ÿbË_cÚÃùed
 = 
FALSE
;

75 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "usb_deviû.mode", 
usb_mode
);

76 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "usb_device.cable_type",

77 
ÿbË_ty³
);

78 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "button.state.value",

79 
ÿbË_cÚÃùed
);

81 
	`dbus_”rÜ_š™
 (&
”rÜ
);

83 
	`libh®_deviû_comm™_chªge£t
 (
ùx
, 
cs
, &
”rÜ
);

84 
	`libh®_deviû_ä“_chªge£t
 (
cs
);

86 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

87 
	`HAL_ERROR
 (("FaedØ£ˆ´İ”ty: %s", 
”rÜ
.
mes§ge
));

88 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

92 
	`libh®_deviû_em™_cÚd™iÚ
 (
ùx
, 
udi
, "Bu‰ÚP»s£d", 
bu‰Ú_ty³
,

93 &
”rÜ
);

94 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

95 
	`HAL_ERROR
 (("FaedØ£nd cÚd™iÚ: %s", 
”rÜ
.
mes§ge
));

96 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

101 
	}
}

104 
	$»ad_¡©e
 (
fd
)

106 
Şd_v®ue
[128] = "\0";

107 
v®ue
[128];

108 
r
;

110 
	`mem£t
 (
v®ue
, 0,  (value));

111 
r
 = 
	`»ad
 (
fd
, 
v®ue
,  (value));

112 ià(
r
 < 0) {

113 
	`HAL_ERROR
 (("Could‚ot„eadhe value fromhe file"));

114  
r
;

118 
	`g_¡rchomp
 (
v®ue
);

120 ià(
	`¡rcmp
 (
Şd_v®ue
, 
v®ue
) != 0) {

121 
	`em™_¡©e
 (
v®ue
);

122 
	`¡rıy
 (
Şd_v®ue
, 
v®ue
);

126 ià(
	`l£ek
 (
fd
, 0, 
SEEK_SET
) < 0) {

127 
	`HAL_ERROR
 (("Could‚ot seek inhe file"));

128  
r
;

132 
	}
}

135 
	$w©ch_¡©e
 (
fd
)

137 
pŞlfd
…ollfd;

138 
r
;

140 
pŞlfd
.
fd
 = fd;

141 
pŞlfd
.
ev’ts
 = 
POLLIN
 | 
POLLPRI
;

142 
pŞlfd
.
»v’ts
 = 0;

144 
	`pŞl
 (&
pŞlfd
, 1, -1) == 1) {

145 
r
 = 
	`»ad_¡©e
 (
fd
);

146 ià(
r
 < 0)

150  
r
;

151 
	}
}

154 
	$maš
 (
¬gc
, **
¬gv
)

156 
DBusE¼Ü
 
”rÜ
;

157 *
sysfs_·th
, *
¡©e_·th
;

158 
fd
;

160 
	`h®_£t_´oc_t™Ë_š™
 (
¬gc
, 
¬gv
);

162 
	`£tup_logg”
();

164 
	`HAL_INFO
 (("addon-usb-cable„unning"));

166 
udi
 = 
	`g‘’v
("UDI");

167 ià(!
udi
) {

168 
	`HAL_ERROR
 (("Failedo get UDI"));

172 
	`dbus_”rÜ_š™
 (&
”rÜ
);

174 
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
);

175 ià(
ùx
 =ğ
NULL
) {

176 
	`HAL_ERROR
 (("Unableo initialise†ibhal context: %s",

177 
”rÜ
.
mes§ge
));

181 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
ùx
, 
udi
, &
”rÜ
)) {

182 
	`HAL_INFO
 (("Deviû % nÙ„—dy y‘: %s", 
udi
, 
”rÜ
.
mes§ge
));

186 
sysfs_·th
 = 
	`g‘’v
 ("HAL_PROP_LINUX_SYSFS_PATH");

187 ià(!
sysfs_·th
) {

188 
	`HAL_ERROR
 (("Property†inux.sysfs_path‚ot set for device"));

192 
	`HAL_INFO
 (("sysfs_·th=%s", 
sysfs_·th
));

194 
bu‰Ú_ty³
 = 
	`g‘’v
 ("HAL_PROP_BUTTON_TYPE");

195 ià(!
bu‰Ú_ty³
) {

196 
	`HAL_ERROR
 (("Property button.type‚ot set for device"));

200 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
udi
, "bu‰Ú.has_¡©e", 
TRUE
,

201 &
”rÜ
);

203 ià(!
	`a¥rštf
 (&
¡©e_·th
, "%s/../mode", 
sysfs_·th
)) {

204 
	`HAL_ERROR
 (("Memory‡llocation…roblem"));

208 
	`drİ_´iveges
 (0);

210 
	`h®_£t_´oc_t™Ë
 ("h®d-addÚ-usb-ÿbË:†i¡’šg oÀ%s", 
¡©e_·th
);

212 
fd
 = 
	`İ’
 (
¡©e_·th
, 
O_RDONLY
);

213 ià(
fd
 < 0) {

214 
	`HAL_ERROR
 (("FaedØİ’ '%s'", 
¡©e_·th
));

218 
	`ä“
 (
¡©e_·th
);

220 
	`»ad_¡©e
 (
fd
);

221 
	`w©ch_¡©e
 (
fd
);

223 
	`şo£
 (
fd
);

226 
	}
}

	@hald/linux/addons/addon-usb-csr.c

27 
	~<cÚfig.h
>

28 
	~<¡dio.h
>

29 
	~<¡ršg.h
>

30 
	~<usb.h
>

32 
	~<glib/gmaš.h
>

33 
	~<dbus/dbus-glib.h
>

34 
	~<dbus/dbus-glib-lowËv–.h
>

36 
	~"libh®/libh®.h
"

37 
	~"../../logg”.h
"

38 
	~"../../ut_h–³r.h
"

40 
	#TIMEOUT
 30L

	)

43 
	#P6
 (
buf
[0])

	)

44 
	#P0
 (
buf
[1])

	)

45 
	#P4
 (
buf
[2])

	)

46 
	#P5
 (
buf
[3])

	)

47 
	#P8
 (
buf
[4])

	)

48 
	#P9
 (
buf
[5])

	)

49 
	#PB0
 (
buf
[6])

	)

50 
	#PB1
 (
buf
[7])

	)

52 
	s_Prİ”tyCacheI‹m


54 
gboŞ—n
 
	mbus_no_´e£Á
;

55 
	mbus_no
;

56 
gboŞ—n
 
	mpÜt_no_´e£Á
;

57 
	mpÜt_no
;

58 
gboŞ—n
 
	mc¤_is_du®_´e£Á
;

59 
gboŞ—n
 
	mc¤_is_du®
;

60 
gboŞ—n
 
	mcu¼’t_ch¬ge_´e£Á
;

61 
	mcu¼’t_ch¬ge
;

62 } 
	tPrİ”tyCacheI‹m
;

65 
Prİ”tyCacheI‹m
 *
	gdev_´İs
 = 
NULL
;

66 
LibH®CÚ‹xt
 *
	gh®ùx
 = 
NULL
;

67 
GMašLoİ
 *
	gmaš_loİ
;

68 cÚ¡ *
	gdeviû_udi
;

71 
usb_deviû
 *
fšd_deviû
 (
Prİ”tyCacheI‹m
 *
pci
);

73 
Prİ”tyCacheI‹m
*

74 
	$´İ”ty_ÿche_™em_g‘
 (cÚ¡ *
h®_deviû_udi
)

76 
Prİ”tyCacheI‹m
 * 
pci
 = 
	`g_Ãw0
 (PropertyCacheItem,1);

77 
DBusE¼Ü
 
”r
;

78 
	`dbus_”rÜ_š™
 (&
”r
);

80 
pci
->
bus_no_´e£Á
 = 
	`libh®_deviû_´İ”ty_exi¡s
 (
h®ùx
, 
h®_deviû_udi
,

81 "usb_deviû.bus_numb”", &
”r
);

82 ià(
	`dbus_”rÜ_is_£t
 (&
”r
))

83 
	`HAL_ERROR
 (("E¼Ü: [%s]/[%s]", 
”r
.
Çme
,ƒ¼.
mes§ge
));

85 ià(
pci
->
bus_no_´e£Á
)

86 
pci
->
bus_no
 = 
	`libh®_deviû_g‘_´İ”ty_št
 (
h®ùx
, 
h®_deviû_udi
,

87 "usb_deviû.bus_numb”", &
”r
);

89 
pci
->
pÜt_no_´e£Á
 = 
	`libh®_deviû_´İ”ty_exi¡s
 (
h®ùx
, 
h®_deviû_udi
,

90 "usb_deviû.lšux.deviû_numb”", &
”r
);

91 ià(
pci
->
pÜt_no_´e£Á
)

92 
pci
->
pÜt_no
 = 
	`libh®_deviû_g‘_´İ”ty_št
 (
h®ùx
, 
h®_deviû_udi
,

93 "usb_deviû.lšux.deviû_numb”", &
”r
);

95 
pci
->
c¤_is_du®_´e£Á
 = 
	`libh®_deviû_´İ”ty_exi¡s
 (
h®ùx
, 
h®_deviû_udi
,

96 "b©‹ry.c¤.is_du®", &
”r
);

97 ià(
pci
->
c¤_is_du®_´e£Á
)

98 
pci
->
c¤_is_du®
 = 
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
h®ùx
, 
h®_deviû_udi
,

99 "b©‹ry.c¤.is_du®", &
”r
);

101 
pci
->
cu¼’t_ch¬ge_´e£Á
 = 
	`libh®_deviû_´İ”ty_exi¡s
 (
h®ùx
, 
h®_deviû_udi
,

102 "b©‹ry.ch¬ge_Ëv–.cu¼’t", &
”r
);

103 ià(
pci
->
cu¼’t_ch¬ge_´e£Á
)

104 
pci
->
cu¼’t_ch¬ge
 = 
	`libh®_deviû_g‘_´İ”ty_št
 (
h®ùx
, 
h®_deviû_udi
,

105 "b©‹ry.ch¬ge_Ëv–.cu¼’t", &
”r
);

107  
pci
;

108 
	}
}

112 
	$check_b©‹ry
 (cÚ¡ *
h®_deviû_udi
, 
Prİ”tyCacheI‹m
 *
pci
)

114 
usb_deviû
 *
cu¼_deviû
;

115 
usb_dev_hªdË
 *
hªdË
;

116 
buf
[80];

117 
DBusE¼Ü
 
”r
;

118 
addr
;

119 
is_du®
 = 0;

120 
³rûÁage
 = 0;

122 ià(
pci
 =ğ
NULL
)

125 
	`HAL_DEBUG
 (("CSR deviû: [%s]", 
h®_deviû_udi
));

126 
is_du®
 = 
pci
->
c¤_is_du®
;

129 
	`HAL_DEBUG
 (("I du®: %d", 
is_du®
));

130 
addr
 = 
is_du®
? 1<<8 : 0;

132 
cu¼_deviû
 = 
	`fšd_deviû
 (
pci
);

133 ià(
cu¼_deviû
 =ğ
NULL
) {

134 
	`HAL_ERROR
 (("Deviû % nÙ found", 
h®_deviû_udi
));

138 
hªdË
 = 
	`usb_İ’
 (
cu¼_deviû
);

139 ià(
hªdË
 =ğ
NULL
) {

140 
	`HAL_ERROR
 (("Could‚ot open usb device"));

144 ià(!
	`usb_cÚŒŞ_msg
 (
hªdË
, 0xc0, 0x09, 0x03|
addr
, 0x00|addr,

145 
buf
, 8, 
TIMEOUT
) != 8) {

146 ià((
P0
 =ğ0x3bè&& (
P4
 == 0)) {

147 
	`HAL_DEBUG
 (("Receiver busy,rying‡gain†ater"));

149 
cu¼’t_ch¬ge
 = 
P5
 & 0x07;

151 
	`HAL_DEBUG
 (("Ch¬gËv–: %d->%d", 
pci
->
cu¼’t_ch¬ge
, current_charge));

152 ià(
cu¼’t_ch¬ge
 !ğ
pci
->current_charge) {

153 
pci
->
cu¼’t_ch¬ge
 = cu¼’t_ch¬ge; 
	`dbus_”rÜ_š™
 (&
”r
);

154 
	`libh®_deviû_£t_´İ”ty_št
 (
h®ùx
, 
h®_deviû_udi
,

155 "b©‹ry.ch¬ge_Ëv–.cu¼’t", 
cu¼’t_ch¬ge
, &
”r
);

156 ià(
cu¼’t_ch¬ge
 != 0) {

157 
³rûÁage
 = (100.0 / 7.0è* 
cu¼’t_ch¬ge
;

158 
	`libh®_deviû_£t_´İ”ty_št
 (
h®ùx
, 
h®_deviû_udi
,

159 "b©‹ry.ch¬ge_Ëv–.³rûÁage", 
³rûÁage
, &
”r
);

161 
	`libh®_deviû_»move_´İ”ty
(
h®ùx
, 
h®_deviû_udi
,

162 "b©‹ry.ch¬ge_Ëv–.³rûÁage", &
”r
);

167 
	`³¼Ü
 ("Writingo USB device");

168 
	`usb_şo£
 (
hªdË
);

169 
	}
}

172 
usb_deviû
*

173 
	$fšd_deviû
 (
Prİ”tyCacheI‹m
 *
pci
)

175 
usb_bus
* 
cu¼_bus
;

176 
LUdœÇme
[5];

177 
LUâame
[5];

179 ià(!(
pci
->
bus_no_´e£Á
 &&…ci->
pÜt_no_´e£Á
)) {

181 
	`HAL_ERROR
 (("No hal bus‚umber‡nd/or…ort‚umber"));

182  
NULL
;

184 
	`¢´štf
 (
LUdœÇme
,  (LUdœÇme), "%03d", 
pci
->
bus_no
);

185 
	`¢´štf
 (
LUâame
,  (LUâame), "%03d",
pci
->
pÜt_no
);

186 
	`HAL_DEBUG
 (("Lookšg fÜ: [%s][%s]", 
LUdœÇme
, 
LUâame
));

188 
cu¼_bus
 = 
usb_bus£s
; cu¼_bu !ğ
NULL
; cu¼_bu ğcu¼_bus->
Ãxt
) {

189 
usb_deviû
 *
cu¼_deviû
;

191 ià(
	`g_¡rÿ£cmp
 (
LUdœÇme
, 
cu¼_bus
->
dœÇme
))

194 
cu¼_deviû
 = 
cu¼_bus
->
deviûs
; cu¼_deviû !ğ
NULL
;

195 
cu¼_deviû
 = cu¼_deviû->
Ãxt
) {

197 ià(
	`g_¡rÿ£cmp
 (
LUâame
, 
cu¼_deviû
->
f’ame
))

199 
	`HAL_DEBUG
 (("M©ched deviû: [%s][%s][%04X:%04X]", 
cu¼_bus
->
dœÇme
,

200 
cu¼_deviû
->
f’ame
,

201 
cu¼_deviû
->
desütÜ
.
idV’dÜ
,

202 
cu¼_deviû
->
desütÜ
.
idProduù
));

203  
cu¼_deviû
;

206  
NULL
;

207 
	}
}

209 
gboŞ—n


210 
	$check_®l_b©‹r›s
 (
gpoš‹r
 
d©a
)

212 
	`HAL_DEBUG
 (("** Check batteries"));

214 
	`usb_fšd_bus£s
 ();

215 
	`usb_fšd_deviûs
 ();

216 
	`check_b©‹ry
 (
deviû_udi
, 
dev_´İs
);

217  
TRUE
;

218 
	}
}

220 
gboŞ—n


221 
	$is_the_deviû
 (cÚ¡ *
h®_deviû_udi
)

223  !
	`g_ascii_¡rÿ£cmp
 (
deviû_udi
, 
h®_deviû_udi
);

224 
	}
}

227 
	$deviû_»moved
 (cÚ¡ *
h®_deviû_udi
)

230 ià(
	`is_the_deviû
 (
h®_deviû_udi
)) {

231 
	`HAL_DEBUG
 (("** Thdeviû % »moved,ƒx™", 
deviû_udi
));

232 
	`g_maš_loİ_qu™
 (
maš_loİ
);

234 
	}
}

237 
	$´İ”ty_modif›d
 (
LibH®CÚ‹xt
 *
ùx
,

238 cÚ¡ *
h®_deviû_udi
,

239 cÚ¡ *
key
,

240 
dbus_boŞ_t
 
is_»moved
,

241 
dbus_boŞ_t
 
is_added
)

244 ià(!
	`g_ascii_¡rÿ£cmp
 (
key
, "battery.command_interface")) {

245 ià(
is_»moved
) {

246 
	`HAL_DEBUG
 (("** Maš Prİ”ty % »moved: %s", 
key
, 
h®_deviû_udi
));

248 
	`deviû_»moved
 (
h®_deviû_udi
);

252 ià(
	`is_the_deviû
 (
h®_deviû_udi
))

254 ià(!(
	`g_ascii_¡rÿ£cmp
 (
key
, "usb_device.bus_number") &&

255 
	`g_ascii_¡rÿ£cmp
 (
key
, "usb_device.linux.device_number") &&

256 
	`g_ascii_¡rÿ£cmp
 (
key
, "battery.csr.is_dual"))) {

257 
	`HAL_DEBUG
 (("** Prİ”ty % added/chªged: %s", 
key
, 
h®_deviû_udi
));

258 ià(
dev_´İs
)

259 
	`g_ä“
 (
dev_´İs
);

260 
dev_´İs
 = 
	`´İ”ty_ÿche_™em_g‘
 (
h®_deviû_udi
);

263 
	}
}

266 
	$maš
 (
¬gc
, *
¬gv
[])

268 
DBusE¼Ü
 
”r
;

270 
	`h®_£t_´oc_t™Ë_š™
 (
¬gc
, 
¬gv
);

272 
	`£tup_logg”
 ();

274 
deviû_udi
 = 
	`g‘’v
 ("UDI");

276 
	`HAL_DEBUG
 (("deviû:[%s]", 
deviû_udi
));

277 ià(
deviû_udi
 =ğ
NULL
) {

278 
	`HAL_ERROR
 (("No device specified"));

282 
	`dbus_”rÜ_š™
 (&
”r
);

283 ià((
h®ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”r
)è=ğ
NULL
) {

284 
	`HAL_ERROR
 (("Cannot connecto hald"));

290 
	`dbus_”rÜ_š™
 (&
”r
);

291 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
h®ùx
, 
deviû_udi
,

292 "b©‹ry.´e£Á", 
TRUE
, &
”r
);

293 ià(!
	`libh®_deviû_´İ”ty_exi¡s
 (
h®ùx
, 
deviû_udi
,

294 "b©‹ry.is_»ch¬g—bË", &
”r
))

295 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
h®ùx
, 
deviû_udi
,

296 "b©‹ry.is_»ch¬g—bË", 
FALSE
, &
”r
);

297 
	`libh®_deviû_£t_´İ”ty_št
 (
h®ùx
, 
deviû_udi
,

298 "b©‹ry.ch¬ge_Ëv–.design", 7, &
”r
);

299 
	`libh®_deviû_£t_´İ”ty_št
 (
h®ùx
, 
deviû_udi
,

300 "b©‹ry.ch¬ge_Ëv–.Ï¡_fuÎ", 7, &
”r
);

301 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
h®ùx
, 
deviû_udi
,

302 "šfo.ÿ‹gÜy", "b©‹ry", &
”r
);

303 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
h®ùx
, 
deviû_udi
,

304 "b©‹ry.commªd_š‹rçû", "c¤", &
”r
);

307 
	`libh®_ùx_£t_deviû_´İ”ty_modif›d
 (
h®ùx
, 
´İ”ty_modif›d
);

310 
dev_´İs
 = 
	`´İ”ty_ÿche_™em_g‘
 (
deviû_udi
);

311 
	`HAL_ERROR
 (("** Initial fillup done"));

314 
	`usb_š™
 ();

317 
	`check_®l_b©‹r›s
 (
NULL
);

320 
	`dbus_”rÜ_š™
 (&
”r
);

321 
	`libh®_deviû_add_ÿ·b™y
 (
h®ùx
, 
deviû_udi
, "b©‹ry", &
”r
);

323 
	`dbus_”rÜ_š™
 (&
”r
);

324 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
h®ùx
, 
deviû_udi
, &
”r
)) {

328 
	`h®_£t_´oc_t™Ë
 ("hald-addon-usb-csr:†istening on '%s'",

329 
	`libh®_deviû_g‘_´İ”ty_¡ršg
(
h®ùx
, 
deviû_udi
,

330 "šfo.´oduù", &
”r
));

332 
maš_loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

333 #ifdeà
HAVE_GLIB_2_14


334 
	`g_timeout_add_£cÚds
 (
TIMEOUT
, 
check_®l_b©‹r›s
, 
NULL
);

336 
	`g_timeout_add
 (1000L * 
TIMEOUT
, 
check_®l_b©‹r›s
, 
NULL
);

338 
	`g_maš_loİ_run
 (
maš_loİ
);

340 
	`libh®_ùx_shutdown
 (
h®ùx
, &
”r
);

341 
	`HAL_ERROR
 (("** Addonƒxits‚ormally"));

343 
	}
}

	@hald/linux/apm.c

23 #ifdeà
HAVE_CONFIG_H


24 
	~<cÚfig.h
>

27 
	~<¡ršg.h
>

29 
	~"../h®d_dbus.h
"

30 
	~"../deviû_šfo.h
"

31 
	~"../logg”.h
"

32 
	~"../ut.h
"

33 
	~"../ut_pm.h
"

35 
	~"os¥ec_lšux.h
"

37 
	~"­m.h
"

40 
	mAPM_TYPE_BATTERY
,

41 
	mAPM_TYPE_AC_ADAPTER


44 
	gš‹rv®_pŞl_round
 = 0;

46 
	sAPMDevHªdËr_s


48 
	m­m_ty³
;

49 
	mH®Deviû
 *(*
	madd
è(cÚ¡ 
gch¬
 *
	m­m_·th
, 
H®Deviû
 *
	m·»Á
, 
APMDevHªdËr_s
 *
	mhªdËr
);

50 
gboŞ—n
 (*
compu‹_udi
è(
H®Deviû
 *
	md
, 
APMDevHªdËr_s
 *
	mhªdËr
);

51 
gboŞ—n
 (*
»move
è(
H®Deviû
 *
	md
, 
APMDevHªdËr_s
 *
	mhªdËr
);

52 
gboŞ—n
 (*
»äesh
è(
H®Deviû
 *
	md
, 
APMDevHªdËr_s
 *
	mhªdËr
);

53 } 
	tAPMDevHªdËr
;

56 
	mdriv”_v”siÚ
[256];

57 
	mv”siÚ_majÜ
;

58 
	mv”siÚ_mšÜ
;

59 
	mæags
;

60 
	mac_lše_¡©us
;

61 
	mb©‹ry_¡©us
;

62 
	mb©‹ry_æags
;

63 
	mb©‹ry_³rûÁage
;

64 
	mb©‹ry_time
;

65 } 
	tAPMInfo
;

67 
	#APM_POLL_INTERVAL
 2

	)

69 
gboŞ—n


70 
	$­m_pŞl
 (
gpoš‹r
 
d©a
)

72 
GSLi¡
 *
i
;

73 
GSLi¡
 *
deviûs
;

75 
deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

78 
i
 = 
deviûs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

79 
H®Deviû
 *
d
;

80 
d
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

81 
	`­m_»sÿn_deviû
 (
d
);

84 
	`g_¦i¡_ä“
 (
deviûs
);

85  
TRUE
;

86 
	}
}

88 
gboŞ—n


89 
	$»ad_äom_­m
 (cÚ¡ *
­m_fe
, 
APMInfo
 *
i
)

91 *
buf
;

92 
gboŞ—n
 
»t
;

94 
»t
 = 
FALSE
;

96 ià((
buf
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 ("", 
­m_fe
)è=ğ
NULL
)

97 
out
;

99 ià(
	`ssÿnf
 (
buf
, "%s %d.%d %x %x %x %x %d%% %d",

100 
i
->
driv”_v”siÚ
,

101 &
i
->
v”siÚ_majÜ
,

102 &
i
->
v”siÚ_mšÜ
,

103 &
i
->
æags
,

104 &
i
->
ac_lše_¡©us
,

105 &
i
->
b©‹ry_¡©us
,

106 &
i
->
b©‹ry_æags
,

107 &
i
->
b©‹ry_³rûÁage
,

108 &
i
->
b©‹ry_time
) != 9)

109 
out
;

111 
»t
 = 
TRUE
;

113 
out
:

114  
»t
;

115 
	}
}

119 
	mBATTERY_HIGH
 = 0,

120 
	mBATTERY_LOW
 = 1,

121 
	mBATTERY_CRITICAL
 = 2,

122 
	mBATTERY_CHARGING
 = 3

125 
gboŞ—n


126 
	$b©‹ry_»äesh
 (
H®Deviû
 *
d
, 
APMDevHªdËr
 *
hªdËr
)

128 cÚ¡ *
·th
;

129 
»maššg_³rûÁage
;

130 
»maššg_time
;

131 
gboŞ—n
 
is_ch¬gšg
;

132 
gboŞ—n
 
is_disch¬gšg
;

133 
H®Deviû
 *
compu‹r
;

134 
APMInfo
 
i
;

136 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.apm_path");

137 ià(
·th
 =ğ
NULL
)

138  
FALSE
;

140 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Battery Bay");

141 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.type", "primary");

142 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.technology", "unknown");

143 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "battery");

144 
	`h®_deviû_add_ÿ·b™y
 (
d
, "battery");

148 
	`»ad_äom_­m
 (
·th
, &
i
);

155 ià(
i
.
b©‹ry_³rûÁage
 < 0 || i.
driv”_v”siÚ
[0] =ğ'B' || i.
b©‹ry_¡©us
 == 0xff ) {

156 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

157 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.is_rechargeable");

158 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.rechargeable.is_charging");

159 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.rechargeable.is_discharging");

160 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.unit");

161 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.current");

163 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.last_full");

164 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.design");

165 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.percentage");

166 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.remaining_time");

167 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.´e£Á", 
FALSE
);

168 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

170 ià((
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/Üg/ä“desktİ/H®/deviûs/compu‹r")è=ğ
NULL
 &&

171 (
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/Üg/ä“desktİ/H®/deviûs/compu‹r")è=ğ
NULL
) {

172 
	`HAL_ERROR
 (("No computer object?"));

174 ià(!
	`h®_deviû_has_´İ”ty
(
compu‹r
, "system.formfactor")) {

175 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
compu‹r
, "system.formfactor", "laptop");

177 ià(
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
compu‹r
, "system.formfactor"), "laptop") != 0) {

178 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
compu‹r
, "system.formfactor", "laptop");

182 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

183 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.is_»ch¬g—bË", 
TRUE
);

184 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.´e£Á", 
TRUE
);

185 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.cu¼’t", 
i
.
b©‹ry_³rûÁage
);

186 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.charge_level.unit", "percent");

188 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "battery.charge_level.design", 100);

190 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "battery.charge_level.last_full", 100);

197 ià(
i
.
b©‹ry_¡©us
 =ğ
BATTERY_CHARGING
) {

198 
is_ch¬gšg
 = 
TRUE
;

199 
is_disch¬gšg
 = 
FALSE
;

200 
»maššg_time
 = 0;

202 
is_ch¬gšg
 = 
FALSE
;

203 
is_disch¬gšg
 = (
i
.
ac_lše_¡©us
 =ğ
FALSE
);

205 
»maššg_time
 = 
i
.
b©‹ry_time
 * 60;

209 ià(
»maššg_time
 > 0) {

211 ià(!
is_ch¬gšg
 && 
is_disch¬gšg
 && !
	`h®_deviû_has_´İ”ty
(
d
,"battery.remaining_time")) {

212 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»maššg_time", 
»maššg_time
);

213 
š‹rv®_pŞl_round
 = 0;

216 ià(
š‹rv®_pŞl_round
 == 15) {

217 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»maššg_time", 
»maššg_time
);

218 
š‹rv®_pŞl_round
 = 0;

223 
š‹rv®_pŞl_round
++;

225 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.remaining_time");

229 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.»ch¬g—bË.is_ch¬gšg", 
is_ch¬gšg
);

230 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.»ch¬g—bË.is_disch¬gšg", 
is_disch¬gšg
);

233 
»maššg_³rûÁage
 = 
i
.
b©‹ry_³rûÁage
;

236 ià(
»maššg_³rûÁage
 >= 0 &&„emaining_percentage <= 100)

237 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.³rûÁage", 
»maššg_³rûÁage
);

239 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.charge_level.percentage");

241 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

244  
TRUE
;

245 
	}
}

247 
gboŞ—n


248 
	$ac_ad­‹r_»äesh
 (
H®Deviû
 *
d
, 
APMDevHªdËr
 *
hªdËr
)

250 cÚ¡ *
·th
;

251 
APMInfo
 
i
;

253 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.apm_path");

254 ià(
·th
 =ğ
NULL
)

255  
FALSE
;

257 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "AC Adapter");

258 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "ac_adapter");

259 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ac_adapter");

261 
	`»ad_äom_­m
(
·th
, &
i
);

263 ià(
i
.
ac_lše_¡©us
)

264 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "ac_ad­‹r.´e£Á", 
TRUE
);

266 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "ac_ad­‹r.´e£Á", 
FALSE
);

268  
TRUE
;

269 
	}
}

277 
gboŞ—n


278 
	$­m_syÁhesize_hÙ¶ug_ev’ts
 ()

280 
gboŞ—n
 
»t
;

281 
H®Deviû
 *
compu‹r
;

282 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

284 
»t
 = 
FALSE
;

286 ià(!
	`g_fe_‹¡
 ("/´oc/­m", 
G_FILE_TEST_EXISTS
))

287 
out
;

289 
»t
 = 
TRUE
;

291 ià((
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/Üg/ä“desktİ/H®/deviûs/compu‹r")è=ğ
NULL
 &&

292 (
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/Üg/ä“desktİ/H®/deviûs/compu‹r")è=ğ
NULL
) {

293 
	`HAL_ERROR
 (("No computer object?"));

294 
out
;

298 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
compu‹r
, "power_management.type", "apm");

300 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

301 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

302 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_APM
;

303 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
­m
.
­m_·th
, "/proc/apm",  (hotplug_event->apm.apm_path));

304 
hÙ¶ug_ev’t
->
­m
.
­m_ty³
 = 
APM_TYPE_BATTERY
;

305 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

307 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

308 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_APM
;

309 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
­m
.
­m_·th
, "/proc/apm",  (hotplug_event->apm.apm_path));

310 
hÙ¶ug_ev’t
->
­m
.
­m_ty³
 = 
APM_TYPE_AC_ADAPTER
;

311 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

313 #ifdeà
HAVE_GLIB_2_14


314 
	`g_timeout_add_£cÚds
 (
APM_POLL_INTERVAL
,

315 
­m_pŞl
,

316 
NULL
);

318 
	`g_timeout_add
 (1000 * 
APM_POLL_INTERVAL
,

319 
­m_pŞl
,

320 
NULL
);

323 
out
:

324  
»t
;

325 
	}
}

327 
H®Deviû
 *

328 
	$­m_g’”ic_add
 (cÚ¡ 
gch¬
 *
­m_·th
, 
H®Deviû
 *
·»Á
, 
APMDevHªdËr
 *
hªdËr
)

330 
H®Deviû
 *
d
;

331 
d
 = 
	`h®_deviû_Ãw
 ();

332 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.­m_·th", 
­m_·th
);

333 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "lšux.­m_ty³", 
hªdËr
->
­m_ty³
);

334 ià(
·»Á
 !ğ
NULL
)

335 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á
));

337 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

338 ià(
hªdËr
->
»äesh
 =ğ
NULL
 || !hªdËr->
	`»äesh
 (
d
, handler)) {

339 
	`g_objeù_uÄef
 (
d
);

340 
d
 = 
NULL
;

342  
d
;

343 
	}
}

345 
gboŞ—n


346 
	$­m_g’”ic_compu‹_udi
 (
H®Deviû
 *
d
, 
APMDevHªdËr
 *
hªdËr
)

348 
gch¬
 
udi
[256];

350 ià(
hªdËr
->
­m_ty³
 =ğ
APM_TYPE_BATTERY
 ) {

351 
	`h®d_compu‹_udi
 (
udi
,  (udi),

354 } ià(
hªdËr
->
­m_ty³
 =ğ
APM_TYPE_AC_ADAPTER
 ) {

355 
	`h®d_compu‹_udi
 (
udi
,  (udi),

358 
	`h®d_compu‹_udi
 (
udi
,  (udi),

360 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "info.category"));

363 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

364  
TRUE
;

365 
	}
}

367 
gboŞ—n


368 
	$­m_g’”ic_»move
 (
H®Deviû
 *
d
, 
APMDevHªdËr
 *
hªdËr
)

370 ià(!
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_gdl
 (), 
d
)) {

371 
	`HAL_WARNING
 (("Error„emoving device"));

374  
TRUE
;

375 
	}
}

377 
APMDevHªdËr
 
	g­mdev_hªdËr_b©‹ry
 = {

378 .
­m_ty³
 = 
APM_TYPE_BATTERY
,

379 .
	gadd
 = 
­m_g’”ic_add
,

380 .
	gcompu‹_udi
 = 
­m_g’”ic_compu‹_udi
,

381 .
	g»äesh
 = 
b©‹ry_»äesh
,

382 .
	g»move
 = 
­m_g’”ic_»move


385 
APMDevHªdËr
 
	g­mdev_hªdËr_ac_ad­‹r
 = {

386 .
­m_ty³
 = 
APM_TYPE_AC_ADAPTER
,

387 .
	gadd
 = 
­m_g’”ic_add
,

388 .
	gcompu‹_udi
 = 
­m_g’”ic_compu‹_udi
,

389 .
	g»äesh
 = 
ac_ad­‹r_»äesh
,

390 .
	g»move
 = 
­m_g’”ic_»move


393 
APMDevHªdËr
 *
	g­m_hªdËrs
[] = {

394 &
­mdev_hªdËr_b©‹ry
,

395 &
­mdev_hªdËr_ac_ad­‹r
,

396 
NULL


400 
	$hÙ¶ug_ev’t_begš_add_­m
 (cÚ¡ 
gch¬
 *
­m_·th
, 
­m_ty³
, 
H®Deviû
 *
·»Á
, *
’d_tok’
)

402 
gušt
 
i
;

404 
	`HAL_INFO
 (("­m_add:‡pm_·th=% ­m_ty³=%d,…¬’t=0x%08x", 
­m_·th
, 
­m_ty³
, 
·»Á
));

406 
i
 = 0; 
­m_hªdËrs
 [i] !ğ
NULL
; i++) {

407 
APMDevHªdËr
 *
hªdËr
;

409 
hªdËr
 = 
­m_hªdËrs
[
i
];

410 ià(
hªdËr
->
­m_ty³
 ==‡pm_type) {

411 
H®Deviû
 *
d
;

413 
d
 = 
hªdËr
->
	`add
 (
­m_·th
, 
·»Á
, handler);

414 ià(
d
 =ğ
NULL
) {

416 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

417 
out
;

420 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "lšux.hÙ¶ug_ty³", 
HOTPLUG_EVENT_APM
);

423 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
d
);

426 ià(!
hªdËr
->
	`compu‹_udi
 (
d
, handler)) {

427 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

428 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

429 
out
;

433 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_INFORMATION
);

434 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_POLICY
);

439 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

440 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

442 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

443 
out
;

448 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

449 
out
:

451 
	}
}

454 
	$hÙ¶ug_ev’t_begš_»move_­m
 (cÚ¡ 
gch¬
 *
­m_·th
, 
­m_ty³
, *
’d_tok’
)

456 
gušt
 
i
;

457 
H®Deviû
 *
d
;

459 
	`HAL_INFO
 (("­m_»m:‡pm_·th=% ­m_ty³=%d", 
­m_·th
, 
­m_ty³
));

461 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "lšux.­m_·th", 
­m_·th
);

462 ià(
d
 =ğ
NULL
) {

463 
	`HAL_WARNING
 (("Couldn'ˆ»movdeviû w™h‡pm…©h % -‚Ù found", 
­m_·th
));

464 
out
;

467 
i
 = 0; 
­m_hªdËrs
 [i] !ğ
NULL
; i++) {

468 
APMDevHªdËr
 *
hªdËr
;

470 
hªdËr
 = 
­m_hªdËrs
[
i
];

471 ià(
hªdËr
->
­m_ty³
 ==‡pm_type) {

472 ià(
hªdËr
->
	`»move
 (
d
, handler)) {

473 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

474 
out2
;

478 
out
:

480 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

481 
out2
:

483 
	}
}

485 
gboŞ—n


486 
	$­m_»sÿn_deviû
 (
H®Deviû
 *
d
)

488 
gušt
 
i
;

489 
gboŞ—n
 
»t
;

490 
­m_ty³
;

492 
»t
 = 
FALSE
;

494 
­m_ty³
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.apm_type");

496 
i
 = 0; 
­m_hªdËrs
 [i] !ğ
NULL
; i++) {

497 
APMDevHªdËr
 *
hªdËr
;

499 
hªdËr
 = 
­m_hªdËrs
[
i
];

500 ià(
hªdËr
->
­m_ty³
 ==‡pm_type) {

501 
»t
 = 
hªdËr
->
	`»äesh
 (
d
, handler);

502 
out
;

506 
	`HAL_WARNING
 (("Didn'ˆfšd‡„esÿÀhªdË¸fÜ ud˜%s", 
	`h®_deviû_g‘_udi
 (
d
)));

508 
out
:

509  
»t
;

510 
	}
}

512 
HÙ¶ugEv’t
 *

513 
	$­m_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
)

515 
­m_ty³
;

516 cÚ¡ *
­m_·th
;

517 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

519 
­m_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.apm_path");

520 
­m_ty³
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.apm_type");

522 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

523 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

524 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_APM
;

525 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
­m
.
­m_·th
,‡pm_path,  (hotplug_event->apm.apm_path));

526 
hÙ¶ug_ev’t
->
­m
.
­m_ty³
 =‡pm_type;

527  
hÙ¶ug_ev’t
;

528 
	}
}

530 
HÙ¶ugEv’t
 *

531 
	$­m_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
)

533 
­m_ty³
;

534 cÚ¡ *
­m_·th
;

535 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

537 
­m_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.apm_path");

538 
­m_ty³
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.apm_type");

540 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

541 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_REMOVE
;

542 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_APM
;

543 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
­m
.
­m_·th
,‡pm_path,  (hotplug_event->apm.apm_path));

544 
hÙ¶ug_ev’t
->
­m
.
­m_ty³
 =‡pm_type;

545  
hÙ¶ug_ev’t
;

546 
	}
}

	@hald/linux/apm.h

23 #iâdeà
APM_H


24 
	#APM_H


	)

26 
	~"../h®d.h
"

27 
	~"hÙ¶ug.h
"

29 #ifdeà
HAVE_APM


30 
gboŞ—n
 
­m_syÁhesize_hÙ¶ug_ev’ts
 ();

31 
hÙ¶ug_ev’t_begš_add_­m
 (cÚ¡ 
gch¬
 *
­m_·th
, 
­m_ty³
, 
H®Deviû
 *
·»Á
, *
’d_tok’
);

32 
hÙ¶ug_ev’t_begš_»move_­m
 (cÚ¡ 
gch¬
 *
­m_·th
, 
­m_ty³
, *
’d_tok’
);

33 
gboŞ—n
 
­m_»sÿn_deviû
 (
H®Deviû
 *
d
);

34 
HÙ¶ugEv’t
 *
­m_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
);

35 
HÙ¶ugEv’t
 *
­m_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
);

37 
šlše
 
gboŞ—n
 
	$­m_syÁhesize_hÙ¶ug_ev’ts
 (è{ 
FALSE
;
	}
}

38 
šlše
 
	$hÙ¶ug_ev’t_begš_add_­m
 (cÚ¡ 
gch¬
 *
­m_·th
, 
­m_ty³
, 
H®Deviû
 *
·»Á
, *
’d_tok’
è{;
	}
}

39 
šlše
 
	$hÙ¶ug_ev’t_begš_»move_­m
 (cÚ¡ 
gch¬
 *
­m_·th
, 
­m_ty³
, *
’d_tok’
è{;
	}
}

40 
šlše
 
gboŞ—n
 
	$­m_»sÿn_deviû
 (
H®Deviû
 *
d
è{ 
FALSE
;
	}
}

41 
šlše
 
HÙ¶ugEv’t
 *
	$­m_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
è{ 
NULL
;
	}
}

42 
šlše
 
HÙ¶ugEv’t
 *
	$­m_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
è{ 
NULL
;
	}
}

	@hald/linux/blockdev.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<ùy³.h
>

30 
	~<lim™s.h
>

31 
	~<lšux/kdev_t.h
>

32 
	~<mÁ’t.h
>

33 
	~<¡dšt.h
>

34 
	~<¡dlib.h
>

35 
	~<dœ’t.h
>

36 
	~<¡ršg.h
>

37 
	~<sys/¡©.h
>

38 
	~<sy¦og.h
>

39 
	~<uni¡d.h
>

40 
	~<”ºo.h
>

42 
	~<dbus/dbus.h
>

43 
	~<dbus/dbus-glib.h
>

45 
	~"../deviû_šfo.h
"

46 
	~"../h®d.h
"

47 
	~"../h®d_dbus.h
"

48 
	~"../h®d_ruÂ”.h
"

49 
	~"../logg”.h
"

50 
	~"../os¥ec.h
"

51 
	~"../ut.h
"

53 
	~"cŞd¶ug.h
"

54 
	~"hÙ¶ug.h
"

55 
	~"hÙ¶ug_h–³r.h
"

56 
	~"os¥ec_lšux.h
"

58 
	~"blockdev.h
"

60 
gch¬
 *

61 
	$¡rdup_v®id_utf8
 (cÚ¡ *
¡r
)

63 *
’dch¬
;

64 *
Ãw¡r
;

65 
fixes
;

67 ià(
¡r
 =ğ
NULL
)

68  
NULL
;

70 
Ãw¡r
 = 
	`g_¡rdup
 (
¡r
);

72 
fixes
 = 0;

73 !
	`g_utf8_v®id©e
 (
Ãw¡r
, -1, (cÚ¡ **è&
’dch¬
)) {

74 *
’dch¬
 = '_';

75 ++
fixes
;

79 ià(
fixes
 > 0 && 
	`g_utf8_¡¾’
 (
Ãw¡r
, -1) / fixes < 5) {

80 
	`g_ä“
 (
Ãw¡r
);

81 
Ãw¡r
 = 
	`g_¡rdup
("");

84  
Ãw¡r
;

85 
	}
}

90 
gboŞ—n


91 
	$blockdev_compu‹_udi
 (
H®Deviû
 *
d
)

93 
gch¬
 
udi
[256];

95 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "block.is_volume")) {

96 cÚ¡ *
Ïb–
;

97 cÚ¡ *
uuid
;

98 *
vŞum–ab–
;

100 
Ïb–
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "volume.label");

102 
vŞum–ab–
 = 
	`g_¡rdup
(
Ïb–
);

103 
vŞum–ab–
 = 
	`g_¡rd–im™
 (volumelabel, "/", '_');

105 
uuid
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "volume.uuid");

107 ià(
uuid
 !ğ
NULL
 && 
	`¡¾’
 (uuid) > 0) {

108 
	`h®d_compu‹_udi
 (
udi
,  (udi),

109 "/Üg/ä“desktİ/H®/deviûs/vŞume_uuid_%s", 
uuid
);

110 } ià(
vŞum–ab–
 !ğ
NULL
 && 
	`¡¾’
 (volumelabel) > 0) {

111 
	`h®d_compu‹_udi
 (
udi
,  (udi),

112 "/Üg/ä“desktİ/H®/deviûs/vŞume_Ïb–_%s", 
vŞum–ab–
);

113 } ià(
	`h®_deviû_´İ”ty_g‘_boŞ
(
d
, "volume.is_disc") &&

114 
	`h®_deviû_´İ”ty_g‘_boŞ
(
d
, "volume.disc.is_blank")) {

116 
	`h®d_compu‹_udi
 (
udi
,  (udi),

118 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "volume.disc.type"));

121 
	`h®d_compu‹_udi
 (
udi
,  (udi),

123 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "volume.partition.number"),

124 
	`h®_deviû_´İ”ty_g‘_ušt64
 (
d
, "volume.size"));

126 
	`g_ä“
(
vŞum–ab–
);

128 cÚ¡ *
mod–
;

129 cÚ¡ *
£rŸl
;

130 cÚ¡ *
bus
;

131 cÚ¡ *
ty³
;

133 
mod–
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.model");

134 
£rŸl
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.serial");

135 
bus
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.bus");

136 
ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.drive_type");

138 ià(
£rŸl
 !ğ
NULL
) {

139 
	`h®d_compu‹_udi
 (
udi
,  (udi),

141 
£rŸl
);

142 } ià((
mod–
 !ğ
NULL
è&& (
	`¡¾’
(model) != 0) ) {

143 
	`h®d_compu‹_udi
 (
udi
,  (udi),

145 
mod–
);

146 } ià((
bus
 !ğ
NULL
è&& (
ty³
 != NULL)){

147 
	`h®d_compu‹_udi
 (
udi
,  (udi),

149 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.originating_device"),

150 
bus
, 
ty³
);

152 
	`h®d_compu‹_udi
 (
udi
,  (udi),

154 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.originating_device"));

158 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

160  
TRUE
;

161 
	}
}

165 
	$blockdev_ÿÎouts_add_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

167 *
’d_tok’
 = (*è
u£rd©a1
;

169 
	`HAL_INFO
 (("Add c®lout com¶‘ed udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

172 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

173 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

175 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

176 
	}
}

179 
	$blockdev_ÿÎouts_»move_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

181 *
’d_tok’
 = (*è
u£rd©a1
;

183 
	`HAL_INFO
 (("RemovÿÎout com¶‘ed udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

185 ià(!
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_gdl
 (), 
d
)) {

186 
	`HAL_WARNING
 (("Error„emoving device"));

188 
	`g_objeù_uÄef
 (
d
);

190 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

191 
	}
}

194 
	$ş—nup_mouÁpošt_cb
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
,

195 
gšt
 
»tuº_code
, 
gch¬
 **
”rÜ
,

196 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

198 *
mouÁ_pošt
 = (*è
d©a1
;

199 
	`HAL_INFO
 (("IÀş—nup_mouÁpošt_cb fÜ '%s'", 
mouÁ_pošt
));

200 
	`g_ä“
 (
mouÁ_pošt
);

201 
	}
}

204 
	$blockdev_»äesh_mouÁ_¡©e
 (
H®Deviû
 *
d
)

206 
FILE
 *
f
;

207 
mÁ’t
 
mÁ
;

208 
buf
[1024];

209 
GSLi¡
 *
vŞumes
 = 
NULL
;

210 
GSLi¡
 *
vŞume
;

213 
	`g_¢´štf
 (
buf
,  (buf), "%s/mounts", "/proc");

214 ià((
f
 = 
	`£tmÁ’t
 (
buf
, "r")è=ğ
NULL
) {

215 
	`HAL_ERROR
 (("Could‚ot open /proc/mounts"));

219 ià(
d
)

220 
vŞumes
 = 
	`g_¦i¡_­³nd
 (
NULL
, 
d
);

222 
vŞumes
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "info.category", "volume");

224 ià(!
vŞumes
)

225 
ex™
;

228 
	`g‘mÁ’t_r
 (
f
, &
mÁ
, 
buf
, (buf)è!ğ
NULL
) {

229 
¡©
 
¡©buf
;

230 
dev_t
 
devt
;

237 ià(
	`¡rcmp
(
mÁ
.
mÁ_ty³
, "nfs") == 0)

241 ià(
mÁ
.
mÁ_f¢ame
[0] != '/')

249 
devt
 = 
	`makedev
(0, 0);

250 ià(
	`¡©
 (
mÁ
.
mÁ_f¢ame
, &
¡©buf
) == 0) {

252 ià(
	`majÜ
 (
¡©buf
.
¡_rdev
) == 0)

256 
devt
 = 
¡©buf
.
¡_rdev
;

263 ià(
	`¡rcmp
 (
mÁ
.
mÁ_dœ
, "/"è=ğ0 && 
	`¡©
 ("/", &
¡©buf
) == 0)

264 
devt
 = 
¡©buf
.
¡_dev
;

277 
vŞume
 = 
vŞumes
; vŞum!ğ
NULL
; vŞumğ
	`g_¦i¡_Ãxt
 (volume)) {

278 
H®Deviû
 *
dev
;

279 
gboŞ—n
 
is_m©ch
;

281 
is_m©ch
 = 
FALSE
;

282 
dev
 = 
	`HAL_DEVICE
 (
vŞume
->
d©a
);

285 ià(
	`majÜ
 (
devt
) == 0) {

286 cÚ¡ *
deviû_Çme
;

288 
deviû_Çme
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
dev
, "block.device");

289 ià(
deviû_Çme
 =ğ
NULL
)

292 ià(
	`¡rcmp
 (
deviû_Çme
, 
mÁ
.
mÁ_f¢ame
) == 0)

293 
is_m©ch
 = 
TRUE
;

295 
majÜnum
;

296 
mšÜnum
;

298 
majÜnum
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
dev
, "block.major");

299 ià(
majÜnum
 == 0)

301 
mšÜnum
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
dev
, "block.minor");

304 ià(
majÜnum
 =ğ
	`majÜ
 (
devt
è&& 
mšÜnum
 =ğ
	`mšÜ
 (devt))

305 
is_m©ch
 = 
TRUE
;

308 ià(
is_m©ch
) {

310 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

311 
	`h®_deviû_´İ”ty_£t_boŞ
 (
dev
, "vŞume.is_mouÁed", 
TRUE
);

312 
	`h®_deviû_´İ”ty_£t_boŞ
 (
dev
, "volume.is_mounted_read_only",

313 
	`hasmÁİt
 (&
mÁ
, 
MNTOPT_RO
è? 
TRUE
 : 
FALSE
);

314 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
dev
, "vŞume.mouÁ_pošt", 
mÁ
.
mÁ_dœ
);

315 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

318 
vŞumes
 = 
	`g_¦i¡_d–‘e_lšk
 (vŞumes, 
vŞume
);

325 
vŞume
 = 
vŞumes
; vŞum!ğ
NULL
; vŞumğ
	`g_¦i¡_Ãxt
 (volume)) {

326 
H®Deviû
 *
dev
;

328 
dev
 = 
	`HAL_DEVICE
 (
vŞume
->
d©a
);

335 ià(
	`deviû_is_executšg_m‘hod
 (
dev
, "org.freedesktop.Hal.Device.Volume", "Unmount")) {

336 
	`HAL_INFO
 (("/´oc/mouÁ ‹Î th© % i unmouÁed - wa™šg fÜ UnmouÁ(ètØcom¶‘tØchªgmouÁ s‹", 
	`h®_deviû_g‘_udi
 (
dev
)));

338 *
mouÁ_pošt
;

340 
mouÁ_pošt
 = 
	`g_¡rdup
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
dev
, "volume.mount_point"));

341 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

342 
	`h®_deviû_´İ”ty_£t_boŞ
 (
dev
, "vŞume.is_mouÁed", 
FALSE
);

343 
	`h®_deviû_´İ”ty_£t_boŞ
 (
dev
, "vŞume.is_mouÁed_»ad_Úly", 
FALSE
);

344 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
dev
, "volume.mount_point", "");

345 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

348 ià(
mouÁ_pošt
 !ğ
NULL
 && 
	`¡¾’
 (mount_point) > 0 &&

349 
	`h®_ut_is_mouÁed_by_h®d
 (
mouÁ_pošt
)) {

350 *
ş—nup_¡dš
;

351 *
exŒa_’v
[2];

353 
	`HAL_INFO
 (("CËªšg u°dœeùÜy '%s' sšû iˆwa ü—‹d by HAL' MouÁ()", 
mouÁ_pošt
));

355 
exŒa_’v
[0] = 
	`g_¡rdup_´štf
 ("HALD_CLEANUP=%s", 
mouÁ_pošt
);

356 
exŒa_’v
[1] = 
NULL
;

357 
ş—nup_¡dš
 = "\n";

359 
	`h®d_ruÂ”_run_m‘hod
 (
dev
,

361 
exŒa_’v
,

362 
ş—nup_¡dš
, 
TRUE
,

364 
ş—nup_mouÁpošt_cb
,

365 
	`g_¡rdup
 (
mouÁ_pošt
), 
NULL
);

368 
	`g_ä“
 (
mouÁ_pošt
);

372 
	`g_¦i¡_ä“
 (
vŞumes
);

373 
ex™
:

374 
	`’dmÁ’t
 (
f
);

375 
	}
}

378 
	$g’”©e_çkevŞume_hÙ¶ug_ev’t_add_fÜ_¡Üage_deviû
 (
H®Deviû
 *
d
)

380 cÚ¡ *
sysfs_·th
;

381 cÚ¡ *
deviû_fe
;

382 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

383 
çke_sysfs_·th
[
HAL_PATH_MAX
];

385 
sysfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.sysfs_path");

386 
deviû_fe
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "block.device");

388 
	`¢´štf
 (
çke_sysfs_·th
, (çke_sysfs_·th), "%s/çkevŞume", 
sysfs_·th
);

390 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

391 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

392 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS_BLOCK
;

393 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, "block",  (hotplug_event->sysfs.subsystem));

394 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, 
çke_sysfs_·th
,  (hotplug_event->sysfs.sysfs_path));

395 ià(
deviû_fe
 !ğ
NULL
)

396 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, device_file,  (hotplug_event->sysfs.device_file));

398 
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
[0] = '\0';

399 
hÙ¶ug_ev’t
->
sysfs
.
Ãt_ifšdex
 = -1;

401 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

402 
	}
}

405 
	$add_blockdev_´obšg_h–³r_dÚe
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
,

406 
gšt
 
»tuº_code
, **
”rÜ
,

407 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

409 *
’d_tok’
 = (*è
d©a1
;

410 
gboŞ—n
 
is_vŞume
;

414 
	`HAL_INFO
 (("’‹ršg;ƒx™_ty³=%d,„‘uº_code=%d", 
ex™_ty³
, 
»tuº_code
));

416 ià(
d
 =ğ
NULL
) {

417 
	`HAL_INFO
 (("Device object‡lready„emoved"));

418 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

419 
out
;

422 
is_vŞume
 = 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "block.is_volume");

428 ià(
ex™_ty³
 !ğ
HALD_RUN_SUCCESS


429 || !(
»tuº_code
 =ğ0 || (!
is_vŞume
 &&„eturn_code == 2))) {

430 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

431 
	`g_objeù_uÄef
 (
d
);

432 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

433 
out
;

436 ià(!
	`blockdev_compu‹_udi
 (
d
)) {

437 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

438 
	`g_objeù_uÄef
 (
d
);

439 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

440 
out
;

444 ià(!
is_vŞume
) {

445 
	`h®_deviû_cİy_´İ”ty
 (
d
, "info.udi", d, "block.storage_device");

448 
	`blockdev_»äesh_mouÁ_¡©e
 (
d
);

452 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_INFORMATION
);

453 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_POLICY
);

458 
	`h®_ut_ÿÎout_deviû_add
 (
d
, 
blockdev_ÿÎouts_add_dÚe
, 
’d_tok’
, 
NULL
);

464 ià(!
is_vŞume
 && 
»tuº_code
 == 2) {

465 
	`g’”©e_çkevŞume_hÙ¶ug_ev’t_add_fÜ_¡Üage_deviû
 (
d
);

469 
out
:

471 
	}
}

474 
	$blockdev_ÿÎouts_´•robšg_¡Üage_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

476 *
’d_tok’
 = (*è
u£rd©a1
;

478 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "info.ignore")) {

482 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.category");

483 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.capabilities");

484 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.udi", "/org/freedesktop/Hal/devices/ignored-device");

485 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Ignored Device");

487 
	`HAL_INFO
 (("Preprobing merged info.ignore==TRUE"));

490 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

491 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

493 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

494 
out
;

497 ià(!
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "storage.media_check_enabled") &&

498 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "storage.no_partitions_hint")) {

501 ià(
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.bus"), "platform") == 0 &&

502 
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.drive_type"), "floppy") == 0) {

503 
	`HAL_INFO
 (("Probing PC floppy %so see if it is…resent",

504 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "block.device")));

506 
	`h®d_ruÂ”_run
(
d
,

507 "h®d-´obe-pc-æİpy", 
NULL
,

508 
HAL_HELPER_TIMEOUT
,

509 
add_blockdev_´obšg_h–³r_dÚe
,

510 (
gpoš‹r
è
’d_tok’
, 
NULL
);

511 
out
;

513 *
syÃ¼Ü
[1] = {
NULL
};

515 
	`HAL_INFO
 (("Not…robing storage device %s",

516 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "block.device")));

518 
	`add_blockdev_´obšg_h–³r_dÚe
 (
d
, 
FALSE
, 0, 
syÃ¼Ü
, (
gpoš‹r
è
’d_tok’
, 
NULL
);

519 
out
;

529 
	`HAL_INFO
 (("Probšg stÜagdeviû %s", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "block.device")));

532 
	`h®d_ruÂ”_run
(
d
,

533 "h®d-´obe-¡Üage", 
NULL
,

534 
HAL_HELPER_TIMEOUT
,

535 
add_blockdev_´obšg_h–³r_dÚe
,

536 (
gpoš‹r
è
’d_tok’
, 
NULL
);

538 
out
:

540 
	}
}

543 
	$blockdev_ÿÎouts_´•robšg_vŞume_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

545 *
’d_tok’
 = (*è
u£rd©a1
;

547 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "info.ignore")) {

551 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.category");

552 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.capabilities");

553 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.udi", "/org/freedesktop/Hal/devices/ignored-device");

554 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Ignored Device");

556 
	`HAL_INFO
 (("Preprobing merged info.ignore==TRUE"));

559 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

560 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

562 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

563 
out
;

567 
	`h®d_ruÂ”_run
 (
d
,

568 "h®d-´obe-vŞume", 
NULL
,

569 
HAL_HELPER_TIMEOUT
,

570 
add_blockdev_´obšg_h–³r_dÚe
,

571 (
gpoš‹r
è
’d_tok’
, 
NULL
);

572 
out
:

574 
	}
}

580 
	$ÿnÚiÿlize_f’ame
 (
gch¬
 *
f’ame
)

582 
gch¬
 *
p
, *
q
;

583 
gboŞ—n
 
Ï¡_was_¦ash
 = 
FALSE
;

585 
p
 = 
f’ame
;

586 
q
 = 
f’ame
;

588 *
p
)

590 ià(*
p
 =ğ
G_DIR_SEPARATOR
)

592 ià(!
Ï¡_was_¦ash
)

593 *
q
++ = 
G_DIR_SEPARATOR
;

595 
Ï¡_was_¦ash
 = 
TRUE
;

599 ià(
Ï¡_was_¦ash
 && *
p
 == '.')

601 ià(*(
p
 + 1è=ğ
G_DIR_SEPARATOR
 ||

602 *(
p
 + 1) == '\0')

604 ià(*(
p
 + 1) == '\0')

607 
p
 += 1;

609 ià(*(
p
 + 1) == '.' &&

610 (*(
p
 + 2è=ğ
G_DIR_SEPARATOR
 ||

611 *(
p
 + 2) == '\0'))

613 ià(
q
 > 
f’ame
 + 1)

615 
q
--;

616 
q
 > 
f’ame
 + 1 &&

617 *(
q
 - 1è!ğ
G_DIR_SEPARATOR
)

618 
q
--;

621 ià(*(
p
 + 2) == '\0')

624 
p
 += 2;

628 *
q
++ = *
p
;

629 
Ï¡_was_¦ash
 = 
FALSE
;

634 *
q
++ = *
p
;

635 
Ï¡_was_¦ash
 = 
FALSE
;

639 
p
++;

642 ià(
q
 > 
f’ame
 + 1 && *(q - 1è=ğ
G_DIR_SEPARATOR
)

643 
q
--;

645 *
q
 = '\0';

646 
	}
}

649 
	$»sŞve_symlšk
 (cÚ¡ *
fe
)

651 *
dœ
;

652 
gch¬
 
lšk
[
HAL_PATH_MAX
];

653 *
f
;

654 *
f1
;

656 
f
 = 
	`g_¡rdup
 (
fe
);

657 
	`mem£t
(
lšk
, 0, 
HAL_PATH_MAX
);

658 
	`g_fe_‹¡
 (
f
, 
G_FILE_TEST_IS_SYMLINK
)) {

659 if(
	`»adlšk
(
f
, 
lšk
, 
HAL_PATH_MAX
 - 1) < 0) {

660 
	`g_w¬nšg
 ("CªnÙ„esŞvsymlšk %s: %s", 
f
, 
	`¡»¼Ü
(
”ºo
));

661 
	`g_ä“
 (
f
);

662 
f
 = 
NULL
;

663 
out
;

666 
dœ
 = 
	`g_·th_g‘_dœÇme
 (
f
);

667 
f1
 = 
	`g_¡rdup_´štf
 ("%s/%s", 
dœ
, 
lšk
);

668 
	`g_ä“
 (
dœ
);

669 
	`g_ä“
 (
f
);

670 
f
 = 
f1
;

673 
out
:

674 ià(
f
 !ğ
NULL
)

675 
	`ÿnÚiÿlize_f’ame
 (
f
);

676  
f
;

677 
	}
}

679 
gboŞ—n


680 
»äesh_md_¡©e
 (
H®Deviû
 *
d
);

682 
gboŞ—n


683 
	$md_check_sync_timeout
 (
gpoš‹r
 
u£r_d©a
)

685 
H®Deviû
 *
d
;

686 *
sysfs_·th
 = (*è
u£r_d©a
;

688 
	`HAL_INFO
 (("IÀmd_check_sync_timeouˆfÜ sysf ·th %s", 
sysfs_·th
));

690 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

692 
sysfs_·th
);

693 ià(
d
 =ğ
NULL
)

694 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_tdl
 (),

696 
sysfs_·th
);

697 ià(
d
 =ğ
NULL
) {

698 
	`HAL_WARNING
 (("CªnÙ fšd md deviû w™h sysf ·th '%s'", 
sysfs_·th
));

699 
out
;

702 
	`»äesh_md_¡©e
 (
d
);

704 
out
:

705 
	`g_ä“
 (
sysfs_·th
);

706  
FALSE
;

707 
	}
}

709 
gboŞ—n


710 
	$»äesh_md_¡©e
 (
H®Deviû
 *
d
)

712 
n
;

713 *
sync_aùiÚ
;

714 
num_compÚ’ts
;

715 
gboŞ—n
 
»t
;

716 cÚ¡ *
sysfs_·th
;

717 cÚ¡ *
Ëv–
;

719 
»t
 = 
FALSE
;

721 
sysfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.linux_raid.sysfs_path");

722 ià(
sysfs_·th
 =ğ
NULL
) {

723 
	`HAL_WARNING
 (("CªnÙ g‘ sysfs_·th fÜ ud˜%s", 
	`h®_deviû_g‘_udi
 (
d
)));

724 
”rÜ
;

727 
	`HAL_INFO
 (("IÀ»äesh_md_¡©e(èfÜ '%s'", 
sysfs_·th
));

728 
Ëv–
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.linux_raid.level");

729 
	`HAL_INFO
 ((" MD Lev– i '%s'", 
Ëv–
));

732 ià(
	`¡rcmp
 (
Ëv–
, "linear") != 0) {

733 
sync_aùiÚ
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "md/sync_action");

734 ià(
sync_aùiÚ
 =ğ
NULL
) {

735 
	`HAL_WARNING
 (("CªnÙ g‘ sync_aùiÚ fÜ %s", 
sysfs_·th
));

736 
”rÜ
;

738 ià(
	`¡rcmp
 (
sync_aùiÚ
, "idle") == 0) {

739 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.lšux_¿id.is_syncšg", 
FALSE
);

740 
	`h®_deviû_´İ”ty_»move
 (
d
, "storage.linux_raid.sync.action");

741 
	`h®_deviû_´İ”ty_»move
 (
d
, "storage.linux_raid.sync.speed");

742 
	`h®_deviû_´İ”ty_»move
 (
d
, "storage.linux_raid.sync.progress");

744 
¥“d
;

745 *
¡r_com¶‘ed
;

747 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.lšux_¿id.is_syncšg", 
TRUE
);

749 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.lšux_¿id.sync.aùiÚ", 
sync_aùiÚ
);

751 ià(!
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "md/sync_¥“d", &
¥“d
, 10)) {

752 
	`HAL_WARNING
 (("CªnÙ g‘ sync_¥“d fÜ %s", 
sysfs_·th
));

754 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "¡Üage.lšux_¿id.sync.¥“d", 
¥“d
);

757 ià((
¡r_com¶‘ed
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "md/sync_com¶‘ed")è=ğ
NULL
) {

758 
	`HAL_WARNING
 (("CªnÙ g‘ sync_com¶‘ed fÜ %s", 
sysfs_·th
));

760 
sync_pos
, 
sync_tÙ®
;

762 ià(
	`ssÿnf
 (
¡r_com¶‘ed
, "%Îd / %Îd", &
sync_pos
, &
sync_tÙ®
) != 2) {

763 
	`HAL_WARNING
 (("M®fÜmed sync_com¶‘ed '%s'", 
¡r_com¶‘ed
));

765 
sync_´og»ss
;

766 
sync_´og»ss
 = ((è
sync_pos
è/ ((è
sync_tÙ®
);

767 
	`h®_deviû_´İ”ty_£t_doubË
 (
d
, "¡Üage.lšux_¿id.sync.´og»ss", 
sync_´og»ss
);

772 #ifdeà
HAVE_GLIB_2_14


773 
	`g_timeout_add_£cÚds
 (2, 
md_check_sync_timeout
, 
	`g_¡rdup
 (
sysfs_·th
));

775 
	`g_timeout_add
 (2000, 
md_check_sync_timeout
, 
	`g_¡rdup
 (
sysfs_·th
));

779 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.lšux_¿id.is_syncšg", 
FALSE
);

781 ià(!
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "md/¿id_disks", &
num_compÚ’ts
, 0)) {

782 
	`HAL_WARNING
 (("Cannot get‚umber of RAID components"));

783 
”rÜ
;

785 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "¡Üage.lšux_¿id.num_compÚ’ts", 
num_compÚ’ts
);

788 
n
 = 0;‚ < 
num_compÚ’ts
;‚++) {

789 *
s
;

790 *
lšk
;

791 *
rg‘
;

792 
H®Deviû
 *
¦ave_vŞume
;

793 cÚ¡ *
¦ave_vŞume_¡Üdev_udi
;

794 
H®Deviû
 *
¦ave_vŞume_¡Üdev
;

796 
s
 = 
	`g_¡rdup_´štf
 ("%s/md/rd%d", 
sysfs_·th
, 
n
);

797 ià(!
	`g_fe_‹¡
 (
s
, 
G_FILE_TEST_IS_SYMLINK
)) {

798 
	`g_ä“
 (
s
);

801 
	`g_ä“
 (
s
);

803 
lšk
 = 
	`g_¡rdup_´štf
 ("%s/md/rd%d/block", 
sysfs_·th
, 
n
);

804 
rg‘
 = 
	`»sŞve_symlšk
 (
lšk
);

805 ià(
rg‘
 =ğ
NULL
) {

806 
	`HAL_WARNING
 (("CªnÙ„esŞv%s", 
lšk
));

807 
	`g_ä“
 (
lšk
);

808 
”rÜ
;

810 
	`HAL_INFO
 (("lšk->rg‘: '%s' -> '%s'", 
lšk
, 
rg‘
));

812 
¦ave_vŞume
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "lšux.sysfs_·th", 
rg‘
);

813 ià(
¦ave_vŞume
 =ğ
NULL
) {

814 
	`HAL_WARNING
 (("NØvŞumfÜ sysf ·th %s", 
rg‘
));

815 
	`g_ä“
 (
rg‘
);

816 
	`g_ä“
 (
lšk
);

817 
”rÜ
;

821 
¦ave_vŞume_¡Üdev_udi
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
¦ave_vŞume
, "block.storage_device");

822 ià(
¦ave_vŞume_¡Üdev_udi
 =ğ
NULL
) {

823 
	`HAL_WARNING
 (("No storage device for slave"));

824 
	`g_ä“
 (
rg‘
);

825 
	`g_ä“
 (
lšk
);

826 
”rÜ
;

828 
¦ave_vŞume_¡Üdev
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
¦ave_vŞume_¡Üdev_udi
);

829 ià(
¦ave_vŞume_¡Üdev
 =ğ
NULL
) {

830 
	`HAL_WARNING
 (("No storage device for slave"));

831 
	`g_ä“
 (
rg‘
);

832 
	`g_ä“
 (
lšk
);

833 
”rÜ
;

837 
	`h®_deviû_´İ”ty_¡¾i¡_add
 (
d
, "¡Üage.lšux_¿id.compÚ’ts", 
	`h®_deviû_g‘_udi
 (
¦ave_vŞume
));

849 ià(
n
 == 0) {

850 cÚ¡ *
uuid
;

852 
	`h®_deviû_´İ”ty_£t_boŞ
 (

853 
d
, "storage.hotpluggable",

854 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
¦ave_vŞume_¡Üdev
, "storage.hotpluggable"));

857 
uuid
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (

858 
¦ave_vŞume
, "volume.uuid");

859 ià(
uuid
 !ğ
NULL
) {

860 
	`h®_deviû_´İ”ty_£t_¡ršg
 (

861 
d
, "¡Üage.£rŸl", 
uuid
);

865 
	`g_ä“
 (
rg‘
);

866 
	`g_ä“
 (
lšk
);

870 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "¡Üage.lšux_¿id.num_compÚ’ts_aùive", 
n
);

874 
»t
 = 
TRUE
;

876 
”rÜ
:

877  
»t
;

878 
	}
}

882 
	$hÙ¶ug_ev’t_begš_add_blockdev
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
gboŞ—n
 
is_·¹™iÚ
,

883 
H®Deviû
 *
·»Á
, *
’d_tok’
)

885 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
 = (HÙ¶ugEv’ˆ*è
’d_tok’
;

886 
gch¬
 *
majÜ_mšÜ
;

887 
H®Deviû
 *
d
;

888 
majÜ
, 
mšÜ
;

889 
gboŞ—n
 
is_çkevŞume
;

890 *
sysfs_·th_»®
 = 
NULL
;

891 
æİpy_num
;

892 
gboŞ—n
 
is_deviû_m­³r
;

893 
gboŞ—n
 
is_md_deviû
;

894 
gboŞ—n
 
is_cciss_deviû
;

895 
md_numb”
;

897 
is_deviû_m­³r
 = 
FALSE
;

898 
is_çkevŞume
 = 
FALSE
;

899 
is_md_deviû
 = 
FALSE
;

900 
is_cciss_deviû
 = 
FALSE
;

902 
	`HAL_INFO
 (("block_add: sysfs_path=%s dev=%s is_part=%d,…arent=0x%08x",

903 
sysfs_·th
, 
deviû_fe
, 
is_·¹™iÚ
, 
·»Á
));

905 ià(
·»Á
 !ğ
NULL
 && 
	`h®_deviû_´İ”ty_g‘_boŞ
 (parent, "info.ignore")) {

906 
	`HAL_INFO
 (("Ignoring block_add since…arent has info.ignore==TRUE"));

907 
out
;

910 ià(
	`¡rcmp
 (
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
), "fakevolume") == 0) {

911 
	`HAL_INFO
 (("Hªdlšg % a çkevŞum- sysfs_·th_»®=%s", 
deviû_fe
, 
sysfs_·th_»®
));

912 
is_çkevŞume
 = 
TRUE
;

913 
sysfs_·th_»®
 = 
	`h®_ut_g‘_·»Á_·th
 (
sysfs_·th
);

914 } ià(
	`ssÿnf
 (
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
), "md%d", &
md_numb”
) == 1) {

915 
	`HAL_INFO
 (("Hªdlšg % a MD deviû", 
deviû_fe
));

916 
is_md_deviû
 = 
TRUE
;

917 
sysfs_·th_»®
 = 
	`g_¡rdup
 (
sysfs_·th
);

919 
·»Á
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/org/freedesktop/Hal/devices/computer");

920 ià(
·»Á
 =ğ
NULL
)

921 
·»Á
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/org/freedesktop/Hal/devices/computer");

923 
sysfs_·th_»®
 = 
	`g_¡rdup
 (
sysfs_·th
);

929 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "lšux.sysfs_·th", 
sysfs_·th
);

930 ià(
d
 !ğ
NULL
) {

931 
	`HAL_INFO
 (("Ignoring hotplugƒvent - device is‡lready‡dded"));

932 
out
;

935 
d
 = 
	`h®_deviû_Ãw
 ();

938 ià(
·»Á
 =ğ
NULL
 && !
is_·¹™iÚ
 && !
is_çkevŞume
 && !
hÙ¶ug_ev’t
->
»po¡ed
) {

939 
·th
[
HAL_PATH_MAX
];

940 
	`g_¢´štf
 (
·th
, 
HAL_PATH_MAX
, "%s/¦aves", 
sysfs_·th
);

942 ià(
deviû_fe
 && (
	`¡r¡r
(deviû_fe, "/dev/cciss/"è!ğ
NULL
)) {

944 ià(
	`g_fe_‹¡
 (
·th
, (
G_FILE_TEST_EXISTS
 | 
G_FILE_TEST_IS_DIR
))) {

945 
	`HAL_DEBUG
(("block_add: found cciss‡ base device"));

947 
is_cciss_deviû
 = 
TRUE
;

948 
·»Á
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/org/freedesktop/Hal/devices/computer");

949 ià(
·»Á
 =ğ
NULL
)

950 
·»Á
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/org/freedesktop/Hal/devices/computer");

954 
DIR
 * 
dœ
;

955 
dœ’t
 *
dp
;

957 
	`HAL_INFO
 (("Lookšg iÀ% fÜ Deviû M­³r", 
·th
));

959 ià((
dœ
 = 
	`İ’dœ
 (
·th
)è=ğ
NULL
) {

960 
	`HAL_WARNING
 (("UÇbËØİ’ %s: %s", 
·th
, 
	`¡»¼Ü
(
”ºo
)));

962 ((
dp
 = 
	`»addœ
 (
dœ
)è!ğ
NULL
è&& (
·»Á
 == NULL)) {

963 *
lšk
;

964 *
rg‘
;

966 
lšk
 = 
	`g_¡rdup_´štf
 ("%s/%s", 
·th
, 
dp
->
d_Çme
);

967 
rg‘
 = 
	`»sŞve_symlšk
 (
lšk
);

968 
	`HAL_INFO
 ((" % -> %s", 
lšk
, 
rg‘
));

969 
	`g_ä“
 (
lšk
);

971 ià(
rg‘
 !ğ
NULL
) {

972 
H®Deviû
 *
¦ave_vŞume
;

974 
¦ave_vŞume
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

976 
rg‘
);

977 ià(
¦ave_vŞume
 !ğ
NULL
) {

978 cÚ¡ *
¦ave_vŞume_¡Üdev_udi
;

979 cÚ¡ *
¦ave_vŞume_f¡y³
;

981 
¦ave_vŞume_¡Üdev_udi
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
¦ave_vŞume
, "block.storage_device");

982 
¦ave_vŞume_f¡y³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
¦ave_vŞume
, "volume.fstype");

989 ià(
¦ave_vŞume_¡Üdev_udi
 !ğ
NULL
 &&

990 
¦ave_vŞume_f¡y³
 !ğ
NULL
 &&

991 (
	`¡rcmp
 (
¦ave_vŞume_f¡y³
, "crypto_LUKS") == 0)) {

992 
	`HAL_INFO
 ((" sÏve_vŞume_¡Üdev_udi='%s'!", 
¦ave_vŞume_¡Üdev_udi
));

993 
·»Á
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
¦ave_vŞume_¡Üdev_udi
);

994 ià(
·»Á
 !ğ
NULL
) {

995 
	`HAL_INFO
 (("…¬’t='%s'!", 
	`h®_deviû_g‘_udi
 (
·»Á
)));

996 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.crypto_luks.clear.backing_volume",

997 
	`h®_deviû_g‘_udi
 (
¦ave_vŞume
));

998 
is_deviû_m­³r
 = 
TRUE
;

1002 
	`HAL_INFO
(("Couldn't find slave volume in devices"));

1005 
	`g_ä“
 (
rg‘
);

1007 
	`şo£dœ
(
dœ
);

1008 
	`HAL_INFO
 (("DÚlookšg iÀ%s", 
·th
));

1014 ià(
·»Á
 =ğ
NULL
) {

1015 
	`HAL_INFO
 (("Ignoring hotplugƒvent -‚o…arent"));

1016 
”rÜ
;

1019 ià(!
is_çkevŞume
 && 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
·»Á
, "storage.no_partitions_hint")) {

1020 
	`HAL_INFO
 (("Ignoring blockdev since‚ot‡ fakevolume‡nd…arent has "

1022 
”rÜ
;

1025 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

1026 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á
));

1027 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "lšux.hÙ¶ug_ty³", 
HOTPLUG_EVENT_SYSFS_BLOCK
);

1029 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "block.deviû", 
deviû_fe
);

1030 ià((
majÜ_mšÜ
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th_»®
, "dev")è=ğ
NULL
 ||

1031 
	`ssÿnf
 (
majÜ_mšÜ
, "%d:%d", &
majÜ
, &
mšÜ
) != 2) {

1032 
	`HAL_INFO
 (("Ignoring hotplugƒvent - cannot„ead major:minor"));

1033 
”rÜ
;

1036 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "block.majÜ", 
majÜ
);

1037 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "block.mšÜ", 
mšÜ
);

1038 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "block.is_vŞume", 
is_·¹™iÚ
 || 
is_deviû_m­³r
 || 
is_çkevŞume
);

1040 ià(
	`h®_deviû_has_´İ”ty
(
·»Á
, "info.subsystem") &&

1041 (
	`¡rcmp
(
	`h®_deviû_´İ”ty_g‘_¡ršg
(
·»Á
, "info.subsystem"), "platform") == 0) &&

1042 (
	`ssÿnf
(
	`h®_deviû_´İ”ty_g‘_¡ršg
(
·»Á
, "¶©fÜm.id"), "æİpy.%d", &
æİpy_num
) == 1)) {

1045 
	`HAL_INFO
 (("došg flİpy drivhack fÜ flİpy %d", 
æİpy_num
));

1047 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "platform");

1048 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.no_·¹™iÚs_hšt", 
TRUE
);

1049 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.medŸ_check_’abËd", 
FALSE
);

1050 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.automouÁ_’abËd_hšt", 
TRUE
);

1051 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.model", "");

1052 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.vendor", "PC Floppy Drive");

1053 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.vendor", "");

1054 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "PC Floppy Drive");

1055 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.drive_type", "floppy");

1056 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á
));

1057 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»movabË", 
TRUE
);

1058 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»movabË.medŸ_avaabË", 
FALSE
);

1059 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.hÙ¶uggabË", 
FALSE
);

1060 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»quœes_ejeù", 
FALSE
);

1061 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "storage.size", 0);

1063 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "storage");

1064 
	`h®_deviû_add_ÿ·b™y
 (
d
, "storage");

1065 
	`h®_deviû_add_ÿ·b™y
 (
d
, "block");

1068 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
d
);

1071 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_PREPROBE
);

1074 
	`h®_ut_ÿÎout_deviû_´•robe
 (
d
, 
blockdev_ÿÎouts_´•robšg_¡Üage_dÚe
, 
’d_tok’
, 
NULL
);

1075 
out2
;

1078 ià(!
is_·¹™iÚ
 && !
is_deviû_m­³r
 && !
is_çkevŞume
) {

1079 cÚ¡ *
udi_™
;

1080 cÚ¡ *
physdev_udi
;

1081 
H®Deviû
 *
scsidev
;

1082 
H®Deviû
 *
physdev
;

1083 
gboŞ—n
 
is_hÙ¶uggabË
;

1084 
gboŞ—n
 
is_»movabË
;

1085 
gboŞ—n
 
»quœes_ejeù
;

1086 
gboŞ—n
 
no_·¹™iÚs_hšt
;

1087 cÚ¡ 
gch¬
 *
bus
;

1088 cÚ¡ 
gch¬
 *
·»Á_bus
;

1094 
scsidev
 = 
NULL
;

1095 
physdev
 = 
NULL
;

1096 
physdev_udi
 = 
NULL
;

1098 
is_»movabË
 = 
FALSE
;

1099 
is_hÙ¶uggabË
 = 
FALSE
;

1100 
»quœes_ejeù
 = 
FALSE
;

1101 
no_·¹™iÚs_hšt
 = 
FALSE
;

1104 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "unknown");

1105 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.no_·¹™iÚs_hšt", 
TRUE
);

1106 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.medŸ_check_’abËd", 
TRUE
);

1107 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.automouÁ_’abËd_hšt", 
TRUE
);

1108 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.drive_type", "disk");

1111 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.mod–", 
hÙ¶ug_ev’t
->
sysfs
.
mod–
);

1112 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.v’dÜ", 
hÙ¶ug_ev’t
->
sysfs
.
v’dÜ
);

1113 ià(
hÙ¶ug_ev’t
->
sysfs
.
£rŸl
[0] != '\0')

1114 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.£rŸl", 
hÙ¶ug_ev’t
->
sysfs
.
£rŸl
);

1115 ià(
hÙ¶ug_ev’t
->
sysfs
.
»visiÚ
[0] != '\0')

1116 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.fœmw¬e_v”siÚ", 
hÙ¶ug_ev’t
->
sysfs
.
»visiÚ
);

1121 
udi_™
 = 
	`h®_deviû_g‘_udi
 (
·»Á
);

1122 
udi_™
 !ğ
NULL
) {

1123 
H®Deviû
 *
d_™
;

1132 
d_™
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
udi_™
);

1133 ià(
d_™
 =ğ
NULL
) {

1134 
d_™
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), 
udi_™
);

1135 ià(
d_™
 =ğ
NULL
) {

1136 
	`HAL_WARNING
 (("Could‚Ù g‘ deviû '%s' from gdÈÜdl.", 
udi_™
));

1137 
”rÜ
;

1141 ià(
	`¡rcmp
 (
udi_™
, "/org/freedesktop/Hal/devices/computer") == 0) {

1142 
physdev
 = 
d_™
;

1143 
physdev_udi
 = 
udi_™
;

1144 ià(
is_md_deviû
) {

1145 *
Ëv–
;

1146 *
mod–_Çme
;

1148 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "linux_raid");

1150 
Ëv–
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th_»®
, "md/level");

1151 ià(
Ëv–
 =ğ
NULL
)

1152 
”rÜ
;

1153 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.lšux_¿id.Ëv–", 
Ëv–
);

1155 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.lšux_¿id.sysfs_·th", 
sysfs_·th_»®
);

1157 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.vendor", "Linux");

1158 ià(
	`¡rcmp
 (
Ëv–
, "linear") == 0) {

1159 
mod–_Çme
 = 
	`g_¡rdup
 ("Software RAID (Linear)");

1160 } ià(
	`¡rcmp
 (
Ëv–
, "raid0") == 0) {

1161 
mod–_Çme
 = 
	`g_¡rdup
 ("Software RAID-0 (Stripe)");

1162 } ià(
	`¡rcmp
 (
Ëv–
, "raid1") == 0) {

1163 
mod–_Çme
 = 
	`g_¡rdup
 ("Software RAID-1 (Mirror)");

1164 } ià(
	`¡rcmp
 (
Ëv–
, "raid5") == 0) {

1165 
mod–_Çme
 = 
	`g_¡rdup
 ("Software RAID-5");

1167 
mod–_Çme
 = 
	`g_¡rdup_´štf
 ("Soáw¬RAID (%s)", 
Ëv–
);

1169 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.mod–", 
mod–_Çme
);

1170 
	`g_ä“
 (
mod–_Çme
);

1172 
	`h®_ut_£t_¡ršg_äom_fe
 (

1173 
d
, "storage.firmware_version",

1174 
sysfs_·th_»®
, "md/metadata_version");

1176 
	`h®_deviû_add_ÿ·b™y
 (
d
, "storage.linux_raid");

1178 ià(!
	`»äesh_md_¡©e
 (
d
))

1179 
”rÜ
;

1181 
is_hÙ¶uggabË
 = 
	`h®_deviû_´İ”ty_g‘_boŞ
 (

1182 
d
, "storage.hotpluggable");

1184 } ià(
is_cciss_deviû
) {

1185 
	`HAL_DEBUG
 (("block_add:…arent=/org/freedesktop/Hal/devices/computer, is_cciss_device=true"));

1186 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "cciss");

1192 ià((
bus
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d_™
, "šfo.subsy¡em")è!ğ
NULL
) {

1193 
	`HAL_DEBUG
(("block_add: info.subsy¡em='%s'", 
bus
));

1195 ià(
	`¡rcmp
 (
bus
, "scsi") == 0) {

1196 
scsidev
 = 
d_™
;

1197 
physdev
 = 
d_™
;

1198 
physdev_udi
 = 
udi_™
;

1199 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "scsi");

1200 
	`h®_deviû_cİy_´İ”ty
 (
scsidev
, "scsi.lun", 
d
, "storage.lun");

1204 ià(
	`¡rcmp
 (
bus
, "usb") == 0) {

1205 
physdev
 = 
d_™
;

1206 
physdev_udi
 = 
udi_™
;

1207 
is_hÙ¶uggabË
 = 
TRUE
;

1208 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "usb");

1210 } ià(
	`¡rcmp
 (
bus
, "ieee1394") == 0) {

1211 
physdev
 = 
d_™
;

1212 
physdev_udi
 = 
udi_™
;

1213 
is_hÙ¶uggabË
 = 
TRUE
;

1214 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "ieee1394");

1216 } ià(
	`¡rcmp
 (
bus
, "ide") == 0) {

1217 
physdev
 = 
d_™
;

1218 
physdev_udi
 = 
udi_™
;

1219 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "ide");

1221 } ià(
	`¡rcmp
 (
bus
, "pcmcia") == 0) {

1222 
physdev
 = 
d_™
;

1223 
physdev_udi
 = 
udi_™
;

1224 
is_hÙ¶uggabË
 = 
TRUE
;

1225 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "pcmcia");

1227 } ià(
	`¡rcmp
 (
bus
, "mmc") == 0) {

1228 
physdev
 = 
d_™
;

1229 
physdev_udi
 = 
udi_™
;

1230 
is_hÙ¶uggabË
 = 
TRUE
;

1231 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "mmc");

1233 } ià(
	`¡rcmp
 (
bus
, "memstick") == 0) {

1234 
physdev
 = 
d_™
;

1235 
physdev_udi
 = 
udi_™
;

1236 
is_hÙ¶uggabË
 = 
TRUE
;

1237 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "memstick");

1239 } ià(
	`¡rcmp
 (
bus
, "ccw") == 0) {

1240 
physdev
 = 
d_™
;

1241 
physdev_udi
 = 
udi_™
;

1242 
is_hÙ¶uggabË
 = 
TRUE
;

1243 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "ccw");

1244 } ià(
	`¡rcmp
 (
bus
, "vio") == 0) {

1245 
physdev
 = 
d_™
;

1246 
physdev_udi
 = 
udi_™
;

1247 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "vio");

1248 } ià(
	`¡rcmp
 (
bus
, "pci") == 0) {

1249 
physdev
 = 
d_™
;

1250 
physdev_udi
 = 
udi_™
;

1251 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "pci");

1256 
udi_™
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d_™
, "info.parent");

1260 ià(
physdev_udi
 =ğ
NULL
) {

1261 
	`HAL_WARNING
 (("No…hysical device?"));

1262 
”rÜ
;

1265 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.Üigš©šg_deviû", 
physdev_udi
);

1267 ià(!
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th_»®
, "»movabË", (
gšt
 *è&
is_»movabË
, 10)) {

1268 
	`HAL_WARNING
 (("Cannot get 'removable' file"));

1269 
is_»movabË
 = 
FALSE
;

1272 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»movabË.medŸ_avaabË", 
FALSE
);

1273 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»movabË", 
is_»movabË
);

1275 ià(!
is_»movabË
) {

1276 
gušt64
 
num_blocks
;

1277 ià(
	`h®_ut_g‘_ušt64_äom_fe
 (
sysfs_·th_»®
, "size", &
num_blocks
, 0)) {

1280 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "¡Üage.size", 
num_blocks
 * 512);

1283 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "storage.size", 0);

1286 ià(
is_»movabË
) {

1287 
sysfs_ÿ·b™y
;

1288 
gboŞ—n
 
suµÜt_ª
;

1290 
suµÜt_ª
 =

1291 
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "ÿ·b™y", &
sysfs_ÿ·b™y
, 16) &&

1292 (
sysfs_ÿ·b™y
&4) != 0;

1294 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»movabË.suµÜt_async_nÙifiÿtiÚ", 
suµÜt_ª
);

1301 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.medŸ_check_’abËd", 
is_»movabË
);

1303 
·»Á_bus
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
·»Á
, "info.subsystem");

1304 ià(
·»Á_bus
 =ğ
NULL
) {

1305 
	`HAL_INFO
 (("parent_bus is NULL - wrong…arent?"));

1306 
”rÜ
;

1308 
	`HAL_INFO
 (("·»Á_bu i %s", 
·»Á_bus
));

1311 ià(
	`¡rcmp
 (
·»Á_bus
, "ide") == 0) {

1312 
buf
[256];

1313 
gch¬
 *
medŸ
;

1314 
gch¬
 *
mod–
;

1315 
¡©
 
¡
;

1318 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.medŸ_check_’abËd", 
FALSE
);

1324 
	`¢´štf
 (
buf
,  (buf), "/´oc/ide/%s", 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th_»®
));

1325 ià(
	`¡©
(
buf
, &
¡
)) {

1329 
	`¢´štf
 (
buf
,  (buf), "%s/%s", 
sysfs_·th_»®
, "device");

1331 ià((
medŸ
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
buf
, "medŸ")è!ğ
NULL
) {

1332 ià(
	`¡rcmp
 (
medŸ
, "disk") == 0 ||

1333 
	`¡rcmp
 (
medŸ
, "cdrom") == 0 ||

1334 
	`¡rcmp
 (
medŸ
, "floppy") == 0) {

1335 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.drive_ty³", 
medŸ
);

1337 
	`HAL_WARNING
 (("CªnÙ d‘”mšIDE drivty³ from f%s/medŸ", 
buf
));

1338 
”rÜ
;

1341 ià(
	`¡rcmp
 (
medŸ
, "cdrom") == 0) {

1343 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.medŸ_check_’abËd", 
TRUE
);

1347 ià((
mod–
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
buf
, "mod–")è!ğ
NULL
) {

1348 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.mod–", 
mod–
);

1349 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
mod–
);

1352 } ià(
	`¡rcmp
 (
·»Á_bus
, "scsi") == 0) {

1353 ià(
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
·»Á
, "scsi.type"), "unknown") == 0) {

1354 
	`HAL_WARNING
 (("scsi.type is unknown"));

1355 
”rÜ
;

1357 
	`h®_deviû_cİy_´İ”ty
 (
·»Á
, "scsi.ty³", 
d
, "storage.drive_type");

1358 
	`h®_deviû_cİy_´İ”ty
 (
·»Á
, "scsi.v’dÜ", 
d
, "storage.vendor");

1359 
	`h®_deviû_cİy_´İ”ty
 (
·»Á
, "scsi.mod–", 
d
, "storage.model");

1361 
	`h®_deviû_cİy_´İ”ty
 (
d
, "storage.vendor", d, "info.vendor");

1362 
	`h®_deviû_cİy_´İ”ty
 (
d
, "storage.model", d, "info.product");

1369 ià(
physdev
 !ğ
NULL
) {

1370 ià(
	`h®_deviû_´İ”ty_g‘_št
 (
physdev
, "usb.interface.class") == 8 &&

1371 
	`h®_deviû_´İ”ty_g‘_št
 (
physdev
, "usb.interface.subclass") == 4 ) {

1373 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.drive_type", "floppy");

1384 } ià(
	`¡rcmp
 (
·»Á_bus
, "mmc") == 0) {

1385 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.drive_type", "sd_mmc");

1386 } ià(
	`¡rcmp
 (
·»Á_bus
, "memstick") == 0) {

1387 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.drive_type", "memstick");

1388 } ià(
	`¡rcmp
 (
·»Á_bus
, "vio") == 0) {

1389 
buf
[256];

1390 cÚ¡ 
gch¬
 *
´İ
;

1392 
	`¢´štf
(
buf
, (buf), "%s/deviû", 
sysfs_·th_»®
);

1393 
´İ
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
buf
, "name");

1394 ià(
´İ
) {

1395 ià(
	`¡rcmp
 (
´İ
, "viocd") == 0) {

1396 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Vio Virtual CD");

1397 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.drive_type", "cdrom");

1398 } ià(
	`¡rcmp
 (
´İ
, "viodasd") == 0) {

1399 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Vio Virtual Disk");

1400 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.drive_type", "disk");

1401 } ià(
	`¡rcmp
 (
´İ
, "viotape") == 0) {

1402 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Vio Virtual Tape");

1403 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.drive_type", "tape");

1407 ià(
	`¡rcmp
 (
·»Á_bus
, "xen") == 0) {

1408 
buf
[256];

1409 
gch¬
 *
medŸ
;

1411 
	`¢´štf
 (
buf
,  (buf), "%s/%s", 
sysfs_·th_»®
, "device");

1412 ià((
medŸ
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
buf
, "medŸ")è!ğ
NULL
) {

1413 ià(
	`¡rcmp
 (
medŸ
, "cdrom") == 0) {

1414 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Xen Virtual CD");

1415 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.drive_ty³", 
medŸ
);

1416 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.medŸ_check_’abËd", 
FALSE
);

1417 } ià(
	`¡rcmp
 (
medŸ
, "floppy") == 0) {

1418 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Xen Virtual Floppy");

1419 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.drive_ty³", 
medŸ
);

1420 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.medŸ_check_’abËd", 
FALSE
);

1423 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Xen Virtual Disk");

1424 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.drive_type", "disk");

1429 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "storage");

1430 
	`h®_deviû_add_ÿ·b™y
 (
d
, "storage");

1431 
	`h®_deviû_add_ÿ·b™y
 (
d
, "block");

1433 ià(
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.drive_type"), "cdrom") == 0) {

1434 
	`h®_deviû_add_ÿ·b™y
 (
d
, "storage.cdrom");

1435 
no_·¹™iÚs_hšt
 = 
TRUE
;

1436 
»quœes_ejeù
 = 
TRUE
;

1439 ià(
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.drive_type"), "floppy") == 0) {

1440 
no_·¹™iÚs_hšt
 = 
TRUE
;

1443 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.hÙ¶uggabË", 
is_hÙ¶uggabË
);

1444 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»quœes_ejeù", 
»quœes_ejeù
);

1445 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.no_·¹™iÚs_hšt", 
no_·¹™iÚs_hšt
);

1448 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
d
);

1451 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_PREPROBE
);

1454 
	`h®_ut_ÿÎout_deviû_´•robe
 (
d
, 
blockdev_ÿÎouts_´•robšg_¡Üage_dÚe
, 
’d_tok’
, 
NULL
);

1457 
gušt
 
sysfs_·th_Ën
;

1458 
gboŞ—n
 
is_physiÿl_·¹™iÚ
;

1459 *
vŞume_Ïb–
;

1460 
buf
[64];

1467 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "block.¡Üage_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á
));

1470 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.fstype", "");

1471 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.fsusage", "");

1472 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.fsversion", "");

1473 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.uuid", "");

1474 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.label", "");

1475 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.mount_point", "");

1478 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "vŞume.fsu§ge", 
hÙ¶ug_ev’t
->
sysfs
.
fsu§ge
);

1479 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "vŞume.fsv”siÚ", 
hÙ¶ug_ev’t
->
sysfs
.
fsv”siÚ
);

1480 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "vŞume.uuid", 
hÙ¶ug_ev’t
->
sysfs
.
fsuuid
);

1481 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "vŞume.f¡y³", 
hÙ¶ug_ev’t
->
sysfs
.
f¡y³
);

1482 ià(
hÙ¶ug_ev’t
->
sysfs
.
f¡y³
[0] != '\0') {

1483 
	`¢´štf
 (
buf
,  (buf), "VŞum(%s)", 
hÙ¶ug_ev’t
->
sysfs
.
f¡y³
);

1485 
	`¢´štf
 (
buf
,  (buf), "Volume");

1487 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

1489 
vŞume_Ïb–
 = 
	`¡rdup_v®id_utf8
 (
hÙ¶ug_ev’t
->
sysfs
.
f¦ab–
);

1490 ià(
vŞume_Ïb–
) {

1491 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "vŞume.Ïb–", 
vŞume_Ïb–
);

1492 ià(
vŞume_Ïb–
[0] != '\0') {

1493 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
vŞume_Ïb–
);

1495 
	`g_ä“
(
vŞume_Ïb–
);

1498 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.is_mouÁed", 
FALSE
);

1499 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.is_mouÁed_»ad_Úly", 
FALSE
);

1500 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.lšux.is_deviû_m­³r", 
is_deviû_m­³r
);

1501 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.is_disc", 
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
·»Á
, "storage.drive_type"), "cdrom") == 0);

1504 
is_physiÿl_·¹™iÚ
 = 
TRUE
;

1505 ià(
is_çkevŞume
 || 
is_deviû_m­³r
)

1506 
is_physiÿl_·¹™iÚ
 = 
FALSE
;

1508 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.is_·¹™iÚ", 
is_physiÿl_·¹™iÚ
);

1510 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "volume");

1511 ià(
	`¡rcmp
(
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
·»Á
, "storage.drive_type"), "cdrom") == 0) {

1512 
	`h®_deviû_add_ÿ·b™y
 (
d
, "volume.disc");

1514 
	`h®_deviû_add_ÿ·b™y
 (
d
, "volume");

1515 
	`h®_deviû_add_ÿ·b™y
 (
d
, "block");

1518 
sysfs_·th_Ën
 = 
	`¡¾’
 (
sysfs_·th
);

1519 ià(
is_physiÿl_·¹™iÚ
) {

1520 ià(
sysfs_·th_Ën
 > 0 && 
	`isdig™
 (
sysfs_·th
[sysfs_path_len - 1])) {

1521 
gušt
 
i
;

1522 
i
 = 
sysfs_·th_Ën
 - 1; 
	`isdig™
 (
sysfs_·th
[i]); --i)

1524 ià(
	`isdig™
 (
sysfs_·th
[
i
+1])) {

1525 
gušt
 
·¹™iÚ_numb”
;

1526 
·¹™iÚ_numb”
 = 
	`©oi
 (&
sysfs_·th
[
i
+1]);

1527 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "vŞume.·¹™iÚ.numb”", 
·¹™iÚ_numb”
);

1529 
	`HAL_WARNING
 (("Cannot determine…artition‚umber?"));

1530 
”rÜ
;

1533 
	`HAL_WARNING
 (("Cannot determine…artition‚umber"));

1534 
”rÜ
;

1542 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "volume.block_size", 512);

1543 ià(!
	`h®_ut_£t_ušt64_äom_fe
 (
d
, "vŞume.num_blocks", 
sysfs_·th_»®
, "size", 0)) {

1544 
	`HAL_INFO
 (("Ignoring hotplugƒvent - cannot„ead 'size'"));

1545 
”rÜ
;

1547 
	`h®_deviû_´İ”ty_£t_ušt64
 (

1548 
d
, "volume.size",

1549 ((
dbus_ušt64_t
)(512)è* ((dbus_ušt64_t)(
	`h®_deviû_´İ”ty_g‘_ušt64
 (
d
, "volume.num_blocks"))));

1551 ià(
is_physiÿl_·¹™iÚ
) {

1552 
gušt64
 
¡¬t_block
;

1553 
gušt64
 
·»Á_size
;

1554 ià(
	`h®_ut_g‘_ušt64_äom_fe
 (
sysfs_·th
, "¡¬t", &
¡¬t_block
, 0)) {

1555 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "vŞume.·¹™iÚ.¡¬t", 
¡¬t_block
 * 512);

1557 ià(
	`h®_ut_g‘_ušt64_äom_fe
 (
sysfs_·th
, "../size", &
·»Á_size
, 0)) {

1558 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "vŞume.·¹™iÚ.medŸ_size", 
·»Á_size
 * 512);

1564 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
d
);

1567 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_PREPROBE
);

1570 
	`h®_ut_ÿÎout_deviû_´•robe
 (
d
, 
blockdev_ÿÎouts_´•robšg_vŞume_dÚe
, 
’d_tok’
, 
NULL
);

1572 
out2
:

1573 
	`g_ä“
 (
sysfs_·th_»®
);

1576 
”rÜ
:

1577 
	`HAL_WARNING
 (("Not‡dding device object"));

1578 ià(
d
 !ğ
NULL
)

1579 
	`g_objeù_uÄef
 (
d
);

1580 
out
:

1581 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1582 
	`g_ä“
 (
sysfs_·th_»®
);

1584 
	}
}

1588 
	$fÜû_unmouÁ_cb
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
,

1589 
gšt
 
»tuº_code
, 
gch¬
 **
”rÜ
,

1590 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

1592 *
’d_tok’
 = (*è
d©a1
;

1594 
	`HAL_INFO
 (("fÜû_unmouÁ_cb fÜ udi='%s',ƒx™_ty³=%d,„‘uº_code=%d", 
	`h®_deviû_g‘_udi
 (
d
), 
ex™_ty³
, 
»tuº_code
));

1596 ià(
ex™_ty³
 =ğ
HALD_RUN_SUCCESS
 && 
”rÜ
 !ğ
NULL
 &&

1597 
”rÜ
[0] !ğ
NULL
 &&ƒrror[1] != NULL) {

1598 *
exp_Çme
 = 
NULL
;

1599 *
exp_d‘a
 = 
NULL
;

1601 
exp_Çme
 = 
”rÜ
[0];

1602 ià(
”rÜ
[0] !ğ
NULL
) {

1603 
exp_d‘a
 = 
”rÜ
[1];

1605 
	`HAL_INFO
 (("çed w™h '%s' '%s'", 
exp_Çme
, 
exp_d‘a
));

1608 
	`h®_ut_ÿÎout_deviû_»move
 (
d
, 
blockdev_ÿÎouts_»move_dÚe
, 
’d_tok’
, 
NULL
);

1610 
	}
}

1612 
gboŞ—n


1613 
	$fÜû_unmouÁ
 (
H®Deviû
 *
d
, *
’d_tok’
)

1615 cÚ¡ *
deviû_fe
;

1616 cÚ¡ *
mouÁ_pošt
;

1618 
deviû_fe
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "block.device");

1619 
mouÁ_pošt
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "volume.mount_point");

1622 ià(
mouÁ_pošt
 !ğ
NULL
 && 
	`¡¾’
 (mouÁ_poštè> 0 && 
	`h®_ut_is_mouÁed_by_h®d
 (mount_point)) {

1623 *
unmouÁ_¡dš
;

1624 *
exŒa_’v
[2];

1626 
exŒa_’v
[0] = "HAL_METHOD_INVOKED_BY_UID=0";

1627 
exŒa_’v
[1] = 
NULL
;

1629 
	`HAL_INFO
 (("fÜû_unmouÁ fÜ udi='%s'", 
	`h®_deviû_g‘_udi
 (
d
)));

1630 
	`sy¦og
 (
LOG_NOTICE
, "fÜcibly‡‰em±šgØÏzy unmouÁ % a ’şosšg drivwa discÚÃùed", 
deviû_fe
);

1632 
unmouÁ_¡dš
 = "lazy\n";

1635 
	`h®d_ruÂ”_run_m‘hod
 (
d
,

1637 
exŒa_’v
,

1638 
unmouÁ_¡dš
, 
TRUE
,

1640 
fÜû_unmouÁ_cb
,

1641 
’d_tok’
, 
NULL
);

1642  
TRUE
;

1644  
FALSE
;

1646 
	}
}

1649 
	$hÙ¶ug_ev’t_begš_»move_blockdev
 (cÚ¡ 
gch¬
 *
sysfs_·th
, *
’d_tok’
)

1651 
H®Deviû
 *
d
;

1653 
	`HAL_INFO
 (("block_»m: sysfs_·th=%s", 
sysfs_·th
));

1655 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "lšux.sysfs_·th", 
sysfs_·th
);

1656 ià(
d
 =ğ
NULL
) {

1657 
	`HAL_WARNING
 (("Device is‚ot inhe HAL database"));

1658 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1660 
H®Deviû
 *
çkevŞume
;

1661 
çke_sysfs_·th
[
HAL_PATH_MAX
];

1666 
	`¢´štf
 (
çke_sysfs_·th
, (çke_sysfs_·th), "%s/çkevŞume", 
sysfs_·th
);

1667 
çkevŞume
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "lšux.sysfs_·th", 
çke_sysfs_·th
);

1668 ià(
çkevŞume
 !ğ
NULL
) {

1669 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

1670 
	`HAL_INFO
 (("Storage device with‡ fakevolume is going‡way; "

1671 "syÁhesizšg hÙ¶ug„em fÜ fakevŞum%s", 
	`h®_deviû_g‘_udi
 (
çkevŞume
)));

1672 
hÙ¶ug_ev’t
 = 
	`blockdev_g’”©e_»move_hÙ¶ug_ev’t
 (
çkevŞume
);

1673 ià(
hÙ¶ug_ev’t
 !ğ
NULL
) {

1679 
	`hÙ¶ug_ev’t_’queue_©_äÚt
 ((
HÙ¶ugEv’t
 *è
’d_tok’
);

1680 
	`hÙ¶ug_ev’t_’queue_©_äÚt
 (
hÙ¶ug_ev’t
);

1681 
	`hÙ¶ug_ev’t_»po¡ed
 (
’d_tok’
);

1682 
out
;

1688 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "volume.is_mounted")) {

1689 ià(!
	`fÜû_unmouÁ
 (
d
, 
’d_tok’
)) {

1691 
	`HAL_INFO
 (("deviû‡ˆsysfs_·th % i mouÁed, buˆnÙ by HAL", 
sysfs_·th
));

1692 
	`h®_ut_ÿÎout_deviû_»move
 (
d
, 
blockdev_ÿÎouts_»move_dÚe
, 
’d_tok’
, 
NULL
);

1695 
	`HAL_INFO
 (("deviû‡ˆsysfs_·th % i nÙ mouÁed", 
sysfs_·th
));

1696 
	`h®_ut_ÿÎout_deviû_»move
 (
d
, 
blockdev_ÿÎouts_»move_dÚe
, 
’d_tok’
, 
NULL
);

1699 
out
:

1701 
	}
}

1704 
	$hÙ¶ug_ev’t_»äesh_blockdev
 (
gch¬
 *
sysfs_·th
, 
H®Deviû
 *
d
, *
’d_tok’
)

1706 
	`HAL_INFO
 (("block_chªge: sysfs_·th=%s", 
sysfs_·th
));

1708 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "storage.removable.support_async_notification")) {

1709 
	`blockdev_»sÿn_deviû
 (
d
);

1713 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1714 
	}
}

1718 
	$block_»sÿn_¡Üage_dÚe
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
,

1719 
gšt
 
»tuº_code
, 
gch¬
 **
”rÜ
,

1720 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

1722 cÚ¡ *
sysfs_·th
;

1723 
H®Deviû
 *
çkevŞume
;

1724 
çke_sysfs_·th
[
HAL_PATH_MAX
];

1726 
	`HAL_INFO
 (("h®d-´obe-¡Üag--Úly-check-fÜ-medŸ„‘uºed %d (ex™_ty³=%d)", 
»tuº_code
, 
ex™_ty³
));

1728 ià(
d
 =ğ
NULL
) {

1729 
	`HAL_INFO
 (("Device object‡lready„emoved"));

1730 
out
;

1733 
sysfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.sysfs_path");

1736 
	`¢´štf
 (
çke_sysfs_·th
, (çke_sysfs_·th), "%s/çkevŞume", 
sysfs_·th
);

1737 
çkevŞume
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "lšux.sysfs_·th", 
çke_sysfs_·th
);

1739 ià(
»tuº_code
 == 2) {

1741 ià(
çkevŞume
 =ğ
NULL
) {

1742 
	`HAL_INFO
 (("Media insertion detected with file system on main block device; synthesizing hotplug‡dd"));

1743 
	`g’”©e_çkevŞume_hÙ¶ug_ev’t_add_fÜ_¡Üage_deviû
 (
d
);

1747 ià(
çkevŞume
 !ğ
NULL
) {

1749 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

1750 
	`HAL_INFO
 (("Media„emoval detected; synthesizing hotplug„em for fakevolume %s",

1751 
	`h®_deviû_g‘_udi
 (
çkevŞume
)));

1752 
hÙ¶ug_ev’t
 = 
	`blockdev_g’”©e_»move_hÙ¶ug_ev’t
 (
çkevŞume
);

1753 ià(
hÙ¶ug_ev’t
 !ğ
NULL
) {

1754 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

1759 
out
:

1761 
	}
}

1763 
gboŞ—n


1764 
	$blockdev_»sÿn_deviû
 (
H®Deviû
 *
d
)

1766 
gboŞ—n
 
»t
;

1768 
»t
 = 
FALSE
;

1770 
	`HAL_INFO
 (("blockdev_»sÿn_deviû: udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1773 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "block.is_volume")) {

1774 
	`HAL_INFO
 (("NØaùiÚ oÀvŞumes", 
	`h®_deviû_g‘_udi
 (
d
)));

1775 
out
;

1779 
	`h®d_ruÂ”_run
 (
d
,

1780 "h®d-´obe-¡Üag--Úly-check-fÜ-medŸ", 
NULL
,

1781 
HAL_HELPER_TIMEOUT
,

1782 
block_»sÿn_¡Üage_dÚe
,

1783 
NULL
, NULL);

1784 
»t
 = 
TRUE
;

1786 
out
:

1787  
»t
;

1788 
	}
}

1791 
HÙ¶ugEv’t
 *

1792 
	$blockdev_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
)

1794 cÚ¡ *
sysfs_·th
;

1795 cÚ¡ *
deviû_fe
;

1796 cÚ¡ *
mod–
;

1797 cÚ¡ *
v’dÜ
;

1798 cÚ¡ *
£rŸl
;

1799 cÚ¡ *
»visiÚ
;

1800 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

1801 cÚ¡ *
nul
;

1803 
nul
 = "\0";

1805 
sysfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.sysfs_path");

1807 
deviû_fe
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "block.device");

1808 
mod–
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.model");

1809 
v’dÜ
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.vendor");

1810 
£rŸl
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.serial");

1811 
»visiÚ
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.firmware_revision");

1813 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

1814 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

1815 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS
;

1816 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, "block",  (hotplug_event->sysfs.subsystem));

1817 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, sysfs_path,  (hotplug_event->sysfs.sysfs_path));

1819 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, deviû_f!ğ
NULL
 ? deviû_f: 
nul
, 
HAL_NAME_MAX
);

1820 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
v’dÜ
, v’dÜ !ğ
NULL
 ? v’dÜ : 
nul
, 
HAL_NAME_MAX
);

1821 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
mod–
, mod– !ğ
NULL
 ? mod– : 
nul
, 
HAL_NAME_MAX
);

1822 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
£rŸl
, s”ŸÈ!ğ
NULL
 ? s”ŸÈ: 
nul
, 
HAL_NAME_MAX
);

1823 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
»visiÚ
,„evisiÚ !ğ
NULL
 ?„evisiÚ : 
nul
, 
HAL_NAME_MAX
);

1825 
hÙ¶ug_ev’t
->
sysfs
.
Ãt_ifšdex
 = -1;

1827  
hÙ¶ug_ev’t
;

1828 
	}
}

1830 
HÙ¶ugEv’t
 *

1831 
	$blockdev_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
)

1833 cÚ¡ *
sysfs_·th
;

1834 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

1836 
sysfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.sysfs_path");

1838 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

1839 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_REMOVE
;

1840 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS
;

1841 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, "block",  (hotplug_event->sysfs.subsystem));

1842 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, sysfs_path,  (hotplug_event->sysfs.sysfs_path));

1843 
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
[0] = '\0';

1844 
hÙ¶ug_ev’t
->
sysfs
.
Ãt_ifšdex
 = -1;

1846  
hÙ¶ug_ev’t
;

1847 
	}
}

1849 
GSLi¡
 *
	gmd_devs
 = 
NULL
;

1852 
	$udev_g‘_deviû_fe_fÜ_sysfs_·th
 (cÚ¡ *
sysfs_·th
)

1854 *
»t
;

1855 *
u_¡dout
;

1856 
u_ex™_¡©us
;

1857 cÚ¡ *
¬gv
[] = {"/sbš/udevadm", "šfo", "--roÙ", "--qu”y", "Çme", "--·th", 
NULL
, NULL};

1858 
GE¼Ü
 *
g_”rÜ
;

1860 
»t
 = 
NULL
;

1861 
¬gv
[6] = 
sysfs_·th
;

1863 
g_”rÜ
 = 
NULL
;

1865 ià(!
	`g_¥awn_sync
("/",

1866 (**è
¬gv
,

1867 
NULL
,

1868 
G_SPAWN_LEAVE_DESCRIPTORS_OPEN
,

1869 
NULL
,

1870 
NULL
,

1871 &
u_¡dout
,

1872 
NULL
,

1873 &
u_ex™_¡©us
,

1874 &
g_”rÜ
)) {

1875 
	`HAL_ERROR
 (("E¼Ü s·wnšg udevšfo: %s", 
g_”rÜ
->
mes§ge
));

1876 
	`g_”rÜ_ä“
 (
g_”rÜ
);

1877 
out
;

1880 ià(
u_ex™_¡©us
 != 0) {

1881 
	`HAL_ERROR
 (("udevšfØ»tuºedƒx™ cod%d", 
u_ex™_¡©us
));

1882 
	`g_ä“
 (
u_¡dout
);

1883 
out
;

1886 
»t
 = 
u_¡dout
;

1887 
	`g_¡rchomp
 (
»t
);

1888 
	`HAL_INFO
 (("GÙ '%s'", 
»t
));

1890 
out
:

1891  
»t
;

1892 
	}
}

1896 
	$blockdev_´oûss_md¡©
 ()

1898 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

1899 
GIOChªÃl
 *
chªÃl
;

1900 
GSLi¡
 *
»ad_md_devs
;

1901 
GSLi¡
 *
i
;

1902 
GSLi¡
 *
j
;

1903 
GSLi¡
 *
k
;

1905 
chªÃl
 = 
	`g‘_md¡©_chªÃl
 ();

1906 ià(
chªÃl
 =ğ
NULL
)

1907 
”rÜ
;

1909 ià(
	`g_io_chªÃl_£ek
 (
chªÃl
, 0, 
G_SEEK_SET
è!ğ
G_IO_ERROR_NONE
) {

1910 
	`HAL_ERROR
 (("Cannot seek in /proc/mdstat"));

1911 
”rÜ
;

1914 
»ad_md_devs
 = 
NULL
;

1915 
TRUE
) {

1916 
num
;

1917 *
lše
;

1919 ià(
	`g_io_chªÃl_»ad_lše
 (
chªÃl
, &
lše
, 
NULL
, NULL, NULLè!ğ
G_IO_STATUS_NORMAL
)

1922 ià(
	`ssÿnf
 (
lše
, "md%d : ", &
num
) == 1) {

1923 *
sysfs_·th
;

1924 
sysfs_·th
 = 
	`g_¡rdup_´štf
 ("/sys/block/md%d", 
num
);

1925 
»ad_md_devs
 = 
	`g_¦i¡_´•’d
 (»ad_md_devs, 
sysfs_·th
);

1928 
	`g_ä“
 (
lše
);

1934 
i
 = 
»ad_md_devs
; i !ğ
NULL
; i = i->
Ãxt
) {

1935 
gboŞ—n
 
should_add
 = 
TRUE
;

1937 
j
 = 
md_devs
; j !ğ
NULL
 && 
should_add
; j = j->
Ãxt
) {

1938 ià(
	`¡rcmp
 (
i
->
d©a
, 
j
->data) == 0) {

1939 
should_add
 = 
FALSE
;

1943 ià(
should_add
) {

1944 *
sysfs_·th
 = 
i
->
d©a
;

1945 *
deviû_fe
;

1946 
num_Œ›s
;

1948 
num_Œ›s
 = 0;

1949 
»Œy_add
:

1950 
deviû_fe
 = 
	`udev_g‘_deviû_fe_fÜ_sysfs_·th
 (
sysfs_·th
);

1951 ià(
deviû_fe
 =ğ
NULL
) {

1952 ià(
num_Œ›s
 <= 6) {

1953 
num_ms
;

1954 
num_ms
 = 10 * (1<<
num_Œ›s
);

1955 
	`HAL_INFO
 (("spinning %d ms waiting for device file for sysfs…ath %s",

1956 
num_ms
, 
sysfs_·th
));

1957 
	`u¦“p
 (1000 * 
num_ms
);

1958 
num_Œ›s
++;

1959 
»Œy_add
;

1961 
	`HAL_ERROR
 (("CªnÙ g‘ deviû ffÜ sysf ·th %s", 
sysfs_·th
));

1964 
	`HAL_INFO
 (("Addšg md deviû‡ˆ'%s' ('%s')", 
sysfs_·th
, 
deviû_fe
));

1966 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

1967 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

1968 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS_BLOCK
;

1969 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, "block",  (hotplug_event->sysfs.subsystem));

1970 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, sysfs_path,  (hotplug_event->sysfs.sysfs_path));

1971 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, device_file,  (hotplug_event->sysfs.device_file));

1972 
hÙ¶ug_ev’t
->
sysfs
.
Ãt_ifšdex
 = -1;

1973 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

1975 
md_devs
 = 
	`g_¦i¡_´•’d
 (md_devs, 
	`g_¡rdup
 (
sysfs_·th
));

1977 
	`g_ä“
 (
deviû_fe
);

1984 
i
 = 
md_devs
; i !ğ
NULL
; i = 
k
) {

1985 
gboŞ—n
 
should_»move
 = 
TRUE
;

1987 
k
 = 
i
->
Ãxt
;

1989 
j
 = 
»ad_md_devs
; j !ğ
NULL
 && 
should_»move
; j = j->
Ãxt
) {

1990 ià(
	`¡rcmp
 (
i
->
d©a
, 
j
->data) == 0) {

1991 
should_»move
 = 
FALSE
;

1995 ià(
should_»move
) {

1996 *
sysfs_·th
 = 
i
->
d©a
;

1997 *
deviû_fe
;

1998 
num_Œ›s
;

2000 
num_Œ›s
 = 0;

2001 
»Œy_»m
:

2002 
deviû_fe
 = 
	`udev_g‘_deviû_fe_fÜ_sysfs_·th
 (
sysfs_·th
);

2003 ià(
deviû_fe
 =ğ
NULL
) {

2004 ià(
num_Œ›s
 <= 6) {

2005 
num_ms
;

2006 
num_ms
 = 10 * (1<<
num_Œ›s
);

2007 
	`HAL_INFO
 (("spinning %d ms waiting for device file for sysfs…ath %s",

2008 
num_ms
, 
sysfs_·th
));

2009 
	`u¦“p
 (1000 * 
num_ms
);

2010 
num_Œ›s
++;

2011 
»Œy_»m
;

2013 
	`HAL_ERROR
 (("CªnÙ g‘ deviû ffÜ sysf ·th %s", 
sysfs_·th
));

2017 
	`HAL_INFO
 (("Removšg md deviû‡ˆ'%s' ('%s')", 
sysfs_·th
, 
deviû_fe
));

2019 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

2020 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_REMOVE
;

2021 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS_BLOCK
;

2022 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, "block",  (hotplug_event->sysfs.subsystem));

2023 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, sysfs_path,  (hotplug_event->sysfs.sysfs_path));

2024 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, device_file,  (hotplug_event->sysfs.device_file));

2025 
hÙ¶ug_ev’t
->
sysfs
.
Ãt_ifšdex
 = -1;

2026 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

2028 
md_devs
 = 
	`g_¦i¡_»move_lšk
 (md_devs, 
i
);

2029 
	`g_ä“
 (
i
->
d©a
);

2030 
	`g_¦i¡_ä“
 (
i
);

2032 
	`g_ä“
 (
deviû_fe
);

2038 
	`g_¦i¡_fÜ—ch
 (
»ad_md_devs
, (
GFunc
è
g_ä“
, 
NULL
);

2039 
	`g_¦i¡_ä“
 (
»ad_md_devs
);

2042 
i
 = 
md_devs
; i !ğ
NULL
; i = i->
Ãxt
) {

2043 *
sysfs_·th
 = 
i
->
d©a
;

2044 
H®Deviû
 *
d
;

2046 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

2048 
sysfs_·th
);

2049 ià(
d
 =ğ
NULL
)

2050 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_tdl
 (),

2052 
sysfs_·th
);

2053 ià(
d
 !ğ
NULL
)

2054 
	`»äesh_md_¡©e
 (
d
);

2058 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

2060 
”rÜ
:

2062 
	}
}

	@hald/linux/blockdev.h

26 #iâdeà
BLOCKDEV_H


27 
	#BLOCKDEV_H


	)

29 
	~<glib.h
>

31 
hÙ¶ug_ev’t_begš_add_blockdev
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ *
deviû_fe
, 
gboŞ—n
 
is_·¹™iÚ
, 
H®Deviû
 *
·»Á
, *
’d_tok’
);

33 
hÙ¶ug_ev’t_begš_»move_blockdev
 (cÚ¡ 
gch¬
 *
sysfs_·th
, *
’d_tok’
);

35 
hÙ¶ug_ev’t_»äesh_blockdev
 (
gch¬
 *
sysfs_·th
, 
H®Deviû
 *
d
, *
’d_tok’
);

37 
gboŞ—n
 
blockdev_»sÿn_deviû
 (
H®Deviû
 *
d
);

39 
HÙ¶ugEv’t
 *
blockdev_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
);

41 
HÙ¶ugEv’t
 *
blockdev_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
);

43 
blockdev_»äesh_mouÁ_¡©e
 (
H®Deviû
 *
d
);

45 
blockdev_´oûss_md¡©
 ();

	@hald/linux/coldplug.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡dšt.h
>

29 
	~<¡dio.h
>

30 
	~<¡ršg.h
>

31 
	~<dœ’t.h
>

32 
	~<sys/¡©.h
>

33 
	~<uni¡d.h
>

34 
	~<dbus/dbus.h
>

35 
	~<dbus/dbus-glib.h
>

37 
	~"../deviû_šfo.h
"

38 
	~"../h®d.h
"

39 
	~"../logg”.h
"

40 
	~"../os¥ec.h
"

41 
	~"../ut.h
"

42 
	~"../ut_h–³r.h
"

43 
	~"os¥ec_lšux.h
"

44 
	~"hÙ¶ug.h
"

45 
	~"cŞd¶ug.h
"

46 
	~"blockdev.h
"

48 
	#DMPREFIX
 "dm-"

	)

50 
	ssysfs_deviû
 {

51 *
	m·th
;

52 *
	msubsy¡em
;

53 
HÙ¶ugEv’tTy³
 
	mty³
;

56 
GHashTabË
 *
	gsysfs_to_udev_m­
;

57 
GSLi¡
 *
	gdeviû_li¡
;

58 
	gdev_roÙ
[
HAL_PATH_MAX
];

59 
gch¬
 *
	gudevšfo_¡dout
 = 
NULL
;

60 
	gcŞd¶ug_£qnum
 = 0;

61 
_UdevInfo
 
	tUdevInfo
;

63 
	s_UdevInfo


65 cÚ¡ *
	msysfs_·th
;

66 cÚ¡ *
	mdeviû_fe
;

67 cÚ¡ *
	mv’dÜ
;

68 cÚ¡ *
	mmod–
;

69 cÚ¡ *
	m»visiÚ
;

70 cÚ¡ *
	m£rŸl
;

71 cÚ¡ *
	mfsu§ge
;

72 cÚ¡ *
	mf¡y³
;

73 cÚ¡ *
	mfsv”siÚ
;

74 cÚ¡ *
	mfsuuid
;

75 cÚ¡ *
	mf¦ab–
;

78 
	$udev_šfo_ä“
 (
gpoš‹r
 
d©a
)

80 
	`g_¦iû_ä“
(
UdevInfo
, 
d©a
);

81 
	}
}

84 
HÙ¶ugEv’t
*

85 
	$udev_šfo_to_hÙ¶ug_ev’t
 (cÚ¡ 
UdevInfo
 *
šfo
)

87 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

88 
gch¬
 *
¡r
;

90 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

91 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, "/sys", (hotplug_event->sysfs.sysfs_path));

92 
	`g_¡¾ÿt
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, 
šfo
->sysfs_path, (hotplug_event->sysfs.sysfs_path));

94 
	`HAL_INFO
(("ü—tšg HÙ¶ugEv’ˆfÜ %s", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
));

96 ià(
šfo
->
deviû_fe
) {

97 
	`g_¢´štf
 (
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, (hotplug_event->sysfs.device_file),

98 "%s/%s", 
dev_roÙ
, 
šfo
->
deviû_fe
);

99 
	`HAL_INFO
(("w™h deviû f%s", 
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
));

100 ià(
	`¡r¡r
(
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, "/" 
DMPREFIX
è!ğ
NULL
) {

101 
	`HAL_INFO
 (("Found‡ dm-deviû (%sè, m¬k it", 
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
));

102 
hÙ¶ug_ev’t
->
sysfs
.
is_dm_deviû
 = 
TRUE
;

105 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(
šfo
->
v’dÜ
)è!ğ
NULL
) {

106 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
v’dÜ
, 
¡r
, (hotplug_event->sysfs.vendor));

107 
	`g_ä“
 (
¡r
);

110 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(
šfo
->
mod–
)è!ğ
NULL
) {

111 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
mod–
, 
¡r
, (hotplug_event->sysfs.model));

112 
	`g_ä“
 (
¡r
);

115 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(
šfo
->
»visiÚ
)è!ğ
NULL
) {

116 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
»visiÚ
, 
¡r
, (hotplug_event->sysfs.revision));

117 
	`g_ä“
 (
¡r
);

120 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(
šfo
->
£rŸl
)è!ğ
NULL
) {

121 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
£rŸl
, 
¡r
, (hotplug_event->sysfs.serial));

122 
	`g_ä“
 (
¡r
);

125 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(
šfo
->
fsu§ge
)è!ğ
NULL
) {

126 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
fsu§ge
, 
¡r
, (hotplug_event->sysfs.fsusage));

127 
	`g_ä“
 (
¡r
);

130 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(
šfo
->
f¡y³
)è!ğ
NULL
) {

131 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
f¡y³
, 
¡r
, (hotplug_event->sysfs.fstype));

132 
	`g_ä“
 (
¡r
);

135 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(
šfo
->
fsv”siÚ
)è!ğ
NULL
) {

136 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
fsv”siÚ
, 
¡r
, (hotplug_event->sysfs.fsversion));

137 
	`g_ä“
 (
¡r
);

140 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(
šfo
->
fsuuid
)è!ğ
NULL
) {

141 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
fsuuid
, 
¡r
, (hotplug_event->sysfs.fsuuid));

142 
	`g_ä“
 (
¡r
);

145 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(
šfo
->
f¦ab–
)è!ğ
NULL
) {

146 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
f¦ab–
, 
¡r
, (hotplug_event->sysfs.fslabel));

147 
	`g_ä“
 (
¡r
);

150  
hÙ¶ug_ev’t
;

151 
	}
}

154 
gboŞ—n


155 
	$h®_ut_š™_sysfs_to_udev_m­
 ()

157 *
udevdb_expÜt_¬gv
[] = { "/sbš/udevadm", "šfo", "-e", 
NULL
 };

158 *
udevroÙ_¬gv
[] = { "/sbš/udevadm", "šfo", "-r", 
NULL
 };

159 
udevšfo_ex™code
;

160 
UdevInfo
 *
šfo
 = 
NULL
;

161 *
p
;

163 
sysfs_to_udev_m­
 = 
	`g_hash_bË_Ãw_fuÎ
 (
g_¡r_hash
, 
g_¡r_equ®
, 
g_ä“
, 
udev_šfo_ä“
);

166 ià(
	`g_¥awn_sync
 ("/", 
udevroÙ_¬gv
, 
NULL
, 
G_SPAWN_LEAVE_DESCRIPTORS_OPEN
, NULL, NULL,

167 &
udevšfo_¡dout
,

168 
NULL
,

169 &
udevšfo_ex™code
,

170 
NULL
è!ğ
TRUE
) {

171 
	`HAL_ERROR
 (("Couldn'ˆšvok%s", 
udevroÙ_¬gv
[0]));

172 
”rÜ
;

174 ià(
udevšfo_ex™code
 != 0) {

175 
	`HAL_ERROR
 (("% »tuºed %d", 
udevroÙ_¬gv
[0], 
udevšfo_ex™code
));

176 
”rÜ
;

179 
	`g_¡¾ıy
(
dev_roÙ
, 
udevšfo_¡dout
, (dev_root));

180 
p
 = 
	`¡rchr
(
dev_roÙ
, '\n');

181 ià(
p
 !ğ
NULL
)

182 
p
[0] = '\0';

183 
	`g_ä“
(
udevšfo_¡dout
);

184 
	`HAL_INFO
 (("dev_roÙ i %s", 
dev_roÙ
));

187 ià(
	`g_¥awn_sync
 ("/", 
udevdb_expÜt_¬gv
, 
NULL
, 
G_SPAWN_LEAVE_DESCRIPTORS_OPEN
, NULL, NULL,

188 &
udevšfo_¡dout
,

189 
NULL
,

190 &
udevšfo_ex™code
,

191 
NULL
è!ğ
TRUE
) {

192 
	`HAL_ERROR
 (("Couldn'ˆšvok%s", 
udevdb_expÜt_¬gv
[0]));

193 
	`g_ä“
(
udevšfo_¡dout
);

194 
”rÜ
;

197 ià(
udevšfo_ex™code
 != 0) {

198 
	`HAL_ERROR
 (("% »tuºed %d", 
udevdb_expÜt_¬gv
[0], 
udevšfo_ex™code
));

199 
”rÜ
;

203 
p
 = 
udevšfo_¡dout
;

204 
p
[0] != '\0') {

205 *
lše
, *
’d
;

208 
lše
 = 
p
;

209 
’d
 = 
	`¡rchr
(
lše
, '\n');

210 ià(
’d
 =ğ
NULL
)

212 
’d
[0] = '\0';

213 
p
 = &
’d
[1];

216 ià(
lše
[0] == '\0') {

217 ià(
šfo
 !ğ
NULL
) {

218 
	`g_hash_bË_š£¹
 (
sysfs_to_udev_m­
, 
	`g_¡rdup_´štf
 ("/sys%s", 
šfo
->
sysfs_·th
), info);

219 
	`HAL_INFO
 (("found (udevdbƒxport) '/sys%s' -> '%s/%s'",

220 
šfo
->
sysfs_·th
, 
dev_roÙ
, info->
deviû_fe
));

221 
šfo
 = 
NULL
;

227 ià(
	`¡ºcmp
(
lše
, "P: ", 3) == 0) {

228 
šfo
 = 
	`g_¦iû_Ãw0
 (
UdevInfo
);

229 
šfo
->
sysfs_·th
 = &
lše
[3];

234 ià(
šfo
 =ğ
NULL
)

237 ià(
	`¡ºcmp
(
lše
, "N: ", 3) == 0) {

238 
šfo
->
deviû_fe
 = &
lše
[3];

239 } ià(
	`¡ºcmp
(
lše
, "E: ID_VENDOR=", 13) == 0) {

240 
šfo
->
v’dÜ
 = &
lše
[13];

241 } ià(
	`¡ºcmp
(
lše
, "E: ID_MODEL=", 12) == 0) {

242 
šfo
->
mod–
 = &
lše
[12];

243 } ià(
	`¡ºcmp
(
lše
, "E: ID_REVISION=", 15) == 0) {

244 
šfo
->
»visiÚ
 = &
lše
[15];

245 } ià(
	`¡ºcmp
(
lše
, "E: ID_SERIAL=", 13) == 0) {

246 
šfo
->
£rŸl
 = &
lše
[13];

247 } ià(
	`¡ºcmp
(
lše
, "E: ID_FS_USAGE=", 15) == 0) {

248 
šfo
->
fsu§ge
 = &
lše
[15];

249 } ià(
	`¡ºcmp
(
lše
, "E: ID_FS_TYPE=", 14) == 0) {

250 
šfo
->
f¡y³
 = &
lše
[14];

251 } ià(
	`¡ºcmp
(
lše
, "E: ID_FS_VERSION=", 17) == 0) {

252 
šfo
->
fsv”siÚ
 = &
lše
[17];

253 } ià(
	`¡ºcmp
(
lše
, "E: ID_FS_UUID=", 14) == 0) {

254 
šfo
->
fsuuid
 = &
lše
[14];

255 } ià(
	`¡ºcmp
(
lše
, "E: ID_FS_LABEL=", 15) == 0) {

256 
šfo
->
f¦ab–
 = &
lše
[15];

260  
TRUE
;

262 
”rÜ
:

263 
	`g_ä“
(
udevšfo_¡dout
);

264 
	`g_hash_bË_de¡roy
 (
sysfs_to_udev_m­
);

265 
sysfs_to_udev_m­
 = 
NULL
;

266  
FALSE
;

267 
	}
}

269 
HÙ¶ugEv’t


270 *
	$cŞd¶ug_g‘_hÙ¶ug_ev’t
(cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
subsy¡em
, 
HÙ¶ugEv’tTy³
 
ty³
)

272 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

273 cÚ¡ *
pos
;

274 
gch¬
 
·th
[
HAL_PATH_MAX
];

275 
¡©
 
¡©buf
;

276 
UdevInfo
 *
šfo
;

279 
šfo
 = (
UdevInfo
*è
	`g_hash_bË_lookup
 (
sysfs_to_udev_m­
, 
sysfs_·th
);

280 ià(
šfo
) {

281 
hÙ¶ug_ev’t
 = 
	`udev_šfo_to_hÙ¶ug_ev’t
 (
šfo
);

282 
	`HAL_INFO
 (("Ãwƒv’ˆ(dev‚odäom udevè'%s' '%s'", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, hÙ¶ug_ev’t->sysfs.
deviû_fe
));

284 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

287 
	`g_¡¾ıy
(
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, sysfs_path, (hotplug_event->sysfs.sysfs_path));

290 
	`g_¡¾ıy
(
·th
, 
sysfs_·th
, (path));

291 
	`g_¡¾ÿt
(
·th
, "/dev", (path));

292 ià(
	`¡©
 (
·th
, &
¡©buf
) != 0)

293 
no_node
;

296 
pos
 = 
	`¡¼chr
(
sysfs_·th
, '/');

297 ià(
pos
 =ğ
NULL
)

298 
no_node
;

299 
	`g_¡¾ıy
(
·th
, 
dev_roÙ
, (path));

300 
	`g_¡¾ÿt
(
·th
, 
pos
, (path));

301 ià(
	`¡©
 (
·th
, &
¡©buf
) != 0)

302 
no_node
;

303 ià(!
	`S_ISBLK
 (
¡©buf
.
¡_mode
è&& !
	`S_ISCHR
 (statbuf.st_mode))

304 
no_node
;

306 
	`HAL_INFO
 (("Ãwƒv’ˆ(dev‚odäom k”ÃÈÇmeè'%s' '%s'", 
sysfs_·th
, 
·th
));

307 
	`g_¡¾ıy
(
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, 
·th
, (hotplug_event->sysfs.device_file));

308 ià(
	`¡r¡r
(
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, "/" 
DMPREFIX
è!ğ
NULL
) {

309 
	`HAL_INFO
 (("Found‡ dm-deviû (%sè, m¬k it", 
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
));

310 
hÙ¶ug_ev’t
->
sysfs
.
is_dm_deviû
 = 
TRUE
;

314 
no_node
:

315 ià(
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
[0] == '\0')

316 
	`HAL_INFO
 (("Ãwƒv’ˆÒØdev‚odeè'%s'", 
sysfs_·th
));

317 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, subsystem,  (hotplug_event->sysfs.subsystem));

318 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

319 
hÙ¶ug_ev’t
->
ty³
 =ype;

320 
hÙ¶ug_ev’t
->
sysfs
.
Ãt_ifšdex
 = -1;

322 
hÙ¶ug_ev’t
->
sysfs
.
£qnum
 = 
cŞd¶ug_£qnum
++;

323  
hÙ¶ug_ev’t
;

324 
	}
}

326 
	$deviû_li¡_š£¹
(cÚ¡ *
·th
, cÚ¡ *
subsy¡em
,

327 
HÙ¶ugEv’tTy³
 
ty³
)

329 
f’ame
[
HAL_PATH_MAX
];

330 
¡©
 
¡©buf
;

331 
sysfs_deviû
 *
sysfs_dev
 = 
NULL
;

334 
	`g_¡¾ıy
(
f’ame
, 
·th
, (filename));

335 
	`g_¡¾ÿt
(
f’ame
, "/uevent", (filename));

336 ià(
	`¡©
(
f’ame
, &
¡©buf
) < 0)

337 
”rÜ
;

338 ià(!(
¡©buf
.
¡_mode
 & 
S_IWUSR
))

339 
”rÜ
;

341 
sysfs_dev
 = 
	`g_¦iû_Ãw0
 (
sysfs_deviû
);

342 ià(
sysfs_dev
 =ğ
NULL
)

343 
”rÜ
;

346 ià(
	`l¡©
(
·th
, &
¡©buf
) < 0)

347 
”rÜ
;

348 ià(
	`S_ISLNK
(
¡©buf
.
¡_mode
)) {

349 
gch¬
 *
rg‘
;

351 ià((
rg‘
 = 
	`h®_ut_»adlšk
 (
·th
)è!ğ
NULL
) {

352 
gch¬
 *
nÜm®ized_rg‘
;

354 
	`g_¡¾ıy
(
f’ame
, 
·th
, (filename));

355 
	`h®_ut_·th_asûnd
 (
f’ame
);

356 
nÜm®ized_rg‘
 = 
	`h®_ut_g‘_nÜm®ized_·th
 (
f’ame
, 
rg‘
);

357 
sysfs_dev
->
·th
 = 
nÜm®ized_rg‘
;

358 
found
;

360 
”rÜ
;

363 
sysfs_dev
->
·th
 = 
	`g_¡rdup
 (path);

364 
found
:

365 
sysfs_dev
->
subsy¡em
 = 
	`g_¡rdup
 (subsystem);

366 
deviû_li¡
 = 
	`g_¦i¡_­³nd
 (deviû_li¡, 
sysfs_dev
);

369 
”rÜ
:

370 
	`g_¦iû_ä“
 (
sysfs_deviû
, 
sysfs_dev
);

372 
	}
}

375 
	$sÿn_sšgË_bus
 (cÚ¡ *
bus_Çme
)

377 
dœÇme
[
HAL_PATH_MAX
];

378 
DIR
 *
dœ2
;

379 
dœ’t
 *
d’t2
;

381 
	`g_¡¾ıy
(
dœÇme
, "/sys/bus/", (dirname));

382 
	`g_¡¾ÿt
(
dœÇme
, 
bus_Çme
, (dirname));

383 
	`g_¡¾ÿt
(
dœÇme
, "/devices", (dirname));

386 
dœ2
 = 
	`İ’dœ
(
dœÇme
);

387 ià(
dœ2
 !ğ
NULL
) {

388 
d’t2
 = 
	`»addœ
(
dœ2
); d’t2 !ğ
NULL
; dent2 =„eaddir(dir2)) {

389 
dœÇme2
[
HAL_PATH_MAX
];

391 ià(
d’t2
->
d_Çme
[0] == '.')

394 
	`g_¡¾ıy
(
dœÇme2
, 
dœÇme
, (dirname2));

395 
	`g_¡¾ÿt
(
dœÇme2
, "/", (dirname2));

396 
	`g_¡¾ÿt
(
dœÇme2
, 
d’t2
->
d_Çme
, (dirname2));

397 
	`deviû_li¡_š£¹
(
dœÇme2
, 
bus_Çme
, 
HOTPLUG_EVENT_SYSFS_DEVICE
);

399 
	`şo£dœ
(
dœ2
);

401 
	}
}

403 
	$sÿn_subsy¡em
(cÚ¡ *
subsys
)

405 
ba£
[
HAL_PATH_MAX
];

406 
DIR
 *
dœ
;

407 
dœ’t
 *
d’t
;

409 
	`g_¡¾ıy
(
ba£
, "/sys/", (base));

410 
	`g_¡¾ÿt
(
ba£
, 
subsys
, (base));

412 
dœ
 = 
	`İ’dœ
(
ba£
);

413 ià(
dœ
 !ğ
NULL
) {

414 
d’t
 = 
	`»addœ
(
dœ
); d’ˆ!ğ
NULL
; dent =„eaddir(dir)) {

415 
dœÇme
[
HAL_PATH_MAX
];

416 
DIR
 *
dœ2
;

417 
dœ’t
 *
d’t2
;

419 ià(
d’t
->
d_Çme
[0] == '.')

422 
	`g_¡¾ıy
(
dœÇme
, 
ba£
, (dirname));

423 
	`g_¡¾ÿt
(
dœÇme
, "/", (dirname));

424 
	`g_¡¾ÿt
(
dœÇme
, 
d’t
->
d_Çme
, (dirname));

425 
	`g_¡¾ÿt
(
dœÇme
, "/devices", (dirname));

428 
dœ2
 = 
	`İ’dœ
(
dœÇme
);

429 ià(
dœ2
 !ğ
NULL
) {

430 
d’t2
 = 
	`»addœ
(
dœ2
); d’t2 !ğ
NULL
; dent2 =„eaddir(dir2)) {

431 
dœÇme2
[
HAL_PATH_MAX
];

433 ià(
d’t2
->
d_Çme
[0] == '.')

436 
	`g_¡¾ıy
(
dœÇme2
, 
dœÇme
, (dirname2));

437 
	`g_¡¾ÿt
(
dœÇme2
, "/", (dirname2));

438 
	`g_¡¾ÿt
(
dœÇme2
, 
d’t2
->
d_Çme
, (dirname2));

439 
	`deviû_li¡_š£¹
(
dœÇme2
, 
d’t
->
d_Çme
, 
HOTPLUG_EVENT_SYSFS_DEVICE
);

441 
	`şo£dœ
(
dœ2
);

444 
	`şo£dœ
(
dœ
);

446 
	}
}

448 
	$sÿn_block
()

450 
DIR
 *
dœ
;

451 
dœ’t
 *
d’t
;

453 
dœ
 = 
	`İ’dœ
("/sys/block");

454 ià(
dœ
 !ğ
NULL
) {

455 
d’t
 = 
	`»addœ
(
dœ
); d’ˆ!ğ
NULL
; dent =„eaddir(dir)) {

456 
dœÇme
[
HAL_PATH_MAX
];

457 
DIR
 *
dœ2
;

458 
dœ’t
 *
d’t2
;

460 ià(
d’t
->
d_Çme
[0] == '.')

464 ià(
	`g_¡r_has_´efix
 (
d’t
->
d_Çme
, "md")) {

465 
	`HAL_INFO
 (("skpšg mdƒv’ˆfÜ %s", 
d’t
->
d_Çme
));

469 
	`g_¡¾ıy
(
dœÇme
, "/sys/block/", (dirname));

470 
	`g_¡¾ÿt
(
dœÇme
, 
d’t
->
d_Çme
, (dirname));

471 ià(
	`deviû_li¡_š£¹
(
dœÇme
, "block", 
HOTPLUG_EVENT_SYSFS_BLOCK
) != 0)

475 
dœ2
 = 
	`İ’dœ
(
dœÇme
);

476 ià(
dœ2
 !ğ
NULL
) {

477 
d’t2
 = 
	`»addœ
(
dœ2
); d’t2 !ğ
NULL
; dent2 =„eaddir(dir2)) {

478 
dœÇme2
[
HAL_PATH_MAX
];

480 ià(
d’t2
->
d_Çme
[0] == '.')

483 ià(!
	`¡rcmp
(
d’t2
->
d_Çme
,"device"))

485 
	`g_¡¾ıy
(
dœÇme2
, 
dœÇme
, (dirname2));

486 
	`g_¡¾ÿt
(
dœÇme2
, "/", (dirname2));

487 
	`g_¡¾ÿt
(
dœÇme2
, 
d’t2
->
d_Çme
, (dirname2));

488 
	`deviû_li¡_š£¹
(
dœÇme2
, "block", 
HOTPLUG_EVENT_SYSFS_BLOCK
);

490 
	`şo£dœ
(
dœ2
);

493 
	`şo£dœ
(
dœ
);

495 
	}
}

497 
	$sÿn_şass
()

499 
DIR
 *
dœ
;

500 
dœ’t
 *
d’t
;

502 
dœ
 = 
	`İ’dœ
("/sys/class");

503 ià(
dœ
 !ğ
NULL
) {

504 
d’t
 = 
	`»addœ
(
dœ
); d’ˆ!ğ
NULL
; dent =„eaddir(dir)) {

505 
dœÇme
[
HAL_PATH_MAX
];

506 
DIR
 *
dœ2
;

507 
dœ’t
 *
d’t2
;

509 ià(
d’t
->
d_Çme
[0] == '.')

512 
	`g_¡¾ıy
(
dœÇme
, "/sys/class/", (dirname));

513 
	`g_¡¾ÿt
(
dœÇme
, 
d’t
->
d_Çme
, (dirname));

514 
dœ2
 = 
	`İ’dœ
(
dœÇme
);

515 ià(
dœ2
 !ğ
NULL
) {

516 
d’t2
 = 
	`»addœ
(
dœ2
); d’t2 !ğ
NULL
; dent2 =„eaddir(dir2)) {

517 
dœÇme2
[
HAL_PATH_MAX
];

519 ià(
d’t2
->
d_Çme
[0] == '.')

521 ià(!
	`¡rcmp
(
d’t2
->
d_Çme
, "device"))

524 
	`g_¡¾ıy
(
dœÇme2
, 
dœÇme
, (dirname2));

525 
	`g_¡¾ÿt
(
dœÇme2
, "/", (dirname2));

526 
	`g_¡¾ÿt
(
dœÇme2
, 
d’t2
->
d_Çme
, (dirname2));

527 
	`deviû_li¡_š£¹
(
dœÇme2
, 
d’t
->
d_Çme
, 
HOTPLUG_EVENT_SYSFS_DEVICE
);

529 
	`şo£dœ
(
dœ2
);

532 
	`şo£dœ
(
dœ
);

534 
	}
}

536 
	$´oûss_cŞd¶ug_ev’ts
()

538 
GSLi¡
 *
dev
;

541 
dev
 = 
deviû_li¡
; dev !ğ
NULL
; dev = 
	`g_¦i¡_Ãxt
 (dev)) {

542 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

543 
sysfs_deviû
 *
sysfs_dev
 = 
dev
->
d©a
;

545 
hÙ¶ug_ev’t
 = 
	`cŞd¶ug_g‘_hÙ¶ug_ev’t
 (
sysfs_dev
->
·th
,

546 
sysfs_dev
->
subsy¡em
,

547 
sysfs_dev
->
ty³
);

548 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

549 
	`hÙ¶ug_ev’t_´oûss_queue
();

551 
	`g_ä“
 (
sysfs_dev
->
·th
);

552 
	`g_ä“
 (
sysfs_dev
->
subsy¡em
);

553 
	`g_¦iû_ä“
 (
sysfs_deviû
, 
sysfs_dev
);

556 
	`g_¦i¡_ä“
 (
deviû_li¡
);

557 
deviû_li¡
 = 
NULL
;

558 
	}
}

560 
	$_deviû_Üd”
 (cÚ¡ *
d1
, cÚ¡ *
d2
)

562 cÚ¡ 
sysfs_deviû
 *
dev1
 = 
d1
;

563 cÚ¡ 
sysfs_deviû
 *
dev2
 = 
d2
;

566 ià(
	`¡r¡r
 (
dev2
->
·th
, "/" 
DMPREFIX
))

568 ià(
	`¡r¡r
 (
dev1
->
·th
, "/" 
DMPREFIX
))

571  
	`¡rcmp
(
dev1
->
·th
, 
dev2
->path);

572 
	}
}

574 
gboŞ—n


575 
	$cŞd¶ug_syÁhesize_ev’ts
 ()

577 
¡©
 
¡©buf
;

579 ià(
	`h®_ut_š™_sysfs_to_udev_m­
 (è=ğ
FALSE
) {

580 
	`HAL_ERROR
 (("Unableo get sysfso dev map"));

581 
”rÜ
;

585 ià(
	`¡©
("/sys/subsy¡em", &
¡©buf
) == 0) {

586 
	`sÿn_subsy¡em
 ("subsystem");

587 
deviû_li¡
 = 
	`g_¦i¡_sÜt
 (deviû_li¡, 
_deviû_Üd”
);

588 
	`´oûss_cŞd¶ug_ev’ts
 ();

590 
	`sÿn_subsy¡em
 ("bus");

591 
deviû_li¡
 = 
	`g_¦i¡_sÜt
 (deviû_li¡, 
_deviû_Üd”
);

592 
	`´oûss_cŞd¶ug_ev’ts
 ();

594 
	`sÿn_şass
 ();

595 
	`sÿn_sšgË_bus
 ("mmc");

596 
	`sÿn_sšgË_bus
 ("bluetooth");

597 
deviû_li¡
 = 
	`g_¦i¡_sÜt
 (deviû_li¡, 
_deviû_Üd”
);

598 
	`´oûss_cŞd¶ug_ev’ts
 ();

601 ià(
	`¡©
("/sys/şass/block", &
¡©buf
) != 0) {

602 
	`sÿn_block
 ();

603 
deviû_li¡
 = 
	`g_¦i¡_sÜt
 (deviû_li¡, 
_deviû_Üd”
);

604 
	`´oûss_cŞd¶ug_ev’ts
 ();

608 
	`blockdev_´oûss_md¡©
 ();

611 
	`g_hash_bË_de¡roy
 (
sysfs_to_udev_m­
);

612 
	`g_ä“
 (
udevšfo_¡dout
);

613  
TRUE
;

615 
”rÜ
:

616  
FALSE
;

617 
	}
}

	@hald/linux/coldplug.h

26 #iâdeà
COLDPLUG_H


27 
	#COLDPLUG_H


	)

29 
	~<glib.h
>

31 
gboŞ—n
 
cŞd¶ug_syÁhesize_ev’ts
 ();

	@hald/linux/device.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<ùy³.h
>

31 
	~<lim™s.h
>

32 
	~<sys/sock‘.h
>

33 
	~<lšux/ty³s.h
>

34 
	~<lšux/if_¬p.h
>

35 
	~<¡dlib.h
>

36 
	~<¡ršg.h
>

37 
	~<¡dšt.h
>

38 
	~<sys/¡©.h
>

39 
	~<uni¡d.h
>

40 
	~<asm/by‹Üd”.h
>

41 
	~<fú.h
>

43 
	~"šput_loÿl.h
"

46 
	~<lšux/if.h
>

47 
	~<lšux/wœ–ess.h
>

49 
	~<dbus/dbus.h
>

50 
	~<dbus/dbus-glib.h
>

52 
	~"../deviû_šfo.h
"

53 
	~"../deviû_pm.h
"

54 
	~"../deviû_¡Üe.h
"

55 
	~"../h®d.h
"

56 
	~"../h®d_dbus.h
"

57 
	~"../h®d_ruÂ”.h
"

58 
	~"../logg”.h
"

59 
	~"../os¥ec.h
"

60 
	~"../ut.h
"

61 
	~"../ut_pm.h
"

62 
	~"../ids.h
"

64 
	~"cŞd¶ug.h
"

65 
	~"hÙ¶ug_h–³r.h
"

66 
	~"os¥ec_lšux.h
"

68 
	~"deviû.h
"

71 
gboŞ—n
 
	g_have_sysfs_lid_bu‰Ú
 = 
FALSE
;

72 
gboŞ—n
 
	g_have_sysfs_pow”_bu‰Ú
 = 
FALSE
;

73 
gboŞ—n
 
	g_have_sysfs_¦“p_bu‰Ú
 = 
FALSE
;

74 
gboŞ—n
 
	g_have_sysfs_pow”_suµly
 = 
FALSE
;

75 
gboŞ—n
 
	gb©‹ry_pŞl_ruÂšg
 = 
FALSE
;

77 
	#POWER_SUPPLY_BATTERY_POLL_INTERVAL
 30

	)

78 
	#DOCK_STATION_UNDOCK_POLL_INTERVAL
 300

	)

81 
	#BITS_PER_LONG
 ((è* 8)

	)

82 
	#NBITS
(
x
è((((x)-1)/
BITS_PER_LONG
)+1)

	)

83 
	#OFF
(
x
è((x)%
BITS_PER_LONG
)

	)

84 
	#BIT
(
x
è(1UL<<
	`OFF
(x))

	)

85 
	#LONG
(
x
è((x)/
BITS_PER_LONG
)

	)

86 
	#‹¡_b™
(
b™
, 
¬¿y
è(×¼ay[
	`LONG
(b™)] >> 
	`OFF
(b™)è& 1)

	)

92 
H®Deviû
 *

93 
	$backlight_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
physdev
,

94 cÚ¡ 
gch¬
 *
sysfs_·th_š_deviûs
)

96 
H®Deviû
 *
d
;

97 
max_brighŠess
;

98 cÚ¡ *
id
;

100 
d
 = 
	`h®_deviû_Ãw
 ();

101 
	`h®_deviû_add_ÿ·b™y
 (
d
, "laptop_panel");

102 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

103 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

104 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "laptop_panel");

105 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Generic Backlight Device");

106 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "laptop_panel.access_method", "general");

108 
id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

109 ià(
	`¡r¡r
(
id
, "aıi_video"è!ğ
NULL
) {

111 cÚ¡ *
·¿m
;

116 
·¿m
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 ("/sys/module/video/parameters/", "brightness_switch_enabled");

118 ià(
·¿m
 && !
	`¡rcmp
(param, "Y")) {

119 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "Ï±İ_·Ãl.brighŠess_š_h¬dw¬e", 
TRUE
);

121 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "Ï±İ_·Ãl.brighŠess_š_h¬dw¬e", 
FALSE
);

125 
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "max_brighŠess", &
max_brighŠess
, 10);

126 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "Ï±İ_·Ãl.num_Ëv–s", 
max_brighŠess
 + 1);

127  
d
;

128 
	}
}

130 
gboŞ—n


131 
	$backlight_compu‹_udi
 (
H®Deviû
 *
d
)

133 
gch¬
 
udi
[256];

135 
	`h®d_compu‹_udi
 (
udi
,  (udi),

137 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"));

138 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

139  
TRUE
;

140 
	}
}

144 
H®Deviû
 *

145 
	$blu‘oÙh_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
,

146 cÚ¡ 
gch¬
 *
·»Á_·th
)

148 
H®Deviû
 *
d
;

149 cÚ¡ *
ty³_’Œy
;

150 cÚ¡ *
addr_’Œy
;

151 
a5
, 
a4
, 
a3
, 
a2
, 
a1
, 
a0
;

152 
dbus_ušt64_t
 
add»ss
;

154 
d
 = 
NULL
;

156 ià(
·»Á_dev
 =ğ
NULL
) {

157 
out
;

160 
addr_’Œy
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "address");

161 ià(
addr_’Œy
 =ğ
NULL
)

162 
out
;

164 ià(
	`ssÿnf
 (
addr_’Œy
, "%x:%x:%x:%x:%x:%x", &
a5
, &
a4
, &
a3
, &
a2
, &
a1
, &
a0
) != 6) {

165 
out
;

167 
add»ss
 = ((
dbus_ušt64_t
)
a5
<<40) |

168 ((
dbus_ušt64_t
)
a4
<<32) |

169 ((
dbus_ušt64_t
)
a3
<<24) |

170 ((
dbus_ušt64_t
)
a2
<<16) |

171 ((
dbus_ušt64_t
)
a1
<< 8) |

172 ((
dbus_ušt64_t
)
a0
<< 0);

174 
ty³_’Œy
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "type");

175 ià(
ty³_’Œy
 =ğ
NULL
)

176 
out
;

178 
d
 = 
	`h®_deviû_Ãw
 ();

179 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

180 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

182 ià(
	`¡rcmp
 (
ty³_’Œy
, "ACL") == 0) {

183 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "bluetooth_acl");

184 
	`h®_deviû_add_ÿ·b™y
 (
d
, "bluetooth_acl");

185 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "blu‘oÙh_aş.add»ss", 
add»ss
);

186 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Bluetooth Asynchronous Connection-oriented Link");

187 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "blu‘oÙh_aş.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

189 } ià(
	`¡rcmp
 (
ty³_’Œy
, "SCO") == 0) {

190 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "bluetooth_sco");

191 
	`h®_deviû_add_ÿ·b™y
 (
d
, "bluetooth_sco");

192 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "blu‘oÙh_sco.add»ss", 
add»ss
);

193 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Bluetooth Synchronous Connection-oriented Link");

194 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "blu‘oÙh_sco.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

196 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "bluetooth_hci");

197 
	`h®_deviû_add_ÿ·b™y
 (
d
, "bluetooth_hci");

198 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Bluetooth Host Controller Interface");

199 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "blu‘oÙh_hci.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

200 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "blu‘oÙh_hci.add»ss", 
add»ss
);

203 
out
:

204  
d
;

205 
	}
}

207 
gboŞ—n


208 
	$blu‘oÙh_compu‹_udi
 (
H®Deviû
 *
d
)

210 
gch¬
 
udi
[256];

212 ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "bluetooth_acl")) {

213 
	`h®d_compu‹_udi
 (
udi
,  (udi),

215 
	`h®_deviû_´İ”ty_g‘_ušt64
 (
d
, "bluetooth_acl.address"));

216 } ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "bluetooth_sco")) {

217 
	`h®d_compu‹_udi
 (
udi
,  (udi),

219 
	`h®_deviû_´İ”ty_g‘_ušt64
 (
d
, "bluetooth_acl.address"));

221 
	`h®d_compu‹_udi
 (
udi
,  (udi),

223 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

224 
	`h®_deviû_´İ”ty_g‘_ušt64
 (
d
, "bluetooth_hci.address"));

226 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

227  
TRUE
;

228 
	}
}

232 #ifdeà
USE_S390


233 
šlše
 

234 
	$ccw_add_dasd_´İ”t›s
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
sysfs_·th
)

236 cÚ¡ 
gch¬
 *
disc
;

238 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccw.dasd.u£_dŸg", 
sysfs_·th
,

240 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccw.dasd.»adÚly", 
sysfs_·th
,

242 
disc
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "discipline");

243 ià(
disc
)

244 
	`h®_deviû_´İ”ty_£t_¡ršg
(
d
, "ccw.dasd.disclše", 
disc
);

245 
	}
}

247 
šlše
 

248 
	$ccw_add_zfı_´İ”t›s
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
sysfs_·th
)

250 
Úlše
;

253 ià(!
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "Úlše", &
Úlše
, 2))

255 ià(!
Úlše
)

258 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccw.zfı.š_»cov”y", 
sysfs_·th
,

260 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccw.zfı.çed", 
sysfs_·th
,

262 
	}
}

264 
šlše
 

265 
	$ccw_add_³_´İ”t›s
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
sysfs_·th
)

267 
medium_¡©e
, 
Úlše
;

269 cÚ¡ 
gch¬
 *
¡©e_‹xt
[3] = {"unknown", "loaded", "no medium"};

271 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccw.³.¡©e", 
sysfs_·th
, "state");

272 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccw.³.İ”©iÚ", 
sysfs_·th
,

275 ià(!
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "Úlše", &
Úlše
, 2))

277 ià(!
Úlše
)

279 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccw.³.blocksize", 
sysfs_·th
,

281 ià(!
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "medium_state",

282 &
medium_¡©e
, 10))

284 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "ccw.tape.medium_state",

285 
¡©e_‹xt
[
medium_¡©e
]);

286 
	}
}

288 
šlše
 

289 
	$ccw_add_3270_´İ”t›s
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
sysfs_·th
)

291 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccw.3270.mod–", 
sysfs_·th
,

293 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccw.3270.rows", 
sysfs_·th
, "rows", 10);

294 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccw.3270.cŞumns", 
sysfs_·th
,

296 
	}
}

298 
H®Deviû
 *

299 
	$ccw_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

301 
H®Deviû
 *
d
;

302 cÚ¡ 
gch¬
 *
bus_id
;

303 cÚ¡ 
gch¬
 *
pim·mpom
;

304 
pim
, 
·m
, 
pom
;

305 cÚ¡ 
gch¬
 *
chpids
;

306 
chpid
[8];

307 
gch¬
 
©Œ
[25];

308 
i
;

309 
gch¬
 
driv”_Çme
[256];

311 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

313 
d
 = 
	`h®_deviû_Ãw
 ();

314 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

315 ià(
·»Á_dev
 !ğ
NULL
)

316 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

318 
h®_deviû_´İ”ty_£t_¡ršg


319 (
d
, "info.parent",

322 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

324 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "ccw.bus_id", 
bus_id
);

325 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccw.Úlše", 
sysfs_·th
, "online", 2);

326 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccw.avaabl™y", 
sysfs_·th
,

328 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccw.cmb_’abË", 
sysfs_·th
,

330 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccw.cuty³", 
sysfs_·th
, "cutype");

331 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccw.devty³", 
sysfs_·th
, "devtype");

334 
pim·mpom
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "../pimpampom");

335 ià(
pim·mpom
) {

336 
	`ssÿnf
 (
pim·mpom
, "%x %x %x", &
pim
, &
·m
, &
pom
);

337 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "ccw.subchªÃl.pim", 
pim
);

338 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "ccw.subchªÃl.·m", 
·m
);

339 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "ccw.subchªÃl.pom", 
pom
);

342 
chpids
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "../chpids");

343 ià(
chpids
) {

344 
	`ssÿnf
 (
chpids
, "%x %x %x %x %x %x %x %x", &
chpid
[0], &chpid[1],

345 &
chpid
[2], &chpid[3], &chpid[4], &chpid[5], &chpid[6],

346 &
chpid
[7]);

347 
i
=0; i<8 && (
chpid
[i] != 0); i++) {

348 
	`g_¢´štf
 (
©Œ
,  (attr),

349 "ccw.subchªÃl.chpid%x", 
i
);

350 
	`h®_deviû_´İ”ty_£t_št
 (
d
, 
©Œ
, 
chpid
[
i
]);

355 ià(
	`h®_ut_g‘_driv”_Çme
 (
sysfs_·th
, 
driv”_Çme
)) {

356 ià(!
	`¡ºcmp
 (
driv”_Çme
, "dasd", 4))

358 
	`ccw_add_dasd_´İ”t›s
 (
d
, 
sysfs_·th
);

359 ià(!
	`¡ºcmp
 (
driv”_Çme
, "zfcp", 4))

360 
	`ccw_add_zfı_´İ”t›s
 (
d
, 
sysfs_·th
);

361 ià(!
	`¡ºcmp
 (
driv”_Çme
, "tape_3", 6))

363 
	`ccw_add_³_´İ”t›s
 (
d
, 
sysfs_·th
);

364 ià(!
	`¡ºcmp
 (
driv”_Çme
, "3270", 4))

365 
	`ccw_add_3270_´İ”t›s
 (
d
, 
sysfs_·th
);

367  
d
;

368 
	}
}

370 
gboŞ—n


371 
	$ccw_compu‹_udi
 (
H®Deviû
 *
d
)

373 
gch¬
 
udi
[256];

375 
	`h®d_compu‹_udi
 (
udi
,  (udi),

377 
h®_deviû_´İ”ty_g‘_¡ršg


378 (
d
, "ccw.bus_id"));

379 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

380  
TRUE
;

382 
	}
}

386 
šlše
 

387 
	$ccwgroup_add_q‘h_´İ”t›s
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
sysfs_·th
)

389 
is_Ïy”2
;

392 
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "Ïy”2", &
is_Ïy”2
, 2);

394 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.qeth.large_send",

395 
sysfs_·th
, "large_send");

396 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.q‘h.ÿrd_ty³", 
sysfs_·th
,

398 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.qeth.checksumming",

399 
sysfs_·th
, "checksumming");

400 ià(!
is_Ïy”2
) {

402 
	`h®_ut_£t_št_äom_fe
 (
d
,

404 
sysfs_·th
, "canonical_macaddr", 2);

405 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
,

407 
sysfs_·th
, "broadcast_mode");

408 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccwgroup.qeth.fake_broadcast",

409 
sysfs_·th
, "fake_broadcast", 2);

410 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccwgroup.qeth.fake_ll",

411 
sysfs_·th
, "fake_ll", 2);

413 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "ccwgroup.q‘h.Ïy”2", 
is_Ïy”2
);

414 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.q‘h.pÜŠame", 
sysfs_·th
,

416 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccwgroup.q‘h.pÜŠo", 
sysfs_·th
,

418 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccwgroup.q‘h.bufãr_couÁ", 
sysfs_·th
,

420 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccwgroup.q‘h.add_hhËn", 
sysfs_·th
,

422 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.qeth.priority_queueing",

423 
sysfs_·th
, "priority_queueing");

424 ià(!
is_Ïy”2
) {

425 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.qeth.route4",

426 
sysfs_·th
, "route4");

427 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.qeth.route6",

428 
sysfs_·th
, "route6");

430 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.q‘h.¡©e", 
sysfs_·th
,

432 
	}
}

434 
šlše
 

435 
	$ccwgroup_add_ùc_´İ”t›s
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
sysfs_·th
)

438 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccwgroup.ùc.´ÙocŞ", 
sysfs_·th
,

440 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.ùc.ty³", 
sysfs_·th
,

442 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccwgroup.ùc.bufãr", 
sysfs_·th
,

444 
	}
}

446 
šlše
 

447 
	$ccwgroup_add_lcs_´İ”t›s
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
sysfs_·th
)

449 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccwgroup.lcs.pÜŠumb”", 
sysfs_·th
,

451 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.lcs.ty³", 
sysfs_·th
,

453 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccwgroup.lcs.lancmd_timeout",

454 
sysfs_·th
, "lancmd_timeout", 10);

455 
	}
}

457 
šlše
 

458 
	$ccwgroup_add_şaw_´İ”t›s
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
sysfs_·th
)

460 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.şaw.­i_ty³", 
sysfs_·th
,

462 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.claw.adapter_name",

463 
sysfs_·th
, "adapter_name");

464 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "ccwgroup.şaw.ho¡_Çme", 
sysfs_·th
,

466 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccwgroup.şaw.»ad_bufãr", 
sysfs_·th
,

468 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccwgroup.şaw.wr™e_bufãr", 
sysfs_·th
,

470 
	}
}

472 
H®Deviû
 *

473 
	$ccwgroup_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

475 
H®Deviû
 *
d
;

476 cÚ¡ 
gch¬
 *
bus_id
;

477 
gch¬
 
driv”_Çme
[256];

479 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

481 
d
 = 
	`h®_deviû_Ãw
 ();

482 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

483 ià(
·»Á_dev
 !ğ
NULL
)

484 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

486 
h®_deviû_´İ”ty_£t_¡ršg


487 (
d
, "info.parent",

490 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

492 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "ccwgroup.bus_id", 
bus_id
);

493 
	`h®_ut_£t_št_äom_fe
 (
d
, "ccwgroup.Úlše", 
sysfs_·th
,

497 ià(
	`h®_ut_g‘_driv”_Çme
 (
sysfs_·th
, 
driv”_Çme
)) {

498 ià(!
	`¡ºcmp
 (
driv”_Çme
, "qeth", 4))

499 
	`ccwgroup_add_q‘h_´İ”t›s
 (
d
, 
sysfs_·th
);

500 ià(!
	`¡ºcmp
 (
driv”_Çme
, "ctc", 3))

501 
	`ccwgroup_add_ùc_´İ”t›s
 (
d
, 
sysfs_·th
);

502 ià(!
	`¡ºcmp
 (
driv”_Çme
, "lcs", 3))

503 
	`ccwgroup_add_lcs_´İ”t›s
 (
d
, 
sysfs_·th
);

504 ià(!
	`¡ºcmp
 (
driv”_Çme
, "claw", 4))

505 
	`ccwgroup_add_şaw_´İ”t›s
 (
d
, 
sysfs_·th
);

507  
d
;

508 
	}
}

510 
gboŞ—n


511 
	$ccwgroup_compu‹_udi
 (
H®Deviû
 *
d
)

513 
gch¬
 
udi
[256];

515 
	`h®d_compu‹_udi
 (
udi
,  (udi),

517 
h®_deviû_´İ”ty_g‘_¡ršg


518 (
d
, "ccwgroup.bus_id"));

519 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

520  
TRUE
;

522 
	}
}

527 
H®Deviû
 *

528 
	$drm_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

530 
H®Deviû
 *
d
 = 
NULL
;

532 
d
 = 
	`h®_deviû_Ãw
 ();

534 
	`h®_deviû_add_ÿ·b™y
 (
d
, "drm");

536 ià(
·»Á_dev
 !ğ
NULL
) {

537 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

538 
	`h®_deviû_cİy_´İ”ty
Ğ
·»Á_dev
, "šfo.v’dÜ", 
d
, "info.vendor");

540 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

543 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Direct Rendering Manager Device");

544 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "drm");

545 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.deviû_fe", 
deviû_fe
);

546 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

548 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

549 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "drm.dri_lib¿ry", 
sysfs_·th
, "dri_library_name");

550 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "drm.v”siÚ", 
sysfs_·th
, "../version");

552  
d
;

553 
	}
}

555 
gboŞ—n


556 
	$drm_compu‹_udi
 (
H®Deviû
 *
d
)

558 
gch¬
 
udi
[256];

559 cÚ¡ *
dœ
;

560 cÚ¡ *
Çme
;

562 
dœ
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.sysfs_path");

564 
Çme
 = 
	`h®_ut_g‘_Ï¡_–em’t
(
dœ
);

567 
	`h®d_compu‹_udi
 (
udi
,  (udi),

569 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

570 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "drm.dri_library"),

571 
Çme
);

573 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

575  
TRUE
;

576 
	}
}

580 
H®Deviû
 *

581 
	$dvb_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

583 
H®Deviû
 *
d
;

585 
d
 = 
NULL
;

587 ià(
·»Á_dev
 =ğ
NULL
 || 
·»Á_·th
 == NULL)

588 
out
;

590 
d
 = 
	`h®_deviû_Ãw
 ();

591 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

592 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

593 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "dvb");

594 
	`h®_deviû_add_ÿ·b™y
 (
d
, "dvb");

595 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "DVB Device");

596 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "dvb.deviû", 
deviû_fe
);

598 
out
:

599  
d
;

600 
	}
}

602 
gboŞ—n


603 
	$dvb_compu‹_udi
 (
H®Deviû
 *
d
)

605 
gch¬
 
udi
[256];

607 
	`h®d_compu‹_udi
 (
udi
,  (udi), "%s_dvb",

608 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"));

609 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

611  
TRUE
;

612 
	}
}

616 #ifdeà
USE_FIREWIRE


617 
H®Deviû
 *

618 
	$fœewœe_add_deviû
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
)

620 
H®Deviû
 *
d
 = 
NULL
;

621 
gch¬
 
buf
[64];

623 ià(
deviû_fe
 =ğ
NULL
 || device_file[0] == '\0')

624 
out
;

626 
d
 = 
	`h®_deviû_Ãw
 ();

627 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

628 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.subsystem", "ieee1394");

629 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

630 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ieee1394");

631 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "›“1394.deviû", 
deviû_fe
);

632 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

634 
	`h®_ut_£t_ušt64_äom_fe
 (
d
, "›“1394.guid", 
sysfs_·th
, "guid", 16);

635 
	`h®_ut_£t_št_äom_fe
 (
d
, "›“1394.v’dÜ_id", 
sysfs_·th
, "vendor", 16);

636 
	`h®_ut_£t_št_äom_fe
 (
d
, "›“1394.´oduù_id", 
sysfs_·th
, "model", 16);

637 
	`h®_ut_£t_št_äom_fe
 (
d
, "›“1394.h¬w¬e_v”siÚ", 
sysfs_·th
, "harware_version", 16);

639 ià(!
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "›“1394.v’dÜ", 
sysfs_·th
, "vendor_name")) {

643 
	`g_¢´štf
 (
buf
,  (buf), "Unknown (0x%06x)",

644 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "ieee1394.vendor_id"));

645 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "›“1394.v’dÜ", 
buf
);

648 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "›“1394.´oduù", 
sysfs_·th
, "model_name");

650 
out
:

651  
d
;

652 
	}
}

654 
H®Deviû
 *

655 
	$fœewœe_add_un™
 (cÚ¡ 
gch¬
 *
sysfs_·th
, 
un™_id
, 
H®Deviû
 *
·»Á_dev
)

657 
¥ecif›r_id
;

658 
v”siÚ
;

659 
H®Deviû
 *
d
;

661 
d
 = 
	`h®_deviû_Ãw
 ();

662 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

663 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.subsystem", "ieee1394_unit");

664 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent",

665 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

666 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "ieee1394_unit.originating_device",

667 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

668 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "›“1394_un™.un™_šdex", 
un™_id
);

669 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ieee1394_unit");

670 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

672 
	`h®_ut_£t_št_äom_fe
 (
d
, "›“1394.v’dÜ_id", 
sysfs_·th
, "../vendor_id", 16);

673 
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "¥ecif›r_id", &
¥ecif›r_id
, 16);

674 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "›“1394_un™.¥ecif›r_id", 
¥ecif›r_id
);

675 
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "v”siÚ", &
v”siÚ
, 16);

676 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "›“1394_un™.v”siÚ", 
v”siÚ
);

678 ià(
¥ecif›r_id
 =ğ0x00609&& 
v”siÚ
 == 0x010483) {

679 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ieee1394_unit.sbp2");

680 } ià(
¥ecif›r_id
 == 0x00a02d) {

681 ià((
v”siÚ
 & 0xffff00) == 0x000100)

682 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ieee1394_unit.iidc");

683 ià((
v”siÚ
 & 0xff0001) == 0x010001)

684 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ieee1394_unit.avc");

685 ià((
v”siÚ
 & 0xff0002) == 0x010002)

686 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ieee1394_unit.cal");

687 ià((
v”siÚ
 & 0xff0004) == 0x010004)

688 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ieee1394_unit.ehs");

689 ià((
v”siÚ
 & 0xff0004) == 0x010008)

690 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ieee1394_unit.havi");

691 } ià(
¥ecif›r_id
 =ğ0x000b09d && 
v”siÚ
 == 0x800002) {

693 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ieee1394_unit.iidc");

696  
d
;

697 
	}
}

699 
H®Deviû
 *

700 
	$fœewœe_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

702 
deviû_id
;

703 
un™_id
;

704 cÚ¡ *
bus_id
;

706 ià(
·»Á_dev
 =ğ
NULL
)

707  
NULL
;

709 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

711 ià(
	`ssÿnf
 (
bus_id
, "fw%d.%d", &
deviû_id
, &
un™_id
) == 2 ) {

712  
	`fœewœe_add_un™
 (
sysfs_·th
, 
un™_id
, 
·»Á_dev
);

713 } ià(
	`ssÿnf
 (
bus_id
, "fw%d", &
deviû_id
) == 1) {

714  
	`fœewœe_add_deviû
 (
sysfs_·th
, 
deviû_fe
, 
·»Á_dev
);

716  
NULL
;

718 
	}
}

720 cÚ¡ 
gch¬
 *

721 
	$fœewœe_g‘_´ob”
 (
H®Deviû
 *
d
)

723 cÚ¡ *
´ob”
 = 
NULL
;

726 ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "ieee1394_unit.avc")) {

727 
´ob”
 = "hald-probe-ieee1394-unit";

730  
´ob”
;

731 
	}
}

733 
gboŞ—n


734 
	$fœewœe_po¡_´obšg
 (
H®Deviû
 *
d
)

736  
TRUE
;

737 
	}
}

740 
gboŞ—n


741 
	$fœewœe_compu‹_udi
 (
H®Deviû
 *
d
)

743 
gch¬
 
udi
[256];

745 ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "ieee1394")) {

746 
	`h®d_compu‹_udi
 (
udi
,  (udi),

748 
	`h®_deviû_´İ”ty_g‘_ušt64
 (
d
, "ieee1394.guid"));

750 
	`h®d_compu‹_udi
 (
udi
,  (udi),

752 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "ieee1394_unit.originating_device"),

753 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "ieee1394_unit.unit_index"));

756 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

757  
TRUE
;

759 
	}
}

765 
H®Deviû
 *

766 
	$ide_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

768 
H®Deviû
 *
d
;

769 cÚ¡ 
gch¬
 *
bus_id
;

770 
gušt
 
ho¡
, 
chªÃl
;

772 
d
 = 
	`h®_deviû_Ãw
 ();

773 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

774 ià(
·»Á_dev
 !ğ
NULL
) {

775 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

777 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

780 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

782 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

784 
	`ssÿnf
 (
bus_id
, "%d.%d", &
ho¡
, &
chªÃl
);

785 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "ide.ho¡", 
ho¡
);

786 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "ide.chªÃl", 
chªÃl
);

788 ià(
chªÃl
 == 0) {

789 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "IDE device (master)");

791 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "IDE device (slave)");

794  
d
;

795 
	}
}

797 
gboŞ—n


798 
	$ide_compu‹_udi
 (
H®Deviû
 *
d
)

800 
gch¬
 
udi
[256];

802 
	`h®d_compu‹_udi
 (
udi
,  (udi),

804 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

805 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "ide.host"),

806 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "ide.channel"));

807 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

809  
TRUE
;

811 
	}
}

815 #ifdeà
USE_FIREWIRE


816 
H®Deviû
 *

817 
	$›“1394_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

819 
H®Deviû
 *
d
;

820 
guid
;

821 
gšt
 
ho¡_id
;

822 cÚ¡ 
gch¬
 *
bus_id
;

823 
gch¬
 
buf
[64];

825 
d
 = 
NULL
;

827 ià(
·»Á_dev
 =ğ
NULL
)

828 
out
;

831 ià(
	`¡r¡r
(
sysfs_·th
, "/şass/"è!ğ
NULL
)

832 
out
;

834 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

836 ià(
	`ssÿnf
 (
bus_id
, "fw-ho¡%d", &
ho¡_id
) == 1)

837 
out
;

839 ià(
	`ssÿnf
 (
bus_id
, "%Îx-%d", &
guid
, &
ho¡_id
) !=2 )

840 
out
;

842 
d
 = 
	`h®_deviû_Ãw
 ();

843 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

844 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

846 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

848 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "›“1394.guid", 
guid
);

849 
	`h®_ut_£t_št_äom_fe
 (
d
, "›“1394.v’dÜ_id", 
sysfs_·th
, "../vendor_id", 16);

850 
	`h®_ut_£t_št_äom_fe
 (
d
, "›“1394.¥ecif›r_id", 
sysfs_·th
, "specifier_id", 16);

851 
	`h®_ut_£t_št_äom_fe
 (
d
, "›“1394.v”siÚ", 
sysfs_·th
, "version", 16);

853 ià(!
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "›“1394.v’dÜ", 
sysfs_·th
, "../vendor_oui")) {

854 
	`g_¢´štf
 (
buf
,  (buf), "Unknown (0x%06x)",

855 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "ieee1394.vendor_id"));

856 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "›“1394.v’dÜ", 
buf
);

860 ià(
	`h®_ut_£t_št_äom_fe
 (
d
, "›“1394.´oduù_id", 
sysfs_·th
, "model_id", 16)) {

861 ià(!
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "›“1394.´oduù", 
sysfs_·th
, "model_name_kv")) {

862 
	`g_¢´štf
 (
buf
,  (buf), "Unknown (0x%06x)",

863 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "ieee1394.product_id"));

864 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "›“1394.´oduù", 
buf
);

867 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "ieee1394.product_id", 0x000000);

868 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "ieee1394.product",

869 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "ieee1394.vendor"));

872 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.vendor",

873 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "ieee1394.vendor"));

874 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product",

875 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "ieee1394.product"));

877 
out
:

878  
d
;

879 
	}
}

881 
gboŞ—n


882 
	$›“1394_compu‹_udi
 (
H®Deviû
 *
d
)

884 
gch¬
 
udi
[256];

886 
	`h®d_compu‹_udi
 (
udi
,  (udi),

888 
	`h®_deviû_´İ”ty_g‘_ušt64
 (
d
, "ieee1394.guid"));

889 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

890  
TRUE
;

892 
	}
}

898 
	$šput_¡r_to_b™mask
 (cÚ¡ *
s
, *
b™mask
, 
size_t
 
max_size
)

900 
i
, 
j
;

901 
gch¬
 **
v
;

902 
num_b™s_£t
 = 0;

904 
	`mem£t
 (
b™mask
, 0, 
max_size
);

905 
v
 = 
	`g_¡r¥l™
 (
s
, " ", 
max_size
);

906 
i
 = 
	`g_¡rv_Ëngth
 (
v
è- 1, 
j
 = 0; i >= 0; i--, j++) {

907 
v®
;

909 
v®
 = 
	`¡¹oul
 (
v
[
i
], 
NULL
, 16);

910 
b™mask
[
j
] = 
v®
;

912 
v®
 != 0) {

913 
num_b™s_£t
++;

914 
v®
 &= (val - 1);

917 
	`g_¡rä“v
(
v
);

919  
num_b™s_£t
;

920 
	}
}

923 
	$šput_‹¡_»l
 (
H®Deviû
 *
d
, cÚ¡ *
sysfs_·th
)

925 *
s
;

926 
b™mask
[
	`NBITS
(
REL_MAX
)];

927 
num_b™s
;

929 
s
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "capabilities/rel");

930 ià(
s
 =ğ
NULL
)

931 
out
;

933 
num_b™s
 = 
	`šput_¡r_to_b™mask
 (
s
, 
b™mask
,  (bitmask));

936 ià(
	`‹¡_b™
 (
REL_X
, 
b™mask
è&&e¡_b™ (
REL_Y
, bitmask)) {

937 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.mouse");

939 
out
:

941 
	}
}

943 
gboŞ—n


944 
	$šput_‹¡_keybßrd
 (*
b™mask
)

946 
i
;

948 
i
 = 
KEY_Q
; i <ğ
KEY_P
; i++) {

949 ià(!
	`‹¡_b™
 (
i
, 
b™mask
))

950  
FALSE
;

953  
TRUE
;

954 
	}
}

956 
gboŞ—n


957 
	$šput_‹¡_key·d
 (*
b™mask
)

959 
i
;

961 
i
 = 
KEY_KP7
; i <ğ
KEY_KPDOT
; i++) {

962 ià(!
	`‹¡_b™
 (
i
, 
b™mask
))

963  
FALSE
;

966  
TRUE
;

967 
	}
}

969 
gboŞ—n


970 
	$šput_‹¡_keys
 (*
b™mask
)

972 
i
;

975 
i
 = 
KEY_RESERVED
 + 1; i < 
BTN_MISC
; i++) {

976 ià(
	`‹¡_b™
 (
i
, 
b™mask
))

977  
TRUE
;

980  
FALSE
;

981 
	}
}

984 
	$šput_‹¡_key
 (
H®Deviû
 *
d
, cÚ¡ *
sysfs_·th
)

986 *
s
;

987 
b™mask
[
	`NBITS
(
KEY_MAX
)];

988 
num_b™s
;

990 
s
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "capabilities/key");

991 ià(
s
 =ğ
NULL
)

992 
out
;

994 
num_b™s
 = 
	`šput_¡r_to_b™mask
 (
s
, 
b™mask
,  (bitmask));

996 ià(
num_b™s
 == 1) {

1001 
	`h®_deviû_add_ÿ·b™y
 (
d
, "button");

1002 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "bu‰Ú.has_¡©e", 
FALSE
);

1003 ià(
	`‹¡_b™
 (
KEY_POWER
, 
b™mask
)) {

1004 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "button.type", "power");

1005 
_have_sysfs_pow”_bu‰Ú
 = 
TRUE
;

1006 } ià(
	`‹¡_b™
 (
KEY_SLEEP
, 
b™mask
)) {

1007 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "button.type", "sleep");

1008 
_have_sysfs_¦“p_bu‰Ú
 = 
TRUE
;

1009 } ià(
	`‹¡_b™
 (
KEY_SUSPEND
, 
b™mask
)) {

1010 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "button.type", "hibernate");

1013 
gboŞ—n
 
is_keybßrd
 = 
	`šput_‹¡_keybßrd
 (
b™mask
);

1014 
gboŞ—n
 
is_key·d
 = 
	`šput_‹¡_key·d
 (
b™mask
);

1016 ià(
is_keybßrd
)

1017 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.keyboard");

1018 ià(
is_key·d
)

1019 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.keypad");

1021 ià(
is_keybßrd
 || 
is_key·d
 || 
	`šput_‹¡_keys
 (
b™mask
))

1022 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.keys");

1024 
out
:

1026 
	}
}

1029 
	$šput_couÁ_jack_sw™ches
 (*
b™mask
)

1031 
jack_sw
[] = {

1032 
SW_HEADPHONE_INSERT
,

1033 
SW_MICROPHONE_INSERT
,

1034 
SW_LINEOUT_INSERT
,

1035 
SW_VIDEOOUT_INSERT
,

1036 
SW_JACK_PHYSICAL_INSERT
,

1038 
i
, 
found
 = 0;

1040 
i
 = 0; i < ()( (
jack_sw
) /  (jack_sw[0])); i++)

1041 ià(
	`‹¡_b™
 (
jack_sw
[
i
], 
b™mask
))

1042 
found
++;

1044  
found
;

1045 
	}
}

1048 
	$šput_‹¡_sw™ch
 (
H®Deviû
 *
d
, cÚ¡ *
sysfs_·th
)

1050 *
s
;

1051 
b™mask
[
	`NBITS
(
SW_MAX
)];

1052 
num_b™s
;

1054 
s
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "capabilities/sw");

1055 ià(
s
 =ğ
NULL
)

1056 
out
;

1058 
num_b™s
 = 
	`šput_¡r_to_b™mask
 (
s
, 
b™mask
,  (bitmask));

1059 ià(
num_b™s
 <= 0)

1060 
out
;

1062 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.switch");

1063 ià(
num_b™s
 =ğ1 ||‚um_b™ =ğ
	`šput_couÁ_jack_sw™ches
 (
b™mask
)) {

1064 
gboŞ—n
 
is_jack_sw™ch
 = 
FALSE
;

1066 
	`h®_deviû_add_ÿ·b™y
 (
d
, "button");

1067 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "bu‰Ú.has_¡©e", 
TRUE
);

1069 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "bu‰Ú.¡©e.v®ue", 
FALSE
);

1070 ià(
	`‹¡_b™
 (
SW_LID
, 
b™mask
)) {

1071 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "button.type", "lid");

1072 
_have_sysfs_lid_bu‰Ú
 = 
TRUE
;

1073 } ià(
	`‹¡_b™
 (
SW_TABLET_MODE
, 
b™mask
)) {

1074 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "button.type", "tablet_mode");

1075 } ià(
	`‹¡_b™
 (
SW_RFKILL_ALL
, 
b™mask
)) {

1076 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "button.type", "radio");

1079 ià(
	`‹¡_b™
 (
SW_HEADPHONE_INSERT
, 
b™mask
)) {

1080 
is_jack_sw™ch
 = 
TRUE
;

1081 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.jack.headphone");

1083 ià(
	`‹¡_b™
 (
SW_MICROPHONE_INSERT
, 
b™mask
)) {

1084 
is_jack_sw™ch
 = 
TRUE
;

1085 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.jack.microphone");

1087 ià(
	`‹¡_b™
 (
SW_LINEOUT_INSERT
, 
b™mask
)) {

1088 
is_jack_sw™ch
 = 
TRUE
;

1089 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.jack.lineout");

1091 ià(
	`‹¡_b™
 (
SW_VIDEOOUT_INSERT
, 
b™mask
)) {

1092 
is_jack_sw™ch
 = 
TRUE
;

1093 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.jack.videoout");

1095 ià(
	`‹¡_b™
 (
SW_JACK_PHYSICAL_INSERT
, 
b™mask
)) {

1099 
is_jack_sw™ch
 = 
TRUE
;

1102 ià(
is_jack_sw™ch
) {

1103 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.jack");

1104 
	`h®_deviû_´İ”ty_£t_¡¾i¡
 (
d
, "šput.jack.ty³", 
NULL
);

1105 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "button.type", "jack_insert");

1109 
out
:

1111 
	}
}

1114 
	$šput_‹¡_abs
 (
H®Deviû
 *
d
, cÚ¡ *
sysfs_·th
)

1116 *
s
;

1117 
b™mask_abs
[
	`NBITS
(
ABS_MAX
)];

1118 
b™mask_key
[
	`NBITS
(
KEY_MAX
)];

1119 
num_b™s_abs
;

1120 
num_b™s_key
;

1122 
s
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "capabilities/abs");

1123 ià(
s
 =ğ
NULL
)

1124 
out
;

1125 
num_b™s_abs
 = 
	`šput_¡r_to_b™mask
 (
s
, 
b™mask_abs
,  (bitmask_abs));

1127 ià(
	`‹¡_b™
 (
ABS_X
, 
b™mask_abs
è&&e¡_b™ (
ABS_Y
, bitmask_abs)) {

1129 
s
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "capabilities/key");

1130 ià(
s
 !ğ
NULL
)

1132 
num_b™s_key
 = 
	`šput_¡r_to_b™mask
 (
s
, 
b™mask_key
,  (bitmask_key));

1134 ià(
	`‹¡_b™
 (
BTN_STYLUS
, 
b™mask_key
)) {

1135 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.tablet");

1136 
out
;

1139 ià(
	`‹¡_b™
 (
BTN_TOUCH
, 
b™mask_key
)) {

1140 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.touchpad");

1141 
out
;

1144 ià(
	`‹¡_b™
 (
BTN_TRIGGER
, 
b™mask_key
è||e¡_b™ (
BTN_A
, b™mask_keyè||e¡_b™ (
BTN_1
, bitmask_key)) {

1145 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.joystick");

1146 
out
;

1149 ià(
	`‹¡_b™
 (
BTN_MOUSE
, 
b™mask_key
)) {

1154 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.mouse");

1155 
out
;

1159 ià(
	`‹¡_b™
 (
ABS_PRESSURE
, 
b™mask_abs
)) {

1160 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input.touchpad");

1161 
out
;

1164 
out
:

1166 
	}
}

1168 
H®Deviû
 *

1169 
	$šput_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

1171 
ev’tdev_num
;

1172 
H®Deviû
 *
d
;

1173 *
©Œ_sysfs_·th
;

1175 
d
 = 
NULL
;

1176 
©Œ_sysfs_·th
 = 
NULL
;

1178 ià(
deviû_fe
 =ğ
NULL
 || device_file[0] == '\0')

1179 
out
;

1182 ià(
	`ssÿnf
 (
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
), "ev’t%d", &
ev’tdev_num
) != 1)

1183 
out
;

1188 
©Œ_sysfs_·th
 = 
	`g_¡rdup_´štf
 ("%s/../ÿ·b™›s", 
sysfs_·th
);

1189 ià(
	`g_fe_‹¡
 (
©Œ_sysfs_·th
, 
G_FILE_TEST_EXISTS
 | 
G_FILE_TEST_IS_DIR
)) {

1190 
	`g_ä“
 (
©Œ_sysfs_·th
);

1191 
©Œ_sysfs_·th
 = 
	`g_¡rdup_´štf
 ("%s/../", 
sysfs_·th
);

1193 
	`g_ä“
 (
©Œ_sysfs_·th
);

1194 
©Œ_sysfs_·th
 = 
	`g_¡rdup_´štf
 ("%s/deviû/ÿ·b™›s", 
sysfs_·th
);

1195 ià(
	`g_fe_‹¡
 (
©Œ_sysfs_·th
, 
G_FILE_TEST_EXISTS
 | 
G_FILE_TEST_IS_DIR
)) {

1196 
	`g_ä“
 (
©Œ_sysfs_·th
);

1197 
©Œ_sysfs_·th
 = 
	`g_¡rdup_´štf
 ("%s/deviû/", 
sysfs_·th
);

1199 
out
;

1203 
d
 = 
	`h®_deviû_Ãw
 ();

1204 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

1205 ià(
·»Á_dev
 !ğ
NULL
) {

1206 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šput.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1207 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1209 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

1211 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "input");

1212 
	`h®_deviû_add_ÿ·b™y
 (
d
, "input");

1214 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šput.deviû", 
deviû_fe
);

1216 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "šfo.´oduù", 
©Œ_sysfs_·th
, "name");

1217 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "šput.´oduù", 
©Œ_sysfs_·th
, "name");

1220 
	`šput_‹¡_key
 (
d
, 
©Œ_sysfs_·th
);

1223 
	`šput_‹¡_»l
 (
d
, 
©Œ_sysfs_·th
);

1226 
	`šput_‹¡_abs
 (
d
, 
©Œ_sysfs_·th
);

1229 
	`šput_‹¡_sw™ch
 (
d
, 
©Œ_sysfs_·th
);

1231 
out
:

1232 
	`g_ä“
 (
©Œ_sysfs_·th
);

1233  
d
;

1234 
	}
}

1236 cÚ¡ 
gch¬
 *

1237 
	$šput_g‘_´ob”
 (
H®Deviû
 *
d
)

1239 cÚ¡ *
´ob”
 = 
NULL
;

1242 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "button.has_state")) {

1243 
´ob”
 = "hald-probe-input";

1246  
´ob”
;

1247 
	}
}

1249 
gboŞ—n


1250 
	$šput_po¡_´obšg
 (
H®Deviû
 *
d
)

1252  
TRUE
;

1253 
	}
}

1255 
gboŞ—n


1256 
	$šput_compu‹_udi
 (
H®Deviû
 *
d
)

1258 
gch¬
 
udi
[256];

1260 
	`h®d_compu‹_udi
 (
udi
,  (udi),

1262 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"));

1263 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

1265  
TRUE
;

1266 
	}
}

1270 
šlše
 

1271 
	$iucv_add_Ãtiucv_´İ”t›s
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
sysfs_·th
)

1273 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "iucv.Ãtiucv.u£r", 
sysfs_·th
,

1275 
	`h®_ut_£t_št_äom_fe
 (
d
, "iucv.Ãtiucv.bufãr", 
sysfs_·th
,

1277 
	}
}

1279 
H®Deviû
 *

1280 
	$iucv_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

1282 
H®Deviû
 *
d
;

1283 cÚ¡ 
gch¬
 *
bus_id
;

1284 
gch¬
 
driv”_Çme
[256];

1286 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

1288 
d
 = 
	`h®_deviû_Ãw
 ();

1289 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

1290 ià(
·»Á_dev
 !ğ
NULL
)

1291 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1293 
h®_deviû_´İ”ty_£t_¡ršg


1294 (
d
, "info.parent",

1297 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

1299 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "iucv.bus_id", 
bus_id
);

1301 ià(
	`h®_ut_g‘_driv”_Çme
 (
sysfs_·th
, 
driv”_Çme
)) {

1302 ià(!
	`¡ºcmp
 (
driv”_Çme
, "netiucv", 7))

1303 
	`iucv_add_Ãtiucv_´İ”t›s
 (
d
, 
sysfs_·th
);

1305  
d
;

1306 
	}
}

1308 
gboŞ—n


1309 
	$iucv_compu‹_udi
 (
H®Deviû
 *
d
)

1311 
gch¬
 
udi
[256];

1313 
	`h®d_compu‹_udi
 (
udi
,  (udi),

1315 
h®_deviû_´İ”ty_g‘_¡ršg


1316 (
d
, "iucv.bus_id"));

1317 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

1318  
TRUE
;

1320 
	}
}

1323 
H®Deviû
 *

1324 
	$Ëds_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

1326 
H®Deviû
 *
d
;

1327 cÚ¡ 
gch¬
 *
dev_Çme
;

1328 
gch¬
 **
©Œibu‹s
;

1330 
d
 = 
	`h®_deviû_Ãw
 ();

1332 ià(
·»Á_dev
 !ğ
NULL
)

1333 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1335 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

1337 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

1338 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

1340 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "leds");

1341 
	`h®_deviû_add_ÿ·b™y
 (
d
, "leds");

1343 
dev_Çme
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

1344 ià(
dev_Çme
) {

1345 
©Œibu‹s
 = 
	`g_¡r¥l™_£t
 (
dev_Çme
, ":", 0);

1347 ià(
©Œibu‹s
 !ğ
NULL
) {

1348 ià(
©Œibu‹s
[0] !ğ
NULL
) {

1349 ià(
©Œibu‹s
[0][0] != '\0')

1350 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "Ëds.deviû_Çme", 
©Œibu‹s
[0]);

1351 ià(
©Œibu‹s
[1] !ğ
NULL
 ) {

1352 ià(
©Œibu‹s
[1][0] != '\0')

1353 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "Ëds.cŞour", 
©Œibu‹s
[1]);

1354 ià(
©Œibu‹s
[2] !ğ
NULL
 &&‡ttributes[2][0] != '\0')

1355 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "Ëds.funùiÚ", 
©Œibu‹s
[2]);

1359 
	`g_¡rä“v
 (
©Œibu‹s
);

1362  
d
;

1363 
	}
}

1365 
gboŞ—n


1366 
	$Ëds_compu‹_udi
 (
H®Deviû
 *
d
)

1368 
gch¬
 
udi
[256];

1369 cÚ¡ *
Çme
;

1370 cÚ¡ *
cŞour
;

1371 cÚ¡ *
funùiÚ
;

1373 
Çme
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "leds.device_name");

1374 
cŞour
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "leds.colour");

1375 
funùiÚ
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "leds.function");

1377 ià(
Çme
 && 
funùiÚ
 && 
cŞour
) {

1378 
	`h®d_compu‹_udi
 (
udi
,  (udi), "/Üg/ä“desktİ/H®/deviûs/Ëds_%s_%s_%s", 
Çme
, 
funùiÚ
, 
cŞour
);

1379 } ià(
Çme
 && 
funùiÚ
) {

1380 
	`h®d_compu‹_udi
 (
udi
,  (udi), "/Üg/ä“desktİ/H®/deviûs/Ëds_%s_%s", 
Çme
, 
funùiÚ
);

1381 } ià(
Çme
) {

1382 
	`h®d_compu‹_udi
 (
udi
,  (udi), "/Üg/ä“desktİ/H®/deviûs/Ëds_%s", 
Çme
);

1384 
	`h®d_compu‹_udi
 (
udi
,  (udi), "/org/freedesktop/Hal/devices/leds_unknown");

1387 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

1388  
TRUE
;

1389 
	}
}

1394 
H®Deviû
 *

1395 
	$mem¡ick_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

1397 
H®Deviû
 *
d
;

1399 ià(
·»Á_dev
 =ğ
NULL
) {

1400 
d
 = 
NULL
;

1401 
out
;

1404 
d
 = 
	`h®_deviû_Ãw
 ();

1405 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

1406 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1408 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

1410 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "šfo.´oduù", 
sysfs_·th
, "attr_modelname");

1412 
out
:

1413  
d
;

1414 
	}
}

1416 
gboŞ—n


1417 
	$mem¡ick_compu‹_udi
 (
H®Deviû
 *
d
)

1419 
gch¬
 
udi
[256];

1421 
	`h®_ut_compu‹_udi
 (
	`h®d_g‘_gdl
 (), 
udi
,  (udi),

1423 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"));

1424 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

1425 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.udi", 
udi
);

1426  
TRUE
;

1428 
	}
}

1432 
H®Deviû
 *

1433 
	$mem¡ick_ho¡_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

1435 
H®Deviû
 *
d
;

1436 
gšt
 
ho¡_num
;

1437 cÚ¡ 
gch¬
 *
Ï¡_–em
;

1439 
d
 = 
NULL
;

1441 ià(
·»Á_dev
 =ğ
NULL
 || 
·»Á_·th
 == NULL) {

1442 
out
;

1445 
d
 = 
	`h®_deviû_Ãw
 ();

1446 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

1448 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1450 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "memstick_host");

1451 
	`h®_deviû_add_ÿ·b™y
 (
d
, "memstick_host");

1453 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Memory Stick Host Adapter");

1455 
Ï¡_–em
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

1456 
	`ssÿnf
 (
Ï¡_–em
, "mem¡ick%d", &
ho¡_num
);

1457 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "mem¡ick_ho¡.ho¡", 
ho¡_num
);

1459 
out
:

1460  
d
;

1461 
	}
}

1463 
gboŞ—n


1464 
	$mem¡ick_ho¡_compu‹_udi
 (
H®Deviû
 *
d
)

1466 
gch¬
 
udi
[256];

1468 
	`h®_ut_compu‹_udi
 (
	`h®d_g‘_gdl
 (), 
udi
,  (udi),

1470 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"));

1471 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

1472 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.udi", 
udi
);

1473  
TRUE
;

1474 
	}
}

1478 
H®Deviû
 *

1479 
	$mmc_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

1481 
H®Deviû
 *
d
;

1482 cÚ¡ 
gch¬
 *
bus_id
;

1483 
gšt
 
ho¡_num
, 
rÿ
, 
mªfid
, 
Ûmid
;

1484 
gch¬
 *
sü
, *
ty³
;

1486 ià(
·»Á_dev
 =ğ
NULL
) {

1487 
d
 = 
NULL
;

1488 
out
;

1491 
d
 = 
	`h®_deviû_Ãw
 ();

1492 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

1493 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1495 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

1497 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

1498 
	`ssÿnf
 (
bus_id
, "mmc%d:%x", &
ho¡_num
, &
rÿ
);

1499 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "mmc.rÿ", 
rÿ
);

1501 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "mmc.cid", 
sysfs_·th
, "cid");

1502 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "mmc.csd", 
sysfs_·th
, "csd");

1504 
ty³
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "type");

1505 ià(
ty³
 !ğ
NULL
)

1507 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "mmc.ty³", 
ty³
);

1509 
sü
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "scr");

1510 ià(
sü
 !ğ
NULL
) {

1511 ià(
	`¡rcmp
 (
sü
, "0000000000000000") == 0)

1512 
sü
 = 
NULL
;

1514 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "mmc.sü", 
sü
);

1517 ià(!
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "šfo.´oduù", 
sysfs_·th
, "name")) {

1518 
gch¬
 
buf
[64];

1519 ià(
ty³
 !ğ
NULL
) {

1520 
	`g_¢´štf
(
buf
, (buf), "% C¬d", 
ty³
);

1521 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

1522 } ià(
sü
 !ğ
NULL
) {

1523 
	`g_¢´štf
(
buf
, (buf), "SD Card");

1524 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

1526 
	`g_¢´štf
(
buf
, (buf), "MMC Card");

1528 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "mmc.´oduù", 
buf
);

1531 ià(
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "mªfid", &
mªfid
, 16)) {

1533 
v’dÜ
[256];

1534 
	`¢´štf
(
v’dÜ
, 256, "UnknowÀ(%d)", 
mªfid
);

1535 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.v’dÜ", 
v’dÜ
);

1536 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "mmc.v’dÜ", 
v’dÜ
);

1538 ià(
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "Ûmid", &
Ûmid
, 16)) {

1540 
Ûm
[256];

1541 
	`¢´štf
(
Ûm
, 256, "UnknowÀ(%d)", 
Ûmid
);

1542 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "mmc.Ûm", 
Ûm
);

1545 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "mmc.d©e", 
sysfs_·th
, "date");

1546 
	`h®_ut_£t_št_äom_fe
 (
d
, "mmc.hw»v", 
sysfs_·th
, "hwrev", 16);

1547 
	`h®_ut_£t_št_äom_fe
 (
d
, "mmc.fw»v", 
sysfs_·th
, "fwrev", 16);

1548 
	`h®_ut_£t_št_äom_fe
 (
d
, "mmc.£rŸl", 
sysfs_·th
, "serial", 16);

1550 
out
:

1551  
d
;

1552 
	}
}

1554 
gboŞ—n


1555 
	$mmc_compu‹_udi
 (
H®Deviû
 *
d
)

1557 
gch¬
 
udi
[256];

1559 
	`h®d_compu‹_udi
 (
udi
,  (udi),

1561 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

1562 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "mmc.rca"));

1563 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

1564  
TRUE
;

1566 
	}
}

1570 
H®Deviû
 *

1571 
	$mmc_ho¡_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

1573 
H®Deviû
 *
d
;

1574 
gšt
 
ho¡_num
;

1575 cÚ¡ 
gch¬
 *
Ï¡_–em
;

1576 cÚ¡ 
gch¬
 *
¦Ù_Çme
;

1577 cÚ¡ 
gch¬
 *
s
;

1579 
d
 = 
NULL
;

1581 ià(
·»Á_dev
 =ğ
NULL
 || 
·»Á_·th
 == NULL) {

1582 
out
;

1585 
d
 = 
	`h®_deviû_Ãw
 ();

1586 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

1588 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1590 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "mmc_host");

1591 
	`h®_deviû_add_ÿ·b™y
 (
d
, "mmc_host");

1593 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "MMC/SD Host Adapter");

1595 
Ï¡_–em
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

1596 
	`ssÿnf
 (
Ï¡_–em
, "mmc%d", &
ho¡_num
);

1597 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "mmc_ho¡.ho¡", 
ho¡_num
);

1599 
¦Ù_Çme
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "slot_name");

1600 ià(
¦Ù_Çme
) {

1601 ià(
	`¡ºcmp
 (
¦Ù_Çme
, "¦Ù:", 
	`¡¾’
 ("slot:")) == 0)

1602 
¦Ù_Çme
 +ğ
	`¡¾’
 ("slot:");

1604 ià(
	`¡rcmp
 (
¦Ù_Çme
, "internal") != 0 &&

1605 
	`¡rcmp
 (
¦Ù_Çme
, "external") != 0)

1606 
¦Ù_Çme
 = "unknown";

1608 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "mmc_ho¡.¦Ù_Çme", 
¦Ù_Çme
);

1611 
s
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "/cover_switch");

1612 ià(
s
) {

1613 
	`h®_deviû_add_ÿ·b™y
 (
d
, "button");

1614 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "button.type", "cover");

1615 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "bu‰Ú.has_¡©e", 
FALSE
);

1618 
out
:

1619  
d
;

1620 
	}
}

1622 
gboŞ—n


1623 
	$mmc_ho¡_compu‹_udi
 (
H®Deviû
 *
d
)

1625 
gch¬
 
udi
[256];

1627 
	`h®d_compu‹_udi
 (
udi
,  (udi),

1629 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"));

1630 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

1631  
TRUE
;

1632 
	}
}

1636 
H®Deviû
 *

1637 
	$Ãt_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

1639 
H®Deviû
 *
d
;

1640 cÚ¡ 
gch¬
 *
iâame
;

1641 
gušt
 
medŸ_ty³
;

1642 
gšt
 
æags
;

1643 
gšt
 
addr_Ën
;

1645 
d
 = 
NULL
;

1646 
d
 = 
	`h®_deviû_Ãw
 ();

1648 ià(
·»Á_dev
 =ğ
NULL
) {

1649 
·»Á_dev
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/org/freedesktop/Hal/devices/computer");

1650 ià(
·»Á_dev
 =ğ
NULL
) {

1651 
·»Á_dev
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/org/freedesktop/Hal/devices/computer");

1652 ià(
·»Á_dev
 =ğ
NULL
) {

1653 
	`HAL_ERROR
 (("Device '%s' has‚o…arent‡nd couldn't find computer„oot object."));

1654 
”rÜ
;

1659 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1660 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "Ãt.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1662 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "net");

1663 
	`h®_deviû_add_ÿ·b™y
 (
d
, "net");

1665 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

1666 
iâame
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

1667 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "Ãt.š‹rçû", 
iâame
);

1669 
	`h®_ut_g‘_št_äom_fe
(
sysfs_·th
, "addr_Ën", &
addr_Ën
, 0);

1671 ià(!
addr_Ën
 || !
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "Ãt.add»ss", 
sysfs_·th
, "address")) {

1672 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "net.address", "00:00:00:00:00:00");

1675 ià(!
	`h®_ut_£t_št_äom_fe
 (
d
, "Ãt.lšux.ifšdex", 
sysfs_·th
, "ifindex", 10))

1676 
”rÜ
;

1678 ià(!
	`h®_ut_£t_št_äom_fe
 (
d
, "Ãt.¬p_´Ùo_hw_id", 
sysfs_·th
, "type", 10))

1679 
”rÜ
;

1681 ià(!
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "æags", &
æags
, 16))

1682 
”rÜ
;

1684 
medŸ_ty³
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "net.arp_proto_hw_id");

1685 ià(
medŸ_ty³
 =ğ
ARPHRD_ETHER
) {

1686 cÚ¡ *
addr
;

1687 cÚ¡ *
·»Á_subsys
;

1688 
bridge_·th
[
HAL_PATH_MAX
];

1689 
phy80211_·th
[
HAL_PATH_MAX
];

1690 
¡©
 
s
;

1691 
dbus_ušt64_t
 
mac_add»ss
 = 0;

1692 
ioùl_fd
;

1693 
iw»q
 
iwr
;

1695 
ioùl_fd
 = 
	`sock‘
 (
PF_INET
, 
SOCK_DGRAM
, 0);

1696 
	`¡ºıy
 (
iwr
.
iä_iän
.
iän_Çme
, 
iâame
, 
IFNAMSIZ
);

1698 
addr
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "net.address");

1699 ià(
addr
 !ğ
NULL
) {

1700 
a5
, 
a4
, 
a3
, 
a2
, 
a1
, 
a0
;

1702 ià(
	`ssÿnf
 (
addr
, "%x:%x:%x:%x:%x:%x",

1703 &
a5
, &
a4
, &
a3
, &
a2
, &
a1
, &
a0
) == 6) {

1704 
mac_add»ss
 =

1705 ((
dbus_ušt64_t
)
a5
<<40) |

1706 ((
dbus_ušt64_t
)
a4
<<32) |

1707 ((
dbus_ušt64_t
)
a3
<<24) |

1708 ((
dbus_ušt64_t
)
a2
<<16) |

1709 ((
dbus_ušt64_t
)
a1
<< 8) |

1710 ((
dbus_ušt64_t
)
a0
<< 0);

1714 
	`¢´štf
 (
bridge_·th
, 
HAL_PATH_MAX
, "%s/bridge", 
sysfs_·th
);

1716 
	`¢´štf
 (
phy80211_·th
, 
HAL_PATH_MAX
, "%s/phy80211", 
sysfs_·th
);

1717 
·»Á_subsys
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
·»Á_dev
, "info.subsystem");

1719 ià(
·»Á_subsys
 && 
	`¡rcmp
(parent_subsys, "bluetooth") == 0) {

1720 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Bluetooth Interface");

1721 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "net.bluetooth");

1722 
	`h®_deviû_add_ÿ·b™y
 (
d
, "net.bluetooth");

1723 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "Ãt.blu‘oÙh.mac_add»ss", 
mac_add»ss
);

1724 } ià((
	`ioùl
 (
ioùl_fd
, 
SIOCGIWNAME
, &
iwr
) == 0) ||

1725 (
	`¡©
 (
phy80211_·th
, &
s
è=ğ0 && (s.
¡_mode
 & 
S_IFDIR
))) {

1726 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "WLAN Interface");

1727 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "net.80211");

1728 
	`h®_deviû_add_ÿ·b™y
 (
d
, "net.80211");

1729 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "Ãt.80211.mac_add»ss", 
mac_add»ss
);

1730 } ià(
	`¡©
 (
bridge_·th
, &
s
è=ğ0 && (s.
¡_mode
 & 
S_IFDIR
)) {

1731 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Bridge Interface");

1732 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "net.bridge");

1733 
	`h®_deviû_add_ÿ·b™y
 (
d
, "net.bridge");

1734 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "Ãt.bridge.mac_add»ss", 
mac_add»ss
);

1736 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Networking Interface");

1737 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "net.80203");

1738 
	`h®_deviû_add_ÿ·b™y
 (
d
, "net.80203");

1739 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, "Ãt.80203.mac_add»ss", 
mac_add»ss
);

1742 
	`şo£
 (
ioùl_fd
);

1743 } ià(
medŸ_ty³
 =ğ
ARPHRD_IRDA
) {

1744 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Networking Interface");

1745 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "net.irda");

1746 
	`h®_deviû_add_ÿ·b™y
 (
d
, "net.irda");

1747 } ià(
medŸ_ty³
 =ğ
ARPHRD_LOOPBACK
) {

1748 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Loopback device Interface");

1749 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "net.loopback");

1750 
	`h®_deviû_add_ÿ·b™y
 (
d
, "net.loopback");

1753 #ià
	`defšed
(
ARPHRD_IEEE80211_RADIOTAP
è&& defšed(
ARPHRD_IEEE80211_PRISM
)

1754 ià(
medŸ_ty³
 =ğ
ARPHRD_IEEE80211
 || medŸ_ty³ =ğ
ARPHRD_IEEE80211_PRISM
 ||

1755 
medŸ_ty³
 =ğ
ARPHRD_IEEE80211_RADIOTAP
) {

1756 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Networking Wireless Control Interface");

1757 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "net.80211control");

1758 
	`h®_deviû_add_ÿ·b™y
 (
d
, "net.80211control");

1761 #w¬nšg 
ARPHRD_IEEE80211_RADIOTAP
 
ªd
/
Ü
 
ARPHRD_IEEE80211_PRISM
 
nÙ
 
defšed
!

1764  
d
;

1765 
”rÜ
:

1766 ià(
d
 !ğ
NULL
) {

1767 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

1768 
	`g_objeù_uÄef
 (
d
);

1769 
d
 = 
NULL
;

1772  
d
;

1773 
	}
}

1775 
gboŞ—n


1776 
	$Ãt_»äesh
 (
H®Deviû
 *
d
)

1778 cÚ¡ 
gch¬
 *
·th
, *
iâame
;

1780 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.sysfs_path");

1781 
iâame
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
·th
);

1782 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "Ãt.š‹rçû", 
iâame
);

1783  
TRUE
;

1784 
	}
}

1787 
	$Ãt_g‘_´ob”
 (
H®Deviû
 *
d
)

1789 cÚ¡ *
´ob”
 = 
NULL
;

1792 ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "net.bluetooth")) {

1793 
´ob”
 = "hald-probe-net-bluetooth";

1796  
´ob”
;

1797 
	}
}

1799 
gboŞ—n


1800 
	$Ãt_po¡_´obšg
 (
H®Deviû
 *
d
)

1802  
TRUE
;

1803 
	}
}

1805 
gboŞ—n


1806 
	$Ãt_compu‹_udi
 (
H®Deviû
 *
d
)

1808 
gch¬
 
udi
[256];

1809 cÚ¡ 
gch¬
 *
id
;

1810 
gboŞ—n
 
id_Úly
 = 
TRUE
;

1812 
id
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "net.address");

1814 ià(
id
 =ğ
NULL
 || (
	`¡rcmp
 (id, "00:00:00:00:00:00") == 0)) {

1816 
id
 = 
	`h®_ut_g‘_Ï¡_–em’t
(
	`h®_deviû_´İ”ty_g‘_¡ršg
(
d
, "net.originating_device"));

1817 ià(!
	`¡rcmp
(
id
, "computer")) {

1818 cÚ¡ 
gch¬
 *
ÿt
;

1819 
ty³
[32];

1822 ià((
ÿt
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
d
, "info.category")) &&

1823 (
	`ssÿnf
 (
ÿt
, "Ãt.%s", 
ty³
) == 1)) {

1824 
	`h®d_compu‹_udi
 (
udi
,  (udi), "/Üg/ä“desktİ/H®/deviûs/Ãt_%s_%s", 
id
, 
ty³
);

1825 
id_Úly
 = 
FALSE
;

1830 ià(
id_Úly
)

1831 
	`h®d_compu‹_udi
 (
udi
,  (udi), "/Üg/ä“desktİ/H®/deviûs/Ãt_%s", 
id
);

1833 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

1834  
TRUE
;

1835 
	}
}

1839 #ifdeà
USE_OPENFIRMWARE


1840 
H®Deviû
 *

1841 
	$of_¶©fÜm_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
,

1842 cÚ¡ 
gch¬
 *
sysfs_·th_š_deviûs
)

1844 
H®Deviû
 *
d
;

1845 cÚ¡ 
gch¬
 *
dev_id
;

1846 
gch¬
 
buf
[64];

1848 
d
 = 
	`h®_deviû_Ãw
 ();

1849 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

1850 ià(
·»Á_dev
 !ğ
NULL
) {

1851 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1853 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

1856 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

1858 
dev_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

1860 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "of_¶©fÜm.id", 
dev_id
);

1862 
	`g_¢´štf
 (
buf
,  (buf), "O³nFœmw¬PÏtfÜm Deviû (%s)", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "of_platform.id"));

1863 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

1865  
d
;

1866 
	}
}

1868 
gboŞ—n


1869 
	$of_¶©fÜm_compu‹_udi
 (
H®Deviû
 *
d
)

1871 
gch¬
 
udi
[256];

1873 
	`h®d_compu‹_udi
 (
udi
,  (udi), "/org/freedesktop/Hal/devices/of_platform_%s",

1874 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "of_platform.id"));

1875 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

1877  
TRUE
;

1878 
	}
}

1883 #ifdeà
USE_PCI


1884 
H®Deviû
 *

1885 
	$pci_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

1887 
H®Deviû
 *
d
;

1888 
gšt
 
deviû_şass
;

1890 
d
 = 
	`h®_deviû_Ãw
 ();

1891 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

1892 ià(
·»Á_dev
 !ğ
NULL
) {

1893 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1895 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

1898 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "pci.lšux.sysfs_·th", 
sysfs_·th
);

1900 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

1902 if(!
	`h®_ut_£t_št_äom_fe
 (
d
, "pci.´oduù_id", 
sysfs_·th
, "device", 16) ||

1903 !
	`h®_ut_£t_št_äom_fe
 (
d
, "pci.v’dÜ_id", 
sysfs_·th
, "vendor", 16)) {

1904 
	`HAL_ERROR
(("Could‚ot get PCI…roduct or vendor ID, don't‡dd device,his info is mandatory!"));

1905  
NULL
;

1908 
	`h®_ut_£t_št_äom_fe
 (
d
, "pci.subsys_´oduù_id", 
sysfs_·th
, "subsystem_device", 16);

1909 
	`h®_ut_£t_št_äom_fe
 (
d
, "pci.subsys_v’dÜ_id", 
sysfs_·th
, "subsystem_vendor", 16);

1911 ià(
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "şass", &
deviû_şass
, 16)) {

1912 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "pci.deviû_şass", ((
deviû_şass
 >> 16) & 0xff));

1913 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "pci.deviû_subşass", ((
deviû_şass
 >> 8) & 0xff));

1914 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "pci.deviû_´ÙocŞ", (
deviû_şass
 & 0xff));

1918 
gch¬
 
buf
[64];

1919 *
v’dÜ_Çme
 = 
NULL
;

1920 *
´oduù_Çme
 = 
NULL
;

1921 *
subsys_v’dÜ_Çme
 = 
NULL
;

1922 *
subsys_´oduù_Çme
 = 
NULL
;

1924 
	`ids_fšd_pci
 (
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pci.vendor_id"),

1925 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pci.product_id"),

1926 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pci.subsys_vendor_id"),

1927 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pci.subsys_product_id"),

1928 &
v’dÜ_Çme
, &
´oduù_Çme
, &
subsys_v’dÜ_Çme
, &
subsys_´oduù_Çme
);

1930 ià(
v’dÜ_Çme
 !ğ
NULL
) {

1931 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "pci.v’dÜ", 
v’dÜ_Çme
);

1932 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.v’dÜ", 
v’dÜ_Çme
);

1934 
	`g_¢´štf
 (
buf
,  (buf), "Unknown (0x%04x)",

1935 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pci.vendor_id"));

1936 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.v’dÜ", 
buf
);

1939 ià(
´oduù_Çme
 !ğ
NULL
) {

1940 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "pci.´oduù", 
´oduù_Çme
);

1941 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
´oduù_Çme
);

1943 
	`g_¢´štf
 (
buf
,  (buf), "Unknown (0x%04x)",

1944 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pci.product_id"));

1945 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

1948 ià(
subsys_v’dÜ_Çme
 !ğ
NULL
) {

1949 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "pci.subsys_v’dÜ", 
subsys_v’dÜ_Çme
);

1951 ià(
subsys_´oduù_Çme
 !ğ
NULL
) {

1952 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "pci.subsys_´oduù", 
subsys_´oduù_Çme
);

1956  
d
;

1957 
	}
}

1959 
gboŞ—n


1960 
	$pci_compu‹_udi
 (
H®Deviû
 *
d
)

1962 
gch¬
 
udi
[256];

1964 
	`h®d_compu‹_udi
 (
udi
,  (udi),

1966 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pci.vendor_id"),

1967 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pci.product_id"));

1968 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

1970  
TRUE
;

1971 
	}
}

1976 #ifdeà
USE_PCMCIA


1977 
H®Deviû
 *

1978 
	$pcmcŸ_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

1980 
H®Deviû
 *
d
;

1981 cÚ¡ 
gch¬
 *
bus_id
;

1982 
gušt
 
sock‘
, 
funùiÚ
;

1983 cÚ¡ *
´od_id1
;

1984 cÚ¡ *
´od_id2
;

1986 
d
 = 
	`h®_deviû_Ãw
 ();

1987 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

1988 ià(
·»Á_dev
 !ğ
NULL
) {

1989 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

1991 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

1994 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

1996 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

1999 
	`ssÿnf
 (
bus_id
, "%d.%d", &
sock‘
, &
funùiÚ
);

2000 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "pcmcŸ.sock‘_numb”", 
sock‘
);

2002 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "pcmcŸ.´od_id1", 
sysfs_·th
, "prod_id1");

2003 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "pcmcŸ.´od_id2", 
sysfs_·th
, "prod_id2");

2004 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "pcmcŸ.´od_id3", 
sysfs_·th
, "prod_id3");

2005 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "pcmcŸ.´od_id4", 
sysfs_·th
, "prod_id4");

2007 
	`h®_ut_£t_št_äom_fe
 (
d
, "pcmcŸ.mªf_id", 
sysfs_·th
, "manf_id", 16);

2008 
	`h®_ut_£t_št_äom_fe
 (
d
, "pcmcŸ.ÿrd_id", 
sysfs_·th
, "card_id", 16);

2009 
	`h®_ut_£t_št_äom_fe
 (
d
, "pcmcŸ.func_id", 
sysfs_·th
, "func_id", 16);

2011 
´od_id1
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "pcmcia.prod_id1");

2012 
´od_id2
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "pcmcia.prod_id2");

2015 ià(
´od_id1
 !ğ
NULL
) {

2016 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "pcmcŸ.v’dÜ", 
´od_id1
);

2017 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.v’dÜ", 
´od_id1
);

2019 
buf
[50];

2020 
	`g_¢´štf
 (
buf
, (buf), "UnknowÀ(0x%04x)", 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pcmcia.manf_id"));

2021 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.v’dÜ", 
buf
);

2025 ià(
´od_id2
 !ğ
NULL
) {

2026 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "pcmcŸ.´oduù", 
´od_id1
);

2027 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
´od_id2
);

2029 
buf
[50];

2030 
	`g_¢´štf
 (
buf
, (buf), "UnknowÀ(0x%04x)", 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pcmcia.card_id"));

2031 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

2034  
d
;

2035 
	}
}

2037 
gboŞ—n


2038 
	$pcmcŸ_compu‹_udi
 (
H®Deviû
 *
d
)

2040 
gch¬
 
udi
[256];

2042 
	`h®d_compu‹_udi
 (
udi
,  (udi),

2044 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pcmcia.manfid1"),

2045 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pcmcia.manfid2"));

2046 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

2047  
TRUE
;

2049 
	}
}

2054 
H®Deviû
 *

2055 
	$¶©fÜm_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

2057 
H®Deviû
 *
d
;

2058 cÚ¡ 
gch¬
 *
dev_id
;

2059 
gch¬
 
buf
[64];

2061 
d
 = 
	`h®_deviû_Ãw
 ();

2062 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

2063 ià(
·»Á_dev
 !ğ
NULL
) {

2064 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

2066 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

2069 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

2071 
dev_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

2073 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¶©fÜm.id", 
dev_id
);

2075 
	`g_¢´štf
 (
buf
,  (buf), "PÏtfÜm Deviû (%s)", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "platform.id"));

2076 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

2078 ià(
	`¡ºcmp
 (
dev_id
, "dock", 4) == 0) {

2079 
docked
;

2081 
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "docked", &
docked
, 0);

2082 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "šfo.docked", 
docked
);

2085  
d
;

2086 
	}
}

2088 
gboŞ—n


2089 
	$¶©fÜm_compu‹_udi
 (
H®Deviû
 *
d
)

2091 
gch¬
 
udi
[256];

2093 
	`h®d_compu‹_udi
 (
udi
,  (udi),

2095 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "platform.id"));

2096 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

2098  
TRUE
;

2099 
	}
}

2101 
gboŞ—n


2102 
	$¶©fÜm_»äesh_undock
 (
gpoš‹r
 
d©a
)

2104 
H®Deviû
 *
d
;

2105 
gšt
 
æags
, 
docked
;

2106 cÚ¡ 
gch¬
 *
sysfs_·th
;

2108 ià(
d©a
 =ğ
NULL
)

2109  
FALSE
;

2110 
d
 = (
H®Deviû
 *è
d©a
;

2112 
sysfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
d
, "linux.sysfs_path");

2113 
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "æags", &
æags
, 0);

2116 ià(
æags
 != 0)

2117  
TRUE
;

2119 
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "docked", &
docked
, 0);

2120 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "šfo.docked", 
docked
);

2122  
FALSE
;

2123 
	}
}

2125 
gboŞ—n


2126 
	$¶©fÜm_»äesh
 (
H®Deviû
 *
d
)

2128 cÚ¡ 
gch¬
 *
id
, *
sysfs_·th
;

2129 
gšt
 
docked
, 
æags
;

2131 
id
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "platform.id");

2132 ià(
	`¡ºcmp
 (
id
, "dock", 4) != 0)

2133  
TRUE
;

2135 
sysfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
d
, "linux.sysfs_path");

2136 
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "docked", &
docked
, 0);

2138 ià(
docked
 == 1) {

2140 
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "æags", &
æags
, 0);

2141 ià(
æags
 == 2) {

2142 
	`g_timeout_add
 (
DOCK_STATION_UNDOCK_POLL_INTERVAL
,

2143 
¶©fÜm_»äesh_undock
, 
d
);

2144  
TRUE
;

2148 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "šfo.docked", 
docked
);

2149  
TRUE
;

2150 
	}
}

2154 #ifdeà
USE_ISAPC


2156 
	$²p_£t_£rŸl_šfo
 (cÚ¡ 
gch¬
 *
sysfs_·th
, 
H®Deviû
 *
d
) {

2158 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "²p.£rŸl.œq", 
sysfs_·th
, "»sourûs", "œq", 0, 10, 
TRUE
);

2160 ià(
	`h®_ut_£t_¡ršg_–em_äom_fe
 (
d
, "²p.£rŸl.pÜt", 
sysfs_·th
, "»sourûs", "io", 0, 
TRUE
)) {

2161 cÚ¡ * 
pÜt
;

2162 cÚ¡ * 
_pÜt
;

2163 
_pÜt
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "pnp.serial.port");

2164 if(
_pÜt
 =ğ
NULL
)

2167 
pÜt
 = 
	`¡¹ok
((*è
_pÜt
, "-");

2168 if(
pÜt
 =ğ
NULL
)

2171 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "²p.£rŸl.pÜt", 
pÜt
);

2173 
	}
}

2176 
H®Deviû
 *

2177 
	$²p_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

2179 
H®Deviû
 *
d
;

2180 
H®Deviû
 *
compu‹r
;

2182 
d
 = 
	`h®_deviû_Ãw
 ();

2183 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

2184 ià(
·»Á_dev
 !ğ
NULL
) {

2185 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

2187 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

2190 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

2192 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "²p.id", 
sysfs_·th
, "id");

2193 ià(
	`h®_deviû_has_´İ”ty
 (
d
, "pnp.id")) {

2194 
gch¬
 *
²p_desütiÚ
;

2195 cÚ¡ *
²p_id
;

2196 
	`ids_fšd_²p
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "²p.id"), &
²p_desütiÚ
);

2197 ià(
²p_desütiÚ
 !ğ
NULL
) {

2198 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "²p.desütiÚ", 
²p_desütiÚ
);

2199 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
²p_desütiÚ
);

2201 
²p_id
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "pnp.id");

2202 ifĞ!
	`¡ºcmp
(
²p_id
, "WACf00", 6è|| !
	`¡rcmp
(pnp_id, "FUJ02e5") ||

2203 !
	`¡rcmp
(
²p_id
, "FUJ02e6") || !strcmp(pnp_id, "FPI2004")) {

2205 ià((
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/Üg/ä“desktİ/H®/deviûs/compu‹r")è!ğ
NULL
 ||

2206 (
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/Üg/ä“desktİ/H®/deviûs/compu‹r")è!ğ
NULL
) {

2208 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
compu‹r
, "system.formfactor", "laptop");

2209 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
compu‹r
, "system.formfactor.subtype", "tabletpc");

2211 
	`²p_£t_£rŸl_šfo
 (
sysfs_·th
, 
d
);

2216 ià(!
	`h®_deviû_has_´İ”ty
 (
d
, "info.product")) {

2217 
gch¬
 
buf
[64];

2218 
	`g_¢´štf
 (
buf
,  (buf), "PnP Deviû (%s)", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "pnp.id"));

2219 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

2223  
d
;

2224 
	}
}

2226 
gboŞ—n


2227 
	$²p_compu‹_udi
 (
H®Deviû
 *
d
)

2229 
gch¬
 
udi
[256];

2231 
	`h®d_compu‹_udi
 (
udi
,  (udi),

2233 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "pnp.id"));

2234 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

2236  
TRUE
;

2238 
	}
}

2244 
H®Deviû
 *

2245 
	$µdev_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

2247 
H®Deviû
 *
d
;

2249 
d
 = 
	`h®_deviû_Ãw
 ();

2251 ià(
·»Á_dev
 !ğ
NULL
) {

2252 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

2254 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

2257 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

2258 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

2259 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ppdev");

2260 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "ppdev");

2261 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Parallel Port Device");

2263  
d
;

2264 
	}
}

2266 
gboŞ—n


2267 
	$µdev_compu‹_udi
 (
H®Deviû
 *
d
)

2269 
gch¬
 
udi
[256];

2270 cÚ¡ *
Çme
;

2272 
Çme
 = 
	`h®_ut_g‘_Ï¡_–em’t
Ğ
	`h®_deviû_´İ”ty_g‘_¡ršg
(
d
, "linux.device_file"));

2274 ià(
Çme
) {

2275 
	`h®d_compu‹_udi
 (
udi
,  (udi), "/Üg/ä“desktİ/H®/deviûs/µdev_%s", 
Çme
);

2277 
	`h®d_compu‹_udi
 (
udi
,  (udi), "/org/freedesktop/Hal/devices/ppdev");

2280 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

2282  
TRUE
;

2283 
	}
}

2288 
	$»äesh_ac_ad­‹r
 (
H®Deviû
 *
d
)

2290 cÚ¡ *
·th
;

2291 
gboŞ—n
 
´e£Á
 = 
FALSE
;

2293 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.sysfs_path");

2294 ià(
·th
 =ğ
NULL
)

2297 ià(
	`h®_ut_g‘_boŞ_äom_fe
 (
·th
, "Úlše", &
´e£Á
, "1"è=ğ
FALSE
) {

2299 
´e£Á
 = 
TRUE
;

2302 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "ac_ad­‹r.´e£Á", 
´e£Á
);

2303 
	}
}

2306 
	$»äesh_b©‹ry_ç¡
 (
H®Deviû
 *
d
)

2308 
gšt
 
³rûÁage
 = 0;

2309 
gšt
 
vŞge_now
 = 0;

2310 
gšt
 
cu¼’t
 = 0;

2311 
gšt
 
time
 = 0;

2312 
gšt
 
v®ue_now
 = 0;

2313 
gšt
 
v®ue_Ï¡_fuÎ
 = 0;

2314 
gboŞ—n
 
´e£Á
 = 
FALSE
;

2315 
gboŞ—n
 
unknown_un™
 = 
TRUE
;

2316 
gboŞ—n
 
is_mah
 = 
FALSE
;

2317 
gboŞ—n
 
is_mwh
 = 
FALSE
;

2318 
gboŞ—n
 
is_ch¬gšg
 = 
FALSE
;

2319 
gboŞ—n
 
is_disch¬gšg
 = 
FALSE
;

2320 
gboŞ—n
 
gÙ_time
 = 
FALSE
;

2321 
gboŞ—n
 
gÙ_³rûÁage
 = 
FALSE
;

2322 cÚ¡ 
gch¬
 *
·th
;

2323 cÚ¡ 
gch¬
 *
»pÜtšg_un™
;

2324 
gch¬
 *
¡©us
;

2326 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.sysfs_path");

2327 ià(
·th
 =ğ
NULL
)

2331 ià(
	`h®_ut_g‘_boŞ_äom_fe
 (
·th
, "´e£Á", &
´e£Á
, "1")) {

2332 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.´e£Á", 
´e£Á
);

2334 ià(
´e£Á
 =ğ
FALSE
) {

2336 
	`deviû_pm_»move_İtiÚ®_´İs
 (
d
);

2341 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "ÿ·c™y", &
³rûÁage
, 10)) {

2343 ià(
³rûÁage
 >= 0 &&…ercentage <= 100)

2344 
gÙ_³rûÁage
 = 
TRUE
;

2348 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "vŞge_avg", &
vŞge_now
, 10)) {

2349 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.vŞge.cu¼’t", 
vŞge_now
 / 1000);

2350 } ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "vŞge_now", &
vŞge_now
, 10)) {

2351 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.vŞge.cu¼’t", 
vŞge_now
 / 1000);

2355 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "cu¼’t_avg", &
cu¼’t
, 10)) {

2356 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»pÜtšg.¿‹", 
cu¼’t
 / 1000);

2357 } ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "cu¼’t_now", &
cu¼’t
, 10)) {

2358 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»pÜtšg.¿‹", 
cu¼’t
 / 1000);

2362 
¡©us
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
·th
, "status");

2363 ià(
¡©us
 !ğ
NULL
) {

2364 ià(
	`¡rÿ£cmp
 (
¡©us
, "charging") == 0) {

2365 
is_ch¬gšg
 = 
TRUE
;

2366 } ià(
	`¡rÿ£cmp
 (
¡©us
, "discharging") == 0) {

2367 
is_disch¬gšg
 = 
TRUE
;

2369 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.is_»ch¬g—bË", 
TRUE
);

2370 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.»ch¬g—bË.is_ch¬gšg", 
is_ch¬gšg
);

2371 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.»ch¬g—bË.is_disch¬gšg", 
is_disch¬gšg
);

2375 ià(
is_ch¬gšg
 =ğ
TRUE
) {

2376 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "time_to_fuÎ_avg", &
time
, 10) ||

2377 
	`h®_ut_g‘_št_äom_fe
 (
·th
, "time_to_fuÎ_now", &
time
, 10)) {

2378 
gÙ_time
 = 
TRUE
;

2380 } ià(
is_disch¬gšg
 =ğ
TRUE
) {

2381 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "time_to_em±y_avg", &
time
, 10) ||

2382 
	`h®_ut_g‘_št_äom_fe
 (
·th
, "time_to_em±y_now", &
time
, 10)) {

2383 
gÙ_time
 = 
TRUE
;

2389 
»pÜtšg_un™
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "battery.reporting.unit");

2390 ià(
»pÜtšg_un™
 !ğ
NULL
) {

2391 ià(
	`¡rÿ£cmp
 (
»pÜtšg_un™
, "mah") == 0) {

2392 
is_mah
 = 
TRUE
;

2393 
unknown_un™
 = 
FALSE
;

2394 } ià(
	`¡rÿ£cmp
 (
»pÜtšg_un™
, "mwh") == 0) {

2395 
is_mwh
 = 
TRUE
;

2396 
unknown_un™
 = 
FALSE
;

2401 ià(
unknown_un™
 || 
is_mwh
) {

2402 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "’”gy_avg", &
v®ue_now
, 10)) {

2403 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»pÜtšg.cu¼’t", 
v®ue_now
 / 1000);

2404 
is_mwh
 = 
TRUE
;

2405 } ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "’”gy_now", &
v®ue_now
, 10)) {

2406 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»pÜtšg.cu¼’t", 
v®ue_now
 / 1000);

2407 
is_mwh
 = 
TRUE
;

2409 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "’”gy_fuÎ", &
v®ue_Ï¡_fuÎ
, 10)) {

2410 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»pÜtšg.Ï¡_fuÎ", 
v®ue_Ï¡_fuÎ
 / 1000);

2411 
is_mwh
 = 
TRUE
;

2416 ià((
unknown_un™
 && !
is_mwh
è|| 
is_mah
) {

2417 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "ch¬ge_avg", &
v®ue_now
, 10)) {

2418 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»pÜtšg.cu¼’t", 
v®ue_now
 / 1000);

2419 
is_mah
 = 
TRUE
;

2420 } ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "ch¬ge_now", &
v®ue_now
, 10)) {

2421 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»pÜtšg.cu¼’t", 
v®ue_now
 / 1000);

2422 
is_mah
 = 
TRUE
;

2424 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "ch¬ge_fuÎ", &
v®ue_Ï¡_fuÎ
, 10)) {

2425 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»pÜtšg.Ï¡_fuÎ", 
v®ue_Ï¡_fuÎ
 / 1000);

2426 
is_mah
 = 
TRUE
;

2431 ià(
unknown_un™
) {

2432 ià(
is_mwh
 =ğ
TRUE
) {

2433 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.reporting.unit", "mWh");

2434 } ià(
is_mah
 =ğ
TRUE
) {

2435 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.reporting.unit", "mAh");

2442 
	`deviû_pm_ab¡¿ù_´İs
 (
d
);

2445 ià(
gÙ_³rûÁage
) {

2446 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.³rûÁage", 
³rûÁage
);

2448 
	`deviû_pm_ÿlcuÏ‹_³rûÁage
 (
d
);

2452 ià(
gÙ_time
) {

2454 ià(
time
 > 0)

2455 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»maššg_time", 
time
);

2457 
	`h®_deviû_´İ”ty_»move
 (
d
, "battery.remaining_time");

2459 
	`deviû_pm_ÿlcuÏ‹_time
 (
d
);

2461 
	}
}

2464 
	$»äesh_b©‹ry_¦ow
 (
H®Deviû
 *
d
)

2466 
gšt
 
vŞge_design
 = 0;

2467 
gšt
 
v®ue_fuÎ_design
 = 0;

2468 *
‹chnŞogy_¿w
;

2469 *
mod–_Çme
;

2470 *
mªuçùu»r
;

2471 *
£rŸl
;

2472 cÚ¡ 
gch¬
 *
·th
;

2474 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.sysfs_path");

2475 ià(
·th
 =ğ
NULL
)

2479 
‹chnŞogy_¿w
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
·th
, "technology");

2480 ià(
‹chnŞogy_¿w
 !ğ
NULL
) {

2481 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "b©‹ry.»pÜtšg.‹chnŞogy", 
‹chnŞogy_¿w
);

2483 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "b©‹ry.‹chnŞogy", 
	`ut_g‘_b©‹ry_‹chnŞogy
 (
‹chnŞogy_¿w
));

2486 
mod–_Çme
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
·th
, "model_name");

2487 ià(
mod–_Çme
 !ğ
NULL
) {

2488 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "b©‹ry.mod–", 
mod–_Çme
);

2489 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
mod–_Çme
);

2491 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Generic Battery Device");

2495 
mªuçùu»r
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
·th
, "manufacturer");

2496 ià(
mªuçùu»r
 !ğ
NULL
) {

2497 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "b©‹ry.v’dÜ", 
mªuçùu»r
);

2501 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "vŞge_max_design", &
vŞge_design
, 10)) {

2502 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.vŞge.design", 
vŞge_design
 / 1000);

2503 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.voltage.unit", "mV");

2504 } ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "vŞge_mš_design", &
vŞge_design
, 10)) {

2505 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.vŞge.design", 
vŞge_design
 / 1000);

2506 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.voltage.unit", "mV");

2510 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "’”gy_fuÎ_design", &
v®ue_fuÎ_design
, 10)) {

2511 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»pÜtšg.design", 
v®ue_fuÎ_design
 / 1000);

2512 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.reporting.unit", "mWh");

2513 } ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "ch¬ge_fuÎ_design", &
v®ue_fuÎ_design
, 10)) {

2514 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.»pÜtšg.design", 
v®ue_fuÎ_design
 / 1000);

2515 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.reporting.unit", "mAh");

2519 
£rŸl
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
·th
, "serial_number");

2520 ià(
£rŸl
 !ğ
NULL
) {

2521 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "b©‹ry.£rŸl", 
£rŸl
);

2525 
	`»äesh_b©‹ry_ç¡
 (
d
);

2526 
	}
}

2528 
gboŞ—n


2529 
	$pow”_suµly_»äesh
 (
H®Deviû
 *
d
)

2531 cÚ¡ 
gch¬
 *
ty³
;

2532 
ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.category");

2533 ià(
ty³
 =ğ
NULL
) {

2534  
FALSE
;

2536 ià(
	`¡rcmp
 (
ty³
, "ac_adapter") == 0) {

2537 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

2538 
	`»äesh_ac_ad­‹r
 (
d
);

2539 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

2540 } ià(
	`¡rcmp
 (
ty³
, "battery") == 0) {

2541 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

2542 
	`»äesh_b©‹ry_ç¡
 (
d
);

2543 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

2545 
	`HAL_WARNING
 (("Could‚ot„ecognise…ower_supplyype!"));

2546  
FALSE
;

2548  
TRUE
;

2549 
	}
}

2552 
gboŞ—n


2553 
	$pow”_suµly_b©‹ry_pŞl
 (
gpoš‹r
 
d©a
) {

2555 
GSLi¡
 *
i
;

2556 
GSLi¡
 *
b©‹ry_deviûs
;

2557 
H®Deviû
 *
d
;

2558 
gboŞ—n
 
b©‹ry_pŞËd
 = 
FALSE
;

2561 
b©‹ry_deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

2565 ià(
b©‹ry_deviûs
) {

2566 
i
 = 
b©‹ry_deviûs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

2567 cÚ¡ *
subsys
;

2569 
d
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

2572 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "battery.quirk.do_not_poll"))

2575 
subsys
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.subsystem");

2576 ià(
subsys
 && (
	`¡rcmp
(subsys, "power_supply") == 0)) {

2577 
	`h®_ut_g»p_disÿrd_exi¡šg_d©a
();

2578 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

2579 
	`»äesh_b©‹ry_ç¡
(
d
);

2580 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

2581 
b©‹ry_pŞËd
 = 
TRUE
;

2586 
	`g_¦i¡_ä“
 (
b©‹ry_deviûs
);

2588 
b©‹ry_pŞl_ruÂšg
 = 
b©‹ry_pŞËd
;

2589  
b©‹ry_pŞËd
;

2590 
	}
}

2592 
H®Deviû
 *

2593 
	$pow”_suµly_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
physdev
,

2594 cÚ¡ 
gch¬
 *
sysfs_·th_š_deviûs
)

2596 
H®Deviû
 *
d
 = 
NULL
;

2597 
gboŞ—n
 
is_b©‹ry
 = 
FALSE
;

2598 
gboŞ—n
 
is_ac_ad­‹r
 = 
FALSE
;

2599 *
ty³
 = 
NULL
;

2600 cÚ¡ *
b©‹ry_ty³
 = 
NULL
;

2603 
ty³
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "type");

2604 ià(
ty³
 =ğ
NULL
) {

2606 
fšish
;

2608 ià(
	`¡rÿ£cmp
 (
ty³
, "battery") == 0) {

2609 
is_b©‹ry
 = 
TRUE
;

2610 
b©‹ry_ty³
 = "primary";

2611 } ià(
	`¡rÿ£cmp
 (
ty³
, "ups") == 0) {

2612 
is_b©‹ry
 = 
TRUE
;

2613 
b©‹ry_ty³
 = "ups";

2614 } ià(
	`¡rÿ£cmp
 (
ty³
, "usb") == 0) {

2615 
is_b©‹ry
 = 
TRUE
;

2616 
b©‹ry_ty³
 = "usb";

2617 } ià(
	`¡rÿ£cmp
 (
ty³
, "mains") == 0) {

2618 
is_ac_ad­‹r
 = 
TRUE
;

2620 
	`HAL_WARNING
 (("Power supply is‚either‡c_adapter or battery!"));

2621 
fšish
;

2624 
d
 = 
	`h®_deviû_Ãw
 ();

2625 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

2626 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

2628 ià(
is_b©‹ry
 =ğ
TRUE
) {

2629 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "battery");

2630 ià(
b©‹ry_ty³
 !ğ
NULL
)

2631 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "b©‹ry.ty³", 
b©‹ry_ty³
);

2632 
	`»äesh_b©‹ry_¦ow
 (
d
);

2633 
	`h®_deviû_add_ÿ·b™y
 (
d
, "battery");

2636 ià(!
b©‹ry_pŞl_ruÂšg
) {

2637 #ifdeà
HAVE_GLIB_2_14


2638 
	`g_timeout_add_£cÚds
 (
POWER_SUPPLY_BATTERY_POLL_INTERVAL
,

2639 
pow”_suµly_b©‹ry_pŞl
,

2640 
NULL
);

2642 
	`g_timeout_add
 (1000 * 
POWER_SUPPLY_BATTERY_POLL_INTERVAL
,

2643 
pow”_suµly_b©‹ry_pŞl
,

2644 
NULL
);

2646 
b©‹ry_pŞl_ruÂšg
 = 
TRUE
;

2650 ià(
is_ac_ad­‹r
 =ğ
TRUE
) {

2651 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "ac_adapter");

2652 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Generic AC Adapter Device");

2653 
	`»äesh_ac_ad­‹r
 (
d
);

2654 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ac_adapter");

2657 
_have_sysfs_pow”_suµly
 = 
TRUE
;

2658 
fšish
:

2659  
d
;

2660 
	}
}

2662 
gboŞ—n


2663 
	$pow”_suµly_compu‹_udi
 (
H®Deviû
 *
d
)

2665 
gch¬
 
udi
[256];

2666 cÚ¡ *
dœ
;

2667 cÚ¡ *
Çme
;

2669 
dœ
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.sysfs_path");

2671 
Çme
 = 
	`h®_ut_g‘_Ï¡_–em’t
(
dœ
);

2672 ià(
Çme
)

2673 
	`h®d_compu‹_udi
 (
udi
,  (udi),

2675 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

2676 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.category"),

2677 
Çme
);

2679 
	`h®d_compu‹_udi
 (
udi
,  (udi),

2681 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

2682 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.category"));

2684 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

2685  
TRUE
;

2686 
	}
}

2690 #ifdeà
USE_ARCH_PS3


2691 
H®Deviû
 *

2692 
	$ps3_sy¡em_bus_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
,

2693 cÚ¡ 
gch¬
 *
sysfs_·th_š_deviûs
)

2695 
H®Deviû
 *
d
;

2696 cÚ¡ 
gch¬
 *
dev_id
;

2697 
gch¬
 
buf
[64];

2699 
d
 = 
	`h®_deviû_Ãw
 ();

2700 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

2701 ià(
·»Á_dev
 !ğ
NULL
) {

2702 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

2704 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

2707 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

2709 
dev_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

2711 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "ps3_sy¡em_bus.id", 
dev_id
);

2713 
	`g_¢´štf
 (
buf
,  (buf), "PS3 Deviû (%s)", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "ps3_system_bus.id"));

2714 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

2716  
d
;

2717 
	}
}

2719 
gboŞ—n


2720 
	$ps3_sy¡em_bus_compu‹_udi
 (
H®Deviû
 *
d
)

2722 
gch¬
 
udi
[256];

2724 
	`h®d_compu‹_udi
 (
udi
,  (udi),

2726 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "ps3_system_bus.id"));

2727 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

2729  
TRUE
;

2730 
	}
}

2735 
H®Deviû
 *

2736 
	$p£udo_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

2738 
H®Deviû
 *
d
;

2739 cÚ¡ 
gch¬
 *
dev_id
;

2740 
gch¬
 
buf
[64];

2742 
d
 = 
	`h®_deviû_Ãw
 ();

2743 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

2744 ià(
·»Á_dev
 !ğ
NULL
) {

2745 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

2747 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

2750 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

2752 
dev_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

2753 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "p£udo.id", 
dev_id
);

2755 
	`g_¢´štf
 (
buf
,  (buf), "SCSI Debug Deviû (%s)", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "pseudo.id"));

2756 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

2758  
d
;

2759 
	}
}

2761 
gboŞ—n


2762 
	$p£udo_compu‹_udi
 (
H®Deviû
 *
d
)

2764 
gch¬
 
udi
[256];

2766 
	`h®d_compu‹_udi
 (
udi
,  (udi),

2768 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "platform.id"));

2769 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

2771  
TRUE
;

2773 
	}
}

2777 
H®Deviû
 *

2778 
	$rfkl_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

2780 
H®Deviû
 *
d
;

2781 
gch¬
 
buf
[64];

2782 cÚ¡ 
gch¬
 *
ty³
;

2784 
d
 = 
	`h®_deviû_Ãw
 ();

2785 
	`h®_deviû_add_ÿ·b™y
 (
d
, "killswitch");

2786 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "killswitch");

2787 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

2789 ià(
·»Á_dev
 !ğ
NULL
) {

2790 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

2791 
	`h®_deviû_cİy_´İ”ty
Ğ
·»Á_dev
, "šfo.v’dÜ", 
d
, "info.vendor");

2793 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

2796 
ty³
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "type");

2797 ià(
ty³
 =ğ
NULL
)

2798 
ty³
 = "unknown";

2800 ià(
	`¡rÿ£cmp
 (
ty³
, "wimax") == 0) {

2801 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "killswitch.type", "wwan");

2803 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "klsw™ch.ty³", 
ty³
);

2806 
	`h®_ut_£t_št_äom_fe
 (
d
, "klsw™ch.¡©e", 
sysfs_·th
, "state", 10);

2808 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "killswitch.access_method", "rfkill");

2810 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "klsw™ch.Çme", 
sysfs_·th
, "name");

2812 
	`g_¢´štf
(
buf
, (buf), "% % Klsw™ch", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "killswitch.name"),

2813 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "killswitch.type"));

2814 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

2816  
d
;

2817 
	}
}

2819 
gboŞ—n


2820 
	$rfkl_»äesh
 (
H®Deviû
 *
d
)

2822 cÚ¡ *
sysfs_·th
;

2824 ià((
sysfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "lšux.sysfs_·th")è!ğ
NULL
) {

2826 
	`h®_ut_£t_št_äom_fe
 (
d
, "klsw™ch.¡©e", 
sysfs_·th
, "state", 10);

2829  
TRUE
;

2830 
	}
}

2832 
gboŞ—n


2833 
	$rfkl_compu‹_udi
 (
H®Deviû
 *
d
)

2835 
gch¬
 
udi
[256];

2837 
	`h®d_compu‹_udi
 (
udi
,  (udi),

2839 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

2840 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "killswitch.name"),

2841 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "killswitch.type"));

2842 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

2843  
TRUE
;

2844 
	}
}

2848 
H®Deviû
 *

2849 
	$scsi_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

2851 
H®Deviû
 *
d
 = 
NULL
;

2852 cÚ¡ 
gch¬
 *
bus_id
;

2853 
gšt
 
ho¡_num
, 
bus_num
, 
rg‘_num
, 
lun_num
;

2854 
ty³
;

2856 ià(
·»Á_dev
 =ğ
NULL
)

2857 
out
;

2859 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

2860 ià(
	`ssÿnf
 (
bus_id
, "%d:%d:%d:%d", &
ho¡_num
, &
bus_num
, &
rg‘_num
, &
lun_num
) != 4)

2861 
out
;

2863 
d
 = 
	`h®_deviû_Ãw
 ();

2864 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

2865 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

2866 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "scsi.ho¡", 
ho¡_num
);

2867 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "scsi.bus", 
bus_num
);

2868 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "scsi.rg‘", 
rg‘_num
);

2869 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "scsi.lun", 
lun_num
);

2871 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

2873 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "SCSI Device");

2875 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "scsi.mod–", 
sysfs_·th
, "model");

2876 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "scsi.v’dÜ", 
sysfs_·th
, "vendor");

2877 
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "ty³", &
ty³
, 0);

2878 
	`HAL_INFO
 (("%s/ty³ -> %d (-> scsi.ty³)", 
sysfs_·th
, 
ty³
));

2879 
ty³
) {

2886 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "scsi.type", "disk");

2889 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "scsi.type", "tape");

2893 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "scsi.type", "printer");

2896 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "scsi.type", "processor");

2900 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "scsi.type", "cdrom");

2903 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "scsi.type", "scanner");

2906 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "scsi.type", "medium_changer");

2909 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "scsi.type", "comm");

2912 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "scsi.type", "raid");

2915 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "scsi.type", "unknown");

2918 
out
:

2919  
d
;

2920 
	}
}

2922 
gboŞ—n


2923 
	$scsi_compu‹_udi
 (
H®Deviû
 *
d
)

2925 
gch¬
 
udi
[256];

2927 
	`h®d_compu‹_udi
 (
udi
,  (udi),

2929 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

2930 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "scsi.lun"));

2931 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

2932  
TRUE
;

2934 
	}
}

2938 
H®Deviû
 *

2939 
	$scsi_g’”ic_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

2941 
H®Deviû
 *
d
;

2943 
d
 = 
NULL
;

2945 ià(
·»Á_dev
 =ğ
NULL
 || 
·»Á_·th
 == NULL)

2946 
out
;

2948 
d
 = 
	`h®_deviû_Ãw
 ();

2949 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

2950 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

2951 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "scsi_generic");

2952 
	`h®_deviû_add_ÿ·b™y
 (
d
, "scsi_generic");

2953 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "SCSI Generic Interface");

2954 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "scsi_g’”ic.deviû", 
deviû_fe
);

2956 
out
:

2957  
d
;

2958 
	}
}

2960 
gboŞ—n


2961 
	$scsi_g’”ic_compu‹_udi
 (
H®Deviû
 *
d
)

2963 
gch¬
 
udi
[256];

2965 
	`h®d_compu‹_udi
 (
udi
,  (udi),

2967 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"));

2968 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

2969  
TRUE
;

2970 
	}
}

2978 
gboŞ—n


2979 
	$missšg_scsi_ho¡
 (cÚ¡ 
gch¬
 *
sysfs_·th
, 
HÙ¶ugEv’t
 *
deviû_ev’t
, 
HÙ¶ugAùiÚTy³
 
aùiÚ
)

2981 
gch¬
 
·th
[
HAL_PATH_MAX
];

2982 
H®Deviû
 *
d
;

2983 
HÙ¶ugEv’t
 *
ho¡_ev’t
;

2984 cÚ¡ 
gch¬
 *
Ï¡_–em
;

2985 
gšt
 
ho¡_num
, 
bus_num
, 
rg‘_num
, 
lun_num
;

2986 
max
;

2987 
gšt
 
num
 = -1;

2988 
rc
 = 
FALSE
;

2991 
Ï¡_–em
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

2992 ià(
	`ssÿnf
 (
Ï¡_–em
, "%d:%d:%d:%d", &
ho¡_num
, &
bus_num
, &
rg‘_num
, &
lun_num
) != 4)

2993 
out
;

2996 ià(
deviû_ev’t
->
»po¡ed
)

2997 
out
;

3000 
	`g_¡¾ıy
(
·th
, 
sysfs_·th
, (path));

3001 
max
 = 100;

3002 
max
--) {

3003 ià(!
	`h®_ut_·th_asûnd
 (
·th
))

3004 
out
;

3006 
Ï¡_–em
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
·th
);

3007 ià(
	`ssÿnf
 (
Ï¡_–em
, "ho¡%d", &
num
) == 1)

3012 ià(
ho¡_num
 !ğ
num
)

3013 
out
;

3016 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

3018 
·th
);

3021 ià(
aùiÚ
 =ğ
HOTPLUG_ACTION_ADD
 && 
d
 !ğ
NULL
)

3022 
out
;

3025 ià(
aùiÚ
 =ğ
HOTPLUG_ACTION_REMOVE
 && 
d
 =ğ
NULL
)

3026 
out
;

3029 
rc
 = 
TRUE
;

3030 
ho¡_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

3031 
ho¡_ev’t
->
aùiÚ
 =‡ction;

3032 
ho¡_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS_DEVICE
;

3033 
	`g_¡¾ıy
 (
ho¡_ev’t
->
sysfs
.
subsy¡em
, "scsi_host",  (host_event->sysfs.subsystem));

3034 
	`g_¡¾ıy
 (
ho¡_ev’t
->
sysfs
.
sysfs_·th
, 
·th
,  (host_event->sysfs.sysfs_path));

3035 
ho¡_ev’t
->
sysfs
.
Ãt_ifšdex
 = -1;

3038 ià(
aùiÚ
 =ğ
HOTPLUG_ACTION_ADD
) {

3039 
	`hÙ¶ug_ev’t_’queue_©_äÚt
 (
deviû_ev’t
);

3040 
	`hÙ¶ug_ev’t_’queue_©_äÚt
 (
ho¡_ev’t
);

3041 
	`hÙ¶ug_ev’t_»po¡ed
 (
deviû_ev’t
);

3042 
out
;

3046 ià(
aùiÚ
 =ğ
HOTPLUG_ACTION_REMOVE
)

3047 
	`hÙ¶ug_ev’t_’queue
 (
ho¡_ev’t
);

3048 
out
:

3049  
rc
;

3050 
	}
}

3052 
H®Deviû
 *

3053 
	$scsi_ho¡_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

3055 
H®Deviû
 *
d
;

3056 
gšt
 
ho¡_num
;

3057 cÚ¡ 
gch¬
 *
Ï¡_–em
;

3059 
d
 = 
NULL
;

3062 ià(
	`¡r¡r
(
sysfs_·th
, "şass/scsi_ho¡"è!ğ
NULL
)

3063 
out
;

3065 
Ï¡_–em
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

3066 ià(
	`ssÿnf
 (
Ï¡_–em
, "ho¡%d", &
ho¡_num
) != 1)

3067 
out
;

3069 
d
 = 
	`h®_deviû_Ãw
 ();

3070 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

3071 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "scsi_ho¡.ho¡", 
ho¡_num
);

3072 ià(
·»Á_dev
 !ğ
NULL
)

3073 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3075 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

3076 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "scsi_host");

3077 
	`h®_deviû_add_ÿ·b™y
 (
d
, "scsi_host");

3078 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "SCSI Host Adapter");

3079 
out
:

3080  
d
;

3081 
	}
}

3083 
gboŞ—n


3084 
	$scsi_ho¡_compu‹_udi
 (
H®Deviû
 *
d
)

3086 
gch¬
 
udi
[256];

3088 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3090 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"));

3091 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

3092  
TRUE
;

3093 
	}
}

3097 
H®Deviû
 *

3098 
	$sdio_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

3100 
H®Deviû
 *
d
;

3101 cÚ¡ 
gch¬
 *
bus_id
;

3102 
gch¬
 
buf
[256];

3103 
gšt
 
ho¡_num
, 
rÿ
, 
ÿrd_id
;

3105 ià(
·»Á_dev
 =ğ
NULL
)

3106  
NULL
;

3108 
d
 = 
	`h®_deviû_Ãw
 ();

3109 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

3110 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3112 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

3114 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

3115 
	`ssÿnf
 (
bus_id
, "mmc%d:%x:%d", &
ho¡_num
, &
rÿ
, &
ÿrd_id
);

3116 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "sdio.rÿ", 
rÿ
);

3117 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "sdio.ÿrd_id", 
ÿrd_id
);

3119 
	`h®_ut_£t_št_äom_fe
 (
d
, "sdio.v’dÜ_id", 
sysfs_·th
, "vendor", 16);

3120 
	`h®_ut_£t_št_äom_fe
 (
d
, "sdio.´oduù_id", 
sysfs_·th
, "device", 16);

3121 
	`h®_ut_£t_št_äom_fe
 (
d
, "sdio.şass_id", 
sysfs_·th
, "class", 16);

3124 
	`g_¢´štf
 (
buf
,  (buf), "UnknowÀ(0x%04x)", 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "sdio.vendor_id"));

3125 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.v’dÜ", 
buf
);

3126 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sdio.v’dÜ", 
buf
);

3129 
	`g_¢´štf
 (
buf
,  (buf), "UnknowÀ(0x%04x)", 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "sdio.product_id"));

3130 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

3131 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sdio.´oduù", 
buf
);

3133  
d
;

3134 
	}
}

3136 
gboŞ—n


3137 
	$sdio_compu‹_udi
 (
H®Deviû
 *
d
)

3139 
gch¬
 
udi
[256];

3141 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3143 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

3144 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "sdio.card_id"));

3145 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

3146  
TRUE
;

3147 
	}
}

3151 
H®Deviû
 *

3152 
	$£rŸl_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

3154 
pÜŠum
;

3155 
H®Deviû
 *
d
;

3156 cÚ¡ 
gch¬
 *
Ï¡_–em
;

3158 
d
 = 
NULL
;

3160 ià(
·»Á_dev
 =ğ
NULL
 || 
·»Á_·th
 =ğNULL || 
deviû_fe
 == NULL || device_file[0] == '\0') {

3161 
out
;

3164 
d
 = 
	`h®_deviû_Ãw
 ();

3165 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

3166 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3167 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "serial");

3168 
	`h®_deviû_add_ÿ·b™y
 (
d
, "serial");

3169 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "£rŸl.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3170 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "£rŸl.deviû", 
deviû_fe
);

3172 
Ï¡_–em
 = 
	`h®_ut_g‘_Ï¡_–em’t
(
sysfs_·th
);

3173 ià(
	`ssÿnf
 (
Ï¡_–em
, "‰yS%d", &
pÜŠum
) == 1) {

3174 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "£rŸl.pÜt", 
pÜŠum
);

3175 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "serial.type", "platform");

3176 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product",

3177 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
·»Á_dev
, "info.product"));

3178 } ià(
	`ssÿnf
 (
Ï¡_–em
, "‰yUSB%d", &
pÜŠum
) == 1) {

3179 
H®Deviû
 *
usbdev
;

3180 
pÜt_numb”
;

3183 ià(
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "deviû/pÜt_numb”", &
pÜt_numb”
, 10)) {

3184 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "£rŸl.pÜt", 
pÜt_numb”
);

3186 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "£rŸl.pÜt", 
pÜŠum
);

3188 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "serial.type", "usb");

3190 
usbdev
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (),

3191 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
·»Á_dev
, "info.parent"));

3192 ià(
usbdev
 !ğ
NULL
) {

3193 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product",

3194 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
usbdev
, "info.product"));

3196 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "USB Serial Port");

3199 
Ën
;

3200 
i
;

3202 
Ën
 = 
	`¡¾’
 (
Ï¡_–em
);

3204 
i
 = 
Ën
 - 1; i >ğ0 && 
	`isdig™
 (
Ï¡_–em
[i]); --i)

3206 ià(
i
 =ğ
Ën
 - 1)

3207 
pÜŠum
 = 0;

3209 
pÜŠum
 = 
	`©oi
 (
Ï¡_–em
 + 
i
 + 1);

3211 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "£rŸl.pÜt", 
pÜŠum
);

3212 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "serial.type", "unknown");

3213 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Serial Port");

3216 
out
:

3217  
d
;

3218 
	}
}

3220 cÚ¡ 
gch¬
 *

3221 
	$£rŸl_g‘_´ob”
 (
H®Deviû
 *
d
)

3223 cÚ¡ 
gch¬
 *
dev
;

3227 
dev
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.device_file");

3228 ià(
dev
 && !
	`¡ºcmp
(dev, "/dev/ttyS", 9))

3231  
NULL
;

3232 
	}
}

3234 
gboŞ—n


3235 
	$£rŸl_compu‹_udi
 (
H®Deviû
 *
d
)

3237 
gch¬
 
udi
[256];

3239 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3241 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

3242 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "serial.type"),

3243 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "serial.port"));

3244 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

3246  
TRUE
;

3247 
	}
}

3251 
H®Deviû
 *

3252 
	$£rio_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

3254 
H®Deviû
 *
d
;

3255 cÚ¡ 
gch¬
 *
bus_id
;

3257 
d
 = 
	`h®_deviû_Ãw
 ();

3258 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

3259 ià(
·»Á_dev
 !ğ
NULL
) {

3260 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3262 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

3265 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

3267 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

3268 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "£rio.id", 
bus_id
);

3269 ià(!
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "£rio.desütiÚ", 
sysfs_·th
, "description")) {

3270 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "£rio.desütiÚ", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (d, "serio.id"));

3272 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (d, "serio.description"));

3274  
d
;

3275 
	}
}

3277 
gboŞ—n


3278 
	$£rio_compu‹_udi
 (
H®Deviû
 *
d
)

3280 
gch¬
 
udi
[256];

3282 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3284 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

3285 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "serio.description"));

3286 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

3287  
TRUE
;

3289 
	}
}

3294 
	$asound_ÿrd_id_£t
 (
ÿrdnum
, 
H®Deviû
 *
d
, cÚ¡ *
´İ”tyÇme
)

3296 
lše¡¬t
[5];

3297 
gch¬
 *
®§Çme
;

3299 
	`¢´štf
 (
lše¡¬t
,  (lše¡¬t), "%2d [", 
ÿrdnum
);

3300 
®§Çme
 = 
	`h®_ut_g»p_fe_Ãxt_lše
 ("/´oc/asound", "ÿrds", 
lše¡¬t
, 
FALSE
);

3301 ià(
®§Çme
 !ğ
NULL
) {

3302 
gch¬
 *
’d
;

3303 
’d
 = 
	`¡r¡r
 (
®§Çme
, "‡t ");

3304 ià(
’d
 !ğ
NULL
) {

3305 
’d
[0] = '\0';

3307 
®§Çme
 = 
	`g_¡r¡r
 (alsaname);

3308 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, 
´İ”tyÇme
, 
®§Çme
);

3310 
	}
}

3312 
H®Deviû
 *

3313 
	$sound_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

3315 
H®Deviû
 *
d
;

3316 
ÿrdnum
, 
deviûnum
;

3317 
ty³
;

3318 cÚ¡ 
gch¬
 *
deviû
;

3319 
gch¬
 *
deviû_id
;

3320 
­rocdœ
[256];

3321 
buf
[256];

3323 
d
 = 
NULL
;

3325 
	`HAL_INFO
 (("sound_add: sysfs_·th=% deviû_fe=% ·»Á_dev=0x%08x…¬’t_·th=%s", 
sysfs_·th
, 
deviû_fe
, 
·»Á_dev
, 
·»Á_·th
));

3327 
d
 = 
	`h®_deviû_Ãw
 ();

3328 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

3329 
deviû
 = 
	`h®_ut_g‘_Ï¡_–em’t
(
sysfs_·th
);

3331 ià(
deviû_fe
[0] =ğ'\0' && 
·»Á_dev
 =ğ
NULL
 && 
·»Á_·th
 == NULL) {

3332 
out
;

3333 } ià(
deviû_fe
[0] =ğ'\0' && 
·»Á_dev
 !ğ
NULL
 && 
·»Á_·th
 != NULL) {

3334 
	`HAL_INFO
(("sound_add: hªdË sound c¬d %s", 
sysfs_·th
));

3336 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "sound");

3337 
	`h®_deviû_add_ÿ·b™y
 (
d
, "sound");

3338 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sound.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3339 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3341 ià(
	`ssÿnf
 (
deviû
, "ÿrd%d", &
ÿrdnum
) == 1) {

3342 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "sound.ÿrd", 
ÿrdnum
);

3343 
	`asound_ÿrd_id_£t
 (
ÿrdnum
, 
d
, "sound.card_id");

3344 
	`¢´štf
 (
buf
,  (buf), "% Sound C¬d", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "sound.card_id"));

3345 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

3347 } ià(
·»Á_dev
 =ğ
NULL
 || 
·»Á_·th
 == NULL) {

3350 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

3352 ià(!
	`¡ºcmp
 (
deviû
, "timer", 5)){

3354 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "alsa");

3355 
	`h®_deviû_add_ÿ·b™y
 (
d
, "alsa");

3356 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "alsa.type", "timer");

3357 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "ALSA Timer Device");

3358 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "®§.deviû_fe", 
deviû_fe
);

3359 } ià(!
	`¡ºcmp
 (
deviû
, "sequencer", 9)){

3361 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "oss");

3362 
	`h®_deviû_add_ÿ·b™y
 (
d
, "oss");

3363 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "oss.type", "sequencer");

3364 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "OSS Sequencer Device");

3365 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "oss.deviû_fe", 
deviû_fe
);

3366 } ià(!
	`¡ºcmp
 (
deviû
, "£q", 3è&& 
	`¡¾’
(device) == 3) {

3368 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "alsa");

3369 
	`h®_deviû_add_ÿ·b™y
 (
d
, "alsa");

3370 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "alsa.type", "sequencer");

3371 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "ALSA Sequencer Device");

3372 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "®§.deviû_fe", 
deviû_fe
);

3374 
”rÜ
;

3378 ià(
	`ssÿnf
 (
deviû
, "cÚŒŞC%d", &
ÿrdnum
) == 1) {

3380 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "alsa");

3381 
	`h®_deviû_add_ÿ·b™y
 (
d
, "alsa");

3382 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "®§.deviû_fe", 
deviû_fe
);

3383 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3384 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "®§.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3385 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "®§.ÿrd", 
ÿrdnum
);

3386 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "alsa.type", "control");

3388 
	`asound_ÿrd_id_£t
 (
ÿrdnum
, 
d
, "alsa.card_id");

3390 
	`¢´štf
 (
buf
,  (buf), "%s ALSA Control Device",

3391 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "alsa.card_id"));

3392 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

3394 } ià(
	`ssÿnf
 (
deviû
, "pcmC%dD%d%c", &
ÿrdnum
, &
deviûnum
, &
ty³
) == 3) {

3396 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "alsa");

3397 
	`h®_deviû_add_ÿ·b™y
 (
d
, "alsa");

3398 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "®§.deviû_fe", 
deviû_fe
);

3399 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3400 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "®§.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3401 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "®§.ÿrd", 
ÿrdnum
);

3402 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "®§.deviû", 
deviûnum
);

3404 
	`asound_ÿrd_id_£t
 (
ÿrdnum
, 
d
, "alsa.card_id");

3406 ià(!
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "®§.pcm_şass", 
sysfs_·th
, "pcm_class"))

3407 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "alsa.pcm_class", "unknown");

3409 
	`¢´štf
 (
­rocdœ
,  (aprocdir), "/proc/asound/card%d/pcm%d%c",

3410 
ÿrdnum
, 
deviûnum
, 
ty³
);

3411 
deviû_id
 = 
	`h®_ut_g»p_fe
 (
­rocdœ
, "šfo", "Çme: ", 
FALSE
);

3412 ià(
deviû_id
 !ğ
NULL
) {

3413 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "®§.deviû_id", 
deviû_id
);

3416 ià(
ty³
 == 'p') {

3417 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "alsa.type", "playback");

3418 ià(
deviû_id
 !ğ
NULL
) {

3419 
	`¢´štf
 (
buf
,  (buf), "% ALSA PÏyback Deviû", 
deviû_id
);

3420 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

3422 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "ALSA Playback Device");

3423 } ià(
ty³
 == 'c') {

3424 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "alsa.type", "capture");

3425 ià(
deviû_id
 !ğ
NULL
) {

3426 
	`¢´štf
 (
buf
,  (buf), "% ALSA C­tu» Deviû", 
deviû_id
);

3427 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

3429 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "ALSA Capture Device");

3431 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "alsa.type", "unknown");

3432 ià(
deviû_id
 !ğ
NULL
) {

3433 
	`¢´štf
 (
buf
,  (buf), "% ALSA Deviû", 
deviû_id
);

3434 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

3436 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "ALSA Device");

3438 } ià((
	`ssÿnf
 (
deviû
, "hwC%dD%d", &
ÿrdnum
, &
deviûnum
) == 2) ||

3439 (
	`ssÿnf
 (
deviû
, "midiC%dD%d", &
ÿrdnum
, &
deviûnum
) == 2)) {

3441 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "alsa");

3442 
	`h®_deviû_add_ÿ·b™y
 (
d
, "alsa");

3443 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "®§.deviû_fe", 
deviû_fe
);

3444 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3445 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "®§.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3446 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "®§.ÿrd", 
ÿrdnum
);

3447 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "®§.deviû", 
deviûnum
);

3449 
	`asound_ÿrd_id_£t
 (
ÿrdnum
, 
d
, "alsa.card_id");

3451 ià(!
	`¡ºcmp
 (
deviû
, "hwC", 3)) {

3452 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "alsa.type", "hw_specific");

3453 
	`¢´štf
 (
buf
,  (buf), "% ALSA h¬dw¬¥ecifiøDeviû", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "alsa.card_id"));

3454 } ià(!
	`¡ºcmp
 (
deviû
, "midiC", 5)) {

3455 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "alsa.type", "midi");

3456 
	`¢´štf
 (
buf
,  (buf), "% ALSA MIDI Deviû", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "alsa.card_id"));

3458 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

3460 } ià(!
	`¡ºcmp
 (
deviû
, "dsp", 3) || !strncmp (device, "adsp", 4) ||

3461 !
	`¡ºcmp
 (
deviû
, "midi", 4) || !strncmp (device, "amidi", 5) ||

3462 !
	`¡ºcmp
 (
deviû
, "audio", 5) || !strncmp (device, "mixer", 5)) {

3465 
CÏssDevOSSDeviûTy³s
 
ty³
;

3467 ià(!
	`¡ºcmp
 (
deviû
, "dsp", 3)) {

3468 if(
	`ssÿnf
 (
deviû
, "d¥%d", &
ÿrdnum
) != 1) cardnum = 0;

3469 
ty³
 = 
OSS_DEVICE_TYPE_DSP
;

3470 } ià(!
	`¡ºcmp
 (
deviû
, "adsp", 4)) {

3471 if(
	`ssÿnf
 (
deviû
, "ad¥%d", &
ÿrdnum
) != 1) cardnum = 0;

3472 
ty³
 = 
OSS_DEVICE_TYPE_ADSP
;

3473 } ià(!
	`¡ºcmp
 (
deviû
, "midi", 4)) {

3474 if(
	`ssÿnf
 (
deviû
, "midi%d", &
ÿrdnum
) != 1) cardnum = 0;

3475 
ty³
 = 
OSS_DEVICE_TYPE_MIDI
;

3476 } ià(!
	`¡ºcmp
 (
deviû
, "amidi", 5)) {

3477 if(
	`ssÿnf
 (
deviû
, "amidi%d", &
ÿrdnum
) != 1) cardnum = 0;

3478 
ty³
 = 
OSS_DEVICE_TYPE_AMIDI
;

3479 } ià(!
	`¡ºcmp
 (
deviû
, "audio", 5)) {

3480 if(
	`ssÿnf
 (
deviû
, "audio%d", &
ÿrdnum
) != 1) cardnum = 0;

3481 
ty³
 = 
OSS_DEVICE_TYPE_AUDIO
;

3482 } ià(!
	`¡ºcmp
 (
deviû
, "mixer", 5)) {

3483 if(
	`ssÿnf
 (
deviû
, "mix”%d", &
ÿrdnum
) != 1) cardnum = 0;

3484 
ty³
 = 
OSS_DEVICE_TYPE_MIXER
;

3486 
ÿrdnum
 = 0;

3487 
ty³
 = 
OSS_DEVICE_TYPE_UNKNOWN
;

3490 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "oss");

3491 
	`h®_deviû_add_ÿ·b™y
 (
d
, "oss");

3492 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "oss.deviû_fe", 
deviû_fe
);

3493 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3494 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "oss.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3495 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "oss.ÿrd", 
ÿrdnum
);

3497 
	`asound_ÿrd_id_£t
 (
ÿrdnum
, 
d
, "oss.card_id");

3499 
	`¢´štf
 (
­rocdœ
,  (­rocdœ), "/´oc/asound/ÿrd%d/pcm0p", 
ÿrdnum
);

3500 
deviû_id
 = 
	`h®_ut_g»p_fe
 (
­rocdœ
, "šfo", "Çme: ", 
FALSE
);

3501 ià(
deviû_id
 !ğ
NULL
) {

3502 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "oss.deviû_id", 
deviû_id
);

3505 
ty³
) {

3506 
OSS_DEVICE_TYPE_MIXER
:

3507 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "oss.type", "mixer");

3508 ià(
deviû_id
 !ğ
NULL
)

3509 
	`¢´štf
 (
buf
,  (buf), "% OSS CÚŒŞ Deviû", 
deviû_id
);

3511 
	`¢´štf
 (
buf
,  (buf), "%s OSS Control Device",

3512 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "oss.card_id"));

3514 
OSS_DEVICE_TYPE_DSP
:

3515 
OSS_DEVICE_TYPE_AUDIO
:

3516 
OSS_DEVICE_TYPE_ADSP
:

3517 ià(
ty³
 =ğ
OSS_DEVICE_TYPE_ADSP
)

3518 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "oss.device", 1);

3520 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "oss.device", 0);

3522 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "oss.type", "pcm");

3523 ià(
deviû_id
 !ğ
NULL
)

3524 
	`¢´štf
 (
buf
,  (buf), "% OSS PCM Deviû", 
deviû_id
);

3526 
	`¢´štf
 (
buf
,  (buf), "%s OSS PCM Device",

3527 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "oss.card_id"));

3529 
OSS_DEVICE_TYPE_MIDI
:

3530 
OSS_DEVICE_TYPE_AMIDI
:

3531 ià(
ty³
 =ğ
OSS_DEVICE_TYPE_AMIDI
)

3532 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "oss.device", 1);

3534 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "oss.device", 0);

3535 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "oss.type", "midi");

3536 ià(
deviû_id
 !ğ
NULL
)

3537 
	`¢´štf
 (
buf
,  (buf), "% OSS MIDI Deviû", 
deviû_id
);

3539 
	`¢´štf
 (
buf
,  (buf), "%s OSS MIDI Device",

3540 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "oss.card_id"));

3542 
OSS_DEVICE_TYPE_UNKNOWN
:

3544 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "oss.type", "unknown");

3545 ià(
deviû_id
 !ğ
NULL
)

3546 
	`¢´štf
 (
buf
,  (buf), "% OSS Deviû", 
deviû_id
);

3548 
	`¢´štf
 (
buf
,  (buf), "%s OSS Device",

3549 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "oss.card_id"));

3552 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

3555 
”rÜ
;

3558 
out
:

3559  
d
;

3561 
”rÜ
:

3562 
	`g_objeù_uÄef
 (
d
);

3563 
d
 = 
NULL
;

3564  
d
;

3565 
	}
}

3567 
gboŞ—n


3568 
	$sound_compu‹_udi
 (
H®Deviû
 *
d
)

3570 
gch¬
 
udi
[256];

3572 ià(
	`h®_deviû_has_´İ”ty
(
d
, "sound.card")) {

3574 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3576 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

3577 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "sound.card"));

3578 } ià(
	`h®_deviû_has_´İ”ty
(
d
, "alsa.card")) {

3580 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3582 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

3583 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "alsa.type"),

3584 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "alsa.device"));

3585 } ià(
	`h®_deviû_has_´İ”ty
(
d
, "oss.card")) {

3587 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3589 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

3590 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "oss.type"),

3591 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "oss.device"));

3592 } ià(
	`h®_deviû_has_´İ”ty
(
d
, "alsa.type")) {

3594 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3596 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

3597 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "alsa.type"));

3598 } ià(
	`h®_deviû_has_´İ”ty
(
d
, "oss.type")) {

3600 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3602 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

3603 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "oss.type"));

3606 
	`h®d_compu‹_udi
 (
udi
,  (udi), "%s_sound_unknown",

3607 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"));

3609 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

3611  
TRUE
;

3612 
	}
}

3616 
H®Deviû
 *

3617 
	$³_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
,

3618 
H®Deviû
 *
·»Á_dev
, cÚ¡ 
gch¬
 *
·»Á_·th
)

3620 
H®Deviû
 *
d
;

3621 cÚ¡ 
gch¬
 *
dev_’Œy
;

3623 ià(
·»Á_dev
 =ğ
NULL
)

3624  
NULL
;

3626 
d
 = 
	`h®_deviû_Ãw
 ();

3627 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

3628 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3629 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "tape");

3630 
	`h®_deviû_add_ÿ·b™y
 (
d
, "tape");

3631 
	`h®_deviû_add_ÿ·b™y
 (
·»Á_dev
, "tape");

3633 
dev_’Œy
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "dev");

3634 ià(
dev_’Œy
 !ğ
NULL
) {

3635 
majÜ
, 
mšÜ
;

3637 ià(
	`ssÿnf
 (
dev_’Œy
, "%d:%d", &
majÜ
, &
mšÜ
) != 2) {

3638 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "³.majÜ", 
majÜ
);

3639 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "³.mšÜ", 
mšÜ
);

3642  
d
;

3643 
	}
}

3645 
gboŞ—n


3646 
	$³_compu‹_udi
 (
H®Deviû
 *
d
)

3648 
gch¬
 
udi
[256];

3649 cÚ¡ 
gch¬
 *
sysfs_Çme
;

3651 
sysfs_Çme
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
h®_deviû_´İ”ty_g‘_¡ršg


3652 (
d
, "linux.sysfs_path"));

3653 ià(!
sysfs_Çme
)

3654  
FALSE
;

3655 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3657 
sysfs_Çme
);

3658 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

3660  
TRUE
;

3661 
	}
}

3666 
	$usbif_£t_Çme
 (
H®Deviû
 *
d
, 
ifşass
, 
ifsubşass
, 
iårÙocŞ
)

3668 cÚ¡ *
Çme
;

3670 
ifşass
) {

3673 
Çme
 = "USB Interface";

3676 
Çme
 = "USB Audio Interface";

3679 
Çme
 = "USB Communications Interface";

3682 
Çme
 = "USB HID Interface";

3685 
Çme
 = "USB Imaging Interface";

3688 
Çme
 = "USB Printer Interface";

3691 
Çme
 = "USB Mass Storage Interface";

3694 
Çme
 = "USB Hub Interface";

3697 
Çme
 = "USB Data Interface";

3700 
Çme
 = "USB Chip/Smartcard Interface";

3703 
Çme
 = "USB Content Security Interface";

3706 
Çme
 = "USB Video Interface";

3709 
Çme
 = "USB Diagnostic Interface";

3712 
Çme
 = "USB Wireless Interface";

3715 
Çme
 = "USB Miscelleneous Interface";

3718 
Çme
 = "USB Application Specific Interface";

3721 
Çme
 = "USB Vendor Specific Interface";

3725 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "usb.´oduù", 
Çme
);

3726 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
Çme
);

3727 
	}
}

3729 
H®Deviû
 *

3730 
	$usb_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

3732 
H®Deviû
 *
d
;

3733 cÚ¡ 
gch¬
 *
bus_id
;

3735 
d
 = 
	`h®_deviû_Ãw
 ();

3736 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

3737 ià(
·»Á_dev
 !ğ
NULL
) {

3738 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3742 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

3743 ià(
	`¡rchr
 (
bus_id
, ':'è=ğ
NULL
) {

3744 
gšt
 
bmA‰ribu‹s
;

3745 *
s
;

3747 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.subsystem", "usb_device");

3749 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

3751 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "usb_deviû.lšux.sysfs_·th", 
sysfs_·th
);

3753 
	`h®_ut_£t_¡ršg_äom_fe
(
d
, "usb_deviû.cÚfigu¿tiÚ", 
sysfs_·th
, "configuration");

3754 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb_deviû.cÚfigu¿tiÚ_v®ue", 
sysfs_·th
, "bConfigurationValue", 10);

3755 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb_deviû.num_cÚfigu¿tiÚs", 
sysfs_·th
, "bNumConfigurations", 10);

3756 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb_deviû.num_š‹rçûs", 
sysfs_·th
, "bNumInterfaces", 10);

3758 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb_deviû.deviû_şass", 
sysfs_·th
, "bDeviceClass", 16);

3759 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb_deviû.deviû_subşass", 
sysfs_·th
, "bDeviceSubClass", 16);

3760 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb_deviû.deviû_´ÙocŞ", 
sysfs_·th
, "bDeviceProtocol", 16);

3762 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb_deviû.v’dÜ_id", 
sysfs_·th
, "idVendor", 16);

3763 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb_deviû.´oduù_id", 
sysfs_·th
, "idProduct", 16);

3766 
gch¬
 
buf
[64];

3767 *
v’dÜ_Çme
;

3768 *
´oduù_Çme
;

3770 
	`ids_fšd_usb
 (
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "usb_device.vendor_id"),

3771 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "usb_device.product_id"),

3772 &
v’dÜ_Çme
, &
´oduù_Çme
);

3774 ià(
v’dÜ_Çme
 !ğ
NULL
) {

3775 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "usb_deviû.v’dÜ", 
v’dÜ_Çme
);

3776 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.v’dÜ", 
v’dÜ_Çme
);

3778 ià(!
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "usb_device.vendor",

3779 
sysfs_·th
, "manufacturer")) {

3780 
	`g_¢´štf
 (
buf
,  (buf), "Unknown (0x%04x)",

3781 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "usb_device.vendor_id"));

3782 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.v’dÜ", 
buf
);

3784 
	`h®_deviû_´İ”ty_£t_¡ršg
 (

3785 
d
, "info.vendor",

3786 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "usb_device.vendor"));

3790 ià(
´oduù_Çme
 !ğ
NULL
) {

3791 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "usb_deviû.´oduù", 
´oduù_Çme
);

3792 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
´oduù_Çme
);

3794 ià(!
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "usb_device.product",

3795 
sysfs_·th
, "product")) {

3796 
	`g_¢´štf
 (
buf
,  (buf), "Unknown (0x%04x)",

3797 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "usb_device.product_id"));

3798 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

3800 
	`h®_deviû_´İ”ty_£t_¡ršg
 (

3801 
d
, "info.product",

3802 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "usb_device.product"));

3807 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb_deviû.deviû_»visiÚ_bcd", 
sysfs_·th
, "bcdDevice", 16);

3809 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb_deviû.max_pow”", 
sysfs_·th
, "bMaxPower", 10);

3810 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb_deviû.num_pÜts", 
sysfs_·th
, "maxchild", 10);

3811 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb_deviû.lšux.deviû_numb”", 
sysfs_·th
, "devnum", 10);

3813 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "usb_deviû.£rŸl", 
sysfs_·th
, "serial");

3814 
	`h®_ut_£t_doubË_äom_fe
 (
d
, "usb_deviû.¥“d", 
sysfs_·th
, "speed");

3815 
	`h®_ut_£t_doubË_äom_fe
 (
d
, "usb_deviû.v”siÚ", 
sysfs_·th
, "version");

3817 
	`h®_ut_g‘_št_äom_fe
 (
sysfs_·th
, "bmA‰ribu‹s", &
bmA‰ribu‹s
, 16);

3818 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "usb_deviû.is_£lf_pow”ed", (
bmA‰ribu‹s
 & 0x40) != 0);

3819 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "usb_deviû.ÿn_wake_up", (
bmA‰ribu‹s
 & 0x20) != 0);

3821 ià(
	`¡ºcmp
 (
bus_id
, "usb", 3) == 0)

3822 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "usb_deviû.bus_numb”", 
	`©oi
 (
bus_id
 + 3));

3824 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "usb_deviû.bus_numb”", 
	`©oi
 (
bus_id
));

3826 
s
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "../mode");

3827 ià(
s
) {

3828 
	`h®_deviû_add_ÿ·b™y
 (
d
, "button");

3829 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "button.type", "usb.cable");

3830 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "bu‰Ú.has_¡©e", 
FALSE
);

3836 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.subsystem", "usb");

3839 ià(
·»Á_dev
 !ğ
NULL
)

3840 
	`h®_deviû_m”ge_w™h_»wr™e
 (
d
, 
·»Á_dev
, "usb.", "usb_device.");

3842 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

3844 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "usb.lšux.sysfs_·th", 
sysfs_·th
);

3846 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb.š‹rçû.numb”", 
sysfs_·th
, "bInterfaceNumber", 10);

3848 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb.š‹rçû.şass", 
sysfs_·th
, "bInterfaceClass", 16);

3849 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb.š‹rçû.subşass", 
sysfs_·th
, "bInterfaceSubClass", 16);

3850 
	`h®_ut_£t_št_äom_fe
 (
d
, "usb.š‹rçû.´ÙocŞ", 
sysfs_·th
, "bInterfaceProtocol", 16);

3851 
	`h®_ut_£t_¡ršg_äom_fe
(
d
, "usb.š‹rçû.desütiÚ", 
sysfs_·th
, "interface");

3853 
	`usbif_£t_Çme
 (
d
,

3854 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "usb.interface.class"),

3855 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "usb.interface.subclass"),

3856 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "usb.interface.protocol"));

3859  
d
;

3860 
	}
}

3862 
gboŞ—n


3863 
	$usb_compu‹_udi
 (
H®Deviû
 *
d
)

3865 
gch¬
 
udi
[256];

3867 ià(
	`h®_deviû_has_´İ”ty
 (
d
, "usb.interface.number")) {

3868 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3870 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

3871 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "usb.interface.number"));

3872 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

3874 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3876 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "usb_device.vendor_id"),

3877 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "usb_device.product_id"),

3878 
	`h®_deviû_has_´İ”ty
 (
d
, "usb_device.serial") ?

3879 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "usb_device.serial") :

3881 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

3884  
TRUE
;

3885 
	}
}

3889 
H®Deviû
 *

3890 
	$usbşass_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

3892 
H®Deviû
 *
d
;

3893 
gšt
 
ho¡_num
;

3894 cÚ¡ 
gch¬
 *
Ï¡_–em
;

3896 
d
 = 
NULL
;

3898 ià(
·»Á_dev
 =ğ
NULL
 || 
·»Á_·th
 =ğNULL || 
deviû_fe
 == NULL || device_file[0] == '\0') {

3899 
out
;

3902 
Ï¡_–em
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

3903 ià(
	`ssÿnf
 (
Ï¡_–em
, "hiddev%d", &
ho¡_num
) == 1) {

3905 
d
 = 
	`h®_deviû_Ãw
 ();

3906 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

3907 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3909 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "hiddev");

3910 
	`h®_deviû_add_ÿ·b™y
 (
d
, "hiddev");

3912 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "USB HID Device");

3914 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "hiddev.deviû", 
deviû_fe
);

3915 } ià(
	`ssÿnf
 (
Ï¡_–em
, "Í%d", &
ho¡_num
) == 1) {

3917 
d
 = 
	`h®_deviû_Ãw
 ();

3918 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

3919 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3921 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "printer");

3922 
	`h®_deviû_add_ÿ·b™y
 (
d
, "printer");

3924 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Printer");

3925 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "´š‹r.deviû", 
deviû_fe
);

3927 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "´š‹r.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3930 
out
:

3931  
d
;

3932 
	}
}

3934 cÚ¡ 
gch¬
 *

3935 
	$usbşass_g‘_´ob”
 (
H®Deviû
 *
d
)

3937 ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "hiddev"))

3939 ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "printer"))

3942  
NULL
;

3943 
	}
}

3945 
gboŞ—n


3946 
	$usbşass_compu‹_udi
 (
H®Deviû
 *
d
)

3948 
gch¬
 
udi
[256];

3950 ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "hiddev")) {

3951 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3953 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"));

3954 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

3955 } ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "printer")) {

3956 cÚ¡ *
£rŸl
;

3958 
£rŸl
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "printer.serial");

3959 
	`h®d_compu‹_udi
 (
udi
,  (udi),

3961 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"),

3962 
£rŸl
 !ğ
NULL
 ? serial : "noserial");

3963 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

3966  
TRUE
;

3967 
	}
}

3971 
H®Deviû
 *

3972 
	$usb¿w_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

3974 
H®Deviû
 *
d
;

3976 
d
 = 
NULL
;

3978 ià(
·»Á_dev
 =ğ
NULL
 || 
·»Á_·th
 == NULL)

3979 
out
;

3981 
d
 = 
	`h®_deviû_Ãw
 ();

3982 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

3983 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

3984 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "usbraw");

3985 
	`h®_deviû_add_ÿ·b™y
 (
d
, "usbraw");

3986 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "USB Raw Device Access");

3987 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "usb¿w.deviû", 
deviû_fe
);

3989 
out
:

3990  
d
;

3991 
	}
}

3993 
gboŞ—n


3994 
	$usb¿w_compu‹_udi
 (
H®Deviû
 *
d
)

3996 
gch¬
 
udi
[256];

3998 
	`h®d_compu‹_udi
 (
udi
,  (udi), "%s_usbraw",

3999 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"));

4000 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

4002  
TRUE
;

4003 
	}
}

4007 
H®Deviû
 *

4008 
	$video4lšux_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

4010 
H®Deviû
 *
d
;

4012 
d
 = 
NULL
;

4014 ià(
·»Á_dev
 =ğ
NULL
 || 
·»Á_·th
 == NULL)

4015 
out
;

4017 
d
 = 
	`h®_deviû_Ãw
 ();

4018 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

4019 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

4020 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "video4linux");

4021 
	`h®_deviû_add_ÿ·b™y
 (
d
, "video4linux");

4022 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Multimedia Device");

4023 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "video4lšux.deviû", 
deviû_fe
);

4025 
out
:

4026  
d
;

4027 
	}
}

4029 cÚ¡ 
gch¬
 *

4030 
	$video4lšux_g‘_´ob”
 (
H®Deviû
 *
d
)

4032 cÚ¡ *
´ob”
 = 
NULL
;

4035 ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "video4linux")) {

4036 
´ob”
 = "hald-probe-video4linux";

4039  
´ob”
;

4040 
	}
}

4042 
gboŞ—n


4043 
	$video4lšux_compu‹_udi
 (
H®Deviû
 *
d
)

4045 
gch¬
 
udi
[256];

4047 
	`h®d_compu‹_udi
 (
udi
,  (udi), "%s_video4linux",

4048 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent"));

4049 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

4051  
TRUE
;

4052 
	}
}

4056 #ifdeà
USE_VIRT


4057 
H®Deviû
 *

4058 
	$vio_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
,

4059 cÚ¡ 
gch¬
 *
sysfs_·th_š_deviûs
)

4061 
H®Deviû
 *
d
;

4062 cÚ¡ 
gch¬
 *
dev_id
;

4063 cÚ¡ 
gch¬
 *
dev_ty³
;

4064 
gch¬
 
buf
[64];

4066 
d
 = 
	`h®_deviû_Ãw
 ();

4067 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

4068 ià(
·»Á_dev
 !ğ
NULL
) {

4069 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

4071 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

4074 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

4076 
dev_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

4077 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "vio.id", 
dev_id
);

4079 
dev_ty³
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "name");

4081 ià(
dev_ty³
) {

4082 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "vio.ty³", 
dev_ty³
);

4083 
	`g_¢´štf
 (
buf
,  (buf), "ViØ% Deviû (%s)", 
dev_ty³
, 
dev_id
);

4084 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

4086 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Vio Device (unknown)");

4089  
d
;

4090 
	}
}

4092 
gboŞ—n


4093 
	$vio_compu‹_udi
 (
H®Deviû
 *
d
)

4095 
gch¬
 
udi
[256];

4096 cÚ¡ *
ty³
;

4098 
ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "vio.type");

4100 ià(
ty³
) {

4101 
	`h®d_compu‹_udi
 (
udi
,  (udi),

4103 
ty³
,

4104 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "vio.id"));

4106 
	`h®d_compu‹_udi
 (
udi
,  (udi),

4108 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "vio.id"));

4111 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

4113  
TRUE
;

4114 
	}
}

4118 
H®Deviû
 *

4119 
	$vœtio_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
,

4120 cÚ¡ 
gch¬
 *
sysfs_·th_š_deviûs
)

4122 
H®Deviû
 *
d
;

4123 cÚ¡ 
gch¬
 *
dev_id
;

4124 
gch¬
 
buf
[64];

4126 
d
 = 
	`h®_deviû_Ãw
 ();

4127 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

4128 ià(
·»Á_dev
 !ğ
NULL
) {

4129 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

4131 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

4134 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

4136 
dev_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

4138 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "vœtio.id", 
dev_id
);

4140 
	`g_¢´štf
 (
buf
,  (buf), "VœtIO Deviû (%s)", 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "virtio.id"));

4141 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

4143  
d
;

4144 
	}
}

4146 
gboŞ—n


4147 
	$vœtio_compu‹_udi
 (
H®Deviû
 *
d
)

4149 
gch¬
 
udi
[256];

4151 
	`h®d_compu‹_udi
 (
udi
,  (udi),

4153 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "virtio.id"));

4154 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

4156  
TRUE
;

4157 
	}
}

4161 
H®Deviû
 *

4162 
	$vmbus_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

4164 
H®Deviû
 *
d
;

4165 cÚ¡ 
gch¬
 *
bus_id
;

4166 cÚ¡ 
gch¬
 *
şass_id
;

4167 cÚ¡ 
gch¬
 *
deviû_id
;

4168 
bu¢um
, 
deviûnum
;

4170 
	`HAL_INFO
 (("vmbus_add: sysfs_·th=% deviû_fe=% ·»Á_dev=0x%08x…¬’t_·th=%s", 
sysfs_·th
, 
deviû_fe
, 
·»Á_dev
, 
·»Á_·th
));

4172 
d
 = 
	`h®_deviû_Ãw
 ();

4173 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

4174 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.vendor", "Microsoft/Citrix");

4175 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

4177 ià(
·»Á_dev
 !ğ
NULL
) {

4178 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

4180 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

4183 
bus_id
 = 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
);

4184 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "vmbus.bus_id", 
bus_id
);

4185 ià(
	`ssÿnf
 (
bus_id
, "vmbus_%d_%d", &
bu¢um
, &
deviûnum
) == 2) {

4186 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "vmbus.bus_numb”", 
bu¢um
);

4187 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "vmbus.deviû_numb”", 
deviûnum
);

4190 
deviû_id
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "device_id");

4191 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "vmbus.deviû_id", 
deviû_id
);

4192 
şass_id
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "class_id");

4193 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "vmbus.şass_id", 
şass_id
);

4195 ià(
şass_id
 !ğ
NULL
) {

4196 ià(
	`¡rcmp
 (
şass_id
, "{f8615163-df3e-46c5-913ff2d2f965ed0e}") == 0) {

4197 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Network Virtualization Service Client Device");

4198 } ià(
	`¡rcmp
 (
şass_id
, "{ba6163d9-04a1-4d29-b60572e2ffb1dc7f}") == 0) {

4199 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Storage Virtualization Service Client Device");

4200 } ià(
	`¡rcmp
 (
şass_id
, "{c5295816-f63a-4d5f-8d1a4daf999ca185}") == 0) {

4202 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Vmbus Device");

4206 ià(!
	`h®_deviû_has_´İ”ty
(
d
, "info.product")) {

4207 
buf
[64];

4208 
	`g_¢´štf
 (
buf
,  (buf), "Vœtu®iz©iÚ S”viû Cl›Á Deviû (%s)", 
bus_id
);

4209 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

4212  
d
;

4213 
	}
}

4215 
gboŞ—n


4216 
	$vmbus_compu‹_udi
 (
H®Deviû
 *
d
)

4218 
gch¬
 
udi
[256];

4220 
	`h®d_compu‹_udi
 (
udi
,  (udi), "/org/freedesktop/Hal/devices/_%s",

4221 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "vmbus.bus_id"));

4222 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

4224  
TRUE
;

4225 
	}
}

4229 
H®Deviû
 *

4230 
	$x’_add
 (cÚ¡ 
gch¬
 *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
, 
H®Deviû
 *
·»Á_dev
, cÚ¡ gch¬ *
·»Á_·th
)

4232 
H®Deviû
 *
d
;

4233 cÚ¡ 
gch¬
 *
devty³
;

4235 
d
 = 
	`h®_deviû_Ãw
 ();

4236 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
sysfs_·th
);

4237 ià(
·»Á_dev
 !ğ
NULL
) {

4238 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á_dev
));

4240 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

4243 
	`h®_ut_£t_driv”
 (
d
, "šfo.lšux.driv”", 
sysfs_·th
);

4245 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "xen.bus_id",

4246 
	`h®_ut_g‘_Ï¡_–em’t
 (
sysfs_·th
));

4248 
	`h®_ut_£t_¡ršg_äom_fe
 (
d
, "x’.·th", 
sysfs_·th
, "nodename");

4250 
devty³
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
sysfs_·th
, "devtype");

4251 ià(
devty³
 !ğ
NULL
) {

4252 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "x’.ty³", 
devty³
);

4254 ià(
	`¡rcmp
 (
devty³
, "pci") == 0) {

4255 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Xen PCI Device");

4256 } ià(
	`¡rcmp
 (
devty³
, "vbd") == 0) {

4257 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Xen Virtual Block Device");

4258 } ià(
	`¡rcmp
 (
devty³
, "vif") == 0) {

4259 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Xen Virtual Network Device");

4260 } ià(
	`¡rcmp
 (
devty³
, "vtpm") == 0) {

4261 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Xen Virtual Trusted Platform Module");

4263 
buf
[64];

4264 
	`g_¢´štf
 (
buf
,  (buf), "X’ Deviû (%s)", 
devty³
);

4265 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
buf
);

4268 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Xen Device (unknown)");

4271  
d
;

4272 
	}
}

4274 
gboŞ—n


4275 
	$x’_compu‹_udi
 (
H®Deviû
 *
d
)

4277 
gch¬
 
udi
[256];

4279 
	`h®d_compu‹_udi
 (
udi
,  (udi),

4281 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "xen.bus_id"));

4282 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

4283  
TRUE
;

4284 
	}
}

4289 
gboŞ—n


4290 
	$dev_»move
 (
H®Deviû
 *
d
)

4292  
TRUE
;

4293 
	}
}

4297 
	gDevHªdËr_s
;

4298 
DevHªdËr_s
 
	tDevHªdËr
;

4300 
	sDevHªdËr_s


4302 cÚ¡ 
gch¬
 *
	msubsy¡em
;

4303 
	mH®Deviû
 *(*
	madd
è(cÚ¡ 
gch¬
 *
	msysfs_·th
, cÚ¡ gch¬ *
	mdeviû_fe
,

4304 
H®Deviû
 *
	m·»Á_dev
, cÚ¡ 
gch¬
 *
	m·»Á_·th
);

4305 cÚ¡ 
	mgch¬
 *(*
	mg‘_´ob”
)(
H®Deviû
 *
	md
);

4306 
gboŞ—n
 (*
po¡_´obšg
è(
H®Deviû
 *
	md
);

4307 
gboŞ—n
 (*
compu‹_udi
è(
H®Deviû
 *
	md
);

4308 
gboŞ—n
 (*
»äesh
è(
H®Deviû
 *
	md
);

4309 
gboŞ—n
 (*
»move
è(
H®Deviû
 *
	md
);

4316 
DevHªdËr
 
	gdev_hªdËr_backlight
 =

4318 .
subsy¡em
 = "backlight",

4319 .
	gadd
 = 
backlight_add
,

4320 .
	gcompu‹_udi
 = 
backlight_compu‹_udi
,

4321 .
	g»move
 = 
dev_»move


4324 
DevHªdËr
 
	gdev_hªdËr_blu‘oÙh
 =

4326 .
subsy¡em
 = "bluetooth",

4327 .
	gadd
 = 
blu‘oÙh_add
,

4328 .
	gg‘_´ob”
 = 
NULL
,

4329 .
	gpo¡_´obšg
 = 
NULL
,

4330 .
	gcompu‹_udi
 = 
blu‘oÙh_compu‹_udi
,

4331 .
	g»move
 = 
dev_»move


4334 #ifdeà
USE_S390


4336 
DevHªdËr
 
	gdev_hªdËr_ccw
 = {

4337 .
subsy¡em
 = "ccw",

4338 .
	gadd
 = 
ccw_add
,

4339 .
	gcompu‹_udi
 = 
ccw_compu‹_udi
,

4340 .
	g»move
 = 
dev_»move


4343 
DevHªdËr
 
	gdev_hªdËr_ccwgroup
 = {

4344 .
subsy¡em
 = "ccwgroup",

4345 .
	gadd
 = 
ccwgroup_add
,

4346 .
	gcompu‹_udi
 = 
ccwgroup_compu‹_udi
,

4347 .
	g»move
 = 
dev_»move


4351 
DevHªdËr
 
	gdev_hªdËr_drm
 =

4353 .
subsy¡em
 = "drm",

4354 .
	gadd
 = 
drm_add
,

4355 .
	gcompu‹_udi
 = 
drm_compu‹_udi
,

4356 .
	g»move
 = 
dev_»move


4359 
DevHªdËr
 
	gdev_hªdËr_dvb
 =

4361 .
subsy¡em
 = "dvb",

4362 .
	gadd
 = 
dvb_add
,

4363 .
	gg‘_´ob”
 = 
NULL
,

4364 .
	gpo¡_´obšg
 = 
NULL
,

4365 .
	gcompu‹_udi
 = 
dvb_compu‹_udi
,

4366 .
	g»move
 = 
dev_»move


4369 #ifdeà
USE_FIREWIRE


4371 
DevHªdËr
 
	gdev_hªdËr_fœewœe
 = {

4372 .
subsy¡em
 = "firewire",

4373 .
	gadd
 = 
fœewœe_add
,

4374 .
	gg‘_´ob”
 = 
fœewœe_g‘_´ob”
,

4375 .
	gpo¡_´obšg
 = 
fœewœe_po¡_´obšg
,

4376 .
	gcompu‹_udi
 = 
fœewœe_compu‹_udi
,

4377 .
	g»move
 = 
dev_»move


4381 
DevHªdËr
 
	gdev_hªdËr_ide
 = {

4382 .
subsy¡em
 = "ide",

4383 .
	gadd
 = 
ide_add
,

4384 .
	gcompu‹_udi
 = 
ide_compu‹_udi
,

4385 .
	g»move
 = 
dev_»move


4388 #ifdeà
USE_FIREWIRE


4389 
DevHªdËr
 
	gdev_hªdËr_›“1394
 = {

4390 .
subsy¡em
 = "ieee1394",

4391 .
	gadd
 = 
›“1394_add
,

4392 .
	gcompu‹_udi
 = 
›“1394_compu‹_udi
,

4393 .
	g»move
 = 
dev_»move


4397 
DevHªdËr
 
	gdev_hªdËr_šput
 =

4399 .
subsy¡em
 = "input",

4400 .
	gadd
 = 
šput_add
,

4401 .
	gg‘_´ob”
 = 
šput_g‘_´ob”
,

4402 .
	gpo¡_´obšg
 = 
šput_po¡_´obšg
,

4403 .
	gcompu‹_udi
 = 
šput_compu‹_udi
,

4404 .
	g»move
 = 
dev_»move


4407 
DevHªdËr
 
	gdev_hªdËr_iucv
 = {

4408 .
subsy¡em
 = "iucv",

4409 .
	gadd
 = 
iucv_add
,

4410 .
	gcompu‹_udi
 = 
iucv_compu‹_udi
,

4411 .
	g»move
 = 
dev_»move


4414 
DevHªdËr
 
	gdev_hªdËr_Ëds
 = {

4415 .
subsy¡em
 = "leds",

4416 .
	gadd
 = 
Ëds_add
,

4417 .
	gcompu‹_udi
 = 
Ëds_compu‹_udi
,

4418 .
	g»move
 = 
dev_»move


4421 
DevHªdËr
 
	gdev_hªdËr_mem¡ick
 = {

4422 .
subsy¡em
 = "memstick",

4423 .
	gadd
 = 
mem¡ick_add
,

4424 .
	gcompu‹_udi
 = 
mem¡ick_compu‹_udi
,

4425 .
	g»move
 = 
dev_»move


4428 
DevHªdËr
 
	gdev_hªdËr_mem¡ick_ho¡
 =

4430 .
subsy¡em
 = "memstick_host",

4431 .
	gadd
 = 
mem¡ick_ho¡_add
,

4432 .
	gg‘_´ob”
 = 
NULL
,

4433 .
	gpo¡_´obšg
 = 
NULL
,

4434 .
	gcompu‹_udi
 = 
mem¡ick_ho¡_compu‹_udi
,

4435 .
	g»move
 = 
dev_»move


4438 
DevHªdËr
 
	gdev_hªdËr_mmc
 = {

4439 .
subsy¡em
 = "mmc",

4440 .
	gadd
 = 
mmc_add
,

4441 .
	gcompu‹_udi
 = 
mmc_compu‹_udi
,

4442 .
	g»move
 = 
dev_»move


4445 
DevHªdËr
 
	gdev_hªdËr_mmc_ho¡
 =

4447 .
subsy¡em
 = "mmc_host",

4448 .
	gadd
 = 
mmc_ho¡_add
,

4449 .
	gg‘_´ob”
 = 
NULL
,

4450 .
	gpo¡_´obšg
 = 
NULL
,

4451 .
	gcompu‹_udi
 = 
mmc_ho¡_compu‹_udi
,

4452 .
	g»move
 = 
dev_»move


4455 
DevHªdËr
 
	gdev_hªdËr_Ãt
 =

4457 .
subsy¡em
 = "net",

4458 .
	gadd
 = 
Ãt_add
,

4459 .
	g»äesh
 = 
Ãt_»äesh
,

4460 .
	gg‘_´ob”
 = 
Ãt_g‘_´ob”
,

4461 .
	gpo¡_´obšg
 = 
Ãt_po¡_´obšg
,

4462 .
	gcompu‹_udi
 = 
Ãt_compu‹_udi
,

4463 .
	g»move
 = 
dev_»move


4466 #ifdeà
USE_OPENFIRMWARE


4467 
DevHªdËr
 
	gdev_hªdËr_of_¶©fÜm
 =

4469 .
subsy¡em
 = "of_platform",

4470 .
	gadd
 = 
of_¶©fÜm_add
,

4471 .
	gcompu‹_udi
 = 
of_¶©fÜm_compu‹_udi
,

4472 .
	g»move
 = 
dev_»move


4476 #ifdeà
USE_PCI


4477 
DevHªdËr
 
	gdev_hªdËr_pci
 = {

4478 .
subsy¡em
 = "pci",

4479 .
	gadd
 = 
pci_add
,

4480 .
	gcompu‹_udi
 = 
pci_compu‹_udi
,

4481 .
	g»move
 = 
dev_»move


4485 #ifdeà
USE_PCMCIA


4486 
DevHªdËr
 
	gdev_hªdËr_pcmcŸ
 = {

4487 .
subsy¡em
 = "pcmcia",

4488 .
	gadd
 = 
pcmcŸ_add
,

4489 .
	gcompu‹_udi
 = 
pcmcŸ_compu‹_udi
,

4490 .
	g»move
 = 
dev_»move


4494 
DevHªdËr
 
	gdev_hªdËr_¶©fÜm
 = {

4495 .
subsy¡em
 = "platform",

4496 .
	gadd
 = 
¶©fÜm_add
,

4497 .
	g»äesh
 = 
¶©fÜm_»äesh
,

4498 .
	gcompu‹_udi
 = 
¶©fÜm_compu‹_udi
,

4499 .
	g»move
 = 
dev_»move


4502 #ifdeà
USE_ISAPC


4503 
DevHªdËr
 
	gdev_hªdËr_²p
 = {

4504 .
subsy¡em
 = "pnp",

4505 .
	gadd
 = 
²p_add
,

4506 .
	gcompu‹_udi
 = 
²p_compu‹_udi
,

4507 .
	g»move
 = 
dev_»move


4511 
DevHªdËr
 
	gdev_hªdËr_µdev
 = {

4512 .
subsy¡em
 = "ppdev",

4513 .
	gadd
 = 
µdev_add
,

4514 .
	gcompu‹_udi
 = 
µdev_compu‹_udi
,

4515 .
	g»move
 = 
dev_»move


4518 #ifdeà
USE_ARCH_PS3


4519 
DevHªdËr
 
	gdev_hªdËr_ps3_sy¡em_bus
 =

4521 .
subsy¡em
 = "ps3_system_bus",

4522 .
	gadd
 = 
ps3_sy¡em_bus_add
,

4523 .
	gcompu‹_udi
 = 
ps3_sy¡em_bus_compu‹_udi
,

4524 .
	g»move
 = 
dev_»move


4529 
DevHªdËr
 
	gdev_hªdËr_p£udo
 = {

4530 .
subsy¡em
 = "pseudo",

4531 .
	gadd
 = 
p£udo_add
,

4532 .
	gcompu‹_udi
 = 
p£udo_compu‹_udi
,

4533 .
	g»move
 = 
dev_»move


4536 
DevHªdËr
 
	gdev_hªdËr_pow”_suµly
 =

4538 .
subsy¡em
 = "power_supply",

4539 .
	gadd
 = 
pow”_suµly_add
,

4540 .
	g»äesh
 = 
pow”_suµly_»äesh
,

4541 .
	gcompu‹_udi
 = 
pow”_suµly_compu‹_udi
,

4542 .
	g»move
 = 
dev_»move


4545 
DevHªdËr
 
	gdev_hªdËr_rfkl
 =

4547 .
subsy¡em
 = "rfkill",

4548 .
	gadd
 = 
rfkl_add
,

4549 .
	gcompu‹_udi
 = 
rfkl_compu‹_udi
,

4550 .
	g»äesh
 = 
rfkl_»äesh
,

4551 .
	g»move
 = 
dev_»move


4554 
DevHªdËr
 
	gdev_hªdËr_scsi
 = {

4555 .
subsy¡em
 = "scsi",

4556 .
	gadd
 = 
scsi_add
,

4557 .
	gcompu‹_udi
 = 
scsi_compu‹_udi
,

4558 .
	g»move
 = 
dev_»move


4560 
DevHªdËr
 
	gdev_hªdËr_scsi_g’”ic
 =

4562 .
subsy¡em
 = "scsi_generic",

4563 .
	gadd
 = 
scsi_g’”ic_add
,

4564 .
	gg‘_´ob”
 = 
NULL
,

4565 .
	gpo¡_´obšg
 = 
NULL
,

4566 .
	gcompu‹_udi
 = 
scsi_g’”ic_compu‹_udi
,

4567 .
	g»move
 = 
dev_»move


4570 
DevHªdËr
 
	gdev_hªdËr_scsi_ho¡
 =

4572 .
subsy¡em
 = "scsi_host",

4573 .
	gadd
 = 
scsi_ho¡_add
,

4574 .
	gg‘_´ob”
 = 
NULL
,

4575 .
	gpo¡_´obšg
 = 
NULL
,

4576 .
	gcompu‹_udi
 = 
scsi_ho¡_compu‹_udi
,

4577 .
	g»move
 = 
dev_»move


4580 
DevHªdËr
 
	gdev_hªdËr_sdio
 = {

4581 .
subsy¡em
 = "sdio",

4582 .
	gadd
 = 
sdio_add
,

4583 .
	gcompu‹_udi
 = 
sdio_compu‹_udi
,

4584 .
	g»move
 = 
dev_»move


4587 
DevHªdËr
 
	gdev_hªdËr_£rŸl
 =

4589 .
subsy¡em
 = "tty",

4590 .
	gadd
 = 
£rŸl_add
,

4591 .
	gg‘_´ob”
 = 
£rŸl_g‘_´ob”
,

4592 .
	gpo¡_´obšg
 = 
NULL
,

4593 .
	gcompu‹_udi
 = 
£rŸl_compu‹_udi
,

4594 .
	g»move
 = 
dev_»move


4597 
DevHªdËr
 
	gdev_hªdËr_£rio
 = {

4598 .
subsy¡em
 = "serio",

4599 .
	gadd
 = 
£rio_add
,

4600 .
	gcompu‹_udi
 = 
£rio_compu‹_udi
,

4601 .
	g»move
 = 
dev_»move


4604 
DevHªdËr
 
	gdev_hªdËr_sound
 =

4606 .
subsy¡em
 = "sound",

4607 .
	gadd
 = 
sound_add
,

4608 .
	gg‘_´ob”
 = 
NULL
,

4609 .
	gpo¡_´obšg
 = 
NULL
,

4610 .
	gcompu‹_udi
 = 
sound_compu‹_udi
,

4611 .
	g»move
 = 
dev_»move


4614 
DevHªdËr
 
	gdev_hªdËr_³
 =

4616 .
subsy¡em
 = "tape",

4617 .
	gadd
 = 
³_add
,

4618 .
	gg‘_´ob”
 = 
NULL
,

4619 .
	gpo¡_´obšg
 = 
NULL
,

4620 .
	gcompu‹_udi
 = 
³_compu‹_udi
,

4621 .
	g»move
 = 
dev_»move


4624 #ifdeà
USE_S390


4625 
DevHªdËr
 
	gdev_hªdËr_³390
 =

4627 .
subsy¡em
 = "tape390",

4628 .
	gadd
 = 
³_add
,

4629 .
	gg‘_´ob”
 = 
NULL
,

4630 .
	gpo¡_´obšg
 = 
NULL
,

4631 .
	gcompu‹_udi
 = 
³_compu‹_udi
,

4632 .
	g»move
 = 
dev_»move


4636 
DevHªdËr
 
	gdev_hªdËr_usb
 = {

4637 .
subsy¡em
 = "usb",

4638 .
	gadd
 = 
usb_add
,

4639 .
	gcompu‹_udi
 = 
usb_compu‹_udi
,

4640 .
	g»move
 = 
dev_»move


4643 
DevHªdËr
 
	gdev_hªdËr_usbşass
 =

4645 .
subsy¡em
 = "usb",

4646 .
	gadd
 = 
usbşass_add
,

4647 .
	gg‘_´ob”
 = 
usbşass_g‘_´ob”
,

4648 .
	gpo¡_´obšg
 = 
NULL
,

4649 .
	gcompu‹_udi
 = 
usbşass_compu‹_udi
,

4650 .
	g»move
 = 
dev_»move


4653 
DevHªdËr
 
	gdev_hªdËr_usb¿w
 =

4655 .
subsy¡em
 = "usb_device",

4656 .
	gadd
 = 
usb¿w_add
,

4657 .
	gg‘_´ob”
 = 
NULL
,

4658 .
	gpo¡_´obšg
 = 
NULL
,

4659 .
	gcompu‹_udi
 = 
usb¿w_compu‹_udi
,

4660 .
	g»move
 = 
dev_»move


4663 
DevHªdËr
 
	gdev_hªdËr_video4lšux
 =

4665 .
subsy¡em
 = "video4linux",

4666 .
	gadd
 = 
video4lšux_add
,

4667 .
	gg‘_´ob”
 = 
video4lšux_g‘_´ob”
,

4668 .
	gpo¡_´obšg
 = 
NULL
,

4669 .
	gcompu‹_udi
 = 
video4lšux_compu‹_udi
,

4670 .
	g»move
 = 
dev_»move


4673 #ifdeà
USE_VIRT


4674 
DevHªdËr
 
	gdev_hªdËr_vio
 =

4676 .
subsy¡em
 = "vio",

4677 .
	gadd
 = 
vio_add
,

4678 .
	gcompu‹_udi
 = 
vio_compu‹_udi
,

4679 .
	g»move
 = 
dev_»move


4682 
DevHªdËr
 
	gdev_hªdËr_vœtio
 =

4684 .
subsy¡em
 = "virtio",

4685 .
	gadd
 = 
vœtio_add
,

4686 .
	gcompu‹_udi
 = 
vœtio_compu‹_udi
,

4687 .
	g»move
 = 
dev_»move


4690 
DevHªdËr
 
	gdev_hªdËr_vmbus
 =

4692 .
subsy¡em
 = "vmbus",

4693 .
	gadd
 = 
vmbus_add
,

4694 .
	gcompu‹_udi
 = 
vmbus_compu‹_udi
,

4695 .
	g»move
 = 
dev_»move


4698 
DevHªdËr
 
	gdev_hªdËr_x’
 = {

4699 .
subsy¡em
 = "xen",

4700 .
	gadd
 = 
x’_add
,

4701 .
	gcompu‹_udi
 = 
x’_compu‹_udi
,

4702 .
	g»move
 = 
dev_»move


4710 
DevHªdËr
 *
	gdev_hªdËrs
[] = {

4711 &
dev_hªdËr_backlight
,

4712 &
dev_hªdËr_blu‘oÙh
,

4713 #ifdeà
USE_S390


4714 &
dev_hªdËr_ccw
,

4715 &
dev_hªdËr_ccwgroup
,

4717 &
dev_hªdËr_drm
,

4718 &
dev_hªdËr_dvb
,

4719 #ifdeà
USE_FIREWIRE


4720 &
dev_hªdËr_fœewœe
,

4722 &
dev_hªdËr_ide
,

4723 #ifdeà
USE_FIREWIRE


4724 &
dev_hªdËr_›“1394
,

4726 &
dev_hªdËr_šput
,

4727 &
dev_hªdËr_iucv
,

4728 &
dev_hªdËr_Ëds
,

4729 &
dev_hªdËr_mmc
,

4730 &
dev_hªdËr_mem¡ick
,

4731 &
dev_hªdËr_mem¡ick_ho¡
,

4732 &
dev_hªdËr_mmc_ho¡
,

4733 &
dev_hªdËr_Ãt
,

4734 #ifdeà
USE_OPENFIRMWARE


4735 &
dev_hªdËr_of_¶©fÜm
,

4737 #ifdeà
USE_PCI


4738 &
dev_hªdËr_pci
,

4740 #ifdeà
USE_PCMCIA


4741 &
dev_hªdËr_pcmcŸ
,

4743 &
dev_hªdËr_¶©fÜm
,

4744 #ifdeà
USE_ISAPC


4745 &
dev_hªdËr_²p
,

4747 &
dev_hªdËr_pow”_suµly
,

4748 &
dev_hªdËr_µdev
,

4749 #ifdeà
USE_ARCH_PS3


4750 &
dev_hªdËr_ps3_sy¡em_bus
,

4752 &
dev_hªdËr_p£udo
,

4753 &
dev_hªdËr_rfkl
,

4754 &
dev_hªdËr_scsi
,

4755 &
dev_hªdËr_scsi_g’”ic
,

4756 &
dev_hªdËr_scsi_ho¡
,

4757 &
dev_hªdËr_sdio
,

4758 &
dev_hªdËr_£rŸl
,

4759 &
dev_hªdËr_£rio
,

4760 &
dev_hªdËr_sound
,

4761 &
dev_hªdËr_³
,

4762 #ifdeà
USE_S390


4763 &
dev_hªdËr_³390
,

4766 &
dev_hªdËr_usbşass
,

4767 &
dev_hªdËr_usb
,

4769 &
dev_hªdËr_usb¿w
,

4770 &
dev_hªdËr_video4lšux
,

4771 #ifdeà
USE_VIRT


4772 &
dev_hªdËr_vio
,

4773 &
dev_hªdËr_vœtio
,

4774 &
dev_hªdËr_vmbus
,

4775 &
dev_hªdËr_x’
,

4777 
NULL


4783 
	$dev_ÿÎouts_add_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

4785 *
’d_tok’
 = (*è
u£rd©a1
;

4787 
	`HAL_INFO
 (("Add c®lout com¶‘ed udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

4790 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

4791 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

4793 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

4794 
	}
}

4797 
	$dev_ÿÎouts_»move_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

4799 *
’d_tok’
 = (*è
u£rd©a1
;

4801 
	`HAL_INFO
 (("RemovÿÎout com¶‘ed udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

4803 ià(!
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_gdl
 (), 
d
)) {

4804 
	`HAL_WARNING
 (("Error„emoving device"));

4807 
	`g_objeù_uÄef
 (
d
);

4809 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

4810 
	}
}

4813 
	$dev_ÿÎouts_»move_chd_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

4815 
	`HAL_INFO
 (("RemovÿÎout com¶‘ed udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

4817 ià(!
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_gdl
 (), 
d
)) {

4818 
	`HAL_WARNING
 (("Error„emoving device"));

4821 
	`g_objeù_uÄef
 (
d
);

4822 
	}
}

4825 
	$add_dev_aá”_´obšg
 (
H®Deviû
 *
d
, 
DevHªdËr
 *
hªdËr
, *
’d_tok’
)

4828 ià(!
hªdËr
->
	`compu‹_udi
 (
d
)) {

4829 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

4830 
	`g_objeù_uÄef
 (
d
);

4831 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

4832 
out
;

4836 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_INFORMATION
);

4837 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_POLICY
);

4842 
	`h®_ut_ÿÎout_deviû_add
 (
d
, 
dev_ÿÎouts_add_dÚe
, 
’d_tok’
, 
NULL
);

4844 
out
:

4846 
	}
}

4849 
	$add_dev_´obšg_h–³r_dÚe
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
,

4850 
gšt
 
»tuº_code
, **
”rÜ
,

4851 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

4853 *
’d_tok’
 = (*è
d©a1
;

4854 
DevHªdËr
 *
hªdËr
 = (DevHªdË¸*è
d©a2
;

4856 
	`HAL_INFO
 (("’‹ršg;ƒx™_ty³=%d,„‘uº_code=%d", 
ex™_ty³
, 
»tuº_code
));

4858 ià(
d
 =ğ
NULL
) {

4859 
	`HAL_INFO
 (("Device object‡lready„emoved"));

4860 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

4861 
out
;

4865 ià(
ex™_ty³
 !ğ
HALD_RUN_SUCCESS
 || 
»tuº_code
 != 0) {

4866 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

4867 
	`HAL_INFO
 (("device„emoved dueo…rober fail"));

4868 
	`h®_deviû_´št
 (
d
);

4869 
	`g_objeù_uÄef
 (
d
);

4870 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

4871 
out
;

4875 ià(
hªdËr
->
po¡_´obšg
 !ğ
NULL
) {

4876 ià(!
hªdËr
->
	`po¡_´obšg
 (
d
)) {

4877 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

4878 
out
;

4882 
	`add_dev_aá”_´obšg
 (
d
, 
hªdËr
, 
’d_tok’
);

4884 
out
:

4886 
	}
}

4889 
	$dev_ÿÎouts_´•robšg_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

4891 *
’d_tok’
 = (*è
u£rd©a1
;

4892 
DevHªdËr
 *
hªdËr
 = (DevHªdË¸*è
u£rd©a2
;

4893 cÚ¡ 
gch¬
 *
´ob”
;

4895 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "info.ignore")) {

4899 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.category");

4900 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.capabilities");

4901 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.udi", "/org/freedesktop/Hal/devices/ignored-device");

4902 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Ignored Device");

4904 
	`HAL_INFO
 (("Preprobing merged info.ignore==TRUE"));

4907 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

4908 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

4910 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

4911 
out
;

4914 ià(
hªdËr
->
g‘_´ob”
 !ğ
NULL
)

4915 
´ob”
 = 
hªdËr
->
	`g‘_´ob”
 (
d
);

4917 
´ob”
 = 
NULL
;

4918 ià(
´ob”
 !ğ
NULL
) {

4920 
	`h®d_ruÂ”_run
(
d
,

4921 
´ob”
, 
NULL
,

4922 
HAL_HELPER_TIMEOUT
,

4923 
add_dev_´obšg_h–³r_dÚe
,

4924 (
gpoš‹r
è
’d_tok’
, (gpoš‹rè
hªdËr
);

4926 
	`add_dev_aá”_´obšg
 (
d
, 
hªdËr
, 
’d_tok’
);

4928 
out
:

4930 
	}
}

4933 
	$hÙ¶ug_ev’t_begš_add_dev
 (cÚ¡ 
gch¬
 *
subsy¡em
, cÚ¡ gch¬ *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
,

4934 
H®Deviû
 *
·»Á_dev
, cÚ¡ 
gch¬
 *
·»Á_·th
,

4935 *
’d_tok’
)

4937 
gušt
 
i
;

4939 
	`HAL_INFO
 (("add_dev: subsys=% sysfs_·th=% dev=% ·»Á_dev=0x%08x", 
subsy¡em
, 
sysfs_·th
, 
deviû_fe
, 
·»Á_dev
));

4944 ià(
·»Á_dev
 !ğ
NULL
)

4945 
	`h®_ut_£t_driv”
 (
·»Á_dev
, "šfo.lšux.driv”", 
·»Á_·th
);

4947 ià(
·»Á_dev
 !ğ
NULL
 && 
	`h®_deviû_´İ”ty_g‘_boŞ
 (parent_dev, "info.ignore")) {

4948 
	`HAL_INFO
 (("Ignoring‡dd_dev since…arent_dev has info.ignore==TRUE"));

4949 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

4950 
out
;

4953 
i
 = 0; 
dev_hªdËrs
 [i] !ğ
NULL
; i++) {

4954 
DevHªdËr
 *
hªdËr
;

4956 
hªdËr
 = 
dev_hªdËrs
[
i
];

4957 ià(
	`¡rcmp
 (
hªdËr
->
subsy¡em
, subsystem) == 0) {

4958 
H®Deviû
 *
d
;

4960 ià(
	`¡rcmp
 (
subsy¡em
, "scsi") == 0)

4961 ià(
	`missšg_scsi_ho¡
 (
sysfs_·th
, (
HÙ¶ugEv’t
 *)
’d_tok’
, 
HOTPLUG_ACTION_ADD
))

4962 
out
;

4965 
d
 = 
hªdËr
->
	`add
 (
sysfs_·th
, 
deviû_fe
, 
·»Á_dev
, 
·»Á_·th
);

4966 ià(
d
 =ğ
NULL
) {

4971 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "lšux.hÙ¶ug_ty³", 
HOTPLUG_EVENT_SYSFS_DEVICE
);

4972 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.subsy¡em", 
subsy¡em
);

4975 ià(!
	`h®_deviû_has_´İ”ty
(
d
, "info.subsystem")) {

4976 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.subsy¡em", 
subsy¡em
);

4979 ià(
deviû_fe
 !ğ
NULL
 && 
	`¡¾’
 (device_file) > 0)

4980 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.deviû_fe", 
deviû_fe
);

4983 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
d
);

4986 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_PREPROBE
);

4989 
	`h®_ut_ÿÎout_deviû_´•robe
 (
d
, 
dev_ÿÎouts_´•robšg_dÚe
, 
’d_tok’
, 
hªdËr
);

4990 
out
;

4995 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

4996 
out
:

4998 
	}
}

5001 
	$hÙ¶ug_ev’t_begš_»move_dev
 (cÚ¡ 
gch¬
 *
subsy¡em
, cÚ¡ gch¬ *
sysfs_·th
, *
’d_tok’
)

5003 
gušt
 
i
;

5004 
H®Deviû
 *
d
;

5005 
H®Deviû
 *
chd
;

5006 
GSLi¡
 *
chd»n
;

5007 
GSLi¡
 *
tmp
;

5009 
	`HAL_INFO
 (("»move_dev: subsys=% sysfs_·th=%s", 
subsy¡em
, 
sysfs_·th
));

5011 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "lšux.sysfs_·th", 
sysfs_·th
);

5012 ià(
d
 =ğ
NULL
) {

5013 
	`HAL_WARNING
 (("Error„emoving device"));

5015 
i
 = 0; 
dev_hªdËrs
 [i] !ğ
NULL
; i++) {

5016 
DevHªdËr
 *
hªdËr
;

5018 
hªdËr
 = 
dev_hªdËrs
[
i
];

5019 ià(
	`¡rcmp
 (
hªdËr
->
subsy¡em
, subsystem) == 0) {

5020 ià(
	`¡rcmp
 (
subsy¡em
, "scsi") == 0) {

5021 
	`missšg_scsi_ho¡
(
sysfs_·th
, (
HÙ¶ugEv’t
 *)
’d_tok’
, 
HOTPLUG_ACTION_REMOVE
);

5025 
chd»n
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

5027 
	`h®_deviû_g‘_udi
(
d
));

5029 
tmp
 = 
chd»n
;m°!ğ
NULL
;m°ğ
	`g_¦i¡_Ãxt
 (tmp)) {

5030 
chd
 = 
	`HAL_DEVICE
 (
tmp
->
d©a
);

5032 ià(
	`h®_deviû_´İ”ty_g‘_¡ršg
(
chd
, "lšux.sysfs_·th"è=ğ
NULL
) {

5033 
	`HAL_INFO
(("Removnow: % a chd of: %s", 
	`h®_deviû_g‘_udi
(
chd
), h®_deviû_g‘_udi(
d
)));

5034 
	`h®_ut_ÿÎout_deviû_»move
 (
chd
, 
dev_ÿÎouts_»move_chd_dÚe
, 
NULL
, NULL);

5037 
	`g_¦i¡_ä“
 (
chd»n
);

5039 
hªdËr
->
	`»move
 (
d
);

5040 
	`h®_ut_ÿÎout_deviû_»move
 (
d
, 
dev_ÿÎouts_»move_dÚe
, 
’d_tok’
, 
NULL
);

5041 
out
;

5047 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

5048 
out
:

5050 
	}
}

5053 
	$hÙ¶ug_ev’t_»äesh_dev
 (cÚ¡ 
gch¬
 *
subsy¡em
, cÚ¡ gch¬ *
sysfs_·th
, 
H®Deviû
 *
d
, *
’d_tok’
)

5055 
gušt
 
i
;

5056 
DevHªdËr
 *
hªdËr
;

5058 
	`HAL_INFO
 (("»äesh_dev: subsys=%s", 
subsy¡em
));

5060 
i
 = 0; 
dev_hªdËrs
 [i] !ğ
NULL
; i++) {

5061 
hªdËr
 = 
dev_hªdËrs
[
i
];

5062 ià(
	`¡rcmp
 (
hªdËr
->
subsy¡em
, subsystem) == 0) {

5063 ià(
hªdËr
->
»äesh
 !ğ
NULL
) {

5064 
hªdËr
->
	`»äesh
 (
d
);

5066 
out
;

5070 
out
:

5072 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

5073 
	}
}

5077 
	$dev_»sÿn_deviû_dÚe
 (
H®Deviû
 *
d
,

5078 
gušt32
 
ex™_ty³
,

5079 
gšt
 
»tuº_code
,

5080 **
”rÜ
,

5081 
gpoš‹r
 
d©a1
,

5082 
gpoš‹r
 
d©a2
)

5084 
	`HAL_INFO
 (("dev_»sÿn_deviû_dÚe:ƒx™_ty³=%d,„‘uº_code=%d", 
ex™_ty³
, 
»tuº_code
));

5085 
	}
}

5087 
gboŞ—n


5088 
	$dev_»sÿn_deviû
 (
H®Deviû
 *
d
)

5090 
gboŞ—n
 
»t
;

5092 
»t
 = 
FALSE
;

5095 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "button.has_state")) {

5097 
	`h®d_ruÂ”_run
 (
d
,

5099 
NULL
,

5100 
HAL_HELPER_TIMEOUT
,

5101 
dev_»sÿn_deviû_dÚe
,

5102 
NULL
,

5103 
NULL
);

5105 
»t
 = 
TRUE
;

5106 
out
;

5109 
out
:

5110  
»t
;

5111 
	}
}

5114 
HÙ¶ugEv’t
 *

5115 
	$dev_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
)

5117 cÚ¡ *
subsy¡em
;

5118 cÚ¡ *
sysfs_·th
;

5119 cÚ¡ *
deviû_fe
;

5120 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

5122 
subsy¡em
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.subsystem");

5123 
sysfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.sysfs_path");

5124 
deviû_fe
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.device_file");

5126 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

5127 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

5128 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS
;

5129 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, subsystem,  (hotplug_event->sysfs.subsystem));

5130 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, sysfs_path,  (hotplug_event->sysfs.sysfs_path));

5131 ià(
deviû_fe
 !ğ
NULL
)

5132 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, device_file,  (hotplug_event->sysfs.device_file));

5134 
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
[0] = '\0';

5135 
hÙ¶ug_ev’t
->
sysfs
.
Ãt_ifšdex
 = -1;

5137  
hÙ¶ug_ev’t
;

5138 
	}
}

5140 
HÙ¶ugEv’t
 *

5141 
	$dev_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
)

5143 cÚ¡ *
subsy¡em
;

5144 cÚ¡ *
sysfs_·th
;

5145 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

5148 
subsy¡em
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.subsystem");

5149 
sysfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.sysfs_path");

5151 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

5152 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_REMOVE
;

5153 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS
;

5154 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, subsystem,  (hotplug_event->sysfs.subsystem));

5155 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, sysfs_path,  (hotplug_event->sysfs.sysfs_path));

5156 
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
[0] = '\0';

5157 
hÙ¶ug_ev’t
->
sysfs
.
Ãt_ifšdex
 = -1;

5159  
hÙ¶ug_ev’t
;

5160 
	}
}

	@hald/linux/device.h

23 #iâdeà
DEV_H


24 
	#DEV_H


	)

26 
	~<glib.h
>

27 
	~"hÙ¶ug.h
"

30 
	mOSS_DEVICE_TYPE_DSP
,

31 
	mOSS_DEVICE_TYPE_ADSP
,

32 
	mOSS_DEVICE_TYPE_MIDI
,

33 
	mOSS_DEVICE_TYPE_AMIDI
,

34 
	mOSS_DEVICE_TYPE_AUDIO
,

35 
	mOSS_DEVICE_TYPE_MIXER
,

36 
	mOSS_DEVICE_TYPE_UNKNOWN


37 } 
	tCÏssDevOSSDeviûTy³s
;

39 
hÙ¶ug_ev’t_begš_add_dev
 (cÚ¡ 
gch¬
 *
subsy¡em
, cÚ¡ gch¬ *
sysfs_·th
, cÚ¡ gch¬ *
deviû_fe
,

40 
H®Deviû
 *
·»Á_dev
, cÚ¡ 
gch¬
 *
·»Á_·th
,

41 *
’d_tok’
);

43 
hÙ¶ug_ev’t_begš_»move_dev
 (cÚ¡ 
gch¬
 *
subsy¡em
, cÚ¡ gch¬ *
sysfs_·th
, *
’d_tok’
);

44 
hÙ¶ug_ev’t_»äesh_dev
 (cÚ¡ 
gch¬
 *
subsy¡em
, cÚ¡ gch¬ *
sysfs_·th
, 
H®Deviû
 *
d
, *
’d_tok’
);

46 
gboŞ—n
 
dev_»sÿn_deviû
 (
H®Deviû
 *
d
);

48 
HÙ¶ugEv’t
 *
dev_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
);

50 
HÙ¶ugEv’t
 *
dev_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
);

52 
gboŞ—n
 
_have_sysfs_lid_bu‰Ú
;

53 
gboŞ—n
 
_have_sysfs_pow”_bu‰Ú
;

54 
gboŞ—n
 
_have_sysfs_¦“p_bu‰Ú
;

55 
gboŞ—n
 
_have_sysfs_pow”_suµly
;

	@hald/linux/hal-file-monitor.c

21 #ifdeà
HAVE_CONFIG


22 
	~"cÚfig.h
"

25 
	~<¡dlib.h
>

26 
	~<¡dio.h
>

27 
	~<fú.h
>

28 
	~<uni¡d.h
>

29 
	~<¡ršg.h
>

30 
	~<”ºo.h
>

32 #ifdeà
HAVE_SYS_INOTIFY_H


33 
	~<sys/šÙify.h
>

35 
	~"šÙify_loÿl.h
"

38 
	~<glib.h
>

39 
	~<glib/gi18n.h
>

40 
	~<glib/g¡dio.h
>

41 
	~<glib-objeù.h
>

43 
	~"../h®-fe-mÚ™Ü.h
"

45 
	#HAL_FILE_MONITOR_GET_PRIVATE
(
o
è(
	`G_TYPE_INSTANCE_GET_PRIVATE
 ((o), 
HAL_TYPE_FILE_MONITOR
, 
H®FeMÚ™ÜPriv©e
))

	)

49 
	mwd
;

50 *
	m·th
;

51 
GSLi¡
 *
	mnÙif›s
;

52 } 
	tFeInÙifyW©ch
;

56 
gušt
 
	mid
;

57 
	mmask
;

58 
H®FeMÚ™ÜNÙifyFunc
 
	mnÙify_func
;

59 
gpoš‹r
 
	mu£r_d©a
;

60 
FeInÙifyW©ch
 *
	mw©ch
;

61 } 
	tFeMÚ™ÜNÙify
;

65 
FeInÙifyW©ch
 *
	mw©ch
;

66 
H®FeMÚ™ÜEv’t
 
	mev’t
;

67 *
	m·th
;

68 } 
	tFeMÚ™ÜEv’tInfo
;

70 
	#DEFAULT_NOTIFY_BUFLEN
 (32 * ( (
šÙify_ev’t
è+ 16))

	)

71 
	#MAX_NOTIFY_BUFLEN
 (32 * 
DEFAULT_NOTIFY_BUFLEN
)

	)

73 
	sH®FeMÚ™ÜPriv©e


75 
gušt
 
	m£rŸl
;

77 
gboŞ—n
 
	mš™Ÿlized_šÙify
;

79 
	mšÙify_fd
;

80 
gušt
 
	mio_w©ch
;

82 
GHashTabË
 *
	mwd_to_w©ch
;

83 
GHashTabË
 *
	m·th_to_w©ch
;

84 
GHashTabË
 *
	mnÙif›s
;

86 
gušt
 
	mbuæ’
;

87 
guch¬
 *
	mbufãr
;

89 
gušt
 
	mev’ts_idË_id
;

90 
GQueue
 *
	mnÙify_ev’ts
;

94 
	mPROP_0
,

97 
h®_fe_mÚ™Ü_şass_š™
 (
H®FeMÚ™ÜCÏss
 *
kÏss
);

98 
h®_fe_mÚ™Ü_š™
 (
H®FeMÚ™Ü
 *
fe_mÚ™Ü
);

99 
h®_fe_mÚ™Ü_fš®ize
 (
GObjeù
 *
objeù
);

101 
	$G_DEFINE_TYPE
 (
H®FeMÚ™Ü
, 
h®_fe_mÚ™Ü
, 
G_TYPE_OBJECT
)

103 
gpoš‹r
 
mÚ™Ü_objeù
 = 
NULL
;

105 
GQu¬k


106 
	$h®_fe_mÚ™Ü_”rÜ_qu¬k
 ()

108 
GQu¬k
 
»t
 = 0;

109 ià(
»t
 == 0) {

110 
»t
 = 
	`g_qu¬k_äom_¡©ic_¡ršg
 ("hal_file_monitor_error");

113  
»t
;

114 
	}
}

119 
	$our_ev’t_mask_to_šÙify_mask
 (
our_mask
)

121 
mask
;

123 
mask
 = 0;

125 ià(
our_mask
 & 
HAL_FILE_MONITOR_EVENT_ACCESS
) {

126 
mask
 |ğ
IN_ACCESS
;

129 ià(
our_mask
 & 
HAL_FILE_MONITOR_EVENT_CREATE
) {

130 
mask
 |ğ
IN_CREATE
 | 
IN_MOVED_TO
;

133 ià(
our_mask
 & 
HAL_FILE_MONITOR_EVENT_DELETE
) {

134 
mask
 |ğ
IN_DELETE
 | 
IN_DELETE_SELF
 | 
IN_MOVED_FROM
 | 
IN_MOVE_SELF
;

137 ià(
our_mask
 & 
HAL_FILE_MONITOR_EVENT_CHANGE
) {

138 
mask
 |ğ
IN_MODIFY
 | 
IN_ATTRIB
;

141  
mask
;

142 
	}
}

145 
	$imask_to_¡ršg
 (
gušt32
 
mask
)

147 
GSŒšg
 *
out
;

149 
out
 = 
	`g_¡ršg_Ãw
 (
NULL
);

151 ià(
mask
 & 
IN_ACCESS
) {

152 
	`g_¡ršg_­³nd
 (
out
, "ACCESS ");

154 ià(
mask
 & 
IN_MODIFY
) {

155 
	`g_¡ršg_­³nd
 (
out
, "MODIFY ");

157 ià(
mask
 & 
IN_ATTRIB
) {

158 
	`g_¡ršg_­³nd
 (
out
, "ATTRIB ");

160 ià(
mask
 & 
IN_CLOSE_WRITE
) {

161 
	`g_¡ršg_­³nd
 (
out
, "CLOSE_WRITE ");

163 ià(
mask
 & 
IN_CLOSE_NOWRITE
) {

164 
	`g_¡ršg_­³nd
 (
out
, "CLOSE_NOWRITE ");

166 ià(
mask
 & 
IN_OPEN
) {

167 
	`g_¡ršg_­³nd
 (
out
, "OPEN ");

169 ià(
mask
 & 
IN_MOVED_FROM
) {

170 
	`g_¡ršg_­³nd
 (
out
, "MOVED_FROM ");

172 ià(
mask
 & 
IN_MOVED_TO
) {

173 
	`g_¡ršg_­³nd
 (
out
, "MOVED_TO ");

175 ià(
mask
 & 
IN_DELETE
) {

176 
	`g_¡ršg_­³nd
 (
out
, "DELETE ");

178 ià(
mask
 & 
IN_CREATE
) {

179 
	`g_¡ršg_­³nd
 (
out
, "CREATE ");

181 ià(
mask
 & 
IN_DELETE_SELF
) {

182 
	`g_¡ršg_­³nd
 (
out
, "DELETE_SELF ");

184 ià(
mask
 & 
IN_UNMOUNT
) {

185 
	`g_¡ršg_­³nd
 (
out
, "UNMOUNT ");

187 ià(
mask
 & 
IN_Q_OVERFLOW
) {

188 
	`g_¡ršg_­³nd
 (
out
, "Q_OVERFLOW ");

190 ià(
mask
 & 
IN_IGNORED
) {

191 
	`g_¡ršg_­³nd
 (
out
, "IGNORED ");

194  
	`g_¡ršg_ä“
 (
out
, 
FALSE
);

195 
	}
}

197 
FeInÙifyW©ch
 *

198 
	$fe_mÚ™Ü_add_w©ch_fÜ_·th
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

199 cÚ¡ *
·th
,

200 
mask
)

203 
FeInÙifyW©ch
 *
w©ch
;

204 
wd
;

205 
imask
;

206 *
mask_¡r
;

208 
imask
 = 
	`our_ev’t_mask_to_šÙify_mask
 (
mask
);

210 
mask_¡r
 = 
	`imask_to_¡ršg
 (
imask
);

212 
	`g_ä“
 (
mask_¡r
);

214 
wd
 = 
	`šÙify_add_w©ch
 (
mÚ™Ü
->
´iv
->
šÙify_fd
, 
·th
, 
IN_MASK_ADD
 | 
imask
);

215 ià(
wd
 < 0) {

217  
NULL
;

220 
w©ch
 = 
	`g_hash_bË_lookup
 (
mÚ™Ü
->
´iv
->
·th_to_w©ch
, 
·th
);

221 ià(
w©ch
 =ğ
NULL
) {

222 
w©ch
 = 
	`g_Ãw0
 (
FeInÙifyW©ch
, 1);

224 
w©ch
->
wd
 = wd;

225 
w©ch
->
·th
 = 
	`g_¡rdup
 (path);

227 
	`g_hash_bË_š£¹
 (
mÚ™Ü
->
´iv
->
·th_to_w©ch
, 
w©ch
->
·th
, watch);

228 
	`g_hash_bË_š£¹
 (
mÚ™Ü
->
´iv
->
wd_to_w©ch
, 
	`GINT_TO_POINTER
 (
wd
), 
w©ch
);

231  
w©ch
;

232 
	}
}

235 
	$mÚ™Ü_»Ëa£_w©ch
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

236 
FeInÙifyW©ch
 *
w©ch
)

238 
	`g_¦i¡_ä“
 (
w©ch
->
nÙif›s
);

239 
w©ch
->
nÙif›s
 = 
NULL
;

241 
	`g_ä“
 (
w©ch
->
·th
);

242 
w©ch
->
·th
 = 
NULL
;

244 
	`šÙify_rm_w©ch
 (
mÚ™Ü
->
´iv
->
šÙify_fd
, 
w©ch
->
wd
);

245 
w©ch
->
wd
 = -1;

246 
	}
}

249 
	$fe_mÚ™Ü_»move_w©ch
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

250 
FeInÙifyW©ch
 *
w©ch
)

252 
	`g_hash_bË_»move
 (
mÚ™Ü
->
´iv
->
·th_to_w©ch
,

253 
w©ch
->
·th
);

254 
	`g_hash_bË_»move
 (
mÚ™Ü
->
´iv
->
wd_to_w©ch
,

255 
	`GINT_TO_POINTER
 (
w©ch
->
wd
));

256 
	`mÚ™Ü_»Ëa£_w©ch
 (
mÚ™Ü
, 
w©ch
);

257 
	}
}

259 
gboŞ—n


260 
	$»move_w©ch_fÜ—ch
 (cÚ¡ *
·th
,

261 
FeInÙifyW©ch
 *
w©ch
,

262 
H®FeMÚ™Ü
 *
mÚ™Ü
)

264 
	`mÚ™Ü_»Ëa£_w©ch
 (
mÚ™Ü
, 
w©ch
);

265  
TRUE
;

266 
	}
}

269 
	$şo£_šÙify
 (
H®FeMÚ™Ü
 *
mÚ™Ü
)

271 ià(! 
mÚ™Ü
->
´iv
->
š™Ÿlized_šÙify
) {

275 
mÚ™Ü
->
´iv
->
š™Ÿlized_šÙify
 = 
FALSE
;

277 
	`g_hash_bË_fÜ—ch_»move
 (
mÚ™Ü
->
´iv
->
·th_to_w©ch
,

278 (
GHRFunc
è
»move_w©ch_fÜ—ch
,

279 
mÚ™Ü
);

280 
mÚ™Ü
->
´iv
->
·th_to_w©ch
 = 
NULL
;

282 ià(
mÚ™Ü
->
´iv
->
wd_to_w©ch
 !ğ
NULL
) {

283 
	`g_hash_bË_de¡roy
 (
mÚ™Ü
->
´iv
->
wd_to_w©ch
);

285 
mÚ™Ü
->
´iv
->
wd_to_w©ch
 = 
NULL
;

287 
	`g_ä“
 (
mÚ™Ü
->
´iv
->
bufãr
);

288 
mÚ™Ü
->
´iv
->
bufãr
 = 
NULL
;

289 
mÚ™Ü
->
´iv
->
buæ’
 = 0;

291 ià(
mÚ™Ü
->
´iv
->
io_w©ch
) {

292 
	`g_sourû_»move
 (
mÚ™Ü
->
´iv
->
io_w©ch
);

294 
mÚ™Ü
->
´iv
->
io_w©ch
 = 0;

296 ià(
mÚ™Ü
->
´iv
->
šÙify_fd
 > 0) {

297 
	`şo£
 (
mÚ™Ü
->
´iv
->
šÙify_fd
);

299 
mÚ™Ü
->
´iv
->
šÙify_fd
 = 0;

300 
	}
}

302 
gboŞ—n


303 
	$em™_ev’ts_š_idË
 (
H®FeMÚ™Ü
 *
mÚ™Ü
)

305 
FeMÚ™ÜEv’tInfo
 *
ev’t_šfo
;

307 
mÚ™Ü
->
´iv
->
ev’ts_idË_id
 = 0;

309 (
ev’t_šfo
 = 
	`g_queue_pİ_h—d
 (
mÚ™Ü
->
´iv
->
nÙify_ev’ts
)è!ğ
NULL
) {

310 
GSLi¡
 *
l
;

311 
FeInÙifyW©ch
 *
w©ch
;

313 
w©ch
 = 
ev’t_šfo
->watch;

315 
l
 = 
w©ch
->
nÙif›s
;† !ğ
NULL
;† =†->
Ãxt
) {

316 
FeMÚ™ÜNÙify
 *
nÙify
;

318 
nÙify
 = 
	`g_hash_bË_lookup
 (
mÚ™Ü
->
´iv
->
nÙif›s
,

319 
	`GUINT_TO_POINTER
 (
l
->
d©a
));

320 ià(
nÙify
 =ğ
NULL
) {

324 ià(! (
nÙify
->
mask
 & 
ev’t_šfo
->
ev’t
)) {

328 ià(
nÙify
->
nÙify_func
) {

329 
nÙify
->
	`nÙify_func
 (
mÚ™Ü
, 
ev’t_šfo
->
ev’t
,ƒv’t_šfo->
·th
,‚Ùify->
u£r_d©a
);

333 
	`g_ä“
 (
ev’t_šfo
->
·th
);

334 
ev’t_šfo
->
·th
 = 
NULL
;

336 
ev’t_šfo
->
ev’t
 = 
HAL_FILE_MONITOR_EVENT_NONE
;

338 
	`g_ä“
 (
ev’t_šfo
);

341  
FALSE
;

342 
	}
}

345 
	$fe_mÚ™Ü_queue_ev’t
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

346 
FeMÚ™ÜEv’tInfo
 *
ev’t_šfo
)

348 
	`g_queue_push_
 (
mÚ™Ü
->
´iv
->
nÙify_ev’ts
, 
ev’t_šfo
);

350 ià(
mÚ™Ü
->
´iv
->
ev’ts_idË_id
 == 0) {

351 
mÚ™Ü
->
´iv
->
ev’ts_idË_id
 = 
	`g_idË_add
 ((
GSourûFunc
è
em™_ev’ts_š_idË
, monitor);

353 
	}
}

356 
	$queue_w©ch_ev’t
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

357 
FeInÙifyW©ch
 *
w©ch
,

358 
H®FeMÚ™ÜEv’t
 
ev’t
,

359 cÚ¡ *
·th
)

361 
FeMÚ™ÜEv’tInfo
 *
ev’t_šfo
;

363 
ev’t_šfo
 = 
	`g_Ãw0
 (
FeMÚ™ÜEv’tInfo
, 1);

365 
ev’t_šfo
->
w©ch
 = watch;

366 
ev’t_šfo
->
·th
 = 
	`g_¡rdup
 (path);

367 
ev’t_šfo
->
ev’t
 =ƒvent;

369 
	`fe_mÚ™Ü_queue_ev’t
 (
mÚ™Ü
, 
ev’t_šfo
);

370 
	}
}

373 
	$hªdË_šÙify_ev’t
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

374 
FeInÙifyW©ch
 *
w©ch
,

375 
šÙify_ev’t
 *
›v’t
)

377 
H®FeMÚ™ÜEv’t
 
ev’t
;

378 cÚ¡ *
·th
;

379 *
ä“me
;

380 *
mask_¡r
;

382 
ä“me
 = 
NULL
;

384 ià(
›v’t
->
Ën
 > 0) {

385 
·th
 = 
ä“me
 = 
	`g_bud_f’ame
 (
w©ch
->·th, 
›v’t
->
Çme
, 
NULL
);

387 
·th
 = 
w©ch
->path;

390 
mask_¡r
 = 
	`imask_to_¡ršg
 (
›v’t
->
mask
);

392 
	`g_ä“
 (
mask_¡r
);

394 
ev’t
 = 
HAL_FILE_MONITOR_EVENT_NONE
;

396 ià(
›v’t
->
mask
 & (
IN_CREATE
 | 
IN_MOVED_TO
)) {

397 
ev’t
 = 
HAL_FILE_MONITOR_EVENT_CREATE
;

398 } ià(
›v’t
->
mask
 & (
IN_DELETE
 | 
IN_DELETE_SELF
 | 
IN_MOVED_FROM
 | 
IN_MOVE_SELF
)) {

399 
ev’t
 = 
HAL_FILE_MONITOR_EVENT_DELETE
;

400 } ià(
›v’t
->
mask
 & (
IN_MODIFY
 | 
IN_ATTRIB
)) {

401 
ev’t
 = 
HAL_FILE_MONITOR_EVENT_CHANGE
;

402 } ià(
›v’t
->
mask
 & 
IN_ACCESS
) {

403 
ev’t
 = 
HAL_FILE_MONITOR_EVENT_ACCESS
;

406 ià(
ev’t
 !ğ
HAL_FILE_MONITOR_EVENT_NONE
) {

407 
	`queue_w©ch_ev’t
 (
mÚ™Ü
, 
w©ch
, 
ev’t
, 
·th
);

410 ià(
›v’t
->
mask
 & 
IN_IGNORED
) {

411 
	`fe_mÚ™Ü_»move_w©ch
 (
mÚ™Ü
, 
w©ch
);

414 
	`g_ä“
(
ä“me
);

415 
	}
}

417 
gboŞ—n


418 
	$šÙify_d©a_³ndšg
 (
GIOChªÃl
 *
sourû
,

419 
GIOCÚd™iÚ
 
cÚd™iÚ
,

420 
H®FeMÚ™Ü
 *
mÚ™Ü
)

422 
Ën
;

423 
i
;

427 
	`g_as£¹
 (
mÚ™Ü
->
´iv
->
šÙify_fd
 > 0);

428 
	`g_as£¹
 (
mÚ™Ü
->
´iv
->
bufãr
 !ğ
NULL
);

431 (
Ën
 = 
	`»ad
 (
mÚ™Ü
->
´iv
->
šÙify_fd
, mÚ™Ü->´iv->
bufãr
, mÚ™Ü->´iv->
buæ’
)è< 0 && 
”ºo
 =ğ
EINTR
);

433 ià(
Ën
 > 0) {

435 } ià(
Ën
 < 0) {

436 
	`g_w¬nšg
 ("Error„eading inotifyƒvent: %s",

437 
	`g_¡»¼Ü
 (
”ºo
));

438 
”rÜ_ÿnûl
;

441 
	`g_as£¹
 (
Ën
 == 0);

443 ià((
mÚ™Ü
->
´iv
->
buæ’
 << 1è> 
MAX_NOTIFY_BUFLEN
) {

444 
	`g_w¬nšg
 ("Error„eading inotifyƒvent: Exceded maximum buffer size");

445 
”rÜ_ÿnûl
;

451 
mÚ™Ü
->
´iv
->
buæ’
 <<= 1;

452 
mÚ™Ü
->
´iv
->
bufãr
 = 
	`g_»®loc
 (mÚ™Ü->´iv->bufãr, mÚ™Ü->´iv->
buæ’
);

453 } 
TRUE
);

457 
i
 = 0;

458 
i
 < 
Ën
) {

459 
šÙify_ev’t
 *
›v’t
 = (šÙify_ev’ˆ*è&
mÚ™Ü
->
´iv
->
bufãr
 [
i
];

460 
FeInÙifyW©ch
 *
w©ch
;

469 
w©ch
 = 
	`g_hash_bË_lookup
 (
mÚ™Ü
->
´iv
->
wd_to_w©ch
,

470 
	`GINT_TO_POINTER
 (
›v’t
->
wd
));

471 ià(
w©ch
 !ğ
NULL
) {

472 
	`hªdË_šÙify_ev’t
 (
mÚ™Ü
, 
w©ch
, 
›v’t
);

475 
i
 +ğ (
šÙify_ev’t
è+ 
›v’t
->
Ën
;

478  
TRUE
;

480 
”rÜ_ÿnûl
:

481 
mÚ™Ü
->
´iv
->
io_w©ch
 = 0;

483 
	`şo£_šÙify
 (
mÚ™Ü
);

485  
FALSE
;

486 
	}
}

488 
FeMÚ™ÜNÙify
 *

489 
	$fe_mÚ™Ü_add_nÙify_fÜ_·th
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

490 cÚ¡ *
·th
,

491 
mask
,

492 
H®FeMÚ™ÜNÙifyFunc
 
nÙify_func
,

493 
gpoš‹r
 
d©a
)

495 
FeMÚ™ÜNÙify
 *
nÙify
;

496 
FeInÙifyW©ch
 *
w©ch
;

498 
nÙify
 = 
NULL
;

500 
w©ch
 = 
	`fe_mÚ™Ü_add_w©ch_fÜ_·th
 (
mÚ™Ü
, 
·th
, 
mask
);

501 ià(
w©ch
 !ğ
NULL
) {

502 
nÙify
 = 
	`g_Ãw0
 (
FeMÚ™ÜNÙify
, 1);

503 
nÙify
->
nÙify_func
 =‚otify_func;

504 
nÙify
->
u£r_d©a
 = 
d©a
;

505 
nÙify
->
id
 = 
mÚ™Ü
->
´iv
->
£rŸl
++;

506 
nÙify
->
w©ch
 = watch;

507 
nÙify
->
mask
 = mask;

511 
	`g_hash_bË_š£¹
 (
mÚ™Ü
->
´iv
->
nÙif›s
, 
	`GUINT_TO_POINTER
 (
nÙify
->
id
),‚otify);

512 
w©ch
->
nÙif›s
 = 
	`g_¦i¡_´•’d
 (w©ch->nÙif›s, 
	`GUINT_TO_POINTER
 (
nÙify
->
id
));

515  
nÙify
;

516 
	}
}

519 
	$fe_mÚ™Ü_»move_nÙify
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

520 
gušt
 
id
)

522 
FeMÚ™ÜNÙify
 *
nÙify
;

526 
nÙify
 = 
	`g_hash_bË_lookup
 (
mÚ™Ü
->
´iv
->
nÙif›s
,

527 
	`GUINT_TO_POINTER
 (
id
));

528 ià(
nÙify
 =ğ
NULL
) {

532 
	`g_hash_bË_¡—l
 (
mÚ™Ü
->
´iv
->
nÙif›s
,

533 
	`GUINT_TO_POINTER
 (
id
));

535 
nÙify
->
w©ch
->
nÙif›s
 = 
	`g_¦i¡_»move
 (nÙify->w©ch->nÙif›s, 
	`GUINT_TO_POINTER
 (
id
));

537 ià(
	`g_¦i¡_Ëngth
 (
nÙify
->
w©ch
->
nÙif›s
) == 0) {

538 
	`fe_mÚ™Ü_»move_w©ch
 (
mÚ™Ü
, 
nÙify
->
w©ch
);

539 
	`g_ä“
 (
nÙify
->
w©ch
);

542 
	`g_ä“
 (
nÙify
);

543 
	}
}

545 
gušt


546 
	$h®_fe_mÚ™Ü_add_nÙify
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

547 cÚ¡ *
·th
,

548 
mask
,

549 
H®FeMÚ™ÜNÙifyFunc
 
nÙify_func
,

550 
gpoš‹r
 
d©a
)

552 
FeMÚ™ÜNÙify
 *
nÙify
;

554 ià(! 
mÚ™Ü
->
´iv
->
š™Ÿlized_šÙify
) {

558 
nÙify
 = 
	`fe_mÚ™Ü_add_nÙify_fÜ_·th
 (
mÚ™Ü
,

559 
·th
,

560 
mask
,

561 
nÙify_func
,

562 
d©a
);

563 ià(
nÙify
 =ğ
NULL
) {

564 
	`g_w¬nšg
 ("Failedo‡dd monitor on '%s': %s",

565 
·th
,

566 
	`g_¡»¼Ü
 (
”ºo
));

570  
nÙify
->
id
;

571 
	}
}

574 
	$h®_fe_mÚ™Ü_»move_nÙify
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

575 
gušt
 
id
)

577 ià(! 
mÚ™Ü
->
´iv
->
š™Ÿlized_šÙify
) {

581 
	`fe_mÚ™Ü_»move_nÙify
 (
mÚ™Ü
, 
id
);

582 
	}
}

585 
	$h®_fe_mÚ™Ü_şass_š™
 (
H®FeMÚ™ÜCÏss
 *
kÏss
)

587 
GObjeùCÏss
 *
objeù_şass
 = 
	`G_OBJECT_CLASS
 (
kÏss
);

589 
objeù_şass
->
fš®ize
 = 
h®_fe_mÚ™Ü_fš®ize
;

591 
	`g_ty³_şass_add_´iv©e
 (
kÏss
,  (
H®FeMÚ™ÜPriv©e
));

592 
	}
}

596 
	$£tup_šÙify
 (
H®FeMÚ™Ü
 *
mÚ™Ü
)

598 
GIOChªÃl
 *
io_chªÃl
;

599 
fd
;

601 ià(
mÚ™Ü
->
´iv
->
š™Ÿlized_šÙify
) {

605 ià((
fd
 = 
	`šÙify_š™
 ()) < 0) {

606 
	`g_w¬nšg
 ("Failedo initialize inotify: %s",

607 
	`g_¡»¼Ü
 (
”ºo
));

611 
mÚ™Ü
->
´iv
->
šÙify_fd
 = 
fd
;

613 
io_chªÃl
 = 
	`g_io_chªÃl_unix_Ãw
 (
fd
);

614 
mÚ™Ü
->
´iv
->
io_w©ch
 = 
	`g_io_add_w©ch
 (
io_chªÃl
,

615 
G_IO_IN
|
G_IO_PRI
,

616 (
GIOFunc
è
šÙify_d©a_³ndšg
,

617 
mÚ™Ü
);

618 
	`g_io_chªÃl_uÄef
 (
io_chªÃl
);

620 
mÚ™Ü
->
´iv
->
buæ’
 = 
DEFAULT_NOTIFY_BUFLEN
;

621 
mÚ™Ü
->
´iv
->
bufãr
 = 
	`g_m®loc
 (
DEFAULT_NOTIFY_BUFLEN
);

623 
mÚ™Ü
->
´iv
->
nÙif›s
 = 
	`g_hash_bË_Ãw
 (
g_dœeù_hash
,

624 
g_dœeù_equ®
);

626 
mÚ™Ü
->
´iv
->
wd_to_w©ch
 = 
	`g_hash_bË_Ãw
 (
g_dœeù_hash
,

627 
g_dœeù_equ®
);

628 
mÚ™Ü
->
´iv
->
·th_to_w©ch
 = 
	`g_hash_bË_Ãw
 (
g_¡r_hash
,

629 
g_¡r_equ®
);

631 
mÚ™Ü
->
´iv
->
š™Ÿlized_šÙify
 = 
TRUE
;

632 
	}
}

635 
	$h®_fe_mÚ™Ü_š™
 (
H®FeMÚ™Ü
 *
mÚ™Ü
)

637 
mÚ™Ü
->
´iv
 = 
	`HAL_FILE_MONITOR_GET_PRIVATE
 (monitor);

639 
mÚ™Ü
->
´iv
->
£rŸl
 = 1;

640 
mÚ™Ü
->
´iv
->
nÙify_ev’ts
 = 
	`g_queue_Ãw
 ();

642 
	`£tup_šÙify
 (
mÚ™Ü
);

643 
	}
}

646 
	$h®_fe_mÚ™Ü_fš®ize
 (
GObjeù
 *
objeù
)

648 
H®FeMÚ™Ü
 *
mÚ™Ü
;

650 
	`g_»tuº_if_ç
 (
objeù
 !ğ
NULL
);

651 
	`g_»tuº_if_ç
 (
	`HAL_IS_FILE_MONITOR
 (
objeù
));

653 
mÚ™Ü
 = 
	`HAL_FILE_MONITOR
 (
objeù
);

655 
	`g_»tuº_if_ç
 (
mÚ™Ü
->
´iv
 !ğ
NULL
);

657 
	`şo£_šÙify
 (
mÚ™Ü
);

659 
	`g_hash_bË_de¡roy
 (
mÚ™Ü
->
´iv
->
nÙif›s
);

660 
	`g_queue_ä“
 (
mÚ™Ü
->
´iv
->
nÙify_ev’ts
);

662 
	`G_OBJECT_CLASS
 (
h®_fe_mÚ™Ü_·»Á_şass
)->
	`fš®ize
 (
objeù
);

663 
	}
}

665 
H®FeMÚ™Ü
 *

666 
	$h®_fe_mÚ™Ü_Ãw
 ()

668 ià(
mÚ™Ü_objeù
 !ğ
NULL
) {

669 
	`g_objeù_»f
 (
mÚ™Ü_objeù
);

671 
mÚ™Ü_objeù
 = 
	`g_objeù_Ãw
 (
HAL_TYPE_FILE_MONITOR
, 
NULL
);

673 
	`g_objeù_add_w—k_poš‹r
 (
mÚ™Ü_objeù
,

674 (
gpoš‹r
 *è&
mÚ™Ü_objeù
);

677  
	`HAL_FILE_MONITOR
 (
mÚ™Ü_objeù
);

678 
	}
}

	@hald/linux/hotplug.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<ùy³.h
>

31 
	~<¡dšt.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

35 
	~<dbus/dbus.h
>

36 
	~<dbus/dbus-glib.h
>

38 
	~"../deviû_šfo.h
"

39 
	~"../h®d.h
"

40 
	~"../logg”.h
"

41 
	~"../os¥ec.h
"

43 
	~"aıi.h
"

44 
	~"­m.h
"

45 
	~"blockdev.h
"

46 
	~"deviû.h
"

47 
	~"os¥ec_lšux.h
"

48 
	~"pmu.h
"

50 
	~"hÙ¶ug.h
"

53 
GQueue
 *
	ghÙ¶ug_ev’t_queue
 = 
NULL
;

56 
gboŞ—n
 
	ghÙ¶ug_ev’t_queue_»¡¬t
 = 
FALSE
;

59 
GLi¡
 *
	ghÙ¶ug_ev’ts_š_´og»ss
 = 
NULL
;

62 
	$hÙ¶ug_ev’t_’d
 (*
’d_tok’
)

64 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
 = (HÙ¶ugEv’ˆ*è
’d_tok’
;

66 
hÙ¶ug_ev’ts_š_´og»ss
 = 
	`g_li¡_»move
 (hÙ¶ug_ev’ts_š_´og»ss, 
hÙ¶ug_ev’t
);

68 
	`g_¦iû_ä“
 (
HÙ¶ugEv’t
, 
hÙ¶ug_ev’t
);

72 
hÙ¶ug_ev’t_queue_»¡¬t
 = 
TRUE
;

73 
	}
}

76 
	$hÙ¶ug_ev’t_»po¡ed
 (*
’d_tok’
)

78 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
 = (HÙ¶ugEv’ˆ*è
’d_tok’
;

80 
hÙ¶ug_ev’t
->
»po¡ed
 = 
TRUE
;

81 
hÙ¶ug_ev’ts_š_´og»ss
 = 
	`g_li¡_»move
 (hÙ¶ug_ev’ts_š_´og»ss, 
hÙ¶ug_ev’t
);

82 
	}
}

85 
	$hÙ¶ug_ev’t_begš_sysfs
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
)

87 
H®Deviû
 *
d
;

88 
subsy¡em
[
HAL_PATH_MAX
];

89 
gch¬
 *
subsy¡em_rg‘
;

91 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

93 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
);

95 ià(
d
 =ğ
NULL
 && 
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_MOVE
) {

96 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
(
	`h®d_g‘_gdl
 (),

98 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th_Şd
);

103 ià(
d
 !ğ
NULL
 && 
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_ADD
) {

104 
	`HAL_ERROR
 (("deviû % ®»ady…»£Á iÀth¡Üe, sØ»äeshšg", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
));

105 
	`hÙ¶ug_ev’t_»äesh_dev
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, 
d
, (*) hotplug_event);

111 ià(
hÙ¶ug_ev’t
->
ty³
 =ğ
HOTPLUG_EVENT_SYSFS
)

112 ià(
	`¡rcmp
(
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, "block") == 0)

113 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS_BLOCK
;

116 ià(
hÙ¶ug_ev’t
->
ty³
 =ğ
HOTPLUG_EVENT_SYSFS
 && 
d
 !ğ
NULL
) {

117 
HÙ¶ugEv’tTy³
 
ty³
;

119 
ty³
 = (
HÙ¶ugEv’tTy³
è
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.hotplug_type");

120 ià(
ty³
 =ğ
HOTPLUG_EVENT_SYSFS_DEVICE
) {

121 
	`HAL_INFO
 (("% i ¨deviû (¡Üe)", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
));

122 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS_DEVICE
;

123 } ià(
ty³
 =ğ
HOTPLUG_EVENT_SYSFS_BLOCK
) {

124 
	`HAL_INFO
 (("% i ¨block deviû (¡Üe)", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
));

125 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS_BLOCK
;

134 ià(
hÙ¶ug_ev’t
->
ty³
 =ğ
HOTPLUG_EVENT_SYSFS
) {

135 
	`g_¢´štf
 (
subsy¡em
, 
HAL_PATH_MAX
, "%s/subsy¡em", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
);

139 
subsy¡em_rg‘
 = 
	`h®_ut_»adlšk
(
subsy¡em
);

140 ià(
subsy¡em_rg‘
 !ğ
NULL
) {

141 ià(
	`¡r¡r
(
subsy¡em_rg‘
, "/block"è!ğ
NULL
) {

142 
	`HAL_INFO
 (("% i ¨block deviû (subsy¡em)", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
));

143 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS_BLOCK
;

145 
	`HAL_INFO
 (("% i ¨deviû (subsy¡em)", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
));

146 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS_DEVICE
;

152 ià(
hÙ¶ug_ev’t
->
ty³
 =ğ
HOTPLUG_EVENT_SYSFS
) {

153 
sys_block_·th
[
HAL_PATH_MAX
];

154 
gsize
 
sys_block_·th_Ën
;

156 
sys_block_·th_Ën
 = 
	`g_¢´štf
 (
sys_block_·th
, 
HAL_PATH_MAX
, "/sys/block");

157 ià(
	`¡ºcmp
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, 
sys_block_·th
, 
sys_block_·th_Ën
) == 0) {

158 
	`HAL_INFO
 (("% i ¨block deviû (dev·th)", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
));

159 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS_BLOCK
;

161 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS_DEVICE
;

164 ià(
hÙ¶ug_ev’t
->
ty³
 =ğ
HOTPLUG_EVENT_SYSFS_DEVICE
) {

165 ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_ADD
 ||

166 (
d
 =ğ
NULL
 && 
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_CHANGE
)) {

167 
H®Deviû
 *
·»Á
;

168 
gch¬
 *
·»Á_·th
;

170 
	`h®_ut_fšd_known_·»Á
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
,

171 &
·»Á
, &
·»Á_·th
);

172 
	`hÙ¶ug_ev’t_begš_add_dev
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
,

173 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
,

174 
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
,

175 
·»Á
,

176 
·»Á_·th
,

177 (*è
hÙ¶ug_ev’t
);

178 
	`g_ä“
 (
·»Á_·th
);

179 } ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_REMOVE
) {

180 
	`hÙ¶ug_ev’t_begš_»move_dev
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
,

181 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
,

182 (*è
hÙ¶ug_ev’t
);

183 } ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_CHANGE
 && 
d
 !ğ
NULL
) {

184 
	`hÙ¶ug_ev’t_»äesh_dev
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
,

185 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
,

186 
d
,

187 (*è
hÙ¶ug_ev’t
);

188 } ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_MOVE
 && 
d
 !ğ
NULL
) {

189 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.sysfs_·th", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
);

190 
	`hÙ¶ug_ev’t_»äesh_dev
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
,

191 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
,

192 
d
,

193 (*è
hÙ¶ug_ev’t
);

195 
	`hÙ¶ug_ev’t_’d
 ((*è
hÙ¶ug_ev’t
);

197 } ià(
hÙ¶ug_ev’t
->
ty³
 =ğ
HOTPLUG_EVENT_SYSFS_BLOCK
) {

198 ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_ADD
 ||

199 (
d
 =ğ
NULL
 && 
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_CHANGE
)) {

200 
H®Deviû
 *
·»Á
;

201 
¿nge
;

202 
gboŞ—n
 
is_·¹™iÚ
;

212 ià((
	`¡r¡r
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, "/çkevŞume"è!ğ
NULL
) ||

213 
	`h®_ut_g‘_št_äom_fe
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, "¿nge", &
¿nge
, 0)) {

214 
is_·¹™iÚ
 = 
FALSE
;

216 
is_·¹™iÚ
 = 
TRUE
;

219 
	`h®_ut_fšd_known_·»Á
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, &
·»Á
, 
NULL
);

220 
	`hÙ¶ug_ev’t_begš_add_blockdev
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
,

221 
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
,

222 
is_·¹™iÚ
,

223 
·»Á
,

224 (*è
hÙ¶ug_ev’t
);

225 } ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_REMOVE
) {

226 
	`hÙ¶ug_ev’t_begš_»move_blockdev
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
,

227 (*è
hÙ¶ug_ev’t
);

228 } ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_CHANGE
 && 
d
 !ğ
NULL
) {

229 
	`hÙ¶ug_ev’t_»äesh_blockdev
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
,

230 
d
,

231 (*è
hÙ¶ug_ev’t
);

233 
	`hÙ¶ug_ev’t_’d
 ((*è
hÙ¶ug_ev’t
);

237 
	`hÙ¶ug_ev’t_’d
 ((*è
hÙ¶ug_ev’t
);

239 
	}
}

242 
	$hÙ¶ug_ev’t_begš_aıi
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
)

244 ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_ADD
) {

245 
	`hÙ¶ug_ev’t_begš_add_aıi
 (
hÙ¶ug_ev’t
->
aıi
.
aıi_·th
,

246 
hÙ¶ug_ev’t
->
aıi
.
aıi_ty³
,

247 
NULL
,

248 (*è
hÙ¶ug_ev’t
);

249 } ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_REMOVE
) {

250 
	`hÙ¶ug_ev’t_begš_»move_aıi
 (
hÙ¶ug_ev’t
->
aıi
.
aıi_·th
,

251 
hÙ¶ug_ev’t
->
aıi
.
aıi_ty³
,

252 (*è
hÙ¶ug_ev’t
);

254 
	}
}

257 
	$hÙ¶ug_ev’t_begš_­m
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
)

259 ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_ADD
) {

260 
	`hÙ¶ug_ev’t_begš_add_­m
 (
hÙ¶ug_ev’t
->
­m
.
­m_·th
,

261 
hÙ¶ug_ev’t
->
­m
.
­m_ty³
,

262 
NULL
,

263 (*è
hÙ¶ug_ev’t
);

264 } ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_REMOVE
) {

265 
	`hÙ¶ug_ev’t_begš_»move_­m
 (
hÙ¶ug_ev’t
->
­m
.
­m_·th
,

266 
hÙ¶ug_ev’t
->
­m
.
­m_ty³
,

267 (*è
hÙ¶ug_ev’t
);

269 
	}
}

272 
	$hÙ¶ug_ev’t_begš_pmu
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
)

274 ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_ADD
) {

275 
	`hÙ¶ug_ev’t_begš_add_pmu
 (
hÙ¶ug_ev’t
->
pmu
.
pmu_·th
,

276 
hÙ¶ug_ev’t
->
pmu
.
pmu_ty³
,

277 
NULL
,

278 (*è
hÙ¶ug_ev’t
);

279 } ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_REMOVE
) {

280 
	`hÙ¶ug_ev’t_begš_»move_pmu
 (
hÙ¶ug_ev’t
->
pmu
.
pmu_·th
,

281 
hÙ¶ug_ev’t
->
pmu
.
pmu_ty³
,

282 (*è
hÙ¶ug_ev’t
);

284 
	}
}

287 
	$hÙ¶ug_ev’t_begš
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
)

289 
hÙ¶ug_ev’t
->
ty³
) {

292 
HOTPLUG_EVENT_SYSFS
:

293 
HOTPLUG_EVENT_SYSFS_DEVICE
:

294 
HOTPLUG_EVENT_SYSFS_BLOCK
:

295 
	`hÙ¶ug_ev’t_begš_sysfs
 (
hÙ¶ug_ev’t
);

298 
HOTPLUG_EVENT_ACPI
:

299 
	`hÙ¶ug_ev’t_begš_aıi
 (
hÙ¶ug_ev’t
);

302 
HOTPLUG_EVENT_APM
:

303 
	`hÙ¶ug_ev’t_begš_­m
 (
hÙ¶ug_ev’t
);

306 
HOTPLUG_EVENT_PMU
:

307 
	`hÙ¶ug_ev’t_begš_pmu
 (
hÙ¶ug_ev’t
);

311 
	`HAL_ERROR
 (("UnknowÀhÙ¶ugƒv’ˆty³ %d", 
hÙ¶ug_ev’t
->
ty³
));

312 
	`hÙ¶ug_ev’t_’d
 ((*è
hÙ¶ug_ev’t
);

315 
	}
}

318 
	$hÙ¶ug_ev’t_’queue
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
)

320 ià(
	`G_UNLIKELY
 (
hÙ¶ug_ev’t_queue
 =ğ
NULL
))

321 
hÙ¶ug_ev’t_queue
 = 
	`g_queue_Ãw
 ();

323 
	`g_queue_push_
 (
hÙ¶ug_ev’t_queue
, 
hÙ¶ug_ev’t
);

324 
	}
}

327 
	$hÙ¶ug_ev’t_’queue_©_äÚt
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
)

329 ià(
	`G_UNLIKELY
 (
hÙ¶ug_ev’t_queue
 =ğ
NULL
))

330 
hÙ¶ug_ev’t_queue
 = 
	`g_queue_Ãw
 ();

332 
	`g_queue_push_h—d
 (
hÙ¶ug_ev’t_queue
, 
hÙ¶ug_ev’t
);

336 
hÙ¶ug_ev’t_queue_»¡¬t
 = 
TRUE
;

337 
	}
}

339 
gboŞ—n


340 
	$com·»_sysf¥©h
(cÚ¡ *
ruÂšg
, cÚ¡ *
wa™šg
)

342 
i
;

344 
i
 = 0; i < 
HAL_PATH_MAX
; i++) {

346 ià(
ruÂšg
[
i
] =ğ'\0' && 
wa™šg
[i] == '\0')

347  
TRUE
;

350 ià(
ruÂšg
[
i
] =ğ'\0' && 
wa™šg
[i] == '/')

351  
TRUE
;

354 ià(
ruÂšg
[
i
] =ğ'/' && 
wa™šg
[i] == '\0')

355  
TRUE
;

358 ià(
ruÂšg
[
i
] !ğ
wa™šg
[i])

362  
FALSE
;

363 
	}
}

368 
gboŞ—n


369 
	$com·»_ev’t
 (
HÙ¶ugEv’t
 *
ev’
, HÙ¶ugEv’ˆ*
ev’Œ
)

371 ià(*
ev’
->
sysfs
.
sysfs_·th_Şd
 != '\0')

372 ià(
	`¡rcmp
 (
ev’Œ
->
sysfs
.
sysfs_·th_Şd
, 
ev’
->sysfs.sysfs_path_old) == 0)

373  
TRUE
;

374  
	`com·»_sysf¥©h
 (
ev’Œ
->
sysfs
.
sysfs_·th
, 
ev’
->sysfs.sysfs_path);

375 
	}
}

380 
gboŞ—n


381 
	$com·»_ev’ts
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
, 
GLi¡
 *
ev’ts
)

383 
GLi¡
 *
Í
;

384 
HÙ¶ugEv’t
 *
loİ_ev’t
;

386 
hÙ¶ug_ev’t
->
ty³
) {

389 
HOTPLUG_EVENT_SYSFS
:

390 
HOTPLUG_EVENT_SYSFS_DEVICE
:

391 
HOTPLUG_EVENT_SYSFS_BLOCK
:

393 
Í
 = 
ev’ts
;†p;†°ğ
	`g_li¡_Ãxt
 (lp)) {

394 
loİ_ev’t
 = (
HÙ¶ugEv’t
*è
Í
->
d©a
;

396 ià(
loİ_ev’t
->
sysfs
.
£qnum
 >ğ
hÙ¶ug_ev’t
->sysfs.seqnum)

398 ià(
	`com·»_ev’t
 (
hÙ¶ug_ev’t
, 
loİ_ev’t
)) {

399 
	`HAL_DEBUG
 (("ev’ˆ% d•’dªˆÚ %s", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, 
loİ_ev’t
->sysfs.sysfs_path));

400  
TRUE
;

401 } ià(
hÙ¶ug_ev’t
->
sysfs
.
is_dm_deviû
) {

402 ià((
loİ_ev’t
->
ty³
 =ğ
HOTPLUG_EVENT_SYSFS_BLOCK
è&& !loİ_ev’t->
sysfs
.
is_dm_deviû
) {

403 
	`HAL_DEBUG
 (("event %s is dm-device, have‡t†east one (%s)‚on-dm block device in queue -> heldƒvent.",

404 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
, 
loİ_ev’t
->sysfs.sysfs_path ));

405  
TRUE
;

409  
FALSE
;

412  
FALSE
;

414 
	}
}

418 
	$hÙ¶ug_ev’t_´oûss_queue
 ()

420 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

421 
GLi¡
 *
Í
, *
Í2
;

422 
gboŞ—n
 
´oûssšg
 = 
FALSE
;

424 ià(
	`G_UNLIKELY
 (
hÙ¶ug_ev’t_queue
 =ğ
NULL
))

427 ià(
´oûssšg
)

430 
´oûssšg
 = 
TRUE
;

432 
Í
 = 
hÙ¶ug_ev’t_queue
->
h—d
;

433 
Í
 !ğ
NULL
) {

434 
hÙ¶ug_ev’t
 = 
Í
->
d©a
;

435 
	`HAL_INFO
 (("checkšgƒv’ˆ%s", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
));

436 ià(!
	`com·»_ev’ts
 (
hÙ¶ug_ev’t
, 
hÙ¶ug_ev’t_queue
->
h—d
)

437 && !
	`com·»_ev’ts
 (
hÙ¶ug_ev’t
, 
hÙ¶ug_ev’ts_š_´og»ss
)) {

438 
Í2
 = 
Í
->
´ev
;

439 
	`g_queue_uÆšk
(
hÙ¶ug_ev’t_queue
, 
Í
);

440 
hÙ¶ug_ev’ts_š_´og»ss
 = 
	`g_li¡_cÚÿt
 (hÙ¶ug_ev’ts_š_´og»ss, 
Í
);

441 
	`hÙ¶ug_ev’t_begš
 (
hÙ¶ug_ev’t
);

442 ià(
Í2
 =ğ
NULL
 || 
hÙ¶ug_ev’t_queue_»¡¬t
) {

443 
Í
 = 
hÙ¶ug_ev’t_queue
->
h—d
;

444 
hÙ¶ug_ev’t_queue_»¡¬t
 = 
FALSE
;

446 
Í
 = 
	`g_li¡_Ãxt
(
Í2
);

449 
	`HAL_DEBUG
 (("ev’ˆh–d back: %s", 
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
));

450 
Í
 = 
	`g_li¡_Ãxt
 (lp);

453 
	`HAL_DEBUG
 (("ev’t queued = %d,ƒv’t š…rog»s ğ%d", 
hÙ¶ug_ev’t_queue
->
Ëngth
, 
	`g_li¡_Ëngth
 (
hÙ¶ug_ev’ts_š_´og»ss
)));

455 
´oûssšg
 = 
FALSE
;

457 ià(
hÙ¶ug_ev’t_queue
->
Ëngth
 =ğ0 && 
	`g_li¡_Ëngth
 (
hÙ¶ug_ev’ts_š_´og»ss
) == 0) {

458 
	`HAL_DEBUG
(("Hotplug-queueƒmpty‚ow ...‚o hotplugƒvents in…rogress"));

459 
	`hÙ¶ug_queue_now_em±y
 ();

461 
	}
}

463 
gboŞ—n


464 
	$hÙ¶ug_»sÿn_deviû
 (
H®Deviû
 *
d
)

466 
gboŞ—n
 
»t
;

468 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.hotplug_type")) {

469 
HOTPLUG_EVENT_SYSFS_DEVICE
:

470 
»t
 = 
	`dev_»sÿn_deviû
 (
d
);

473 
HOTPLUG_EVENT_SYSFS_BLOCK
:

474 
»t
 = 
	`blockdev_»sÿn_deviû
 (
d
);

477 
HOTPLUG_EVENT_ACPI
:

478 
»t
 = 
	`aıi_»sÿn_deviû
 (
d
);

481 
HOTPLUG_EVENT_APM
:

482 
»t
 = 
	`­m_»sÿn_deviû
 (
d
);

485 
HOTPLUG_EVENT_PMU
:

486 
»t
 = 
	`pmu_»sÿn_deviû
 (
d
);

490 
	`HAL_INFO
 (("UnknowÀhÙ¶ugy³ fÜ udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

491 
»t
 = 
FALSE
;

495  
»t
;

496 
	}
}

499 
	$hÙ¶ug_»´obe_g’”©e_»move_ev’ts
 (
H®Deviû
 *
d
)

501 
GSLi¡
 *
i
;

502 
GSLi¡
 *
chds
;

503 
HÙ¶ugEv’t
 *
e
;

506 
chds
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
d
));

507 
i
 = 
chds
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

508 
H®Deviû
 *
chd
;

510 
chd
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

511 
	`hÙ¶ug_»´obe_g’”©e_»move_ev’ts
 (
chd
);

513 
	`g_¦i¡_ä“
 (
chds
);

516 
	`HAL_INFO
 (("G’”©»movev’ˆfÜ ud˜%s", 
	`h®_deviû_g‘_udi
 (
d
)));

517 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.hotplug_type")) {

518 
HOTPLUG_EVENT_SYSFS_DEVICE
:

519 
e
 = 
	`dev_g’”©e_»move_hÙ¶ug_ev’t
 (
d
);

522 
HOTPLUG_EVENT_SYSFS_BLOCK
:

523 
e
 = 
	`blockdev_g’”©e_»move_hÙ¶ug_ev’t
 (
d
);

526 
HOTPLUG_EVENT_ACPI
:

527 
e
 = 
	`aıi_g’”©e_»move_hÙ¶ug_ev’t
 (
d
);

530 
HOTPLUG_EVENT_APM
:

531 
e
 = 
	`­m_g’”©e_»move_hÙ¶ug_ev’t
 (
d
);

534 
HOTPLUG_EVENT_PMU
:

535 
e
 = 
	`pmu_g’”©e_»move_hÙ¶ug_ev’t
 (
d
);

539 
e
 = 
NULL
;

540 
	`HAL_INFO
 (("UnknowÀhÙ¶ugy³ fÜ udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

544 ià(
e
 !ğ
NULL
) {

545 
	`hÙ¶ug_ev’t_’queue
 (
e
);

547 
	}
}

550 
	$hÙ¶ug_»´obe_g’”©e_add_ev’ts
 (
H®Deviû
 *
d
)

552 
GSLi¡
 *
i
;

553 
GSLi¡
 *
chds
;

554 
HÙ¶ugEv’t
 *
e
;

557 
	`HAL_INFO
 (("G’”©addƒv’ˆfÜ ud˜%s", 
	`h®_deviû_g‘_udi
 (
d
)));

558 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.hotplug_type")) {

559 
HOTPLUG_EVENT_SYSFS_DEVICE
:

560 
e
 = 
	`dev_g’”©e_add_hÙ¶ug_ev’t
 (
d
);

563 
HOTPLUG_EVENT_SYSFS_BLOCK
:

564 
e
 = 
	`blockdev_g’”©e_add_hÙ¶ug_ev’t
 (
d
);

567 
HOTPLUG_EVENT_ACPI
:

568 
e
 = 
	`aıi_g’”©e_add_hÙ¶ug_ev’t
 (
d
);

571 
HOTPLUG_EVENT_APM
:

572 
e
 = 
	`­m_g’”©e_add_hÙ¶ug_ev’t
 (
d
);

575 
HOTPLUG_EVENT_PMU
:

576 
e
 = 
	`pmu_g’”©e_add_hÙ¶ug_ev’t
 (
d
);

580 
e
 = 
NULL
;

581 
	`HAL_INFO
 (("UnknowÀhÙ¶ugy³ fÜ udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

585 ià(
e
 !ğ
NULL
) {

586 
	`hÙ¶ug_ev’t_’queue
 (
e
);

590 
chds
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
d
));

591 
i
 = 
chds
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

592 
H®Deviû
 *
chd
;

594 
chd
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

595 
	`hÙ¶ug_»´obe_g’”©e_add_ev’ts
 (
chd
);

597 
	`g_¦i¡_ä“
 (
chds
);

598 
	}
}

600 
gboŞ—n


601 
	$hÙ¶ug_»´obe_Œ“
 (
H®Deviû
 *
d
)

603 
	`hÙ¶ug_»´obe_g’”©e_»move_ev’ts
 (
d
);

604 
	`hÙ¶ug_»´obe_g’”©e_add_ev’ts
 (
d
);

605 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

606  
FALSE
;

607 
	}
}

	@hald/linux/hotplug.h

26 #iâdeà
HOTPLUG_H


27 
	#HOTPLUG_H


	)

29 
	~<glib.h
>

31 
	~"../deviû.h
"

32 
	~"../ut.h
"

35 
	mHOTPLUG_ACTION_ADD
,

36 
	mHOTPLUG_ACTION_REMOVE
,

37 
	mHOTPLUG_ACTION_ONLINE
,

38 
	mHOTPLUG_ACTION_OFFLINE
,

39 
	mHOTPLUG_ACTION_CHANGE
,

40 
	mHOTPLUG_ACTION_MOVE


41 } 
	tHÙ¶ugAùiÚTy³
;

44 
	mHOTPLUG_EVENT_SYSFS
 = 0,

45 
	mHOTPLUG_EVENT_SYSFS_DEVICE
 = 2,

46 
	mHOTPLUG_EVENT_SYSFS_BLOCK
 = 3,

47 
	mHOTPLUG_EVENT_ACPI
 = 4,

48 
	mHOTPLUG_EVENT_APM
 = 5,

49 
	mHOTPLUG_EVENT_PMU
 = 6

50 } 
	tHÙ¶ugEv’tTy³
;

57 
HÙ¶ugAùiÚTy³
 
	maùiÚ
;

58 
HÙ¶ugEv’tTy³
 
	mty³
;

59 
gboŞ—n
 
	m»po¡ed
;

62 
	msubsy¡em
[
HAL_NAME_MAX
];

63 
	msysfs_·th
[
HAL_PATH_MAX
];

64 
	msysfs_·th_Şd
[
HAL_PATH_MAX
];

65 
	mdeviû_fe
[
HAL_PATH_MAX
];

66 
	m£qnum
;

67 
	mÃt_ifšdex
;

70 
gboŞ—n
 
	mis_dm_deviû
;

73 
	mv’dÜ
[
HAL_NAME_MAX
];

74 
	mmod–
[
HAL_NAME_MAX
];

75 
	m»visiÚ
[
HAL_NAME_MAX
];

76 
	m£rŸl
[
HAL_NAME_MAX
];

77 
	mfsu§ge
[
HAL_NAME_MAX
];

78 
	mf¡y³
[
HAL_NAME_MAX
];

79 
	mfsv”siÚ
[
HAL_NAME_MAX
];

80 
	mf¦ab–
[
HAL_NAME_MAX
];

81 
	mfsuuid
[
HAL_NAME_MAX
];

82 } 
	msysfs
;

85 
	maıi_ty³
;

86 
	maıi_·th
[
HAL_PATH_MAX
];

87 } 
	maıi
;

90 
	m­m_ty³
;

91 
	m­m_·th
[
HAL_PATH_MAX
];

92 } 
	m­m
;

95 
	mpmu_ty³
;

96 
	mpmu_·th
[
HAL_PATH_MAX
];

97 } 
	mpmu
;

100 } 
	tHÙ¶ugEv’t
;

102 
hÙ¶ug_ev’t_’queue
 (
HÙ¶ugEv’t
 *
ev’t
);

104 
hÙ¶ug_ev’t_’queue_©_äÚt
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
);

106 
hÙ¶ug_ev’t_´oûss_queue
 ();

108 
hÙ¶ug_ev’t_’d
 (*
’d_tok’
);

110 
hÙ¶ug_ev’t_»po¡ed
 (*
’d_tok’
);

112 
gboŞ—n
 
hÙ¶ug_»sÿn_deviû
 (
H®Deviû
 *
d
);

114 
gboŞ—n
 
hÙ¶ug_»´obe_Œ“
 (
H®Deviû
 *
d
);

116 
hÙ¶ug_queue_now_em±y
 ();

	@hald/linux/hotplug_helper.h

26 #iâdeà
HALD_HELPER_H


27 
	#HALD_HELPER_H


	)

29 
	#HALD_HELPER_MAGIC
 0x68616c64

	)

30 
	#HALD_HELPER_SOCKET_PATH
 "/v¬/run/h®d/hÙ¶ug_sock‘2"

	)

31 
	#HALD_HELPER_STRLEN
 256

	)

33 
	sh®d_h–³r_msg


35 
	mmagic
;

36 
	m£qnum
;

37 
	maùiÚ
[
HALD_HELPER_STRLEN
];

38 
	msubsy¡em
[
HALD_HELPER_STRLEN
];

39 
	msysfs_·th
[
HALD_HELPER_STRLEN
];

40 
	mdeviû_Çme
[
HALD_HELPER_STRLEN
];

41 
	mÃt_ifšdex
;

42 
time_t
 
	mtime_¡amp
;

	@hald/linux/inotify_local.h

21 #iâdeà
_INOTIFY_LOCAL_H_


22 
	#_INOTIFY_LOCAL_H_


	)

24 
	~<¡ršg.h
>

25 
	~<uni¡d.h
>

26 
	~<¡dšt.h
>

29 
	~<sys/sysÿÎ.h
>

30 #iâdeà
__NR_šÙify_š™


31 #ià
defšed
(
__i386__
)

32 
	#__NR_šÙify_š™
 291

	)

33 
	#__NR_šÙify_add_w©ch
 292

	)

34 
	#__NR_šÙify_rm_w©ch
 293

	)

35 #–ià
defšed
(
__x86_64__
)

36 
	#__NR_šÙify_š™
 253

	)

37 
	#__NR_šÙify_add_w©ch
 254

	)

38 
	#__NR_šÙify_rm_w©ch
 255

	)

39 #–ià
defšed
(
__pow”pc__
è|| defšed(
__pow”pc64__
)

40 
	#__NR_šÙify_š™
 275

	)

41 
	#__NR_šÙify_add_w©ch
 276

	)

42 
	#__NR_šÙify_rm_w©ch
 277

	)

43 #–ià
defšed
 (
__Ÿ64__
)

44 
	#__NR_šÙify_š™
 1277

	)

45 
	#__NR_šÙify_add_w©ch
 1278

	)

46 
	#__NR_šÙify_rm_w©ch
 1279

	)

47 #–ià
defšed
 (
__s390__
)

48 
	#__NR_šÙify_š™
 284

	)

49 
	#__NR_šÙify_add_w©ch
 285

	)

50 
	#__NR_šÙify_rm_w©ch
 286

	)

51 #–ià
defšed
 (
__mc68000__
)

52 
	#__NR_šÙify_š™
 284

	)

53 
	#__NR_šÙify_add_w©ch
 285

	)

54 
	#__NR_šÙify_rm_w©ch
 286

	)

55 #–ià
defšed
 (
__®pha__
)

56 
	#__NR_šÙify_š™
 444

	)

57 
	#__NR_šÙify_add_w©ch
 445

	)

58 
	#__NR_šÙify_rm_w©ch
 446

	)

59 #–ià
defšed
 (
__¥¬c__
è|| defšed (
__¥¬c64__
)

60 
	#__NR_šÙify_š™
 151

	)

61 
	#__NR_šÙify_add_w©ch
 152

	)

62 
	#__NR_šÙify_rm_w©ch
 156

	)

63 #–ià
defšed
 (
__¬m__
)

64 
	#__NR_šÙify_š™
 
__NR_SYSCALL_BASE
+316

	)

65 
	#__NR_šÙify_add_w©ch
 
__NR_SYSCALL_BASE
+317

	)

66 
	#__NR_šÙify_rm_w©ch
 
__NR_SYSCALL_BASE
+318

	)

67 #–ià
defšed
 (
__sh__
)

68 
	#__NR_šÙify_š™
 290

	)

69 
	#__NR_šÙify_add_w©ch
 291

	)

70 
	#__NR_šÙify_rm_w©ch
 292

	)

71 #–ià
defšed
 (
__m32r__
)

72 
	#__NR_šÙify_š™
 290

	)

73 
	#__NR_šÙify_add_w©ch
 291

	)

74 
	#__NR_šÙify_rm_w©ch
 292

	)

75 #–ià
defšed
 (
__hµa__
)

76 
	#__NR_šÙify_š™
 269

	)

77 
	#__NR_šÙify_add_w©ch
 270

	)

78 
	#__NR_šÙify_rm_w©ch
 271

	)

79 #–ià
defšed
 (
__ms__
)

80 
	~<sgidefs.h
>

81 #ià
_MIPS_SIM
 =ğ
_MIPS_SIM_ABI32


82 
	#__NR_Lšux
 4000

	)

83 
	#__NR_šÙify_š™
 (
__NR_Lšux
 + 284)

	)

84 
	#__NR_šÙify_add_w©ch
 (
__NR_Lšux
 + 285)

	)

85 
	#__NR_šÙify_rm_w©ch
 (
__NR_Lšux
 + 286)

	)

86 #–ià
_MIPS_SIM
 =ğ
_MIPS_SIM_ABI64


87 
	#__NR_Lšux
 5000

	)

88 
	#__NR_šÙify_š™
 (
__NR_Lšux
 + 243)

	)

89 
	#__NR_šÙify_add_w©ch
 (
__NR_Lšux
 + 244)

	)

90 
	#__NR_šÙify_rm_w©ch
 (
__NR_Lšux
 + 245)

	)

91 #–ià
_MIPS_SIM
 =ğ
_MIPS_SIM_NABI32


92 
	#__NR_Lšux
 6000

	)

93 
	#__NR_šÙify_š™
 (
__NR_Lšux
 + 247)

	)

94 
	#__NR_šÙify_add_w©ch
 (
__NR_Lšux
 + 248)

	)

95 
	#__NR_šÙify_rm_w©ch
 (
__NR_Lšux
 + 249)

	)

103 #iâdeà
__NR_šÙify_š™


104 
šlše
 
	$šÙify_š™
()

107 
	}
}

109 
šlše
 
	$šÙify_add_w©ch
(
fd
, cÚ¡ *
Çme
, 
ušt32_t
 
mask
)

112 
	}
}

114 
šlše
 
	$šÙify_rm_w©ch
(
fd
, 
ušt32_t
 
wd
)

117 
	}
}

119 
šlše
 
	$šÙify_š™
()

121  
	`sysÿÎ
(
__NR_šÙify_š™
);

122 
	}
}

124 
šlše
 
	$šÙify_add_w©ch
(
fd
, cÚ¡ *
Çme
, 
ušt32_t
 
mask
)

126  
	`sysÿÎ
(
__NR_šÙify_add_w©ch
, 
fd
, 
Çme
, 
mask
);

127 
	}
}

129 
šlše
 
	$šÙify_rm_w©ch
(
fd
, 
ušt32_t
 
wd
)

131  
	`sysÿÎ
(
__NR_šÙify_rm_w©ch
, 
fd
, 
wd
);

132 
	}
}

135 #iâdeà
IN_CREATE


136 
	#IN_CREATE
 0x00000100

	)

137 
	#IN_MOVED_FROM
 0x00000040

	)

138 
	#IN_MOVED_TO
 0x00000080

	)

139 
	#IN_DELETE
 0x00000200

	)

140 
	#IN_CLOSE_WRITE
 0x00000008

	)

141 
	#IN_MOVE
 (
IN_MOVED_FROM
 | 
IN_MOVED_TO
è

	)

144 
	sšÙify_ev’t
 {

145 
	mwd
;

146 
ušt32_t
 
	mmask
;

147 
ušt32_t
 
	mcook›
;

148 
ušt32_t
 
	mËn
;

149 
	mÇme
[];

153 
	#IN_ACCESS
 0x00000001

	)

154 
	#IN_MODIFY
 0x00000002

	)

155 
	#IN_ATTRIB
 0x00000004

	)

156 
	#IN_CLOSE_WRITE
 0x00000008

	)

157 
	#IN_CLOSE_NOWRITE
 0x00000010

	)

158 
	#IN_OPEN
 0x00000020

	)

159 
	#IN_MOVED_FROM
 0x00000040

	)

160 
	#IN_MOVED_TO
 0x00000080

	)

161 
	#IN_CREATE
 0x00000100

	)

162 
	#IN_DELETE
 0x00000200

	)

163 
	#IN_DELETE_SELF
 0x00000400

	)

164 
	#IN_MOVE_SELF
 0x00000800

	)

167 
	#IN_UNMOUNT
 0x00002000

	)

168 
	#IN_Q_OVERFLOW
 0x00004000

	)

169 
	#IN_IGNORED
 0x00008000

	)

172 
	#IN_CLOSE
 (
IN_CLOSE_WRITE
 | 
IN_CLOSE_NOWRITE
è

	)

173 
	#IN_MOVE
 (
IN_MOVED_FROM
 | 
IN_MOVED_TO
è

	)

176 
	#IN_ONLYDIR
 0x01000000

	)

177 
	#IN_DONT_FOLLOW
 0x02000000

	)

178 
	#IN_MASK_ADD
 0x20000000

	)

179 
	#IN_ISDIR
 0x40000000

	)

180 
	#IN_ONESHOT
 0x80000000

	)

187 
	#IN_ALL_EVENTS
 (
IN_ACCESS
 | 
IN_MODIFY
 | 
IN_ATTRIB
 | 
IN_CLOSE_WRITE
 | \

188 
IN_CLOSE_NOWRITE
 | 
IN_OPEN
 | 
IN_MOVED_FROM
 | \

189 
IN_MOVED_TO
 | 
IN_DELETE
 | 
IN_CREATE
 | 
IN_DELETE_SELF
 | \

190 
IN_MOVE_SELF
)

	)

	@hald/linux/input_local.h

1 #iâdeà
_INPUT_H


2 
	#_INPUT_H


	)

12 #ifdeà
__KERNEL__


13 
	~<lšux/time.h
>

14 
	~<lšux/li¡.h
>

16 
	~<sys/time.h
>

17 
	~<sys/ioùl.h
>

18 
	~<sys/ty³s.h
>

19 
	~<asm/ty³s.h
>

26 
	sšput_ev’t
 {

27 
timev®
 
	mtime
;

28 
__u16
 
	mty³
;

29 
__u16
 
	mcode
;

30 
__s32
 
	mv®ue
;

37 
	#EV_VERSION
 0x010000

	)

43 
	sšput_id
 {

44 
__u16
 
	mbu¡y³
;

45 
__u16
 
	mv’dÜ
;

46 
__u16
 
	m´oduù
;

47 
__u16
 
	mv”siÚ
;

50 
	sšput_absšfo
 {

51 
__s32
 
	mv®ue
;

52 
__s32
 
	mmšimum
;

53 
__s32
 
	mmaximum
;

54 
__s32
 
	mfuzz
;

55 
__s32
 
	mæ©
;

58 
	#EVIOCGVERSION
 
	`_IOR
('E', 0x01, è

	)

59 
	#EVIOCGID
 
	`_IOR
('E', 0x02, 
šput_id
è

	)

60 
	#EVIOCGREP
 
	`_IOR
('E', 0x03, [2]è

	)

61 
	#EVIOCSREP
 
	`_IOW
('E', 0x03, [2]è

	)

62 
	#EVIOCGKEYCODE
 
	`_IOR
('E', 0x04, [2]è

	)

63 
	#EVIOCSKEYCODE
 
	`_IOW
('E', 0x04, [2]è

	)

65 
	#EVIOCGNAME
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x06,†’è

	)

66 
	#EVIOCGPHYS
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x07,†’è

	)

67 
	#EVIOCGUNIQ
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x08,†’è

	)

69 
	#EVIOCGKEY
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x18,†’è

	)

70 
	#EVIOCGLED
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x19,†’è

	)

71 
	#EVIOCGSND
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x1a,†’è

	)

72 
	#EVIOCGSW
(
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x1b,†’è

	)

74 
	#EVIOCGBIT
(
ev
,
Ën
è
	`_IOC
(
_IOC_READ
, 'E', 0x20 +ƒv,†’è

	)

75 
	#EVIOCGABS
(
abs
è
	`_IOR
('E', 0x40 +‡bs, 
šput_absšfo
è

	)

76 
	#EVIOCSABS
(
abs
è
	`_IOW
('E', 0xc0 +‡bs, 
šput_absšfo
è

	)

78 
	#EVIOCSFF
 
	`_IOC
(
_IOC_WRITE
, 'E', 0x80, (
ff_efãù
)è

	)

79 
	#EVIOCRMFF
 
	`_IOW
('E', 0x81, è

	)

80 
	#EVIOCGEFFECTS
 
	`_IOR
('E', 0x84, è

	)

82 
	#EVIOCGRAB
 
	`_IOW
('E', 0x90, è

	)

88 
	#EV_SYN
 0x00

	)

89 
	#EV_KEY
 0x01

	)

90 
	#EV_REL
 0x02

	)

91 
	#EV_ABS
 0x03

	)

92 
	#EV_MSC
 0x04

	)

93 
	#EV_SW
 0x05

	)

94 
	#EV_LED
 0x11

	)

95 
	#EV_SND
 0x12

	)

96 
	#EV_REP
 0x14

	)

97 
	#EV_FF
 0x15

	)

98 
	#EV_PWR
 0x16

	)

99 
	#EV_FF_STATUS
 0x17

	)

100 
	#EV_MAX
 0x1f

	)

101 
	#EV_CNT
 (
EV_MAX
+1)

	)

107 
	#SYN_REPORT
 0

	)

108 
	#SYN_CONFIG
 1

	)

121 
	#KEY_RESERVED
 0

	)

122 
	#KEY_ESC
 1

	)

123 
	#KEY_1
 2

	)

124 
	#KEY_2
 3

	)

125 
	#KEY_3
 4

	)

126 
	#KEY_4
 5

	)

127 
	#KEY_5
 6

	)

128 
	#KEY_6
 7

	)

129 
	#KEY_7
 8

	)

130 
	#KEY_8
 9

	)

131 
	#KEY_9
 10

	)

132 
	#KEY_0
 11

	)

133 
	#KEY_MINUS
 12

	)

134 
	#KEY_EQUAL
 13

	)

135 
	#KEY_BACKSPACE
 14

	)

136 
	#KEY_TAB
 15

	)

137 
	#KEY_Q
 16

	)

138 
	#KEY_W
 17

	)

139 
	#KEY_E
 18

	)

140 
	#KEY_R
 19

	)

141 
	#KEY_T
 20

	)

142 
	#KEY_Y
 21

	)

143 
	#KEY_U
 22

	)

144 
	#KEY_I
 23

	)

145 
	#KEY_O
 24

	)

146 
	#KEY_P
 25

	)

147 
	#KEY_LEFTBRACE
 26

	)

148 
	#KEY_RIGHTBRACE
 27

	)

149 
	#KEY_ENTER
 28

	)

150 
	#KEY_LEFTCTRL
 29

	)

151 
	#KEY_A
 30

	)

152 
	#KEY_S
 31

	)

153 
	#KEY_D
 32

	)

154 
	#KEY_F
 33

	)

155 
	#KEY_G
 34

	)

156 
	#KEY_H
 35

	)

157 
	#KEY_J
 36

	)

158 
	#KEY_K
 37

	)

159 
	#KEY_L
 38

	)

160 
	#KEY_SEMICOLON
 39

	)

161 
	#KEY_APOSTROPHE
 40

	)

162 
	#KEY_GRAVE
 41

	)

163 
	#KEY_LEFTSHIFT
 42

	)

164 
	#KEY_BACKSLASH
 43

	)

165 
	#KEY_Z
 44

	)

166 
	#KEY_X
 45

	)

167 
	#KEY_C
 46

	)

168 
	#KEY_V
 47

	)

169 
	#KEY_B
 48

	)

170 
	#KEY_N
 49

	)

171 
	#KEY_M
 50

	)

172 
	#KEY_COMMA
 51

	)

173 
	#KEY_DOT
 52

	)

174 
	#KEY_SLASH
 53

	)

175 
	#KEY_RIGHTSHIFT
 54

	)

176 
	#KEY_KPASTERISK
 55

	)

177 
	#KEY_LEFTALT
 56

	)

178 
	#KEY_SPACE
 57

	)

179 
	#KEY_CAPSLOCK
 58

	)

180 
	#KEY_F1
 59

	)

181 
	#KEY_F2
 60

	)

182 
	#KEY_F3
 61

	)

183 
	#KEY_F4
 62

	)

184 
	#KEY_F5
 63

	)

185 
	#KEY_F6
 64

	)

186 
	#KEY_F7
 65

	)

187 
	#KEY_F8
 66

	)

188 
	#KEY_F9
 67

	)

189 
	#KEY_F10
 68

	)

190 
	#KEY_NUMLOCK
 69

	)

191 
	#KEY_SCROLLLOCK
 70

	)

192 
	#KEY_KP7
 71

	)

193 
	#KEY_KP8
 72

	)

194 
	#KEY_KP9
 73

	)

195 
	#KEY_KPMINUS
 74

	)

196 
	#KEY_KP4
 75

	)

197 
	#KEY_KP5
 76

	)

198 
	#KEY_KP6
 77

	)

199 
	#KEY_KPPLUS
 78

	)

200 
	#KEY_KP1
 79

	)

201 
	#KEY_KP2
 80

	)

202 
	#KEY_KP3
 81

	)

203 
	#KEY_KP0
 82

	)

204 
	#KEY_KPDOT
 83

	)

206 
	#KEY_ZENKAKUHANKAKU
 85

	)

207 
	#KEY_102ND
 86

	)

208 
	#KEY_F11
 87

	)

209 
	#KEY_F12
 88

	)

210 
	#KEY_RO
 89

	)

211 
	#KEY_KATAKANA
 90

	)

212 
	#KEY_HIRAGANA
 91

	)

213 
	#KEY_HENKAN
 92

	)

214 
	#KEY_KATAKANAHIRAGANA
 93

	)

215 
	#KEY_MUHENKAN
 94

	)

216 
	#KEY_KPJPCOMMA
 95

	)

217 
	#KEY_KPENTER
 96

	)

218 
	#KEY_RIGHTCTRL
 97

	)

219 
	#KEY_KPSLASH
 98

	)

220 
	#KEY_SYSRQ
 99

	)

221 
	#KEY_RIGHTALT
 100

	)

222 
	#KEY_LINEFEED
 101

	)

223 
	#KEY_HOME
 102

	)

224 
	#KEY_UP
 103

	)

225 
	#KEY_PAGEUP
 104

	)

226 
	#KEY_LEFT
 105

	)

227 
	#KEY_RIGHT
 106

	)

228 
	#KEY_END
 107

	)

229 
	#KEY_DOWN
 108

	)

230 
	#KEY_PAGEDOWN
 109

	)

231 
	#KEY_INSERT
 110

	)

232 
	#KEY_DELETE
 111

	)

233 
	#KEY_MACRO
 112

	)

234 
	#KEY_MUTE
 113

	)

235 
	#KEY_VOLUMEDOWN
 114

	)

236 
	#KEY_VOLUMEUP
 115

	)

237 
	#KEY_POWER
 116

	)

238 
	#KEY_KPEQUAL
 117

	)

239 
	#KEY_KPPLUSMINUS
 118

	)

240 
	#KEY_PAUSE
 119

	)

242 
	#KEY_KPCOMMA
 121

	)

243 
	#KEY_HANGEUL
 122

	)

244 
	#KEY_HANGUEL
 
KEY_HANGEUL


	)

245 
	#KEY_HANJA
 123

	)

246 
	#KEY_YEN
 124

	)

247 
	#KEY_LEFTMETA
 125

	)

248 
	#KEY_RIGHTMETA
 126

	)

249 
	#KEY_COMPOSE
 127

	)

251 
	#KEY_STOP
 128

	)

252 
	#KEY_AGAIN
 129

	)

253 
	#KEY_PROPS
 130

	)

254 
	#KEY_UNDO
 131

	)

255 
	#KEY_FRONT
 132

	)

256 
	#KEY_COPY
 133

	)

257 
	#KEY_OPEN
 134

	)

258 
	#KEY_PASTE
 135

	)

259 
	#KEY_FIND
 136

	)

260 
	#KEY_CUT
 137

	)

261 
	#KEY_HELP
 138

	)

262 
	#KEY_MENU
 139

	)

263 
	#KEY_CALC
 140

	)

264 
	#KEY_SETUP
 141

	)

265 
	#KEY_SLEEP
 142

	)

266 
	#KEY_WAKEUP
 143

	)

267 
	#KEY_FILE
 144

	)

268 
	#KEY_SENDFILE
 145

	)

269 
	#KEY_DELETEFILE
 146

	)

270 
	#KEY_XFER
 147

	)

271 
	#KEY_PROG1
 148

	)

272 
	#KEY_PROG2
 149

	)

273 
	#KEY_WWW
 150

	)

274 
	#KEY_MSDOS
 151

	)

275 
	#KEY_COFFEE
 152

	)

276 
	#KEY_SCREENLOCK
 
KEY_COFFEE


	)

277 
	#KEY_DIRECTION
 153

	)

278 
	#KEY_CYCLEWINDOWS
 154

	)

279 
	#KEY_MAIL
 155

	)

280 
	#KEY_BOOKMARKS
 156

	)

281 
	#KEY_COMPUTER
 157

	)

282 
	#KEY_BACK
 158

	)

283 
	#KEY_FORWARD
 159

	)

284 
	#KEY_CLOSECD
 160

	)

285 
	#KEY_EJECTCD
 161

	)

286 
	#KEY_EJECTCLOSECD
 162

	)

287 
	#KEY_NEXTSONG
 163

	)

288 
	#KEY_PLAYPAUSE
 164

	)

289 
	#KEY_PREVIOUSSONG
 165

	)

290 
	#KEY_STOPCD
 166

	)

291 
	#KEY_RECORD
 167

	)

292 
	#KEY_REWIND
 168

	)

293 
	#KEY_PHONE
 169

	)

294 
	#KEY_ISO
 170

	)

295 
	#KEY_CONFIG
 171

	)

296 
	#KEY_HOMEPAGE
 172

	)

297 
	#KEY_REFRESH
 173

	)

298 
	#KEY_EXIT
 174

	)

299 
	#KEY_MOVE
 175

	)

300 
	#KEY_EDIT
 176

	)

301 
	#KEY_SCROLLUP
 177

	)

302 
	#KEY_SCROLLDOWN
 178

	)

303 
	#KEY_KPLEFTPAREN
 179

	)

304 
	#KEY_KPRIGHTPAREN
 180

	)

305 
	#KEY_NEW
 181

	)

306 
	#KEY_REDO
 182

	)

308 
	#KEY_F13
 183

	)

309 
	#KEY_F14
 184

	)

310 
	#KEY_F15
 185

	)

311 
	#KEY_F16
 186

	)

312 
	#KEY_F17
 187

	)

313 
	#KEY_F18
 188

	)

314 
	#KEY_F19
 189

	)

315 
	#KEY_F20
 190

	)

316 
	#KEY_F21
 191

	)

317 
	#KEY_F22
 192

	)

318 
	#KEY_F23
 193

	)

319 
	#KEY_F24
 194

	)

321 
	#KEY_PLAYCD
 200

	)

322 
	#KEY_PAUSECD
 201

	)

323 
	#KEY_PROG3
 202

	)

324 
	#KEY_PROG4
 203

	)

325 
	#KEY_SUSPEND
 205

	)

326 
	#KEY_CLOSE
 206

	)

327 
	#KEY_PLAY
 207

	)

328 
	#KEY_FASTFORWARD
 208

	)

329 
	#KEY_BASSBOOST
 209

	)

330 
	#KEY_PRINT
 210

	)

331 
	#KEY_HP
 211

	)

332 
	#KEY_CAMERA
 212

	)

333 
	#KEY_SOUND
 213

	)

334 
	#KEY_QUESTION
 214

	)

335 
	#KEY_EMAIL
 215

	)

336 
	#KEY_CHAT
 216

	)

337 
	#KEY_SEARCH
 217

	)

338 
	#KEY_CONNECT
 218

	)

339 
	#KEY_FINANCE
 219

	)

340 
	#KEY_SPORT
 220

	)

341 
	#KEY_SHOP
 221

	)

342 
	#KEY_ALTERASE
 222

	)

343 
	#KEY_CANCEL
 223

	)

344 
	#KEY_BRIGHTNESSDOWN
 224

	)

345 
	#KEY_BRIGHTNESSUP
 225

	)

346 
	#KEY_MEDIA
 226

	)

348 
	#KEY_SWITCHVIDEOMODE
 227

	)

350 
	#KEY_KBDILLUMTOGGLE
 228

	)

351 
	#KEY_KBDILLUMDOWN
 229

	)

352 
	#KEY_KBDILLUMUP
 230

	)

354 
	#KEY_SEND
 231

	)

355 
	#KEY_REPLY
 232

	)

356 
	#KEY_FORWARDMAIL
 233

	)

357 
	#KEY_SAVE
 234

	)

358 
	#KEY_DOCUMENTS
 235

	)

360 
	#KEY_BATTERY
 236

	)

362 
	#KEY_BLUETOOTH
 237

	)

363 
	#KEY_WLAN
 238

	)

364 
	#KEY_UWB
 239

	)

366 
	#KEY_UNKNOWN
 240

	)

368 
	#KEY_VIDEO_NEXT
 241

	)

369 
	#KEY_VIDEO_PREV
 242

	)

370 
	#KEY_BRIGHTNESS_CYCLE
 243

	)

371 
	#KEY_BRIGHTNESS_ZERO
 244

	)

372 
	#KEY_DISPLAY_OFF
 245

	)

374 
	#KEY_WIMAX
 246

	)

378 
	#BTN_MISC
 0x100

	)

379 
	#BTN_0
 0x100

	)

380 
	#BTN_1
 0x101

	)

381 
	#BTN_2
 0x102

	)

382 
	#BTN_3
 0x103

	)

383 
	#BTN_4
 0x104

	)

384 
	#BTN_5
 0x105

	)

385 
	#BTN_6
 0x106

	)

386 
	#BTN_7
 0x107

	)

387 
	#BTN_8
 0x108

	)

388 
	#BTN_9
 0x109

	)

390 
	#BTN_MOUSE
 0x110

	)

391 
	#BTN_LEFT
 0x110

	)

392 
	#BTN_RIGHT
 0x111

	)

393 
	#BTN_MIDDLE
 0x112

	)

394 
	#BTN_SIDE
 0x113

	)

395 
	#BTN_EXTRA
 0x114

	)

396 
	#BTN_FORWARD
 0x115

	)

397 
	#BTN_BACK
 0x116

	)

398 
	#BTN_TASK
 0x117

	)

400 
	#BTN_JOYSTICK
 0x120

	)

401 
	#BTN_TRIGGER
 0x120

	)

402 
	#BTN_THUMB
 0x121

	)

403 
	#BTN_THUMB2
 0x122

	)

404 
	#BTN_TOP
 0x123

	)

405 
	#BTN_TOP2
 0x124

	)

406 
	#BTN_PINKIE
 0x125

	)

407 
	#BTN_BASE
 0x126

	)

408 
	#BTN_BASE2
 0x127

	)

409 
	#BTN_BASE3
 0x128

	)

410 
	#BTN_BASE4
 0x129

	)

411 
	#BTN_BASE5
 0x12a

	)

412 
	#BTN_BASE6
 0x12b

	)

413 
	#BTN_DEAD
 0x12f

	)

415 
	#BTN_GAMEPAD
 0x130

	)

416 
	#BTN_A
 0x130

	)

417 
	#BTN_B
 0x131

	)

418 
	#BTN_C
 0x132

	)

419 
	#BTN_X
 0x133

	)

420 
	#BTN_Y
 0x134

	)

421 
	#BTN_Z
 0x135

	)

422 
	#BTN_TL
 0x136

	)

423 
	#BTN_TR
 0x137

	)

424 
	#BTN_TL2
 0x138

	)

425 
	#BTN_TR2
 0x139

	)

426 
	#BTN_SELECT
 0x13a

	)

427 
	#BTN_START
 0x13b

	)

428 
	#BTN_MODE
 0x13c

	)

429 
	#BTN_THUMBL
 0x13d

	)

430 
	#BTN_THUMBR
 0x13e

	)

432 
	#BTN_DIGI
 0x140

	)

433 
	#BTN_TOOL_PEN
 0x140

	)

434 
	#BTN_TOOL_RUBBER
 0x141

	)

435 
	#BTN_TOOL_BRUSH
 0x142

	)

436 
	#BTN_TOOL_PENCIL
 0x143

	)

437 
	#BTN_TOOL_AIRBRUSH
 0x144

	)

438 
	#BTN_TOOL_FINGER
 0x145

	)

439 
	#BTN_TOOL_MOUSE
 0x146

	)

440 
	#BTN_TOOL_LENS
 0x147

	)

441 
	#BTN_TOUCH
 0x14a

	)

442 
	#BTN_STYLUS
 0x14b

	)

443 
	#BTN_STYLUS2
 0x14c

	)

444 
	#BTN_TOOL_DOUBLETAP
 0x14d

	)

445 
	#BTN_TOOL_TRIPLETAP
 0x14e

	)

447 
	#BTN_WHEEL
 0x150

	)

448 
	#BTN_GEAR_DOWN
 0x150

	)

449 
	#BTN_GEAR_UP
 0x151

	)

451 
	#KEY_OK
 0x160

	)

452 
	#KEY_SELECT
 0x161

	)

453 
	#KEY_GOTO
 0x162

	)

454 
	#KEY_CLEAR
 0x163

	)

455 
	#KEY_POWER2
 0x164

	)

456 
	#KEY_OPTION
 0x165

	)

457 
	#KEY_INFO
 0x166

	)

458 
	#KEY_TIME
 0x167

	)

459 
	#KEY_VENDOR
 0x168

	)

460 
	#KEY_ARCHIVE
 0x169

	)

461 
	#KEY_PROGRAM
 0x16¨

	)

462 
	#KEY_CHANNEL
 0x16b

	)

463 
	#KEY_FAVORITES
 0x16c

	)

464 
	#KEY_EPG
 0x16d

	)

465 
	#KEY_PVR
 0x16

	)

466 
	#KEY_MHP
 0x16f

	)

467 
	#KEY_LANGUAGE
 0x170

	)

468 
	#KEY_TITLE
 0x171

	)

469 
	#KEY_SUBTITLE
 0x172

	)

470 
	#KEY_ANGLE
 0x173

	)

471 
	#KEY_ZOOM
 0x174

	)

472 
	#KEY_MODE
 0x175

	)

473 
	#KEY_KEYBOARD
 0x176

	)

474 
	#KEY_SCREEN
 0x177

	)

475 
	#KEY_PC
 0x178

	)

476 
	#KEY_TV
 0x179

	)

477 
	#KEY_TV2
 0x17¨

	)

478 
	#KEY_VCR
 0x17b

	)

479 
	#KEY_VCR2
 0x17ø

	)

480 
	#KEY_SAT
 0x17d

	)

481 
	#KEY_SAT2
 0x17e

	)

482 
	#KEY_CD
 0x17à

	)

483 
	#KEY_TAPE
 0x180

	)

484 
	#KEY_RADIO
 0x181

	)

485 
	#KEY_TUNER
 0x182

	)

486 
	#KEY_PLAYER
 0x183

	)

487 
	#KEY_TEXT
 0x184

	)

488 
	#KEY_DVD
 0x185

	)

489 
	#KEY_AUX
 0x186

	)

490 
	#KEY_MP3
 0x187

	)

491 
	#KEY_AUDIO
 0x188

	)

492 
	#KEY_VIDEO
 0x189

	)

493 
	#KEY_DIRECTORY
 0x18a

	)

494 
	#KEY_LIST
 0x18b

	)

495 
	#KEY_MEMO
 0x18ø

	)

496 
	#KEY_CALENDAR
 0x18d

	)

497 
	#KEY_RED
 0x18e

	)

498 
	#KEY_GREEN
 0x18f

	)

499 
	#KEY_YELLOW
 0x190

	)

500 
	#KEY_BLUE
 0x191

	)

501 
	#KEY_CHANNELUP
 0x192

	)

502 
	#KEY_CHANNELDOWN
 0x193

	)

503 
	#KEY_FIRST
 0x194

	)

504 
	#KEY_LAST
 0x195

	)

505 
	#KEY_AB
 0x196

	)

506 
	#KEY_NEXT
 0x197

	)

507 
	#KEY_RESTART
 0x198

	)

508 
	#KEY_SLOW
 0x199

	)

509 
	#KEY_SHUFFLE
 0x19a

	)

510 
	#KEY_BREAK
 0x19b

	)

511 
	#KEY_PREVIOUS
 0x19c

	)

512 
	#KEY_DIGITS
 0x19d

	)

513 
	#KEY_TEEN
 0x19e

	)

514 
	#KEY_TWEN
 0x19f

	)

515 
	#KEY_VIDEOPHONE
 0x1a0

	)

516 
	#KEY_GAMES
 0x1a1

	)

517 
	#KEY_ZOOMIN
 0x1a2

	)

518 
	#KEY_ZOOMOUT
 0x1a3

	)

519 
	#KEY_ZOOMRESET
 0x1a4

	)

520 
	#KEY_WORDPROCESSOR
 0x1a5

	)

521 
	#KEY_EDITOR
 0x1a6

	)

522 
	#KEY_SPREADSHEET
 0x1a7

	)

523 
	#KEY_GRAPHICSEDITOR
 0x1a8

	)

524 
	#KEY_PRESENTATION
 0x1a9

	)

525 
	#KEY_DATABASE
 0x1¯

	)

526 
	#KEY_NEWS
 0x1ab

	)

527 
	#KEY_VOICEMAIL
 0x1aø

	)

528 
	#KEY_ADDRESSBOOK
 0x1ad

	)

529 
	#KEY_MESSENGER
 0x1«

	)

530 
	#KEY_DISPLAYTOGGLE
 0x1aà

	)

531 
	#KEY_SPELLCHECK
 0x1b0

	)

532 
	#KEY_LOGOFF
 0x1b1

	)

534 
	#KEY_DOLLAR
 0x1b2

	)

535 
	#KEY_EURO
 0x1b3

	)

537 
	#KEY_FRAMEBACK
 0x1b4

	)

538 
	#KEY_FRAMEFORWARD
 0x1b5

	)

539 
	#KEY_CONTEXT_MENU
 0x1b6

	)

540 
	#KEY_MEDIA_REPEAT
 0x1b7

	)

542 
	#KEY_DEL_EOL
 0x1c0

	)

543 
	#KEY_DEL_EOS
 0x1c1

	)

544 
	#KEY_INS_LINE
 0x1c2

	)

545 
	#KEY_DEL_LINE
 0x1c3

	)

547 
	#KEY_FN
 0x1d0

	)

548 
	#KEY_FN_ESC
 0x1d1

	)

549 
	#KEY_FN_F1
 0x1d2

	)

550 
	#KEY_FN_F2
 0x1d3

	)

551 
	#KEY_FN_F3
 0x1d4

	)

552 
	#KEY_FN_F4
 0x1d5

	)

553 
	#KEY_FN_F5
 0x1d6

	)

554 
	#KEY_FN_F6
 0x1d7

	)

555 
	#KEY_FN_F7
 0x1d8

	)

556 
	#KEY_FN_F8
 0x1d9

	)

557 
	#KEY_FN_F9
 0x1da

	)

558 
	#KEY_FN_F10
 0x1db

	)

559 
	#KEY_FN_F11
 0x1dc

	)

560 
	#KEY_FN_F12
 0x1dd

	)

561 
	#KEY_FN_1
 0x1de

	)

562 
	#KEY_FN_2
 0x1df

	)

563 
	#KEY_FN_D
 0x1e0

	)

564 
	#KEY_FN_E
 0x1e1

	)

565 
	#KEY_FN_F
 0x1e2

	)

566 
	#KEY_FN_S
 0x1e3

	)

567 
	#KEY_FN_B
 0x1e4

	)

569 
	#KEY_BRL_DOT1
 0x1f1

	)

570 
	#KEY_BRL_DOT2
 0x1f2

	)

571 
	#KEY_BRL_DOT3
 0x1f3

	)

572 
	#KEY_BRL_DOT4
 0x1f4

	)

573 
	#KEY_BRL_DOT5
 0x1f5

	)

574 
	#KEY_BRL_DOT6
 0x1f6

	)

575 
	#KEY_BRL_DOT7
 0x1f7

	)

576 
	#KEY_BRL_DOT8
 0x1f8

	)

577 
	#KEY_BRL_DOT9
 0x1f9

	)

578 
	#KEY_BRL_DOT10
 0x1ç

	)

581 
	#KEY_MIN_INTERESTING
 
KEY_MUTE


	)

582 
	#KEY_MAX
 0x1ff

	)

583 
	#KEY_CNT
 (
KEY_MAX
+1)

	)

589 
	#REL_X
 0x00

	)

590 
	#REL_Y
 0x01

	)

591 
	#REL_Z
 0x02

	)

592 
	#REL_RX
 0x03

	)

593 
	#REL_RY
 0x04

	)

594 
	#REL_RZ
 0x05

	)

595 
	#REL_HWHEEL
 0x06

	)

596 
	#REL_DIAL
 0x07

	)

597 
	#REL_WHEEL
 0x08

	)

598 
	#REL_MISC
 0x09

	)

599 
	#REL_MAX
 0x0f

	)

600 
	#REL_CNT
 (
REL_MAX
+1)

	)

606 
	#ABS_X
 0x00

	)

607 
	#ABS_Y
 0x01

	)

608 
	#ABS_Z
 0x02

	)

609 
	#ABS_RX
 0x03

	)

610 
	#ABS_RY
 0x04

	)

611 
	#ABS_RZ
 0x05

	)

612 
	#ABS_THROTTLE
 0x06

	)

613 
	#ABS_RUDDER
 0x07

	)

614 
	#ABS_WHEEL
 0x08

	)

615 
	#ABS_GAS
 0x09

	)

616 
	#ABS_BRAKE
 0x0a

	)

617 
	#ABS_HAT0X
 0x10

	)

618 
	#ABS_HAT0Y
 0x11

	)

619 
	#ABS_HAT1X
 0x12

	)

620 
	#ABS_HAT1Y
 0x13

	)

621 
	#ABS_HAT2X
 0x14

	)

622 
	#ABS_HAT2Y
 0x15

	)

623 
	#ABS_HAT3X
 0x16

	)

624 
	#ABS_HAT3Y
 0x17

	)

625 
	#ABS_PRESSURE
 0x18

	)

626 
	#ABS_DISTANCE
 0x19

	)

627 
	#ABS_TILT_X
 0x1a

	)

628 
	#ABS_TILT_Y
 0x1b

	)

629 
	#ABS_TOOL_WIDTH
 0x1c

	)

630 
	#ABS_VOLUME
 0x20

	)

631 
	#ABS_MISC
 0x28

	)

632 
	#ABS_MAX
 0x3f

	)

633 
	#ABS_CNT
 (
ABS_MAX
+1)

	)

639 
	#SW_LID
 0x00

	)

640 
	#SW_TABLET_MODE
 0x01

	)

641 
	#SW_HEADPHONE_INSERT
 0x02

	)

642 
	#SW_RFKILL_ALL
 0x03

	)

644 
	#SW_RADIO
 
SW_RFKILL_ALL


	)

645 
	#SW_MICROPHONE_INSERT
 0x04

	)

646 
	#SW_DOCK
 0x05

	)

647 
	#SW_LINEOUT_INSERT
 0x06

	)

648 
	#SW_JACK_PHYSICAL_INSERT
 0x07

	)

649 
	#SW_VIDEOOUT_INSERT
 0x08

	)

651 
	#SW_MAX
 0x0f

	)

652 
	#SW_CNT
 (
SW_MAX
+1)

	)

658 
	#MSC_SERIAL
 0x00

	)

659 
	#MSC_PULSELED
 0x01

	)

660 
	#MSC_GESTURE
 0x02

	)

661 
	#MSC_RAW
 0x03

	)

662 
	#MSC_SCAN
 0x04

	)

663 
	#MSC_MAX
 0x07

	)

664 
	#MSC_CNT
 (
MSC_MAX
+1)

	)

670 
	#LED_NUML
 0x00

	)

671 
	#LED_CAPSL
 0x01

	)

672 
	#LED_SCROLLL
 0x02

	)

673 
	#LED_COMPOSE
 0x03

	)

674 
	#LED_KANA
 0x04

	)

675 
	#LED_SLEEP
 0x05

	)

676 
	#LED_SUSPEND
 0x06

	)

677 
	#LED_MUTE
 0x07

	)

678 
	#LED_MISC
 0x08

	)

679 
	#LED_MAIL
 0x09

	)

680 
	#LED_CHARGING
 0x0a

	)

681 
	#LED_MAX
 0x0f

	)

682 
	#LED_CNT
 (
LED_MAX
+1)

	)

688 
	#REP_DELAY
 0x00

	)

689 
	#REP_PERIOD
 0x01

	)

690 
	#REP_MAX
 0x01

	)

696 
	#SND_CLICK
 0x00

	)

697 
	#SND_BELL
 0x01

	)

698 
	#SND_TONE
 0x02

	)

699 
	#SND_MAX
 0x07

	)

700 
	#SND_CNT
 (
SND_MAX
+1)

	)

706 
	#ID_BUS
 0

	)

707 
	#ID_VENDOR
 1

	)

708 
	#ID_PRODUCT
 2

	)

709 
	#ID_VERSION
 3

	)

711 
	#BUS_PCI
 0x01

	)

712 
	#BUS_ISAPNP
 0x02

	)

713 
	#BUS_USB
 0x03

	)

714 
	#BUS_HIL
 0x04

	)

715 
	#BUS_BLUETOOTH
 0x05

	)

716 
	#BUS_VIRTUAL
 0x06

	)

718 
	#BUS_ISA
 0x10

	)

719 
	#BUS_I8042
 0x11

	)

720 
	#BUS_XTKBD
 0x12

	)

721 
	#BUS_RS232
 0x13

	)

722 
	#BUS_GAMEPORT
 0x14

	)

723 
	#BUS_PARPORT
 0x15

	)

724 
	#BUS_AMIGA
 0x16

	)

725 
	#BUS_ADB
 0x17

	)

726 
	#BUS_I2C
 0x18

	)

727 
	#BUS_HOST
 0x19

	)

728 
	#BUS_GSC
 0x1A

	)

729 
	#BUS_ATARI
 0x1B

	)

734 
	#FF_STATUS_STOPPED
 0x00

	)

735 
	#FF_STATUS_PLAYING
 0x01

	)

736 
	#FF_STATUS_MAX
 0x01

	)

753 
	sff_»¶ay
 {

754 
__u16
 
	mËngth
;

755 
__u16
 
	md–ay
;

763 
	sff_Œigg”
 {

764 
__u16
 
	mbu‰Ú
;

765 
__u16
 
	mš‹rv®
;

780 
	sff_’v–İe
 {

781 
__u16
 
	m©ck_Ëngth
;

782 
__u16
 
	m©ck_Ëv–
;

783 
__u16
 
	mçde_Ëngth
;

784 
__u16
 
	mçde_Ëv–
;

792 
	sff_cÚ¡ªt_efãù
 {

793 
__s16
 
	mËv–
;

794 
ff_’v–İe
 
	m’v–İe
;

803 
	sff_¿mp_efãù
 {

804 
__s16
 
	m¡¬t_Ëv–
;

805 
__s16
 
	m’d_Ëv–
;

806 
ff_’v–İe
 
	m’v–İe
;

819 
	sff_cÚd™iÚ_efãù
 {

820 
__u16
 
	mright_§tu¿tiÚ
;

821 
__u16
 
	mËá_§tu¿tiÚ
;

823 
__s16
 
	mright_cÛff
;

824 
__s16
 
	mËá_cÛff
;

826 
__u16
 
	md—dbªd
;

827 
__s16
 
	mûÁ”
;

848 
	sff_³riodic_efãù
 {

849 
__u16
 
	mwavefÜm
;

850 
__u16
 
	m³riod
;

851 
__s16
 
	mmagn™ude
;

852 
__s16
 
	moff£t
;

853 
__u16
 
	mpha£
;

855 
ff_’v–İe
 
	m’v–İe
;

857 
__u32
 
	mcu¡om_Ën
;

858 
__s16
 *
	mcu¡om_d©a
;

869 
	sff_rumbË_efãù
 {

870 
__u16
 
	m¡rÚg_magn™ude
;

871 
__u16
 
	mw—k_magn™ude
;

897 
	sff_efãù
 {

898 
__u16
 
	mty³
;

899 
__s16
 
	mid
;

900 
__u16
 
	mdœeùiÚ
;

901 
ff_Œigg”
 
	mŒigg”
;

902 
ff_»¶ay
 
	m»¶ay
;

905 
ff_cÚ¡ªt_efãù
 
	mcÚ¡ªt
;

906 
ff_¿mp_efãù
 
	m¿mp
;

907 
ff_³riodic_efãù
 
	m³riodic
;

908 
ff_cÚd™iÚ_efãù
 
	mcÚd™iÚ
[2];

909 
ff_rumbË_efãù
 
	mrumbË
;

910 } 
	mu
;

917 
	#FF_RUMBLE
 0x50

	)

918 
	#FF_PERIODIC
 0x51

	)

919 
	#FF_CONSTANT
 0x52

	)

920 
	#FF_SPRING
 0x53

	)

921 
	#FF_FRICTION
 0x54

	)

922 
	#FF_DAMPER
 0x55

	)

923 
	#FF_INERTIA
 0x56

	)

924 
	#FF_RAMP
 0x57

	)

926 
	#FF_EFFECT_MIN
 
FF_RUMBLE


	)

927 
	#FF_EFFECT_MAX
 
FF_RAMP


	)

933 
	#FF_SQUARE
 0x58

	)

934 
	#FF_TRIANGLE
 0x59

	)

935 
	#FF_SINE
 0x5a

	)

936 
	#FF_SAW_UP
 0x5b

	)

937 
	#FF_SAW_DOWN
 0x5c

	)

938 
	#FF_CUSTOM
 0x5d

	)

940 
	#FF_WAVEFORM_MIN
 
FF_SQUARE


	)

941 
	#FF_WAVEFORM_MAX
 
FF_CUSTOM


	)

947 
	#FF_GAIN
 0x60

	)

948 
	#FF_AUTOCENTER
 0x61

	)

950 
	#FF_MAX
 0x7f

	)

951 
	#FF_CNT
 (
FF_MAX
+1)

	)

953 #ifdeà
__KERNEL__


959 
	~<lšux/deviû.h
>

960 
	~<lšux/fs.h
>

961 
	~<lšux/tim”.h
>

962 
	~<lšux/mod_deviûbË.h
>

1037 
	sšput_dev
 {

1038 cÚ¡ *
	mÇme
;

1039 cÚ¡ *
	mphys
;

1040 cÚ¡ *
	muniq
;

1041 
šput_id
 
	mid
;

1043 
	mevb™
[
BITS_TO_LONGS
(
EV_CNT
)];

1044 
	mkeyb™
[
BITS_TO_LONGS
(
KEY_CNT
)];

1045 
	m»lb™
[
BITS_TO_LONGS
(
REL_CNT
)];

1046 
	mabsb™
[
BITS_TO_LONGS
(
ABS_CNT
)];

1047 
	mmscb™
[
BITS_TO_LONGS
(
MSC_CNT
)];

1048 
	mËdb™
[
BITS_TO_LONGS
(
LED_CNT
)];

1049 
	m¢db™
[
BITS_TO_LONGS
(
SND_CNT
)];

1050 
	mffb™
[
BITS_TO_LONGS
(
FF_CNT
)];

1051 
	mswb™
[
BITS_TO_LONGS
(
SW_CNT
)];

1053 
	mkeycodemax
;

1054 
	mkeycodesize
;

1055 *
	mkeycode
;

1056 (*
	m£tkeycode
)(
šput_dev
 *
	mdev
, 
	msÿncode
, 
	mkeycode
);

1057 (*
	mg‘keycode
)(
šput_dev
 *
	mdev
, 
	msÿncode
, *
	mkeycode
);

1059 
ff_deviû
 *
	mff
;

1061 
	m»³©_key
;

1062 
tim”_li¡
 
	mtim”
;

1064 
	msync
;

1066 
	mabs
[
ABS_MAX
 + 1];

1067 
	m»p
[
REP_MAX
 + 1];

1069 
	mkey
[
BITS_TO_LONGS
(
KEY_CNT
)];

1070 
	mËd
[
BITS_TO_LONGS
(
LED_CNT
)];

1071 
	m¢d
[
BITS_TO_LONGS
(
SND_CNT
)];

1072 
	msw
[
BITS_TO_LONGS
(
SW_CNT
)];

1074 
	mabsmax
[
ABS_MAX
 + 1];

1075 
	mabsmš
[
ABS_MAX
 + 1];

1076 
	mabsfuzz
[
ABS_MAX
 + 1];

1077 
	mabsæ©
[
ABS_MAX
 + 1];

1079 (*
	mİ’
)(
šput_dev
 *
	mdev
);

1080 (*
	mşo£
)(
šput_dev
 *
	mdev
);

1081 (*
	mæush
)(
šput_dev
 *
	mdev
, 
fe
 *
	mfe
);

1082 (*
	mev’t
)(
šput_dev
 *
	mdev
, 
	mty³
, 
	mcode
, 
	mv®ue
);

1084 
šput_hªdË
 *
	mg¿b
;

1086 
¥šlock_t
 
	mev’t_lock
;

1087 
mu‹x
 
	mmu‹x
;

1089 
	mu£rs
;

1090 
	mgošg_away
;

1092 
deviû
 
	mdev
;

1094 
li¡_h—d
 
	mh_li¡
;

1095 
li¡_h—d
 
	mnode
;

1097 
	#to_šput_dev
(
d
è
	`cÚš”_of
(d, 
šput_dev
, 
dev
)

	)

1103 #ià
EV_MAX
 !ğ
INPUT_DEVICE_ID_EV_MAX


1107 #ià
KEY_MIN_INTERESTING
 !ğ
INPUT_DEVICE_ID_KEY_MIN_INTERESTING


1111 #ià
KEY_MAX
 !ğ
INPUT_DEVICE_ID_KEY_MAX


1115 #ià
REL_MAX
 !ğ
INPUT_DEVICE_ID_REL_MAX


1119 #ià
ABS_MAX
 !ğ
INPUT_DEVICE_ID_ABS_MAX


1123 #ià
MSC_MAX
 !ğ
INPUT_DEVICE_ID_MSC_MAX


1127 #ià
LED_MAX
 !ğ
INPUT_DEVICE_ID_LED_MAX


1131 #ià
SND_MAX
 !ğ
INPUT_DEVICE_ID_SND_MAX


1135 #ià
FF_MAX
 !ğ
INPUT_DEVICE_ID_FF_MAX


1139 #ià
SW_MAX
 !ğ
INPUT_DEVICE_ID_SW_MAX


1143 
	#INPUT_DEVICE_ID_MATCH_DEVICE
 \

1144 (
INPUT_DEVICE_ID_MATCH_BUS
 | 
INPUT_DEVICE_ID_MATCH_VENDOR
 | 
INPUT_DEVICE_ID_MATCH_PRODUCT
)

	)

1145 
	#INPUT_DEVICE_ID_MATCH_DEVICE_AND_VERSION
 \

1146 (
INPUT_DEVICE_ID_MATCH_DEVICE
 | 
INPUT_DEVICE_ID_MATCH_VERSION
)

	)

1148 
	gšput_hªdË
;

1180 
	sšput_hªdËr
 {

1182 *
	m´iv©e
;

1184 (*
	mev’t
)(
šput_hªdË
 *
	mhªdË
, 
	mty³
, 
	mcode
, 
	mv®ue
);

1185 (*
	mcÚÃù
)(
šput_hªdËr
 *
	mhªdËr
, 
šput_dev
 *
	mdev
, cÚ¡ 
šput_deviû_id
 *
	mid
);

1186 (*
	mdiscÚÃù
)(
šput_hªdË
 *
	mhªdË
);

1187 (*
	m¡¬t
)(
šput_hªdË
 *
	mhªdË
);

1189 cÚ¡ 
fe_İ”©iÚs
 *
	mfİs
;

1190 
	mmšÜ
;

1191 cÚ¡ *
	mÇme
;

1193 cÚ¡ 
šput_deviû_id
 *
	mid_bË
;

1194 cÚ¡ 
šput_deviû_id
 *
	mbÏckli¡
;

1196 
li¡_h—d
 
	mh_li¡
;

1197 
li¡_h—d
 
	mnode
;

1212 
	sšput_hªdË
 {

1214 *
	m´iv©e
;

1216 
	mİ’
;

1217 cÚ¡ *
	mÇme
;

1219 
šput_dev
 *
	mdev
;

1220 
šput_hªdËr
 *
	mhªdËr
;

1222 
li¡_h—d
 
	md_node
;

1223 
li¡_h—d
 
	mh_node
;

1226 
šput_dev
 *
šput_®loÿ‹_deviû
();

1227 
šput_ä“_deviû
(
šput_dev
 *
dev
);

1229 
šlše
 
šput_dev
 *
	$šput_g‘_deviû
(
šput_dev
 *
dev
)

1231  
dev
 ? 
	`to_šput_dev
(
	`g‘_deviû
(&dev->dev)è: 
NULL
;

1232 
	}
}

1234 
šlše
 
	$šput_put_deviû
(
šput_dev
 *
dev
)

1236 ià(
dev
)

1237 
	`put_deviû
(&
dev
->dev);

1238 
	}
}

1240 
šlše
 *
	$šput_g‘_drvd©a
(
šput_dev
 *
dev
)

1242  
	`dev_g‘_drvd©a
(&
dev
->dev);

1243 
	}
}

1245 
šlše
 
	$šput_£t_drvd©a
(
šput_dev
 *
dev
, *
d©a
)

1247 
	`dev_£t_drvd©a
(&
dev
->dev, 
d©a
);

1248 
	}
}

1250 
__mu¡_check
 
šput_»gi¡”_deviû
(
šput_dev
 *);

1251 
šput_uÄegi¡”_deviû
(
šput_dev
 *);

1253 
__mu¡_check
 
šput_»gi¡”_hªdËr
(
šput_hªdËr
 *);

1254 
šput_uÄegi¡”_hªdËr
(
šput_hªdËr
 *);

1256 
šput_»gi¡”_hªdË
(
šput_hªdË
 *);

1257 
šput_uÄegi¡”_hªdË
(
šput_hªdË
 *);

1259 
šput_g¿b_deviû
(
šput_hªdË
 *);

1260 
šput_»Ëa£_deviû
(
šput_hªdË
 *);

1262 
šput_İ’_deviû
(
šput_hªdË
 *);

1263 
šput_şo£_deviû
(
šput_hªdË
 *);

1265 
šput_æush_deviû
(
šput_hªdË
* 
hªdË
, 
fe
* file);

1267 
šput_ev’t
(
šput_dev
 *
dev
, 
ty³
, 
code
, 
v®ue
);

1268 
šput_šjeù_ev’t
(
šput_hªdË
 *
hªdË
, 
ty³
, 
code
, 
v®ue
);

1270 
šlše
 
	$šput_»pÜt_key
(
šput_dev
 *
dev
, 
code
, 
v®ue
)

1272 
	`šput_ev’t
(
dev
, 
EV_KEY
, 
code
, !!
v®ue
);

1273 
	}
}

1275 
šlše
 
	$šput_»pÜt_»l
(
šput_dev
 *
dev
, 
code
, 
v®ue
)

1277 
	`šput_ev’t
(
dev
, 
EV_REL
, 
code
, 
v®ue
);

1278 
	}
}

1280 
šlše
 
	$šput_»pÜt_abs
(
šput_dev
 *
dev
, 
code
, 
v®ue
)

1282 
	`šput_ev’t
(
dev
, 
EV_ABS
, 
code
, 
v®ue
);

1283 
	}
}

1285 
šlše
 
	$šput_»pÜt_ff_¡©us
(
šput_dev
 *
dev
, 
code
, 
v®ue
)

1287 
	`šput_ev’t
(
dev
, 
EV_FF_STATUS
, 
code
, 
v®ue
);

1288 
	}
}

1290 
šlše
 
	$šput_»pÜt_sw™ch
(
šput_dev
 *
dev
, 
code
, 
v®ue
)

1292 
	`šput_ev’t
(
dev
, 
EV_SW
, 
code
, !!
v®ue
);

1293 
	}
}

1295 
šlše
 
	$šput_sync
(
šput_dev
 *
dev
)

1297 
	`šput_ev’t
(
dev
, 
EV_SYN
, 
SYN_REPORT
, 0);

1298 
	}
}

1300 
šput_£t_ÿ·b™y
(
šput_dev
 *
dev
, 
ty³
, 
code
);

1302 
šlše
 
	$šput_£t_abs_·¿ms
(
šput_dev
 *
dev
, 
axis
, 
mš
, 
max
, 
fuzz
, 
æ©
)

1304 
dev
->
absmš
[
axis
] = 
mš
;

1305 
dev
->
absmax
[
axis
] = 
max
;

1306 
dev
->
absfuzz
[
axis
] = 
fuzz
;

1307 
dev
->
absæ©
[
axis
] = 
æ©
;

1309 
dev
->
absb™
[
	`BIT_WORD
(
axis
)] |ğ
	`BIT_MASK
(axis);

1310 
	}
}

1312 
šput_g‘_keycode
(
šput_dev
 *
dev
, 
sÿncode
, *
keycode
);

1313 
šput_£t_keycode
(
šput_dev
 *
dev
, 
sÿncode
, 
keycode
);

1315 
şass
 
šput_şass
;

1340 
	sff_deviû
 {

1341 (*
	mu¶ßd
)(
šput_dev
 *
	mdev
, 
ff_efãù
 *
	mefãù
,

1342 
ff_efãù
 *
	mŞd
);

1343 (*
	m”a£
)(
šput_dev
 *
	mdev
, 
	mefãù_id
);

1345 (*
	m¶ayback
)(
šput_dev
 *
	mdev
, 
	mefãù_id
, 
	mv®ue
);

1346 (*
	m£t_gaš
)(
šput_dev
 *
	mdev
, 
u16
 
	mgaš
);

1347 (*
	m£t_autoûÁ”
)(
šput_dev
 *
	mdev
, 
u16
 
	mmagn™ude
);

1349 (*
	mde¡roy
)(
	mff_deviû
 *);

1351 *
	m´iv©e
;

1353 
	mffb™
[
BITS_TO_LONGS
(
FF_CNT
)];

1355 
mu‹x
 
	mmu‹x
;

1357 
	mmax_efãùs
;

1358 
ff_efãù
 *
	mefãùs
;

1359 
fe
 *
	mefãù_owÃrs
[];

1362 
šput_ff_ü—‹
(
šput_dev
 *
dev
, 
max_efãùs
);

1363 
šput_ff_de¡roy
(
šput_dev
 *
dev
);

1365 
šput_ff_ev’t
(
šput_dev
 *
dev
, 
ty³
, 
code
, 
v®ue
);

1367 
šput_ff_u¶ßd
(
šput_dev
 *
dev
, 
ff_efãù
 *
efãù
, 
fe
 *file);

1368 
šput_ff_”a£
(
šput_dev
 *
dev
, 
efãù_id
, 
fe
 *file);

1370 
šput_ff_ü—‹_memËss
(
šput_dev
 *
dev
, *
d©a
,

1371 (*
¶ay_efãù
)(
šput_dev
 *, *, 
ff_efãù
 *));

	@hald/linux/osspec.c

28 #ifdeà
HAVE_CONFIG_H


29 
	~<cÚfig.h
>

32 
	#_GNU_SOURCE
 1

	)

33 
	#DMI_SYSFS_PATH
 "/sys/şass/dmi/id"

	)

35 
	~<ùy³.h
>

36 
	~<”ºo.h
>

37 
	~<lim™s.h
>

38 
	~<lšux/ty³s.h
>

39 
	~<Ãt/if_¬p.h
>

40 
	~<¡dšt.h
>

41 
	~<¡dlib.h
>

42 
	~<¡ršg.h
>

43 
	~<sys/¡©.h
>

44 
	~<sys/un.h
>

45 
	~<sys/ut¢ame.h
>

46 
	~<uni¡d.h
>

48 
	~<dbus/dbus.h
>

49 
	~<dbus/dbus-glib.h
>

51 
	~"../deviû_šfo.h
"

52 
	~"../h®d.h
"

53 
	~"../h®d_dbus.h
"

54 
	~"../h®d_ruÂ”.h
"

55 
	~"../logg”.h
"

56 
	~"../os¥ec.h
"

57 
	~"../ut.h
"

58 
	~"../ut_h–³r.h
"

59 
	~"../ids.h
"

61 
	~"aıi.h
"

62 
	~"­m.h
"

63 
	~"blockdev.h
"

64 
	~"cŞd¶ug.h
"

65 
	~"hÙ¶ug.h
"

66 
	~"pmu.h
"

68 
	~"os¥ec_lšux.h
"

70 
gboŞ—n
 
	gh®d_dÚe_syÁhesizšg_cŞd¶ug
 = 
FALSE
;

72 
gboŞ—n


73 
	$h®d_udev_d©a
 (
GIOChªÃl
 *
sourû
, 
GIOCÚd™iÚ
 
cÚd™iÚ
, 
gpoš‹r
 
u£r_d©a
)

75 
fd
;

76 
»tv®
;

77 
msghdr
 
smsg
;

78 
cmsghdr
 *
cmsg
;

79 
iovec
 
iov
;

80 
uüed
 *
üed
;

81 
üed_msg
[
	`CMSG_SPACE
((
uüed
))];

83 
buf
[4096];

84 
size_t
 
buåos
 = 0;

85 cÚ¡ *
aùiÚ
 = 
NULL
;

86 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

88 
	`mem£t
(
buf
, 0x00,  (buf));

90 
fd
 = 
	`g_io_chªÃl_unix_g‘_fd
 (
sourû
);

92 
iov
.
iov_ba£
 = &
buf
;

93 
iov
.
iov_Ën
 =  (
buf
);

95 
	`mem£t
(&
smsg
, 0x00,  (
msghdr
));

96 
smsg
.
msg_iov
 = &
iov
;

97 
smsg
.
msg_iovËn
 = 1;

98 
smsg
.
msg_cÚŒŞ
 = 
üed_msg
;

99 
smsg
.
msg_cÚŒŞËn
 =  (
üed_msg
);

101 
»tv®
 = 
	`»cvmsg
 (
fd
, &
smsg
, 0);

102 ià(
»tv®
 < 0) {

103 ià(
”ºo
 !ğ
EINTR
)

104 
	`HAL_INFO
 (("UÇbËØ»ûivmes§ge,ƒ¼no=%d", 
”ºo
));

105 
out
;

107 
cmsg
 = 
	`CMSG_FIRSTHDR
 (&
smsg
);

108 
üed
 = (
uüed
 *è
	`CMSG_DATA
 (
cmsg
);

110 ià(
cmsg
 =ğ
NULL
 || cmsg->
cmsg_ty³
 !ğ
SCM_CREDENTIALS
) {

111 
	`HAL_INFO
 (("No sender credentials„eceived, message ignored"));

112 
out
;

115 ià(
üed
->
uid
 != 0) {

116 
	`HAL_INFO
 (("S’d” uid=%i, mes§gignÜed", 
üed
->
uid
));

117 
out
;

120 ià(!
	`¡r¡r
(
buf
, "@/")) {

121 
	`HAL_INFO
 (("invalid message format"));

122 
out
;

125 
hÙ¶ug_ev’t
 = 
	`g_¦iû_Ãw0
 (
HÙ¶ugEv’t
);

126 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_SYSFS
;

128 
buåos
 <  (
buf
)) {

129 
size_t
 
keyËn
;

130 *
key
;

131 *
¡r
;

133 
key
 = &
buf
[
buåos
];

134 
keyËn
 = 
	`¡¾’
(
key
);

135 ià(
keyËn
 == 0)

137 
buåos
 +ğ
keyËn
 + 1;

139 ià(
	`¡ºcmp
(
key
, "ACTION=", 7) == 0)

140 
aùiÚ
 = &
key
[7];

141 ià(
	`¡ºcmp
(
key
, "DEVPATH=", 8) == 0) {

144 ià(
	`g_¡r_has_´efix
 (
key
 + 8, "/block/md")) {

145 
	`HAL_INFO
 (("skpšg mdƒv’ˆfÜ %s", 
key
 + 8));

146 
šv®id
;

149 
	`g_¢´štf
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
,  (hotplug_event->sysfs.sysfs_path),

150 "/sys%s", &
key
[8]);

151 } ià(
	`¡ºcmp
(
key
, "DEVPATH_OLD=", 12) == 0) {

154 ià(
	`g_¡r_has_´efix
 (
key
 + 12, "/block/md")) {

155 
	`HAL_INFO
 (("skpšg mdƒv’ˆfÜ %s", 
key
 + 8));

156 
šv®id
;

159 
	`g_¢´štf
 (
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th_Şd
,  (hotplug_event->sysfs.sysfs_path_old),

160 "/sys%s", &
key
[12]);

161 } ià(
	`¡ºcmp
(
key
, "SUBSYSTEM=", 10) == 0)

162 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, &
key
[10],  (hotplug_event->sysfs.subsystem));

163 ià(
	`¡ºcmp
(
key
, "DEVNAME=", 8) == 0)

164 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, &
key
[8],  (hotplug_event->sysfs.device_file));

165 ià(
	`¡ºcmp
(
key
, "SEQNUM=", 7) == 0)

166 
hÙ¶ug_ev’t
->
sysfs
.
£qnum
 = 
	`¡¹ouÎ
(&
key
[7], 
NULL
, 10);

167 ià(
	`¡ºcmp
(
key
, "IFINDEX=", 8) == 0)

168 
hÙ¶ug_ev’t
->
sysfs
.
Ãt_ifšdex
 = 
	`¡¹oul
(&
key
[8], 
NULL
, 10);

169 ià(
	`¡ºcmp
(
key
, "ID_VENDOR=", 10) == 0) {

170 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(&
key
[10])è!ğ
NULL
 ) {

171 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
v’dÜ
, 
¡r
, (hotplug_event->sysfs.vendor));

172 
	`g_ä“
 (
¡r
);

174 } ià(
	`¡ºcmp
(
key
, "ID_MODEL=", 9) == 0) {

175 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(&
key
[9])è!ğ
NULL
 ) {

176 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
mod–
, 
¡r
, (hotplug_event->sysfs.model));

177 
	`g_ä“
 (
¡r
);

179 } ià(
	`¡ºcmp
(
key
, "ID_REVISION=", 12) == 0) {

180 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(&
key
[12])è!ğ
NULL
 ) {

181 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
»visiÚ
, 
¡r
, (hotplug_event->sysfs.revision));

182 
	`g_ä“
 (
¡r
);

184 } ià(
	`¡ºcmp
(
key
, "ID_SERIAL=", 10) == 0) {

185 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(&
key
[10])è!ğ
NULL
 ) {

186 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
£rŸl
, 
¡r
, (hotplug_event->sysfs.serial));

187 
	`g_ä“
 (
¡r
);

189 } ià(
	`¡ºcmp
(
key
, "ID_FS_USAGE=", 12) == 0) {

190 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(&
key
[12])è!ğ
NULL
 ) {

191 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
fsu§ge
, 
¡r
, (hotplug_event->sysfs.fsusage));

192 
	`g_ä“
 (
¡r
);

194 } ià(
	`¡ºcmp
(
key
, "ID_FS_TYPE=", 11) == 0) {

195 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(&
key
[11])è!ğ
NULL
 ) {

196 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
f¡y³
, 
¡r
, (hotplug_event->sysfs.fstype));

197 
	`g_ä“
 (
¡r
);

199 } ià(
	`¡ºcmp
(
key
, "ID_FS_VERSION=", 14) == 0) {

200 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(&
key
[14])è!ğ
NULL
 ) {

201 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
fsv”siÚ
, 
¡r
, (hotplug_event->sysfs.fsversion));

202 
	`g_ä“
 (
¡r
);

204 } ià(
	`¡ºcmp
(
key
, "ID_FS_UUID=", 11) == 0) {

205 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(&
key
[11])è!ğ
NULL
 ) {

206 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
fsuuid
, 
¡r
, (hotplug_event->sysfs.fsuuid));

207 
	`g_ä“
 (
¡r
);

209 } ià(
	`¡ºcmp
(
key
, "ID_FS_LABEL=", 12) == 0) {

210 ià((
¡r
 = 
	`h®_ut_¡rdup_v®id_utf8
(&
key
[12])è!ğ
NULL
 ) {

211 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
sysfs
.
f¦ab–
, 
¡r
, (hotplug_event->sysfs.fslabel));

212 
	`g_ä“
 (
¡r
);

217 ià(!
aùiÚ
) {

218 
	`HAL_INFO
 (("missing ACTION"));

219 
šv®id
;

221 ià(
hÙ¶ug_ev’t
->
sysfs
.
sysfs_·th
[0] == '\0') {

222 
	`HAL_INFO
 (("missing DEVPATH"));

223 
šv®id
;

225 ià(
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
[0] == '\0') {

226 
	`HAL_INFO
 (("missing SUSBSYSTEM"));

227 
šv®id
;

235 ià(
	`¡ºcmp
 (
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, "/dev/mapper/temporary-cryptsetup-", 33) == 0) {

236 
	`HAL_INFO
 (("Temporary workaround: ignoringemporary cryptsetup file"));

237 
šv®id
;

239 ià(
	`¡r¡r
 (
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, "/dm-"è!ğ
NULL
) {

240 
	`HAL_DEBUG
 (("Found‡ dm-deviû (%s), m¬k it", 
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
));

241 
hÙ¶ug_ev’t
->
sysfs
.
is_dm_deviû
 = 
TRUE
;

245 
	`HAL_INFO
 (("SEQNUM=%lld, ACTION=%s, SUBSYSTEM=%s, DEVPATH=%s, DEVNAME=%s, IFINDEX=%d",

246 
hÙ¶ug_ev’t
->
sysfs
.
£qnum
, 
aùiÚ
, hÙ¶ug_ev’t->sysfs.
subsy¡em
, hÙ¶ug_ev’t->sysfs.
sysfs_·th
,

247 
hÙ¶ug_ev’t
->
sysfs
.
deviû_fe
, hÙ¶ug_ev’t->sysfs.
Ãt_ifšdex
));

250 ià((
	`¡rcmp
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, "drivers") != 0) &&

251 (
	`¡rcmp
 (
hÙ¶ug_ev’t
->
sysfs
.
subsy¡em
, "module") != 0)) {

252 ià(
	`¡rcmp
 (
aùiÚ
, "add") == 0) {

253 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

254 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

255 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

256 
out
;

259 ià(
	`¡rcmp
 (
aùiÚ
, "change") == 0) {

260 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_CHANGE
;

261 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

262 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

263 
out
;

266 ià(
	`¡rcmp
 (
aùiÚ
, "move") == 0) {

267 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_MOVE
;

268 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

269 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

270 
out
;

273 ià(
	`¡rcmp
 (
aùiÚ
, "remove") == 0) {

274 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_REMOVE
;

275 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

276 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

277 
out
;

281 
šv®id
:

282 
	`g_¦iû_ä“
 (
HÙ¶ugEv’t
, 
hÙ¶ug_ev’t
);

284 
out
:

285  
TRUE
;

286 
	}
}

288 
gboŞ—n


289 
	$mouÁ_Œ“_chªged_ev’t
 (
GIOChªÃl
 *
chªÃl
, 
GIOCÚd™iÚ
 
cÚd
, 
gpoš‹r
 
u£r_d©a
)

291 ià(
cÚd
 & ~
G_IO_ERR
)

292  
TRUE
;

294 
	`HAL_INFO
 (("/proc/mountsells,hathe mount hasree changed"));

295 
	`blockdev_»äesh_mouÁ_¡©e
 (
NULL
);

297  
TRUE
;

298 
	}
}

300 
gboŞ—n


301 
	$md¡©_chªged_ev’t
 (
GIOChªÃl
 *
chªÃl
, 
GIOCÚd™iÚ
 
cÚd
, 
gpoš‹r
 
u£r_d©a
)

303 ià(
cÚd
 & ~
G_IO_PRI
)

304  
TRUE
;

306 
	`HAL_INFO
 (("/proc/mdstat changed"));

308 
	`blockdev_´oûss_md¡©
 ();

310  
TRUE
;

311 
	}
}

313 
H®FeMÚ™Ü
 *
	gfe_mÚ™Ü
 = 
NULL
;

315 
H®FeMÚ™Ü
 *

316 
	$os¥ec_g‘_fe_mÚ™Ü
 ()

318  
fe_mÚ™Ü
;

319 
	}
}

321 
GIOChªÃl
 *
	gmd¡©_chªÃl
 = 
NULL
;

323 
GIOChªÃl
 *
	$g‘_md¡©_chªÃl
 ()

325  
md¡©_chªÃl
;

326 
	}
}

328 #ifdeà
USE_DMI


334 
	$os¥ec_´iveged_š™_´•¬£_£t_dmi
 (
gboŞ—n
 
£t
, 
H®Deviû
 *
d
)

336 
gch¬
 *
buf
;

337 *
´oduù_£rŸl
;

338 *
´oduù_uuid
;

339 *
bßrd_£rŸl
;

340 
gboŞ—n
 
·r£d
 = 
FALSE
;

342 ià(
	`g_fe_‹¡
 (
DMI_SYSFS_PATH
, (
G_FILE_TEST_EXISTS
 | 
G_FILE_TEST_IS_DIR
))) {

344 ià(!
£t
){

345 ià((
buf
 = 
	`h®_ut_g‘_¡ršg_äom_fe
(
DMI_SYSFS_PATH
, "´oduù_£rŸl")è!ğ
NULL
)

346 
´oduù_£rŸl
 = 
	`g_¡rdup
 ( 
buf
 );

347 ià((
buf
 = 
	`h®_ut_g‘_¡ršg_äom_fe
(
DMI_SYSFS_PATH
, "´oduù_uuid")è!ğ
NULL
)

348 
´oduù_uuid
 = 
	`g_¡rdup
 ( 
buf
 );

349 ià((
buf
 = 
	`h®_ut_g‘_¡ršg_äom_fe
(
DMI_SYSFS_PATH
, "bßrd_£rŸl")è!ğ
NULL
)

350 
bßrd_£rŸl
 = 
	`g_¡rdup
 ( 
buf
 );

352 
·r£d
 = 
TRUE
;

354 ià(
d
 !ğ
NULL
 && 
·r£d
) {

355 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sy¡em.h¬dw¬e.£rŸl", 
´oduù_£rŸl
);

356 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sy¡em.h¬dw¬e.uuid", 
´oduù_uuid
);

357 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sy¡em.bßrd.£rŸl", 
bßrd_£rŸl
);

358 
	`g_ä“
 (
´oduù_£rŸl
);

359 
	`g_ä“
 (
´oduù_uuid
);

360 
·r£d
 = 
FALSE
;

364 
	}
}

367 
	$os¥ec_´iveged_š™_´•¬£_£t_dmi
 (
gboŞ—n
 
£t
, 
H®Deviû
 *
d
)

369 
	}
}

373 
	$os¥ec_´iveged_š™
 ()

375 
GE¼Ü
 *
”r
 = 
NULL
;

377 
fe_mÚ™Ü
 = 
	`h®_fe_mÚ™Ü_Ãw
 ();

378 ià(
fe_mÚ™Ü
 =ğ
NULL
) {

379 
	`DIE
 (("Cannot initialize file monitor"));

385 
md¡©_chªÃl
 = 
	`g_io_chªÃl_Ãw_fe
 ("/´oc/md¡©", "r", &
”r
);

386 ià(
md¡©_chªÃl
 !ğ
NULL
) {

387 
	`g_io_add_w©ch
 (
md¡©_chªÃl
, 
G_IO_PRI
, 
md¡©_chªged_ev’t
, 
NULL
);

389 ià(
”r
 !ğ
NULL
)

390 
	`HAL_WARNING
 (("UÇbËØİ’ /´oc/md¡©: %s", 
”r
->
mes§ge
));

393 ià(!
	`g_”rÜ_m©ches
 (
”r
, 
G_FILE_ERROR
, 
G_FILE_ERROR_NOENT
))

394 
	`DIE
 (("Unableo„ead /proc/mdstat"));

397 ià(
”r
 !ğ
NULL
)

398 
	`g_”rÜ_ä“
 (
”r
);

400 
	`os¥ec_´iveged_š™_´•¬£_£t_dmi
(
FALSE
, 
NULL
);

401 
	}
}

404 
	$os¥ec_š™
 ()

406 
udev_sock‘
;

407 
sockaddr_un
 
§ddr
;

408 
sockËn_t
 
add¾’
;

409 cÚ¡ 
Ú
 = 1;

410 
GIOChªÃl
 *
udev_chªÃl
;

411 
GIOChªÃl
 *
mouÁs_chªÃl
;

417 
	`h®_deviû_¡Üe_šdex_´İ”ty
 (
	`h®d_g‘_gdl
 (), "linux.sysfs_path");

419 
	`mem£t
(&
§ddr
, 0x00, (saddr));

420 
§ddr
.
sun_çmy
 = 
AF_LOCAL
;

422 
	`¡rıy
(&
§ddr
.
sun_·th
[1], "/org/freedesktop/hal/udev_event");

423 
add¾’
 = 
	`off£tof
(
sockaddr_un
, 
sun_·th
è+ 
	`¡¾’
(
§ddr
.sun_path+1) + 1;

425 
udev_sock‘
 = 
	`sock‘
(
AF_LOCAL
, 
SOCK_DGRAM
, 0);

426 ià(
udev_sock‘
 == -1) {

427 
	`DIE
 (("Couldn't open socket"));

430 ià(
	`bšd
(
udev_sock‘
, (
sockaddr
 *è&
§ddr
, 
add¾’
) < 0) {

431 
	`årštf
 (
¡d”r
, "E¼Ü bšdšg udev_ev’ˆsock‘: %s\n", 
	`¡»¼Ü
(
”ºo
));

432 
	`ex™
 (1);

435 
	`£tsockİt
(
udev_sock‘
, 
SOL_SOCKET
, 
SO_PASSCRED
, &
Ú
, (on));

437 
udev_chªÃl
 = 
	`g_io_chªÃl_unix_Ãw
 (
udev_sock‘
);

438 
	`g_io_add_w©ch
 (
udev_chªÃl
, 
G_IO_IN
, 
h®d_udev_d©a
, 
NULL
);

439 
	`g_io_chªÃl_uÄef
 (
udev_chªÃl
);

444 
mouÁs_chªÃl
 = 
	`g_io_chªÃl_Ãw_fe
 ("/´oc/mouÁs", "r", 
NULL
);

445 ià(
mouÁs_chªÃl
 =ğ
NULL
)

446 
	`DIE
 (("Unableo„ead /proc/mounts"));

447 
	`g_io_add_w©ch
 (
mouÁs_chªÃl
, 
G_IO_ERR
, 
mouÁ_Œ“_chªged_ev’t
, 
NULL
);

452 
	`ids_š™
 ();

457 
	}
}

461 
	$compu‹r_ÿÎouts_add_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

463 
	`HAL_INFO
 (("Add c®lout com¶‘ed udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

466 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

467 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

468 
	}
}

471 
	$hÙ¶ug_queue_now_em±y
 ()

473 ià(
h®d_is_š™Ÿlisšg
 && 
h®d_dÚe_syÁhesizšg_cŞd¶ug
) {

474 
	`os¥ec_´obe_dÚe
 ();

476 
	}
}

480 
	$compu‹r_´obšg_h–³r_dÚe
 (
H®Deviû
 *
d
)

483 ià(!
	`h®_deviû_has_´İ”ty
 (
d
, "system.formfactor") ||

484 (
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "system.formfactor"), "laptop") != 0)) {

485 
	`HAL_INFO
 (("Check ifhe machine is may‡†aptop ..."));

486 
	`aıi_check_is_Ï±İ
("BATTERY");

487 
	`aıi_check_is_Ï±İ
("LID");

490 ià(!
	`h®_deviû_has_´İ”ty
 (
d
, "system.formfactor")) {

491 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "system.formfactor", "unknown");

495 
	`HAL_INFO
 (("Synthesizing sysfsƒvents..."));

496 
	`cŞd¶ug_syÁhesize_ev’ts
 ();

498 
	`HAL_INFO
 (("Synthesizing…owermgmtƒvents..."));

499 ià(
	`aıi_syÁhesize_hÙ¶ug_ev’ts
 ()) {

500 
	`HAL_INFO
 (("ACPI capabilities found"));

501 } ià(
	`pmu_syÁhesize_hÙ¶ug_ev’ts
 ()) {

502 
	`HAL_INFO
 (("PMU capabilities found"));

503 } ià(
	`­m_syÁhesize_hÙ¶ug_ev’ts
 ()) {

504 
	`HAL_INFO
 (("APM capabilities found"));

506 
	`HAL_INFO
 (("No…owermgmt capabilities"));

508 
	`HAL_INFO
 (("Done synthesizingƒvents"));

510 
h®d_dÚe_syÁhesizšg_cŞd¶ug
 = 
TRUE
;

515 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_INFORMATION
);

516 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_POLICY
);

518 
	`h®_ut_ÿÎout_deviû_add
 (
d
, 
compu‹r_ÿÎouts_add_dÚe
, 
NULL
, NULL);

519 
	}
}

521 #ifdeà
USE_DMI


523 
	$compu‹r_dmi_m­
 (
H®Deviû
 *
d
, 
gboŞ—n
 
dmidecode
)

533 cÚ¡ *
chassis_m­
[] = {

563 
NULL


567 ià(
dmidecode
) {

569 
i
;

570 cÚ¡ *
chassis_ty³
;

573 ià((
chassis_ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "sy¡em.chassis.ty³")è!ğ
NULL
) {

575 
i
 = 0; 
chassis_m­
[i] !ğ
NULL
; i += 2) {

576 ià(
	`¡rcmp
 (
chassis_m­
[
i
], 
chassis_ty³
) == 0) {

577 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sy¡em.fÜmçùÜ", 
chassis_m­
[
i
+1]);

583 
gšt
 
chassis_ty³
;

587 ià(
	`h®_ut_g‘_št_äom_fe
(
DMI_SYSFS_PATH
, "chassis_ty³", &
chassis_ty³
, 10)) {

589 ià((
chassis_ty³
 > 0è&& (chassis_ty³ < 28è&& (
chassis_m­
[(chassis_ty³-1)*2] !ğ
NULL
)) {

590 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sy¡em.chassis.ty³", 
chassis_m­
[((
chassis_ty³
-1)*2)]);

591 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sy¡em.fÜmçùÜ", 
chassis_m­
[((
chassis_ty³
-1)*2)+1]);

595 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "system.chassis.type", "Unknown");

596 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "system.formfactor", "unknown");

600 
	}
}

603 
	$compu‹r_dmi_m­
 (
H®Deviû
 *
d
, 
gboŞ—n
 
dmidecode
)

605 
	}
}

609 
	$compu‹r_´obšg_pcbios_h–³r_dÚe
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
,

610 
gšt
 
»tuº_code
, 
gch¬
 **
”rÜ
,

611 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

613 cÚ¡ *
sy¡em_mªuçùu»r
;

614 cÚ¡ *
sy¡em_´oduù
;

615 cÚ¡ *
sy¡em_v”siÚ
;

617 ià(
ex™_ty³
 =ğ
HALD_RUN_FAILED
) {

618 
out
;

621 ià((
sy¡em_mªuçùu»r
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "sy¡em.h¬dw¬e.v’dÜ")è!ğ
NULL
 &&

622 (
sy¡em_´oduù
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "sy¡em.h¬dw¬e.´oduù")è!ğ
NULL
 &&

623 (
sy¡em_v”siÚ
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "sy¡em.h¬dw¬e.v”siÚ")è!ğ
NULL
) {

624 
buf
[128];

626 ià(
	`¡rcmp
(
sy¡em_v”siÚ
, "Not Specified" ) != 0 ) {

627 
	`g_¢´štf
 (
buf
,  (buf), "% %s", 
sy¡em_´oduù
, 
sy¡em_v”siÚ
);

628 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sy¡em.´oduù", 
buf
);

630 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sy¡em.´oduù", 
sy¡em_´oduù
);

635 ià(!
	`h®_deviû_has_´İ”ty
 (
d
, "system.formfactor")) {

636 
	`compu‹r_dmi_m­
 (
d
, 
TRUE
);

638 
out
:

639 
	`compu‹r_´obšg_h–³r_dÚe
 (
d
);

640 
	}
}

643 
	$£t_su¥’d_hib”Ç‹_keys
 (
H®Deviû
 *
d
)

645 
gboŞ—n
 
ÿn_su¥’d
;

646 
gboŞ—n
 
ÿn_hib”Ç‹
;

647 *
pow”İtiÚs
;

648 cÚ¡ *
pmty³
;

650 
ÿn_su¥’d
 = 
FALSE
;

651 
ÿn_hib”Ç‹
 = 
FALSE
;

654 
pow”İtiÚs
 = 
	`h®_ut_g‘_¡ršg_äom_fe
("/sys/power/", "state");

655 ià(
pow”İtiÚs
 =ğ
NULL
) {

656 
	`HAL_WARNING
 (("Contents of /sys/power/state invalid"));

657 
out
;

659 ià(
	`¡r¡r
 (
pow”İtiÚs
, "mem"))

660 
ÿn_su¥’d
 = 
TRUE
;

661 ià(
	`¡r¡r
 (
pow”İtiÚs
, "disk"))

662 
ÿn_hib”Ç‹
 = 
TRUE
;

664 ià(!
ÿn_su¥’d
) {

665 
pmty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "power_management.type");

666 ià(
pmty³
 !ğ
NULL
 && 
	`¡rcmp
(pmtype, "pmu") == 0) {

668 
ÿn_su¥’d
 = 
TRUE
;

672 ià(!
ÿn_hib”Ç‹
) {

674 ià(
	`acûss
 ("/´oc/soáw¬e_su¥’d", 
F_OK
) == 0) {

675 
ÿn_hib”Ç‹
 = 
TRUE
;

676 } ià(
	`acûss
 ("/´oc/su¥’d2", 
F_OK
) == 0) {

677 
ÿn_hib”Ç‹
 = 
TRUE
;

678 } ià(
	`acûss
 ("/sys/pow”/su¥’d2/v”siÚ", 
F_OK
) == 0) {

679 
ÿn_hib”Ç‹
 = 
TRUE
;

682 
out
:

683 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "pow”_mªagem’t.ÿn_su¥’d", 
ÿn_su¥’d
);

684 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "pow”_mªagem’t.ÿn_su¥’d_hybrid", 
FALSE
);

685 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "pow”_mªagem’t.ÿn_hib”Ç‹", 
ÿn_hib”Ç‹
);

686 
	}
}

688 #ifdeà
USE_OPENFIRMWARE


690 
	$g‘_İ’fœmw¬e_’Œy
(
H®Deviû
 *
d
, *
´İ”ty
, *
’Œy
,

691 
gboŞ—n
 
muÉiv®ue
)

693 *
cÚ‹Ás
;

694 
gsize
 
Ëngth
;

695 ià(!
	`g_fe_g‘_cÚ‹Ás
(
’Œy
, &
cÚ‹Ás
, &
Ëngth
, 
NULL
)) {

698 ià(
muÉiv®ue
) {

699 
gsize
 
off£t
 = 0;

700 
off£t
 < 
Ëngth
) {

701 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
(
d
, 
´İ”ty
, 
cÚ‹Ás
 + 
off£t
, 
FALSE
);

702 ; 
off£t
 < 
Ëngth
 - 1 && 
cÚ‹Ás
[offset] != '\0'; offset++)

704 
off£t
++;

707 
	`h®_deviû_´İ”ty_£t_¡ršg
(
d
, 
´İ”ty
, 
cÚ‹Ás
);

709 
	`ä“
(
cÚ‹Ás
);

710 
	}
}

713 
	$d‘eù_İ’fœmw¬e_fÜmçùÜ
(
H®Deviû
 *
roÙ
)

715 
x
;

716 ¡ruù { 
gch¬
 *
mod–
; gch¬ *
fÜmçùÜ
; } 
mod–_fÜmçùÜ
[] =

726 {
NULL
, NULL }

728 cÚ¡ 
gch¬
 *
mod–
 =

729 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
roÙ
, "openfirmware.model");

730 ià(
mod–
 =ğ
NULL
)

732 
x
 = 0 ; 
mod–_fÜmçùÜ
[x].
mod–
 ; x++) {

733 ià(
	`¡r¡r
(
mod–
, 
mod–_fÜmçùÜ
[
x
].model)) {

734 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
roÙ
, "system.formfactor",

735 
mod–_fÜmçùÜ
[
x
].
fÜmçùÜ
);

739 
	}
}

741 
gboŞ—n


742 
	$decode_dmi_äom_İ’fœmw¬e
 (
H®Deviû
 *
roÙ
)

744 
	#DEVICE_TREE
 "/´oc/deviû-Œ“/"

	)

745 ià(!
	`g_fe_‹¡
(
DEVICE_TREE
, 
G_FILE_TEST_IS_DIR
))

746  
FALSE
;

748 
	`g‘_İ’fœmw¬e_’Œy
(
roÙ
, "openfirmware.model",

749 
DEVICE_TREE
 "mod–", 
FALSE
);

750 
	`g‘_İ’fœmw¬e_’Œy
(
roÙ
, "openfirmware.compatible",

751 
DEVICE_TREE
 "com·tibË", 
TRUE
);

752 
	`d‘eù_İ’fœmw¬e_fÜmçùÜ
(
roÙ
);

753  
TRUE
;

754 
	}
}

757 
	$´obe_İ’fœmw¬e
(
H®Deviû
 *
roÙ
)

759 
	}
}

762 #ifdeà
USE_DMI


763 
gboŞ—n


764 
	$decode_dmi_äom_sysfs
 (
H®Deviû
 *
d
)

766 ià(!
	`g_fe_‹¡
 (
DMI_SYSFS_PATH
, (
G_FILE_TEST_EXISTS
 | 
G_FILE_TEST_IS_DIR
)))

767  
FALSE
;

769 
	`os¥ec_´iveged_š™_´•¬£_£t_dmi
(
TRUE
, 
d
);

770 
	`h®_ut_£t_¡ršg_äom_fe
(
d
, "sy¡em.fœmw¬e.v’dÜ", 
DMI_SYSFS_PATH
, "bios_vendor");

771 
	`h®_ut_£t_¡ršg_äom_fe
(
d
, "sy¡em.fœmw¬e.v”siÚ", 
DMI_SYSFS_PATH
, "bios_version");

772 
	`h®_ut_£t_¡ršg_äom_fe
(
d
, "sy¡em.fœmw¬e.»Ëa£_d©e", 
DMI_SYSFS_PATH
, "bios_date");

773 
	`h®_ut_£t_¡ršg_äom_fe
(
d
, "sy¡em.h¬dw¬e.v’dÜ", 
DMI_SYSFS_PATH
, "sys_vendor");

774 
	`h®_ut_£t_¡ršg_äom_fe
(
d
, "sy¡em.h¬dw¬e.´oduù", 
DMI_SYSFS_PATH
, "product_name");

775 
	`h®_ut_£t_¡ršg_äom_fe
(
d
, "sy¡em.h¬dw¬e.v”siÚ", 
DMI_SYSFS_PATH
, "product_version");

776 
	`h®_ut_£t_¡ršg_äom_fe
(
d
, "sy¡em.chassis.mªuçùu»r", 
DMI_SYSFS_PATH
, "chassis_vendor");

777 
	`h®_ut_£t_¡ršg_äom_fe
(
d
, "sy¡em.bßrd.´oduù", 
DMI_SYSFS_PATH
, "board_name");

778 
	`h®_ut_£t_¡ršg_äom_fe
(
d
, "sy¡em.bßrd.v”siÚ", 
DMI_SYSFS_PATH
, "board_version");

779 
	`h®_ut_£t_¡ršg_äom_fe
(
d
, "sy¡em.bßrd.v’dÜ", 
DMI_SYSFS_PATH
, "board_vendor");

780 
	`compu‹r_dmi_m­
 (
d
, 
FALSE
);

782  
TRUE
;

783 
	}
}

786 
	$decode_dmi
 (
H®Deviû
 *
d
)

789 ià(
	`decode_dmi_äom_sysfs
(
d
) ||

790 
	`decode_dmi_äom_İ’fœmw¬e
 (
d
)) {

791 
	`HAL_INFO
 (("got DMI from files"));

792 
	`compu‹r_´obšg_h–³r_dÚe
 (
d
);

794 ià(
	`g_fe_‹¡
 ("/u¤/sbš/dmidecode", 
G_FILE_TEST_IS_EXECUTABLE
) ||

795 
	`g_fe_‹¡
 ("/bš/dmidecode", 
G_FILE_TEST_IS_EXECUTABLE
) ||

796 
	`g_fe_‹¡
 ("/sbš/dmidecode", 
G_FILE_TEST_IS_EXECUTABLE
) ||

797 
	`g_fe_‹¡
 ("/u¤/loÿl/sbš/dmidecode", 
G_FILE_TEST_IS_EXECUTABLE
)) {

798 
	`HAL_INFO
 (("getting DMI from…rober"));

799 
	`h®d_ruÂ”_run
 (
d
, "h®d-´obe-smbios", 
NULL
, 
HAL_HELPER_TIMEOUT
,

800 
compu‹r_´obšg_pcbios_h–³r_dÚe
, 
NULL
, NULL);

803 
	`HAL_INFO
 (("failedo…robe DMI"));

804 
	`compu‹r_´obšg_h–³r_dÚe
 (
d
);

807 
	}
}

810 
	$decode_dmi
 (
H®Deviû
 *
d
)

812 
	`´obe_İ’fœmw¬e
 (
d
);

813 
	`compu‹r_´obšg_h–³r_dÚe
 (
d
);

814 
	}
}

818 
	$compu‹r_´obšg_pm_is_suµÜ‹d_h–³r_dÚe
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
,

819 
gšt
 
»tuº_code
, 
gch¬
 **
”rÜ
,

820 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

822 
	`HAL_INFO
 (("In computer_probing_pm_is_supported_helper_done"));

823 
	`decode_dmi
 (
d
);

824 
	}
}

826 #ifdeà
USE_PCI


828 
	$g‘_´im¬y_videoÿrd
 (
H®Deviû
 *
d
)

830 
GDœ
 *
dœ
;

831 cÚ¡ *
Çme
;

833 
dœ
 = 
	`g_dœ_İ’
 ("/sys/bus/pci/deviûs", 0, 
NULL
);

834 ià(
dœ
 =ğ
NULL
)

835 
out
;

836 (
Çme
 = 
	`g_dœ_»ad_Çme
 (
dœ
)è!ğ
NULL
) {

837 
şass
;

838 *
·th
;

839 
·th
 = 
	`g_¡rdup_´štf
 ("/sys/bus/pci/deviûs/%s", 
Çme
);

840 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "şass", &
şass
, 0) && (class&0xffff00) == 0x030000 ) {

841 
v’dÜ
, 
deviû
;

842 ià(
	`h®_ut_g‘_št_äom_fe
 (
·th
, "v’dÜ", &
v’dÜ
, 0) &&

843 
	`h®_ut_g‘_št_äom_fe
 (
·th
, "deviû", &
deviû
, 0)) {

844 
	`HAL_INFO
 (("gÙ %x:%x‡ ´im¬y videoÿrd", 
v’dÜ
, 
deviû
));

845 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "sy¡em.h¬dw¬e.´im¬y_video.v’dÜ", 
v’dÜ
);

846 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "sy¡em.h¬dw¬e.´im¬y_video.´oduù", 
deviû
);

847 
	`g_ä“
 (
·th
);

848 
	`g_dœ_şo£
 (
dœ
);

849 
out
;

852 
	`g_ä“
 (
·th
);

854 
	`g_dœ_şo£
 (
dœ
);

855 
out
:

857 
	}
}

860 
	$g‘_´im¬y_videoÿrd
 (
H®Deviû
 *
d
)

862 
	}
}

865 #ià
defšed
(
__¬m__
)

867 
	#¡rbegš
(
buf
, 
¡r
è(
	`¡ºcmp
 (buf, sŒ, 
	`¡¾’
 (¡r)è=ğ0)

	)

869 
šlše
 

870 
	$is_f›ld_£·¿tÜ
 (
c
)

872  (
	`is¥aû
 (
c
) || ':' == c);

873 
	}
}

884 
	$£t¡r
 (
H®Deviû
 *
d
, *
buf
, *
¡r
, *
´İ
)

886 ià(
	`¡rbegš
 (
buf
, 
¡r
)) {

887 *
v®ue
;

889 
v®ue
 = 
buf
 + 
	`¡¾’
 (
¡r
);

892 
	`is_f›ld_£·¿tÜ
 (*
v®ue
))

893 
v®ue
++;

895 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, 
´İ
, 
v®ue
);

897  
TRUE
;

900  
FALSE
;

901 
	}
}

904 
	$£t¡r¥l™
 (
H®Deviû
 *
d
, *
buf
, *
¡r
, *
´İ_a
, *
´İ_b
)

906 ià(
	`¡rbegš
 (
buf
, 
¡r
)) {

907 *
v®ue_a
, *
v®ue_b
;

909 
v®ue_a
 = 
buf
 + 
	`¡¾’
 (
¡r
);

912 
	`is_f›ld_£·¿tÜ
 (*
v®ue_a
))

913 
v®ue_a
++;

915 
v®ue_b
 = 
v®ue_a
;

918 !
	`is_f›ld_£·¿tÜ
 (*
v®ue_b
))

919 
v®ue_b
++;

922 *
v®ue_b
 = '\0';

923 
v®ue_b
++;

925 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, 
´İ_a
, 
v®ue_a
);

926 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, 
´İ_b
, 
v®ue_b
);

928  
TRUE
;

931  
FALSE
;

932 
	}
}

935 
	$·r£_om­_hwšfo
 (
H®Deviû
 *
d
, *
buf
)

938 
	`£t¡r
 (
d
, 
buf
, "product", "system.hardware.product");

939 
	`£t¡r
 (
d
, 
buf
, "hw-build", "system.hardware.version");

940 ià(
	`£t¡r
 (
d
, 
buf
, "nolo", "system.firmware.version"))

941 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "system.firmware.name", "NOLO");

942 
	}
}

945 
	$·r£_om­_ıušfo
 (
H®Deviû
 *
d
, *
buf
)

947 
	`£t¡r¥l™
 (
d
, 
buf
, "Hardware",

949 
	`£t¡r
 (
d
, 
buf
, "Revision", "system.hardware.uuid");

950 
	`£t¡r
 (
d
, 
buf
, "Serial", "system.hardware.serial");

951 
	}
}

954 
·r£_om­_fe
 (
H®Deviû
 *
d
, *
f’ame
, (*
·r£_â
)(HalDevice *d, *))

956 
buf
[512];

957 
FILE
 *
f
;

959 
f
 = 
	`fİ’
 (
f’ame
, "r");

960 ià(!
f
) {

961 
	`HAL_ERROR
 (("not„unning on‡n OMAP kernel\n"));

966 
	`fg‘s
 (
buf
, (buf), 
f
è!ğ
NULL
) {

967 
i
;

968 
Ën
;

969 *
nbuf
;

972 
Ën
 = 
	`¡¾’
 (
buf
);

975 ià(
Ën
 >ğ (
buf
))

979 ià(
Ën
 < 3)

982 
nbuf
 = 
buf
;

985 
i
 = 
Ën
 - 1; 
	`is¥aû
 (
nbuf
[i]) && i >= 0; --i)

986 
nbuf
[
i
] = '\0';

988 
	`·r£_â
 (
d
, 
nbuf
);

992 
	`fşo£
 (
f
);

995 
	}
}

999 
	$´obe_om­
 (
H®Deviû
 *
roÙ
)

1001 ià(
	`·r£_om­_fe
 (
roÙ
, "/´oc/compÚ’t_v”siÚ", 
·r£_om­_hwšfo
))

1003 ià(
	`·r£_om­_fe
 (
roÙ
, "/´oc/ıušfo", 
·r£_om­_ıušfo
))

1005 
	}
}

1008 
	$´obe_om­
 (
H®Deviû
 *
roÙ
)

1010 
	}
}

1014 
	$os¥ec_´obe
 ()

1016 
H®Deviû
 *
roÙ
;

1017 
ut¢ame
 
un
;

1019 
	`h®d_ruÂ”_£t_m‘hod_run_nÙify
 ((
H®dRuÂ”RunNÙify
è
hÙ¶ug_ev’t_´oûss_queue
, 
NULL
);

1020 
roÙ
 = 
	`h®_deviû_Ãw
 ();

1021 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
roÙ
, "info.subsystem", "unknown");

1022 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
roÙ
, "info.product", "Computer");

1023 
	`h®_deviû_£t_udi
 (
roÙ
, "/org/freedesktop/Hal/devices/computer");

1025 ià(
	`uÇme
 (&
un
) >= 0) {

1026 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
roÙ
, "sy¡em.k”Ãl.Çme", 
un
.
sy¢ame
);

1027 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
roÙ
, "sy¡em.k”Ãl.v”siÚ", 
un
.
»Ëa£
);

1028 ià(
un
.
»Ëa£
 !ğ
NULL
 && un.release[0] != '\0') {

1029 
majÜ
, 
mšÜ
, 
miüo
 ;

1032 iàĞ
	`ssÿnf
Ğ
un
.
»Ëa£
, "%d.%d.%d", &
majÜ
, &
mšÜ
, &
miüo
 ) >= 3 ) {

1033 
	`h®_deviû_´İ”ty_£t_št
 (
roÙ
, "sy¡em.k”Ãl.v”siÚ.majÜ", 
majÜ
);

1034 
	`h®_deviû_´İ”ty_£t_št
 (
roÙ
, "sy¡em.k”Ãl.v”siÚ.mšÜ", 
mšÜ
);

1035 
	`h®_deviû_´İ”ty_£t_št
 (
roÙ
, "sy¡em.k”Ãl.v”siÚ.miüo", 
miüo
);

1039 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
roÙ
, "sy¡em.k”Ãl.machše", 
un
.
machše
);

1043 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
roÙ
);

1051 
	`£t_su¥’d_hib”Ç‹_keys
 (
roÙ
);

1054 
	`g‘_´im¬y_videoÿrd
 (
roÙ
);

1056 
	`´obe_om­
 (
roÙ
);

1060 ià(
	`g_fe_‹¡
 ("/u¤/bš/pm-is-suµÜ‹d", 
G_FILE_TEST_IS_EXECUTABLE
)) {

1061 
	`h®d_ruÂ”_run
 (
roÙ
, "h®-sy¡em-pow”-pm-is-suµÜ‹d", 
NULL
, 
HAL_HELPER_TIMEOUT
,

1062 
compu‹r_´obšg_pm_is_suµÜ‹d_h–³r_dÚe
, 
NULL
, NULL);

1064 
	`decode_dmi
 (
roÙ
);

1066 
	}
}

1068 
DBusHªdËrResuÉ


1069 
	$os¥ec_f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£r_d©a
)

1071  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1072 
	}
}

1074 
gboŞ—n


1075 
	$os¥ec_deviû_»sÿn
 (
H®Deviû
 *
d
)

1077  
	`hÙ¶ug_»sÿn_deviû
 (
d
);

1078 
	}
}

1080 
gboŞ—n


1081 
	$os¥ec_deviû_»´obe
 (
H®Deviû
 *
d
)

1083  
	`hÙ¶ug_»´obe_Œ“
 (
d
);

1084 
	}
}

1086 
gboŞ—n


1087 
	$h®_ut_g‘_driv”_Çme
 (cÚ¡ *
sysfs_·th
, 
gch¬
 *
driv”_Çme
)

1089 
gch¬
 
driv”_·th
[
HAL_PATH_MAX
];

1090 
¡©
 
¡©buf
;

1092 ià(
sysfs_·th
 =ğ
NULL
) {

1093 
	`HAL_WARNING
 (("hal_util_get_driver_name: sysfs_path == NULL"));

1094  
FALSE
;

1097 
	`g_¢´štf
 (
driv”_·th
,  (driv”_·th), "%s/driv”", 
sysfs_·th
);

1098 ià(
	`¡©
 (
driv”_·th
, &
¡©buf
) == 0) {

1099 
gch¬
 
buf
[256];

1100 
	`mem£t
 (
buf
, '\0',  (buf));

1101 ià(
	`»adlšk
 (
driv”_·th
, 
buf
,  (buf) - 1) > 0) {

1102 
	`g_¢´štf
 (
driv”_Çme
, 
	`¡¾’
(
buf
), "%s", 
	`h®_ut_g‘_Ï¡_–em’t
(buf));

1103  
TRUE
;

1106  
FALSE
;

1107 
	}
}

1109 
gboŞ—n


1110 
	$h®_ut_£t_driv”
 (
H®Deviû
 *
d
, cÚ¡ *
´İ”ty_Çme
, cÚ¡ *
sysfs_·th
)

1112 
gboŞ—n
 
»t
;

1113 
gch¬
 
driv”_Çme
[256];

1115 ià(
d
 =ğ
NULL
 || 
´İ”ty_Çme
 =ğNULL || 
sysfs_·th
 == NULL) {

1116 
	`HAL_WARNING
 (("hal_util_set_driver: d,…roperty_name or sysfs_path == NULL"));

1117  
FALSE
;

1120 
	`mem£t
 (
driv”_Çme
, '\0',  (driver_name));

1121 
»t
 = 
	`h®_ut_g‘_driv”_Çme
 (
sysfs_·th
, 
driv”_Çme
);

1122 ià(
»t
 =ğ
TRUE
)

1123 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, 
´İ”ty_Çme
, 
driv”_Çme
);

1125  
»t
;

1126 
	}
}

1128 
gboŞ—n
 
	$g‘_·»Á_deviû
(*
·th
)

1131 ià(!
	`h®_ut_·th_asûnd
 (
·th
))

1132  
FALSE
;

1133 ià(
	`g_¡r_has_suffix
 (
·th
, "/class"))

1134  
FALSE
;

1135 ià(
	`g_¡r_has_suffix
 (
·th
, "/block"))

1136  
FALSE
;

1137 ià(
	`g_¡r_has_suffix
 (
·th
, "/devices"))

1138  
FALSE
;

1139  
TRUE
;

1140 
	}
}

1143 
gboŞ—n


1144 
	$h®_ut_fšd_known_·»Á
 (cÚ¡ 
gch¬
 *
sysfs_·th
, 
H®Deviû
 **
·»Á
, gch¬ **
·»Á_·th
)

1146 
gch¬
 *
rg‘
;

1147 
H®Deviû
 *
·»Á_dev
 = 
NULL
;

1148 
gch¬
 *
·»Á_dev·th
;

1149 
·»Ádev·th
[
HAL_PATH_MAX
];

1150 
gboŞ—n
 
»tv®
 = 
FALSE
;

1152 
·»Á_dev·th
 = 
	`g_¡rdup
 (
sysfs_·th
);

1153 
TRUE
) {

1154 ià(!
	`g‘_·»Á_deviû
 (
·»Á_dev·th
))

1157 
·»Á_dev
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

1159 
·»Á_dev·th
);

1160 ià(
·»Á_dev
 !ğ
NULL
)

1161 
out
;

1163 
	`g_ä“
 (
·»Á_dev·th
);

1164 
·»Á_dev·th
 = 
NULL
;

1167 
	`g_¢´štf
 (
·»Ádev·th
, 
HAL_PATH_MAX
, "%s/deviû", 
sysfs_·th
);

1168 ià((
rg‘
 = 
	`h®_ut_»adlšk
 (
·»Ádev·th
)è!ğ
NULL
) {

1169 
·»Á_dev·th
 = 
	`h®_ut_g‘_nÜm®ized_·th
 (
sysfs_·th
, 
rg‘
);

1171 
TRUE
) {

1172 
·»Á_dev
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

1174 
·»Á_dev·th
);

1175 ià(
·»Á_dev
 !ğ
NULL
)

1176 
out
;

1179 ià(!
	`g‘_·»Á_deviû
 (
·»Á_dev·th
))

1182 
	`g_ä“
 (
·»Á_dev·th
);

1183 
·»Á_dev·th
 = 
NULL
;

1186 
out
:

1187 ià(
·»Á_dev
 !ğ
NULL
) {

1188 
	`HAL_INFO
 (("h®_ut_fšd_known_·»Á: '%s'->'%s'", 
sysfs_·th
, 
·»Á_dev·th
));

1189 
»tv®
 = 
TRUE
;

1191 ià(
·»Á
 !ğ
NULL
)

1192 *
·»Á
 = 
·»Á_dev
;

1193 ià(
·»Á_·th
 !ğ
NULL
)

1194 *
·»Á_·th
 = 
·»Á_dev·th
;

1196 
	`g_ä“
 (
·»Á_dev·th
);

1197  
»tv®
;

1198 
	}
}

1201 
	$os¥ec_»äesh_mouÁ_¡©e_fÜ_block_deviû
 (
H®Deviû
 *
d
)

1203 
	`blockdev_»äesh_mouÁ_¡©e
 (
d
);

1204 
	}
}

	@hald/linux/osspec_linux.h

26 #iâdeà
OSSPEC_LINUX_H


27 
	#OSSPEC_LINUX_H


	)

29 
	~<glib.h
>

30 
	~"../deviû.h
"

32 
gboŞ—n
 
h®_ut_g‘_driv”_Çme
 (cÚ¡ *
sysfs_·th
, 
gch¬
 *
driv”_Çme
);

34 
gboŞ—n
 
h®_ut_£t_driv”
 (
H®Deviû
 *
d
, cÚ¡ *
´İ”ty_Çme
, cÚ¡ *
sysfs_·th
);

36 
gboŞ—n
 
h®_ut_fšd_known_·»Á
 (cÚ¡ 
gch¬
 *
sysfs_·th
, 
H®Deviû
 **
·»Á
, gch¬ **
·»Á_·th
);

38 
GIOChªÃl
 *
g‘_md¡©_chªÃl
 ();

	@hald/linux/pmu.c

23 #ifdeà
HAVE_CONFIG_H


24 
	~<cÚfig.h
>

27 
	~<¡dio.h
>

28 
	~<¡dlib.h
>

29 
	~<fú.h
>

30 
	~<¡ršg.h
>

31 
	~<uni¡d.h
>

33 
	~"../deviû_šfo.h
"

34 
	~"../deviû_pm.h
"

35 
	~"../h®d_dbus.h
"

36 
	~"../logg”.h
"

37 
	~"../ut.h
"

38 
	~"../ut_pm.h
"

40 
	~"hÙ¶ug.h
"

41 
	~"os¥ec_lšux.h
"

42 
	~"deviû.h
"

44 
	~"pmu.h
"

47 
	mPMU_TYPE_BATTERY
,

48 
	mPMU_TYPE_AC_ADAPTER
,

49 
	mPMU_TYPE_LID_BUTTON
,

50 
	mPMU_TYPE_LAPTOP_PANEL


54 
	sPMUDevHªdËr_s


56 
	mpmu_ty³
;

57 
	mH®Deviû
 *(*
	madd
è(cÚ¡ 
gch¬
 *
	mpmu_·th
, 
H®Deviû
 *
	m·»Á
, 
PMUDevHªdËr_s
 *
	mhªdËr
);

58 
gboŞ—n
 (*
compu‹_udi
è(
H®Deviû
 *
	md
, 
PMUDevHªdËr_s
 *
	mhªdËr
);

59 
gboŞ—n
 (*
»move
è(
H®Deviû
 *
	md
, 
PMUDevHªdËr_s
 *
	mhªdËr
);

60 
gboŞ—n
 (*
»äesh
è(
H®Deviû
 *
	md
, 
PMUDevHªdËr_s
 *
	mhªdËr
);

61 } 
	tPMUDevHªdËr
;

65 
	#PMU_BATT_PRESENT
 0x00000001

	)

66 
	#PMU_BATT_CHARGING
 0x00000002

	)

67 
	#PMU_BATT_TYPE_MASK
 0x000000f0

	)

68 
	#PMU_BATT_TYPE_SMART
 0x00000010

	)

69 
	#PMU_BATT_TYPE_HOOPER
 0x00000020

	)

70 
	#PMU_BATT_TYPE_COMET
 0x00000030

	)

72 
	#PMU_POLL_INTERVAL
 2

	)

74 
	#PMUDEV
 "/dev/pmu"

	)

77 
gboŞ—n


78 
	$b©‹ry_»äesh
 (
H®Deviû
 *
d
, 
PMUDevHªdËr
 *
hªdËr
)

80 cÚ¡ *
·th
;

81 
æags
;

83 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.pmu_path");

84 ià(
·th
 =ğ
NULL
)

85  
FALSE
;

87 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Battery Bay");

88 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.type", "primary");

89 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "battery.technology", "unknown");

90 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "battery");

91 
	`h®_deviû_add_ÿ·b™y
 (
d
, "battery");

93 
æags
 = 
	`h®_ut_g»p_št_–em_äom_fe
 (
·th
, "", "æags", 0, 16, 
FALSE
);

95 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.´e£Á", 
æags
 & 
PMU_BATT_PRESENT
);

97 ià(
æags
 & 
PMU_BATT_PRESENT
) {

98 
cu¼’t
;

100 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

101 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.is_»ch¬g—bË", 
TRUE
);

106 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "b©‹ry.»ch¬g—bË.is_ch¬gšg", 
æags
 & 
PMU_BATT_CHARGING
);

109 
	`h®_ut_£t_boŞ_–em_äom_fe
 (
d
, "battery.rechargeable.is_discharging", "/proc/pmu/info", "",

110 "AC Pow”", 0, "0", 
FALSE
);

113 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "battery.charge_level.current",

114 
·th
, "", "ch¬ge", 0, 10, 
FALSE
);

115 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "battery.charge_level.last_full",

116 
·th
, "", "max_ch¬ge", 0, 10, 
FALSE
);

117 
	`h®_ut_£t_št_–em_äom_fe
 (
d
, "battery.charge_level.design",

118 
·th
, "", "max_ch¬ge", 0, 10, 
FALSE
);

120 
cu¼’t
 = 
	`h®_ut_g»p_št_–em_äom_fe
 (
·th
, "", "cu¼’t", 0, 10, 
FALSE
);

121 ià(
cu¼’t
 > 0)

122 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.¿‹", 
cu¼’t
);

124 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "b©‹ry.ch¬ge_Ëv–.¿‹", -
cu¼’t
);

127 
	`deviû_pm_ÿlcuÏ‹_time
 (
d
);

128 
	`deviû_pm_ÿlcuÏ‹_³rûÁage
 (
d
);

130 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

132 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

133 
	`deviû_pm_»move_İtiÚ®_´İs
 (
d
);

134 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

137  
TRUE
;

138 
	}
}

140 
gboŞ—n


141 
	$ac_ad­‹r_»äesh
 (
H®Deviû
 *
d
, 
PMUDevHªdËr
 *
hªdËr
)

143 cÚ¡ *
·th
;

145 
·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.pmu_path");

146 ià(
·th
 =ğ
NULL
)

147  
FALSE
;

149 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "AC Adapter");

150 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "ac_adapter");

151 
	`h®_deviû_add_ÿ·b™y
 (
d
, "ac_adapter");

153 
	`h®_ut_£t_boŞ_–em_äom_fe
 (
d
, "ac_ad­‹r.´e£Á", 
·th
, "", "AC Pow”", 0, "1", 
FALSE
);

155  
TRUE
;

156 
	}
}

158 
gboŞ—n


159 
	$lid_bu‰Ú_»äesh
 (
H®Deviû
 *
d
, 
PMUDevHªdËr
 *
hªdËr
)

161 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Lid Switch");

162 
	`h®_deviû_add_ÿ·b™y
 (
d
, "button");

163 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "button");

164 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "button.type", "lid");

165 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "bu‰Ú.has_¡©e", 
TRUE
);

166 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "bu‰Ú.¡©e.v®ue", 
FALSE
);

171  
TRUE
;

172 
	}
}

184 
gboŞ—n


185 
	$Ï±İ_·Ãl_»äesh
 (
H®Deviû
 *
d
, 
PMUDevHªdËr
 *
hªdËr
)

187 ià((
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (),

188 "/Üg/ä“desktİ/H®/deviûs/compu‹r_backlight")è!ğ
NULL
)

189  
FALSE
;

191 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "laptop_panel");

192 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Apple Laptop Panel");

194 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "laptop_panel.access_method", "pmu");

203 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "laptop_panel.num_levels", 15);

204 
	`h®_deviû_add_ÿ·b™y
 (
d
, "laptop_panel");

205  
TRUE
;

206 
	}
}

208 
gboŞ—n


209 
	$pmu_lid_compu‹_udi
 (
H®Deviû
 *
d
, 
PMUDevHªdËr
 *
hªdËr
)

211 
gch¬
 
udi
[256];

212 
	`h®d_compu‹_udi
 (
udi
,  (udi),

214 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

215  
TRUE
;

216 
	}
}

218 
gboŞ—n


219 
	$pmu_Ï±İ_·Ãl_compu‹_udi
 (
H®Deviû
 *
d
, 
PMUDevHªdËr
 *
hªdËr
)

221 
gch¬
 
udi
[256];

222 
	`h®d_compu‹_udi
 (
udi
,  (udi),

224 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

225  
TRUE
;

226 
	}
}

228 
gboŞ—n


229 
	$pmu_pŞl
 (
gpoš‹r
 
d©a
)

231 
GSLi¡
 *
i
;

232 
GSLi¡
 *
deviûs
;

234 
deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

237 
i
 = 
deviûs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

238 
H®Deviû
 *
d
;

240 
d
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

241 ià(
	`h®_deviû_has_´İ”ty
 (
d
, "linux.pmu_type")) {

242 
	`h®_ut_g»p_disÿrd_exi¡šg_d©a
 ();

243 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

244 
	`b©‹ry_»äesh
 (
d
, 
NULL
);

245 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

249 
	`g_¦i¡_ä“
 (
deviûs
);

250 
deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

253 
i
 = 
deviûs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

254 
H®Deviû
 *
d
;

256 
d
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

257 ià(
	`h®_deviû_has_´İ”ty
 (
d
, "linux.pmu_type")) {

258 
	`h®_ut_g»p_disÿrd_exi¡šg_d©a
 ();

259 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

260 
	`ac_ad­‹r_»äesh
 (
d
, 
NULL
);

261 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

265 
	`g_¦i¡_ä“
 (
deviûs
);

266  
TRUE
;

267 
	}
}

277 
	$pmu_syÁhesize_™em
 (cÚ¡ 
gch¬
 *
fuÎ·th
, 
pmu_ty³
)

279 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

280 
	`HAL_INFO
 (("Proûssšg %s", 
fuÎ·th
));

281 
hÙ¶ug_ev’t
 = 
	`g_Ãw0
 (
HÙ¶ugEv’t
, 1);

282 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

283 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_PMU
;

284 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
pmu
.
pmu_·th
, 
fuÎ·th
,  (hotplug_event->pmu.pmu_path));

285 
hÙ¶ug_ev’t
->
aıi
.
aıi_ty³
 = 
pmu_ty³
;

286 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
);

287 
	}
}

297 
gboŞ—n


298 
	$pmu_syÁhesize_hÙ¶ug_ev’ts
 ()

300 
gboŞ—n
 
»t
;

301 
H®Deviû
 *
compu‹r
;

302 
GE¼Ü
 *
”rÜ
;

303 
GDœ
 *
dœ
;

304 
gboŞ—n
 
has_b©‹ry_bays
;

306 
»t
 = 
FALSE
;

308 
has_b©‹ry_bays
 = 
FALSE
;

310 ià(!
	`g_fe_‹¡
 ("/´oc/pmu/šfo", 
G_FILE_TEST_EXISTS
))

311 
out
;

313 
»t
 = 
TRUE
;

315 ià((
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), "/Üg/ä“desktİ/H®/deviûs/compu‹r")è=ğ
NULL
 &&

316 (
compu‹r
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_tdl
 (), "/Üg/ä“desktİ/H®/deviûs/compu‹r")è=ğ
NULL
) {

317 
	`HAL_ERROR
 (("No computer object?"));

318 
out
;

322 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
compu‹r
, "power_management.type", "pmu");

325 
	`pmu_syÁhesize_™em
 ("/´oc/pmu/šfo", 
PMU_TYPE_AC_ADAPTER
);

327 
”rÜ
 = 
NULL
;

328 
dœ
 = 
	`g_dœ_İ’
 ("/´oc/pmu", 0, &
”rÜ
);

329 ià(
dœ
 !ğ
NULL
) {

330 cÚ¡ 
gch¬
 *
f
;

331 (
f
 = 
	`g_dœ_»ad_Çme
 (
dœ
)è!ğ
NULL
) {

332 
gch¬
 
buf
[
HAL_PATH_MAX
];

333 
b©‹ry_num
;

335 
	`¢´štf
 (
buf
,  (buf), "/´oc/pmu/%s", 
f
);

336 ià(
	`ssÿnf
 (
f
, "b©‹ry_%d", &
b©‹ry_num
) == 1) {

337 
has_b©‹ry_bays
 = 
TRUE
;

338 
	`pmu_syÁhesize_™em
 (
buf
, 
PMU_TYPE_BATTERY
);

343 
	`HAL_ERROR
 (("Couldn'ˆİ’ /´oc/pmu/šfo: %s", 
”rÜ
->
mes§ge
));

344 
	`g_”rÜ_ä“
 (
”rÜ
);

348 
	`g_dœ_şo£
 (
dœ
);

353 ià(
has_b©‹ry_bays
) {

355 
	`pmu_syÁhesize_™em
 ("/´oc/pmu/šfo", 
PMU_TYPE_LID_BUTTON
);

358 
	`pmu_syÁhesize_™em
 ("/´oc/pmu/šfo", 
PMU_TYPE_LAPTOP_PANEL
);

361 ià(!
_have_sysfs_pow”_suµly
) {

363 #ifdeà
HAVE_GLIB_2_14


364 
	`g_timeout_add_£cÚds
 (
PMU_POLL_INTERVAL
,

365 
pmu_pŞl
,

366 
NULL
);

368 
	`g_timeout_add
 (1000 * 
PMU_POLL_INTERVAL
,

369 
pmu_pŞl
,

370 
NULL
);

374 
out
:

375  
»t
;

376 
	}
}

378 
H®Deviû
 *

379 
	$pmu_g’”ic_add
 (cÚ¡ 
gch¬
 *
pmu_·th
, 
H®Deviû
 *
·»Á
, 
PMUDevHªdËr
 *
hªdËr
)

381 
H®Deviû
 *
d
;

383 ià(((
hªdËr
->
pmu_ty³
 =ğ
PMU_TYPE_BATTERY
è|| (hªdËr->pmu_ty³ =ğ
PMU_TYPE_AC_ADAPTER
)è&& 
_have_sysfs_pow”_suµly
)

384  
NULL
;

386 
d
 = 
	`h®_deviû_Ãw
 ();

387 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "lšux.pmu_·th", 
pmu_·th
);

388 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "lšux.pmu_ty³", 
hªdËr
->
pmu_ty³
);

389 ià(
·»Á
 !ğ
NULL
)

390 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á
));

392 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/computer");

393 ià(
hªdËr
->
»äesh
 =ğ
NULL
 || !hªdËr->
	`»äesh
 (
d
, handler)) {

394 
	`g_objeù_uÄef
 (
d
);

395 
d
 = 
NULL
;

397  
d
;

398 
	}
}

400 
gboŞ—n


401 
	$pmu_g’”ic_compu‹_udi
 (
H®Deviû
 *
d
, 
PMUDevHªdËr
 *
hªdËr
)

403 
gch¬
 
udi
[256];

404 
	`h®d_compu‹_udi
 (
udi
,  (udi),

406 
	`h®_ut_g‘_Ï¡_–em’t
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.pmu_path")),

407 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.pmu_type"));

408 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

409  
TRUE
;

410 
	}
}

412 
gboŞ—n


413 
	$pmu_g’”ic_»move
 (
H®Deviû
 *
d
, 
PMUDevHªdËr
 *
hªdËr
)

415 ià(!
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_gdl
 (), 
d
)) {

416 
	`HAL_WARNING
 (("Error„emoving device"));

419  
TRUE
;

420 
	}
}

422 
PMUDevHªdËr
 
	gpmudev_hªdËr_b©‹ry
 = {

423 .
pmu_ty³
 = 
PMU_TYPE_BATTERY
,

424 .
	gadd
 = 
pmu_g’”ic_add
,

425 .
	gcompu‹_udi
 = 
pmu_g’”ic_compu‹_udi
,

426 .
	g»äesh
 = 
b©‹ry_»äesh
,

427 .
	g»move
 = 
pmu_g’”ic_»move


430 
PMUDevHªdËr
 
	gpmudev_hªdËr_ac_ad­‹r
 = {

431 .
pmu_ty³
 = 
PMU_TYPE_AC_ADAPTER
,

432 .
	gadd
 = 
pmu_g’”ic_add
,

433 .
	gcompu‹_udi
 = 
pmu_g’”ic_compu‹_udi
,

434 .
	g»äesh
 = 
ac_ad­‹r_»äesh
,

435 .
	g»move
 = 
pmu_g’”ic_»move


438 
PMUDevHªdËr
 
	gpmudev_hªdËr_lid_bu‰Ú
 = {

439 .
pmu_ty³
 = 
PMU_TYPE_LID_BUTTON
,

440 .
	gadd
 = 
pmu_g’”ic_add
,

441 .
	gcompu‹_udi
 = 
pmu_lid_compu‹_udi
,

442 .
	g»äesh
 = 
lid_bu‰Ú_»äesh
,

443 .
	g»move
 = 
pmu_g’”ic_»move


446 
PMUDevHªdËr
 
	gpmudev_hªdËr_Ï±İ_·Ãl
 = {

447 .
pmu_ty³
 = 
PMU_TYPE_LAPTOP_PANEL
,

448 .
	gadd
 = 
pmu_g’”ic_add
,

449 .
	gcompu‹_udi
 = 
pmu_Ï±İ_·Ãl_compu‹_udi
,

450 .
	g»äesh
 = 
Ï±İ_·Ãl_»äesh
,

451 .
	g»move
 = 
pmu_g’”ic_»move


454 
PMUDevHªdËr
 *
	gpmu_hªdËrs
[] = {

455 &
pmudev_hªdËr_b©‹ry
,

456 &
pmudev_hªdËr_ac_ad­‹r
,

457 &
pmudev_hªdËr_lid_bu‰Ú
,

458 &
pmudev_hªdËr_Ï±İ_·Ãl
,

459 
NULL


463 
	$hÙ¶ug_ev’t_begš_add_pmu
 (cÚ¡ 
gch¬
 *
pmu_·th
, 
pmu_ty³
, 
H®Deviû
 *
·»Á
, *
’d_tok’
)

465 
gušt
 
i
;

467 
	`HAL_INFO
 (("pmu_add:…mu_·th=% pmu_ty³=%d,…¬’t=0x%08x", 
pmu_·th
, 
pmu_ty³
, 
·»Á
));

469 
i
 = 0; 
pmu_hªdËrs
 [i] !ğ
NULL
; i++) {

470 
PMUDevHªdËr
 *
hªdËr
;

472 
hªdËr
 = 
pmu_hªdËrs
[
i
];

473 ià(
hªdËr
->
pmu_ty³
 ==…mu_type) {

474 
H®Deviû
 *
d
;

476 
d
 = 
hªdËr
->
	`add
 (
pmu_·th
, 
·»Á
, handler);

477 ià(
d
 =ğ
NULL
) {

479 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

480 
out
;

483 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "lšux.hÙ¶ug_ty³", 
HOTPLUG_EVENT_PMU
);

486 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
d
);

489 ià(!
hªdËr
->
	`compu‹_udi
 (
d
, handler)) {

490 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

491 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

492 
out
;

496 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_INFORMATION
);

497 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_POLICY
);

502 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

503 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

505 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

506 
out
;

511 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

512 
out
:

514 
	}
}

517 
	$hÙ¶ug_ev’t_begš_»move_pmu
 (cÚ¡ 
gch¬
 *
pmu_·th
, 
pmu_ty³
, *
’d_tok’
)

519 
gušt
 
i
;

520 
H®Deviû
 *
d
;

522 
	`HAL_INFO
 (("pmu_»m:…mu_·th=% pmu_ty³=%d", 
pmu_·th
, 
pmu_ty³
));

524 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "lšux.pmu_·th", 
pmu_·th
);

525 ià(
d
 =ğ
NULL
) {

526 
	`HAL_WARNING
 (("Couldn'ˆ»movdeviû w™h…mu…©h % -‚Ù found", 
pmu_·th
));

527 
out
;

530 
i
 = 0; 
pmu_hªdËrs
 [i] !ğ
NULL
; i++) {

531 
PMUDevHªdËr
 *
hªdËr
;

533 
hªdËr
 = 
pmu_hªdËrs
[
i
];

534 ià(
hªdËr
->
pmu_ty³
 ==…mu_type) {

535 ià(
hªdËr
->
	`»move
 (
d
, handler)) {

536 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

537 
out2
;

541 
out
:

543 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

544 
out2
:

546 
	}
}

548 
gboŞ—n


549 
	$pmu_»sÿn_deviû
 (
H®Deviû
 *
d
)

551 
gušt
 
i
;

552 
gboŞ—n
 
»t
;

553 
pmu_ty³
;

555 
»t
 = 
FALSE
;

557 
pmu_ty³
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.pmu_type");

559 
i
 = 0; 
pmu_hªdËrs
 [i] !ğ
NULL
; i++) {

560 
PMUDevHªdËr
 *
hªdËr
;

562 
hªdËr
 = 
pmu_hªdËrs
[
i
];

563 ià(
hªdËr
->
pmu_ty³
 ==…mu_type) {

564 
»t
 = 
hªdËr
->
	`»äesh
 (
d
, handler);

565 
out
;

569 
	`HAL_WARNING
 (("Didn'ˆfšd‡„esÿÀhªdË¸fÜ ud˜%s", 
	`h®_deviû_g‘_udi
 (
d
)));

571 
out
:

572  
»t
;

573 
	}
}

575 
HÙ¶ugEv’t
 *

576 
	$pmu_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
)

578 
pmu_ty³
;

579 cÚ¡ *
pmu_·th
;

580 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

582 
pmu_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.pmu_path");

583 
pmu_ty³
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.pmu_type");

585 
hÙ¶ug_ev’t
 = 
	`g_Ãw0
 (
HÙ¶ugEv’t
, 1);

586 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_ADD
;

587 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_PMU
;

588 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
pmu
.
pmu_·th
,…mu_path,  (hotplug_event->pmu.pmu_path));

589 
hÙ¶ug_ev’t
->
pmu
.
pmu_ty³
 =…mu_type;

590  
hÙ¶ug_ev’t
;

591 
	}
}

593 
HÙ¶ugEv’t
 *

594 
	$pmu_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
)

596 
pmu_ty³
;

597 cÚ¡ *
pmu_·th
;

598 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

600 
pmu_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "linux.pmu_path");

601 
pmu_ty³
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "linux.pmu_type");

603 
hÙ¶ug_ev’t
 = 
	`g_Ãw0
 (
HÙ¶ugEv’t
, 1);

604 
hÙ¶ug_ev’t
->
aùiÚ
 = 
HOTPLUG_ACTION_REMOVE
;

605 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_PMU
;

606 
	`g_¡¾ıy
 (
hÙ¶ug_ev’t
->
pmu
.
pmu_·th
,…mu_path,  (hotplug_event->pmu.pmu_path));

607 
hÙ¶ug_ev’t
->
pmu
.
pmu_ty³
 =…mu_type;

608  
hÙ¶ug_ev’t
;

609 
	}
}

	@hald/linux/pmu.h

22 #iâdeà
PMU_H


23 
	#PMU_H


	)

25 
	~"../h®d.h
"

26 
	~"hÙ¶ug.h
"

28 #ifdeà
HAVE_PMU


29 
gboŞ—n
 
pmu_syÁhesize_hÙ¶ug_ev’ts
 ();

30 
hÙ¶ug_ev’t_begš_add_pmu
 (cÚ¡ 
gch¬
 *
pmu_·th
, 
pmu_ty³
, 
H®Deviû
 *
·»Á
, *
’d_tok’
);

31 
hÙ¶ug_ev’t_begš_»move_pmu
 (cÚ¡ 
gch¬
 *
pmu_·th
, 
pmu_ty³
, *
’d_tok’
);

32 
gboŞ—n
 
pmu_»sÿn_deviû
 (
H®Deviû
 *
d
);

33 
HÙ¶ugEv’t
 *
pmu_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
);

34 
HÙ¶ugEv’t
 *
pmu_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
);

36 
šlše
 
gboŞ—n
 
	$pmu_syÁhesize_hÙ¶ug_ev’ts
 (è{ 
FALSE
;
	}
}

37 
šlše
 
	$hÙ¶ug_ev’t_begš_add_pmu
 (cÚ¡ 
gch¬
 *
pmu_·th
, 
pmu_ty³
, 
H®Deviû
 *
·»Á
, *
’d_tok’
è{;
	}
}

38 
šlše
 
	$hÙ¶ug_ev’t_begš_»move_pmu
 (cÚ¡ 
gch¬
 *
pmu_·th
, 
pmu_ty³
, *
’d_tok’
è{;
	}
}

39 
šlše
 
gboŞ—n
 
	$pmu_»sÿn_deviû
 (
H®Deviû
 *
d
è{ 
FALSE
;
	}
}

40 
šlše
 
HÙ¶ugEv’t
 *
	$pmu_g’”©e_add_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
è{ 
NULL
;
	}
}

41 
šlše
 
HÙ¶ugEv’t
 *
	$pmu_g’”©e_»move_hÙ¶ug_ev’t
 (
H®Deviû
 *
d
è{ 
NULL
;
	}
}

	@hald/linux/probing/linux_dvd_rw_utils.c

10 
	~<glib.h
>

12 
	#CREAM_ON_ERRNO
(
s
) do { \

13 (
s
)[2]&0x0F) \

14 { 2: ià((
s
)[12]==4è
”ºo
=
EAGAIN
; ; \

15 5: 
”ºo
=
EINVAL
; \

16 ià((
s
)[13]==0) \

17 { ià((
s
)[12]==0x21è
”ºo
=
ENOSPC
; \

18 ià((
s
)[12]==0x20è
”ºo
=
ENODEV
; \

22 } 0)

	)

23 
	#ERRCODE
(
s
è((((s)[2]&0x0F)<<16)|((s)[12]<<8)|((s)[13]))

	)

24 
	#SK
(
”rcode
è((Ó¼code)>>16)&0xF)

	)

25 
	#ASC
(
”rcode
è((Ó¼code)>>8)&0xFF)

	)

26 
	#ASCQ
(
”rcode
è(Ó¼code)&0xFF)

	)

28 #iâdeà
_LARGEFILE_SOURCE


29 
	#_LARGEFILE_SOURCE


	)

31 #iâdeà
_LARGEFILE64_SOURCE


32 
	#_LARGEFILE64_SOURCE


	)

34 #iâdeà
_FILE_OFFSET_BITS


35 
	#_FILE_OFFSET_BITS
 64

	)

37 #iâdeà
_GNU_SOURCE


38 
	#_GNU_SOURCE


	)

41 
	~<¡dio.h
>

42 
	~<¡dlib.h
>

43 
	~<uni¡d.h
>

44 
	~<¡dšt.h
>

45 
	~<sys/¡©.h
>

46 
	~<fú.h
>

47 
	~<sys/ioùl.h
>

48 
	~<lšux/cdrom.h
>

49 
	~<”ºo.h
>

50 
	~<¡ršg.h
>

51 
	~<mÁ’t.h
>

52 
	~<sys/wa™.h
>

53 
	~<sys/ut¢ame.h
>

54 
	~<scsi/scsi.h
>

55 
	~<scsi/sg.h
>

56 
	~<pŞl.h
>

57 
	~<sys/time.h
>

59 
	~"lšux_dvd_rw_uts.h
"

61 #ià!
defšed
(
SG_FLAG_LUN_INHIBIT
)

62 #ià
defšed
(
SG_FLAG_UNUSED_LUN_INHIBIT
)

63 
	#SG_FLAG_LUN_INHIBIT
 
SG_FLAG_UNUSED_LUN_INHIBIT


	)

65 
	#SG_FLAG_LUN_INHIBIT
 0

	)

70 
	mNONE
 = 
CGC_DATA_NONE
,

71 
	mREAD
 = 
CGC_DATA_READ
,

72 
	mWRITE
 = 
CGC_DATA_WRITE


73 } 
	tDœeùiÚ
;

75 
ScsiCommªd
 
	tScsiCommªd
;

77 
	sScsiCommªd
 {

78 
	mfd
;

79 
	mautoşo£
;

80 *
	mf’ame
;

81 
cdrom_g’”ic_commªd
 
	mcgc
;

83 
»que¡_£n£
 
	ms
;

84 
	mu
[18];

85 } 
	m_£n£
;

86 
sg_io_hdr
 
	msg_io
;

89 
	#DIRECTION
(
i
è(
Dœ_xÏ‹
[i]);

	)

95 cÚ¡ 
	gDœ_xÏ‹
[4] = {

97 
SG_DXFER_TO_DEV
,

98 
SG_DXFER_FROM_DEV
,

99 
SG_DXFER_NONE


102 
ScsiCommªd
 *

103 
	$scsi_commªd_Ãw
 ()

105 
ScsiCommªd
 *
cmd
;

107 
cmd
 = (
ScsiCommªd
 *è
	`m®loc
 ( (ScsiCommand));

108 
	`mem£t
 (
cmd
, 0,  (
ScsiCommªd
));

109 
cmd
->
fd
 = -1;

110 
cmd
->
f’ame
 = 
NULL
;

111 
cmd
->
autoşo£
 = 1;

113  
cmd
;

114 
	}
}

116 
ScsiCommªd
 *

117 
	$scsi_commªd_Ãw_äom_fd
 (
f
)

119 
ScsiCommªd
 *
cmd
;

121 
cmd
 = 
	`scsi_commªd_Ãw
 ();

122 
cmd
->
fd
 = 
f
;

123 
cmd
->
autoşo£
 = 0;

125  
cmd
;

126 
	}
}

129 
	$scsi_commªd_ä“
 (
ScsiCommªd
 * 
cmd
)

131 ià(
cmd
->
fd
 >ğ0 && cmd->
autoşo£
) {

132 
	`şo£
 (
cmd
->
fd
);

133 
cmd
->
fd
 = -1;

135 ià(
cmd
->
f’ame
) {

136 
	`ä“
 (
cmd
->
f’ame
);

137 
cmd
->
f’ame
 = 
NULL
;

140 
	`ä“
 (
cmd
);

141 
	}
}

144 
	$scsi_commªd_Œª¥Üt
 (
ScsiCommªd
 * 
cmd
, 
DœeùiÚ
 
dœ
, *
buf
,

145 
size_t
 
sz
)

147 
»t
 = 0;

149 
cmd
->
sg_io
.
dxã½
 = 
buf
;

150 
cmd
->
sg_io
.
dxãr_Ën
 = 
sz
;

151 
cmd
->
sg_io
.
dxãr_dœeùiÚ
 = 
	`DIRECTION
 (
dœ
);

153 ià(
	`ioùl
 (
cmd
->
fd
, 
SG_IO
, &cmd->
sg_io
))

156 ià((
cmd
->
sg_io
.
šfo
 & 
SG_INFO_OK_MASK
è!ğ
SG_INFO_OK
) {

157 
”ºo
 = 
EIO
;

158 
»t
 = -1;

159 ià(
cmd
->
sg_io
.
masked_¡©us
 & 
CHECK_CONDITION
) {

160 
	`CREAM_ON_ERRNO
 ((*)
cmd
->
sg_io
.
sbp
);

161 
»t
 = 
	`ERRCODE
 ((*)
cmd
->
sg_io
.
sbp
);

162 ià(
»t
 == 0)

163 
»t
 = -1;

167  
»t
;

168 
	}
}

171 
	$scsi_commªd_š™
 (
ScsiCommªd
 * 
cmd
, 
size_t
 
i
, 
¬g
)

173 ià(
i
 == 0) {

174 
	`mem£t
 (&
cmd
->
cgc
, 0,  (cmd->cgc));

175 
	`mem£t
 (&
cmd
->
_£n£
, 0,  (cmd->_sense));

176 
cmd
->
cgc
.
qu›t
 = 1;

177 
cmd
->
cgc
.
£n£
 = &cmd->
_£n£
.
s
;

178 
	`mem£t
 (&
cmd
->
sg_io
, 0,  (cmd->sg_io));

179 
cmd
->
sg_io
.
š‹rçû_id
 = 'S';

180 
cmd
->
sg_io
.
mx_sb_Ën
 =  (cmd->
_£n£
);

181 
cmd
->
sg_io
.
cmdp
 = cmd->
cgc
.cmd;

182 
cmd
->
sg_io
.
sbp
 = cmd->
_£n£
.
u
;

183 
cmd
->
sg_io
.
æags
 = 
SG_FLAG_LUN_INHIBIT
 | 
SG_FLAG_DIRECT_IO
;

185 
cmd
->
sg_io
.
cmd_Ën
 = 
i
 + 1;

186 
cmd
->
cgc
.cmd[
i
] = 
¬g
;

187 
	}
}

190 
	$g‘_dvd_r_rw_´ofe
 (
fd
)

192 
ScsiCommªd
 *
cmd
;

193 
»tv®
 = 0;

194 
·ge
[20];

195 *
li¡
;

196 
i
, 
Ën
;

198 
cmd
 = 
	`scsi_commªd_Ãw_äom_fd
 (
fd
);

200 
	`scsi_commªd_š™
 (
cmd
, 0, 0x46);

201 
	`scsi_commªd_š™
 (
cmd
, 1, 2);

202 
	`scsi_commªd_š™
 (
cmd
, 8, 8);

203 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

204 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
·ge
, 8)) {

206 
	`scsi_commªd_ä“
 (
cmd
);

211 
Ën
 = 4 + (
·ge
[0] << 24 |…age[1] << 16 |…age[2] << 8 |…age[3]);

212 ià(
Ën
 > 264) {

213 
	`scsi_commªd_ä“
 (
cmd
);

218 
li¡
 = (*è
	`m®loc
 (
Ën
);

220 
	`scsi_commªd_š™
 (
cmd
, 0, 0x46);

221 
	`scsi_commªd_š™
 (
cmd
, 1, 2);

222 
	`scsi_commªd_š™
 (
cmd
, 7, 
Ën
 >> 8);

223 
	`scsi_commªd_š™
 (
cmd
, 8, 
Ën
);

224 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

225 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
li¡
, 
Ën
)) {

227 
	`scsi_commªd_ä“
 (
cmd
);

228 
	`ä“
 (
li¡
);

232 
i
 = 12; i < 
li¡
[11]; i += 4) {

233 
´ofe
 = (
li¡
[
i
] << 8 |†ist[i + 1]);

251 
´ofe
) {

254 
»tv®
 |ğ
DRIVE_CDROM_CAPS_DVDRW
;

258 
»tv®
 |ğ
DRIVE_CDROM_CAPS_DVDRDL
;

261 
»tv®
 |ğ
DRIVE_CDROM_CAPS_DVDPLUSR
;

264 
»tv®
 |ğ
DRIVE_CDROM_CAPS_DVDPLUSRW
;

267 
»tv®
 |ğ
DRIVE_CDROM_CAPS_DVDPLUSRWDL
;

270 
»tv®
 |ğ
DRIVE_CDROM_CAPS_DVDPLUSRDL
;

273 
»tv®
 |ğ
DRIVE_CDROM_CAPS_BDROM
;

277 
»tv®
 |ğ
DRIVE_CDROM_CAPS_BDR
;

280 
»tv®
 |ğ
DRIVE_CDROM_CAPS_BDRE
;

283 
»tv®
 |ğ
DRIVE_CDROM_CAPS_HDDVDROM
;

286 
»tv®
 |ğ
DRIVE_CDROM_CAPS_HDDVDR
;

289 
»tv®
 |ğ
DRIVE_CDROM_CAPS_HDDVDRW
;

296 
	`scsi_commªd_ä“
 (
cmd
);

297 
	`ä“
 (
li¡
);

299  
»tv®
;

301 
	}
}

304 
	$puÎ_·ge2a_äom_fd
 (
fd
)

306 
ScsiCommªd
 *
cmd
;

307 
h—d”
[12], *
·ge2A
;

308 
Ën
, 
bdËn
;

310 
cmd
 = 
	`scsi_commªd_Ãw_äom_fd
 (
fd
);

312 
	`scsi_commªd_š™
 (
cmd
, 0, 0x5A);

313 
	`scsi_commªd_š™
 (
cmd
, 1, 0x08);

314 
	`scsi_commªd_š™
 (
cmd
, 2, 0x2A);

315 
	`scsi_commªd_š™
 (
cmd
, 8,  (
h—d”
));

316 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

318 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
h—d”
,  (header))) {

320 
	`scsi_commªd_ä“
 (
cmd
);

321  
NULL
;

324 
Ën
 = (
h—d”
[0] << 8 | header[1]) + 2;

325 
bdËn
 = 
h—d”
[6] << 8 | header[7];

328 ià(
bdËn
) {

329 ià(
Ën
 < (8 + 
bdËn
 + 30)) {

331 
	`scsi_commªd_ä“
 (
cmd
);

332  
NULL
;

334 } ià(
Ën
 < (8 + 2 + (è
h—d”
[9])) {

336 
Ën
 = 8 + 2 + 
h—d”
[9];

339 
·ge2A
 = (*è
	`m®loc
 (
Ën
);

340 ià(
·ge2A
 =ğ
NULL
) {

342 
	`scsi_commªd_ä“
 (
cmd
);

343  
NULL
;

346 
	`scsi_commªd_š™
 (
cmd
, 0, 0x5A);

347 
	`scsi_commªd_š™
 (
cmd
, 1, 0x08);

348 
	`scsi_commªd_š™
 (
cmd
, 2, 0x2A);

349 
	`scsi_commªd_š™
 (
cmd
, 7, 
Ën
 >> 8);

350 
	`scsi_commªd_š™
 (
cmd
, 8, 
Ën
);

351 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

352 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
·ge2A
, 
Ën
)) {

354 
	`scsi_commªd_ä“
 (
cmd
);

355 
	`ä“
 (
·ge2A
);

356  
NULL
;

359 
	`scsi_commªd_ä“
 (
cmd
);

361 
Ën
 -= 2;

363 ià(
Ën
 < ((è
·ge2A
[0] << 8 |…age2A[1])) {

364 
·ge2A
[0] = 
Ën
 >> 8;

365 
·ge2A
[1] = 
Ën
;

368  
·ge2A
;

369 
	}
}

372 
	$št_com·»
 (cÚ¡ *
a
, cÚ¡ *
b
)

375  *((*è
b
è- *((*è
a
);

376 
	}
}

382 
	$g‘_wr™e_¥“ds
 (cÚ¡ *
p
, 
Ëngth
, 
max_¥“d
)

384 *
»suÉ
, *
¡r
;

385 
Ä_»cÜds
;

386 *
tmp¥“ds
;

387 
i
, 
j
;

389 
»suÉ
 = 
NULL
;

392 ià(
Ëngth
 < 32)

393  
NULL
;

395 
Ä_»cÜds
 = 
p
[30] << 8 |…[31];

398 ià(
Ëngth
 < 32 + 4 * 
Ä_»cÜds
)

399  
NULL
;

401 
tmp¥“ds
 = 
	`m®loc
 (
Ä_»cÜds
 *  ());

403 
i
 = 0; i < 
Ä_»cÜds
; i++)

405 
tmp¥“ds
[
i
] = 
p
[4*i + 34] << 8 |…[4*i + 35];

410 ià(
tmp¥“ds
[
i
] == 0)

411 
ä“_tmp¥“ds
;

415 
	`qsÜt
 (
tmp¥“ds
, 
Ä_»cÜds
,  (), 
št_com·»
);

418 
i
 = 
j
 = 0; i < 
Ä_»cÜds
; i++)

420 
tmp¥“ds
[
j
] =mp¥“ds[
i
];

423 ià(
i
 >ğ(
Ä_»cÜds
 - 1è|| 
tmp¥“ds
[i+1] !=mpspeeds[i])

424 
j
++;

428 ià(
j
 == 0)

430 
ä“_tmp¥“ds
;

436 ià(
tmp¥“ds
[0] !ğ
max_¥“d
)

438 
ä“_tmp¥“ds
;

444 
»suÉ
 = 
¡r
 = 
	`m®loc
 (8 * 
j
);

446 
i
 = 0; i < 
j
; i++)

448 ià(
i
 > 0)

449 *(
¡r
++) = ',';

451 
¡r
 +ğ
	`¥rštf
 (¡r, "%d", 
tmp¥“ds
[
i
]);

454 
ä“_tmp¥“ds
:

455 
	`ä“
 (
tmp¥“ds
);

457  
»suÉ
;

458 
	}
}

461 
	$g‘_»ad_wr™e_¥“d
 (
fd
, *
»ad_¥“d
, *
wr™e_¥“d
, **
wr™e_¥“ds
)

463 *
·ge2A
;

464 
Ën
, 
hËn
;

465 *
p
;

467 *
»ad_¥“d
 = 0;

468 *
wr™e_¥“d
 = 0;

469 *
wr™e_¥“ds
 = 
NULL
;

471 
·ge2A
 = 
	`puÎ_·ge2a_äom_fd
 (
fd
);

472 ià(
·ge2A
 =ğ
NULL
) {

473 
	`´štf
 ("Failedo get Page 2A\n");

478 
Ën
 = (
·ge2A
[0] << 8 |…age2A[1]) + 2;

479 
hËn
 = 8 + (
·ge2A
[6] << 8 |…age2A[7]);

480 
p
 = 
·ge2A
 + 
hËn
;

484 ià(
Ën
 < (
hËn
 + 30è|| 
p
[1] < (30 - 2)) {

487 ià(
Ën
 < (
hËn
 + 20è|| 
p
[1] < (20 - 2))

488 *
wr™e_¥“d
 = 0;

490 *
wr™e_¥“d
 = 
p
[18] << 8 |…[19];

492 *
wr™e_¥“d
 = 
p
[28] << 8 |…[29];

495 ià(
Ën
 >ğ
hËn
+9)

496 *
»ad_¥“d
 = 
p
[8] << 8 |…[9];

498 *
»ad_¥“d
 = 0;

500 *
wr™e_¥“ds
 = 
	`g‘_wr™e_¥“ds
 (
p
, 
Ën
, *
wr™e_¥“d
);

502 
	`ä“
 (
·ge2A
);

505 
	}
}

509 
	$g‘_disc_ÿ·c™y_cd
 (
fd
,

510 
gušt64
 *
size
)

512 
ScsiCommªd
 *
cmd
;

513 
»tv®
;

514 
gušt64
 
block_size
;

515 
gušt64
 
num_blocks
;

516 
h—d”
 [8];

518 
»tv®
 = -1;

520 
cmd
 = 
	`scsi_commªd_Ãw_äom_fd
 (
fd
);

521 
	`scsi_commªd_š™
 (
cmd
, 0, 0x25);

522 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

523 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
h—d”
, 8)) {

525 
dÚe
;

528 
num_blocks
 = (
h—d”
 [0] << 24) | (header [1] << 16) | (header [2] << 8) | header [3];

529 
num_blocks
++;

530 
block_size
 = 
h—d”
 [4] << 24 | header [5] << 16 | header [6] << 8 | header [7];

532 ià(
size
) {

533 *
size
 = 
num_blocks
 * 
block_size
;

535 
»tv®
 = 0;

537 
dÚe
:

538 
	`scsi_commªd_ä“
 (
cmd
);

540  
»tv®
;

541 
	}
}

544 
	$g‘_disc_ÿ·c™y_cdr
 (
fd
,

545 
gušt64
 *
size
)

547 
ScsiCommªd
 *
cmd
;

548 
»tv®
;

549 
gušt64
 
£cs
;

550 
toc
 [8];

551 *
©
;

552 
Ën
;

554 
»tv®
 = -1;

556 
cmd
 = 
	`scsi_commªd_Ãw_äom_fd
 (
fd
);

558 
	`scsi_commªd_š™
 (
cmd
, 0, 0x43);

560 
	`scsi_commªd_š™
 (
cmd
, 2, 4 & 0x0F);

561 
	`scsi_commªd_š™
 (
cmd
, 6, 0);

562 
	`scsi_commªd_š™
 (
cmd
, 8, 4);

563 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

565 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
toc
, 4)) {

567 
dÚe
;

570 
Ën
 = 2 + (
toc
 [0] << 8 |oc [1]);

572 
©
 = (*è
	`m®loc
 (
Ën
);

574 
	`scsi_commªd_š™
 (
cmd
, 0, 0x43);

575 
	`scsi_commªd_š™
 (
cmd
, 2, 4 & 0x0F);

576 
	`scsi_commªd_š™
 (
cmd
, 6, 0);

577 
	`scsi_commªd_š™
 (
cmd
, 7, 
Ën
 >> 8);

578 
	`scsi_commªd_š™
 (
cmd
, 8, 
Ën
);

579 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

581 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
©
, 
Ën
)) {

583 
	`ä“
 (
©
);

584 
dÚe
;

587 
£cs
 = 
©
 [12] * 60 +‡tip [13] + (atip [14] / 75 + 1);

589 ià(
size
) {

590 *
size
 = (1 + 
£cs
 * 7 / 48) * 1024 * 1024;

592 
»tv®
 = 0;

594 
	`ä“
 (
©
);

595 
dÚe
:

596 
	`scsi_commªd_ä“
 (
cmd
);

598  
»tv®
;

599 
	}
}

602 
	$g‘_disc_ÿ·c™y_dvdr_äom_ty³
 (
fd
,

603 
ty³
,

604 
gušt64
 *
size
)

606 
ScsiCommªd
 *
cmd
;

607 
fÜm©s
 [260];

608 
buf
 [32];

609 
gušt64
 
blocks
;

610 
gušt64
 
nwa
;

611 
i
;

612 
Ën
;

613 
oblig©Üy
;

614 
»tv®
;

615 
Ãxt_Œack
;

617 
»tv®
 = -1;

618 
blocks
 = 0;

619 
Ãxt_Œack
 = 1;

621 
cmd
 = 
	`scsi_commªd_Ãw_äom_fd
 (
fd
);

623 
»Œy
:

624 ià(
ty³
 == 0x1A ||ype == 0x14 ||ype == 0x13 ||ype == 0x12) {

627 
	`scsi_commªd_š™
 (
cmd
, 0, 0x23);

628 
	`scsi_commªd_š™
 (
cmd
, 8, 12);

629 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

630 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
fÜm©s
, 12)) {

632 
dÚe
;

635 
Ën
 = 
fÜm©s
 [3];

636 ià(
Ën
 & 7 ||†en < 16) {

638 
dÚe
;

641 
	`scsi_commªd_š™
 (
cmd
, 0, 0x23);

642 
	`scsi_commªd_š™
 (
cmd
, 7, (4 + 
Ën
) >> 8);

643 
	`scsi_commªd_š™
 (
cmd
, 8, (4 + 
Ën
) & 0xFF);

644 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

645 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
fÜm©s
, 4 + 
Ën
)) {

647 
dÚe
;

650 ià(
Ën
 !ğ
fÜm©s
 [3]) {

652 
dÚe
;

656 
oblig©Üy
 = 0x00;

658 
ty³
) {

660 
oblig©Üy
 = 0x26;

663 
i
 = 8, 
Ën
 = 
fÜm©s
 [3]; i <†en; i += 8) {

664 ià((
fÜm©s
 [4 + 
i
 + 4] >> 2è=ğ
oblig©Üy
) {

669 ià(
i
 =ğ
Ën
) {

671 
dÚe
;

674 
blocks
 = 
fÜm©s
 [4 + 
i
 + 0] << 24;

675 
blocks
 |ğ
fÜm©s
 [4 + 
i
 + 1] << 16;

676 
blocks
 |ğ
fÜm©s
 [4 + 
i
 + 2] << 8;

677 
blocks
 |ğ
fÜm©s
 [4 + 
i
 + 3];

678 
nwa
 = 
fÜm©s
 [4 + 5] << 16 | formats [4 + 6] << 8 | formats [4 + 7];

679 ià(
nwa
 > 2048) {

680 
blocks
 *ğ
nwa
 / 2048;

681 } ià(
nwa
 < 2048) {

682 
blocks
 /ğ2048 / 
nwa
;

685 
»tv®
 = 0;

690 
blocks
 = 
fÜm©s
 [4 + 0] << 24;

691 
blocks
 |ğ
fÜm©s
 [4 + 1] << 16;

692 
blocks
 |ğ
fÜm©s
 [4 + 2] << 8;

693 
blocks
 |ğ
fÜm©s
 [4 + 3];

694 
nwa
 = 
fÜm©s
 [4 + 5] << 16 | formats [4 + 6] << 8 | formats [4 + 7];

695 ià(
nwa
 > 2048) {

696 
blocks
 *ğ
nwa
 / 2048;

697 } ià(
nwa
 < 2048) {

698 
blocks
 /ğ2048 / 
nwa
;

701 
»tv®
 = 0;

712 
	`scsi_commªd_š™
 (
cmd
, 0, 0x52);

713 
	`scsi_commªd_š™
 (
cmd
, 1, 1);

714 
	`scsi_commªd_š™
 (
cmd
, 4, 
Ãxt_Œack
 >> 8);

715 
	`scsi_commªd_š™
 (
cmd
, 5, 
Ãxt_Œack
 & 0xFF);

716 
	`scsi_commªd_š™
 (
cmd
, 8,  (
buf
));

717 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

718 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
buf
,  (buf))) {

720 ià(
Ãxt_Œack
 > 0) {

721 
dÚe
;

723 
Ãxt_Œack
 = 1;

724 
»Œy
;

728 
blocks
 = 
buf
 [24] << 24;

729 
blocks
 |ğ
buf
 [25] << 16;

730 
blocks
 |ğ
buf
 [26] << 8;

731 
blocks
 |ğ
buf
 [27];

733 
»tv®
 = 0;

737 
blocks
 = 
fÜm©s
 [4 + 0] << 24;

738 
blocks
 |ğ
fÜm©s
 [4 + 1] << 16;

739 
blocks
 |ğ
fÜm©s
 [4 + 2] << 8;

740 
blocks
 |ğ
fÜm©s
 [4 + 3];

743 
blocks
 = 0;

747 
dÚe
:

748 
	`scsi_commªd_ä“
 (
cmd
);

750 ià(
size
) {

751 *
size
 = 
blocks
 * 2048;

754  
»tv®
;

755 
	}
}

758 
	$g‘_disc_ÿ·c™y_fÜ_ty³
 (
fd
,

759 
ty³
,

760 
gušt64
 *
size
)

762 
»tv®
;

764 
»tv®
 = -1;

766 
ty³
) {

768 
»tv®
 = 
	`g‘_disc_ÿ·c™y_cd
 (
fd
, 
size
);

772 
»tv®
 = 
	`g‘_disc_ÿ·c™y_cdr
 (
fd
, 
size
);

775 
»tv®
 = 
	`g‘_disc_ÿ·c™y_cd
 (
fd
, 
size
);

786 
»tv®
 = 
	`g‘_disc_ÿ·c™y_dvdr_äom_ty³
 (
fd
, 
ty³
, 
size
);

789 
»tv®
 = -1;

792  
»tv®
;

793 
	}
}

797 
	$g‘_mmc_´ofe
 (
fd
, * 
isbÏnk
)

799 
ScsiCommªd
 * 
cmd
;

800 
»tv®
 = -1;

801 
fÜm©s
[260],
disc_šfo
[32];

802 
·ge
[20];

803 
buf
[8],
šq
[128];

804 
´ofe
=0,
Úû
=1,
bÏnk
=0,
”r
,
”a§bË
=0;

805 
Ën
;

807 
cmd
 = 
	`scsi_commªd_Ãw_äom_fd
 (
fd
);

810 
	`mem£t
 (&
·ge
, 0,  (page));

811 
	`mem£t
 (&
buf
, 0,  (buf));

812 
	`mem£t
 (&
šq
, 0,  (inq));

813 
	`mem£t
 (&
disc_šfo
, 0,  (disc_info));

814 
	`mem£t
 (&
fÜm©s
, 0,  (formats));

822 
	`scsi_commªd_š™
(
cmd
,0,0x12);

823 
	`scsi_commªd_š™
(
cmd
,4,36);

824 
	`scsi_commªd_š™
(
cmd
,5,0);

825 ià((
”r
=
	`scsi_commªd_Œª¥Üt
(
cmd
,
READ
,
šq
,36))) {

827 
ba
;

831 ià((
šq
[0]&0x1F) != 5) {

832 
	`årštf
 (
¡d”r
, "Could‚ot determine drive…rofile:‚ot‡n MMC unit!\n");

833 
ba
;

837 
	`scsi_commªd_š™
(
cmd
,0,0x46);

838 
	`scsi_commªd_š™
(
cmd
,8,(
buf
));

839 
	`scsi_commªd_š™
(
cmd
,9,0);

840 ià((
”r
=
	`scsi_commªd_Œª¥Üt
(
cmd
,
READ
,
buf
,(buf)))) {

846 ià((
´ofe
 = 
buf
[6]<<8|buf[7]è|| !
Úû
) ;

850 
	`scsi_commªd_š™
(
cmd
,0,0);

851 
	`scsi_commªd_š™
(
cmd
,5,0);

852 ià((
	`scsi_commªd_Œª¥Üt
(
cmd
,
READ
,
buf
,(buf))&0xFFF00) != 0x23A00) ;

855 
	`scsi_commªd_š™
(
cmd
,0,0x1B);

856 
	`scsi_commªd_š™
(
cmd
,4,0x3);

857 
	`scsi_commªd_š™
(
cmd
,5,0);

858 ià((
”r
=
	`scsi_commªd_Œª¥Üt
(
cmd
,
READ
,
buf
,(buf)))) {

860 
	`årštf
 (
¡d”r
, "Could‚ot determine drive…rofile: Error†oading driveray\n");

861 
ba
;

865 } 
Úû
--);

867 
	`scsi_commªd_š™
(
cmd
,0,0x51);

868 
	`scsi_commªd_š™
(
cmd
,8,(
disc_šfo
));

869 
	`scsi_commªd_š™
(
cmd
,9,0);

870 ià((
”r
=
	`scsi_commªd_Œª¥Üt
(
cmd
,
READ
,
disc_šfo
,(disc_info)))) {

872 
	`årštf
 (
¡d”r
, "Could‚Ù fuÎy d‘”mšdriv´of%x: E¼Ü„—dšg disøšfÜm©iÚ\n", 
´ofe
);

873 
ba
;

877 ià((
disc_šfo
[2]&3è=ğ0è
bÏnk
=1;

879 ià(!
´ofe
 ) {

884 
”a§bË
 = ((
disc_šfo
[2] & 16));

885 ià(
bÏnk
 && !
”a§bË
) {

886 
´ofe
 = 0x09;

887 } ià(
”a§bË
) {

888 
´ofe
 = 0x0a;

889 } ià(
disc_šfo
[8] == 0x00) {

890 
´ofe
 = 0x08;

892 
	`årštf
 (
¡d”r
, "Could‚ot determine…rofile orype of media\n");

893 
ba
;

897 ià((
´ofe
 != 0x1A &&…rofile != 0x13 &&…rofile != 0x12)) {

898 
»tv®
 = 
´ofe
;

901 
	`scsi_commªd_š™
(
cmd
,0,0x23);

902 
	`scsi_commªd_š™
(
cmd
,8,12);

903 
	`scsi_commªd_š™
(
cmd
,9,0);

904 ià((
”r
=
	`scsi_commªd_Œª¥Üt
(
cmd
,
READ
,
fÜm©s
,12))) {

906 
	`årštf
 (
¡d”r
, "Could‚ot determine drive…rofile: "

908 
ba
;

911 
Ën
 = 
fÜm©s
[3];

912 ià(
Ën
&7 ||†en<16) {

913 
	`årštf
 (
¡d”r
, "Could‚ot determine drive…rofile: "

915 
ba
;

918 
	`scsi_commªd_š™
(
cmd
,0,0x23);

919 
	`scsi_commªd_š™
(
cmd
,7,(4+
Ën
)>>8);

920 
	`scsi_commªd_š™
(
cmd
,8,(4+
Ën
)&0xFF);

921 
	`scsi_commªd_š™
(
cmd
,9,0);

922 ià((
”r
=
	`scsi_commªd_Œª¥Üt
(
cmd
,
READ
,
fÜm©s
,4+
Ën
))) {

924 
	`årštf
 (
¡d”r
, "Could‚ot determine drive…rofile: "

926 
ba
;

929 ià(
Ën
 !ğ
fÜm©s
[3]) {

930 
	`årštf
 (
¡d”r
, "Could‚ot determine drive…rofile: "

932 
ba
;

936 ià((
fÜm©s
[8]&3è!ğ2è
bÏnk
 = 1;

938 
»tv®
 = 
´ofe
;

942 iàĞ
»tv®
 != -1 ) {

943 *
isbÏnk
 = 
bÏnk
;

945 
ba
:

946  
»tv®
;

947 
	}
}

950 
	$g‘_disc_ty³
 (
fd
)

952 
ScsiCommªd
 *
cmd
;

953 
»tv®
 = -1;

954 
h—d”
[8];

956 
cmd
 = 
	`scsi_commªd_Ãw_äom_fd
 (
fd
);

958 
	`scsi_commªd_š™
 (
cmd
, 0, 0x46);

959 
	`scsi_commªd_š™
 (
cmd
, 1, 1);

960 
	`scsi_commªd_š™
 (
cmd
, 8, 8);

961 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

962 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
h—d”
, 8)) {

963 
isbÏnk
;

965 
	`scsi_commªd_ä“
 (
cmd
);

967 
»tv®
 = 
	`g‘_mmc_´ofe
(
fd
,&
isbÏnk
);

968  
»tv®
;

971 
»tv®
 = (
h—d”
[6]<<8)|(header[7]);

973 
	`scsi_commªd_ä“
 (
cmd
);

974  
»tv®
;

975 
	}
}

979 
	$disc_is_­³ndabË
 (
fd
)

981 
ScsiCommªd
 *
cmd
;

982 
»tv®
 = -1;

983 
h—d”
[32];

985 
cmd
 = 
	`scsi_commªd_Ãw_äom_fd
 (
fd
);

988 
	`scsi_commªd_š™
 (
cmd
, 0, 0x51);

989 
	`scsi_commªd_š™
 (
cmd
, 8, 32);

990 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

991 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
h—d”
, 32)) {

993 
	`scsi_commªd_ä“
 (
cmd
);

997 
»tv®
 = ((
h—d”
[2]&0x03) == 0x01);

999 
	`scsi_commªd_ä“
 (
cmd
);

1000  
»tv®
;

1001 
	}
}

1004 
	$disc_is_»wr™abË
 (
fd
)

1006 
ScsiCommªd
 *
cmd
;

1007 
»tv®
 = -1;

1008 
h—d”
[32];

1010 
cmd
 = 
	`scsi_commªd_Ãw_äom_fd
 (
fd
);

1013 
	`scsi_commªd_š™
 (
cmd
, 0, 0x51);

1014 
	`scsi_commªd_š™
 (
cmd
, 8, 32);

1015 
	`scsi_commªd_š™
 (
cmd
, 9, 0);

1016 ià(
	`scsi_commªd_Œª¥Üt
 (
cmd
, 
READ
, 
h—d”
, 32)) {

1018 
	`scsi_commªd_ä“
 (
cmd
);

1022 
»tv®
 = ((
h—d”
[2]&0x10) != 0);

1024 
	`scsi_commªd_ä“
 (
cmd
);

1025  
»tv®
;

1026 
	}
}

	@hald/linux/probing/linux_dvd_rw_utils.h

9 #iâdeà
LINUX_DVD_RW_UTILS_H


10 
	#LINUX_DVD_RW_UTILS_H


	)

12 
	~<glib.h
>

14 
	#DRIVE_CDROM_CAPS_DVDRW
 1

	)

15 
	#DRIVE_CDROM_CAPS_DVDRDL
 2

	)

16 
	#DRIVE_CDROM_CAPS_DVDPLUSR
 4

	)

17 
	#DRIVE_CDROM_CAPS_DVDPLUSRW
 8

	)

18 
	#DRIVE_CDROM_CAPS_DVDPLUSRWDL
 16

	)

19 
	#DRIVE_CDROM_CAPS_DVDPLUSRDL
 32

	)

20 
	#DRIVE_CDROM_CAPS_BDROM
 64

	)

21 
	#DRIVE_CDROM_CAPS_BDR
 128

	)

22 
	#DRIVE_CDROM_CAPS_BDRE
 256

	)

23 
	#DRIVE_CDROM_CAPS_HDDVDROM
 512

	)

24 
	#DRIVE_CDROM_CAPS_HDDVDR
 1024

	)

25 
	#DRIVE_CDROM_CAPS_HDDVDRW
 2048

	)

28 
g‘_dvd_r_rw_´ofe
 (
fd
);

29 
g‘_»ad_wr™e_¥“d
 (
fd
, *
»ad_¥“d
, *
wr™e_¥“d
, **
wr™e_¥“ds
);

30 
g‘_disc_ÿ·c™y_fÜ_ty³
 (
fd
, 
ty³
, 
gušt64
 *
ÿ·c™y
);

31 
g‘_disc_ty³
 (
fd
);

32 
disc_is_­³ndabË
 (
fd
);

33 
disc_is_»wr™abË
 (
fd
);

	@hald/linux/probing/probe-hiddev.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

31 
	~<asm/ty³s.h
>

32 
	~<fú.h
>

33 
	~<lšux/hiddev.h
>

34 
	~<¡dšt.h
>

35 
	~<¡dio.h
>

36 
	~<¡dlib.h
>

37 
	~<sys/ioùl.h
>

38 
	~<uni¡d.h
>

40 
	~"libh®/libh®.h
"

43 
	$maš
 (
¬gc
, *
¬gv
[])

45 
fd
;

46 
»t
;

47 *
udi
;

48 *
deviû_fe
;

49 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

50 
DBusE¼Ü
 
”rÜ
;

51 
Çme
[256] = "Unknown HID device";

52 
i
;

53 
hiddev_devšfo
 
deviû_šfo
;

55 
fd
 = -1;

58 
»t
 = 1;

60 
udi
 = 
	`g‘’v
 ("UDI");

61 ià(
udi
 =ğ
NULL
)

62 
out
;

64 
	`dbus_”rÜ_š™
 (&
”rÜ
);

65 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
)

66 
out
;

68 
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_HIDDEV_DEVICE");

69 ià(
deviû_fe
 =ğ
NULL
)

70 
out
;

72 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
);

73 ià(
fd
 < 0)

74 
out
;

76 ià(
	`ioùl
 (
fd
, 
	`HIDIOCGNAME
( (
Çme
)),‚ame) >= 0) {

77 ià(!
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
ùx
, 
udi
, "hiddev.´oduù", 
Çme
, &
”rÜ
))

78 
out
;

79 ià(!
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
ùx
, 
udi
, "šfo.´oduù", 
Çme
, &
”rÜ
))

80 
out
;

83 ià(
	`ioùl
 (
fd
, 
HIDIOCGDEVINFO
, &
deviû_šfo
) < 0)

84 
out
;

86 
i
 = 0; i < 
deviû_šfo
.
num_­¶iÿtiÚs
; i++) {

87 
­¶
;

88 cÚ¡ *
­¶_Çme
;

89 
buf
[256];

91 ià((
­¶
 = 
	`ioùl
(
fd
, 
HIDIOCAPPLICATION
, 
i
)) < 0)

92 
out
;

95 
­¶
 >> 16)

98 
­¶_Çme
 = "Generic Desktop Page";

101 
­¶_Çme
 = "Consumer Product Page";

104 
­¶_Çme
 = "USB Monitor Page";

107 
­¶_Çme
 = "USB Enumerated Values Page";

110 
­¶_Çme
 = "VESA Virtual Controls Page";

113 
­¶_Çme
 = "Reserved Monitor Page";

116 
­¶_Çme
 = "Power Device Page";

119 
­¶_Çme
 = "Battery System Page";

123 
­¶_Çme
 = "Reserved Power Device Page";

126 
	`¢´štf
 (
buf
,  (buf), "UnknowÀ·g0x%02x", 
­¶
);

127 
­¶_Çme
 = 
buf
;

130 ià(!
	`libh®_deviû_´İ”ty_¡¾i¡_­³nd
 (
ùx
, 
udi
, "hiddev.­¶iÿtiÚ_·ges", 
­¶_Çme
, &
”rÜ
))

131 
out
;

135 
DBusCÚÃùiÚ
 *
cÚn
;

137 ià(
	`fÜk
 () == 0) {

138 
	`¦“p
 (10);

140 
	`dbus_”rÜ_š™
 (&
”rÜ
);

141 ià((
cÚn
 = 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
)è=ğ
NULL
)

142 
out
;

144 ià((
ùx
 = 
	`libh®_ùx_Ãw
 ()è=ğ
NULL
)

145 
out
;

146 ià(!
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
ùx
, 
cÚn
))

147 
out
;

148 ià(!
	`libh®_ùx_š™
 (
ùx
, &
”rÜ
))

149 
out
;

151 
	`maš2
 (
ùx
, "/Üg/ä“desktİ/H®/deviûs/usb_deviû_51d_2_QB0435136106 _if0_hiddev", 
fd
);

154 
	`¦“p
 (2);

158 
»t
 = 0;

160 
out
:

161 ià(
fd
 >= 0)

162 
	`şo£
 (
fd
);

164 ià(
ùx
 !ğ
NULL
) {

165 
	`dbus_”rÜ_š™
 (&
”rÜ
);

166 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

167 
	`libh®_ùx_ä“
 (
ùx
);

170  
»t
;

171 
	}
}

	@hald/linux/probing/probe-ieee1394-unit.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<¡dlib.h
>

31 
	~<¡dio.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<fú.h
>

35 
	~<sys/ioùl.h
>

36 
	~<sys/pŞl.h
>

37 
	~<sys/mmª.h
>

38 
	~<asm/ty³s.h
>

39 
	~<”ºo.h
>

40 
	~<¡ršg.h
>

41 
	~<time.h
>

43 
	~"../../logg”.h
"

44 
	~"libh®/libh®.h
"

48 
	#TCODE_WRITE_BLOCK_REQUEST
 1

	)

49 
	#RCODE_COMPLETE
 0x0

	)

50 
	#RCODE_TYPE_ERROR
 0x6

	)

52 
	#FW_CDEV_EVENT_BUS_RESET
 0x00

	)

53 
	#FW_CDEV_EVENT_RESPONSE
 0x01

	)

54 
	#FW_CDEV_EVENT_REQUEST
 0x02

	)

55 
	#FW_CDEV_EVENT_ISO_INTERRUPT
 0x03

	)

57 
	sfw_cdev_ev’t_bus_»£t
 {

58 
__u64
 
	mşosu»
;

59 
__u32
 
	mty³
;

60 
__u32
 
	mnode_id
;

61 
__u32
 
	mloÿl_node_id
;

62 
__u32
 
	mbm_node_id
;

63 
__u32
 
	mœm_node_id
;

64 
__u32
 
	mroÙ_node_id
;

65 
__u32
 
	mg’”©iÚ
;

68 
	sfw_cdev_ev’t_»¥Ú£
 {

69 
__u64
 
	mşosu»
;

70 
__u32
 
	mty³
;

71 
__u32
 
	mrcode
;

72 
__u32
 
	mËngth
;

73 
__u32
 
	md©a
[0];

76 
	sfw_cdev_ev’t_»que¡
 {

77 
__u64
 
	mşosu»
;

78 
__u32
 
	mty³
;

79 
__u32
 
	mtcode
;

80 
__u64
 
	moff£t
;

81 
__u32
 
	mhªdË
;

82 
__u32
 
	mËngth
;

83 
__u32
 
	md©a
[0];

86 
	#FW_CDEV_IOC_GET_INFO
 
	`_IOWR
('#', 0x00, 
fw_cdev_g‘_šfo
)

	)

87 
	#FW_CDEV_IOC_SEND_REQUEST
 
	`_IOW
('#', 0x01, 
fw_cdev_£nd_»que¡
)

	)

88 
	#FW_CDEV_IOC_ALLOCATE
 
	`_IOWR
('#', 0x02, 
fw_cdev_®loÿ‹
)

	)

89 
	#FW_CDEV_IOC_DEALLOCATE
 
	`_IOW
('#', 0x03, 
fw_cdev_d—Îoÿ‹
)

	)

90 
	#FW_CDEV_IOC_SEND_RESPONSE
 
	`_IOW
('#', 0x04, 
fw_cdev_£nd_»¥Ú£
)

	)

96 
	#FW_CDEV_VERSION
 1

	)

98 
	sfw_cdev_g‘_šfo
 {

99 
__u32
 
	mv”siÚ
;

100 
__u32
 
	mrom_Ëngth
;

101 
__u64
 
	mrom
;

102 
__u64
 
	mbus_»£t
;

103 
__u64
 
	mbus_»£t_şosu»
;

104 
__u32
 
	mÿrd
;

107 
	sfw_cdev_£nd_»que¡
 {

108 
__u32
 
	mtcode
;

109 
__u32
 
	mËngth
;

110 
__u64
 
	moff£t
;

111 
__u64
 
	mşosu»
;

112 
__u64
 
	md©a
;

113 
__u32
 
	mg’”©iÚ
;

116 
	sfw_cdev_£nd_»¥Ú£
 {

117 
__u32
 
	mrcode
;

118 
__u32
 
	mËngth
;

119 
__u64
 
	md©a
;

120 
__u32
 
	mhªdË
;

123 
	sfw_cdev_®loÿ‹
 {

124 
__u64
 
	moff£t
;

125 
__u64
 
	mşosu»
;

126 
__u32
 
	mËngth
;

127 
__u32
 
	mhªdË
;

130 
	sfw_cdev_d—Îoÿ‹
 {

131 
__u32
 
	mhªdË
;

137 
	#ARRAY_LENGTH
(
a
è(×)/(×)[0]))

	)

139 
	#±r_to_u64
(
p
è((
__u64
)()Õ))

	)

140 
	#u64_to_±r
(
p
è((*)()Õ))

	)

142 
	#CSR_FCP_COMMAND
 0xfffff0000b00uÎ

	)

143 
	#CSR_FCP_RESPONSE
 0xfffff0000d00uÎ

	)

145 
	savc_äame
 {

146 
	mùy³
 : 4;

147 
	mùs
 : 4;

148 
	msubun™_id
 : 3;

149 
	msubun™_ty³
 : 5;

150 
	mİcode
 : 8;

151 
	mİ”ªd0
 : 8;

155 
	mCTS_AVC


160 
	mAVC_COMMAND_CONTROL
,

161 
	mAVC_COMMAND_STATUS
,

162 
	mAVC_COMMAND_SPECIFIC_INQUIRY
,

163 
	mAVC_COMMAND_NOTIFY
,

164 
	mAVC_COMMAND_GENERAL_INQUIRY
,

165 
	mAVC_RESPONSE_NOT_IMPLEMENTED
 = 0x08,

166 
	mAVC_RESPONSE_ACCEPTED
,

167 
	mAVC_RESPONSE_REJECTED
,

168 
	mAVC_RESPONSE_IN_TRANSITION
,

169 
	mAVC_RESPONSE_STABLE
,

170 
	mAVC_RESPONSE_CHANGED
,

171 
	mAVC_RESPONSE_INTERIM
 = 0x0f

175 
	mAVC_SUBUNIT_MONITOR
,

176 
	mAVC_SUBUNIT_AUDIO
,

177 
	mAVC_SUBUNIT_PRINTER
,

178 
	mAVC_SUBUNIT_DISC
,

179 
	mAVC_SUBUNIT_TAPE_RECORDER_PLAYER
,

180 
	mAVC_SUBUNIT_TUNER
,

181 
	mAVC_SUBUNIT_CA
,

182 
	mAVC_SUBUNIT_CAMERA
,

183 
	mAVC_SUBUNIT_PANEL
 = 0x09,

184 
	mAVC_SUBUNIT_BULLETIN_BOARD
,

185 
	mAVC_SUBUNIT_CAMERA_STORAGE
,

186 
	mAVC_SUBUNIT_VENDOR_UNIQUE
 = 0x1c,

187 
	mAVC_SUBUNIT_ALL
,

188 
	mAVC_SUBUNIT_EXTENDED
,

189 
	mAVC_SUBUNIT_UNIT


192 cÚ¡ * cÚ¡ 
	gun™_Çmes
[] = {

201 
NULL
,

208 
	mAVC_OPCODE_UNIT_INFO
 = 0x30,

209 
	mAVC_OPCODE_SUBUNIT_INFO
 = 0x31,

213 
	mAVC_SUBUNIT_ID_UNIT
 = 0x07,

216 cÚ¡ *
	gudi
 = 
NULL
;

217 
LibH®CÚ‹xt
 *
	gùx
 = 
NULL
;

221 
	$£nd_»¥Ú£
 (
fd
, 
__u32
 
hªdË
, 
rcode
, *
d©a
, 
size_t
 
Ëngth
)

223 
fw_cdev_£nd_»¥Ú£
 
»¥Ú£
;

225 
»¥Ú£
.
Ëngth
 =†ength;

226 
»¥Ú£
.
hªdË
 = handle;

227 
»¥Ú£
.
rcode
 =„code;

228 
»¥Ú£
.
d©a
 = 
	`±r_to_u64
(data);

230 ià(
	`ioùl
 (
fd
, 
FW_CDEV_IOC_SEND_RESPONSE
, &
»¥Ú£
) < 0) {

231 
	`HAL_ERROR
 (("çedØ£nd„e¥Ú£: %s", 
	`¡»¼Ü
 (
”ºo
)));

234 
	}
}

237 
	$hªdË_»que¡
 (
fd
, 
fw_cdev_ev’t_»que¡
 *
»que¡
)

240 
avc_äame
 
äame
;

241 
İ”ªds
[8];

242 } *
»¥Ú£
;

243 
un™_ty³
;

244 
ÿ²ame
[256];

245 
i
;

247 ià(
»que¡
->
tcode
 !ğ
TCODE_WRITE_BLOCK_REQUEST
 ||

248 
»que¡
->
off£t
 !ğ
CSR_FCP_RESPONSE
) {

249 
	`£nd_»¥Ú£
 (
fd
, 
»que¡
->
hªdË
, 
RCODE_TYPE_ERROR
, 
NULL
, 0);

250 
	`HAL_ERROR
 (("AVC„esponseo wrong‡ddress"));

254 
	`£nd_»¥Ú£
 (
fd
, 
»que¡
->
hªdË
, 
RCODE_COMPLETE
, 
NULL
, 0);

256 
»¥Ú£
 = (*è
»que¡
->
d©a
;

257 ià(
»¥Ú£
->
äame
.
ùs
 !ğ
CTS_AVC
) {

258 
	`HAL_ERROR
 (("not‡n fcp„esponse"));

262 ià(
»¥Ú£
->
äame
.
ùy³
 =ğ
AVC_RESPONSE_INTERIM
) {

263 
	`HAL_ERROR
 (("got interim"));

269 
i
 = 0; i < 4; i++) {

270 ià(
»¥Ú£
->
İ”ªds
[
i
] == 0xff)

273 
un™_ty³
 = 
»¥Ú£
->
İ”ªds
[
i
] >> 3;

274 ià(
un™_ty³
 > 
	`ARRAY_LENGTH
(
un™_Çmes
) ||

275 
un™_Çmes
[
un™_ty³
] =ğ
NULL
) {

276 
	`HAL_ERROR
 (("unknown unitype"));

280 
	`¢´štf
 (
ÿ²ame
,  (capname),

281 "›“1394_un™.avc.%s", 
un™_Çmes
[
un™_ty³
]);

282 
	`libh®_deviû_add_ÿ·b™y
 (
ùx
, 
udi
, 
ÿ²ame
, 
NULL
);

286 
	}
}

289 
	#AVC_TIMEOUT
 200

	)

292 
	$g‘_subun™_šfo
 (
fd
, 
g’”©iÚ
)

295 
avc_äame
 
äame
;

296 
İ”ªds
[8];

297 } 
·ylßd
;

298 
fw_cdev_£nd_»que¡
 
»que¡
;

300 
fw_cdev_ev’t_»¥Ú£
 
»¥Ú£
;

301 
fw_cdev_ev’t_»que¡
 
»que¡
;

302 
__u8
 
bufãr
[64];

303 } 
u
;

304 
pŞlfd
 
fds
[1];

306 
»que¡
.
tcode
 = 
TCODE_WRITE_BLOCK_REQUEST
;

307 
»que¡
.
off£t
 = 
CSR_FCP_COMMAND
;

308 
»que¡
.
Ëngth
 = 8;

309 
»que¡
.
g’”©iÚ
 = generation;

310 
»que¡
.
d©a
 = 
	`±r_to_u64
(&
·ylßd
);

312 
·ylßd
.
äame
.
ùs
 = 
CTS_AVC
;

313 
·ylßd
.
äame
.
ùy³
 = 
AVC_COMMAND_STATUS
;

314 
·ylßd
.
äame
.
subun™_ty³
 = 
AVC_SUBUNIT_UNIT
;

315 
·ylßd
.
äame
.
subun™_id
 = 
AVC_SUBUNIT_ID_UNIT
;

316 
·ylßd
.
äame
.
İcode
 = 
AVC_OPCODE_SUBUNIT_INFO
;

317 
·ylßd
.
äame
.
İ”ªd0
 = 0xff;

318 
·ylßd
.
İ”ªds
[0] = 0xff;

319 
·ylßd
.
İ”ªds
[1] = 0xff;

320 
·ylßd
.
İ”ªds
[2] = 0xff;

321 
·ylßd
.
İ”ªds
[3] = 0xff;

323 ià(
	`ioùl
 (
fd
, 
FW_CDEV_IOC_SEND_REQUEST
, &
»que¡
) < 0) {

324 
	`HAL_ERROR
 (("çedØwr™»que¡: %s", 
	`¡»¼Ü
 (
”ºo
)));

328 
fds
[0].
fd
 = fd;

329 
fds
[0].
ev’ts
 = 
POLLIN
;

331 
TRUE
) {

332 ià(
	`pŞl
 (
fds
, 1, 
AVC_TIMEOUT
) < 0) {

333 
	`HAL_ERROR
 (("pŞÈ”rÜ: %s", 
	`¡»¼Ü
 (
”ºo
)));

337 ià(
fds
[0].
»v’ts
 == 0) {

338 
	`HAL_ERROR
 (("timeout"));

342 ià(
	`»ad
 (
fd
, &
u
,  u) < 0) {

343 
	`HAL_ERROR
 (("»ad faed: %s", 
	`¡»¼Ü
 (
”ºo
)));

347 
u
.
»¥Ú£
.
ty³
) {

348 
FW_CDEV_EVENT_RESPONSE
:

349 ià(
u
.
»¥Ú£
.
rcode
 !ğ
RCODE_COMPLETE
) {

352 
	`HAL_ERROR
 (("not AVC device?"));

356 
FW_CDEV_EVENT_REQUEST
:

357 ià(
	`hªdË_»que¡
(
fd
, &
u
.
»que¡
) == 0)

363 
FW_CDEV_EVENT_BUS_RESET
:

364 
	`HAL_ERROR
 (("bus„eset"));

368 
	`HAL_ERROR
 (("unexpectedƒvent, shouldn't happen"));

372 
	}
}

374 
	$maš
 (
¬gc
, *
¬gv
[])

376 
i
;

377 
fd
;

378 
»t
;

379 
fw_cdev_g‘_šfo
 
g‘_šfo
;

380 
fw_cdev_ev’t_bus_»£t
 
bus_»£t
;

381 
fw_cdev_®loÿ‹
 
»que¡
;

382 cÚ¡ *
deviû_fe
;

383 cÚ¡ *
›“1394_udi
;

384 
DBusE¼Ü
 
”rÜ
;

387 
»t
 = 1;

389 
	`£tup_logg”
 ();

391 
udi
 = 
	`g‘’v
 ("UDI");

392 ià(
udi
 =ğ
NULL
)

393 
out
;

395 
›“1394_udi
 = 
	`g‘’v
 ("HAL_PROP_IEEE1394_UNIT_ORIGINATING_DEVICE");

396 ià(
›“1394_udi
 =ğ
NULL
)

397 
out
;

399 
	`dbus_”rÜ_š™
 (&
”rÜ
);

400 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
)

401 
out
;

403 
deviû_fe
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
ùx
, 
›“1394_udi
, "›“1394.deviû", &
”rÜ
);

404 ià(
deviû_fe
 =ğ
NULL
)

405 
out
;

407 
	`HAL_INFO
 (("Inve¡ig©šg '%s'", 
deviû_fe
));

409 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDWR
);

410 ià(
fd
 < 0) {

411 
	`HAL_ERROR
 (("çedØİ’ %s: %s", 
deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

412 
out
;

415 
g‘_šfo
.
v”siÚ
 = 
FW_CDEV_VERSION
;

416 
g‘_šfo
.
rom
 = 0;

417 
g‘_šfo
.
rom_Ëngth
 = 0;

418 
g‘_šfo
.
bus_»£t
 = 
	`±r_to_u64
(&bus_reset);

419 ià(
	`ioùl
(
fd
, 
FW_CDEV_IOC_GET_INFO
, &
g‘_šfo
) < 0) {

420 
	`HAL_ERROR
 (("g‘ cÚfig„om ioùl: %s", 
	`¡»¼Ü
(
”ºo
)));

421 
out
;

424 
»que¡
.
off£t
 = 
CSR_FCP_RESPONSE
;

425 
»que¡
.
Ëngth
 = 0x200;

426 
»que¡
.
şosu»
 = 0;

427 ià(
	`ioùl
 (
fd
, 
FW_CDEV_IOC_ALLOCATE
, &
»que¡
) < 0) {

428 
	`HAL_ERROR
 (("failedo‡llocate fcp„esponse‡rea: %s",

429 
	`¡»¼Ü
 (
”ºo
)));

430 
out
;

434 
i
 = 0; i < 3; i++) {

435 ià(
	`g‘_subun™_šfo
(
fd
, 
bus_»£t
.
g’”©iÚ
) == 0)

437 
	`pŞl
 (
NULL
, 0, 500);

440 
	`şo£
(
fd
);

442 
»t
 = 0;

444 
out
:

445  
»t
;

446 
	}
}

	@hald/linux/probing/probe-input.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~"../šput_loÿl.h
"

33 
	~<”ºo.h
>

34 
	~<fú.h
>

35 
	~<¡dšt.h
>

36 
	~<¡dio.h
>

37 
	~<¡dlib.h
>

38 
	~<¡ršg.h
>

39 
	~<uni¡d.h
>

41 
	~"libh®/libh®.h
"

42 
	~"../../logg”.h
"

45 
	#BITS_PER_LONG
 ((è* 8)

	)

46 
	#NBITS
(
x
è((((x)-1)/
BITS_PER_LONG
)+1)

	)

47 
	#OFF
(
x
è((x)%
BITS_PER_LONG
)

	)

48 
	#BIT
(
x
è(1UL<<
	`OFF
(x))

	)

49 
	#LONG
(
x
è((x)/
BITS_PER_LONG
)

	)

50 
	#‹¡_b™
(
b™
, 
¬¿y
è(×¼ay[
	`LONG
(b™)] >> 
	`OFF
(b™)è& 1)

	)

53 
	$maš
 (
¬gc
, *
¬gv
[])

55 
fd
;

56 
»t
;

57 *
udi
;

58 *
deviû_fe
;

59 *
bu‰Ú_ty³
;

60 
sw
;

61 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

62 
DBusE¼Ü
 
”rÜ
;

63 
b™mask
[
	`NBITS
(
SW_MAX
)];

66 
»t
 = 1;

67 
fd
 = -1;

69 
	`£tup_logg”
 ();

71 
bu‰Ú_ty³
 = 
	`g‘’v
 ("HAL_PROP_BUTTON_TYPE");

72 ià(
bu‰Ú_ty³
 =ğ
NULL
)

73 
out
;

75 
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_INPUT_DEVICE");

76 ià(
deviû_fe
 =ğ
NULL
)

77 
out
;

79 
udi
 = 
	`g‘’v
 ("UDI");

80 ià(
udi
 =ğ
NULL
)

81 
out
;

83 
	`dbus_”rÜ_š™
 (&
”rÜ
);

84 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
)

85 
out
;

87 
	`HAL_DEBUG
 (("Došg…robe-špuˆfÜ % (udi=%s)", 
deviû_fe
, 
udi
));

89 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
);

90 ià(
fd
 < 0) {

91 
	`HAL_ERROR
 (("CªnÙ o³À%s: %s", 
deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

92 
out
;

95 ià(
	`ioùl
 (
fd
, 
	`EVIOCGSW
( (
b™mask
)), bitmask) < 0) {

96 
	`HAL_DEBUG
 (("ioctl EVIOCGSW failed"));

97 
out
;

100 ià(
	`¡rcmp
 (
bu‰Ú_ty³
, "lid") == 0)

101 
sw
 = 
	`‹¡_b™
 (
SW_LID
, 
b™mask
);

102 ià(
	`¡rcmp
 (
bu‰Ú_ty³
, "tablet_mode") == 0)

103 
sw
 = 
	`‹¡_b™
 (
SW_TABLET_MODE
, 
b™mask
);

104 ià(
	`¡rcmp
 (
bu‰Ú_ty³
, "radio") == 0)

105 
sw
 = 
	`‹¡_b™
 (
SW_RADIO
, 
b™mask
);

106 ià(
	`¡rcmp
 (
bu‰Ú_ty³
, "jack_insert") == 0) {

107 
sw
 = 
	`‹¡_b™
 (
SW_HEADPHONE_INSERT
, 
b™mask
) ||

108 
	`‹¡_b™
 (
SW_MICROPHONE_INSERT
, 
b™mask
) ||

109 
	`‹¡_b™
 (
SW_LINEOUT_INSERT
, 
b™mask
) ||

110 
	`‹¡_b™
 (
SW_VIDEOOUT_INSERT
, 
b™mask
) ||

111 
	`‹¡_b™
 (
SW_JACK_PHYSICAL_INSERT
, 
b™mask
);

113 
out
;

115 
	`dbus_”rÜ_š™
 (&
”rÜ
);

116 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
udi
, "bu‰Ú.¡©e.v®ue", 
sw
, &
”rÜ
);

118 
»t
 = 0;

120 
out
:

121 ià(
fd
 >= 0)

122 
	`şo£
 (
fd
);

124 ià(
ùx
 !ğ
NULL
) {

125 
	`dbus_”rÜ_š™
 (&
”rÜ
);

126 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

127 
	`libh®_ùx_ä“
 (
ùx
);

130  
»t
;

131 
	}
}

	@hald/linux/probing/probe-net-bluetooth.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<¡ršg.h
>

32 
	~"../../logg”.h
"

33 
	~"libh®/libh®.h
"

35 
	#BLUEZ_SERVICE
 "Üg.bluez"

	)

36 
	#BLUEZ_PATH
 "/Üg/bluez"

	)

37 
	#BLUEZ_MANAGER_IFACE
 "Üg.bluez.Mªag”"

	)

38 
	#BLUEZ_NET_PATH
 "/Üg/bluez/ÃtwÜk"

	)

39 
	#BLUEZ_NET_MANAGER_IFACE
 "Üg.bluez.ÃtwÜk.Mªag”"

	)

40 
	#BLUEZ_NET_CONNECTION_IFACE
 "Üg.bluez.ÃtwÜk.CÚÃùiÚ"

	)

41 
	#BLUEZ_NET_SERVER_IFACE
 "Üg.bluez.ÃtwÜk.S”v”"

	)

44 
	$g‘_´İ”t›s
 (
DBusCÚÃùiÚ
 *
cÚn
, 
LibH®ChªgeS‘
 *
cs
,

45 cÚ¡ *
id
, cÚ¡ *
·th
)

47 
DBusMes§ge
 *
msg
;

48 
DBusMes§ge
 *
»¶y
 = 
NULL
;

49 
DBusMes§geI‹r
 
»¶y_™”
;

50 
DBusMes§geI‹r
 
diù_™”
;

51 
DBusE¼Ü
 
”rÜ
;

53 
	`dbus_”rÜ_š™
 (&
”rÜ
);

55 
msg
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 (
id
, 
·th
,

56 
BLUEZ_NET_CONNECTION_IFACE
,

59 ià(
msg
 =ğ
NULL
)

60 
out
;

62 
	`HAL_INFO
 (("%s.G‘Info()", 
BLUEZ_NET_CONNECTION_IFACE
));

63 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
cÚn
, 
msg
, -1, &
”rÜ
);

65 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
è|| 
	`dbus_£t_”rÜ_äom_mes§ge
 (&error,

66 
»¶y
)) {

67 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

68 
out
;

71 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

73 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_ARRAY
 &&

74 
	`dbus_mes§ge_™”_g‘_–em’t_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_DICT_ENTRY
) {

75 
out
;

78 
	`dbus_mes§ge_™”_»cur£
 (&
»¶y_™”
, &
diù_™”
);

80 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
diù_™”
è=ğ
DBUS_TYPE_DICT_ENTRY
) {

81 
DBusMes§geI‹r
 
diù_’Œy_™”
, 
v¬_™”
;

82 cÚ¡ *
key
;

83 
´İ
[32];

85 
	`dbus_mes§ge_™”_»cur£
 (&
diù_™”
, &
diù_’Œy_™”
);

86 
	`dbus_mes§ge_™”_g‘_basic
 (&
diù_’Œy_™”
, &
key
);

88 
	`dbus_mes§ge_™”_Ãxt
 (&
diù_’Œy_™”
);

89 
	`dbus_mes§ge_™”_»cur£
 (&
diù_’Œy_™”
, &
v¬_™”
);

91 
	`¢´štf
(
´İ
,  (´İ), "Ãt.blu‘oÙh.%s", 
key
);

94 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
v¬_™”
)) {

95 
DBUS_TYPE_STRING
:

97 cÚ¡ *
v®ue
;

99 
	`dbus_mes§ge_™”_g‘_basic
 (&
v¬_™”
, &
v®ue
);

101 
	`HAL_INFO
 (("»¶y: %s:%s", 
key
, 
v®ue
));

103 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, 
´İ
, 
v®ue
);

106 
DBUS_TYPE_INT32
:

108 
dbus_št32_t
 
v®ue
;

110 
	`dbus_mes§ge_™”_g‘_basic
 (&
v¬_™”
, &
v®ue
);

112 
	`HAL_INFO
 (("»¶y: %s:%d", 
key
, 
v®ue
));

114 
	`libh®_chªge£t_£t_´İ”ty_št
 (
cs
, 
´İ
, 
v®ue
);

120 
	`dbus_mes§ge_™”_Ãxt
 (&
diù_™”
);

123 
out
:

124 ià(
msg
)

125 
	`dbus_mes§ge_uÄef
 (
msg
);

126 ià(
»¶y
)

127 
	`dbus_mes§ge_uÄef
 (
»¶y
);

129 
	}
}

132 
	$maš
 (
¬gc
, *
¬gv
[])

134 *
udi
;

135 *
içû
;

136 *
id
;

137 cÚ¡ *
cÚÃùiÚ
;

138 
ÃtwÜk
[8] = "network";

139 cÚ¡ *
²‘wÜk
 = 
ÃtwÜk
;

140 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

141 
LibH®ChªgeS‘
 *
cs
 = 
NULL
;

142 
DBusCÚÃùiÚ
 *
cÚn
;

143 
DBusMes§ge
 *
msg
 = 
NULL
;

144 
DBusMes§ge
 *
»¶y
 = 
NULL
;

145 
DBusE¼Ü
 
”rÜ
;

147 
udi
 = 
	`g‘’v
 ("UDI");

148 ià(
udi
 =ğ
NULL
)

149 
out
;

151 
içû
 = 
	`g‘’v
 ("HAL_PROP_NET_INTERFACE");

152 ià(
içû
 =ğ
NULL
)

153 
out
;

155 
	`HAL_INFO
 (("Inve¡ig©šg '%s'", 
içû
));

157 
	`dbus_”rÜ_š™
 (&
”rÜ
);

159 ià((
cÚn
 = 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
)è=ğ
NULL
)

160 
out
;

162 
msg
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 (
BLUEZ_SERVICE
, 
BLUEZ_PATH
, 
BLUEZ_MANAGER_IFACE
, "ActivateService");

164 ià(
msg
 =ğ
NULL
)

165 
out
;

167 
	`HAL_INFO
 (("%s.Aùiv©eS”viû('%s')", 
BLUEZ_MANAGER_IFACE
, 
²‘wÜk
));

168 
	`dbus_mes§ge_­³nd_¬gs
 (
msg
, 
DBUS_TYPE_STRING
, &
²‘wÜk
,

169 
DBUS_TYPE_INVALID
);

170 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
cÚn
, 
msg
, -1, &
”rÜ
);

172 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
è|| 
	`dbus_£t_”rÜ_äom_mes§ge
 (&”rÜ, 
»¶y
)) {

173 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

174 
out
;

177 
	`dbus_mes§ge_uÄef
 (
msg
);

178 
msg
 = 
NULL
;

180 
	`dbus_mes§ge_g‘_¬gs
 (
»¶y
, &
”rÜ
, 
DBUS_TYPE_STRING
, &
id
, 
DBUS_TYPE_INVALID
);

181 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

182 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

183 
out
;

186 
	`dbus_mes§ge_uÄef
 (
»¶y
);

187 
»¶y
 = 
NULL
;

189 
	`HAL_INFO
 (("Found Bluez N‘wÜk s”viû '%s'", 
id
));

191 
msg
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 (
id
, 
BLUEZ_NET_PATH
, 
BLUEZ_NET_MANAGER_IFACE
, "FindConnection");

193 ià(
msg
 =ğ
NULL
)

194 
out
;

196 
	`HAL_INFO
 (("%s.FšdCÚÃùiÚ('%s')", 
BLUEZ_NET_MANAGER_IFACE
, 
içû
));

197 
	`dbus_mes§ge_­³nd_¬gs
 (
msg
, 
DBUS_TYPE_STRING
, &
içû
,

198 
DBUS_TYPE_INVALID
);

199 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
cÚn
, 
msg
, -1, &
”rÜ
);

201 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
è|| 
	`dbus_£t_”rÜ_äom_mes§ge
 (&error,

202 
»¶y
)) {

203 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

204 
out
;

207 
	`dbus_mes§ge_uÄef
 (
msg
);

208 
msg
 = 
NULL
;

210 
	`dbus_mes§ge_g‘_¬gs
 (
»¶y
, &
”rÜ
, 
DBUS_TYPE_STRING
, &
cÚÃùiÚ
,

211 
DBUS_TYPE_INVALID
);

212 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

213 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

214 
out
;

217 
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
);

218 ià(
ùx
 =ğ
NULL
)

219 
out
;

221 
cs
 = 
	`libh®_deviû_Ãw_chªge£t
 (
udi
);

222 ià(
cs
 =ğ
NULL
) {

223 
	`HAL_ERROR
(("Cannot initialize changeset"));

224 
out
;

227 
	`g‘_´İ”t›s
 (
cÚn
, 
cs
, 
id
, 
cÚÃùiÚ
);

229 
out
:

230 ià(
msg
)

231 
	`dbus_mes§ge_uÄef
 (
msg
);

232 ià(
»¶y
)

233 
	`dbus_mes§ge_uÄef
 (
»¶y
);

234 ià(
cs
 !ğ
NULL
) {

235 
	`dbus_”rÜ_š™
 (&
”rÜ
);

236 
	`libh®_deviû_comm™_chªge£t
 (
ùx
, 
cs
, &
”rÜ
);

237 
	`libh®_deviû_ä“_chªge£t
 (
cs
);

239 ià(
ùx
 !ğ
NULL
) {

240 
	`dbus_”rÜ_š™
 (&
”rÜ
);

241 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

242 
	`libh®_ùx_ä“
 (
ùx
);

246 
	}
}

	@hald/linux/probing/probe-pc-floppy.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<fú.h
>

31 
	~<lšux/fd.h
>

32 
	~<lšux/kdev_t.h
>

33 
	~<¡dšt.h
>

34 
	~<¡dio.h
>

35 
	~<¡dlib.h
>

36 
	~<¡ršg.h
>

37 
	~<sys/ioùl.h
>

38 
	~<uni¡d.h
>

40 
	~"libh®/libh®.h
"

42 
	~"../../logg”.h
"

45 
	$maš
 (
¬gc
, *
¬gv
[])

47 
fd
;

48 
»t
;

49 *
deviû_fe
;

50 
Çme
[256];

51 
æİpy_drive_¡ruù
 
ds
;

53 
fd
 = -1;

56 
»t
 = 1;

58 ià(
	`g‘’v
 ("UDI"è=ğ
NULL
)

59 
out
;

60 ià((
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_DEVICE")è=ğ
NULL
)

61 
out
;

63 
	`£tup_logg”
 ();

65 
	`HAL_DEBUG
 (("Checkšg ià% i aùu®ly…»£Á", 
deviû_fe
));

68 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
);

69 ià(
fd
 < 0) {

70 
	`HAL_ERROR
 (("Could‚Ù o³À%s", 
deviû_fe
));

71 
out
;

75 
	`ioùl
 (
fd
, 
FDRESET
, 
NULL
);

76 ià(
	`ioùl
 (
fd
, 
FDGETDRVTYP
, 
Çme
) != 0) {

77 
	`HAL_ERROR
 (("FDGETDRVTYP faed fÜ %s", 
deviû_fe
));

78 
out
;

80 
	`HAL_DEBUG
 (("æİpy drivÇmi '%s'", 
Çme
));

82 ià(
	`ioùl
 (
fd
, 
FDPOLLDRVSTAT
, &
ds
)) {

83 
	`HAL_ERROR
 (("FDPOLLDRVSTAT faed fÜ %s", 
deviû_fe
));

84 
out
;

87 ià(
ds
.
Œack
 < 0) {

88 
	`HAL_ERROR
 (("æİpy driv% £em nÙØexi¡", 
deviû_fe
));

89 
out
;

93 
»t
 = 0;

95 
out
:

96 ià(
fd
 >= 0)

97 
	`şo£
 (
fd
);

99  
»t
;

100 
	}
}

	@hald/linux/probing/probe-printer.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<fú.h
>

29 
	~<¡dšt.h
>

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ršg.h
>

33 
	~<sys/ioùl.h
>

34 
	~<uni¡d.h
>

36 
	~<glib.h
>

38 
	~"libh®/libh®.h
"

39 
	~"../../logg”.h
"

42 
	#IOCNR_GET_DEVICE_ID
 1

	)

43 
	#LPIOC_GET_DEVICE_ID
(
Ën
è
	`_IOC
(
_IOC_READ
, 'P', 
IOCNR_GET_DEVICE_ID
,†’)

	)

46 
	$maš
 (
¬gc
, *
¬gv
[])

48 
fd
;

49 
»t
;

50 *
udi
;

51 *
deviû_fe
;

52 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

53 
DBusE¼Ü
 
”rÜ
;

54 
deviû_id
[1024];

55 **
´İs
;

56 **
™”
;

57 *
mfg
;

58 *
mod–
;

59 *
£rŸl
;

60 *
desc
;

61 *
cmd
;

63 
fd
 = -1;

66 
»t
 = 1;

68 
	`£tup_logg”
 ();

70 
udi
 = 
	`g‘’v
 ("UDI");

71 ià(
udi
 =ğ
NULL
) {

72 
	`HAL_ERROR
 (("UDI‚ot set"));

73 
out
;

76 
	`dbus_”rÜ_š™
 (&
”rÜ
);

77 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

78 
	`HAL_ERROR
 (("ctx init failed"));

79 
out
;

82 
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_PRINTER_DEVICE");

83 ià(
deviû_fe
 =ğ
NULL
) {

84 
	`HAL_ERROR
 (("device_file == NULL"));

85 
out
;

88 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
);

89 ià(
fd
 < 0) {

90 
	`HAL_ERROR
 (("CªnÙ o³À%s", 
deviû_fe
));

91 
out
;

94 ià(
	`ioùl
 (
fd
, 
	`LPIOC_GET_DEVICE_ID
 ( (
deviû_id
)), device_id) < 0) {

95 
	`HAL_ERROR
 (("CªnÙ dØLPIOC_GET_DEVICE_ID oÀ%s", 
deviû_fe
));

96 
out
;

99 
mfg
 = 
NULL
;

100 
mod–
 = 
NULL
;

101 
£rŸl
 = 
NULL
;

102 
desc
 = 
NULL
;

103 
cmd
 = 
NULL
;

105 
	`HAL_DEBUG
 (("deviû_id = %s", 
deviû_id
 + 2));

107 
´İs
 = 
	`g_¡r¥l™
 (
deviû_id
+2, ";", 0);

108 
™”
 = 
´İs
; *™” !ğ
NULL
; iter++) {

109 ià(
	`¡ºcmp
 (*
™”
, "MANUFACTURER:", 13) == 0)

110 
mfg
 = *
™”
 + 13;

111 ià(
	`¡ºcmp
 (*
™”
, "MFG:", 4) == 0)

112 
mfg
 = *
™”
 + 4;

113 ià(
	`¡ºcmp
 (*
™”
, "MODEL:", 6) == 0)

114 
mod–
 = *
™”
 + 6;

115 ià(
	`¡ºcmp
 (*
™”
, "MDL:", 4) == 0)

116 
mod–
 = *
™”
 + 4;

117 ià(
	`¡ºcmp
 (*
™”
, "SN:", 3) == 0)

118 
£rŸl
 = *
™”
 + 3;

119 ià(
	`¡ºcmp
 (*
™”
, "SERN:", 5) == 0)

120 
£rŸl
 = *
™”
 + 5;

121 ià(
	`¡ºcmp
 (*
™”
, "SERIALNUMBER:", 13) == 0)

122 
£rŸl
 = *
™”
 + 13;

123 ià(
	`¡ºcmp
 (*
™”
, "DES:", 4) == 0)

124 
desc
 = *
™”
 + 4;

125 ià(
	`¡ºcmp
 (*
™”
, "DESCRIPTION:", 12) == 0)

126 
desc
 = *
™”
 + 12;

127 ià(
	`¡ºcmp
 (*
™”
, "COMMAND SET:", 12) == 0)

128 
cmd
 = *
™”
 + 12;

129 ià(
	`¡ºcmp
 (*
™”
, "COMMANDSET:", 11) == 0)

130 
cmd
 = *
™”
 + 11;

131 ià(
	`¡ºcmp
 (*
™”
, "CMD:", 4) == 0)

132 
cmd
 = *
™”
 + 4;

135 
	`dbus_”rÜ_š™
 (&
”rÜ
);

137 ià(
mfg
 !ğ
NULL
) {

138 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
ùx
, 
udi
, "šfo.v’dÜ", 
mfg
, &
”rÜ
);

139 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
ùx
, 
udi
, "´š‹r.v’dÜ", 
mfg
, &
”rÜ
);

142 ià(
mod–
 !ğ
NULL
) {

143 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
ùx
, 
udi
, "šfo.´oduù", 
mod–
, &
”rÜ
);

144 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
ùx
, 
udi
, "´š‹r.´oduù", 
mod–
, &
”rÜ
);

147 ià(
£rŸl
 !ğ
NULL
)

148 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
ùx
, 
udi
, "´š‹r.£rŸl", 
£rŸl
, &
”rÜ
);

150 ià(
desc
 !ğ
NULL
) {

151 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
ùx
, 
udi
, "´š‹r.desütiÚ", 
desc
, &
”rÜ
);

154 ià(
cmd
 !ğ
NULL
) {

155 **
cmd£t
 = 
	`g_¡r¥l™
 (
cmd
, ",", 0);

156 
™”
 = 
cmd£t
; *™” !ğ
NULL
; iter++)

157 
	`libh®_deviû_´İ”ty_¡¾i¡_­³nd
 (
ùx
, 
udi
, "´š‹r.commªd£t", *
™”
, &
”rÜ
);

158 
	`g_¡rä“v
 (
cmd£t
);

161 
	`g_¡rä“v
 (
´İs
);

163 
»t
 = 0;

165 
out
:

166 ià(
fd
 >= 0)

167 
	`şo£
 (
fd
);

169 ià(
ùx
 !ğ
NULL
) {

170 
	`dbus_”rÜ_š™
 (&
”rÜ
);

171 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

172 
	`libh®_ùx_ä“
 (
ùx
);

175  
»t
;

176 
	}
}

	@hald/linux/probing/probe-serial.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<fú.h
>

32 
	~<lšux/ty³s.h
>

33 
	~<lšux/£rŸl.h
>

34 
	~<¡dšt.h
>

35 
	~<¡dio.h
>

36 
	~<¡dlib.h
>

37 
	~<¡ršg.h
>

38 
	~<sys/ioùl.h
>

39 
	~<uni¡d.h
>

41 
	~"libh®/libh®.h
"

43 
	~"../../logg”.h
"

46 
	$maš
 (
¬gc
, *
¬gv
[])

48 
fd
;

49 
»t
;

50 *
deviû_fe
;

51 
£rŸl_¡ruù
 
ss
;

53 
fd
 = -1;

56 
»t
 = 1;

58 
	`£tup_logg”
 ();

60 ià(
	`g‘’v
 ("UDI"è=ğ
NULL
) {

61 
	`HAL_ERROR
 (("UDI‚ot set"));

62 
out
;

65 ià((
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_SERIAL_DEVICE")è=ğ
NULL
) {

66 
	`HAL_ERROR
 (("HAL_PROP_SERIAL_DEVICE‚ot set"));

67 
out
;

70 
	`HAL_DEBUG
 (("Checkšg ià% i aùu®ly…»£Á", 
deviû_fe
));

73 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
);

74 ià(
fd
 < 0) {

75 
	`HAL_ERROR
 (("Could‚Ù o³À%s", 
deviû_fe
));

76 
out
;

79 ià(
	`ioùl
 (
fd
, 
TIOCGSERIAL
, &
ss
)) {

80 
	`HAL_ERROR
 (("TIOCGSERIAL faed fÜ %s", 
deviû_fe
));

81 
out
;

84 ià(
ss
.
ty³
 == 0) {

85 
	`HAL_ERROR
 (("£rŸÈpÜˆ% £em nÙØexi¡", 
deviû_fe
));

86 
out
;

90 
»t
 = 0;

92 
out
:

93 ià(
fd
 >= 0)

94 
	`şo£
 (
fd
);

96  
»t
;

97 
	}
}

	@hald/linux/probing/probe-smbios.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<ùy³.h
>

32 
	~<”ºo.h
>

33 
	~<fú.h
>

34 
	~<¡dšt.h
>

35 
	~<¡dio.h
>

36 
	~<¡dlib.h
>

37 
	~<¡ršg.h
>

38 
	~<sys/¡©.h
>

39 
	~<uni¡d.h
>

41 
	~"libh®/libh®.h
"

42 
	~"../../logg”.h
"

44 
	#DMIPARSER_STATE_IGNORE
 0

	)

45 
	#DMIPARSER_STATE_BIOS
 1

	)

46 
	#DMIPARSER_STATE_SYSTEM
 2

	)

47 
	#DMIPARSER_STATE_CHASSIS
 3

	)

48 
	#DMIPARSER_STATE_BOARD
 4

	)

50 
	#¡rbegš
(
buf
, 
¡r
è(
	`¡ºcmp
 (buf, sŒ, 
	`¡¾’
 (¡r)è=ğ0)

	)

53 *
	gudi
 = 
NULL
;

54 
LibH®CÚ‹xt
 *
	gùx
 = 
NULL
;

68 
	$£t¡r
 (*
buf
, *
¡r
, *
´İ
)

70 
DBusE¼Ü
 
”rÜ
;

71 *
v®ue
;

73 ià(
	`¡rbegš
 (
buf
, 
¡r
)) {

74 
	`dbus_”rÜ_š™
 (&
”rÜ
);

75 
v®ue
 = 
buf
 + 
	`¡¾’
 (
¡r
) + 1;

76 ià(
	`¡rcmp
 (
v®ue
, "Not Specified") == 0)

77 
out
;

79 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
ùx
, 
udi
, 
´İ
, 
v®ue
, &
”rÜ
);

80 
	`HAL_DEBUG
 (("S‘tšg %s='%s'", 
´İ
, 
v®ue
));

81  
TRUE
;

83 
out
:

84  
FALSE
;

85 
	}
}

98 
	$maš
 (
¬gc
, *
¬gv
[])

100 
»t
;

101 
DBusE¼Ü
 
”rÜ
;

102 
buf
[512];

103 *
nbuf
;

104 
dme
[2];

105 
nuÎfd
;

106 
FILE
 *
f
;

107 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_IGNORE
;

112 
dm¬£r_dÚe_bios
 = 
FALSE
;

113 
dm¬£r_dÚe_sy¡em
 = 
FALSE
;

114 
dm¬£r_dÚe_chassis
 = 
FALSE
;

116 
ušt
 
i
;

117 
¡©
 
s
;

118 cÚ¡ *
·th
 = 
NULL
;

119 cÚ¡ *
possibË_·ths
[] = {

127 
»t
 = 1;

129 
	`£tup_logg”
 ();

131 
udi
 = 
	`g‘’v
 ("UDI");

132 ià(
udi
 =ğ
NULL
) {

133 
	`HAL_ERROR
 (("UDI‚ot set"));

134 
out
;

137 
	`dbus_”rÜ_š™
 (&
”rÜ
);

138 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

139 
	`HAL_ERROR
 (("ctx init failed"));

140 
out
;

145 
i
 = 0; i <  (
possibË_·ths
) /  (*); i++) {

146 ià(
	`¡©
 (
possibË_·ths
[
i
], &
s
è=ğ0 && 
	`S_ISREG
 (s.
¡_mode
)) {

147 
·th
 = 
possibË_·ths
[
i
];

152 ià(
·th
 =ğ
NULL
) {

153 
	`HAL_ERROR
(("Could‚ot find dmidecode,ƒxit!"));

154 
	`ex™
(1);

157 if(
	`pe
 (
dme
) == -1) {

158 
	`HAL_ERROR
(("Could‚Ù c»©pÓ¼Ü: '%s'),ƒx™!", 
	`¡»¼Ü
(
”ºo
)));

159 
	`ex™
(1);

162 ià((
f
 = 
	`fdİ’
 (
dme
[0], "r")è=ğ
NULL
) {

163 
	`HAL_ERROR
(("Could‚Ù o³ÀfÓ¼Ü: '%s'),ƒx™!", 
	`¡»¼Ü
(
”ºo
)));

164 
	`ex™
(1);

167 ià((
nuÎfd
 = 
	`İ’
 ("/dev/nuÎ", 
O_RDONLY
)) == -1){

168 
	`HAL_ERROR
(("Could‚Ù o³À/dev/nuÎ (”rÜ: '%s'),ƒx™!", 
	`¡»¼Ü
(
”ºo
)));

169 
	`ex™
(1);

173 
	`fÜk
 ()) {

177 
	`dup2
 (
nuÎfd
, 
STDIN_FILENO
);

178 
	`dup2
 (
dme
[1], 
STDOUT_FILENO
);

179 
	`şo£
 (
dme
[0]);

180 
	`şo£
 (
dme
[1]);

183 
	`exeş
 (
·th
,…©h, 
NULL
);

186 
	`HAL_ERROR
 (("Failedoƒxecute dmidecode!"));

187 
	`ex™
 (1);

190 
	`HAL_ERROR
 (("Cannot fork!"));

191 
out
;

197 
	`şo£
 (
dme
[1]);

200 
	`fg‘s
 (
buf
, (buf), 
f
è!ğ
NULL
)

202 
j
;

203 
Ën
;

204 
bs
 = 0;

207 
Ën
 = 
	`¡¾’
 (
buf
);

210 ià(
Ën
 >ğ (
buf
))

214 ià(
Ën
 < 3) {

215 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_IGNORE
;

220 ià(
buf
[0] == '\t' && buf[1] == '\t')

221 
bs
 = 2;

222 ià(
buf
[0] == '\t')

223 
bs
 = 1;

225 ià(
bs
 == 2)

230 ià(
bs
 == 0) {

231 ià(!
dm¬£r_dÚe_bios
 && 
	`¡rbegš
 (
buf
, "BIOS Information"))

232 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_BIOS
;

233 ià(!
dm¬£r_dÚe_sy¡em
 && 
	`¡rbegš
 (
buf
, "System Information"))

234 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_SYSTEM
;

235 ià(!
dm¬£r_dÚe_chassis
 && 
	`¡rbegš
 (
buf
, "Chassis Information"))

236 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_CHASSIS
;

237 ià(!
dm¬£r_dÚe_chassis
 && 
	`¡rbegš
 (
buf
, "Base Board Information"))

238 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_BOARD
;

244 
dm¬£r_¡©e
 = 
DMIPARSER_STATE_IGNORE
;

249 ià(
dm¬£r_¡©e
 =ğ
DMIPARSER_STATE_IGNORE
)

253 
»t
 = 0;

257 
nbuf
 = &
buf
[1];

260 
j
 = 
Ën
 - 2; 
	`is¥aû
 (
nbuf
[j]) && j >= 0; --j)

261 
nbuf
[
j
] = '\0';

263 ià(
dm¬£r_¡©e
 =ğ
DMIPARSER_STATE_BIOS
) {

264 
	`£t¡r
 (
nbuf
, "Vendor:", "system.firmware.vendor");

265 
	`£t¡r
 (
nbuf
, "Version:", "system.firmware.version");

266 
	`£t¡r
 (
nbuf
, "Release Date:", "system.firmware.release_date");

267 
dm¬£r_dÚe_bios
 = 
TRUE
;

268 } ià(
dm¬£r_¡©e
 =ğ
DMIPARSER_STATE_SYSTEM
) {

269 
	`£t¡r
 (
nbuf
, "Manufacturer:", "system.hardware.vendor");

270 
	`£t¡r
 (
nbuf
, "Product Name:", "system.hardware.product");

271 
	`£t¡r
 (
nbuf
, "Version:", "system.hardware.version");

272 
	`£t¡r
 (
nbuf
, "Serial Number:", "system.hardware.serial");

273 
	`£t¡r
 (
nbuf
, "UUID:", "system.hardware.uuid");

274 
dm¬£r_dÚe_sy¡em
 = 
TRUE
;

275 } ià(
dm¬£r_¡©e
 =ğ
DMIPARSER_STATE_CHASSIS
) {

276 
	`£t¡r
 (
nbuf
, "Manufacturer:", "system.chassis.manufacturer");

277 
	`£t¡r
 (
nbuf
, "Type:", "system.chassis.type");

278 
dm¬£r_dÚe_chassis
 = 
TRUE
;

279 } ià(
dm¬£r_¡©e
 =ğ
DMIPARSER_STATE_BOARD
) {

280 
	`£t¡r
 (
nbuf
, "Manufacturer:", "system.board.vendor");

281 
	`£t¡r
 (
nbuf
, "Product Name:", "system.board.product");

282 
	`£t¡r
 (
nbuf
, "Version:", "system.board.version");

283 
	`£t¡r
 (
nbuf
, "Serial Number:", "system.board.serial");

284 
dm¬£r_dÚe_sy¡em
 = 
TRUE
;

289 
	`fşo£
 (
f
);

291 
out
:

293 ià(
ùx
 !ğ
NULL
) {

294 
	`dbus_”rÜ_š™
 (&
”rÜ
);

295 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

296 
	`libh®_ùx_ä“
 (
ùx
);

299  
»t
;

300 
	}
}

	@hald/linux/probing/probe-storage.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<ùy³.h
>

32 
	~<”ºo.h
>

33 
	~<fú.h
>

34 
	~<lšux/kdev_t.h
>

35 
	~<lšux/hd»g.h
>

36 
	~<lšux/cdrom.h
>

37 
	~<lšux/fs.h
>

38 
	~<mÁ’t.h
>

39 
	~<¡dšt.h
>

40 
	~<¡dio.h
>

41 
	~<¡dlib.h
>

42 
	~<¡ršg.h
>

43 
	~<sys/ioùl.h
>

44 
	~<uni¡d.h
>

46 
	~<glib.h
>

47 
	~<libvŞume_id.h
>

49 
	~"libh®/libh®.h
"

50 
	~"·¹ut/·¹ut.h
"

51 
	~"lšux_dvd_rw_uts.h
"

53 
	~"../../logg”.h
"

54 
	~"../../ut_h–³r.h
"

57 
	$vid_log
(
´iÜ™y
, cÚ¡ *
fe
, 
lše
, cÚ¡ *
fÜm©
, ...)

59 
log_¡r
[1024];

60 
va_li¡
 
¬gs
;

62 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

63 
	`v¢´štf
(
log_¡r
, Öog_¡r), 
fÜm©
, 
¬gs
);

64 
	`logg”_fÜw¬d_debug
("%s:%˜%s\n", 
fe
, 
lše
, 
log_¡r
);

65 
	`va_’d
(
¬gs
);

66 
	}
}

75 
dbus_boŞ_t


76 
	$is_mouÁed
 (cÚ¡ *
deviû_fe
)

78 
FILE
 *
f
;

79 
dbus_boŞ_t
 
rc
;

80 
mÁ’t
 
mÁ
;

81 
buf
[512];

83 
rc
 = 
FALSE
;

85 ià((
f
 = 
	`£tmÁ’t
 ("/‘c/mb", "r")è=ğ
NULL
)

86 
out
;

88 
	`g‘mÁ’t_r
 (
f
, &
mÁ
, 
buf
, (buf)è!ğ
NULL
) {

89 ià(
	`¡rcmp
 (
deviû_fe
, 
mÁ
.
mÁ_f¢ame
) == 0) {

90 
rc
 = 
TRUE
;

91 
out1
;

95 
out1
:

96 
	`’dmÁ’t
 (
f
);

97 
out
:

98  
rc
;

99 
	}
}

102 
	$maš
 (
¬gc
, *
¬gv
[])

104 
fd
, 
num_exş_Œ›s
 = 5;

105 
»t
;

106 *
udi
;

107 *
deviû_fe
;

108 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

109 
DBusE¼Ü
 
”rÜ
;

110 *
bus
;

111 *
drive_ty³
;

112 *
sysfs_·th
;

113 
dbus_boŞ_t
 
Úly_check_fÜ_fs
;

114 
LibH®ChªgeS‘
 *
cs
;

116 
cs
 = 
NULL
;

118 
fd
 = -1;

121 
vŞume_id_log_â
 = 
vid_log
;

123 
	`årštf
 (
¡d”r
, "woohoo\n");

126 
»t
 = 1;

128 ià((
udi
 = 
	`g‘’v
 ("UDI")è=ğ
NULL
)

129 
out
;

130 ià((
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_DEVICE")è=ğ
NULL
)

131 
out
;

132 ià((
bus
 = 
	`g‘’v
 ("HAL_PROP_STORAGE_BUS")è=ğ
NULL
)

133 
out
;

134 ià((
drive_ty³
 = 
	`g‘’v
 ("HAL_PROP_STORAGE_DRIVE_TYPE")è=ğ
NULL
)

135 
out
;

136 ià((
sysfs_·th
 = 
	`g‘’v
 ("HAL_PROP_LINUX_SYSFS_PATH")è=ğ
NULL
)

137 
out
;

139 
	`£tup_logg”
 ();

141 ià(
¬gc
 =ğ2 && 
	`¡rcmp
 (
¬gv
[1], "--only-check-for-media") == 0)

142 
Úly_check_fÜ_fs
 = 
TRUE
;

144 
Úly_check_fÜ_fs
 = 
FALSE
;

146 
	`dbus_”rÜ_š™
 (&
”rÜ
);

147 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
)

148 
out
;

150 
cs
 = 
	`libh®_deviû_Ãw_chªge£t
 (
udi
);

151 ià(
cs
 =ğ
NULL
) {

152 
	`HAL_DEBUG
(("Cannot initialize changeset"));

153 
out
;

156 
	`HAL_DEBUG
 (("Doing…robe-storage for %s (bus %s) (drive_type %s) (udi=%s) (--only-check-for-fs==%d)",

157 
deviû_fe
, 
bus
, 
drive_ty³
, 
udi
, 
Úly_check_fÜ_fs
));

160 ià(
	`¡rcmp
 (
bus
, "scsi") == 0){

161 
hd_driveid
 
id
;

162 
gch¬
 *
mod–
 = 
NULL
;

164 
fd
 = 
	`İ’
(
deviû_fe
, 
O_RDONLY
|
O_NONBLOCK
);

165 ià(
fd
 < 0) {

166 
	`HAL_WARNING
(("uÇbËØİ’ '%s',ƒ¼Ü: '%s'", 
deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

168 ià(
	`ioùl
(
fd
, 
HDIO_GET_IDENTITY
, &
id
)) {

169 
	`HAL_WARNING
 (("HDIO_GET_IDENTITY unsuµÜ‹d o¸çed fÜ: '%s' w™hƒ¼Ü: '%s'", 
deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

171 
¡r
[41];

172 
size_t
 
i
, 
Ën
;

174 
i
 = 0;

175 
Ën
 = 40;

177 
Ën
 && 
	`is¥aû
(
id
.
mod–
[len-1]))

178 
Ën
--;

180 
i
 < 
Ën
) {

181 
¡r
[
i
] = 
id
.
mod–
[i];

182 
i
++;

184 
¡r
[
i
] = '\0';

186 
	`g_¡r¡r
(
¡r
);

188 ià((
mod–
 = 
	`h®_ut_¡rdup_v®id_utf8
(
¡r
)è!ğ
NULL
) {

189 
mod–
 = 
	`g_¡rd–im™
(model, "/", '_');

192 
	`şo£
(
fd
);

195 ià(
mod–
 !ğ
NULL
) {

196 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "¡Üage.mod–", 
mod–
);

197 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "šfo.´oduù", 
mod–
);

198 
	`g_ä“
 (
mod–
);

203 ià(
	`¡rcmp
 (
drive_ty³
, "cdrom") == 0) {

204 
ÿ·b™›s
;

205 
»ad_¥“d
, 
wr™e_¥“d
;

206 *
wr™e_¥“ds
;

208 
	`HAL_DEBUG
 (("Došg o³À(\"%s\", O_RDONLY | O_NONBLOCK)", 
deviû_fe
));

209 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
);

210 ià(
fd
 < 0) {

211 
	`HAL_ERROR
 (("CªnÙ o³À%s: %s", 
deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

212 
out
;

214 
	`HAL_DEBUG
 (("Returned from open(2)"));

216 ià(
	`ioùl
 (
fd
, 
CDROM_SET_OPTIONS
, 
CDO_USE_FFLAGS
) < 0) {

217 
	`HAL_ERROR
 (("E¼Ü: CDROM_SET_OPTIONS faed: %s\n", 
	`¡»¼Ü
(
”ºo
)));

218 
	`şo£
 (
fd
);

219 
out
;

222 ià(!
Úly_check_fÜ_fs
) {

223 
ÿ·b™›s
 = 
	`ioùl
 (
fd
, 
CDROM_GET_CAPABILITY
, 0);

224 ià(
ÿ·b™›s
 < 0) {

225 
	`şo£
 (
fd
);

226 
out
;

228 
	`HAL_DEBUG
 (("CDROM_GET_CAPABILITY„‘uºed: 0x%08x", 
ÿ·b™›s
));

230 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.cdr", 
FALSE
);

231 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.cdrw", 
FALSE
);

232 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd", 
FALSE
);

233 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvdr", 
FALSE
);

234 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvdrw", 
FALSE
);

235 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvdrdl", 
FALSE
);

236 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¿m", 
FALSE
);

237 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤", 
FALSE
);

238 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤w", 
FALSE
);

239 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤wdl", 
FALSE
);

240 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤dl", 
FALSE
);

241 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.bd", 
FALSE
);

242 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.bdr", 
FALSE
);

243 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.bd»", 
FALSE
);

244 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.hddvd", 
FALSE
);

245 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.hddvdr", 
FALSE
);

246 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.hddvdrw", 
FALSE
);

247 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.mo", 
FALSE
);

248 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.mrw", 
FALSE
);

249 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.mrw_w", 
FALSE
);

251 ià(
ÿ·b™›s
 & 
CDC_CD_R
) {

252 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.cdr", 
TRUE
);

255 ià(
ÿ·b™›s
 & 
CDC_CD_RW
) {

256 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.cdrw", 
TRUE
);

258 ià(
ÿ·b™›s
 & 
CDC_DVD
) {

259 
´ofe
;

261 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd", 
TRUE
);

263 
´ofe
 = 
	`g‘_dvd_r_rw_´ofe
 (
fd
);

264 
	`HAL_DEBUG
 (("g‘_dvd_r_rw_´of»tuºed: %d", 
´ofe
));

266 ià(
´ofe
 & 
DRIVE_CDROM_CAPS_DVDRW
)

267 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvdrw", 
TRUE
);

268 ià(
´ofe
 & 
DRIVE_CDROM_CAPS_DVDRDL
)

269 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvdrdl", 
TRUE
);

270 ià(
´ofe
 & 
DRIVE_CDROM_CAPS_DVDPLUSR
)

271 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤", 
TRUE
);

272 ià(
´ofe
 & 
DRIVE_CDROM_CAPS_DVDPLUSRW
)

273 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤w", 
TRUE
);

274 ià(
´ofe
 & 
DRIVE_CDROM_CAPS_DVDPLUSRWDL
)

275 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤wdl", 
TRUE
);

276 ià(
´ofe
 & 
DRIVE_CDROM_CAPS_DVDPLUSRDL
)

277 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤dl", 
TRUE
);

278 ià(
´ofe
 & 
DRIVE_CDROM_CAPS_BDROM
)

279 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.bd", 
TRUE
);

280 ià(
´ofe
 & 
DRIVE_CDROM_CAPS_BDR
)

281 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.bdr", 
TRUE
);

282 ià(
´ofe
 & 
DRIVE_CDROM_CAPS_BDRE
)

283 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.bd»", 
TRUE
);

284 ià(
´ofe
 & 
DRIVE_CDROM_CAPS_HDDVDROM
)

285 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.hddvd", 
TRUE
);

286 ià(
´ofe
 & 
DRIVE_CDROM_CAPS_HDDVDR
)

287 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.hddvdr", 
TRUE
);

288 ià(
´ofe
 & 
DRIVE_CDROM_CAPS_HDDVDRW
)

289 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.hddvdrw", 
TRUE
);

291 ià(
ÿ·b™›s
 & 
CDC_DVD_R
) {

292 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvdr", 
TRUE
);

294 ià(
ÿ·b™›s
 & 
CDC_DVD_RAM
) {

295 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¿m", 
TRUE
);

297 ià(
ÿ·b™›s
 & 
CDC_MO_DRIVE
) {

298 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.mo", 
TRUE
);

300 ià(
ÿ·b™›s
 & 
CDC_MRW
) {

301 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.mrw", 
TRUE
);

303 ià(
ÿ·b™›s
 & 
CDC_MRW_W
) {

304 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.mrw_w", 
TRUE
);

308 ià(
ÿ·b™›s
 & 
CDC_MEDIA_CHANGED
) {

309 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.suµÜt_medŸ_chªged", 
TRUE
);

311 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.suµÜt_medŸ_chªged", 
FALSE
);

313 ià(
ÿ·b™›s
 & 
CDC_MULTI_SESSION
) {

314 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.suµÜt_muÉi£ssiÚ", 
TRUE
);

316 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.suµÜt_muÉi£ssiÚ", 
FALSE
);

321 ià(
	`g‘_»ad_wr™e_¥“d
(
fd
, &
»ad_¥“d
, &
wr™e_¥“d
, &
wr™e_¥“ds
) >= 0) {

322 
	`libh®_chªge£t_£t_´İ”ty_št
 (
cs
, "¡Üage.cdrom.»ad_¥“d", 
»ad_¥“d
);

324 ià(
wr™e_¥“d
 > 0) {

325 
	`libh®_chªge£t_£t_´İ”ty_št
 (
cs
, "¡Üage.cdrom.wr™e_¥“d", 
wr™e_¥“d
);

327 ià(
wr™e_¥“ds
 !ğ
NULL
)

329 
gch¬
 **
w¥“ds
;

331 
w¥“ds
 = 
	`g_¡r¥l™_£t
 (
wr™e_¥“ds
, ",", -1);

332 
	`libh®_chªge£t_£t_´İ”ty_¡¾i¡
 (
cs
, "storage.cdrom.write_speeds",

333 (cÚ¡ **è
w¥“ds
);

334 
	`g_¡rä“v
 (
w¥“ds
);

335 
	`ä“
 (
wr™e_¥“ds
);

339 
gch¬
 *
w¥“ds
[1] = {
NULL
};

340 
	`libh®_chªge£t_£t_´İ”ty_št
 (
cs
, "storage.cdrom.write_speed", 0);

341 
	`libh®_chªge£t_£t_´İ”ty_¡¾i¡
 (
cs
, "storage.cdrom.write_speeds",

342 (cÚ¡ **è
w¥“ds
);

346 
	`şo£
 (
fd
);

349 
»t
 = 0;

352 ià(
	`¡rcmp
 (
drive_ty³
, "cdrom") == 0) {

353 *
suµÜt_medŸ_chªged_¡r
;

354 
suµÜt_medŸ_chªged
;

355 
gÙ_medŸ
;

356 
drive
;

358 
	`HAL_DEBUG
 (("Checkšg fÜ o±iÿÈdisøÚ %s", 
deviû_fe
));

360 
suµÜt_medŸ_chªged_¡r
 = 
	`g‘’v
 ("HAL_PROP_STORAGE_CDROM_SUPPORT_MEDIA_CHANGED");

361 ià(
suµÜt_medŸ_chªged_¡r
 !ğ
NULL
 && 
	`¡rcmp
 (support_media_changed_str, "true") == 0)

362 
suµÜt_medŸ_chªged
 = 
TRUE
;

364 
suµÜt_medŸ_chªged
 = 
FALSE
;

366 
	`HAL_DEBUG
 (("Došg o³À(\"%s\", O_RDONLY | O_NONBLOCK | O_EXCL)", 
deviû_fe
));

367 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
 | 
O_EXCL
);

369 ià(
fd
 < 0 && 
”ºo
 =ğ
EBUSY
) {

378 
	`HAL_DEBUG
 (("Open failed - Device Busy"));

379 ià(!
	`is_mouÁed
 (
deviû_fe
)) {

381 
	`u¦“p
(100 * 1000);

382 
	`HAL_DEBUG
 (("Attempting open w/ O_EXCL‡gain"));

383 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
 | 
O_EXCL
);

384 
num_exş_Œ›s
--;

385 } 
fd
 < 0 && 
num_exş_Œ›s
 > 0);

387 
	`HAL_DEBUG
 (("Došg o³À(\"%s\", O_RDONLY | O_NONBLOCK)", 
deviû_fe
));

388 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
);

392 ià(
fd
 < 0) {

393 
	`HAL_DEBUG
 (("İ’ faed fÜ %s: %s", 
deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

394 
out
;

396 
	`HAL_DEBUG
 (("PROBE HAS EXCLUSIVE LOCK ON CDROM"));

397 
gÙ_medŸ
 = 
FALSE
;

403 
drive
 = 
	`ioùl
 (
fd
, 
CDROM_DRIVE_STATUS
, 
CDSL_CURRENT
);

404 
drive
) {

406 
CDS_NO_INFO
:

407 
CDS_NO_DISC
:

408 
CDS_TRAY_OPEN
:

409 
CDS_DRIVE_NOT_READY
:

412 
CDS_DISC_OK
:

417 ià(
suµÜt_medŸ_chªged
 &&

418 
	`ioùl
 (
fd
, 
CDROM_MEDIA_CHANGED
, 
CDSL_CURRENT
) &&

419 
	`ioùl
 (
fd
, 
CDROM_MEDIA_CHANGED
, 
CDSL_CURRENT
)) {

421 
gÙ_medŸ
 = 
TRUE
;

426 
	`HAL_ERROR
 (("E¼Ü: CDROM_DRIVE_STATUS faed: %s\n", 
	`¡»¼Ü
(
”ºo
)));

433 ià(
gÙ_medŸ
) {

434 
ušt64_t
 
size
;

435 
»t
 = 2;

436 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.»movabË.medŸ_avaabË", 
TRUE
);

437 ià(
	`ioùl
 (
fd
, 
BLKGETSIZE64
, &
size
) == 0) {

438 
	`HAL_DEBUG
 (("medŸ sizğ%Îu", 
size
));

439 
	`libh®_chªge£t_£t_´İ”ty_ušt64
 (
cs
, "¡Üage.»movabË.medŸ_size", 
size
);

442 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.»movabË.medŸ_avaabË", 
FALSE
);

445 
	`şo£
 (
fd
);

446 
	`HAL_DEBUG
 (("PROBE CLOSED LOCK ON CDROM"));

448 
vŞume_id
 *
vid
;

449 
GDœ
 *
dœ
;

450 cÚ¡ 
gch¬
 *
·¹™iÚ
;

451 cÚ¡ 
gch¬
 *
maš_deviû
;

452 
size_t
 
maš_deviû_Ën
;

453 
ušt64_t
 
size
;

455 
	`HAL_DEBUG
 (("Checkšg fÜ fsy¡em oÀ%s", 
deviû_fe
));

461 
	`HAL_DEBUG
 (("Došg o³À(\"%s\", O_RDONLY)", 
deviû_fe
));

462 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
);

463 ià(
fd
 < 0) {

464 
	`HAL_DEBUG
 (("CªnÙ o³À%s: %s", 
deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

466 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.»movabË.medŸ_avaabË", 
FALSE
);

467 
out
;

469 
	`HAL_DEBUG
 (("Returned from open(2)"));

472 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.»movabË.medŸ_avaabË", 
TRUE
);

474 ià(
	`ioùl
 (
fd
, 
BLKGETSIZE64
, &
size
) != 0)

475 
size
 = 0;

477 
	`libh®_chªge£t_£t_´İ”ty_ušt64
 (
cs
, "¡Üage.»movabË.medŸ_size", 
size
);

480 
maš_deviû
 = 
	`¡¼chr
 (
sysfs_·th
, '/');

481 ià(
maš_deviû
 =ğ
NULL
)

482 
out
;

483 
maš_deviû
 = &main_device[1];

484 
maš_deviû_Ën
 = 
	`¡¾’
 (
maš_deviû
);

485 
	`HAL_DEBUG
 (("look fÜƒxi¡šg…¬t™iÚ fÜ %s", 
maš_deviû
));

486 ià((
dœ
 = 
	`g_dœ_İ’
 (
sysfs_·th
, 0, 
NULL
)) == NULL) {

487 
	`HAL_DEBUG
 (("failedo open sysfs dir"));

488 
out
;

490 (
·¹™iÚ
 = 
	`g_dœ_»ad_Çme
 (
dœ
)è!ğ
NULL
) {

491 ià(
	`¡ºcmp
 (
maš_deviû
, 
·¹™iÚ
, 
maš_deviû_Ën
) == 0 &&

492 
	`isdig™
 (
·¹™iÚ
[
maš_deviû_Ën
])) {

493 
P¬t™iÚTabË
 *
p
;

495 
	`HAL_DEBUG
 (("·¹™iÚ % found, sk…robšg fÜ fesy¡em", 
·¹™iÚ
));

496 
	`g_dœ_şo£
 (
dœ
);

499 
p
 = 
	`·¹_bË_lßd_äom_disk
 (
deviû_fe
);

500 ià(
p
 !ğ
NULL
) {

502 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (

503 
cs
,

505 
	`·¹_g‘_scheme_Çme
 (
	`·¹_bË_g‘_scheme
 (
p
)));

507 
	`·¹_bË_ä“
 (
p
);

510 
out
;

513 
	`g_dœ_şo£
 (
dœ
);

515 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "storage.partitioning_scheme", "none");

518 
vid
 = 
	`vŞume_id_İ’_fd
 (
fd
);

519 ià(
vid
 !ğ
NULL
) {

520 ià(
	`vŞume_id_´obe_®l
 (
vid
, 0, 
size
) == 0) {

521 cÚ¡ *
u§ge
;

527 ià(
	`vŞume_id_g‘_u§ge
(
vid
, &
u§ge
) &&

528 Ğ
	`¡rcmp
(
u§ge
, "filesystem") == 0 ||

529 
	`¡rcmp
(
u§ge
, "raid") == 0 ||

530 
	`¡rcmp
(
u§ge
, "other") == 0 ||

531 
	`¡rcmp
(
u§ge
, "crypto") == 0))

532 
»t
 = 2;

536 
	`vŞume_id_şo£
(
vid
);

538 
	`şo£
 (
fd
);

542 
out
:

543 ià(
cs
 !ğ
NULL
) {

544 
	`libh®_deviû_comm™_chªge£t
 (
ùx
, 
cs
, &
”rÜ
);

545 
	`libh®_deviû_ä“_chªge£t
 (
cs
);

548 ià(
ùx
 !ğ
NULL
) {

549 
	`dbus_”rÜ_š™
 (&
”rÜ
);

550 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

551 
	`libh®_ùx_ä“
 (
ùx
);

554  
»t
;

555 
	}
}

	@hald/linux/probing/probe-video4linux.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<sys/ty³s.h
>

31 
	~<sys/time.h
>

32 
	~<sys/ioùl.h
>

33 
	~<lšux/videodev.h
>

34 
	~<lšux/videodev2.h
>

35 
	~<”ºo.h
>

36 
	~<fú.h
>

37 
	~<¡dšt.h
>

38 
	~<¡dio.h
>

39 
	~<¡dlib.h
>

40 
	~<¡ršg.h
>

41 
	~<uni¡d.h
>

43 
	~"libh®/libh®.h
"

44 
	~"../../logg”.h
"

47 
	$maš
 (
¬gc
, *
¬gv
[])

49 
fd
 = -1;

50 
»t
 = -1;

51 *
udi
;

52 *
deviû_fe
;

53 
video_ÿ·b™y
 
v1ÿp
;

54 
v4l2_ÿ·b™y
 
v2ÿp
;

55 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

56 
LibH®ChªgeS‘
 *
c£t
;

57 
DBusE¼Ü
 
”rÜ
;

59 
	`£tup_logg”
 ();

61 
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_VIDEO4LINUX_DEVICE");

62 ià(
deviû_fe
 =ğ
NULL
)

63 
out
;

65 
udi
 = 
	`g‘’v
 ("UDI");

66 ià(
udi
 =ğ
NULL
)

67 
out
;

69 
	`dbus_”rÜ_š™
 (&
”rÜ
);

70 
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
);

71 ià(
ùx
 =ğ
NULL
)

72 
out
;

74 
c£t
 = 
	`libh®_deviû_Ãw_chªge£t
 (
udi
);

76 
	`HAL_DEBUG
 (("Došg…robe-video4lšux fÜ % (udi=%s)", 
deviû_fe
, 
udi
));

78 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
);

79 ià(
fd
 < 0) {

80 
	`HAL_ERROR
 (("CªnÙ o³À%s: %s", 
deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

81 
out
;

84 ià(
	`ioùl
 (
fd
, 
VIDIOC_QUERYCAP
, &
v2ÿp
) == 0) {

85 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
c£t
,

88 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
c£t
,

89 "šfo.´oduù", (cÚ¡ *)
v2ÿp
.
ÿrd
);

91 ià((
v2ÿp
.
ÿ·b™›s
 & 
V4L2_CAP_VIDEO_CAPTURE
) > 0)

92 
	`libh®_deviû_add_ÿ·b™y
 (
ùx
, 
udi
, "video4lšux.video_ÿ±u»", &
”rÜ
);

93 ià((
v2ÿp
.
ÿ·b™›s
 & 
V4L2_CAP_VIDEO_OUTPUT
) > 0)

94 
	`libh®_deviû_add_ÿ·b™y
 (
ùx
, 
udi
, "video4lšux.video_ouut", &
”rÜ
);

95 ià((
v2ÿp
.
ÿ·b™›s
 & 
V4L2_CAP_VIDEO_OVERLAY
) > 0)

96 
	`libh®_deviû_add_ÿ·b™y
 (
ùx
, 
udi
, "video4lšux.video_ov”Ïy", &
”rÜ
);

97 ià((
v2ÿp
.
ÿ·b™›s
 & 
V4L2_CAP_AUDIO
) > 0)

98 
	`libh®_deviû_add_ÿ·b™y
 (
ùx
, 
udi
, "video4lšux.audio", &
”rÜ
);

99 ià((
v2ÿp
.
ÿ·b™›s
 & 
V4L2_CAP_TUNER
) > 0)

100 
	`libh®_deviû_add_ÿ·b™y
 (
ùx
, 
udi
, "video4lšux.tuÃr", &
”rÜ
);

101 ià((
v2ÿp
.
ÿ·b™›s
 & 
V4L2_CAP_RADIO
) > 0)

102 
	`libh®_deviû_add_ÿ·b™y
 (
ùx
, 
udi
, "video4lšux.¿dio", &
”rÜ
);

104 
	`HAL_DEBUG
 (("ioctl VIDIOC_QUERYCAP failed"));

106 ià(
	`ioùl
 (
fd
, 
VIDIOCGCAP
, &
v1ÿp
) == 0) {

107 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
c£t
,

110 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
c£t
,

111 "šfo.´oduù", 
v1ÿp
.
Çme
);

113 ià((
v1ÿp
.
ty³
 & 
VID_TYPE_CAPTURE
) > 0)

114 
	`libh®_deviû_add_ÿ·b™y
 (
ùx
, 
udi
, "video4lšux.video_ÿ±u»", &
”rÜ
);

115 ià((
v1ÿp
.
ty³
 & 
VID_TYPE_OVERLAY
) > 0)

116 
	`libh®_deviû_add_ÿ·b™y
 (
ùx
, 
udi
, "video4lšux.video_ov”Ïy", &
”rÜ
);

117 ià(
v1ÿp
.
audios
 > 0)

118 
	`libh®_deviû_add_ÿ·b™y
 (
ùx
, 
udi
, "video4lšux.audio", &
”rÜ
);

119 ià((
v1ÿp
.
ty³
 & 
VID_TYPE_TUNER
) > 0)

120 
	`libh®_deviû_add_ÿ·b™y
 (
ùx
, 
udi
, "video4lšux.tuÃr", &
”rÜ
);

122 
	`HAL_DEBUG
 (("ioctl VIDIOCGCAP failed"));

126 
	`libh®_deviû_comm™_chªge£t
 (
ùx
, 
c£t
, &
”rÜ
);

127 
	`libh®_deviû_ä“_chªge£t
 (
c£t
);

129 
	`şo£
 (
fd
);

131 
»t
 = 0;

133 
out
:

134 ià(
fd
 >= 0)

135 
	`şo£
 (
fd
);

137 ià(
ùx
 !ğ
NULL
) {

138 
	`dbus_”rÜ_š™
 (&
”rÜ
);

139 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

140 
	`libh®_ùx_ä“
 (
ùx
);

143  
»t
;

144 
	}
}

	@hald/linux/probing/probe-volume.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<ùy³.h
>

32 
	~<”ºo.h
>

33 
	~<fú.h
>

34 
	~<lšux/cdrom.h
>

35 
	~<lšux/fs.h
>

36 
	~<¡dšt.h
>

37 
	~<¡dio.h
>

38 
	~<¡dlib.h
>

39 
	~<¡ršg.h
>

40 
	~<sys/ioùl.h
>

41 
	~<uni¡d.h
>

42 
	~<sigÇl.h
>

44 
	~<glib.h
>

45 
	~<libvŞume_id.h
>

47 
	~"libh®/libh®.h
"

48 
	~"·¹ut/·¹ut.h
"

49 
	~"lšux_dvd_rw_uts.h
"

50 
	~"../../logg”.h
"

52 
	$vid_log
(
´iÜ™y
, cÚ¡ *
fe
, 
lše
, cÚ¡ *
fÜm©
, ...)

54 
log_¡r
[1024];

55 
va_li¡
 
¬gs
;

57 
	`va_¡¬t
(
¬gs
, 
fÜm©
);

58 
	`v¢´štf
(
log_¡r
, Öog_¡r), 
fÜm©
, 
¬gs
);

59 
	`logg”_fÜw¬d_debug
("%s:%˜%s\n", 
fe
, 
lše
, 
log_¡r
);

60 
	`va_’d
(
¬gs
);

61 
	}
}

63 
gch¬
 *

64 
	$¡rdup_v®id_utf8
 (cÚ¡ *
¡r
)

66 *
’dch¬
;

67 *
Ãw¡r
;

68 
fixes
;

70 ià(
¡r
 =ğ
NULL
)

71  
NULL
;

73 
Ãw¡r
 = 
	`g_¡rdup
 (
¡r
);

75 
fixes
 = 0;

76 !
	`g_utf8_v®id©e
 (
Ãw¡r
, -1, (cÚ¡ **è&
’dch¬
)) {

77 *
’dch¬
 = '_';

78 ++
fixes
;

82 ià(
fixes
 > 0 && 
	`g_utf8_¡¾’
 (
Ãw¡r
, -1) / fixes < 5) {

83 
	`g_ä“
 (
Ãw¡r
);

84 
Ãw¡r
 = 
	`g_¡rdup
("");

87  
Ãw¡r
;

88 
	}
}

92 
	$£t_vŞume_id_v®ues
 (
LibH®ChªgeS‘
 *
cs
, 
vŞume_id
 *
vid
)

94 
buf
[256];

95 cÚ¡ *
u§ge
;

96 cÚ¡ *
ty³
;

97 cÚ¡ *
ty³_v”siÚ
;

98 cÚ¡ *
Ïb–
;

99 cÚ¡ *
uuid
;

100 
DBusE¼Ü
 
”rÜ
;

102 
	`dbus_”rÜ_š™
 (&
”rÜ
);

104 ià(!
	`vŞume_id_g‘_u§ge
(
vid
, &
u§ge
))

105 
u§ge
 = "";

106 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.fsu§ge", 
u§ge
);

107 
	`HAL_DEBUG
 (("vŞume.fsu§gğ'%s'", 
u§ge
));

109 ià(!
	`vŞume_id_g‘_ty³
(
vid
, &
ty³
))

110 
ty³
 = "";

111 ià(!
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.f¡y³", 
ty³
))

112 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.fstype", "");

113 
	`HAL_DEBUG
(("vŞume.f¡y³ = '%s'", 
ty³
));

115 ià(!
	`vŞume_id_g‘_ty³_v”siÚ
(
vid
, &
ty³_v”siÚ
))

116 
ty³_v”siÚ
 = "";

117 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.fsv”siÚ", 
ty³_v”siÚ
);

118 
	`HAL_DEBUG
(("vŞume.fsv”siÚ = '%s'", 
ty³_v”siÚ
));

120 ià(!
	`vŞume_id_g‘_uuid
(
vid
, &
uuid
))

121 
uuid
 = "";

122 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.uuid", 
uuid
);

123 
	`HAL_DEBUG
(("vŞume.uuid = '%s'", 
uuid
));

125 ià(!
	`vŞume_id_g‘_Ïb–
(
vid
, &
Ïb–
))

126 
Ïb–
 = "";

128 ià(
Ïb–
[0] != '\0') {

129 *
vŞume_Ïb–
;

132 
vŞume_Ïb–
 = 
	`¡rdup_v®id_utf8
 (
Ïb–
);

133 ifĞ
vŞume_Ïb–
 !ğ
NULL
 ) {

134 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.Ïb–", 
vŞume_Ïb–
);

135 
	`HAL_DEBUG
(("vŞume.Ïb– = '%s'", 
vŞume_Ïb–
));

137 ià(
vŞume_Ïb–
[0] != '\0') {

138 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "šfo.´oduù", 
vŞume_Ïb–
);

139 
	`g_ä“
(
vŞume_Ïb–
);

143 
	`g_ä“
(
vŞume_Ïb–
);

147 ià(
ty³
[0] != '\0') {

148 
	`¢´štf
 (
buf
,  (buf), "VŞum(%s)", 
ty³
);

150 
	`¢´štf
 (
buf
,  (buf), "Volume (unknown)");

152 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "šfo.´oduù", 
buf
);

153 
	}
}

156 
	$advªûd_disc_d‘eù
 (
LibH®ChªgeS‘
 *
cs
, 
fd
, cÚ¡ *
deviû_fe
)

159 
bs
;

161 
ts
;

163 

;

165 
Ën_di
 = 0;

167 
·»Á
 = 0;

169 
dœÇme
[256];

171 
pos
 = 0;

173 
cu¼_»cÜd
 = 1;

175 
i
;

176 
DBusE¼Ü
 
”rÜ
;

178 
	`dbus_”rÜ_š™
 (&
”rÜ
);

181 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_videodvd", 
FALSE
);

182 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_blu¿yvideo", 
FALSE
);

183 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_vcd", 
FALSE
);

184 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_svcd", 
FALSE
);

187 
	`l£ek
 (
fd
, 0x8080, 
SEEK_CUR
);

188 ià(
	`»ad
 (
fd
, &
bs
, 2) != 2)

190 
	`HAL_DEBUG
(("Advªûd…robšg oÀ% çed wh»adšg block size", 
deviû_fe
));

191 
out
;

195 
	`l£ek
 (
fd
, 2, 
SEEK_CUR
);

196 ià(
	`»ad
 (
fd
, &
ts
, 2) != 2)

198 
	`HAL_DEBUG
(("Advªûd…robšg oÀ% çed wh»adšg…©habË size", 
deviû_fe
));

199 
out
;

203 
	`l£ek
 (
fd
, 6, 
SEEK_CUR
);

204 ià(
	`»ad
 (
fd
, &

, 4) != 4)

206 
	`HAL_DEBUG
(("Advªûd…robšg oÀ% çed wh»adšg…©habË block", 
deviû_fe
));

207 
out
;

211 
	`l£ek
 (
fd
, 
	`GUINT16_FROM_LE
 (
bs
è* 
	`GUINT32_FROM_LE
 (

), 
SEEK_SET
);

214 
pos
 < 
	`GUINT16_FROM_LE
 (
ts
))

217 ià(
	`»ad
 (
fd
, &
Ën_di
, 1) != 1)

219 
	`HAL_DEBUG
(("Advªûd…robšg oÀ% çed, cªnÙ„—d mÜ’Œ›s", 
deviû_fe
));

225 
	`l£ek
 (
fd
, 5, 
SEEK_CUR
);

226 ià(
	`»ad
 (
fd
, &
·»Á
, 2) != 2)

228 
	`HAL_DEBUG
(("Advªûd…robšg oÀ% çed, couldn'ˆ»ad…¬’ˆ’Œy", 
deviû_fe
));

233 ià(
	`»ad
 (
fd
, 
dœÇme
, 
Ën_di
) !=†en_di)

235 
	`HAL_DEBUG
(("Advªûd…robšg oÀ% çed, couldn'ˆ»adh’Œy‚ame", 
deviû_fe
));

238 
dœÇme
[
Ën_di
] = 0;

241 
i
=0;

242 
dœÇme
[
i
]!=0)

244 
dœÇme
[
i
] = ()
	`touµ”
 (dirname[i]);

245 
i
++;

250 ià(
	`GUINT16_FROM_LE
 (
·»Á
) == 1)

252 ià(!
	`¡rcmp
 (
dœÇme
, "VIDEO_TS"))

254 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_videodvd", 
TRUE
);

255 
	`HAL_DEBUG
(("Disøš % i ¨VideØDVD", 
deviû_fe
));

258 ià(!
	`¡rcmp
 (
dœÇme
, "BDMV"))

260 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_blu¿yvideo", 
TRUE
);

261 
	`HAL_DEBUG
(("Disøš % i ¨Blu-¿y videØdisc", 
deviû_fe
));

264 ià(!
	`¡rcmp
 (
dœÇme
, "VCD"))

266 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_vcd", 
TRUE
);

267 
	`HAL_DEBUG
(("Disøš % i ¨VideØCD", 
deviû_fe
));

270 ià(!
	`¡rcmp
 (
dœÇme
, "SVCD"))

272 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_svcd", 
TRUE
);

273 
	`HAL_DEBUG
(("Disøš % i ¨Su³¸VideØCD", 
deviû_fe
));

280 ià(
Ën_di
%2 == 1)

282 
	`l£ek
 (
fd
, 1, 
SEEK_CUR
);

283 
pos
++;

287 
pos
 +ğ8 + 
Ën_di
;

288 
cu¼_»cÜd
++;

291 
out
:

293 
	`l£ek
 (
fd
, 0, 
SEEK_SET
);

294 
	}
}

296 *
	gdeviû_fe
;

299 
	$hªdË_sig‹rm
 (
v®ue
)

301 
	`HAL_ERROR
 (("Timed ouˆ´obšg % - brok’ deviû driv”?", 
deviû_fe
));

302 
	`ex™
 (1);

303 
	}
}

306 
	$maš
 (
¬gc
, *
¬gv
[])

308 
fd
;

309 
»t
;

310 *
udi
;

311 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

312 
DBusE¼Ü
 
”rÜ
;

313 *
·»Á_udi
;

314 
vŞume_id
 *
vid
;

315 *
¡Üdev_dev_fe
;

316 *
·¹™iÚ_numb”_¡r
;

317 *
·¹™iÚ_¡¬t_¡r
;

318 *
is_disc_¡r
;

319 *
fsu§ge
;

320 
dbus_boŞ_t
 
is_disc
;

321 
·¹™iÚ_numb”
;

322 
gušt64
 
·¹™iÚ_¡¬t
;

323 
block_size
;

324 
dbus_ušt64_t
 
vŞ_size
;

325 
dbus_boŞ_t
 
should_´obe_fÜ_fs
;

326 
dbus_ušt64_t
 
vŞ_´obe_off£t
 = 0;

327 
LibH®ChªgeS‘
 *
cs
;

328 
gboŞ—n
 
disc_may_have_d©a
;

329 
fd
 = -1;

331 
cs
 = 
NULL
;

332 
disc_may_have_d©a
 = 
FALSE
;

335 
vŞume_id_log_â
 = 
vid_log
;

337 
	`£tup_logg”
 ();

340 
»t
 = 1;

342 ià((
udi
 = 
	`g‘’v
 ("UDI")è=ğ
NULL
)

343 
out
;

344 ià((
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_DEVICE")è=ğ
NULL
)

345 
out
;

346 ià((
·»Á_udi
 = 
	`g‘’v
 ("HAL_PROP_INFO_PARENT")è=ğ
NULL
)

347 
out
;

348 ià(
	`g‘’v
 ("HAL_PROP_LINUX_SYSFS_PATH"è=ğ
NULL
)

349 
out
;

350 
·¹™iÚ_numb”_¡r
 = 
	`g‘’v
 ("HAL_PROP_VOLUME_PARTITION_NUMBER");

351 ià(
·¹™iÚ_numb”_¡r
 !ğ
NULL
)

352 
·¹™iÚ_numb”
 = (è
	`©oi
 (
·¹™iÚ_numb”_¡r
);

354 
·¹™iÚ_numb”
 = () -1;

356 
·¹™iÚ_¡¬t_¡r
 = 
	`g‘’v
 ("HAL_PROP_VOLUME_PARTITION_START");

357 ià(
·¹™iÚ_¡¬t_¡r
 !ğ
NULL
)

358 
·¹™iÚ_¡¬t
 = (
gušt64
è
	`¡¹Şl
 (
·¹™iÚ_¡¬t_¡r
, 
NULL
, 0);

360 
·¹™iÚ_¡¬t
 = (
gušt64
) 0;

362 
is_disc_¡r
 = 
	`g‘’v
 ("HAL_PROP_VOLUME_IS_DISC");

363 ià(
is_disc_¡r
 !ğ
NULL
 && 
	`¡rcmp
 (is_disc_str, "true") == 0)

364 
is_disc
 = 
TRUE
;

366 
is_disc
 = 
FALSE
;

368 
fsu§ge
 = 
	`g‘’v
 ("HAL_PROP_VOLUME_FSUSAGE");

370 
	`dbus_”rÜ_š™
 (&
”rÜ
);

371 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
)

372 
out
;

374 
cs
 = 
	`libh®_deviû_Ãw_chªge£t
 (
udi
);

375 ià(
cs
 =ğ
NULL
) {

376 
	`HAL_DEBUG
(("Cannot initialize changeset"));

377 
out
;

380 
	`HAL_DEBUG
(("Došg…robe-vŞumfÜ %s\n", 
deviû_fe
));

383 
	`sigÇl
 (
SIGTERM
, 
hªdË_sig‹rm
);

385 
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
);

386 ià(
fd
 < 0)

387 
out
;

390 ià(
	`ioùl
 (
fd
, 
BLKSSZGET
, &
block_size
) == 0) {

391 
	`HAL_DEBUG
(("vŞume.block_sizğ%d", 
block_size
));

392 
	`libh®_chªge£t_£t_´İ”ty_št
 (
cs
, "vŞume.block_size", 
block_size
);

394 ià(
	`ioùl
 (
fd
, 
BLKGETSIZE64
, &
vŞ_size
) == 0) {

395 
	`HAL_DEBUG
(("vŞume.sizğ%Îu", 
vŞ_size
));

396 
	`libh®_chªge£t_£t_´İ”ty_ušt64
 (
cs
, "vŞume.size", 
vŞ_size
);

398 
vŞ_size
 = 0;

400 
should_´obe_fÜ_fs
 = 
TRUE
;

402 ià(
is_disc
) {

403 
ty³
;

404 
gušt64
 
ÿ·c™y
;

405 
cdrom_tochdr
 
toc_hdr
;

408 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "unknown");

409 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.has_audio", 
FALSE
);

410 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.has_d©a", 
FALSE
);

411 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_bÏnk", 
FALSE
);

412 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_­³ndabË", 
FALSE
);

413 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_»wr™abË", 
FALSE
);

417 ià(
	`ioùl
 (
fd
, 
CDROM_DRIVE_STATUS
, 
CDSL_CURRENT
è!ğ
CDS_DISC_OK
) {

418 
out
;

422 
ty³
 = 
	`ioùl
 (
fd
, 
CDROM_DISC_STATUS
, 
CDSL_CURRENT
);

423 
ty³
) {

424 
CDS_AUDIO
:

425 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.has_audio", 
TRUE
);

426 
	`HAL_DEBUG
(("Disøš % ha audio", 
deviû_fe
));

427 
should_´obe_fÜ_fs
 = 
FALSE
;

429 
CDS_MIXED
:

430 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.has_audio", 
TRUE
);

431 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.has_d©a", 
TRUE
);

432 
	`HAL_DEBUG
(("Disøš % ha audio+d©a", 
deviû_fe
));

434 
CDS_DATA_1
:

435 
CDS_DATA_2
:

436 
CDS_XA_2_1
:

437 
CDS_XA_2_2
:

438 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.has_d©a", 
TRUE
);

439 
	`HAL_DEBUG
(("Disøš % ha d©a", 
deviû_fe
));

440 
	`advªûd_disc_d‘eù
 (
cs
, 
fd
, 
deviû_fe
);

442 
CDS_NO_INFO
:

443 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_bÏnk", 
TRUE
);

445 
	`libh®_chªge£t_£t_´İ”ty_št
 (
cs
, "volume.block_size", 0);

446 
	`HAL_DEBUG
(("Disøš % ´obably bÏnk", 
deviû_fe
));

453 ià(
vŞ_size
 > 0x800) {

454 
should_´obe_fÜ_fs
 = 
TRUE
;

455 
disc_may_have_d©a
 = 
TRUE
;

457 
should_´obe_fÜ_fs
 = 
FALSE
;

462 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc_type", "unknown");

463 
	`HAL_DEBUG
(("Disøš % »tuºed unknowÀCDROM_DISC_STATUS", 
deviû_fe
));

464 
should_´obe_fÜ_fs
 = 
FALSE
;

471 
ty³
 = 
	`g‘_disc_ty³
 (
fd
);

472 
	`HAL_DEBUG
(("g‘_disc_ty³„‘uºed 0x%02x", 
ty³
));

473 ià(
ty³
 != -1) {

474 
ty³
) {

477 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "mo");

478 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_»wr™abË", 
TRUE
);

481 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "mo");

484 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "cd_rom");

487 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "cd_r");

490 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "cd_rw");

491 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_»wr™abË", 
TRUE
);

494 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "dvd_rom");

497 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "dvd_r");

500 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "dvd_ram");

501 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_»wr™abË", 
TRUE
);

505 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "dvd_rw");

506 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_»wr™abË", 
TRUE
);

510 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "dvd_r_dl");

513 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "dvd_plus_rw");

514 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_»wr™abË", 
TRUE
);

517 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "dvd_plus_r");

520 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "dvd_plus_r_dl");

523 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "bd_rom");

527 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "bd_r");

530 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "bd_re");

531 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_»wr™abË", 
TRUE
);

534 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "hddvd_rom");

537 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "hddvd_r");

540 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.disc.type", "hddvd_rw");

541 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_»wr™abË", 
TRUE
);

548 ià(
	`g‘_disc_ÿ·c™y_fÜ_ty³
 (
fd
, 
ty³
, &
ÿ·c™y
) == 0) {

549 
	`HAL_DEBUG
(("vŞume.disc.ÿ·c™y = %Îu", 
ÿ·c™y
));

550 
	`libh®_chªge£t_£t_´İ”ty_ušt64
 (
cs
, "vŞume.disc.ÿ·c™y", 
ÿ·c™y
);

554 ià(
	`disc_is_»wr™abË
 (
fd
)) {

555 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_»wr™abË", 
TRUE
);

558 ià(
	`disc_is_­³ndabË
 (
fd
)) {

559 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_­³ndabË", 
TRUE
);

578 ià(
	`ioùl
 (
fd
, 
CDROMREADTOCHDR
, &
toc_hdr
) == 0) {

579 
cdrom_toûÁry
 
toc_’Œ
;

580 
vŞ_£ssiÚ_couÁ
 = 0;

582 
vŞ_£ssiÚ_couÁ
 = 
toc_hdr
.
cdth_Œk1
;

583 
	`HAL_DEBUG
(("vŞume_£ssiÚ_couÁ = %u", 
vŞ_£ssiÚ_couÁ
));

586 
	`mem£t
 (&
toc_’Œ
, 0x00,  (toc_entr));

587 
toc_’Œ
.
cd‹_Œack
 = 
vŞ_£ssiÚ_couÁ
;

588 
toc_’Œ
.
cd‹_fÜm©
 = 
CDROM_LBA
;

589 ià(
	`ioùl
 (
fd
, 
CDROMREADTOCENTRY
, &
toc_’Œ
) == 0) {

590 ià(
toc_’Œ
.
cd‹_ù¾
 & 
CDROM_DATA_TRACK
) {

591 
	`HAL_DEBUG
 (("Ï¡ sessiÚ s¹ © block = %u", 
toc_’Œ
.
cd‹_addr
.
lba
));

592 
vŞ_´obe_off£t
 = 
toc_’Œ
.
cd‹_addr
.
lba
 * 
block_size
;

598 ià(
vŞ_´obe_off£t
 == 0) {

599 
cdrom_muÉi£ssiÚ
 
ms_šfo
;

601 
	`mem£t
(&
ms_šfo
, 0x00, (ms_info));

602 
ms_šfo
.
addr_fÜm©
 = 
CDROM_LBA
;

603 ià(
	`ioùl
(
fd
, 
CDROMMULTISESSION
, &
ms_šfo
) == 0) {

604 ià(!
ms_šfo
.
xa_æag
) {

605 
vŞ_´obe_off£t
 = 
ms_šfo
.
addr
.
lba
 * 
block_size
;

611 ià(
fsu§ge
 !ğ
NULL
 && 
	`¡¾’
(fsusage) > 0) {

612 
	`HAL_DEBUG
(("have‡lready information‡bout fsusage from udev,‚o‚eedo…robe for filesystem"));

613 
should_´obe_fÜ_fs
 = 
FALSE
;

616 ià(
should_´obe_fÜ_fs
) {

618 
	`HAL_DEBUG
(("start…robing for filesystem ..."));

620 ià((
¡Üdev_dev_fe
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (

621 
ùx
, 
·»Á_udi
, "block.deviû", &
”rÜ
)è=ğ
NULL
) {

622 
out
;

629 ià(
is_disc
) {

630 
vŞ_size
 = 0;

634 
vid
 = 
	`vŞume_id_İ’_fd
 (
fd
);

635 ià(
vid
 !ğ
NULL
) {

636 
vid_»t
;

637 
	`HAL_INFO
 (("švokšg vŞume_id_´obe_®l, off£t=%d, size=%d", 
vŞ_´obe_off£t
, 
vŞ_size
));

638 
vid_»t
 = 
	`vŞume_id_´obe_®l
 (
vid
, 
vŞ_´obe_off£t
, 
vŞ_size
);

639 
	`HAL_INFO
 (("vŞume_id_´obe_®È»tuºed %d", 
vid_»t
));

641 ià(
vid_»t
 !ğ0 && 
is_disc
 && 
vŞ_´obe_off£t
 != 0) {

644 
	`HAL_INFO
 (("švokšg vŞume_id_´obe_®l, off£t=0, size=%d", 
vŞ_size
));

645 
vid_»t
 = 
	`vŞume_id_´obe_®l
 (
vid
, 0 , 
vŞ_size
);

646 
	`HAL_INFO
 (("vŞume_id_´obe_®È»tuºed %d", 
vid_»t
));

649 ià(
vid_»t
 == 0) {

650 
	`£t_vŞume_id_v®ues
(
cs
, 
vid
);

651 ià(
disc_may_have_d©a
) {

652 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_bÏnk", 
FALSE
);

653 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.has_d©a", 
TRUE
);

656 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "info.product", "Volume");

666 ià(
vid_»t
 !ğ0 && 
is_disc
) {

667 
P¬t™iÚTabË
 *
p
;

668 
p
 = 
	`·¹_bË_lßd_äom_disk
 (
¡Üdev_dev_fe
);

669 ià(
p
 !ğ
NULL
) {

670 
i
;

672 
	`HAL_INFO
 (("Partitionable with scheme '%s' on optical disc",

673 
	`·¹_g‘_scheme_Çme
 (
	`·¹_bË_g‘_scheme
 (
p
))));

675 
i
 = 0; i < 
	`·¹_bË_g‘_num_’Œ›s
 (
p
); i++) {

676 *
·¹_ty³
;

678 
·¹_ty³
 = 
	`·¹_bË_’Œy_g‘_ty³
 (
p
, 
i
);

679 
	`HAL_INFO
 (("…¬t™iÚ %d ha ty³ '%s'", 
i
, 
·¹_ty³
));

680 ià(
	`¡rcmp
 (
·¹_ty³
, "Apple_HFS") == 0) {

681 
gušt64
 
·¹_off£t
;

683 
·¹_off£t
 = 
	`·¹_bË_’Œy_g‘_off£t
 (
p
, 
i
);

684 ià(
	`vŞume_id_´obe_®l
 (

685 
vid
, 
vŞ_´obe_off£t
 + 
·¹_off£t
, 0) == 0) {

687 
	`£t_vŞume_id_v®ues
(
cs
, 
vid
);

693 
	`g_ä“
 (
·¹_ty³
);

697 
	`HAL_INFO
 (("Done†ooking‡t…artable"));

698 
	`·¹_bË_ä“
 (
p
);

702 
	`vŞume_id_şo£
(
vid
);

706 ià(
·¹™iÚ_numb”_¡r
 !ğ
NULL
 &&

707 
·¹™iÚ_numb”
 <= 256 &&…artition_number > 0 &&

708 
·¹™iÚ_¡¬t
 > 0) {

709 
P¬t™iÚTabË
 *
p
;

711 
	`HAL_INFO
 (("Loading…artable"));

712 
p
 = 
	`·¹_bË_lßd_äom_disk
 (
¡Üdev_dev_fe
);

713 ià(
p
 !ğ
NULL
) {

714 
P¬t™iÚTabË
 *
p2
;

715 
’Œy
;

717 
	`HAL_INFO
 (("Looking‡t…artable"));

718 
	`·¹_bË_fšd
 (
p
, 
·¹™iÚ_¡¬t
, &
p2
, &
’Œy
);

719 ià(
’Œy
 >= 0) {

720 cÚ¡ *
scheme
;

721 *
ty³
;

722 *
Ïb–
;

723 *
uuid
;

724 **
æags
;

726 
scheme
 = 
	`·¹_g‘_scheme_Çme
 (
	`·¹_bË_g‘_scheme
 (
p2
));

727 
ty³
 = 
	`·¹_bË_’Œy_g‘_ty³
 (
p2
, 
’Œy
);

728 
Ïb–
 = 
	`·¹_bË_’Œy_g‘_Ïb–
 (
p2
, 
’Œy
);

729 
uuid
 = 
	`·¹_bË_’Œy_g‘_uuid
 (
p2
, 
’Œy
);

730 
æags
 = 
	`·¹_bË_’Œy_g‘_æags
 (
p2
, 
’Œy
);

732 ià(
ty³
 =ğ
NULL
)

733 
ty³
 = 
	`g_¡rdup
 ("");

734 ià(
Ïb–
 =ğ
NULL
)

735 
Ïb–
 = 
	`g_¡rdup
 ("");

736 ià(
uuid
 =ğ
NULL
)

737 
uuid
 = 
	`g_¡rdup
 ("");

738 ià(
æags
 =ğ
NULL
) {

739 
æags
 = 
	`g_Ãw0
 (*, 2);

740 
æags
[0] = 
NULL
;

743 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.·¹™iÚ.scheme", 
scheme
);

744 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.·¹™iÚ.ty³", 
ty³
);

745 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.·¹™iÚ.Ïb–", 
Ïb–
);

746 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.·¹™iÚ.uuid", 
uuid
);

747 
	`libh®_chªge£t_£t_´İ”ty_¡¾i¡
 (
cs
, "vŞume.·¹™iÚ.æags", (cÚ¡ **è
æags
);

763 ((
	`¡rcmp
 (
scheme
, "mbr") == 0 || strcmp (scheme, "embr") == 0) &&

764 (0xfd =ğ
	`©oi
 (
ty³
) || 0x8e ==‡toi (type)))

766 ((
	`¡rcmp
 (
scheme
, "gpt") == 0) &&

767 ((
	`¡rcmp
 (
ty³
, "A19D880F-05FC-4D3B-A006-743F0F84911E") == 0) ||

768 (
	`¡rcmp
 (
ty³
, "E6D6D379-F507-44C2-A23C-238F2A3DF928")) == 0)) ) {

770 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.fsusage", "raid");

775 ià(
	`·¹_bË_’Œy_g‘_Ã¡ed
 (
p2
, 
’Œy
è!ğ
NULL
) {

777 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.fsusage", "partitiontable");

778 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.fstype", "");

779 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.fsversion", "");

782 
	`g_ä“
 (
ty³
);

783 
	`g_ä“
 (
Ïb–
);

784 
	`g_ä“
 (
uuid
);

785 
	`g_¡rä“v
 (
æags
);

788 
	`·¹_bË_ä“
 (
p
);

790 
	`HAL_INFO
 (("Done†ooking‡t…artable"));

792 
	`libh®_ä“_¡ršg
 (
¡Üdev_dev_fe
);

797 
»t
 = 0;

799 
out
:

800 ià(
cs
 !ğ
NULL
) {

805 
	`libh®_deviû_comm™_chªge£t
 (
ùx
, 
cs
, &
”rÜ
);

806 
	`libh®_deviû_ä“_chªge£t
 (
cs
);

810 ià(
fd
 >= 0)

811 
	`şo£
 (
fd
);

813 ià(
ùx
 !ğ
NULL
) {

814 
	`dbus_”rÜ_š™
 (&
”rÜ
);

815 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

816 
	`libh®_ùx_ä“
 (
ùx
);

819  
»t
;

821 
	}
}

	@hald/logger.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dio.h
>

32 
	~<¡dlib.h
>

33 
	~<¡ršg.h
>

34 
	~<¡d¬g.h
>

35 
	~<time.h
>

36 
	~<sys/time.h
>

37 
	~<sy¦og.h
>

38 
	~<uni¡d.h
>

40 
	~"logg”.h
"

42 
	g´iÜ™y
;

43 cÚ¡ *
	gfe
;

44 
	glše
;

45 cÚ¡ *
	gfunùiÚ
;

47 
	glog_pid
 = 0;

48 
	gis_’abËd
 = 1;

49 
	gsy¦og_’abËd
 = 0;

59 
	$logg”_di§bË
 ()

61 
is_’abËd
 = 0;

62 
	}
}

71 
	$logg”_’abË
 ()

73 
is_’abËd
 = 1;

74 
	}
}

83 
	$logg”_’abË_sy¦og
 ()

85 
sy¦og_’abËd
 = 1;

86 
	}
}

95 
	$logg”_di§bË_sy¦og
 ()

97 
sy¦og_’abËd
 = 0;

98 
	}
}

107 
	$£tup_logg”
 ()

109 ià((
	`g‘’v
 ("HALD_VERBOSE")è!ğ
NULL
) {

110 
is_’abËd
 = 1;

111 
log_pid
 = 1;

114 
is_’abËd
 = 0;

116 ià((
	`g‘’v
 ("HALD_USE_SYSLOG")è!ğ
NULL
)

117 
sy¦og_’abËd
 = 1;

119 
sy¦og_’abËd
 = 0;

120 
	}
}

132 
	$logg”_£tup
 (
_´iÜ™y
, cÚ¡ *
_fe
, 
_lše
, cÚ¡ *
_funùiÚ
)

134 
´iÜ™y
 = 
_´iÜ™y
;

135 
fe
 = 
_fe
;

136 
lše
 = 
_lše
;

137 
funùiÚ
 = 
_funùiÚ
;

138 
	}
}

148 
	$logg”_em™
 (cÚ¡ *
fÜm©
, ...)

150 
va_li¡
 
¬gs
;

151 
buf
[512];

152 *
´i
;

153 
tbuf
[256];

154 
logmsg
[1024];

155 
timev®
 
Šow
;

156 
tm
 *
oÿÉime
;

157 
timezÚe
 
tzÚe
;

158 
pid_t
 
pid
 = -1;

160 ià(!
is_’abËd
)

163 
	`va_¡¬t
 (
¬gs
, 
fÜm©
);

164 
	`v¢´štf
 (
buf
,  (buf), 
fÜm©
, 
¬gs
);

166 
´iÜ™y
) {

167 
HAL_LOGPRI_TRACE
:

168 
´i
 = "[T]";

170 
HAL_LOGPRI_DEBUG
:

171 
´i
 = "[D]";

173 
HAL_LOGPRI_INFO
:

174 
´i
 = "[I]";

176 
HAL_LOGPRI_WARNING
:

177 
´i
 = "[W]";

180 
HAL_LOGPRI_ERROR
:

181 
´i
 = "[E]";

185 
	`g‘timeofday
 (&
Šow
, &
tzÚe
);

186 
oÿÉime
 = 
	`loÿÉime
 ((
time_t
 *è&
Šow
.
tv_£c
);

187 
	`¡ráime
 (
tbuf
,  (tbuf), "%H:%M:%S", 
oÿÉime
);

189 ià(
log_pid
) {

190 ià((è
pid
 == -1)

191 
pid
 = 
	`g‘pid
 ();

192 
	`¢´štf
 (
logmsg
, Öogmsg), "[%d]: %s.%03d % %s:%d: %s\n", 
pid
, 
tbuf
, ()(
Šow
.
tv_u£c
/1000), 
´i
, 
fe
, 
lše
, 
buf
);

194 
	`¢´štf
 (
logmsg
, Öogmsg), "%s.%03d % %s:%d: %s\n", 
tbuf
, ()(
Šow
.
tv_u£c
/1000), 
´i
, 
fe
, 
lše
, 
buf
);

198 ià(
´iÜ™y
 !ğ
HAL_LOGPRI_TRACE
 && !
sy¦og_’abËd
 ) {

199 
	`årštf
 (
¡d”r
, "%s", 
logmsg
 );

200 } ià(
´iÜ™y
 !ğ
HAL_LOGPRI_TRACE
 && 
sy¦og_’abËd
 ) {

202 
´iÜ™y
) {

203 
HAL_LOGPRI_DEBUG
:

204 
HAL_LOGPRI_INFO
:

205 
	`sy¦og
(
LOG_INFO
, "%s", 
logmsg
 );

207 
HAL_LOGPRI_WARNING
:

208 
	`sy¦og
(
LOG_WARNING
, "%s", 
logmsg
 );

211 
HAL_LOGPRI_ERROR
:

212 
	`sy¦og
(
LOG_ERR
, "%s", 
logmsg
 );

217 
	`va_’d
 (
¬gs
);

218 
	}
}

228 
	$logg”_fÜw¬d_debug
 (cÚ¡ *
fÜm©
, ...)

230 
va_li¡
 
¬gs
;

231 
buf
[512];

232 
tbuf
[256];

233 
timev®
 
Šow
;

234 
tm
 *
oÿÉime
;

235 
timezÚe
 
tzÚe
;

236 
pid_t
 
pid
 = -1;

238 ià(!
is_’abËd
)

241 ià((è
pid
 == -1)

242 
pid
 = 
	`g‘pid
 ();

244 
	`va_¡¬t
 (
¬gs
, 
fÜm©
);

245 
	`v¢´štf
 (
buf
,  (buf), 
fÜm©
, 
¬gs
);

247 
	`g‘timeofday
 (&
Šow
, &
tzÚe
);

248 
oÿÉime
 = 
	`loÿÉime
 ((
time_t
 *è&
Šow
.
tv_£c
);

249 
	`¡ráime
 (
tbuf
,  (tbuf), "%H:%M:%S", 
oÿÉime
);

251 ià(
sy¦og_’abËd
)

252 
	`sy¦og
 (
LOG_INFO
, "%d: %s.%03d: %s", 
pid
, 
tbuf
, ()(
Šow
.
tv_u£c
/1000), 
buf
);

254 
	`årštf
 (
¡d”r
, "%d: %s.%03d: %s", 
pid
, 
tbuf
, ()(
Šow
.
tv_u£c
/1000), 
buf
);

256 
	`va_’d
 (
¬gs
);

257 
	}
}

	@hald/logger.h

26 #ifdeà
__ılu¥lus


30 #iâdeà
LOGGER_H


31 
	#LOGGER_H


	)

33 
	~<¡dio.h
>

34 
	~<¡dlib.h
>

38 
HAL_LOGPRI_TRACE
 = (1 << 0),

39 
HAL_LOGPRI_DEBUG
 = (1 << 1),

40 
HAL_LOGPRI_INFO
 = (1 << 2),

41 
HAL_LOGPRI_WARNING
 = (1 << 3),

42 
HAL_LOGPRI_ERROR
 = (1 << 4)

45 
logg”_£tup
 (
´iÜ™y
, cÚ¡ *
fe
, 
lše
, cÚ¡ *
funùiÚ
);

47 
logg”_em™
 (cÚ¡ *
fÜm©
, ...);

49 
logg”_fÜw¬d_debug
 (cÚ¡ *
fÜm©
, ...);

51 
logg”_’abË
 ();

52 
logg”_di§bË
 ();

54 
logg”_’abË_sy¦og
 ();

55 
logg”_di§bË_sy¦og
 ();

57 
£tup_logg”
 ();

59 #ifdeà
__SUNPRO_C


60 
	#__FUNCTION__
 
__func__


	)

64 
	#HAL_TRACE
(
ex´
èdØ{
	`logg”_£tup
(
HAL_LOGPRI_TRACE
, 
__FILE__
, 
__LINE__
, 
__FUNCTION__
); 
logg”_em™
ƒx´; } 0)

	)

67 
	#HAL_DEBUG
(
ex´
èdØ{
	`logg”_£tup
(
HAL_LOGPRI_DEBUG
, 
__FILE__
, 
__LINE__
, 
__FUNCTION__
); 
logg”_em™
ƒx´; } 0)

	)

70 
	#HAL_INFO
(
ex´
èdØ{
	`logg”_£tup
(
HAL_LOGPRI_INFO
, 
__FILE__
, 
__LINE__
, 
__FUNCTION__
); 
logg”_em™
ƒx´; } 0)

	)

73 
	#HAL_WARNING
(
ex´
èdØ{
	`logg”_£tup
(
HAL_LOGPRI_WARNING
, 
__FILE__
, 
__LINE__
, 
__FUNCTION__
); 
logg”_em™
ƒx´; } 0)

	)

76 
	#HAL_ERROR
(
ex´
èdØ{
	`logg”_£tup
(
HAL_LOGPRI_ERROR
, 
__FILE__
, 
__LINE__
, 
__FUNCTION__
); 
logg”_em™
ƒx´; } 0)

	)

79 
	#DIE
(
ex´
èdØ{
	`´štf
("*** [DIE] %s:%s():%d : ", 
__FILE__
, 
__FUNCTION__
, 
__LINE__
); 
´štf
ƒx´;…rštf("\n"); 
	`ex™
(1); } 0)

	)

83 #ifdeà
__ılu¥lus


	@hald/mmap_cache.c

30 
	~<cÚfig.h
>

31 
	~<sys/ty³s.h
>

32 
	~<sys/¡©.h
>

33 
	~<sys/mmª.h
>

34 
	~<sys/wa™.h
>

35 
	~<fú.h
>

36 
	~<¡dlib.h
>

37 
	~<”ºo.h
>

38 
	~<¡ršg.h
>

39 
	~<uni¡d.h
>

40 
	~<lim™s.h
>

41 
	~<dœ’t.h
>

43 
	~"logg”.h
"

44 
	~"ruË.h
"

45 
	~"mm­_ÿche.h
"

46 
	~"h®d_ruÂ”.h
"

47 
	~"h®-fe-mÚ™Ü.h
"

48 
	~"os¥ec.h
"

50 *
ruËs_±r
;

51 
size_t
 
	gruËs_size
 = 0;

53 
	$di_ruËs_š™
 ()

55 
ÿche_h—d”
 *
h—d”
;

56 *
ÿch’ame
;

57 
fd
;

58 
¡©
 
¡©buf
;

60 
ÿch’ame
 = 
	`g‘’v
 ("HAL_FDI_CACHE_NAME");

61 if(
ÿch’ame
 =ğ
NULL
)

62 
ÿch’ame
 = 
HALD_CACHE_FILE
;

64 ià(
ruËs_±r
 !ğ
NULL
) {

65 
	`HAL_INFO
 (("Unmapping old cache file"));

66 
	`munm­
 (
ruËs_±r
, 
ruËs_size
);

69 if((
fd
 = 
	`İ’
 (
ÿch’ame
, 
O_RDONLY
)) < 0)

70 
	`DIE
(("UÇbËØİ’ cach%s\n", 
ÿch’ame
));

72 if(
	`f¡©
 (
fd
,&
¡©buf
) < 0)

73 
	`DIE
(("UÇbËØ¡© cach%s\n", 
ÿch’ame
));

75 
ruËs_size
 = 
¡©buf
.
¡_size
;

77 
ruËs_±r
 = 
	`mm­
 (
NULL
, 
¡©buf
.
¡_size
, 
PROT_READ
, 
MAP_SHARED
, 
fd
, 0);

78 if(
ruËs_±r
 =ğ
MAP_FAILED
)

79 
	`DIE
 (("Couldn'ˆmm­ f'%s',ƒ¼no=%d: %s", 
ÿch’ame
, 
”ºo
, 
	`¡»¼Ü
 (errno)));

81 
h—d”
 = (
ÿche_h—d”
*è
ruËs_±r
;

82 
	`HAL_INFO
(("´•robe: off£t=%08lx, size=%d", 
h—d”
->
fdi_ruËs_´•robe
,

83 
h—d”
->
fdi_ruËs_šfÜm©iÚ
 - h—d”->
fdi_ruËs_´•robe
));

84 
	`HAL_INFO
(("šfÜm©iÚ: off£t=%08lx, size=%d", 
h—d”
->
fdi_ruËs_šfÜm©iÚ
,

85 
h—d”
->
fdi_ruËs_pŞicy
 - h—d”->
fdi_ruËs_šfÜm©iÚ
));

86 
	`HAL_INFO
(("pŞicy: off£t=%08lx, size=%d", 
h—d”
->
fdi_ruËs_pŞicy
,

87 
h—d”
->
®l_ruËs_size
 - h—d”->
fdi_ruËs_pŞicy
));

89 
	`şo£
(
fd
);

92 
	}
}

94 
gšt
 
	g»g’_ÿche_sucûss
;

97 
	$»g’_ÿche_cb
 (
H®Deviû
 *
d
,

98 
gušt32
 
ex™_ty³
,

99 
gšt
 
»tuº_code
,

100 
gch¬
 **
”rÜ
,

101 
gpoš‹r
 
d©a1
,

102 
gpoš‹r
 
d©a2
)

104 
	`HAL_INFO
 (("IÀ»g’_ÿche_cbƒx™_ty³=%d,„‘uº_code=%d", 
ex™_ty³
, 
»tuº_code
));

107 ià(
ex™_ty³
 =ğ
HALD_RUN_SUCCESS
 && ( 
»tuº_code
 == 0 ||„eturn_code == 2)) {

108 
»g’_ÿche_sucûss
 = 
TRUE
;

110 
»g’_ÿche_sucûss
 = 
FALSE
;

112 
	}
}

116 
	$»g’_ÿche
 ()

118 
n
, 
m
;

119 *
exŒa_’v
[5] = {
NULL
, NULL, NULL, NULL, NULL};

120 *
’v_Çmes
[5] = {"HAL_FDI_SOURCE_PREPROBE",

124 
NULL
};

126 
	`HAL_INFO
 (("Regenerating fdi cache.."));

129 
n
 = 0, 
m
 = 0; 
’v_Çmes
[n] !ğ
NULL
;‚++) {

130 *
Çme
;

131 *
v®
;

133 
Çme
 = 
’v_Çmes
[
n
];

134 
v®
 = 
	`g‘’v
(
Çme
);

135 ià(
v®
 !ğ
NULL
) {

136 
exŒa_’v
 [
m
++] = 
	`g_¡rdup_´štf
 ("%s=%s", 
Çme
, 
v®
);

140 
	`h®d_ruÂ”_run_sync
 (
NULL
,

142 
exŒa_’v
,

144 
»g’_ÿche_cb
,

145 
NULL
,

146 
NULL
);

148 
n
 = 0; 
exŒa_’v
[n] !ğ
NULL
;‚++) {

149 
	`g_ä“
 (
exŒa_’v
[
n
]);

152 ià(!
»g’_ÿche_sucûss
) {

153 
	`HAL_ERROR
 (("fdi cache„egeneration failed!"));

156 
	`HAL_INFO
 (("fdi cache generation done"));

157 
	}
}

159 
gboŞ—n
 
	gÿche_v®id
 = 
FALSE
;

162 
	$ÿche_šv®id©ed
 (
H®FeMÚ™Ü
 *
mÚ™Ü
,

163 
H®FeMÚ™ÜEv’t
 
ev’t
,

164 cÚ¡ *
·th
,

165 
gpoš‹r
 
u£r_d©a
)

167 
	`HAL_INFO
 (("dœ '%s' chªged - m¬kšg fd˜ÿcha šv®id", 
·th
));

168 
ÿche_v®id
 = 
FALSE
;

169 
	}
}

172 
	$dœ_mtime
 (cÚ¡ *
·th
, 
time_t
 *
mt
, 
gboŞ—n
 
£tup_w©ches
)

174 
dœ’t
 **
Çm–i¡
;

175 
¡©
 
¡
;

176 
n
;

178 ià(
£tup_w©ches
) {

179 
H®FeMÚ™Ü
 *
fe_mÚ™Ü
;

181 
fe_mÚ™Ü
 = 
	`os¥ec_g‘_fe_mÚ™Ü
 ();

182 ià(
fe_mÚ™Ü
 !ğ
NULL
) {

183 
	`h®_fe_mÚ™Ü_add_nÙify
 (
fe_mÚ™Ü
,

184 
·th
,

185 
HAL_FILE_MONITOR_EVENT_CREATE
|

186 
HAL_FILE_MONITOR_EVENT_DELETE
|

187 
HAL_FILE_MONITOR_EVENT_CHANGE
,

188 
ÿche_šv®id©ed
,

189 
NULL
);

193 ià(!
	`¡©
(
·th
, &
¡
)) {

194 if(
¡
.
¡_mtime
 > *
mt
)

195 *
mt
 = 
¡
.
¡_mtime
;

197 if(
	`S_ISDIR
(
¡
.
¡_mode
)) {

198 
n
 = 
	`sÿndœ
(
·th
, &
Çm–i¡
, 0, 
®phasÜt
);

199 ià(
n
 < 0)

202 
n
--) {

203 
gch¬
 *
ı©h
;

204 
ı©h
 = 
	`g_bud_f’ame
(
·th
, 
Çm–i¡
[
n
]->
d_Çme
, 
NULL
);

205 if(
Çm–i¡
[
n
]->
d_Çme
[0] != '.')

206 
	`dœ_mtime
(
ı©h
, 
mt
, 
£tup_w©ches
);

208 
	`ä“
(
Çm–i¡
[
n
]);

209 
	`g_ä“
(
ı©h
);

211 
	`ä“
(
Çm–i¡
);

215 
	}
}

217 
gboŞ—n


218 
	$di_ÿche_coh”’cy_check
 (
gboŞ—n
 
£tup_w©ches
)

220 *
h®_fdi_sourû_´•robe
;

221 *
h®_fdi_sourû_šfÜm©iÚ
;

222 *
h®_fdi_sourû_pŞicy
;

223 *
ÿch’ame
;

224 
time_t
 
mt
;

225 
¡©
 
¡
;

226 
gboŞ—n
 
did_»g’
;

228 ià(
ÿche_v®id
)

229  
FALSE
;

231 
did_»g’
 = 
FALSE
;

233 
mt
 = 0;

234 
h®_fdi_sourû_´•robe
 = 
	`g‘’v
 ("HAL_FDI_SOURCE_PREPROBE");

235 
h®_fdi_sourû_šfÜm©iÚ
 = 
	`g‘’v
 ("HAL_FDI_SOURCE_INFORMATION");

236 
h®_fdi_sourû_pŞicy
 = 
	`g‘’v
 ("HAL_FDI_SOURCE_POLICY");

238 ià(
h®_fdi_sourû_´•robe
 !ğ
NULL
) {

239 
	`dœ_mtime
 (
h®_fdi_sourû_´•robe
, &
mt
, 
£tup_w©ches
);

241 
	`dœ_mtime
 (
PACKAGE_DATA_DIR
 "/h®/fdi/´•robe", &
mt
, 
£tup_w©ches
);

242 
	`dœ_mtime
 (
PACKAGE_SYSCONF_DIR
 "/h®/fdi/´•robe", &
mt
, 
£tup_w©ches
);

245 ià(
h®_fdi_sourû_šfÜm©iÚ
 !ğ
NULL
) {

246 
	`dœ_mtime
 (
h®_fdi_sourû_šfÜm©iÚ
, &
mt
, 
£tup_w©ches
);

248 
	`dœ_mtime
 (
PACKAGE_DATA_DIR
 "/h®/fdi/šfÜm©iÚ", &
mt
, 
£tup_w©ches
);

249 
	`dœ_mtime
 (
PACKAGE_SYSCONF_DIR
 "/h®/fdi/šfÜm©iÚ", &
mt
, 
£tup_w©ches
);

252 ià(
h®_fdi_sourû_pŞicy
 !ğ
NULL
) {

253 
	`dœ_mtime
 (
h®_fdi_sourû_pŞicy
, &
mt
, 
£tup_w©ches
);

255 
	`dœ_mtime
 (
PACKAGE_DATA_DIR
 "/h®/fdi/pŞicy", &
mt
, 
£tup_w©ches
);

256 
	`dœ_mtime
 (
PACKAGE_SYSCONF_DIR
 "/h®/fdi/pŞicy", &
mt
, 
£tup_w©ches
);

259 
ÿch’ame
 = 
	`g‘’v
 ("HAL_FDI_CACHE_NAME");

260 if(
ÿch’ame
 =ğ
NULL
)

261 
ÿch’ame
 = 
HALD_CACHE_FILE
;

263 if(
	`¡©
 (
ÿch’ame
, &
¡
) == 0) {

264 if(
¡
.
¡_mtime
 < 
mt
) {

265 
	`HAL_INFO
(("Cache‚eeds update"));

266 
	`»g’_ÿche
();

267 
did_»g’
 = 
TRUE
;

268 } ià(
¡
.
¡_size
 == 0) {

269 
	`HAL_INFO
(("Cache zero size, so„egenerating"));

270 
	`»g’_ÿche
();

271 
did_»g’
 = 
TRUE
;

274 
	`»g’_ÿche
();

275 
did_»g’
 = 
TRUE
;

278 
	`HAL_INFO
(("ÿchmtimi %d",
mt
));

280 
ÿche_v®id
 = 
TRUE
;

282  
did_»g’
;

283 
	}
}

	@hald/mmap_cache.h

31 #iâdeà
__MMAP_CACHE_H__


32 
	#__MMAP_CACHE_H__


	)

34 
	~<glib.h
>

36 
di_ruËs_š™
 ();

37 
gboŞ—n
 
di_ÿche_coh”’cy_check
 (gboŞ—À
£tup_w©ches
);

39 
	#RULES_PTR
(
x
è((*)((*è
ruËs_±r
 + x))

	)

	@hald/osspec.h

26 #iâdeà
OSSPEC_H


27 
	#OSSPEC_H


	)

29 
	~<¡d¬g.h
>

30 
	~<¡dšt.h
>

31 
	~<dbus/dbus.h
>

33 
	~"deviû.h
"

34 
	~"h®-fe-mÚ™Ü.h
"

37 
os¥ec_´iveged_š™
 ();

40 
os¥ec_š™
 ();

43 
os¥ec_´obe
 ();

46 
os¥ec_´obe_dÚe
 ();

48 
gboŞ—n
 
os¥ec_deviû_»sÿn
 (
H®Deviû
 *
d
);

50 
gboŞ—n
 
os¥ec_deviû_»´obe
 (
H®Deviû
 *
d
);

53 
os¥ec_»äesh_mouÁ_¡©e_fÜ_block_deviû
 (
H®Deviû
 *
d
);

63 
DBusHªdËrResuÉ
 
os¥ec_f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£r_d©a
);

65 
H®FeMÚ™Ü
 *
os¥ec_g‘_fe_mÚ™Ü
 ();

	@hald/rule.h

30 #iâdeà
__RULE_H__


31 
	#__RULE__H__


	)

35 
	mRULE_UNKNOWN
,

36 
	mRULE_MATCH
,

37 
	mRULE_MERGE
,

38 
	mRULE_APPEND
,

39 
	mRULE_PREPEND
,

40 
	mRULE_REMOVE
,

41 
	mRULE_CLEAR
,

42 
	mRULE_SPAWN
,

43 
	mRULE_EOF
,

44 
	mRULE_ADDSET


45 } 
	truË_ty³
;

49 
	mMERGE_UNKNOWN
,

50 
	mMERGE_STRING
,

51 
	mMERGE_BOOLEAN
,

52 
	mMERGE_INT32
,

53 
	mMERGE_UINT64
,

54 
	mMERGE_DOUBLE
,

55 
	mMERGE_COPY_PROPERTY
,

56 
	mMERGE_STRLIST
,

57 
	mMERGE_REMOVE
,

58 } 
	tm”ge_ty³
;

62 
	mMATCH_UNKNOWN
,

63 
	mMATCH_STRING
,

64 
	mMATCH_INT
,

65 
	mMATCH_UINT64
,

66 
	mMATCH_BOOL
,

67 
	mMATCH_EXISTS
,

68 
	mMATCH_EMPTY
,

69 
	mMATCH_ISASCII
,

70 
	mMATCH_IS_ABS_PATH
,

71 
	mMATCH_CONTAINS
,

72 
	mMATCH_CONTAINS_NCASE
,

73 
	mMATCH_PREFIX
,

74 
	mMATCH_PREFIX_NCASE
,

75 
	mMATCH_SUFFIX
,

76 
	mMATCH_SUFFIX_NCASE
,

77 
	mMATCH_COMPARE_LT
,

78 
	mMATCH_COMPARE_LE
,

79 
	mMATCH_COMPARE_GT
,

80 
	mMATCH_COMPARE_GE
,

81 
	mMATCH_SIBLING_CONTAINS
,

82 
	mMATCH_COMPARE_NE
,

83 
	mMATCH_CONTAINS_NOT
,

84 
	mMATCH_DOUBLE
,

85 
	mMATCH_CONTAINS_OUTOF
,

86 
	mMATCH_INT_OUTOF
,

87 
	mMATCH_PREFIX_OUTOF
,

88 
	mMATCH_STRING_OUTOF
,

89 } 
	tm©ch_ty³
;

92 
	sruË
 {

93 
size_t
 
	mruË_size
;

94 
u_št32_t
 
	mjump_pos™iÚ
;

96 
ruË_ty³
 
	m¹y³
;

97 
m©ch_ty³
 
	mty³_m©ch
;

98 
m”ge_ty³
 
	mty³_m”ge
;

100 
u_št32_t
 
	mv®ue_off£t
;

101 
size_t
 
	mv®ue_Ën
;

103 
size_t
 
	mkey_Ën
;

104 
	mkey
[0];

107 
	sÿche_h—d”
 {

108 
u_št32_t
 
	mfdi_ruËs_´•robe
;

109 
u_št32_t
 
	mfdi_ruËs_šfÜm©iÚ
;

110 
u_št32_t
 
	mfdi_ruËs_pŞicy
;

111 
u_št32_t
 
	m®l_ruËs_size
;

112 
	mem±y_¡ršg
[4];

115 
	#HAL_MAX_INDENT_DEPTH
 64

	)

117 
	#HALD_CACHE_FILE
 
PACKAGE_LOCALSTATEDIR
 "/ÿche/h®d/fdi-ÿche"

	)

	@hald/solaris/addons/addon-storage.c

12 #´agm¨
id’t
 "@(#)addon-storage.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<”ºo.h
>

19 
	~<¡ršg.h
>

20 
	~<¡ršgs.h
>

21 
	~<¡dlib.h
>

22 
	~<¡dio.h
>

23 
	~<sys/ioùl.h
>

24 
	~<sys/ty³s.h
>

25 
	~<sys/¡©.h
>

26 
	~<sys/ty³s.h
>

27 
	~<sys/wa™.h
>

28 
	~<fú.h
>

29 
	~<uni¡d.h
>

30 
	~<sys/mÁb.h
>

31 
	~<sys/dkio.h
>

32 
	~<´iv.h
>

34 
	~<libh®.h
>

36 
	~<logg”.h
>

38 
	#SLEEP_PERIOD
 5

	)

41 
	$my_dbus_”rÜ_ä“
(
DBusE¼Ü
 *
”rÜ
)

43 ià(
	`dbus_”rÜ_is_£t
(
”rÜ
)) {

44 
	`dbus_”rÜ_ä“
(
”rÜ
);

46 
	}
}

49 
	$fÜû_unmouÁ
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
)

51 
DBusE¼Ü
 
”rÜ
;

52 
DBusMes§ge
 *
msg
 = 
NULL
;

53 
DBusMes§ge
 *
»¶y
 = 
NULL
;

54 **
İtiÚs
 = 
NULL
;

55 
num_İtiÚs
 = 0;

56 
DBusCÚÃùiÚ
 *
dbus_cÚÃùiÚ
;

57 *
deviû_fe
;

59 
	`dbus_”rÜ_š™
 (&
”rÜ
);

61 
dbus_cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
ùx
);

63 
msg
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

66 ià(
msg
 =ğ
NULL
) {

67 
	`HAL_DEBUG
 (("Could‚Ù c»©dbu mes§gfÜ %s", 
udi
));

68 
out
;

72 
İtiÚs
 = 
	`ÿÎoc
 (1,  (*));

73 ià(
İtiÚs
 =ğ
NULL
) {

74 
	`HAL_DEBUG
 (("Could‚ot‡llocate options‡rray"));

75 
out
;

78 
deviû_fe
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
ùx
, 
udi
, "block.deviû", &
”rÜ
);

79 ià(
deviû_fe
 !ğ
NULL
) {

80 
	`libh®_ä“_¡ršg
 (
deviû_fe
);

82 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

84 ià(!
	`dbus_mes§ge_­³nd_¬gs
 (
msg
,

85 
DBUS_TYPE_ARRAY
, 
DBUS_TYPE_STRING
, &
İtiÚs
, 
num_İtiÚs
,

86 
DBUS_TYPE_INVALID
)) {

87 
	`HAL_DEBUG
 (("Could‚Ù‡µ’d‡rg tØdbu mes§gfÜ %s", 
udi
));

88 
out
;

91 ià(!(
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
dbus_cÚÃùiÚ
, 
msg
, -1, &
”rÜ
))) {

92 
	`HAL_DEBUG
 (("UnmouÁ faed fÜ %s: % : %s\n", 
udi
, 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

93 
out
;

96 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

97 
	`HAL_DEBUG
 (("UnmouÁ faed fÜ %s\n% : %s\n", 
udi
, 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
));

98 
out
;

101 
	`HAL_DEBUG
 (("SucûsfuÎy unmouÁed ud˜'%s'", 
udi
));

103 
out
:

104 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

105 ià(
İtiÚs
 !ğ
NULL
)

106 
	`ä“
 (
İtiÚs
);

107 ià(
msg
 !ğ
NULL
)

108 
	`dbus_mes§ge_uÄef
 (
msg
);

109 ià(
»¶y
 !ğ
NULL
)

110 
	`dbus_mes§ge_uÄef
 (
»¶y
);

111 
	}
}

114 
	$unmouÁ_chds
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
)

116 
DBusE¼Ü
 
”rÜ
;

117 
num_vŞumes
;

118 **
vŞumes
;

120 
	`dbus_”rÜ_š™
 (&
”rÜ
);

123 ià((
vŞumes
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (

124 
ùx
, "block.¡Üage_deviû", 
udi
, &
num_vŞumes
, &
”rÜ
)è!ğ
NULL
) {

125 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

126 
i
;

128 
i
 = 0; i < 
num_vŞumes
; i++) {

129 *
vŞ_udi
;

131 
vŞ_udi
 = 
vŞumes
[
i
];

132 ià(
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
ùx
, 
vŞ_udi
, "block.is_vŞume", &
”rÜ
)) {

133 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

134 ià(
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
ùx
, 
vŞ_udi
, "vŞume.is_mouÁed", &
”rÜ
)) {

135 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

136 
	`HAL_DEBUG
 (("FÜcšg unmouÁ oàchd '%s'", 
vŞ_udi
));

137 
	`fÜû_unmouÁ
 (
ùx
, 
vŞ_udi
);

141 
	`libh®_ä“_¡ršg_¬¿y
 (
vŞumes
);

143 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

144 
	}
}

152 
dbus_boŞ_t


153 
	$is_mouÁed
 (cÚ¡ *
deviû_fe
)

155 
FILE
 *
f
;

156 
dbus_boŞ_t
 
rc
 = 
FALSE
;

157 
mÁb
 
mp
;

158 
mÁb
 
m´ef
;

160 ià((
f
 = 
	`fİ’
 ("/‘c/mÁb", "r")è=ğ
NULL
)

161  
rc
;

163 
	`bz”o
(&
mp
,  (mp));

164 
	`bz”o
(&
m´ef
,  (mpref));

165 
m´ef
.
mÁ_¥ecŸl
 = (*)
deviû_fe
;

166 ià(
	`g‘mÁªy
(
f
, &
mp
, &
m´ef
) == 0) {

167 
rc
 = 
TRUE
;

170 
	`fşo£
 (
f
);

171  
rc
;

172 
	}
}

175 
	$şo£_deviû
 (*
fd
)

177 ià(*
fd
 > 0) {

178 
	`şo£
 (*
fd
);

179 *
fd
 = -1;

181 
	}
}

184 
	$drİ_´iveges
 ()

186 
´iv_£t_t
 *
pPrivS‘
 = 
NULL
;

187 
´iv_£t_t
 *
lPrivS‘
 = 
NULL
;

193 ià((
pPrivS‘
 = 
	`´iv_¡r_to_£t
("basic", ",", 
NULL
)) == NULL) {

198 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_FILE_LINK_ANY
);

199 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_PROC_INFO
);

200 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_PROC_SESSION
);

203 (è
	`´iv_add£t
(
pPrivS‘
, 
PRIV_FILE_DAC_READ
);

206 ià(
	`£´iv
(
PRIV_SET
, 
PRIV_PERMITTED
, 
pPrivS‘
) != 0) {

211 ià((
lPrivS‘
 = 
	`´iv_®loc£t
()è=ğ
NULL
) {

215 
	`´iv_em±y£t
(
lPrivS‘
);

217 ià(
	`£´iv
(
PRIV_SET
, 
PRIV_LIMIT
, 
lPrivS‘
) != 0) {

221 
	`´iv_ä“£t
(
lPrivS‘
);

222 
	}
}

225 
	$maš
 (
¬gc
, *
¬gv
[])

227 *
udi
;

228 *
deviû_fe
, *
¿w_deviû_fe
;

229 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

230 
DBusE¼Ü
 
”rÜ
;

231 *
bus
;

232 *
drive_ty³
;

233 
¡©e
, 
Ï¡_¡©e
;

234 *
suµÜt_medŸ_chªged_¡r
;

235 
suµÜt_medŸ_chªged
;

236 
fd
 = -1;

238 ià((
udi
 = 
	`g‘’v
 ("UDI")è=ğ
NULL
)

239 
out
;

240 ià((
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_DEVICE")è=ğ
NULL
)

241 
out
;

242 ià((
¿w_deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_SOLARIS_RAW_DEVICE")è=ğ
NULL
)

243 
out
;

244 ià((
bus
 = 
	`g‘’v
 ("HAL_PROP_STORAGE_BUS")è=ğ
NULL
)

245 
out
;

246 ià((
drive_ty³
 = 
	`g‘’v
 ("HAL_PROP_STORAGE_DRIVE_TYPE")è=ğ
NULL
)

247 
out
;

249 
	`drİ_´iveges
 ();

251 
	`£tup_logg”
 ();

253 
suµÜt_medŸ_chªged_¡r
 = 
	`g‘’v
 ("HAL_PROP_STORAGE_CDROM_SUPPORT_MEDIA_CHANGED");

254 ià(
suµÜt_medŸ_chªged_¡r
 !ğ
NULL
 && 
	`¡rcmp
 (support_media_changed_str, "true") == 0)

255 
suµÜt_medŸ_chªged
 = 
TRUE
;

257 
suµÜt_medŸ_chªged
 = 
FALSE
;

259 
	`dbus_”rÜ_š™
 (&
”rÜ
);

261 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

262 
out
;

264 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

266 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
ùx
, 
udi
, &
”rÜ
)) {

267 
out
;

269 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

271 
	`´štf
 ("Došg‡ddÚ-¡ÜagfÜ % (bu %sè(drive_ty³ %sè(ud˜%s)\n", 
deviû_fe
, 
bus
, 
drive_ty³
, 
udi
);

273 
Ï¡_¡©e
 = 
¡©e
 = 
DKIO_NONE
;

283 ià(
	`is_mouÁed
 (
deviû_fe
)) {

284 
	`şo£_deviû
 (&
fd
);

285 
	`¦“p
 (
SLEEP_PERIOD
);

286 } ià((
fd
 < 0è&& ((fd = 
	`İ’
 (
¿w_deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
)) < 0)) {

287 
	`HAL_DEBUG
 (("İ’ faed fÜ %s: %s", 
¿w_deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

288 
	`¦“p
 (
SLEEP_PERIOD
);

294 ià(
	`ioùl
 (
fd
, 
DKIOCSTATE
, &
¡©e
) == 0) {

295 ià(
¡©e
 =ğ
Ï¡_¡©e
) {

296 
	`HAL_DEBUG
 (("¡©ha nÙ chªged %d %s", 
¡©e
, 
deviû_fe
));

299 
	`HAL_DEBUG
 (("Ãw s‹ %d %s", 
¡©e
, 
deviû_fe
));

302 
¡©e
) {

303 
DKIO_EJECTED
:

304 
	`HAL_DEBUG
 (("MedŸ„emov® d‘eùed oÀ%s", 
deviû_fe
));

305 
Ï¡_¡©e
 = 
¡©e
;

307 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
udi
, "¡Üage.»movabË.medŸ_avaabË", 
FALSE
, &
”rÜ
);

308 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

311 
	`unmouÁ_chds
 (
ùx
, 
udi
);

314 
	`libh®_deviû_»sÿn
 (
ùx
, 
udi
, &
”rÜ
);

315 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

318 
DKIO_INSERTED
:

319 
	`HAL_DEBUG
 (("MedŸ in£¹iÚ d‘eùed oÀ%s", 
deviû_fe
));

320 
Ï¡_¡©e
 = 
¡©e
;

322 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
udi
, "¡Üage.»movabË.medŸ_avaabË", 
TRUE
, &
”rÜ
);

323 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

326 
	`libh®_deviû_»sÿn
 (
ùx
, 
udi
, &
”rÜ
);

327 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

330 
DKIO_DEV_GONE
:

331 
	`HAL_DEBUG
 (("Deviû gÚd‘eùed oÀ%s", 
deviû_fe
));

332 
Ï¡_¡©e
 = 
¡©e
;

334 
	`unmouÁ_chds
 (
ùx
, 
udi
);

335 
	`şo£_deviû
 (&
fd
);

336 
out
;

338 
DKIO_NONE
:

343 
	`HAL_DEBUG
 (("DKIOCSTATE faed: %s\n", 
	`¡»¼Ü
(
”ºo
)));

344 
	`¦“p
 (
SLEEP_PERIOD
);

349 
out
:

350 ià(
ùx
 !ğ
NULL
) {

351 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

352 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

353 
	`libh®_ùx_ä“
 (
ùx
);

357 
	}
}

	@hald/solaris/devinfo.c

12 #´agm¨
id’t
 "@(#)devinfo.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<¡dio.h
>

19 
	~<¡ršg.h
>

20 
	~<libdevšfo.h
>

22 
	~"../os¥ec.h
"

23 
	~"../logg”.h
"

24 
	~"../h®d.h
"

25 
	~"../h®d_dbus.h
"

26 
	~"../deviû_šfo.h
"

27 
	~"../ut.h
"

28 
	~"../h®d_ruÂ”.h
"

29 
	~"os¥ec_sŞ¬is.h
"

30 
	~"hÙ¶ug.h
"

31 
	~"devšfo.h
"

32 
	~"devšfo_pci.h
"

33 
	~"devšfo_¡Üage.h
"

34 
	~"devšfo_›“1394.h
"

35 
	~"devšfo_usb.h
"

36 
	~"devšfo_misc.h
"

38 
devšfo_add_subŒ“
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, 
gboŞ—n
 
is_roÙ
);

39 
H®Deviû
 *
devšfo_add_node
(H®Deviû *
·»Á
, 
di_node_t
 
node
);

42 
	$devšfo_add
(
H®Deviû
 *
·»Á
, 
gch¬
 *
·th
)

44 
di_node_t
 
roÙ
;

46 ià(
	`¡rcmp
 (
·th
, "/") == 0) {

47 ià((
roÙ
 = 
	`di_š™
(
·th
, 
DINFOCACHE
)è=ğ
DI_NODE_NIL
) {

48 
	`HAL_INFO
 (("di_š™(èçed %d", 
”ºo
));

52 ià((
roÙ
 = 
	`di_š™
(
·th
, 
DINFOCPYALL
)è=ğ
DI_NODE_NIL
) {

53 
	`HAL_INFO
 (("di_š™(èçed %d", 
”ºo
));

58 
	`devšfo_add_subŒ“
(
·»Á
, 
roÙ
, 
TRUE
);

60 
	`di_fši
 (
roÙ
);

61 
	}
}

64 
	$devšfo_add_subŒ“
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, 
gboŞ—n
 
is_roÙ
)

66 
H®Deviû
 *
d
;

67 
di_node_t
 
roÙ_node
, 
chd_node
;

69 
	`HAL_INFO
 (("add_subŒ“: %s", 
	`di_node_Çme
 (
node
)));

71 
roÙ_node
 = 
node
;

73 
d
 = 
	`devšfo_add_node
 (
·»Á
, 
node
);

75 ià((
d
 !ğ
NULL
) &&

76 (
chd_node
 = 
	`di_chd_node
 (
node
)è!ğ
DI_NODE_NIL
) {

77 
	`devšfo_add_subŒ“
 (
d
, 
chd_node
, 
FALSE
);

80 
node
 = 
	`di_siblšg_node
 (node);

81 } (
node
 !ğ
DI_NODE_NIL
) &&

82 (!
is_roÙ
 || 
	`di_·»Á_node
 (
node
è=ğ
roÙ_node
));

83 
	}
}

86 
	$devšfo_£t_deçuÉ_´İ”t›s
 (
H®Deviû
 *
d
, H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
)

88 *
driv”_Çme
, *
s
;

89 cÚ¡ *
s1
;

90 
udi
[
HAL_PATH_MAX
];

92 ià(
·»Á
 !ğ
NULL
) {

93 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
·»Á
));

95 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.parent", "/org/freedesktop/Hal/devices/local");

98 
	`h®d_compu‹_udi
 (
udi
,  (udi),

100 
devfs_·th
,

101 
	`di_š¡ªû
 (
node
));

102 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

104 ià(
	`di_´İ_lookup_¡ršgs
 (
DDI_DEV_T_ANY
, 
node
, "mod–", &
s
) > 0) {

105 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
s
);

107 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
	`di_node_Çme
 (
node
));

110 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sŞ¬is.devfs_·th", 
devfs_·th
);

112 ià((
driv”_Çme
 = 
	`di_driv”_Çme
 (
node
)è!ğ
NULL
) {

113 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.solaris.driver",

114 
driv”_Çme
);

119 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
·»Á
, "info.claimed")) {

120 
s1
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
·»Á
, "info.claimed.service");

121 ià(
s1
 !ğ
NULL
) {

122 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "šfo.şaimed", 
TRUE
);

123 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.şaimed.£rviû", 
s1
);

126 
	}
}

129 
DevšfoDevHªdËr
 *
	gdevšfo_hªdËrs
[] = {

130 &
devšfo_compu‹r_hªdËr
,

131 &
devšfo_ıu_hªdËr
,

132 &
devšfo_ide_hªdËr
,

133 &
devšfo_scsi_hªdËr
,

134 &
devšfo_æİpy_hªdËr
,

135 &
devšfo_usb_hªdËr
,

136 &
devšfo_›“1394_hªdËr
,

137 &
devšfo_pci_hªdËr
,

138 &
devšfo_lofi_hªdËr
,

139 &
devšfo_deçuÉ_hªdËr
,

140 
NULL


143 
H®Deviû
 *

144 
	$devšfo_add_node
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
)

146 
H®Deviû
 *
d
 = 
NULL
;

147 *
devfs_·th
;

148 *
deviû_ty³
 = 
NULL
;

149 
DevšfoDevHªdËr
 *
hªdËr
;

150 
i
;

152 
devfs_·th
 = 
	`di_devfs_·th
 (
node
);

154 (è
	`di_´İ_lookup_¡ršgs
 (
DDI_DEV_T_ANY
, 
node
, "device_type",

155 &
deviû_ty³
);

157 
i
 = 0; (
d
 =ğ
NULL
è&& (
devšfo_hªdËrs
[i] != NULL); i++) {

158 
hªdËr
 = 
devšfo_hªdËrs
[
i
];

159 
d
 = 
hªdËr
->
	`add
 (
·»Á
, 
node
, 
devfs_·th
, 
deviû_ty³
);

162 
	`di_devfs_·th_ä“
(
devfs_·th
);

164 
	`HAL_INFO
 (("add_node: %s", 
d
 ? 
	`h®_deviû_g‘_udi
 (d) : "none"));

165  (
d
);

166 
	}
}

169 
	$devšfo_hÙ¶ug_’queue
(
H®Deviû
 *
d
, 
gch¬
 *
devfs_·th
, 
DevšfoDevHªdËr
 *
hªdËr
, 
aùiÚ
, 
äÚt
)

171 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

173 
hÙ¶ug_ev’t
 = 
	`g_Ãw0
 (
HÙ¶ugEv’t
, 1);

174 
hÙ¶ug_ev’t
->
aùiÚ
 =‡ction;

175 
hÙ¶ug_ev’t
->
ty³
 = 
HOTPLUG_EVENT_DEVFS
;

176 
hÙ¶ug_ev’t
->
d
 = d;

177 
	`¡¾ıy
 (
hÙ¶ug_ev’t
->
un
.
devfs
.
devfs_·th
, devfs_path,

178  (
hÙ¶ug_ev’t
->
un
.
devfs
.
devfs_·th
));

179 
hÙ¶ug_ev’t
->
un
.
devfs
.
hªdËr
 = handler;

181 
	`hÙ¶ug_ev’t_’queue
 (
hÙ¶ug_ev’t
, 
äÚt
);

182 
	}
}

185 
	$devšfo_add_’queue
(
H®Deviû
 *
d
, 
gch¬
 *
devfs_·th
, 
DevšfoDevHªdËr
 *
hªdËr
)

187 
	`devšfo_hÙ¶ug_’queue
 (
d
, 
devfs_·th
, 
hªdËr
, 
HOTPLUG_ACTION_ADD
, 0);

188 
	}
}

191 
	$devšfo_add_’queue_©_äÚt
(
H®Deviû
 *
d
, 
gch¬
 *
devfs_·th
, 
DevšfoDevHªdËr
 *
hªdËr
)

193 
	`devšfo_hÙ¶ug_’queue
 (
d
, 
devfs_·th
, 
hªdËr
, 
HOTPLUG_ACTION_ADD
, 1);

194 
	}
}

197 
	$devšfo_»move_’queue
(
gch¬
 *
devfs_·th
, 
DevšfoDevHªdËr
 *
hªdËr
)

199 
	`devšfo_hÙ¶ug_’queue
 (
NULL
, 
devfs_·th
, 
hªdËr
, 
HOTPLUG_ACTION_REMOVE
, 0);

200 
	}
}

203 
	$devšfo_ÿÎouts_add_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

205 *
’d_tok’
 = (*è
u£rd©a1
;

208 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

209 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

211 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

212 
	}
}

215 
	$devšfo_ÿÎouts_´obšg_dÚe
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
, 
gšt
 
»tuº_code
, **
”rÜ
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

217 *
’d_tok’
 = (*è
u£rd©a1
;

220 ià(
ex™_ty³
 !ğ
HALD_RUN_SUCCESS
 || (
»tuº_code
 != 0)) {

221 
	`HAL_INFO
 (("Probšg fÜ % çed %d", 
	`h®_deviû_g‘_udi
 (
d
), 
»tuº_code
));

222 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

223 
	`g_objeù_uÄef
 (
d
);

224 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

229 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_INFORMATION
);

230 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_POLICY
);

232 
	`h®_ut_ÿÎout_deviû_add
 (
d
, 
devšfo_ÿÎouts_add_dÚe
, 
’d_tok’
, 
NULL
);

233 
	}
}

236 
	$devšfo_ÿÎouts_´•robšg_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

238 *
’d_tok’
 = (*è
u£rd©a1
;

239 
DevšfoDevHªdËr
 *
hªdËr
 = (DevšfoDevHªdË¸*è
u£rd©a2
;

240 (*
´obšg_dÚe
è(
H®Deviû
 *, 
gušt32
, 
gšt
, **, 
gpoš‹r
, gpointer);

241 cÚ¡ 
gch¬
 *
´ob”
;

242 
´ob”_timeout
;

244 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "info.ignore")) {

245 
	`HAL_INFO
 (("Preprobing merged info.ignore==TRUE"));

248 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.category");

249 
	`h®_deviû_´İ”ty_»move
 (
d
, "info.capabilities");

251 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

252 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_gdl
 (), 
d
);

254 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

258 ià(
hªdËr
 !ğ
NULL
 && hªdËr->
g‘_´ob”
 != NULL) {

259 
´ob”
 = 
hªdËr
->
	`g‘_´ob”
 (
d
, &
´ob”_timeout
);

261 
´ob”
 = 
NULL
;

264 ià(
hªdËr
->
´obšg_dÚe
 !ğ
NULL
) {

265 
´obšg_dÚe
 = 
hªdËr
->probing_done;

267 
´obšg_dÚe
 = 
devšfo_ÿÎouts_´obšg_dÚe
;

270 ià(
´ob”
 !ğ
NULL
) {

272 
	`HAL_INFO
(("Probšg udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

273 
	`h®d_ruÂ”_run
 (
d
,

274 
´ob”
, 
NULL
,

275 
´ob”_timeout
,

276 
´obšg_dÚe
,

277 (
gpoš‹r
è
’d_tok’
, (gpoš‹rè
hªdËr
);

279 
	`´obšg_dÚe
 (
d
, 0, 0, 
NULL
, 
u£rd©a1
, 
u£rd©a2
);

281 
	}
}

285 
	$hÙ¶ug_ev’t_begš_add_devšfo
 (
H®Deviû
 *
d
, H®Deviû *
·»Á
, 
DevšfoDevHªdËr
 *
hªdËr
, *
’d_tok’
)

287 
	`HAL_INFO
(("P»´obšg udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

289 ià(
·»Á
 !ğ
NULL
 && 
	`h®_deviû_´İ”ty_g‘_boŞ
 (parent, "info.ignore")) {

290 
	`HAL_INFO
 (("Ignoring device since…arent has info.ignore==TRUE"));

292 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

297 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
d
);

300 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_PREPROBE
);

303 
	`h®_ut_ÿÎout_deviû_´•robe
 (
d
, 
devšfo_ÿÎouts_´•robšg_dÚe
, 
’d_tok’
, 
hªdËr
);

304 
	}
}

307 
	$devšfo_»move
 (
gch¬
 *
devfs_·th
)

309 
	`devšfo_»move_’queue
 ((
gch¬
 *)
devfs_·th
, 
NULL
);

310 
	}
}

314 
	$devšfo_»move_b¿nch
 (
gch¬
 *
devfs_·th
, 
H®Deviû
 *
d
)

316 
GSLi¡
 *
i
;

317 
GSLi¡
 *
chd»n
;

318 
H®Deviû
 *
chd
;

319 *
chd_devfs_·th
;

321 ià(
d
 =ğ
NULL
) {

322 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

323 "sŞ¬is.devfs_·th", 
devfs_·th
);

324 ià(
d
 =ğ
NULL
)

328 
	`HAL_INFO
 (("»move_b¿nch: % %s\n", 
devfs_·th
, 
	`h®_deviû_g‘_udi
 (
d
)));

331 
chd»n
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
(),

332 "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
d
));

333 
i
 = 
chd»n
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

334 
chd
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

335 
	`HAL_INFO
 (("»move_b¿nch: chd %s\n", 
	`h®_deviû_g‘_udi
 (
chd
)));

336 
	`devšfo_»move_b¿nch
 ((
gch¬
 *)
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
chd
, "solaris.devfs_path"), child);

338 
	`g_¦i¡_ä“
 (
chd»n
);

339 
	`HAL_INFO
 (("remove_branch: done with children"));

342 
	`HAL_INFO
 (("»move_b¿nch: queuešg %s", 
devfs_·th
));

343 
	`devšfo_»move_’queue
 (
devfs_·th
, 
NULL
);

344 
	}
}

347 
	$devšfo_ÿÎouts_»move_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

349 *
’d_tok’
 = (*è
u£rd©a1
;

351 
	`HAL_INFO
 (("RemovÿÎout com¶‘ed udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

353 ià(!
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_gdl
 (), 
d
)) {

354 
	`HAL_WARNING
 (("Error„emoving device"));

356 
	`g_objeù_uÄef
 (
d
);

358 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

359 
	}
}

362 
	$hÙ¶ug_ev’t_begš_»move_devšfo
 (
H®Deviû
 *
d
, 
gch¬
 *
devfs_·th
, *
’d_tok’
)

364 ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "volume")) {

365 
	`devšfo_vŞume_hÙ¶ug_begš_»move
 (
d
, 
devfs_·th
, 
’d_tok’
);

367 
	`h®_ut_ÿÎout_deviû_»move
 (
d
, 
devšfo_ÿÎouts_»move_dÚe
, 
’d_tok’
, 
NULL
);

369 
	}
}

371 
gboŞ—n


372 
	$devšfo_deviû_»sÿn
 (
H®Deviû
 *
d
)

374 ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "block")) {

375  (
	`devšfo_¡Üage_deviû_»sÿn
 (
d
));

377  (
FALSE
);

379 
	}
}

	@hald/solaris/devinfo.h

12 #´agm¨
id’t
 "@(#)devinfo.h 1.2 06/10/13 SMI"

14 #iâdeà
DEVINFO_H


15 
	#DEVINFO_H


	)

17 
	~<glib.h
>

18 
	~<libdevšfo.h
>

20 
	~"../h®d.h
"

21 
	~"../deviû_šfo.h
"

23 
	sDevšfoDevHªdËr_s


25 
	mH®Deviû
 *(*
	madd
è(
H®Deviû
 *
	m·»Á
, 
di_node_t
 
	mnode
, *
	mdevfs_·th
, *
	mdeviû_ty³
);

28 (*
	m»move
è(*
	mdevfs_·th
);

30 (*
	mhÙ¶ug_begš_add
è(
H®Deviû
 *
	md
, H®Deviû *
	m·»Á
, 
DevšfoDevHªdËr_s
 *
	mhªdËr
, *
	m’d_tok’
);

32 (*
	mhÙ¶ug_begš_»move
è(
H®Deviû
 *
	md
, 
DevšfoDevHªdËr_s
 *
	mhªdËr
, *
	m’d_tok’
);

34 (*
	m´obšg_dÚe
è(
H®Deviû
 *
	md
, 
gušt32
 
	mex™_ty³
, 
gšt
 
	m»tuº_code
, **
	m”rÜ
, 
gpoš‹r
 
	mu£rd©a1
, gpoš‹¸
	mu£rd©a2
);

36 cÚ¡ 
	mgch¬
 *(*
	mg‘_´ob”
è(
H®Deviû
 *
	md
, *
	mtimeout
);

37 } 
	tDevšfoDevHªdËr
;

39 
	#PROP_INT
(
d
, 
node
, 
v
, 
drİ
, 
h®´İ
) \

40 ià(
	`di_´İ_lookup_šts
(
DDI_DEV_T_ANY
, 
node
, 
drİ
, &(
v
)) > 0) { \

41 
	`h®_deviû_´İ”ty_£t_št
 (
d
, 
h®´İ
, *(
v
)); \

42 }

	)

44 
	#PROP_STR
(
d
, 
node
, 
v
, 
drİ
, 
h®´İ
) \

45 ià(
	`di_´İ_lookup_¡ršgs
(
DDI_DEV_T_ANY
, 
node
, 
drİ
, &(
v
)) > 0) { \

46 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, 
h®´İ
, 
v
); \

47 }

	)

49 
	#PROP_BOOL
(
d
, 
node
, 
v
, 
drİ
, 
h®´İ
) \

50 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, 
h®´İ
, \

51 (
	`di_´İ_lookup_šts
(
DDI_DEV_T_ANY
, 
node
, 
drİ
, &(
v
)è>ğ0));

	)

53 
	#NELEM
(
a
è( (aè/  (*×)))

	)

55 
devšfo_add
 (
H®Deviû
 *
·»Á
, 
gch¬
 *
·th
);

56 
devšfo_£t_deçuÉ_´İ”t›s
 (
H®Deviû
 *
d
, H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
);

57 
devšfo_ÿÎouts_´•robšg_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
);

58 
devšfo_ÿÎouts_´obšg_dÚe
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
, 
gšt
 
»tuº_code
, **
”rÜ
,

59 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
);

60 
devšfo_ÿÎouts_add_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
);

61 
devšfo_ÿÎouts_»move_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
);

62 
hÙ¶ug_ev’t_begš_add_devšfo
 (
H®Deviû
 *
d
, H®Deviû *
·»Á
, 
DevšfoDevHªdËr
 *
hªdËr
, *
’d_tok’
);

63 
devšfo_»move
 (
gch¬
 *
·th
);

64 
devšfo_»move_b¿nch
 (
gch¬
 *
·th
, 
H®Deviû
 *
d
);

65 
hÙ¶ug_ev’t_begš_»move_devšfo
 (
H®Deviû
 *
d
, 
gch¬
 *
devfs_·th
, *
’d_tok’
);

66 
devšfo_hÙ¶ug_’queue
(
H®Deviû
 *
d
, 
gch¬
 *
devfs_·th
, 
DevšfoDevHªdËr
 *
hªdËr
, 
aùiÚ
, 
äÚt
);

67 
devšfo_add_’queue
(
H®Deviû
 *
d
, 
gch¬
 *
devfs_·th
, 
DevšfoDevHªdËr
 *
hªdËr
);

68 
devšfo_add_’queue_©_äÚt
(
H®Deviû
 *
d
, 
gch¬
 *
devfs_·th
, 
DevšfoDevHªdËr
 *
hªdËr
);

69 
devšfo_»move_’queue
(
gch¬
 *
devfs_·th
, 
DevšfoDevHªdËr
 *
hªdËr
);

70 
gboŞ—n
 
devšfo_deviû_»sÿn
 (
H®Deviû
 *
d
);

	@hald/solaris/devinfo_ieee1394.c

12 #´agm¨
id’t
 "@(#)devinfo_ieee1394.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<¡dio.h
>

19 
	~<¡ršg.h
>

20 
	~<libdevšfo.h
>

21 
	~<sys/ty³s.h
>

22 
	~<sys/mkdev.h
>

23 
	~<sys/¡©.h
>

25 
	~"../os¥ec.h
"

26 
	~"../logg”.h
"

27 
	~"../h®d.h
"

28 
	~"../h®d_dbus.h
"

29 
	~"../deviû_šfo.h
"

30 
	~"../ut.h
"

31 
	~"../ids.h
"

32 
	~"hÙ¶ug.h
"

33 
	~"devšfo.h
"

34 
	~"devšfo_›“1394.h
"

36 
H®Deviû
 *
devšfo_›“1394_add
(H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
);

37 
H®Deviû
 *
devšfo_sc§1394_add
(H®Deviû *
d
, 
di_node_t
 
node
, 
gch¬
 *
devfs_·th
);

39 
DevšfoDevHªdËr
 
	gdevšfo_›“1394_hªdËr
 = {

40 
devšfo_›“1394_add
,

41 
NULL
,

42 
NULL
,

43 
NULL
,

44 
NULL
,

45 
NULL


48 
H®Deviû
 *

49 
	$devšfo_›“1394_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
)

51 
H®Deviû
 *
d
 = 
NULL
;

52 *
com·t
;

53 *
driv”_Çme
;

59 ià((
	`di_com·tibË_Çmes
 (
node
, &
com·t
) < 1) ||

60 (
	`¡ºcmp
 (
com·t
, "firewire",  ("firewire") - 1) != 0)) {

61  (
NULL
);

64 ià((
driv”_Çme
 = 
	`di_driv”_Çme
 (
node
)è=ğ
NULL
) {

65  (
NULL
);

68 ià(
	`¡rcmp
 (
driv”_Çme
, "scsa1394") == 0) {

69 
d
 = 
	`devšfo_sc§1394_add
 (
·»Á
, 
node
, 
devfs_·th
);

72  (
d
);

73 
	}
}

75 
H®Deviû
 *

76 
	$devšfo_sc§1394_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, 
gch¬
 *
devfs_·th
)

78 
H®Deviû
 *
d
 = 
NULL
;

80 
d
 = 
	`h®_deviû_Ãw
 ();

82 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

83 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.subsystem", "ieee1394");

84 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "FireWire SBP-2 device");

86 
	`devšfo_add_’queue
 (
d
, 
devfs_·th
, &
devšfo_›“1394_hªdËr
);

88  (
d
);

89 
	}
}

	@hald/solaris/devinfo_ieee1394.h

12 #´agm¨
id’t
 "@(#)devinfo_ieee1394.h 1.2 06/10/13 SMI"

14 #iâdeà
DEVINFO_IEEE1394_H


15 
	#DEVINFO_IEEE1394_H


	)

17 
	~"devšfo.h
"

19 
DevšfoDevHªdËr
 
devšfo_›“1394_hªdËr
;

	@hald/solaris/devinfo_misc.c

12 #´agm¨
id’t
 "@(#)devinfo_misc.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<¡dio.h
>

19 
	~<¡ršg.h
>

20 
	~<sys/ut¢ame.h
>

21 
	~<libdevšfo.h
>

23 
	~"../os¥ec.h
"

24 
	~"../logg”.h
"

25 
	~"../h®d.h
"

26 
	~"../h®d_dbus.h
"

27 
	~"../deviû_šfo.h
"

28 
	~"../ut.h
"

29 
	~"devšfo_misc.h
"

31 
H®Deviû
 *
devšfo_compu‹r_add
(H®Deviû *, 
di_node_t
, *, *);

32 
H®Deviû
 *
devšfo_ıu_add
(H®Deviû *, 
di_node_t
, *,*);

33 
H®Deviû
 *
devšfo_deçuÉ_add
(H®Deviû *, 
di_node_t
, *, *);

35 
DevšfoDevHªdËr
 
	gdevšfo_compu‹r_hªdËr
 = {

36 
devšfo_compu‹r_add
,

37 
NULL
,

38 
NULL
,

39 
NULL
,

40 
NULL
,

41 
NULL


43 
DevšfoDevHªdËr
 
	gdevšfo_ıu_hªdËr
 = {

44 
devšfo_ıu_add
,

45 
NULL
,

46 
NULL
,

47 
NULL
,

48 
NULL
,

49 
NULL


51 
DevšfoDevHªdËr
 
	gdevšfo_deçuÉ_hªdËr
 = {

52 
devšfo_deçuÉ_add
,

53 
NULL
,

54 
NULL
,

55 
NULL
,

56 
NULL
,

57 
NULL


60 
H®Deviû
 *

61 
	$devšfo_compu‹r_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
)

63 
H®Deviû
 *
d
, *
loÿl_d
;

64 
ut¢ame
 
un
;

66 ià(
	`¡rcmp
 (
devfs_·th
, "/") != 0) {

67  (
NULL
);

70 
d
 = 
	`h®_deviû_Ãw
 ();

72 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.subsystem", "unknown");

73 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "Computer");

74 
	`h®_deviû_£t_udi
 (
d
, "/org/freedesktop/Hal/devices/computer");

75 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sŞ¬is.devfs_·th", 
devfs_·th
);

77 ià(
	`uÇme
 (&
un
) >= 0) {

78 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sy¡em.k”Ãl.Çme", 
un
.
sy¢ame
);

79 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sy¡em.k”Ãl.v”siÚ", 
un
.
»Ëa£
);

80 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "sy¡em.k”Ãl.machše", 
un
.
machše
);

83 
	`devšfo_add_’queue
 (
d
, 
devfs_·th
, &
devšfo_compu‹r_hªdËr
);

86 
loÿl_d
 = 
	`h®_deviû_Ãw
 ();

88 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
loÿl_d
, "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
d
));

89 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
loÿl_d
, "info.subsystem", "unknown");

90 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
loÿl_d
, "info.product", "Local devices");

91 
	`h®_deviû_£t_udi
 (
loÿl_d
, "/org/freedesktop/Hal/devices/local");

92 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
loÿl_d
, "solaris.devfs_path", "/local");

94 
	`devšfo_add_’queue
 (
loÿl_d
, "/loÿl", &
devšfo_deçuÉ_hªdËr
);

96  (
loÿl_d
);

97 
	}
}

99 
H®Deviû
 *

100 
	$devšfo_ıu_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
)

102 
H®Deviû
 *
d
;

104 ià((
deviû_ty³
 =ğ
NULL
è|| (
	`¡rcmp
(device_type, "cpu") != 0)) {

105  (
NULL
);

108 
d
 = 
	`h®_deviû_Ãw
 ();

110 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

111 
	`h®_deviû_add_ÿ·b™y
 (
d
, "processor");

113 
	`devšfo_add_’queue
 (
d
, 
devfs_·th
, &
devšfo_ıu_hªdËr
);

115  (
d
);

116 
	}
}

118 
H®Deviû
 *

119 
	$devšfo_deçuÉ_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
)

121 *
driv”_Çme
;

122 cÚ¡ *
·»Á_·th
;

123 
H®Deviû
 *
d
;

126 ià(
·»Á
 !ğ
NULL
) {

127 
·»Á_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
·»Á
, "solaris.devfs_path");

128 ià((
·»Á_·th
 !ğ
NULL
) &&

129 (
	`¡rcmp
 (
·»Á_·th
, "/pseudo") == 0)) {

130 
driv”_Çme
 = 
	`di_driv”_Çme
 (
node
);

131 ià((
driv”_Çme
 !ğ
NULL
) &&

132 (
	`¡rcmp
 (
driv”_Çme
, "lofi") != 0)) {

133  (
NULL
);

138 
d
 = 
	`h®_deviû_Ãw
 ();

140 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

142 
	`devšfo_add_’queue
 (
d
, 
devfs_·th
, &
devšfo_deçuÉ_hªdËr
);

144  (
d
);

145 
	}
}

	@hald/solaris/devinfo_misc.h

12 #´agm¨
id’t
 "@(#)devinfo_misc.h 1.2 06/10/13 SMI"

14 #iâdeà
DEVINFO_MISC_H


15 
	#DEVINFO_MISC_H


	)

17 
	~"devšfo.h
"

19 
DevšfoDevHªdËr
 
devšfo_ıu_hªdËr
;

20 
DevšfoDevHªdËr
 
devšfo_compu‹r_hªdËr
;

21 
DevšfoDevHªdËr
 
devšfo_deçuÉ_hªdËr
;

	@hald/solaris/devinfo_pci.c

12 #´agm¨
id’t
 "@(#)devinfo_pci.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<¡dio.h
>

19 
	~<¡ršg.h
>

20 
	~<libdevšfo.h
>

22 
	~"../os¥ec.h
"

23 
	~"../logg”.h
"

24 
	~"../h®d.h
"

25 
	~"../h®d_dbus.h
"

26 
	~"../deviû_šfo.h
"

27 
	~"../ut.h
"

28 
	~"../ids.h
"

29 
	~"devšfo_pci.h
"

31 
H®Deviû
 *
devšfo_pci_add
 (H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
);

33 
DevšfoDevHªdËr
 
	gdevšfo_pci_hªdËr
 = {

34 
devšfo_pci_add
,

35 
NULL
,

36 
NULL
,

37 
NULL
,

38 
NULL
,

39 
NULL


42 
H®Deviû
 *
	$devšfo_pci_add
 (
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
)

44 
H®Deviû
 *
d
;

45 *
s
;

46 *
i
;

47 
vid
, 
pid
, 
svid
, 
¥id
;

49 ià((
deviû_ty³
 =ğ
NULL
) ||

50 ((
	`¡rcmp
 (
deviû_ty³
, "pci") != 0) &&

51 (
	`¡rcmp
 (
deviû_ty³
, "pci-ide") != 0))) {

52 ià(
·»Á
 =ğ
NULL
) {

53  (
NULL
);

55 
s
 = (*)
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
·»Á
, "info.subsystem");

56 ià((
s
 =ğ
NULL
è|| (
	`¡rcmp
 (s, "pci") != 0)) {

57  (
NULL
);

62 
d
 = 
	`h®_deviû_Ãw
 ();

63 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

65 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.subsystem", "pci");

67 
vid
 = 
pid
 = 
svid
 = 
¥id
 = 0;

68 ià(
	`di_´İ_lookup_šts
 (
DDI_DEV_T_ANY
, 
node
, "v’dÜ-id", &
i
) > 0) {

69 
vid
 = 
i
[0];

71 ià(
	`di_´İ_lookup_šts
 (
DDI_DEV_T_ANY
, 
node
, "deviû-id", &
i
) > 0) {

72 
pid
 = 
i
[0];

74 ià(
	`di_´İ_lookup_šts
 (
DDI_DEV_T_ANY
, 
node
, "subsy¡em-v’dÜ-id", &
i
) > 0) {

75 
svid
 = 
i
[0];

77 ià(
	`di_´İ_lookup_šts
 (
DDI_DEV_T_ANY
, 
node
, "subsy¡em-id", &
i
) > 0) {

78 
¥id
 = 
i
[0];

80 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "pci.v’dÜ_id", 
vid
);

81 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "pci.´oduù_id", 
pid
);

82 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "pci.subsys_v’dÜ_id", 
svid
);

83 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "pci.subsys_´oduù_id", 
¥id
);

86 *
v’dÜ_Çme
;

87 *
´oduù_Çme
;

88 *
subsys_v’dÜ_Çme
;

89 *
subsys_´oduù_Çme
;

91 
	`ids_fšd_pci
 (
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pci.vendor_id"),

92 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pci.product_id"),

93 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pci.subsys_vendor_id"),

94 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "pci.subsys_product_id"),

95 &
v’dÜ_Çme
, &
´oduù_Çme
, &
subsys_v’dÜ_Çme
,

96 &
subsys_´oduù_Çme
);

98 ià(
v’dÜ_Çme
 !ğ
NULL
) {

99 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "pci.v’dÜ", 
v’dÜ_Çme
);

100 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.v’dÜ", 
v’dÜ_Çme
);

103 ià(
´oduù_Çme
 !ğ
NULL
) {

104 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "pci.´oduù", 
´oduù_Çme
);

105 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
´oduù_Çme
);

108 ià(
subsys_v’dÜ_Çme
 !ğ
NULL
) {

109 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "pci.subsys_vendor",

110 
subsys_v’dÜ_Çme
);

113 ià(
subsys_´oduù_Çme
 !ğ
NULL
) {

114 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "pci.subsys_´oduù", 
subsys_´oduù_Çme
);

118 
	`devšfo_add_’queue
 (
d
, 
devfs_·th
, &
devšfo_pci_hªdËr
);

120  (
d
);

121 
	}
}

	@hald/solaris/devinfo_pci.h

12 #´agm¨
id’t
 "@(#)devinfo_pci.h 1.2 06/10/13 SMI"

14 #iâdeà
DEVINFO_PCI_H


15 
	#DEVINFO_PCI_H


	)

17 
	~"devšfo.h
"

19 
DevšfoDevHªdËr
 
devšfo_pci_hªdËr
;

	@hald/solaris/devinfo_storage.c

12 #´agm¨
id’t
 "@(#)devinfo_storage.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<¡dio.h
>

19 
	~<¡ršg.h
>

20 
	~<¡ršgs.h
>

21 
	~<ùy³.h
>

22 
	~<libdevšfo.h
>

23 
	~<sys/ty³s.h
>

24 
	~<sys/mkdev.h
>

25 
	~<sys/¡©.h
>

26 
	~<sys/mÁ’t.h
>

27 
	~<sys/mÁb.h
>

29 
	~"../os¥ec.h
"

30 
	~"../logg”.h
"

31 
	~"../h®d.h
"

32 
	~"../h®d_dbus.h
"

33 
	~"../deviû_šfo.h
"

34 
	~"../ut.h
"

35 
	~"../h®d_ruÂ”.h
"

36 
	~"hÙ¶ug.h
"

37 
	~"devšfo.h
"

38 
	~"devšfo_misc.h
"

39 
	~"devšfo_¡Üage.h
"

40 
	~"os¥ec_sŞ¬is.h
"

42 #ifdeà
¥¬c


43 
	#WHOLE_DISK
 "s2"

	)

45 
	#WHOLE_DISK
 "p0"

	)

49 
	#DEVINFO_PROBE_STORAGE_TIMEOUT
 60000

	)

50 
	#DEVINFO_PROBE_VOLUME_TIMEOUT
 60000

	)

52 
	sdevšfo_¡Üage_mšÜ
 {

53 *
	mdev·th
;

54 *
	mdevlšk
;

55 *
	m¦iû
;

56 
dev_t
 
	mdev
;

57 
	mdo¢um
;

58 } 
	tdevšfo_¡Üage_mšÜ_t
;

60 
H®Deviû
 *
devšfo_ide_add
(H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
);

61 
H®Deviû
 *
devšfo_ide_ho¡_add
(H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
);

62 
H®Deviû
 *
devšfo_ide_deviû_add
(H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
);

63 
H®Deviû
 *
devšfo_ide_¡Üage_add
(H®Deviû *
g¿m·
, H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
);

64 
H®Deviû
 *
devšfo_scsi_add
(H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
);

65 
H®Deviû
 *
devšfo_scsi_¡Üage_add
(H®Deviû *
g¿m·
, H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
);

66 
H®Deviû
 *
devšfo_æİpy_add
(H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
);

67 
devšfo_æİpy_add_vŞume
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
);

68 
H®Deviû
 *
devšfo_lofi_add
(H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
);

69 
devšfo_lofi_add_mšÜ
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
mšÜ_·th
, *
devlšk
, 
dev_t
 
dev
);

70 
w®k_devlšks
(
di_devlšk_t
 
devlšk
, *
¬g
);

71 *
g‘_devlšk
(
di_devlšk_hªdË_t
 
devlšk_hdl
, *
·th
);

72 
devšfo_¡Üage_mšÜs
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, 
gch¬
 *
devfs_·th
, 
gboŞ—n
);

73 
devšfo_¡Üage_mšÜ
 *
devšfo_¡Üage_Ãw_mšÜ
(*
mašdev_·th
, *
¦iû
,

74 *
devlšk
, 
dev_t
 
dev
, 
do¢um
);

75 
devšfo_¡Üage_ä“_mšÜ
(
devšfo_¡Üage_mšÜ
 *
m
);

76 
H®Deviû
 *
devšfo_vŞume_add
(H®Deviû *
·»Á
, 
di_node_t
 
node
, 
devšfo_¡Üage_mšÜ_t
 *
m
);

77 
devšfo_vŞume_´•robšg_dÚe
(
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
);

78 
devšfo_vŞume_hÙ¶ug_begš_add
 (
H®Deviû
 *
d
, H®Deviû *
·»Á
, 
DevšfoDevHªdËr
 *
hªdËr
, *
’d_tok’
);

79 
devšfo_¡Üage_hÙ¶ug_begš_add
 (
H®Deviû
 *
d
, H®Deviû *
·»Á
, 
DevšfoDevHªdËr
 *
hªdËr
, *
’d_tok’
);

80 
devšfo_¡Üage_´obšg_dÚe
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
, 
gšt
 
»tuº_code
, **
”rÜ
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
);

81 cÚ¡ 
gch¬
 *
devšfo_vŞume_g‘_´ob”
 (
H®Deviû
 *
d
, *
timeout
);

82 cÚ¡ 
gch¬
 *
devšfo_¡Üage_g‘_´ob”
 (
H®Deviû
 *
d
, *
timeout
);

84 *
devšfo_scsi_dty³2¡r
(
dty³
);

85 *
devšfo_vŞume_g‘_¦iû_Çme
 (*
devlšk
);

86 
gboŞ—n
 
dos_to_dev
(*
·th
, **
dev·th
, *
·¹num
);

87 
gboŞ—n
 
is_dos_·th
(*
·th
, *
·¹num
);

89 
devšfo_¡Üage_£t_nickÇmes
 (
H®Deviû
 *
d
);

91 
DevšfoDevHªdËr
 
	gdevšfo_ide_hªdËr
 = {

92 
devšfo_ide_add
,

93 
NULL
,

94 
NULL
,

95 
NULL
,

96 
NULL
,

97 
NULL


99 
DevšfoDevHªdËr
 
	gdevšfo_scsi_hªdËr
 = {

100 
devšfo_scsi_add
,

101 
NULL
,

102 
NULL
,

103 
NULL
,

104 
NULL
,

105 
NULL


107 
DevšfoDevHªdËr
 
	gdevšfo_æİpy_hªdËr
 = {

108 
devšfo_æİpy_add
,

109 
NULL
,

110 
NULL
,

111 
NULL
,

112 
NULL
,

113 
NULL


115 
DevšfoDevHªdËr
 
	gdevšfo_lofi_hªdËr
 = {

116 
devšfo_lofi_add
,

117 
NULL
,

118 
NULL
,

119 
NULL
,

120 
NULL
,

121 
NULL


123 
DevšfoDevHªdËr
 
	gdevšfo_¡Üage_hªdËr
 = {

124 
NULL
,

125 
NULL
,

126 
devšfo_¡Üage_hÙ¶ug_begš_add
,

127 
NULL
,

128 
devšfo_¡Üage_´obšg_dÚe
,

129 
devšfo_¡Üage_g‘_´ob”


131 
DevšfoDevHªdËr
 
	gdevšfo_vŞume_hªdËr
 = {

132 
NULL
,

133 
NULL
,

134 
devšfo_vŞume_hÙ¶ug_begš_add
,

135 
NULL
,

136 
NULL
,

137 
devšfo_vŞume_g‘_´ob”


142 
H®Deviû
 *

143 
	$devšfo_ide_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
)

145 *
s
;

147 ià((
deviû_ty³
 !ğ
NULL
è&& (
	`¡rcmp
(device_type, "ide") == 0)) {

148  (
	`devšfo_ide_ho¡_add
(
·»Á
, 
node
, 
devfs_·th
));

151 ià((
	`di_´İ_lookup_¡ršgs
 (
DDI_DEV_T_ANY
, 
node
, "şass", &
s
) > 0) &&

152 (
	`¡rcmp
 (
s
, "dada") == 0)) {

153  (
	`devšfo_ide_deviû_add
(
·»Á
, 
node
, 
devfs_·th
));

156  (
NULL
);

157 
	}
}

159 
H®Deviû
 *

160 
	$devšfo_ide_ho¡_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
)

162 
H®Deviû
 *
d
;

164 
d
 = 
	`h®_deviû_Ãw
 ();

166 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

167 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "IDE host controller");

168 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.subsystem", "ide_host");

169 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "ide_host.number", 0);

171 
	`devšfo_add_’queue
 (
d
, 
devfs_·th
, &
devšfo_ide_hªdËr
);

173  (
d
);

174 
	}
}

176 
H®Deviû
 *

177 
	$devšfo_ide_deviû_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
)

179 
H®Deviû
 *
d
;

181 
d
 = 
	`h®_deviû_Ãw
();

183 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

184 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
·»Á
, "info.product", "IDE device");

185 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
·»Á
, "info.subsystem", "ide");

186 
	`h®_deviû_´İ”ty_£t_št
 (
·»Á
, "ide.host", 0);

187 
	`h®_deviû_´İ”ty_£t_št
 (
·»Á
, "ide.channel", 0);

189 
	`devšfo_add_’queue
 (
d
, 
devfs_·th
, &
devšfo_ide_hªdËr
);

191  (
	`devšfo_ide_¡Üage_add
 (
·»Á
, 
d
, 
node
, 
devfs_·th
));

192 
	}
}

194 
H®Deviû
 *

195 
	$devšfo_ide_¡Üage_add
(
H®Deviû
 *
g¿m·
, H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
)

197 
H®Deviû
 *
d
;

198 *
s
;

199 *
i
;

200 *
driv”_Çme
;

201 
udi
[
HAL_PATH_MAX
];

203 ià((
driv”_Çme
 = 
	`di_driv”_Çme
 (
node
)è=ğ
NULL
) {

204  (
NULL
);

207 
d
 = 
	`h®_deviû_Ãw
 ();

209 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

210 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "storage");

212 
	`h®d_compu‹_udi
 (
udi
,  (udi),

213 "%s/%s%d", 
	`h®_deviû_g‘_udi
 (
·»Á
),

214 
driv”_Çme
, 
	`di_š¡ªû
 (
node
));

215 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

216 
	`PROP_STR
(
d
, 
node
, 
s
, "devid", "info.product");

218 
	`h®_deviû_add_ÿ·b™y
 (
d
, "storage");

219 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "ide");

220 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "storage.lun", 0);

221 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.drive_type", "disk");

223 
	`PROP_BOOL
(
d
, 
node
, 
i
, "hotpluggable", "storage.hotpluggable");

224 
	`PROP_BOOL
(
d
, 
node
, 
i
, "removable-media", "storage.removable");

226 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.medŸ_check_’abËd", 
FALSE
);

229 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»quœes_ejeù", 
FALSE
);

231 
	`h®_deviû_add_ÿ·b™y
 (
d
, "block");

233 
	`devšfo_¡Üage_mšÜs
 (
d
, 
node
, (*)
devfs_·th
, 
FALSE
);

235  (
d
);

236 
	}
}

240 
H®Deviû
 *

241 
	$devšfo_scsi_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
)

243 *
i
;

244 *
driv”_Çme
;

245 
H®Deviû
 *
d
;

246 
udi
[
HAL_PATH_MAX
];

248 
driv”_Çme
 = 
	`di_driv”_Çme
 (
node
);

249 ià((
driv”_Çme
 =ğ
NULL
è|| (
	`¡rcmp
 (driver_name, "sd") != 0)) {

250  (
NULL
);

253 
d
 = 
	`h®_deviû_Ãw
 ();

255 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

256 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.subsystem", "scsi");

258 
	`h®d_compu‹_udi
 (
udi
,  (udi),

259 "%s/%s%d", 
	`h®_deviû_g‘_udi
 (
·»Á
),

260 
	`di_node_Çme
(
node
), 
	`di_š¡ªû
 (node));

261 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

263 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "scsi.host",

264 
	`h®_deviû_´İ”ty_g‘_št
 (
·»Á
, "scsi_host.host"));

265 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "scsi.bus", 0);

266 
	`PROP_INT
(
d
, 
node
, 
i
, "target", "scsi.target");

267 
	`PROP_INT
(
d
, 
node
, 
i
, "lun", "scsi.lun");

268 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "SCSI Device");

270 
	`devšfo_add_’queue
 (
d
, 
devfs_·th
, &
devšfo_scsi_hªdËr
);

272  (
	`devšfo_scsi_¡Üage_add
 (
·»Á
, 
d
, 
node
, 
devfs_·th
));

273 
	}
}

275 
H®Deviû
 *

276 
	$devšfo_scsi_¡Üage_add
(
H®Deviû
 *
g¿m·
, H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
)

278 
H®Deviû
 *
d
;

279 *
i
;

280 *
s
;

281 
udi
[
HAL_PATH_MAX
];

283 
d
 = 
	`h®_deviû_Ãw
 ();

285 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

286 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "storage");

288 
	`h®d_compu‹_udi
 (
udi
,  (udi),

289 "%s/sd%d", 
	`h®_deviû_g‘_udi
 (
·»Á
),

290 
	`di_š¡ªû
 (
node
));

291 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

292 
	`PROP_STR
(
d
, 
node
, 
s
, "inquiry-product-id", "info.product");

294 
	`h®_deviû_add_ÿ·b™y
 (
d
, "storage");

296 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "storage.lun",

297 
	`h®_deviû_´İ”ty_g‘_št
 (
·»Á
, "scsi.lun"));

298 
	`PROP_BOOL
(
d
, 
node
, 
i
, "hotpluggable", "storage.hotpluggable");

299 
	`PROP_BOOL
(
d
, 
node
, 
i
, "removable-media", "storage.removable");

300 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»quœes_ejeù", 
FALSE
);

311 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "storage.media_check_enabled",

312 ((
	`di_´İ_lookup_šts
(
DDI_DEV_T_ANY
, 
node
, "»movabË-medŸ", &
i
) >= 0) ||

313 (
	`di_´İ_lookup_šts
(
DDI_DEV_T_ANY
, 
node
, "hÙ¶uggabË", &
i
) >= 0)));

315 ià(
	`di_´İ_lookup_šts
(
DDI_DEV_T_ANY
, 
node
, "inquiry-device-type",

316 &
i
) > 0) {

317 
s
 = 
	`devšfo_scsi_dty³2¡r
 (*
i
);

318 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.drive_ty³", 
s
);

320 ià(
	`¡rcmp
 (
s
, "cdrom") == 0) {

321 
	`h®_deviû_add_ÿ·b™y
 (
d
, "storage.cdrom");

322 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.no_·¹™iÚs_hšt", 
TRUE
);

323 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»quœes_ejeù", 
TRUE
);

327 
	`h®_deviû_add_ÿ·b™y
 (
d
, "block");

329 
	`devšfo_¡Üage_mšÜs
 (
d
, 
node
, 
devfs_·th
, 
FALSE
);

331  (
d
);

332 
	}
}

334 *
	$devšfo_scsi_dty³2¡r
(
dty³
)

336 *
dty³2¡r
[] = {

354 ià(
dty³
 < 
	`NELEM
(
dty³2¡r
)) {

355  (
dty³2¡r
[
dty³
]);

360 
	}
}

364 
H®Deviû
 *

365 
	$devšfo_æİpy_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
)

367 *
driv”_Çme
;

368 *
¿w
;

369 
udi
[
HAL_PATH_MAX
];

370 
di_devlšk_hªdË_t
 
devlšk_hdl
;

371 
majÜ
;

372 
di_mšÜ_t
 
mšÜ
;

373 
dev_t
 
dev
;

374 
H®Deviû
 *
d
 = 
NULL
;

375 *
mšÜ_·th
 = 
NULL
;

376 *
devlšk
 = 
NULL
;

378 
driv”_Çme
 = 
	`di_driv”_Çme
 (
node
);

379 ià((
driv”_Çme
 =ğ
NULL
è|| (
	`¡rcmp
 (driver_name, "fd") != 0)) {

380  (
NULL
);

386 
majÜ
 = 
	`di_driv”_majÜ
(
node
);

387 ià((
devlšk_hdl
 = 
	`di_devlšk_š™
(
NULL
, 0)) == NULL) {

388  (
NULL
);

390 
mšÜ
 = 
DI_MINOR_NIL
;

391 (
mšÜ
 = 
	`di_mšÜ_Ãxt
(
node
, mšÜ)è!ğ
DI_MINOR_NIL
) {

392 
dev
 = 
	`di_mšÜ_devt
(
mšÜ
);

393 ià((
majÜ
 !ğ
	`majÜ
(
dev
)) ||

394 (
	`di_mšÜ_ty³
(
mšÜ
è!ğ
DDM_MINOR
) ||

395 (
	`di_mšÜ_¥eùy³
(
mšÜ
è!ğ
S_IFBLK
) ||

396 ((
mšÜ_·th
 = 
	`di_devfs_mšÜ_·th
(
mšÜ
)è=ğ
NULL
)) {

399 ià(((
devlšk
 = 
	`g‘_devlšk
(
devlšk_hdl
, 
mšÜ_·th
)è!ğ
NULL
) &&

400 (
	`¡ºcmp
 (
devlšk
, "/dev/diskette",  ("/dev/diskette") - 1) == 0)) {

403 
	`di_devfs_·th_ä“
 (
mšÜ_·th
);

404 
mšÜ_·th
 = 
NULL
;

405 
	`ä“
(
devlšk
);

406 
devlšk
 = 
NULL
;

408 
	`di_devlšk_fši
 (&
devlšk_hdl
);

410 ià((
devlšk
 =ğ
NULL
è|| (
mšÜ_·th
 == NULL)) {

411 
	`HAL_INFO
 (("æİpy devlšk‚Ù found %s", 
devfs_·th
));

412 
out
;

415 
d
 = 
	`h®_deviû_Ãw
 ();

417 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

418 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "storage");

419 
	`h®_deviû_add_ÿ·b™y
 (
d
, "storage");

420 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "platform");

421 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.hÙ¶uggabË", 
FALSE
);

422 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»movabË", 
TRUE
);

423 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»quœes_ejeù", 
TRUE
);

424 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.medŸ_check_’abËd", 
FALSE
);

425 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.drive_type", "floppy");

427 
	`h®_deviû_add_ÿ·b™y
 (
d
, "block");

428 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "block.is_vŞume", 
FALSE
);

429 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "block.majÜ", 
	`majÜ
(
dev
));

430 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "block.mšÜ", 
	`mšÜ
(
dev
));

431 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "block.deviû", 
devlšk
);

432 
¿w
 = 
	`dsk_to_rdsk
 (
devlšk
);

433 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "block.sŞ¬is.¿w_deviû", 
¿w
);

434 
	`ä“
 (
¿w
);

436 
	`devšfo_add_’queue
 (
d
, 
devfs_·th
, &
devšfo_¡Üage_hªdËr
);

439 
	`devšfo_æİpy_add_vŞume
(
d
, 
node
);

441 
out
:

442 
	`di_devfs_·th_ä“
 (
mšÜ_·th
);

443 
	`ä“
(
devlšk
);

445  (
d
);

446 
	}
}

449 
	$devšfo_æİpy_add_vŞume
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
)

451 *
devlšk
;

452 *
devfs_·th
;

453 
mšÜ
, 
majÜ
;

454 
dev_t
 
dev
;

455 
devšfo_¡Üage_mšÜ
 *
m
;

457 
devfs_·th
 = (*)
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
·»Á
, "solaris.devfs_path");

458 
devlšk
 = (*)
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
·»Á
, "block.device");

459 
majÜ
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
·»Á
, "block.major");

460 
mšÜ
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
·»Á
, "block.minor");

461 
dev
 = 
	`makedev
 (
majÜ
, 
mšÜ
);

463 
m
 = 
	`devšfo_¡Üage_Ãw_mšÜ
 (
devfs_·th
, 
WHOLE_DISK
, 
devlšk
, 
dev
, -1);

464 
	`devšfo_vŞume_add
 (
·»Á
, 
node
, 
m
);

465 
	`devšfo_¡Üage_ä“_mšÜ
 (
m
);

466 
	}
}

472 
	$devšfo_æİpy_»sÿn_´obšg_dÚe
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
, 
gšt
 
»tuº_code
,

473 **
”rÜ
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

475 *
’d_tok’
 = (*è
u£rd©a1
;

476 cÚ¡ *
devfs_·th
;

477 
di_node_t
 
node
;

478 
H®Deviû
 *
v
;

480 ià(!
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "storage.removable.media_available")) {

481 
	`HAL_INFO
 (("nØæİpy medŸ", 
	`h®_deviû_g‘_udi
 (
d
)));

484 ià(((
v
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
(),

485 "šfo.·»Á", 
	`h®_deviû_g‘_udi
 (
d
))è!ğ
NULL
) &&

486 ((
devfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
v
,

487 "sŞ¬is.devfs_·th")è!ğ
NULL
)) {

488 
	`devšfo_»move_’queue
 ((*)
devfs_·th
, 
NULL
);

491 
	`HAL_INFO
 (("æİpy medŸ found", 
	`h®_deviû_g‘_udi
 (
d
)));

493 ià((
devfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
d
, "sŞ¬is.devfs_·th")è=ğ
NULL
) {

494 
	`HAL_INFO
 (("nØdevfs_·th", 
	`h®_deviû_g‘_udi
 (
d
)));

495 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

498 ià((
node
 = 
	`di_š™
 (
devfs_·th
, 
DINFOCPYALL
)è=ğ
DI_NODE_NIL
) {

499 
	`HAL_INFO
 (("di_š™ % çed %d", 
devfs_·th
, 
”ºo
));

500 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

504 
	`devšfo_æİpy_add_vŞume
 (
d
, 
node
);

506 
	`di_fši
 (
node
);

509 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

510 
	}
}

514 
H®Deviû
 *

515 
	$devšfo_lofi_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
)

517  (
	`devšfo_lofi_add_majÜ
(
·»Á
,
node
, 
devfs_·th
, 
deviû_ty³
, 
FALSE
, 
NULL
));

518 
	}
}

520 
H®Deviû
 *

521 
	$devšfo_lofi_add_majÜ
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
,

522 
gboŞ—n
 
»sÿn
, 
H®Deviû
 *
lofi_d
)

524 *
driv”_Çme
;

525 
H®Deviû
 *
d
 = 
NULL
;

526 
udi
[
HAL_PATH_MAX
];

527 
di_devlšk_hªdË_t
 
devlšk_hdl
;

528 
majÜ
;

529 
di_mšÜ_t
 
mšÜ
;

530 
dev_t
 
dev
;

531 *
mšÜ_·th
 = 
NULL
;

532 *
dev·th
, *
devlšk
;

534 
driv”_Çme
 = 
	`di_driv”_Çme
 (
node
);

535 ià((
driv”_Çme
 =ğ
NULL
è|| (
	`¡rcmp
 (driver_name, "lofi") != 0)) {

536  (
NULL
);

539 ià(!
»sÿn
) {

540 
d
 = 
	`h®_deviû_Ãw
 ();

542 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

543 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.subsystem", "pseudo");

545 
	`h®d_compu‹_udi
 (
udi
,  (udi),

546 "%s/%s%d", 
	`h®_deviû_g‘_udi
 (
·»Á
),

547 
	`di_node_Çme
(
node
), 
	`di_š¡ªû
 (node));

548 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

550 
	`devšfo_add_’queue
 (
d
, 
devfs_·th
, &
devšfo_lofi_hªdËr
);

552 
d
 = 
lofi_d
;

562 
majÜ
 = 
	`di_driv”_majÜ
(
node
);

563 ià((
devlšk_hdl
 = 
	`di_devlšk_š™
(
NULL
, 0)) == NULL) {

564  (
d
);

566 
mšÜ
 = 
DI_MINOR_NIL
;

567 (
mšÜ
 = 
	`di_mšÜ_Ãxt
(
node
, mšÜ)è!ğ
DI_MINOR_NIL
) {

568 
dev
 = 
	`di_mšÜ_devt
(
mšÜ
);

569 ià((
majÜ
 !ğ
	`majÜ
(
dev
)) ||

570 (
	`di_mšÜ_ty³
(
mšÜ
è!ğ
DDM_MINOR
) ||

571 (
	`di_mšÜ_¥eùy³
(
mšÜ
è!ğ
S_IFBLK
) ||

572 ((
mšÜ_·th
 = 
	`di_devfs_mšÜ_·th
(
mšÜ
)è=ğ
NULL
)) {

575 ià((
devlšk
 = 
	`g‘_devlšk
(
devlšk_hdl
, 
mšÜ_·th
)è=ğ
NULL
) {

576 
	`di_devfs_·th_ä“
 (
mšÜ_·th
);

580 ià(!
»sÿn
 ||

581 (
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

582 "sŞ¬is.devfs_·th", 
mšÜ_·th
è=ğ
NULL
)) {

583 
	`devšfo_lofi_add_mšÜ
(
d
, 
node
, 
mšÜ_·th
, 
devlšk
, 
dev
);

586 
	`di_devfs_·th_ä“
 (
mšÜ_·th
);

587 
	`ä“
(
devlšk
);

589 
	`di_devlšk_fši
 (&
devlšk_hdl
);

591  (
d
);

592 
	}
}

595 
	$devšfo_lofi_add_mšÜ
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
mšÜ_·th
, *
devlšk
, 
dev_t
 
dev
)

597 
H®Deviû
 *
d
;

598 *
¿w
;

599 *
do¦šk
;

600 
do¥©h
[64];

601 
devšfo_¡Üage_mšÜ
 *
m
;

602 
i
;

605 
d
 = 
	`h®_deviû_Ãw
 ();

607 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
mšÜ_·th
);

608 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "storage");

609 
	`h®_deviû_add_ÿ·b™y
 (
d
, "storage");

610 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.bus", "lofi");

611 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.hÙ¶uggabË", 
TRUE
);

612 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»movabË", 
FALSE
);

613 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "¡Üage.»quœes_ejeù", 
FALSE
);

614 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "storage.drive_type", "disk");

615 
	`h®_deviû_add_ÿ·b™y
 (
d
, "block");

616 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "block.majÜ", 
	`majÜ
(
dev
));

617 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "block.mšÜ", 
	`mšÜ
(
dev
));

618 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "block.deviû", 
devlšk
);

619 
¿w
 = 
	`dsk_to_rdsk
 (
devlšk
);

620 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "block.sŞ¬is.¿w_deviû", 
¿w
);

621 
	`ä“
 (
¿w
);

622 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "block.is_vŞume", 
FALSE
);

624 
	`devšfo_add_’queue
 (
d
, 
mšÜ_·th
, &
devšfo_¡Üage_hªdËr
);

627 
m
 = 
	`devšfo_¡Üage_Ãw_mšÜ
(
mšÜ_·th
, 
WHOLE_DISK
, 
devlšk
, 
dev
, -1);

628 
	`devšfo_vŞume_add
 (
d
, 
node
, 
m
);

629 
	`devšfo_¡Üage_ä“_mšÜ
 (
m
);

631 
do¦šk
 = (*)
	`ÿÎoc
 (1, 
	`¡¾’
 (
devlšk
) +  (":NNN") + 1);

632 ià(
do¦šk
 !ğ
NULL
) {

633 
i
 = 1; i < 16; i++) {

634 
	`¢´štf
(
do¥©h
,  (do¥©h), 
WHOLE_DISK
":%d", 
i
);

635 
	`¥rštf
(
do¦šk
, "%s:%d", 
devlšk
, 
i
);

636 
m
 = 
	`devšfo_¡Üage_Ãw_mšÜ
(
mšÜ_·th
, 
do¥©h
, 
do¦šk
, 
dev
, 
i
);

637 
	`devšfo_vŞume_add
 (
d
, 
node
, 
m
);

638 
	`devšfo_¡Üage_ä“_mšÜ
 (
m
);

640 
	`ä“
 (
do¦šk
);

642 
	}
}

645 
	$devšfo_lofi_»move_mšÜ
(*
·»Á_devfs_·th
, *
Çme
)

647 
GSLi¡
 *
i
;

648 
GSLi¡
 *
deviûs
;

649 
H®Deviû
 *
d
 = 
NULL
;

650 cÚ¡ *
devfs_·th
;

652 
deviûs
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
(),

653 "block.sŞ¬is.¿w_deviû", 
Çme
);

654 
i
 = 
deviûs
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

655 ià(
	`h®_deviû_has_ÿ·b™y
 (
	`HAL_DEVICE
 (
i
->
d©a
), "storage")) {

656 
d
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

660 
	`g_¦i¡_ä“
 (
deviûs
);

662 ià(
d
 =ğ
NULL
) {

663 
	`HAL_INFO
 (("deviû‚Ù found %s", 
Çme
));

667 ià((
devfs_·th
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
,

668 "sŞ¬is.devfs_·th")è=ğ
NULL
) {

669 
	`HAL_INFO
 (("devfs_·th‚Ù found %s", 
	`h®_deviû_g‘_udi
 (
d
)));

673 ià(
d
 !ğ
NULL
) {

674 
	`devšfo_»move_b¿nch
 ((*)
devfs_·th
, 
d
);

676 
	}
}

681 
	$w®k_devlšks
(
di_devlšk_t
 
devlšk
, *
¬g
)

683 **
·th
ğ(**)
¬g
;

685 *
·th
 = 
	`¡rdup
(
	`di_devlšk_·th
(
devlšk
));

687  (
DI_WALK_TERMINATE
);

688 
	}
}

691 
	$g‘_devlšk
(
di_devlšk_hªdË_t
 
devlšk_hdl
, *
·th
)

693 *
devlšk_·th
 = 
NULL
;

695 (è
	`di_devlšk_w®k
(
devlšk_hdl
, 
NULL
, 
·th
,

696 
DI_PRIMARY_LINK
, &
devlšk_·th
, 
w®k_devlšks
);

698  (
devlšk_·th
);

699 
	}
}

702 
	$devšfo_¡Üage_ä“_mšÜ
(
devšfo_¡Üage_mšÜ
 *
m
)

704 ià(
m
 !ğ
NULL
) {

705 
	`ä“
 (
m
->
¦iû
);

706 
	`ä“
 (
m
->
devlšk
);

707 
	`ä“
 (
m
->
dev·th
);

708 
	`ä“
 (
m
);

710 
	}
}

712 
devšfo_¡Üage_mšÜ
 *

713 
	$devšfo_¡Üage_Ãw_mšÜ
(*
mašdev_·th
, *
¦iû
, *
devlšk
, 
dev_t
 
dev
, 
do¢um
)

715 
devšfo_¡Üage_mšÜ
 *
m
;

716 
·thËn
;

717 *
dev·th
;

719 
m
 = (
devšfo_¡Üage_mšÜ
 *)
	`ÿÎoc
 ( (devinfo_storage_minor), 1);

720 ià(
m
 !ğ
NULL
) {

725 
·thËn
 = 
	`¡¾’
 (
mašdev_·th
è+ sŒËÀ(
¦iû
) + 2;

726 
dev·th
 = (*)
	`ÿÎoc
 (1, 
·thËn
);

727 
	`¢´štf
(
dev·th
, 
·thËn
, "%s/%s", 
mašdev_·th
, 
¦iû
);

729 
m
->
dev·th
 = devpath;

730 
m
->
devlšk
 = 
	`¡rdup
 (devlink);

731 
m
->
¦iû
 = 
	`¡rdup
 (slice);

732 
m
->
dev
 = dev;

733 
m
->
do¢um
 = dosnum;

734 ià((
m
->
dev·th
 =ğ
NULL
è|| (m->
devlšk
 == NULL)) {

735 
	`devšfo_¡Üage_ä“_mšÜ
 (
m
);

736 
m
 = 
NULL
;

739  (
m
);

740 
	}
}

747 
	$devšfo_¡Üage_mšÜs
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, 
gch¬
 *
devfs_·th
, 
gboŞ—n
 
»sÿn
)

749 
di_devlšk_hªdË_t
 
devlšk_hdl
;

750 
gboŞ—n
 
is_cdrom
;

751 cÚ¡ *
whŞe_disk
;

752 
majÜ
;

753 
di_mšÜ_t
 
mšÜ
;

754 
dev_t
 
dev
;

755 *
mšÜ_·th
 = 
NULL
;

756 *
mašdev_·th
 = 
NULL
;

757 *
dev·th
, *
devlšk
;

758 
do¦šk_Ën
;

759 *
do¦šk
;

760 
do¥©h
[64];

761 *
¦iû
;

762 
·thËn
;

763 
i
;

764 *
¿w
;

765 
boŞ—n_t
 
mašdev_is_d0
;

766 
GQueue
 *
mq
;

767 
H®Deviû
 *
vŞume
;

768 
devšfo_¡Üage_mšÜ
 *
m
;

769 
devšfo_¡Üage_mšÜ
 *
mašdev
 = 
NULL
;

772 
is_cdrom
 = 
	`h®_deviû_has_ÿ·b™y
 (
·»Á
, "storage.cdrom");

773 
whŞe_disk
 = 
is_cdrom
 ? "s2" : 
WHOLE_DISK
;

775 
majÜ
 = 
	`di_driv”_majÜ
(
node
);

781 ià((
mq
 = 
	`g_queue_Ãw
()è=ğ
NULL
) {

782 
”r
;

784 ià((
devlšk_hdl
 = 
	`di_devlšk_š™
(
NULL
, 0)) == NULL) {

785 
	`g_queue_ä“
 (
mq
);

786 
”r
;

788 
mšÜ
 = 
DI_MINOR_NIL
;

789 (
mšÜ
 = 
	`di_mšÜ_Ãxt
(
node
, mšÜ)è!ğ
DI_MINOR_NIL
) {

790 
dev
 = 
	`di_mšÜ_devt
(
mšÜ
);

791 ià((
majÜ
 !ğ
	`majÜ
(
dev
)) ||

792 (
	`di_mšÜ_ty³
(
mšÜ
è!ğ
DDM_MINOR
) ||

793 (
	`di_mšÜ_¥eùy³
(
mšÜ
è!ğ
S_IFBLK
) ||

794 ((
mšÜ_·th
 = 
	`di_devfs_mšÜ_·th
(
mšÜ
)è=ğ
NULL
)) {

797 ià((
devlšk
 = 
	`g‘_devlšk
(
devlšk_hdl
, 
mšÜ_·th
)è=ğ
NULL
) {

798 
	`di_devfs_·th_ä“
 (
mšÜ_·th
);

802 
¦iû
 = 
	`devšfo_vŞume_g‘_¦iû_Çme
 (
devlšk
);

803 ià(
	`¡¾’
 (
¦iû
) < 2) {

804 
	`ä“
 (
devlšk
);

805 
	`di_devfs_·th_ä“
 (
mšÜ_·th
);

810 ià((
	`¡¾’
 (
¦iû
è> 1è&& (¦iû[0] =ğ'p'è&& 
	`isdig™
(slice[1]) &&

811 ((
	`©Ş
(&
¦iû
[1])) > 0)) {

812 
	`ä“
 (
devlšk
);

813 
	`di_devfs_·th_ä“
 (
mšÜ_·th
);

817 
m
 = 
	`devšfo_¡Üage_Ãw_mšÜ
(
mšÜ_·th
, 
¦iû
, 
devlšk
, 
dev
, -1);

818 ià(
m
 =ğ
NULL
) {

819 
	`ä“
 (
devlšk
);

820 
	`di_devfs_·th_ä“
 (
mšÜ_·th
);

825 ià((
	`¡rcmp
 (
¦iû
, "d0") == 0) ||

826 (((
	`¡rcmp
 (
¦iû
, 
whŞe_disk
è=ğ0è&& (
mašdev
 =ğ
NULL
)))) {

827 ià(
mašdev_·th
 !ğ
NULL
) {

828 
	`di_devfs_·th_ä“
 (
mašdev_·th
);

830 
mašdev_·th
 = 
mšÜ_·th
;

831 
mašdev
 = 
m
;

832 
	`g_queue_push_h—d
 (
mq
, 
mašdev
);

834 
	`di_devfs_·th_ä“
 (
mšÜ_·th
);

835 
	`g_queue_push_
 (
mq
, 
m
);

838 
	`ä“
 (
devlšk
);

840 
	`di_devlšk_fši
 (&
devlšk_hdl
);

842 ià(
mašdev
 =ğ
NULL
) {

844 !
	`g_queue_is_em±y
 (
mq
)) {

845 
	`devšfo_¡Üage_ä“_mšÜ
 (
	`g_queue_pİ_h—d
 (
mq
));

847 
”r
;

851 ià(!
»sÿn
) {

852 
	`h®_deviû_´İ”ty_£t_št
 (
·»Á
, "block.majÜ", 
majÜ
);

853 
	`h®_deviû_´İ”ty_£t_št
 (
·»Á
, "block.mšÜ", 
	`mšÜ
(
mašdev
->
dev
));

854 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
·»Á
, "block.deviû", 
mašdev
->
devlšk
);

855 
¿w
 = 
	`dsk_to_rdsk
 (
mašdev
->
devlšk
);

856 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
·»Á
, "block.sŞ¬is.¿w_deviû", 
¿w
);

857 
	`ä“
 (
¿w
);

858 
	`h®_deviû_´İ”ty_£t_boŞ
 (
·»Á
, "block.is_vŞume", 
FALSE
);

859 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
·»Á
, "sŞ¬is.devfs_·th", 
mašdev_·th
);

860 
	`devšfo_add_’queue
 (
·»Á
, 
mašdev_·th
, &
devšfo_¡Üage_hªdËr
);

864 ià(!
is_cdrom
) {

865 
do¦šk_Ën
 = 
	`¡¾’
 (
mašdev
->
devlšk
) +  (":NNN") + 1;

866 ià((
do¦šk
 = (*)
	`ÿÎoc
 (1, 
do¦šk_Ën
)è!ğ
NULL
) {

867 
i
 = 1; i < 16; i++) {

868 
	`¢´štf
(
do¥©h
,  (do¥©h), "%s:%d", 
mašdev
->
¦iû
, 
i
);

869 
	`¢´štf
(
do¦šk
, 
do¦šk_Ën
, "%s:%d", 
mašdev
->
devlšk
, 
i
);

870 
m
 = 
	`devšfo_¡Üage_Ãw_mšÜ
(
mašdev_·th
, 
do¥©h
, 
do¦šk
, 
mašdev
->
dev
, 
i
);

871 
	`g_queue_push_
 (
mq
, 
m
);

873 
	`ä“
 (
do¦šk
);

877 
mašdev_is_d0
 = (
	`¡rcmp
 (
mašdev
->
¦iû
, "d0") == 0);

880 !
	`g_queue_is_em±y
 (
mq
)) {

881 
m
 = 
	`g_queue_pİ_h—d
 (
mq
);

884 ià(
mašdev_is_d0
 && (
	`¡rcmp
 (
m
->
¦iû
, 
whŞe_disk
) == 0)) {

885 
	`devšfo_¡Üage_ä“_mšÜ
 (
m
);

889 ià(
is_cdrom
 && (
	`¡rcmp
 (
m
->
¦iû
, "p0") == 0)) {

890 
	`devšfo_¡Üage_ä“_mšÜ
 (
m
);

893 ià(
»sÿn
) {

896 
vŞume
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

897 "sŞ¬is.devfs_·th", 
m
->
dev·th
);

898 ià((
vŞume
 =ğ
NULL
è|| !
	`h®_deviû_has_ÿ·b™y
(volume, "volume")) {

899 
	`devšfo_vŞume_add
 (
·»Á
, 
node
, 
m
);

901 
	`HAL_INFO
(("»sÿÀvŞumexi¡ %s", 
m
->
dev·th
));

904 
	`devšfo_vŞume_add
 (
·»Á
, 
node
, 
m
);

906 
	`devšfo_¡Üage_ä“_mšÜ
 (
m
);

909 ià(
mašdev_·th
 !ğ
NULL
) {

910 
	`di_devfs_·th_ä“
 (
mašdev_·th
);

915 
”r
:

916 ià(
mašdev_·th
 !ğ
NULL
) {

917 
	`di_devfs_·th_ä“
 (
mašdev_·th
);

919 ià(!
»sÿn
) {

920 
	`devšfo_add_’queue
 (
·»Á
, 
devfs_·th
, &
devšfo_¡Üage_hªdËr
);

922 
	}
}

924 
H®Deviû
 *

925 
	$devšfo_vŞume_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, 
devšfo_¡Üage_mšÜ_t
 *
m
)

927 
H®Deviû
 *
d
;

928 *
¿w
;

929 
udi
[
HAL_PATH_MAX
];

930 *
devfs_·th
 = 
m
->
dev·th
;

931 *
devlšk
 = 
m
->devlink;

932 
dev_t
 
dev
 = 
m
->dev;

933 
do¢um
 = 
m
->dosnum;

934 *
¦iû
 = 
m
->slice;

936 
	`HAL_INFO
 (("vŞume_add: devfs_·th=% devlšk=%s", 
devfs_·th
, 
devlšk
));

937 
d
 = 
	`h®_deviû_Ãw
 ();

939 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

940 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "volume");

942 
	`h®d_compu‹_udi
 (
udi
,  (udi),

943 "%s/%s", 
	`h®_deviû_g‘_udi
 (
·»Á
), 
¦iû
);

944 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

945 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "šfo.´oduù", 
¦iû
);

947 
	`h®_deviû_add_ÿ·b™y
 (
d
, "volume");

948 
	`h®_deviû_add_ÿ·b™y
 (
d
, "block");

949 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "block.majÜ", 
	`majÜ
 (
dev
));

950 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "block.mšÜ", 
	`mšÜ
 (
dev
));

951 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "block.deviû", 
devlšk
);

952 
¿w
 = 
	`dsk_to_rdsk
 (
devlšk
);

953 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "block.sŞ¬is.¿w_deviû", 
¿w
);

954 
	`ä“
 (
¿w
);

955 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "block.sŞ¬is.¦iû", 
¦iû
);

956 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "block.is_vŞume", 
TRUE
);

958 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "block.¡Üage_deviû", 
	`h®_deviû_g‘_udi
 (
·»Á
));

961 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.fstype", "");

962 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.fsusage", "");

963 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.fsversion", "");

964 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.uuid", "");

965 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.label", "");

966 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.mount_point", "");

967 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.is_mouÁed", 
FALSE
);

968 ià(
	`¡rcmp
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
·»Á
, "storage.drive_type"), "cdrom") == 0) {

969 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.is_disc", 
TRUE
);

970 
	`h®_deviû_add_ÿ·b™y
 (
d
, "volume.disc");

972 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.is_disc", 
FALSE
);

975 ià(
do¢um
 > 0) {

976 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.is_·¹™iÚ", 
TRUE
);

977 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "vŞume.·¹™iÚ.numb”", 
do¢um
);

979 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.is_·¹™iÚ", 
FALSE
);

983 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "volume.block_size", 512);

985 
	`devšfo_add_’queue
 (
d
, 
devfs_·th
, &
devšfo_vŞume_hªdËr
);

987  (
d
);

988 
	}
}

991 
	$devšfo_vŞume_´•robšg_dÚe
 (
H®Deviû
 *
d
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

993 *
’d_tok’
 = (*è
u£rd©a1
;

994 *
whŞe_disk
;

995 *
block_deviû
;

996 cÚ¡ *
¡Üage_udi
;

997 
H®Deviû
 *
¡Üage_d
;

998 cÚ¡ *
¦iû
;

999 
dos_num
;

1001 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "info.ignore")) {

1002 
	`HAL_INFO
 (("P»´obšg m”ged info.ignÜe==TRUE %s", 
	`h®_deviû_g‘_udi
 (
d
)));

1003 
sk
;

1009 
block_deviû
 = (*)
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "block.device");

1010 
¡Üage_udi
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "block.storage_device");

1011 
¦iû
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
(
d
, "block.solaris.slice");

1012 ià((
block_deviû
 =ğ
NULL
è|| (
¡Üage_udi
 == NULL) ||

1013 (
¦iû
 =ğ
NULL
è|| (
	`¡¾’
 (slice) < 2)) {

1014 
	`HAL_INFO
 (("M®fÜmed vŞum´İ”t› %s", 
	`h®_deviû_g‘_udi
 (
d
)));

1015 
sk
;

1017 
¡Üage_d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "šfo.udi", 
¡Üage_udi
);

1018 ià(
¡Üage_d
 =ğ
NULL
) {

1019 
	`HAL_INFO
 (("StÜagdeviû‚Ù found %s", 
	`h®_deviû_g‘_udi
 (
d
)));

1020 
sk
;

1023 
whŞe_disk
 = 
	`h®_deviû_has_ÿ·b™y
 (
¡Üage_d
,

1024 "¡Üage.cdrom"è? "s2" : 
WHOLE_DISK
;

1026 ià(
	`is_dos_·th
(
block_deviû
, &
dos_num
)) {

1028 ià((
	`h®_deviû_´İ”ty_g‘_boŞ
 (
¡Üage_d
, "storage.no_partitions_hint") ||

1029 (
dos_num
 > 
	`h®_deviû_´İ”ty_g‘_št
 (
¡Üage_d
, "storage.solaris.num_dos_partitions")))) {

1030 
	`HAL_INFO
 (("%d > %d %s", 
dos_num
, 
	`h®_deviû_´İ”ty_g‘_št
 (
¡Üage_d
,

1031 "¡Üage.sŞ¬is.num_dos_·¹™iÚs"), 
	`h®_deviû_g‘_udi
 (
¡Üage_d
)));

1032 
sk
;

1036 ià((
¦iû
[0] =ğ's'è&& (
	`isdig™
(¦iû[1])è&& ((
	`¡rcmp
 (¦iû, 
whŞe_disk
)) != 0) &&

1037 !
	`h®_deviû_´İ”ty_g‘_boŞ
 (
¡Üage_d
, "storage.solaris.vtoc_slices")) {

1038 
	`HAL_INFO
 (("NÙ…robšg sliû %s", 
	`h®_deviû_g‘_udi
 (
d
)));

1039 
sk
;

1043 
	`HAL_INFO
(("Probšg udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1044 
	`h®d_ruÂ”_run
 (
d
,

1045 "h®d-´obe-vŞume", 
NULL
,

1046 
DEVINFO_PROBE_VOLUME_TIMEOUT
,

1047 
devšfo_ÿÎouts_´obšg_dÚe
,

1048 (
gpoš‹r
è
’d_tok’
, 
u£rd©a2
);

1052 
sk
:

1053 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

1054 
	`g_objeù_uÄef
 (
d
);

1055 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1056 
	}
}

1059 
	$devšfo_vŞume_hÙ¶ug_begš_add
 (
H®Deviû
 *
d
, H®Deviû *
·»Á
, 
DevšfoDevHªdËr
 *
hªdËr
, *
’d_tok’
)

1061 
	`HAL_INFO
(("P»´obšg vŞumudi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1063 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
·»Á
, "info.ignore")) {

1064 
	`HAL_INFO
 (("Ignoring volume:…arent's info.ignore is TRUE"));

1065 
sk
;

1069 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
d
);

1072 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_PREPROBE
);

1075 
	`h®_ut_ÿÎout_deviû_´•robe
 (
d
, 
devšfo_vŞume_´•robšg_dÚe
, 
’d_tok’
, 
hªdËr
);

1079 
sk
:

1080 
	`g_objeù_uÄef
 (
d
);

1081 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1082 
	}
}

1085 
	$devšfo_¡Üage_hÙ¶ug_begš_add
 (
H®Deviû
 *
d
, H®Deviû *
·»Á
, 
DevšfoDevHªdËr
 *
hªdËr
, *
’d_tok’
)

1087 cÚ¡ *
drive_ty³
;

1088 cÚ¡ *
p_udi
;

1089 
H®Deviû
 *
p_d
;

1090 
H®Deviû
 *
phys_d
 = 
NULL
;

1091 cÚ¡ *
phys_bus
;

1092 cÚ¡ *
bus
;

1093 cÚ¡ *
bus£s
[] = { "usb", "ide", "scsi", "ieee1394",

1095 
i
;

1097 
	`HAL_INFO
 (("P»´obšg udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1099 ià(
·»Á
 =ğ
NULL
) {

1100 
	`HAL_INFO
 (("nØ·»Á %s", 
	`h®_deviû_g‘_udi
 (
d
)));

1101 
”rÜ
;

1107 
drive_ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.drive_type");

1108 ià((
drive_ty³
 !ğ
NULL
è&& (
	`¡rcmp
 (drive_type, "floppy") == 0)) {

1109 
sk_bus
;

1112 
p_d
 = 
·»Á
;

1114 
bus
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
p_d
, "info.subsystem");

1115 ià(
bus
 !ğ
NULL
) {

1116 
i
 = 0; i < 
	`NELEM
(
bus£s
); i++) {

1117 ià(
	`¡rcmp
(
bus
, 
bus£s
[
i
]) == 0) {

1118 
phys_d
 = 
p_d
;

1119 
phys_bus
 = 
bus£s
[
i
];

1125 
p_udi
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
p_d
, "info.parent");

1126 ià(
p_udi
 =ğ
NULL
) {

1129 
p_d
 = 
	`h®_deviû_¡Üe_fšd
 (
	`h®d_g‘_gdl
 (), 
p_udi
);

1131 ià(
phys_d
 =ğ
NULL
) {

1132 
	`HAL_INFO
 (("nØphysiÿÈdeviû %s", 
	`h®_deviû_g‘_udi
 (
d
)));

1133 
”rÜ
;

1135 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.Üigš©šg_deviû", 
	`h®_deviû_g‘_udi
 (
phys_d
));

1136 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.bus", 
phys_bus
);

1138 
sk_bus
:

1141 
	`h®_deviû_¡Üe_add
 (
	`h®d_g‘_tdl
 (), 
d
);

1144 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_PREPROBE
);

1147 
	`h®_ut_ÿÎout_deviû_´•robe
 (
d
, 
devšfo_ÿÎouts_´•robšg_dÚe
, 
’d_tok’
, 
hªdËr
);

1151 
”rÜ
:

1152 
	`g_objeù_uÄef
 (
d
);

1153 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1154 
	}
}

1157 
	$devšfo_¡Üage_´obšg_dÚe
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
, 
gšt
 
»tuº_code
, **
”rÜ
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

1159 *
’d_tok’
 = (*è
u£rd©a1
;

1161 
	`HAL_INFO
 (("devšfo_¡Üage_´obšg_dÚ%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1164 ià(
ex™_ty³
 !ğ
HALD_RUN_SUCCESS
 || 
»tuº_code
 != 0) {

1165 
	`HAL_INFO
 (("devšfo_¡Üage_´obšg_dÚ»tuºšgƒx™_ty³=%d„‘uº_code=%d", 
ex™_ty³
, 
»tuº_code
));

1166 
	`h®_deviû_¡Üe_»move
 (
	`h®d_g‘_tdl
 (), 
d
);

1167 
	`g_objeù_uÄef
 (
d
);

1168 
	`hÙ¶ug_ev’t_’d
 (
’d_tok’
);

1172 
	`devšfo_¡Üage_£t_nickÇmes
 (
d
);

1175 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_INFORMATION
);

1176 
	`di_£¬ch_ªd_m”ge
 (
d
, 
DEVICE_INFO_TYPE_POLICY
);

1178 
	`h®_ut_ÿÎout_deviû_add
 (
d
, 
devšfo_ÿÎouts_add_dÚe
, 
’d_tok’
, 
NULL
);

1179 
	}
}

1181 cÚ¡ 
gch¬
 *

1182 
	$devšfo_¡Üage_g‘_´ob”
 (
H®Deviû
 *
d
, *
timeout
)

1184 *
timeout
 = 
DEVINFO_PROBE_STORAGE_TIMEOUT
;

1186 
	}
}

1188 cÚ¡ 
gch¬
 *

1189 
	$devšfo_vŞume_g‘_´ob”
 (
H®Deviû
 *
d
, *
timeout
)

1191 *
timeout
 = 
DEVINFO_PROBE_VOLUME_TIMEOUT
;

1193 
	}
}

1199 
	$devšfo_¡Üage_»sÿn_´obšg_dÚe
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
, 
gšt
 
»tuº_code
, **
”rÜ
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

1201 *
’d_tok’
 = (*è
u£rd©a1
;

1202 cÚ¡ *
devfs_·th_Üig
 = 
NULL
;

1203 *
devfs_·th
 = 
NULL
;

1204 *
p
;

1205 
di_node_t
 
node
;

1207 
	`HAL_INFO
 (("devšfo_¡Üage_»sÿn_´obšg_dÚ%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1209 
devfs_·th_Üig
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "solaris.devfs_path");

1210 ià(
devfs_·th_Üig
 =ğ
NULL
) {

1211 
	`HAL_INFO
 (("device has‚o solaris.devfs_path"));

1212 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

1217 ià(
	`¡¼chr
(
devfs_·th_Üig
, ':'è!ğ
NULL
) {

1218 ià((
devfs_·th
 = 
	`¡rdup
 (
devfs_·th_Üig
)è!ğ
NULL
) {

1219 
p
 = 
	`¡¼chr
(
devfs_·th
, ':');

1220 *
p
 = '\0';

1223 
devfs_·th
 = (*)
devfs_·th_Üig
;

1226 ià((
node
 = 
	`di_š™
 (
devfs_·th
, 
DINFOCPYALL
)è=ğ
DI_NODE_NIL
) {

1227 
	`HAL_INFO
 (("di_š™ % çed %d %s", 
devfs_·th
, 
”ºo
, 
	`h®_deviû_g‘_udi
 (
d
)));

1228 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

1231 
	`devšfo_¡Üage_mšÜs
 (
d
, 
node
, (*)
devfs_·th
, 
TRUE
);

1232 
	`di_fši
 (
node
);

1235 ià(
devfs_·th
 !ğ
devfs_·th_Üig
) {

1236 
	`ä“
 (
devfs_·th
);

1239 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

1240 
	}
}

1249 
gboŞ—n


1250 
	$devšfo_¡Üage_deviû_»sÿn
 (
H®Deviû
 *
d
)

1252 
GSLi¡
 *
i
;

1253 
GSLi¡
 *
vŞumes
;

1254 
H®Deviû
 *
v
;

1255 
gch¬
 *
v_devfs_·th
;

1256 cÚ¡ *
drive_ty³
;

1257 
gboŞ—n
 
is_æİpy
;

1258 
gboŞ—n
 
medŸ_avaabË
;

1260 
	`HAL_INFO
 (("devšfo_¡Üage_deviû_»sÿÀudi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1262 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "block.is_volume")) {

1263 
	`HAL_INFO
 (("nothingo do for volume"));

1264  (
FALSE
);

1267 
drive_ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.drive_type");

1268 
is_æİpy
 = (
drive_ty³
 !ğ
NULL
è&& (
	`¡rcmp
 (drive_type, "floppy") == 0);

1270 
medŸ_avaabË
 = !
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "storage.removable") ||

1271 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "storage.removable.media_available");

1273 ià(!
medŸ_avaabË
 && !
is_æİpy
) {

1274 
	`HAL_INFO
 (("medŸ gÚ%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1276 
vŞumes
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
(),

1277 "block.¡Üage_deviû", 
	`h®_deviû_g‘_udi
 (
d
));

1278 
i
 = 
vŞumes
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

1279 
v
 = 
	`HAL_DEVICE
 (
i
->
d©a
);

1280 
v_devfs_·th
 = (
gch¬
 *)
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
v
, "solaris.devfs_path");

1281 
	`HAL_INFO
 (("chd vŞum%s", 
	`h®_deviû_g‘_udi
 (
v
)));

1282 ià((
v_devfs_·th
 !ğ
NULL
è&& 
	`h®_deviû_has_ÿ·b™y
 (
v
, "volume")) {

1283 
	`HAL_INFO
 (("»movšg vŞum%s", 
	`h®_deviû_g‘_udi
 (
v
)));

1284 
	`devšfo_»move_’queue
 (
v_devfs_·th
, 
NULL
);

1286 
	`HAL_INFO
 (("nÙ‡ vŞum%s", 
	`h®_deviû_g‘_udi
 (
v
)));

1289 
	`g_¦i¡_ä“
 (
vŞumes
);

1291 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

1292 } ià(
is_æİpy
) {

1293 
	`HAL_INFO
 (("»sÿÂšg flİpy %s", 
	`h®_deviû_g‘_udi
 (
d
)));

1295 
	`h®d_ruÂ”_run
 (
d
,

1296 "h®d-´obe-¡Üag--Úly-check-fÜ-medŸ", 
NULL
,

1297 
DEVINFO_PROBE_STORAGE_TIMEOUT
,

1298 
devšfo_æİpy_»sÿn_´obšg_dÚe
,

1299 
NULL
, NULL);

1301 
	`HAL_INFO
 (("medŸ‡vaabË %s", 
	`h®_deviû_g‘_udi
 (
d
)));

1303 
	`h®d_ruÂ”_run
 (
d
,

1304 "h®d-´obe-¡Üag--Úly-check-fÜ-medŸ", 
NULL
,

1305 
DEVINFO_PROBE_STORAGE_TIMEOUT
,

1306 
devšfo_¡Üage_»sÿn_´obšg_dÚe
,

1307 
NULL
, NULL);

1310  
TRUE
;

1311 
	}
}

1314 
	$devšfo_vŞume_g‘_¦iû_Çme
 (*
devlšk
)

1316 *
·¹
, *
¦iû
, *
disk
;

1317 *
s
 = 
NULL
;

1318 *
p
;

1320 ià((
p
 = 
	`¡r¡r
(
devlšk
, "/lofi/")) != 0) {

1321  (
p
 +  ("/lofi/") - 1);

1324 
·¹
 = 
	`¡¼chr
(
devlšk
, 'p');

1325 
¦iû
 = 
	`¡¼chr
(
devlšk
, 's');

1326 
disk
 = 
	`¡¼chr
(
devlšk
, 'd');

1328 ià((
·¹
 !ğ
NULL
è&& (·¹ > 
¦iû
è&& (·¹ > 
disk
)) {

1329 
s
 = 
·¹
;

1330 } ià((
¦iû
 !ğ
NULL
è&& (¦iû > 
disk
)) {

1331 
s
 = 
¦iû
;

1333 
s
 = 
disk
;

1335 ià((
s
 !ğ
NULL
è&& 
	`isdig™
(s[1])) {

1336  (
s
);

1340 
	}
}

1342 
gboŞ—n


1343 
	$is_dos_·th
(*
·th
, *
·¹num
)

1345 *
p
;

1347 ià((
p
 = 
	`¡¼chr
 (
·th
, ':')è=ğ
NULL
) {

1348  (
FALSE
);

1350  ((*
·¹num
 = 
	`©oi
(
p
 + 1)) != 0);

1351 
	}
}

1353 
gboŞ—n


1354 
	$dos_to_dev
(*
·th
, **
dev·th
, *
·¹num
)

1356 *
p
;

1358 ià((
p
 = 
	`¡¼chr
 (
·th
, ':')è=ğ
NULL
) {

1359  (
FALSE
);

1361 ià((*
·¹num
 = 
	`©oi
(
p
 + 1)) == 0) {

1362  (
FALSE
);

1364 
p
[0] = '\0';

1365 *
dev·th
 = 
	`¡rdup
(
·th
);

1366 
p
[0] = ':';

1367  (*
dev·th
 !ğ
NULL
);

1368 
	}
}

1371 
	$devšfo_¡Üage_ş—nup_mouÁpošt_cb
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
,

1372 
gšt
 
»tuº_code
, 
gch¬
 **
”rÜ
,

1373 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

1375 *
mouÁ_pošt
 = (*è
d©a1
;

1377 
	`HAL_INFO
 (("CËªed u°mouÁ…ošˆ'%s'", 
mouÁ_pošt
));

1378 
	`g_ä“
 (
mouÁ_pošt
);

1379 
	}
}

1383 
	$devšfo_¡Üage_mÁb_ev’t
 (
H®Deviû
 *
h®_vŞume
)

1385 
FILE
 *
å
 = 
NULL
;

1386 
extmÁb
 
m
;

1387 
H®Deviû
 *
d
;

1388 
majÜ
;

1389 
mšÜ
;

1390 
GSLi¡
 *
vŞumes
 = 
NULL
;

1391 
GSLi¡
 *
v
;

1392 *
mouÁ_pošt
;

1393 
dbus_boŞ_t
 
is_·¹™iÚ
;

1394 cÚ¡ *
f¡y³
;

1395 
·¹™iÚ_numb”
;

1397 ià(
h®_vŞume
 !ğ
NULL
) {

1398 
vŞumes
 = 
	`g_¦i¡_­³nd
 (
NULL
, 
h®_vŞume
);

1400 
vŞumes
 = 
	`h®_deviû_¡Üe_m©ch_muÉË_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "info.category", "volume");

1402 ià(
vŞumes
 =ğ
NULL
) {

1406 ià((
å
 = 
	`fİ’
(
MNTTAB
, "r")è=ğ
NULL
) {

1407 
	`HAL_ERROR
 (("O³Àçed % ”ºØ%d", 
MNTTAB
, 
”ºo
));

1411 
	`g‘extmÁ’t
(
å
, &
m
, 1) == 0) {

1412 
v
 = 
vŞumes
; v !ğ
NULL
; v = 
	`g_¦i¡_Ãxt
 (v)) {

1413 
d
 = 
	`HAL_DEVICE
 (
v
->
d©a
);

1414 
majÜ
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "block.major");

1415 
mšÜ
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "block.minor");

1421 
is_·¹™iÚ
 = 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "volume.is_partition");

1422 
·¹™iÚ_numb”
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "volume.partition.number");

1423 
f¡y³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "volume.fstype");

1425 ià(
is_·¹™iÚ
 && (
·¹™iÚ_numb”
 > 0è&& (
	`¡rcmp
 (
f¡y³
, "pcfs") == 0)) {

1426 
mšÜ
 |ğ
·¹™iÚ_numb”
 << 12;

1429 ià(
m
.
mÁ_majÜ
 !ğ
majÜ
 || m.
mÁ_mšÜ
 !ğ
mšÜ
) {

1434 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

1435 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.is_mouÁed", 
TRUE
);

1436 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "volume.is_mounted_read_only",

1437 
	`hasmÁİt
 ((
mÁb
 *)&
m
, "ro"è? 
TRUE
 : 
FALSE
);

1438 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "vŞume.mouÁ_pošt", 
m
.
mÁ_mouÁp
);

1439 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

1441 
	`HAL_INFO
 (("set %so be mounted‡t %s",

1442 
	`h®_deviû_g‘_udi
 (
d
), 
m
.
mÁ_mouÁp
));

1443 
vŞumes
 = 
	`g_¦i¡_d–‘e_lšk
 (vŞumes, 
v
);

1448 
v
 = 
vŞumes
; v !ğ
NULL
; v = 
	`g_¦i¡_Ãxt
 (v)) {

1449 
d
 = 
	`HAL_DEVICE
 (
v
->
d©a
);

1450 
mouÁ_pošt
 = 
	`g_¡rdup
 (
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "volume.mount_point"));

1451 ià(
mouÁ_pošt
 =ğ
NULL
 || 
	`¡¾’
 (mount_point) == 0) {

1452 
	`g_ä“
 (
mouÁ_pošt
);

1456 
	`deviû_´İ”ty_©omic_upd©e_begš
 ();

1457 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.is_mouÁed", 
FALSE
);

1458 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, "vŞume.is_mouÁed_»ad_Úly", 
FALSE
);

1459 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "volume.mount_point", "");

1460 
	`deviû_´İ”ty_©omic_upd©e_’d
 ();

1462 
	`HAL_INFO
 (("£ˆ% tØunmouÁed", 
	`h®_deviû_g‘_udi
 (
d
)));

1465 ià(
	`h®_ut_is_mouÁed_by_h®d
 (
mouÁ_pošt
)) {

1466 *
ş—nup_¡dš
;

1467 *
exŒa_’v
[2];

1469 
	`HAL_INFO
 (("CËªšg u°'%s'", 
mouÁ_pošt
));

1471 
exŒa_’v
[0] = 
	`g_¡rdup_´štf
 ("HALD_CLEANUP=%s", 
mouÁ_pošt
);

1472 
exŒa_’v
[1] = 
NULL
;

1473 
ş—nup_¡dš
 = "\n";

1475 
	`h®d_ruÂ”_run_m‘hod
 (
d
,

1477 
exŒa_’v
,

1478 
ş—nup_¡dš
, 
TRUE
,

1480 
devšfo_¡Üage_ş—nup_mouÁpošt_cb
,

1481 
	`g_¡rdup
 (
mouÁ_pošt
), 
NULL
);

1483 
	`g_ä“
 (
exŒa_’v
[0]);

1486 
	`g_ä“
 (
mouÁ_pošt
);

1488 
	`g_¦i¡_ä“
 (
vŞumes
);

1490 (è
	`fşo£
 (
å
);

1491 
	}
}

1494 
	$devšfo_vŞume_fÜû_unmouÁ_cb
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
,

1495 
gšt
 
»tuº_code
, 
gch¬
 **
”rÜ
,

1496 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

1498 *
’d_tok’
 = (*è
d©a1
;

1500 
	`HAL_INFO
 (("devšfo_vŞume_fÜû_unmouÁ_cb fÜ udi='%s',ƒx™_ty³=%d,„‘uº_code=%d", 
	`h®_deviû_g‘_udi
 (
d
), 
ex™_ty³
, 
»tuº_code
));

1502 ià(
ex™_ty³
 =ğ
HALD_RUN_SUCCESS
 && 
”rÜ
 !ğ
NULL
 &&

1503 
”rÜ
[0] !ğ
NULL
 &&ƒrror[1] != NULL) {

1504 *
exp_Çme
 = 
NULL
;

1505 *
exp_d‘a
 = 
NULL
;

1507 
exp_Çme
 = 
”rÜ
[0];

1508 ià(
”rÜ
[0] !ğ
NULL
) {

1509 
exp_d‘a
 = 
”rÜ
[1];

1511 
	`HAL_INFO
 (("çed w™h '%s' '%s'", 
exp_Çme
, 
exp_d‘a
));

1514 
	`h®_ut_ÿÎout_deviû_»move
 (
d
, 
devšfo_ÿÎouts_»move_dÚe
, 
’d_tok’
, 
NULL
);

1515 
	}
}

1518 
	$devšfo_vŞume_fÜû_unmouÁ
 (
H®Deviû
 *
d
, *
’d_tok’
)

1520 cÚ¡ *
deviû_fe
;

1521 cÚ¡ *
mouÁ_pošt
;

1522 *
unmouÁ_¡dš
;

1523 *
exŒa_’v
[2];

1524 
exŒa_’v
[0] = "HAL_METHOD_INVOKED_BY_UID=0";

1525 
exŒa_’v
[1] = 
NULL
;

1527 
deviû_fe
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "block.device");

1528 
mouÁ_pošt
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "volume.mount_point");

1530 ià(
mouÁ_pošt
 =ğ
NULL
 || 
	`¡¾’
 (mouÁ_poštè=ğ0 || !
	`h®_ut_is_mouÁed_by_h®d
 (mount_point)) {

1531 
	`h®_ut_ÿÎout_deviû_»move
 (
d
, 
devšfo_ÿÎouts_»move_dÚe
, 
’d_tok’
, 
NULL
);

1535 
	`HAL_INFO
 (("devšfo_vŞume_fÜû_unmouÁ fÜ udi='%s'", 
	`h®_deviû_g‘_udi
 (
d
)));

1537 
unmouÁ_¡dš
 = "\n";

1539 
	`h®d_ruÂ”_run_m‘hod
 (
d
,

1541 
exŒa_’v
,

1542 
unmouÁ_¡dš
, 
TRUE
,

1544 
devšfo_vŞume_fÜû_unmouÁ_cb
,

1545 
’d_tok’
, 
NULL
);

1546 
	}
}

1549 
	$devšfo_vŞume_hÙ¶ug_begš_»move
 (
H®Deviû
 *
d
, *
devfs_·th
, *
’d_tok’
)

1551 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "volume.is_mounted")) {

1552 
	`devšfo_vŞume_fÜû_unmouÁ
 (
d
, 
’d_tok’
);

1554 
	`h®_ut_ÿÎout_deviû_»move
 (
d
, 
devšfo_ÿÎouts_»move_dÚe
, 
’d_tok’
, 
NULL
);

1556 
	}
}

1560 
	mLEGACY_CDROM
,

1561 
	mLEGACY_FLOPPY
,

1562 
	mLEGACY_RMDISK


1565 cÚ¡ *
	gËgacy_medŸ_¡r
[] = {

1571 
	s’um_nick
 {

1572 cÚ¡ *
	mty³
;

1573 
GSLi¡
 *
	mnums
;

1577 
	$devšfo_¡Üage_g‘_Ëgacy_medŸ
(
H®Deviû
 *
d
)

1579 cÚ¡ *
drive_ty³
;

1581 ià(
	`h®_deviû_has_ÿ·b™y
 (
d
, "storage.cdrom")) {

1582  (
LEGACY_CDROM
);

1583 } ià(((
drive_ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
,

1584 "¡Üage.drive_ty³")è!ğ
NULL
è&& (
	`¡rcmp
 (
drive_ty³
, "floppy") == 0)) {

1585  (
LEGACY_FLOPPY
);

1586 } ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "storage.removable") ||

1587 
	`h®_deviû_´İ”ty_g‘_boŞ
 (
d
, "storage.hotpluggable")) {

1588  (
LEGACY_RMDISK
);

1592 
	}
}

1594 
gboŞ—n


1595 
	$devšfo_¡Üage_fÜ—ch_nick
 (
H®DeviûStÜe
 *
¡Üe
, 
H®Deviû
 *
d
, 
gpoš‹r
 
u£r_d©a
)

1597 
’um_nick
 *
’
 = (’um_nick *è
u£r_d©a
;

1598 cÚ¡ *
medŸ_ty³
;

1599 
medŸ_num
;

1601 
medŸ_ty³
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "storage.solaris.legacy.media_type");

1602 
medŸ_num
 = 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "storage.solaris.legacy.media_num");

1603 ià((
medŸ_ty³
 !ğ
NULL
è&& (
	`¡rcmp
 (medŸ_ty³, 
’
->
ty³
) == 0) &&

1604 (
medŸ_num
 >= 0)) {

1605 
’
->
nums
 = 
	`g_¦i¡_´•’d
 (’->nums, 
	`GINT_TO_POINTER
(
medŸ_num
));

1607  
TRUE
;

1608 
	}
}

1611 
	$devšfo_¡Üage_­³nd_nickÇme
 (
H®Deviû
 *
d
, cÚ¡ *
medŸ_ty³
, 
medŸ_num
)

1613 
buf
[64];

1615 ià(
medŸ_num
 == 0) {

1616 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
d
, "¡Üage.sŞ¬is.nickÇmes", 
medŸ_ty³
, 
FALSE
);

1618 
	`¢´štf
(
buf
,  (buf), "%s%d", 
medŸ_ty³
, 
medŸ_num
);

1619 
	`h®_deviû_´İ”ty_¡¾i¡_­³nd
 (
d
, "¡Üage.sŞ¬is.nickÇmes", 
buf
, 
FALSE
);

1620 
	}
}

1623 
	$devšfo_¡Üage_£t_nickÇmes
 (
H®Deviû
 *
d
)

1625 
medŸ
;

1626 cÚ¡ *
medŸ_ty³
;

1627 
medŸ_num
;

1628 
GSLi¡
 *
i
;

1629 
’um_nick
 
’
;

1630 
buf
[64];

1632 ià((
medŸ
 = 
	`devšfo_¡Üage_g‘_Ëgacy_medŸ
 (
d
)) < 0) {

1635 
medŸ_ty³
 = 
Ëgacy_medŸ_¡r
[
medŸ
];

1638 
’
.
ty³
 = 
medŸ_ty³
;

1639 
’
.
nums
 = 
NULL
;

1640 
	`h®_deviû_¡Üe_fÜ—ch
 (
	`h®d_g‘_gdl
 (), 
devšfo_¡Üage_fÜ—ch_nick
, &
’
);

1643 
medŸ_num
 = 0; ; media_num++) {

1644 
i
 = 
’
.
nums
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

1645 ià(
	`GPOINTER_TO_INT
 (
i
->
d©a
è=ğ
medŸ_num
) {

1649 ià(
i
 =ğ
NULL
) {

1653 
	`g_¦i¡_ä“
 (
’
.
nums
);

1655 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.sŞ¬is.Ëgacy.medŸ_ty³", 
medŸ_ty³
);

1656 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "¡Üage.sŞ¬is.Ëgacy.medŸ_num", 
medŸ_num
);

1659 
	`¢´štf
(
buf
,  (buf), "%s%d", 
medŸ_ty³
, 
medŸ_num
);

1660 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "¡Üage.sŞ¬is.Ëgacy.symdev", 
buf
);

1661 
	`devšfo_¡Üage_­³nd_nickÇme
(
d
, 
medŸ_ty³
, 
medŸ_num
);

1664 ià(
medŸ
 =ğ
LEGACY_CDROM
) {

1665 
	`devšfo_¡Üage_­³nd_nickÇme
(
d
, "cd", 
medŸ_num
);

1666 
	`devšfo_¡Üage_­³nd_nickÇme
(
d
, "¤", 
medŸ_num
);

1667 } ià(
medŸ
 =ğ
LEGACY_FLOPPY
) {

1668 
	`devšfo_¡Üage_­³nd_nickÇme
(
d
, "fd", 
medŸ_num
);

1669 
	`devšfo_¡Üage_­³nd_nickÇme
(
d
, "disk‘‹", 
medŸ_num
);

1670 
	`devšfo_¡Üage_­³nd_nickÇme
(
d
, "rdisk‘‹", 
medŸ_num
);

1672 
	}
}

	@hald/solaris/devinfo_storage.h

12 #´agm¨
id’t
 "@(#)devinfo_storage.h 1.2 06/10/13 SMI"

14 #iâdeà
DEVINFO_STORAGE_H


15 
	#DEVINFO_STORAGE_H


	)

17 
	~"devšfo.h
"

19 
DevšfoDevHªdËr
 
devšfo_ide_hªdËr
;

20 
DevšfoDevHªdËr
 
devšfo_scsi_hªdËr
;

21 
DevšfoDevHªdËr
 
devšfo_æİpy_hªdËr
;

22 
DevšfoDevHªdËr
 
devšfo_lofi_hªdËr
;

24 
gboŞ—n
 
devšfo_¡Üage_deviû_»sÿn
 (
H®Deviû
 *
d
);

25 
H®Deviû
 *
devšfo_lofi_add_majÜ
(H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
,

26 *
deviû_ty³
, 
gboŞ—n
 
»sÿn
, 
H®Deviû
 *
lofi_d
);

27 
devšfo_lofi_»move_mšÜ
(*
·»Á_devfs_·th
, *
Çme
);

28 
devšfo_¡Üage_mÁb_ev’t
 (
H®Deviû
 *
h®_vŞume
);

29 
devšfo_vŞume_hÙ¶ug_begš_»move
 (
H®Deviû
 *
d
, *
devfs_·th
, *
’d_tok’
);

	@hald/solaris/devinfo_usb.c

12 #´agm¨
id’t
 "@(#)devinfo_usb.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<¡dio.h
>

19 
	~<¡ršg.h
>

20 
	~<libdevšfo.h
>

21 
	~<sys/ty³s.h
>

22 
	~<sys/mkdev.h
>

23 
	~<sys/¡©.h
>

25 
	~"../os¥ec.h
"

26 
	~"../logg”.h
"

27 
	~"../h®d.h
"

28 
	~"../h®d_dbus.h
"

29 
	~"../deviû_šfo.h
"

30 
	~"../ut.h
"

31 
	~"../ids.h
"

32 
	~"hÙ¶ug.h
"

33 
	~"devšfo.h
"

34 
	~"devšfo_usb.h
"

36 
H®Deviû
 *
devšfo_usb_add
(H®Deviû *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
);

37 
H®Deviû
 *
devšfo_usb_if_add
(H®Deviû *
d
, 
di_node_t
 
node
, 
gch¬
 *
devfs_·th
, 
iâum
);

38 
H®Deviû
 *
devšfo_usb_sc§2usb_add
(H®Deviû *
d
, 
di_node_t
 
node
, 
gch¬
 *
devfs_·th
);

40 
DevšfoDevHªdËr
 
	gdevšfo_usb_hªdËr
 = {

41 
devšfo_usb_add
,

42 
NULL
,

43 
NULL
,

44 
NULL
,

45 
NULL
,

46 
NULL


49 
H®Deviû
 *

50 
	$devšfo_usb_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, *
devfs_·th
, *
deviû_ty³
)

52 
H®Deviû
 *
d
, *
nd
 = 
NULL
;

53 *
s
;

54 *
i
, *
vid
;

55 *
driv”_Çme
, *
bšdšg_Çme
;

56 
if_devfs_·th
[
HAL_PATH_MAX
];

62 ià(
	`di_´İ_lookup_šts
(
DDI_DEV_T_ANY
, 
node
, "usb-v’dÜ-id", &
vid
) <= 0) {

63  (
NULL
);

66 
d
 = 
	`h®_deviû_Ãw
 ();

68 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

69 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.subsystem", "usb_device");

70 
	`PROP_STR
(
d
, 
node
, 
s
, "usb-product-name", "info.product");

71 
	`PROP_STR
(
d
, 
node
, 
s
, "usb-product-name", "usb_device.product");

72 
	`PROP_STR
(
d
, 
node
, 
s
, "usb-vendor-name", "usb_device.vendor");

73 
	`PROP_INT
(
d
, 
node
, 
i
, "usb-vendor-id", "usb_device.vendor_id");

74 
	`PROP_INT
(
d
, 
node
, 
i
, "usb-product-id", "usb_device.product_id");

75 
	`PROP_INT
(
d
, 
node
, 
i
, "usb-revision-id", "usb_device.device_revision_bcd");

76 
	`PROP_INT
(
d
, 
node
, 
i
, "usb-release-id", "usb_device.version_bcd");

77 
	`PROP_STR
(
d
, 
node
, 
s
, "usb-serialno", "usb_device.serial");

83 ià(((
bšdšg_Çme
 = 
	`di_bšdšg_Çme
(
node
)è!ğ
NULL
) &&

84 (
	`¡ºcmp
(
bšdšg_Çme
, "usbif,",  ("usbif,") - 1) == 0)) {

85 
	`¢´štf
(
if_devfs_·th
,  (if_devfs_·th), "%s:if%d", 
devfs_·th
, 0);

86 ià((
nd
 = 
	`devšfo_usb_if_add
(
d
, 
node
, 
if_devfs_·th
, 0)è!ğ
NULL
) {

87 
d
 = 
nd
;

88 
nd
 = 
NULL
;

89 
devfs_·th
 = 
if_devfs_·th
;

94 
driv”_Çme
 = 
	`di_driv”_Çme
 (
node
);

95 ià((
driv”_Çme
 !ğ
NULL
è&& (
	`¡rcmp
 (driver_name, "scsa2usb") == 0)) {

96 
nd
 = 
	`devšfo_usb_sc§2usb_add
 (
d
, 
node
, 
devfs_·th
);

98 
	`devšfo_add_’queue
 (
d
, 
devfs_·th
, &
devšfo_usb_hªdËr
);

101 
out
:

102 ià(
nd
 !ğ
NULL
) {

103  (
nd
);

105  (
d
);

107 
	}
}

109 
H®Deviû
 *

110 
	$devšfo_usb_if_add
(
H®Deviû
 *
·»Á
, 
di_node_t
 
node
, 
gch¬
 *
devfs_·th
, 
iâum
)

112 
H®Deviû
 *
d
 = 
NULL
;

113 
udi
[
HAL_PATH_MAX
];

115 
	`devšfo_add_’queue
 (
·»Á
, 
devfs_·th
, &
devšfo_usb_hªdËr
);

117 
d
 = 
	`h®_deviû_Ãw
 ();

119 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
·»Á
, 
node
, 
devfs_·th
);

120 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.subsystem", "usb");

122 
	`h®d_compu‹_udi
 (
udi
,  (udi),

123 "%s_if%d", 
	`h®_deviû_g‘_udi
 (
·»Á
), 
iâum
);

124 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

125 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "USB Device Interface");

128 
	`h®_deviû_m”ge_w™h_»wr™e
 (
d
, 
·»Á
, "usb.", "usb_device.");

130  (
d
);

131 
	}
}

134 
	$w®k_devlšks
(
di_devlšk_t
 
devlšk
, *
¬g
)

136 **
·th
 = (**)
¬g
;

138 *
·th
 = 
	`¡rdup
(
	`di_devlšk_·th
(
devlšk
));

140  (
DI_WALK_TERMINATE
);

141 
	}
}

144 
	$g‘_devlšk
(
di_devlšk_hªdË_t
 
devlšk_hdl
, *
·th
)

146 *
devlšk
 = 
NULL
;

148 (è
	`di_devlšk_w®k
(
devlšk_hdl
, 
NULL
, 
·th
,

149 
DI_PRIMARY_LINK
, &
devlšk
, 
w®k_devlšks
);

151  (
devlšk
);

152 
	}
}

154 
H®Deviû
 *

155 
	$devšfo_usb_sc§2usb_add
(
H®Deviû
 *
usbd
, 
di_node_t
 
node
, 
gch¬
 *
devfs_·th
)

157 
H®Deviû
 *
d
 = 
NULL
;

158 
di_devlšk_hªdË_t
 
devlšk_hdl
;

159 
majÜ
;

160 
di_mšÜ_t
 
mšÜ
;

161 
dev_t
 
devt
;

162 *
mšÜ_·th
 = 
NULL
;

163 *
devlšk
 = 
NULL
;

164 
udi
[
HAL_PATH_MAX
];

166 
	`devšfo_add_’queue
 (
usbd
, 
devfs_·th
, &
devšfo_usb_hªdËr
);

168 ià((
devlšk_hdl
 = 
	`di_devlšk_š™
(
NULL
, 0)) == NULL) {

169 
	`´štf
("di_devlink_init() failed\n");

170  (
NULL
);

173 
majÜ
 = 
	`di_driv”_majÜ
(
node
);

174 
mšÜ
 = 
DI_MINOR_NIL
;

175 (
mšÜ
 = 
	`di_mšÜ_Ãxt
(
node
, mšÜ)è!ğ
DI_MINOR_NIL
) {

176 
devt
 = 
	`di_mšÜ_devt
(
mšÜ
);

177 ià(
majÜ
 !ğ
	`majÜ
(
devt
)) {

180 ià((
mšÜ_·th
 = 
	`di_devfs_mšÜ_·th
(
mšÜ
)è=ğ
NULL
) {

183 ià(
	`di_mšÜ_ty³
(
mšÜ
è!ğ
DDM_MINOR
) {

186 ià(
	`¡rcmp
 (
	`di_mšÜ_nod‘y³
(
mšÜ
),

188 
devlšk
 = 
	`g‘_devlšk
(
devlšk_hdl
, 
mšÜ_·th
);

189 ià(
devlšk
 =ğ
NULL
) {

190 
devlšk
 = 
	`¡rdup
("");

194 
	`di_devfs_·th_ä“
 (
mšÜ_·th
);

195 
mšÜ_·th
 = 
NULL
;

198 
	`di_devlšk_fši
 (&
devlšk_hdl
);

200 ià(
devlšk
 =ğ
NULL
) {

201 
out
;

204 
d
 = 
	`h®_deviû_Ãw
 ();

206 
	`devšfo_£t_deçuÉ_´İ”t›s
 (
d
, 
usbd
, 
node
, 
mšÜ_·th
);

207 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "scsi_ho¡.sŞ¬is.deviû", 
devlšk
);

208 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.category", "scsi_host");

209 
	`h®_deviû_´İ”ty_£t_št
 (
d
, "scsi_host.host", 0);

211 
	`h®d_compu‹_udi
 (
	`h®d_g‘_gdl
 (), 
udi
,  (udi),

212 "%s/scsi_ho¡%d", 
	`h®_deviû_g‘_udi
 (
usbd
),

213 
	`h®_deviû_´İ”ty_g‘_št
 (
d
, "scsi_host.host"));

214 
	`h®_deviû_£t_udi
 (
d
, 
udi
);

215 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, "info.product", "SCSI Host Adapter");

217 
	`devšfo_add_’queue
 (
d
, 
mšÜ_·th
, &
devšfo_usb_hªdËr
);

219 
out
:

220 ià(
devlšk
) {

221 
	`ä“
(
devlšk
);

223 ià(
mšÜ_·th
) {

224 
	`di_devfs_·th_ä“
 (
mšÜ_·th
);

227  (
d
);

228 
	}
}

	@hald/solaris/devinfo_usb.h

12 #´agm¨
id’t
 "@(#)devinfo_usb.h 1.2 06/10/13 SMI"

14 #iâdeà
DEVINFO_USB_H


15 
	#DEVINFO_USB_H


	)

17 
	~"devšfo.h
"

19 
DevšfoDevHªdËr
 
devšfo_usb_hªdËr
;

	@hald/solaris/hotplug.c

12 #´agm¨
id’t
 "@(#)hotplug.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<¡dio.h
>

19 
	~<¡ršg.h
>

20 
	~<”ºo.h
>

21 
	~<sys/ty³s.h
>

22 
	~<sys/¡©.h
>

23 
	~<sys/un.h
>

24 
	~<sys/ut¢ame.h
>

25 
	~<uni¡d.h
>

27 
	~<glib.h
>

28 
	~<dbus/dbus.h
>

29 
	~<dbus/dbus-glib.h
>

31 
	~"../os¥ec.h
"

32 
	~"../logg”.h
"

33 
	~"../h®d.h
"

34 
	~"../deviû_šfo.h
"

36 
	~"os¥ec_sŞ¬is.h
"

37 
	~"hÙ¶ug.h
"

38 
	~"devšfo.h
"

41 
GQueue
 *
	ghÙ¶ug_ev’t_queue
;

44 
GSLi¡
 *
	ghÙ¶ug_ev’ts_š_´og»ss
 = 
NULL
;

46 
hÙ¶ug_ev’t_begš
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
);

49 
	$hÙ¶ug_ev’t_’d
 (*
’d_tok’
)

51 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
 = (HÙ¶ugEv’ˆ*è
’d_tok’
;

53 
hÙ¶ug_ev’ts_š_´og»ss
 = 
	`g_¦i¡_»move
 (hÙ¶ug_ev’ts_š_´og»ss, 
hÙ¶ug_ev’t
);

54 
	`g_ä“
 (
hÙ¶ug_ev’t
);

55 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

56 
	}
}

59 
	$hÙ¶ug_ev’t_begš_devfs_add
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
, 
H®Deviû
 *
d
)

61 
H®Deviû
 *
·»Á
;

62 cÚ¡ 
gch¬
 *
·»Á_udi
;

63 (*
begš_add_func
è(
H®Deviû
 *, H®Deviû *, 
DevšfoDevHªdËr
 *, *);

65 ià(
d
 !ğ
NULL
) {

67 
	`HAL_ERROR
 (("dev·th % ®»ady…»£Á iÀ¡Üe, ignÜev’t", 
hÙ¶ug_ev’t
->
un
.
devfs
.
devfs_·th
));

68 
	`hÙ¶ug_ev’t_’d
 ((*è
hÙ¶ug_ev’t
);

73 
·»Á_udi
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
hÙ¶ug_ev’t
->
d
, "info.parent");

74 ià(
·»Á_udi
 =ğ
NULL
 || 
	`¡¾’
(parent_udi) == 0) {

75 
·»Á
 = 
NULL
;

77 
·»Á
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (), "šfo.udi", 
·»Á_udi
);

80 ià(
·»Á
 =ğ
NULL
) {

81 ià(
	`¡rcmp
(
hÙ¶ug_ev’t
->
un
.
devfs
.
devfs_·th
, "/") != 0) {

82 
	`HAL_ERROR
 (("P¬’ˆi NULL devfs_·th=% ·»Á_udi=%s", 
hÙ¶ug_ev’t
->
un
.
devfs
.
devfs_·th
, 
·»Á_udi
 ?…arent_udi : "<null>"));

83 
	`hÙ¶ug_ev’t_’d
 ((*è
hÙ¶ug_ev’t
);

89 ià(
	`h®_deviû_´İ”ty_g‘_boŞ
 (
·»Á
, "info.ignore")) {

90 
	`HAL_INFO
 (("·»Á ignÜed %s", 
·»Á_udi
));

91 
	`hÙ¶ug_ev’t_’d
 ((*è
hÙ¶ug_ev’t
);

96 
begš_add_func
 = 
hÙ¶ug_ev’t
->
un
.
devfs
.
hªdËr
->
hÙ¶ug_begš_add
;

97 ià(
begš_add_func
 =ğ
NULL
) {

98 
begš_add_func
 = 
hÙ¶ug_ev’t_begš_add_devšfo
;

100 
	`begš_add_func
 (
hÙ¶ug_ev’t
->
d
,

101 
·»Á
,

102 
hÙ¶ug_ev’t
->
un
.
devfs
.
hªdËr
,

103 (*è
hÙ¶ug_ev’t
);

104 
	}
}

107 
	$hÙ¶ug_ev’t_begš_devfs_»move
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
, 
H®Deviû
 *
d
)

109 ià(
d
 =ğ
NULL
) {

110 
	`HAL_ERROR
 (("dev·th % nÙ…»£Á iÀ¡Üe, ignÜev’t", 
hÙ¶ug_ev’t
->
un
.
devfs
.
devfs_·th
));

111 
	`hÙ¶ug_ev’t_’d
 ((*è
hÙ¶ug_ev’t
);

114 
	`HAL_INFO
 (("hÙ¶ug_ev’t_begš_devfs_»mov%s", 
	`h®_deviû_g‘_udi
 (
d
)));

116 
	`hÙ¶ug_ev’t_begš_»move_devšfo
(
d
,

117 
hÙ¶ug_ev’t
->
un
.
devfs
.
devfs_·th
,

118 (*è
hÙ¶ug_ev’t
);

119 
	}
}

122 
	$hÙ¶ug_ev’t_begš_devfs
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
)

124 
H®Deviû
 *
d
;

126 
	`HAL_INFO
 (("hÙ¶ug_ev’t_begš_devfs: %s", 
hÙ¶ug_ev’t
->
un
.
devfs
.
devfs_·th
));

127 
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

129 
hÙ¶ug_ev’t
->
un
.
devfs
.
devfs_·th
);

131 ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_ADD
) {

132 
	`hÙ¶ug_ev’t_begš_devfs_add
 (
hÙ¶ug_ev’t
, 
d
);

133 } ià(
hÙ¶ug_ev’t
->
aùiÚ
 =ğ
HOTPLUG_ACTION_REMOVE
) {

134 
	`hÙ¶ug_ev’t_begš_devfs_»move
 (
hÙ¶ug_ev’t
, 
d
);

136 
	`hÙ¶ug_ev’t_’d
 ((*è
hÙ¶ug_ev’t
);

138 
	}
}

141 
	$hÙ¶ug_ev’t_begš
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
)

143 
hÙ¶ug_ev’t
->
ty³
) {

145 
HOTPLUG_EVENT_DEVFS
:

146 
	`hÙ¶ug_ev’t_begš_devfs
 (
hÙ¶ug_ev’t
);

150 
	`HAL_ERROR
 (("UnknowÀhÙ¶ugƒv’ˆty³ %d", 
hÙ¶ug_ev’t
->
ty³
));

151 
	`hÙ¶ug_ev’t_’d
 ((*è
hÙ¶ug_ev’t
);

154 
	}
}

157 
	$hÙ¶ug_ev’t_’queue
 (
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
, 
äÚt
)

159 ià(
hÙ¶ug_ev’t_queue
 =ğ
NULL
)

160 
hÙ¶ug_ev’t_queue
 = 
	`g_queue_Ãw
 ();

162 ià(
äÚt
) {

163 
	`g_queue_push_h—d
 (
hÙ¶ug_ev’t_queue
, 
hÙ¶ug_ev’t
);

165 
	`g_queue_push_
 (
hÙ¶ug_ev’t_queue
, 
hÙ¶ug_ev’t
);

167 
	}
}

170 
	$hÙ¶ug_ev’t_´oûss_queue
 ()

172 
HÙ¶ugEv’t
 *
hÙ¶ug_ev’t
;

174 ià(
hÙ¶ug_ev’ts_š_´og»ss
 =ğ
NULL
 &&

175 (
hÙ¶ug_ev’t_queue
 =ğ
NULL
 || 
	`g_queue_is_em±y
 (hotplug_event_queue))) {

176 
	`hÙ¶ug_queue_now_em±y
 ();

177 
out
;

181 ià(
hÙ¶ug_ev’ts_š_´og»ss
 !ğ
NULL
 && 
	`g_¦i¡_Ëngth
 (hotplug_events_in_progress) > 0)

182 
out
;

184 
hÙ¶ug_ev’t
 = 
	`g_queue_pİ_h—d
 (
hÙ¶ug_ev’t_queue
);

185 ià(
hÙ¶ug_ev’t
 =ğ
NULL
)

186 
out
;

188 
hÙ¶ug_ev’ts_š_´og»ss
 = 
	`g_¦i¡_­³nd
 (hÙ¶ug_ev’ts_š_´og»ss, 
hÙ¶ug_ev’t
);

189 
	`hÙ¶ug_ev’t_begš
 (
hÙ¶ug_ev’t
);

191 
out
:

193 
	}
}

	@hald/solaris/hotplug.h

12 #´agm¨
id’t
 "@(#)hotplug.h 1.2 06/10/13 SMI"

14 #iâdeà
HOTPLUG_H


15 
	#HOTPLUG_H


	)

17 
	~<glib.h
>

19 
	~"../deviû.h
"

20 
	~"../ut.h
"

22 
	~"devšfo.h
"

25 
	mHOTPLUG_ACTION_ADD
,

26 
	mHOTPLUG_ACTION_REMOVE
,

27 } 
	tHÙ¶ugAùiÚTy³
;

30 
	mHOTPLUG_EVENT_DEVFS
 = 0,

31 } 
	tHÙ¶ugEv’tTy³
;

38 
HÙ¶ugAùiÚTy³
 
	maùiÚ
;

39 
HÙ¶ugEv’tTy³
 
	mty³
;

41 
H®Deviû
 *
	md
;

45 
	mdevfs_·th
[
HAL_PATH_MAX
];

46 
DevšfoDevHªdËr
 *
	mhªdËr
;

47 } 
	mdevfs
;

48 } 
	mun
;

50 } 
	tHÙ¶ugEv’t
;

52 
hÙ¶ug_ev’t_’queue
 (
HÙ¶ugEv’t
 *
ev’t
, 
äÚt
);

54 
hÙ¶ug_ev’t_´oûss_queue
 ();

56 
hÙ¶ug_ev’t_’d
 (*
’d_tok’
);

58 
hÙ¶ug_queue_now_em±y
 ();

	@hald/solaris/osspec.c

12 #´agm¨
id’t
 "@(#)osspec.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<¡dio.h
>

19 
	~<uni¡d.h
>

20 
	~<¡ršgs.h
>

21 
	~<pÜt.h
>

22 
	~<sys/¡©.h
>

23 
	~<fú.h
>

24 
	~<sys/ty³s.h
>

25 
	~<sys/mÁ’t.h
>

26 
	~<sys/mÁb.h
>

28 
	~"../os¥ec.h
"

29 
	~"../logg”.h
"

30 
	~"../h®d.h
"

31 
	~"../h®d_dbus.h
"

32 
	~"../deviû_šfo.h
"

33 
	~"../ut.h
"

34 
	~"../ids.h
"

35 
	~"os¥ec_sŞ¬is.h
"

36 
	~"hÙ¶ug.h
"

37 
	~"sy£v’t.h
"

38 
	~"devšfo.h
"

39 
	~"devšfo_¡Üage.h
"

41 
mÁb_ev’t_š™
 ();

42 
gboŞ—n
 
mÁb_ev’t
 (
GIOChªÃl
 *
chªÃl
, 
GIOCÚd™iÚ
 
cÚd
, 
gpoš‹r
 
u£r_d©a
);

44 
H®FeMÚ™Ü
 *

45 
	$os¥ec_g‘_fe_mÚ™Ü
 ()

47 #w¬nšg 
PËa£
 
im¶em’t


48  
NULL
;

49 
	}
}

52 
	$os¥ec_š™
 ()

54 
	`ids_š™
 ();

55 
	`sy£v’t_š™
 ();

56 
	`mÁb_ev’t_š™
 ();

57 
	}
}

60 
	$os¥ec_´iveged_š™
 ()

62 
	}
}

65 
	$hÙ¶ug_queue_now_em±y
 ()

67 ià(
h®d_is_š™Ÿlisšg
) {

68 
	`os¥ec_´obe_dÚe
 ();

70 
	}
}

73 
	$os¥ec_´obe
 ()

76 
	`devšfo_add
 (
NULL
, "/");

79 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

80 
	}
}

82 
gboŞ—n


83 
	$os¥ec_deviû_»sÿn
 (
H®Deviû
 *
d
)

85  (
	`devšfo_deviû_»sÿn
 (
d
));

86 
	}
}

88 
gboŞ—n


89 
	$os¥ec_deviû_»´obe
 (
H®Deviû
 *
d
)

91  
FALSE
;

92 
	}
}

94 
DBusHªdËrResuÉ


95 
	$os¥ec_f‹r_funùiÚ
 (
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, *
u£r_d©a
)

97  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

98 
	}
}

108 
H®Deviû
 *

109 
	$h®_ut_fšd_şo£¡_ªû¡Ü
 (cÚ¡ 
gch¬
 *
devfs_·th
, gch¬ **
ªû¡Ü_devfs_·th
, gch¬ **
hÙ¶ug_devfs_·th
)

111 
gch¬
 
buf
[512];

112 
gch¬
 
c
;

113 
H®Deviû
 *
·»Á
;

115 
·»Á
 = 
NULL
;

117 
	`¡ºıy
 (
buf
, 
devfs_·th
,  (buf));

119 *
p
;

121 
p
 = 
	`¡¼chr
 (
buf
, '/');

122 ià(
p
 =ğ
NULL
)

124 
c
 = *
p
;

125 *
p
 = '\0';

127 
·»Á
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

129 
buf
);

130 ià(
·»Á
 !ğ
NULL
) {

131 ià(
ªû¡Ü_devfs_·th
 !ğ
NULL
) {

132 *
ªû¡Ü_devfs_·th
 = 
	`g_¡rdup
 (
buf
);

134 ià(
hÙ¶ug_devfs_·th
 !ğ
NULL
) {

135 *
p
 = 
c
;

136 *
hÙ¶ug_devfs_·th
 = 
	`g_¡rdup
 (
buf
);

141 } 
TRUE
);

143  
·»Á
;

144 
	}
}

147 
	$dsk_to_rdsk
(*
dsk
)

149 
Ën
, 
pos
;

150 *
p
;

151 *
rdsk
;

153 ià((
Ën
 = 
	`¡¾’
 (
dsk
)) <  ("/dev/dsk/cN") - 1) {

154  (
	`¡rdup
(""));

156 ià((
p
 = 
	`¡r¡r
 (
dsk
, "/dsk/")è=ğ
NULL
) {

157 ià((
p
 = 
	`¡r¡r
 (
dsk
, "/lofi/")è=ğ
NULL
) {

158 
p
 = 
	`¡r¡r
 (
dsk
, "/diskette");

161 ià(
p
 =ğ
NULL
) {

162  (
	`¡rdup
(""));

165 
pos
 = (
ušŒ_t
)
p
 - (ušŒ_t)
dsk
;

166 ià((
rdsk
 = (*)
	`ÿÎoc
 (
Ën
 + 2, 1)è!ğ
NULL
) {

167 
	`¡ºıy
 (
rdsk
, 
dsk
, 
pos
 + 1);

168 
rdsk
[
pos
 + 1] = 'r';

169 
	`¡rıy
 (
rdsk
 + 
pos
 + 2, 
dsk
 +…os + 1);

172  (
rdsk
);

173 
	}
}

187 
	gmÁb_fd
;

188 
	gmÁb_pÜt
;

189 
GIOChªÃl
 *
	gmÁb_chªÃl
;

192 
	$mÁb_ev’t_š™
 ()

194 
buf
[81];

196 ià((
mÁb_fd
 = 
	`İ’
 (
MNTTAB
, 
O_RDONLY
)) < 0) {

199 ià((
mÁb_pÜt
 = 
	`pÜt_ü—‹
 ()) < 0) {

200 (è
	`şo£
 (
mÁb_fd
);

203 ià(
	`pÜt_assocŸ‹
 (
mÁb_pÜt
, 
PORT_SOURCE_FD
, 
mÁb_fd
, 
POLLRDBAND
,

204 
NULL
) != 0) {

205 (è
	`şo£
 (
mÁb_pÜt
);

206 (è
	`şo£
 (
mÁb_fd
);

211 (è
	`»ad
(
mÁb_fd
, 
buf
, (
size_t
)( (buf) - 1));

212 (è
	`l£ek
(
mÁb_fd
, 0, 
SEEK_SET
);

214 
mÁb_chªÃl
 = 
	`g_io_chªÃl_unix_Ãw
 (
mÁb_pÜt
);

215 
	`g_io_add_w©ch
 (
mÁb_chªÃl
, 
G_IO_IN
, 
mÁb_ev’t
, 
NULL
);

216 
	}
}

218 
gboŞ—n


219 
	$mÁb_ev’t
 (
GIOChªÃl
 *
chªÃl
, 
GIOCÚd™iÚ
 
cÚd
, 
gpoš‹r
 
u£r_d©a
)

221 
pÜt_ev’t_t
 
³
;

222 
time¥ec_t
 
timeout
;

223 
buf
[81];

228 
	`HAL_INFO
 (("mnttabƒvent"));

231 
timeout
.
tv_£c
 =imeout.
tv_n£c
 = 0;

232 (è
	`pÜt_g‘
(
mÁb_pÜt
, &
³
, &
timeout
);

233 (è
	`pÜt_assocŸ‹
(
mÁb_pÜt
, 
PORT_SOURCE_FD
,

234 
mÁb_fd
, 
POLLRDBAND
, 
NULL
);

236 ià(!
h®d_is_š™Ÿlisšg
) {

237 
	`devšfo_¡Üage_mÁb_ev’t
 (
NULL
);

240 (è
	`l£ek
(
mÁb_fd
, 0, 
SEEK_SET
);

241 (è
	`»ad
(
mÁb_fd
, 
buf
, (
size_t
)( (buf) - 1));

243  
TRUE
;

244 
	}
}

247 
	$os¥ec_»äesh_mouÁ_¡©e_fÜ_block_deviû
 (
H®Deviû
 *
d
)

249 
	`devšfo_¡Üage_mÁb_ev’t
 (
d
);

250 
	}
}

	@hald/solaris/osspec_solaris.h

12 #´agm¨
id’t
 "@(#)osspec_solaris.h 1.2 06/10/13 SMI"

14 #iâdeà
OSSPEC_SOLARIS_H


15 
	#OSSPEC_SOLARIS_H


	)

17 
	~<glib.h
>

19 
hÙ¶ug_queue_now_em±y
 ();

20 
H®Deviû
 *
h®_ut_fšd_şo£¡_ªû¡Ü
 (cÚ¡ 
gch¬
 *
devfs_·th
, gch¬ **
ªû¡Ü_devfs_·th
, gch¬ **
hÙ¶ug_devfs_·th
);

21 *
dsk_to_rdsk
(*);

	@hald/solaris/probing/cdutils.c

12 #´agm¨
id’t
 "@(#)cdutils.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<¡dio.h
>

19 
	~<sys/ty³s.h
>

20 
	~<sys/scsi/im¶/uscsi.h
>

21 
	~<¡ršg.h
>

22 
	~<¡ršgs.h
>

23 
	~<uni¡d.h
>

24 
	~<¡dlib.h
>

25 
	~<”ºo.h
>

26 
	~<fú.h
>

27 
	~<sys/dkio.h
>

28 
	~<libš.h
>

30 
	~<logg”.h
>

32 
	~"cduts.h
"

34 
	#RQLEN
 32

	)

35 
	#SENSE_KEY
(
rqbuf
èÔqbuf[2]è

	)

36 
	#ASC
(
rqbuf
èÔqbuf[12]è

	)

37 
	#ASCQ
(
rqbuf
èÔqbuf[13]è

	)

39 
	#GET16
(
a
è((×)[0] << 8è| (a)[1])

	)

40 
	#GET32
(
a
è((×)[0] << 24è| (×)[1] << 16è| (×)[2] << 8è| (a)[3])

	)

42 
	#CD_USCSI_TIMEOUT
 60

	)

45 
	$uscsi_cmd_š™
(
uscsi_cmd
 *
scmd
, *
cdb
, 
cdbËn
)

47 
	`bz”o
(
scmd
,  (*scmd));

48 
	`bz”o
(
cdb
, 
cdbËn
);

49 
scmd
->
uscsi_cdb
 = 
cdb
;

50 
	}
}

53 
	$uscsi
(
fd
, 
uscsi_cmd
 *
scmd
)

55 
rqbuf
[
RQLEN
];

56 
»t
;

57 
i
, 
»Œ›s
, 
tÙ®_»Œ›s
;

58 
max_»Œ›s
 = 20;

60 
scmd
->
uscsi_æags
 |ğ
USCSI_RQENABLE
;

61 
scmd
->
uscsi_rqËn
 = 
RQLEN
;

62 
scmd
->
uscsi_rqbuf
 = 
rqbuf
;

64 
»Œ›s
 = 0;„‘r› < 
max_»Œ›s
;„etries++) {

65 
scmd
->
uscsi_¡©us
 = 0;

66 
	`mem£t
(
rqbuf
, 0, 
RQLEN
);

68 
»t
 = 
	`ioùl
(
fd
, 
USCSICMD
, 
scmd
);

70 ià((
»t
 =ğ0è&& (
scmd
->
uscsi_¡©us
 == 2)) {

71 
»t
 = -1;

72 
”ºo
 = 
EIO
;

74 ià((
»t
 < 0è&& (
scmd
->
uscsi_¡©us
 == 2)) {

85 ià((
	`SENSE_KEY
(
rqbuf
è=ğ2è&& (
	`ASC
(rqbuf) == 4) &&

86 ((
	`ASCQ
(
rqbuf
) == 0) || (ASCQ(rqbuf) == 1) ||

87 (
	`ASCQ
(
rqbuf
) == 4)) || (ASCQ(rqbuf) == 7)) {

88 
tÙ®_»Œ›s
++;

89 
	`¦“p
(1);

98 ià((
	`SENSE_KEY
(
rqbuf
è=ğ6è&& ((
	`ASC
(rqbuf) == 0x28) ||

99 (
	`ASC
(
rqbuf
) == 0x29))) {

100 
	`¦“p
(1);

101 
tÙ®_»Œ›s
++;

110 ià((
	`SENSE_KEY
(
rqbuf
è=ğ0è&& (
	`ASC
(rqbuf) == 0) &&

111 (
	`ASCQ
(
rqbuf
) == 0)) {

112 
»t
 = 0;

116 
	`HAL_DEBUG
 (("cmd: 0x%02x„et:%i status:%02x "

118 (
uch¬_t
)
scmd
->
uscsi_cdb
[0], 
»t
,

119 
scmd
->
uscsi_¡©us
,

120 (
uch¬_t
)
	`SENSE_KEY
(
rqbuf
),

121 (
uch¬_t
)
	`ASC
(
rqbuf
), (uch¬_t)
	`ASCQ
(rqbuf)));

127 ià(
»Œ›s
) {

128 
	`HAL_DEBUG
 (("tÙ®„‘r›s: %d\n", 
tÙ®_»Œ›s
));

131  (
»t
);

132 
	}
}

135 
	$mode_£n£
(
fd
, 
uch¬_t
 
pc
, 
dbd
, 
·ge_Ën
, uch¬_ˆ*
bufãr
)

137 
uscsi_cmd
 
scmd
;

138 
cdb
[16];

140 
	`uscsi_cmd_š™
(&
scmd
, 
cdb
,  (cdb));

141 
scmd
.
uscsi_æags
 = 
USCSI_READ
|
USCSI_SILENT
;

142 
scmd
.
uscsi_buæ’
 = 
·ge_Ën
;

143 
scmd
.
uscsi_buçddr
 = (*)
bufãr
;

144 
scmd
.
uscsi_timeout
 = 
CD_USCSI_TIMEOUT
;

145 
scmd
.
uscsi_cdbËn
 = 0xa;

146 
scmd
.
uscsi_cdb
[0] = 0x5a;

147 ià(
dbd
) {

148 
scmd
.
uscsi_cdb
[1] = 0x8;

150 
scmd
.
uscsi_cdb
[2] = 
pc
;

151 
scmd
.
uscsi_cdb
[7] = (
·ge_Ën
 >> 8) & 0xff;

152 
scmd
.
uscsi_cdb
[8] = 
·ge_Ën
 & 0xff;

154  (
	`uscsi
(
fd
, &
scmd
) == 0);

155 
	}
}

161 
	$g‘_mode_·ge
(
fd
, 
·ge_no
, 
pc
, 
buf_Ën
, 
uch¬_t
 *
bufãr
, *
¶’
)

163 
»t
;

164 
uch¬_t
 
by‹2
;

165 
uch¬_t
 
buf
[256];

166 
ušt_t
 
h—d”_Ën
, 
·ge_Ën
, 
cİy_út
;

168 
by‹2
 = (
uch¬_t
)(((
pc
 << 6è& 0xC0è| (
·ge_no
 & 0x3f));

171 ià((
»t
 = 
	`mode_£n£
(
fd
, 
by‹2
, 1, 254, 
buf
)) == 0) {

175 
h—d”_Ën
 = 8 + 
	`GET16
(&
buf
[6]);

176 
·ge_Ën
 = 
buf
[
h—d”_Ën
 + 1] + 2;

178 
cİy_út
 = (
·ge_Ën
 > 
buf_Ën
) ? buf_len :…age_len;

179 (è
	`memıy
(
bufãr
, &
buf
[
h—d”_Ën
], 
cİy_út
);

181 ià(
¶’
) {

182 *
¶’
 = 
·ge_Ën
;

186 
	}
}

190 
	$g‘_cÚfigu¿tiÚ
(
fd
, 
ušt16_t
 
ã©u»
, 
bufsize
, 
uch¬_t
 *
buf
)

192 
uscsi_cmd
 
scmd
;

193 
cdb
[16];

195 
	`uscsi_cmd_š™
(&
scmd
, 
cdb
,  (cdb));

196 
scmd
.
uscsi_æags
 = 
USCSI_READ
|
USCSI_SILENT
;

197 
scmd
.
uscsi_timeout
 = 
CD_USCSI_TIMEOUT
;

198 
scmd
.
uscsi_cdb
[0] = 0x46;

199 
scmd
.
uscsi_cdb
[1] = 0x2;

200 
scmd
.
uscsi_cdb
[2] = (
ã©u»
 >> 8) & 0xff;

201 
scmd
.
uscsi_cdb
[3] = 
ã©u»
 & 0xff;

202 
scmd
.
uscsi_cdb
[7] = (
bufsize
 >> 8) & 0xff;

203 
scmd
.
uscsi_cdb
[8] = 
bufsize
 & 0xff;

204 
scmd
.
uscsi_cdbËn
 = 10;

205 
scmd
.
uscsi_buçddr
 = (*)
buf
;

206 
scmd
.
uscsi_buæ’
 = 
bufsize
;

208  (
	`uscsi
(
fd
, &
scmd
) == 0);

209 
	}
}

211 
boŞ—n_t


212 
	$g‘_cu¼’t_´ofe
(
fd
, *
´ofe
)

214 
size_t
 
i
;

215 
uch¬_t
 
sm®lbuf
[4];

216 
size_t
 
buæ’
;

217 
uch¬_t
 *
buå
;

218 
»t
 = 
B_FALSE
;

221 ià(
	`g‘_cÚfigu¿tiÚ
(
fd
, 0, 4, &
sm®lbuf
[0])) {

222 
buæ’
 = 
	`GET32
(
sm®lbuf
) + 4;

223 
buå
 = (
uch¬_t
 *)
	`m®loc
(
buæ’
);

226 ià(
	`g‘_cÚfigu¿tiÚ
(
fd
, 0, 
buæ’
, 
buå
)) {

227 *
´ofe
 = 
	`GET16
(&
buå
[6]);

228 
»t
 = 
B_TRUE
;

230 
	`ä“
(
buå
);

233  (
»t
);

234 
	}
}

237 
w®k_´ofes
(
fd
, (*
f
)(*, , 
boŞ—n_t
), *
¬g
)

239 
size_t
 
i
;

240 
ušt16_t
 
´ofe
, 
cu¼’t_´ofe
;

241 
uch¬_t
 
sm®lbuf
[4];

242 
size_t
 
buæ’
;

243 
uch¬_t
 *
buå
;

244 
»t
;

247 ià(
	`g‘_cÚfigu¿tiÚ
(
fd
, 0, 4, &
sm®lbuf
[0])) {

248 
buæ’
 = 
	`GET32
(
sm®lbuf
) + 4;

249 
buå
 = (
uch¬_t
 *)
	`m®loc
(
buæ’
);

252 ià(
	`g‘_cÚfigu¿tiÚ
(
fd
, 0, 
buæ’
, 
buå
)) {

253 
cu¼’t_´ofe
 = 
	`GET16
(&
buå
[6]);

254 
i
 = 8 + 4; i < 
buæ’
; i += 4) {

255 
´ofe
 = 
	`GET16
(&
buå
[
i
]);

256 
»t
 = 
	`f
(
¬g
, 
´ofe
, (´of=ğ
cu¼’t_´ofe
));

257 ià(
»t
 =ğ
CDUTIL_WALK_STOP
) {

263 
	`ä“
(
buå
);

265 
	}
}

270 
	$g‘_wr™e_¥“ds
(
uch¬_t
 *
·ge
, 
n
, 
ši¡_t
 **
¥“ds
, *
n_¥“ds
, iÁli¡_ˆ**
¥“ds_mem
)

272 
uch¬_t
 *
p
 = 
·ge
 + 2;

273 
i
;

274 
ši¡_t
 **
Ãx
;

275 
ši¡_t
 *
cu¼’t
;

276 
boŞ—n_t
 
sk
;

278 *
n_¥“ds
 = 0;

279 *
¥“ds
 = 
NULL
;

280 *
¥“ds_mem
 = (
ši¡_t
 *)
	`ÿÎoc
(
n
,  (intlist_t));

281 ià(*
¥“ds_mem
 =ğ
NULL
) {

285 
i
 = 0; i < 
n
; i++, 
p
 += 4) {

286 
cu¼’t
 = &(*
¥“ds_mem
)[
i
];

287 
cu¼’t
->
v®
 = 
	`GET16
(
p
);

290 
sk
 = 
B_FALSE
;

291 
Ãx
 = 
¥“ds
; *Ãx !ğ
NULL
;‚ex = &((*Ãx)->
Ãxt
)) {

292 ià(
cu¼’t
->
v®
 =ğ(*
Ãx
)->val) {

293 
sk
 = 
B_TRUE
;

295 } ià(
cu¼’t
->
v®
 > (*
Ãx
)->val) {

299 ià(!
sk
) {

300 
cu¼’t
->
Ãxt
 = *
Ãx
;

301 *
Ãx
 = 
cu¼’t
;

302 *
n_¥“ds
++;

305 
	}
}

308 
	$g‘_»ad_wr™e_¥“ds
(
fd
, *
»ad_¥“d
, *
wr™e_¥“d
,

309 
ši¡_t
 **
¥“ds
, *
n_¥“ds
, iÁli¡_ˆ**
¥“ds_mem
)

311 
·ge_Ën
;

312 
uch¬_t
 
p
[254];

313 
n
;

315 *
»ad_¥“d
 = *
wr™e_¥“d
 = 0;

316 *
¥“ds
 = *
¥“ds_mem
 = 
NULL
;

318 ià(!
	`g‘_mode_·ge
(
fd
, 0x2A, 0,  (
p
),…, &
·ge_Ën
)) {

322 ià(
·ge_Ën
 > 8) {

323 *
»ad_¥“d
 = 
	`GET16
(&
p
[8]);

325 ià(
·ge_Ën
 > 18) {

326 *
wr™e_¥“d
 = 
	`GET16
(&
p
[18]);

328 ià(
·ge_Ën
 < 28) {

329 
	`´štf
("MMC-2\n");

332 
	`´štf
("MMC-3\n");

335 *
wr™e_¥“d
 = 
	`GET16
(&
p
[28]);

337 ià(
·ge_Ën
 < 30) {

342 
n
 = 
	`GET16
(&
p
[30]);

343 
n
 = 
	`mš
Ò, ( (
p
) - 32) / 4);

345 
	`g‘_wr™e_¥“ds
(&
p
[32], 
n
, 
¥“ds
, 
n_¥“ds
, 
¥“ds_mem
);

347 ià(*
¥“ds
 !ğ
NULL
) {

348 *
wr™e_¥“d
 = 
	`max
(*wr™e_¥“d, (*
¥“ds
)[0].
v®
);

350 
	}
}

352 
boŞ—n_t


353 
	$g‘_disc_šfo
(
fd
, 
disc_šfo_t
 *
di
)

355 
uscsi_cmd
 
scmd
;

356 
cdb
[16];

357 
ušt8_t
 
buf
[32];

358 
bufsize
 =  (
buf
);

360 
	`bz”o
(
buf
, 
bufsize
);

361 
	`uscsi_cmd_š™
(&
scmd
, 
cdb
,  (cdb));

362 
scmd
.
uscsi_æags
 = 
USCSI_READ
|
USCSI_SILENT
;

363 
scmd
.
uscsi_timeout
 = 
CD_USCSI_TIMEOUT
;

364 
scmd
.
uscsi_cdb
[0] = 0x51;

365 
scmd
.
uscsi_cdb
[7] = (
bufsize
 >> 8) & 0xff;

366 
scmd
.
uscsi_cdb
[8] = 
bufsize
 & 0xff;

367 
scmd
.
uscsi_cdbËn
 = 10;

368 
scmd
.
uscsi_buçddr
 = (*)
buf
;

369 
scmd
.
uscsi_buæ’
 = 
bufsize
;

371 ià((
	`uscsi
(
fd
, &
scmd
)) != 0) {

372  (
B_FALSE
);

375 
di
->
disc_¡©us
 = 
buf
[2] & 0x03;

376 
di
->
”a§bË
 = 
buf
[2] & 0x10;

377 ià((
buf
[21] != 0) && (buf[21] != 0xff)) {

378 
di
->
ÿ·c™y
 = ((
buf
[21] * 60) + buf[22]) * 75;

380 
di
->
ÿ·c™y
 = 0;

383  (
B_TRUE
);

384 
	}
}

389 
boŞ—n_t


390 
	$»ad_fÜm©_ÿ·c™y
(
fd
, 
ušt64_t
 *
ÿ·c™y
)

392 
uscsi_cmd
 
scmd
;

393 
cdb
[16];

394 
ušt8_t
 
buf
[32];

395 
bufsize
 =  (
buf
);

396 
ušt32_t
 
num_blocks
;

397 
ušt32_t
 
block_Ën
;

399 
	`bz”o
(
buf
, 
bufsize
);

400 
	`uscsi_cmd_š™
(&
scmd
, 
cdb
,  (cdb));

401 
scmd
.
uscsi_æags
 = 
USCSI_READ
|
USCSI_SILENT
;

402 
scmd
.
uscsi_timeout
 = 
CD_USCSI_TIMEOUT
;

403 
scmd
.
uscsi_cdb
[0] = 0x23;

404 
scmd
.
uscsi_cdb
[7] = (
bufsize
 >> 8) & 0xff;

405 
scmd
.
uscsi_cdb
[8] = 
bufsize
 & 0xff;

406 
scmd
.
uscsi_cdbËn
 = 12;

407 
scmd
.
uscsi_buçddr
 = (*)
buf
;

408 
scmd
.
uscsi_buæ’
 = 
bufsize
;

410 ià((
	`uscsi
(
fd
, &
scmd
)) != 0) {

411  (
B_FALSE
);

414 
num_blocks
 = (
ušt32_t
)(
buf
[4] << 24) + (buf[5] << 16) + (buf[6] << 8) + buf[7];

415 
block_Ën
 = (
ušt32_t
)(
buf
[9] << 16) + (buf[10] << 8) + buf[11];

416 *
ÿ·c™y
 = (
ušt64_t
)
num_blocks
 * 
block_Ën
;

418  (
B_TRUE
);

419 
	}
}

421 
boŞ—n_t


422 
	$g‘_medŸ_šfo
(
fd
, 
dk_mšfo
 *
mšfİ
)

424  (
	`ioùl
(
fd
, 
DKIOCGMEDIAINFO
, 
mšfİ
) != -1);

425 
	}
}

431 
boŞ—n_t


432 
	$g‘_disc_ÿ·c™y_fÜ_´ofe
(
fd
, 
´ofe
, 
ušt64_t
 *
ÿ·c™y
)

434 
dk_mšfo
 
mi
;

435 
disc_šfo_t
 
di
;

436 
boŞ—n_t
 
»t
 = 
B_FALSE
;

438 
´ofe
) {

441 ià(
	`g‘_medŸ_šfo
(
fd
, &
mi
è&& (mi.
dki_ÿ·c™y
 > 1)) {

442 *
ÿ·c™y
 = 
mi
.
dki_ÿ·c™y
 * mi.
dki_lbsize
;

443 
»t
 = 
B_TRUE
;

447 ià(
	`»ad_fÜm©_ÿ·c™y
(
fd
, 
ÿ·c™y
) && (*capacity > 0)) {

448 
»t
 = 
B_TRUE
;

449 } ià(
	`g‘_disc_šfo
(
fd
, &
di
è&& (di.
ÿ·c™y
 > 0)) {

450 ià(
	`g‘_medŸ_šfo
(
fd
, &
mi
)) {

451 *
ÿ·c™y
 = 
di
.ÿ·c™y * 
mi
.
dki_lbsize
;

452 
»t
 = 
B_TRUE
;

457  (
»t
);

458 
	}
}

460 
boŞ—n_t


461 
	$»ad_toc
(
fd
, 
fÜm©
, 
Œackno
, 
buæ’
, 
uch¬_t
 *
buf
)

463 
uscsi_cmd
 
scmd
;

464 
cdb
[16];

466 
	`bz”o
(
buf
, 
buæ’
);

467 
	`uscsi_cmd_š™
(&
scmd
, 
cdb
,  (cdb));

468 
scmd
.
uscsi_æags
 = 
USCSI_READ
|
USCSI_SILENT
;

469 
scmd
.
uscsi_timeout
 = 
CD_USCSI_TIMEOUT
;

470 
scmd
.
uscsi_cdb
[0] = 0x43 ;

471 
scmd
.
uscsi_cdb
[2] = 
fÜm©
 & 0xf;

472 
scmd
.
uscsi_cdb
[6] = 
Œackno
;

473 
scmd
.
uscsi_cdb
[8] = 
buæ’
 & 0xff;

474 
scmd
.
uscsi_cdb
[7] = (
buæ’
 >> 8) & 0xff;

475 
scmd
.
uscsi_cdbËn
 = 10;

476 
scmd
.
uscsi_buçddr
 = (*)
buf
;

477 
scmd
.
uscsi_buæ’
 = 
buæ’
;

479 ià((
	`uscsi
(
fd
, &
scmd
)) != 0) {

480  (
B_FALSE
);

483  (
B_TRUE
);

484 
	}
}

	@hald/solaris/probing/cdutils.h

12 #´agm¨
id’t
 "@(#)cdutils.h 1.2 06/10/13 SMI"

14 #iâdeà
CDUTILS_H


15 
	#CDUTILS_H


	)

17 
	~<sys/ty³s.h
>

18 
	~<sys/dkio.h
>

19 
	~<sys/cdio.h
>

20 
	~<sys/scsi/im¶/uscsi.h
>

23 
	mCDUTIL_WALK_CONTINUE
,

24 
	mCDUTIL_WALK_STOP


27 
	sši¡
 {

28 
	mv®
;

29 
ši¡
 *
	mÃxt
;

30 } 
	tši¡_t
;

32 
	sdisc_šfo
 {

33 
	mdisc_¡©us
;

34 
	m”a§bË
;

35 
ušt_t
 
	mÿ·c™y
;

36 } 
	tdisc_šfo_t
;

38 
	#mš
(
a
, 
b
è(×è< (bè? (aè: (b))

	)

39 
	#max
(
a
, 
b
è(×è> (bè? (aè: (b))

	)

41 
uscsi_cmd_š™
(
uscsi_cmd
 *
scmd
, *
cdb
, 
cdbËn
);

42 
uscsi
(
fd
, 
uscsi_cmd
 *
scmd
);

43 
mode_£n£
(
fd
, 
uch¬_t
 
pc
, 
dbd
, 
·ge_Ën
,

44 
uch¬_t
 *
bufãr
);

45 
g‘_mode_·ge
(
fd
, 
·ge_no
, 
pc
, 
buf_Ën
,

46 
uch¬_t
 *
bufãr
, *
¶’
);

47 
g‘_cÚfigu¿tiÚ
(
fd
, 
ušt16_t
 
ã©u»
, 
bufsize
,

48 
uch¬_t
 *
buf
);

49 
boŞ—n_t
 
g‘_cu¼’t_´ofe
(
fd
, *
´ofe
);

50 
w®k_´ofes
(
fd
, (*
f
)(*, , 
boŞ—n_t
), *);

51 
	`g‘_»ad_wr™e_¥“ds
(
fd
, *
»ad_¥“d
, *
wr™e_¥“d
,

52 
ši¡_t
 **
w¥“ds
, *
n_w¥“ds
, iÁli¡_ˆ**
w¥“ds_mem
);

53 
boŞ—n_t
 
	`g‘_disc_šfo
(
fd
, 
disc_šfo_t
 *);

54 
boŞ—n_t
 
	`»ad_fÜm©_ÿ·c™y
(
fd
, 
ušt64_t
 *
ÿ·c™y
);

55 
boŞ—n_t
 
	`g‘_medŸ_šfo
(
fd
, 
dk_mšfo
 *
mšfİ
);

56 
boŞ—n_t
 
	`g‘_disc_ÿ·c™y_fÜ_´ofe
(
fd
, 
´ofe
,

57 
ušt64_t
 *
ÿ·c™y
);

58 
boŞ—n_t
 
	`»ad_toc
(
fd
, 
fÜm©
, 
Œackno
, 
buæ’
,

59 
uch¬_t
 *
buf
);

	@hald/solaris/probing/fsutils.c

12 #´agm¨
id’t
 "@(#)fsutils.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<¡dio.h
>

19 
	~<sys/ty³s.h
>

20 
	~<sys/scsi/im¶/uscsi.h
>

21 
	~<¡ršg.h
>

22 
	~<¡ršgs.h
>

23 
	~<ùy³.h
>

24 
	~<uni¡d.h
>

25 
	~<¡dlib.h
>

26 
	~<”ºo.h
>

27 
	~<fú.h
>

28 
	~<sys/dkio.h
>

29 
	~<libš.h
>

30 
	~<sys/dk/fdisk.h
>

31 
	~<sys/fs/pc_Ïb–.h
>

33 
	~<libh®.h
>

34 
	~"fsuts.h
"

39 
boŞ—n_t


40 
	$dos_to_dev
(*
·th
, **
dev·th
, *
num
)

42 *
p
;

44 ià((
p
 = 
	`¡¼chr
(
·th
, ':')è=ğ
NULL
) {

45  (
B_FALSE
);

47 ià((*
num
 = 
	`©oi
(
p
 + 1)) == 0) {

48  (
B_FALSE
);

50 
p
[0] = '\0';

51 *
dev·th
 = 
	`¡rdup
(
·th
);

52 
p
[0] = ':';

53  (*
dev·th
 !ğ
NULL
);

54 
	}
}

57 
	$g‘_¦iû_Çme
 (*
devlšk
)

59 *
·¹
, *
¦iû
, *
disk
;

60 *
s
 = 
NULL
;

61 *
p
;

63 ià((
p
 = 
	`¡r¡r
(
devlšk
, "/lofi/")) != 0) {

64  (
p
 +  ("/lofi/") - 1);

67 
·¹
 = 
	`¡¼chr
(
devlšk
, 'p');

68 
¦iû
 = 
	`¡¼chr
(
devlšk
, 's');

69 
disk
 = 
	`¡¼chr
(
devlšk
, 'd');

71 ià((
·¹
 !ğ
NULL
è&& (·¹ > 
¦iû
è&& (·¹ > 
disk
)) {

72 
s
 = 
·¹
;

73 } ià((
¦iû
 !ğ
NULL
è&& (¦iû > 
disk
)) {

74 
s
 = 
¦iû
;

76 
s
 = 
disk
;

78 ià((
s
 !ğ
NULL
è&& 
	`isdig™
(s[1])) {

79  (
s
);

83 
	}
}

85 
boŞ—n_t


86 
	$is_dos_drive
(
uch¬_t
 
ty³
)

88  ((
ty³
 == 1) || (type == 4) || (type == 5) || (type == 6) ||

89 ((
ty³
 >= 8) && (type <= 0xf)));

90 
	}
}

92 
boŞ—n_t


93 
	$is_dos_ex‹nded
(
uch¬_t
 
id
)

95  ((
id
 =ğ
EXTDOS
è|| (id =ğ
FDISK_EXTLBA
));

96 
	}
}

98 
	s·¹_fšd_s
 {

99 
	mnum
;

100 
	mcouÁ
;

101 
	msy¡id
;

102 
	mr_sy¡id
;

103 
	mr_»l£ù
;

104 
	mr_num£ù
;

107 ’um { 
	mWALK_CONTINUE
, 
	mWALK_TERMINATE
 };

113 
w®k_·¹™iÚs
(
fd
, 
¡¬t£c
, (*
f
)(*, , , ),

114 *
¬g
)

116 
ušt32_t
 
buf
[1024/4];

117 
bufsize
 = 1024;

118 
mboÙ
 *mboÙ = (mboÙ *)&
buf
[0];

119 
¬t
 i·¹[
FD_NUMPART
];

120 
£c
 = 
¡¬t£c
;

121 
Ï¡£c
 = 
£c
 + 1;

122 
»l£ù
;

123 
ext
 = 0;

124 
sy¡id
;

125 
boŞ—n_t
 
v®id
;

126 
i
;

128 
£c
 !ğ
Ï¡£c
) {

129 ià(
	`´—d
(
fd
, 
buf
, 
bufsize
, (
off_t
)
£c
 * 512) != bufsize) {

132 
Ï¡£c
 = 
£c
;

133 ià(
	`Éohs
(
mboÙ
->
sigÇtu»
è!ğ
MBB_MAGIC
) {

136 
	`bcİy
(
mboÙ
->
·¹s
, 
¬t
, 
FD_NUMPART
 *  (ipart));

138 
i
 = 0; i < 
FD_NUMPART
; i++) {

139 
sy¡id
 = 
¬t
[
i
].systid;

140 
»l£ù
 = 
£c
 + 
	`Éohi
(
¬t
[
i
].relsect);

141 ià(
sy¡id
 == 0) {

144 
v®id
 = 
B_TRUE
;

145 ià(
	`is_dos_ex‹nded
(
sy¡id
è&& (
£c
 =ğ
Ï¡£c
)) {

146 
£c
 = 
¡¬t£c
 + 
	`Éohi
(
¬t
[
i
].
»l£ù
);

147 ià(
ext
++ == 0) {

148 
»l£ù
 = 
¡¬t£c
 = 
£c
;

150 
v®id
 = 
B_FALSE
;

153 ià(
v®id
 && 
	`f
(
¬g
, 
¬t
[
i
].
sy¡id
, 
»l£ù
,

154 
	`Éohi
(
¬t
[
i
].
num£ù
)è=ğ
WALK_TERMINATE
) {

159 
	}
}

162 
	$fšd_dos_drive_cb
(*
¬g
, 
sy¡id
, 
»l£ù
, 
num£ù
)

164 
·¹_fšd_s
 *
p
 = 
¬g
;

166 ià(
	`is_dos_drive
(
sy¡id
)) {

167 ià(++
p
->
couÁ
 =ğp->
num
) {

168 
p
->
r_»l£ù
 = 
»l£ù
;

169 
p
->
r_num£ù
 = 
num£ù
;

170 
p
->
r_sy¡id
 = 
sy¡id
;

171  (
WALK_TERMINATE
);

175  (
WALK_CONTINUE
);

176 
	}
}

182 
boŞ—n_t


183 
	$fšd_dos_drive
(
fd
, 
num
, *
»l£ù
, *
num£ù
, *
sy¡id
)

185 
·¹_fšd_s
 
p
 = { 0, 0, 0, 0, 0, 0 };

187 
p
.
num
 =‚um;

189 ià(
num
 > 0) {

190 
	`w®k_·¹™iÚs
(
fd
, 0, 
fšd_dos_drive_cb
, &
p
);

191 ià(
p
.
couÁ
 =ğ
num
) {

192 *
»l£ù
 = 
p
.
r_»l£ù
;

193 *
num£ù
 = 
p
.
r_num£ù
;

194 *
sy¡id
 = 
p
.
r_sy¡id
;

195  (
B_TRUE
);

199  (
B_FALSE
);

200 
	}
}

203 
	$g‘_num_dos_drives_cb
(*
¬g
, 
sy¡id
, 
»l£ù
, 
num£ù
)

205 ià(
	`is_dos_drive
(
sy¡id
)) {

206 (*(*)
¬g
)++;

208  (
WALK_CONTINUE
);

209 
	}
}

212 
	$g‘_num_dos_drives
(
fd
)

214 
couÁ
 = 0;

216 
	`w®k_·¹™iÚs
(
fd
, 0, 
g‘_num_dos_drives_cb
, &
couÁ
);

218  (
couÁ
);

219 
	}
}

225 
boŞ—n_t


226 
	$vtoc_Úe_¦iû_’tœe_disk
(
vtoc
 *vtoc)

228 
i
;

229 
·¹™iÚ
 *
p
;

230 
daddr_t
 
´ev_¡¬t
;

231 
´ev_size
;

233 
i
 = 0; i < 
vtoc
->
v_Å¬ts
; i++) {

234 
p
 = &
vtoc
->
v_·¹
[
i
];

235 ià(
p
->
p_size
 == 0) {

238 ià((
p
->
p_g
 !ğ
V_BACKUP
è&& (Õ->p_g !ğ
V_UNASSIGNED
))) {

239  (
B_FALSE
);

241 ià((
i
 > 0) &&

242 ((
p
->
p_¡¬t
 !ğ
´ev_¡¬t
è|| (p->
p_size
 !ğ
´ev_size
))) {

243  (
B_FALSE
);

245 
´ev_¡¬t
 = 
p
->
p_¡¬t
;

246 
´ev_size
 = 
p
->
p_size
;

249  (
B_TRUE
);

250 
	}
}

	@hald/solaris/probing/fsutils.h

12 #´agm¨
id’t
 "@(#)fsutils.h 1.2 06/10/13 SMI"

14 #iâdeà
FSUTILS_H


15 
	#FSUTILS_H


	)

17 
	~<sys/ty³s.h
>

18 
	~<sys/vtoc.h
>

20 
boŞ—n_t
 
dos_to_dev
(*
·th
, **
dev·th
, *
num
);

21 *
g‘_¦iû_Çme
 (*
devlšk
);

22 
boŞ—n_t
 
is_dos_drive
(
uch¬_t
 
id
);

23 
boŞ—n_t
 
is_dos_ex‹nded
(
uch¬_t
 
id
);

24 
boŞ—n_t
 
fšd_dos_drive
(
fd
, 
num
, *
»l£ù
, *
num£ù
, *
sy¡id
);

25 
g‘_num_dos_drives
(
fd
);

26 
boŞ—n_t
 
vtoc_Úe_¦iû_’tœe_disk
(
vtoc
 *vtoc);

	@hald/solaris/probing/probe-storage.c

12 #´agm¨
id’t
 "@(#)probe-storage.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<”ºo.h
>

19 
	~<¡ršg.h
>

20 
	~<¡ršgs.h
>

21 
	~<ùy³.h
>

22 
	~<¡dlib.h
>

23 
	~<¡dio.h
>

24 
	~<sys/ioùl.h
>

25 
	~<sys/ty³s.h
>

26 
	~<sys/¡©.h
>

27 
	~<fú.h
>

28 
	~<uni¡d.h
>

29 
	~<sys/mÁb.h
>

30 
	~<sys/fdio.h
>

31 
	~<sys/scsi/scsi.h
>

32 
	~<sys/vtoc.h
>

33 
	~<sys/efi_·¹™iÚ.h
>

34 
	~<´iv.h
>

36 
	~<libh®.h
>

37 
	~<cduts.h
>

38 
	~<fsuts.h
>

39 
	~<logg”.h
>

47 
dbus_boŞ_t


48 
	$is_mouÁed
 (cÚ¡ *
deviû_fe
)

50 
FILE
 *
f
;

51 
dbus_boŞ_t
 
rc
 = 
FALSE
;

52 
mÁb
 
mp
;

53 
mÁb
 
m´ef
;

55 ià((
f
 = 
	`fİ’
 ("/‘c/mÁb", "r")è=ğ
NULL
)

56  
rc
;

58 
	`bz”o
(&
mp
,  (mp));

59 
	`bz”o
(&
m´ef
,  (mpref));

60 
m´ef
.
mÁ_¥ecŸl
 = (*)
deviû_fe
;

61 ià(
	`g‘mÁªy
(
f
, &
mp
, &
m´ef
) == 0) {

62 
rc
 = 
TRUE
;

65 
	`fşo£
 (
f
);

66  
rc
;

67 
	}
}

70 
	$g‘_cdrom_´İ”t›s_w®k”
 (*
¬g
, 
´ofe
, 
boŞ—n_t
 
is_cu¼’t
)

72 
LibH®ChªgeS‘
 *
cs
 = (LibH®ChªgeS‘ *)
¬g
;

74 
´ofe
) {

76 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.cdr", 
TRUE
);

79 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.cdrw", 
TRUE
);

82 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd", 
TRUE
);

85 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvdr", 
TRUE
);

88 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¿m", 
TRUE
);

91 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvdrw", 
TRUE
);

94 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvdrw", 
TRUE
);

97 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤w", 
TRUE
);

100 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤", 
TRUE
);

103 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤dl", 
TRUE
);

106 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.bd", 
TRUE
);

110 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.bdr", 
TRUE
);

113 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.bd»", 
TRUE
);

116 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.hddvd", 
TRUE
);

119 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.hddvdr", 
TRUE
);

122 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.hddvdrw", 
TRUE
);

126  
CDUTIL_WALK_CONTINUE
;

127 
	}
}

129 
	#WSPLEN
 64

	)

132 
	$g‘_cdrom_´İ”t›s
 (
fd
, 
LibH®ChªgeS‘
 *
cs
)

134 
DBusE¼Ü
 
”rÜ
;

135 
ÿ·b™›s
;

136 
»ad_¥“d
, 
wr™e_¥“d
;

137 
ši¡_t
 *
wr™e_¥“ds
, *
wr™e_¥“ds_mem
, *
¥
;

138 
n_w¥“ds
;

139 **
w¥“ds
;

140 *
w¥“ds_mem
;

141 
i
;

143 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.cdr", 
FALSE
);

144 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.cdrw", 
FALSE
);

145 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd", 
FALSE
);

146 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvdr", 
FALSE
);

147 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvdrw", 
FALSE
);

148 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¿m", 
FALSE
);

149 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤", 
FALSE
);

150 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤w", 
FALSE
);

151 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.dvd¶u¤dl", 
FALSE
);

152 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.bd", 
FALSE
);

153 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.bdr", 
FALSE
);

154 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.bd»", 
FALSE
);

155 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.hddvd", 
FALSE
);

156 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.hddvdr", 
FALSE
);

157 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.hddvdrw", 
FALSE
);

159 
	`w®k_´ofes
(
fd
, 
g‘_cdrom_´İ”t›s_w®k”
, 
cs
);

162 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.cdrom.suµÜt_medŸ_chªged", 
TRUE
);

164 
	`g‘_»ad_wr™e_¥“ds
(
fd
, &
»ad_¥“d
, &
wr™e_¥“d
, &
wr™e_¥“ds
, &
n_w¥“ds
, &
wr™e_¥“ds_mem
);

166 
	`libh®_chªge£t_£t_´İ”ty_št
 (
cs
, "¡Üage.cdrom.»ad_¥“d", 
»ad_¥“d
);

167 
	`libh®_chªge£t_£t_´İ”ty_št
 (
cs
, "¡Üage.cdrom.wr™e_¥“d", 
wr™e_¥“d
);

169 ià(
n_w¥“ds
 <= 0) {

170 
w¥“ds_mem
 = 
NULL
;

171 
	`libh®_chªge£t_£t_´İ”ty_¡¾i¡
 (
cs
, "¡Üage.cdrom.wr™e_¥“ds", (cÚ¡ **)&
w¥“ds_mem
);

174 ià((
w¥“ds
 = (**)
	`ÿÎoc
(
n_w¥“ds
 + 1,  (*))è=ğ
NULL
) {

175 
	`ä“
 (
wr™e_¥“ds_mem
);

178 ià((
w¥“ds_mem
 = (*)
	`ÿÎoc
(
n_w¥“ds
, 
WSPLEN
)è=ğ
NULL
) {

179 
	`ä“
 (
w¥“ds
);

180 
	`ä“
 (
wr™e_¥“ds_mem
);

183 
i
 = 0; i < 
n_w¥“ds
; i++) {

184 
w¥“ds
[
i
] = &
w¥“ds_mem
[˜* 
WSPLEN
];

187 
¥
 = 
wr™e_¥“ds
, 
i
 = 0; s°!ğ
NULL
; s°ğ¥->
Ãxt
, i++) {

188 
	`¢´štf
 (
w¥“ds
[
i
], 
WSPLEN
, "%d", 
¥
->
v®
);

190 
	`libh®_chªge£t_£t_´İ”ty_¡¾i¡
 (
cs
, "¡Üage.cdrom.wr™e_¥“ds", (cÚ¡ **)
w¥“ds
);

192 
	`ä“
 (
w¥“ds
);

193 
	`ä“
 (
w¥“ds_mem
);

194 
	`ä“
 (
wr™e_¥“ds_mem
);

195 
	}
}

202 
	$¹rim_cİy
(*
¤c
, 
Ën
)

204 *
d¡
, *
p
;

206 ià(
Ën
 == 0) {

207 
Ën
 = 
	`¡¾’
(
¤c
);

209 ià((
d¡
 = 
	`ÿÎoc
(1, 
Ën
 + 1)è!ğ
NULL
) {

210 
	`¡ºıy
(
d¡
, 
¤c
, 
Ën
);

211 
p
 = 
d¡
 + 
Ën
 - 1;

212 (
p
 >ğ
d¡
è&& (
	`is¥aû
(*p))) {

213 *
p
-- = '\0';

216  (
d¡
);

217 
	}
}

220 
	$g‘_disk_´İ”t›s
 (
fd
, 
LibH®ChªgeS‘
 *
cs
)

222 
scsi_šquœy
 
šq
;

223 
uscsi_cmd
 
ucmd
;

224 
scsi_cdb
 
cdb
;

225 
¡©us
;

226 *
s
;

229 (è
	`mem£t
((*è&
šq
, 0,  (inq));

230 (è
	`mem£t
((*è&
ucmd
, 0,  (ucmd));

231 (è
	`mem£t
((*è&
cdb
, 0,  (
scsi_cdb
));

232 
cdb
.
scc_cmd
 = 
SCMD_INQUIRY
;

233 
	`FORMG0COUNT
(&
cdb
,  (
šq
));

234 
ucmd
.
uscsi_cdb
 = (
ÿddr_t
è& 
cdb
;

235 
ucmd
.
uscsi_cdbËn
 = 
CDB_GROUP0
;

236 
ucmd
.
uscsi_buçddr
 = (
ÿddr_t
è& 
šq
;

237 
ucmd
.
uscsi_buæ’
 =  (
šq
);

238 
ucmd
.
uscsi_timeout
 = 30;

239 
ucmd
.
uscsi_æags
 = 
USCSI_READ
;

240 
¡©us
 = 
	`ioùl
(
fd
, 
USCSICMD
, &
ucmd
);

241 ià(
¡©us
 || 
ucmd
.
uscsi_¡©us
) {

245 ià((
s
 = 
	`¹rim_cİy
(
šq
.
šq_vid
,  (šq.šq_vid))è!ğ
NULL
) {

246 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "¡Üage.v’dÜ", 
s
);

247 
	`ä“
(
s
);

249 ià((
s
 = 
	`¹rim_cİy
(
šq
.
šq_pid
,  (šq.šq_pid))è!ğ
NULL
) {

250 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "¡Üage.mod–", 
s
);

251 
	`ä“
(
s
);

253 ià((
s
 = 
	`¹rim_cİy
(
šq
.
šq_»visiÚ
,  (šq.šq_»visiÚ))è!ğ
NULL
) {

254 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "¡Üage.fœmw¬e_»visiÚ", 
s
);

255 
	`ä“
(
s
);

257 ià((
s
 = 
	`¹rim_cİy
(
šq
.
šq_£rŸl
,  (šq.šq_£rŸl))è!ğ
NULL
) {

258 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "¡Üage.£rŸl", 
s
);

259 
	`ä“
(
s
);

261 
	}
}

267 
dbus_boŞ_t


268 
	$check_æİpy
(
fd
, 
dbus_boŞ_t
 *
w´Ù
)

270 
chg
;

272 ià((
	`ioùl
(
fd
, 
FDGETCHANGE
, &
chg
è=ğ0è&& !(chg & 
FDGC_CURRENT
)) {

273 *
w´Ù
 = ((
chg
 & 
FDGC_CURWPROT
è!ğ
NULL
);

274  (
TRUE
);

276  (
FALSE
);

278 
	}
}

281 
	$drİ_´iveges
 ()

283 
´iv_£t_t
 *
pPrivS‘
 = 
NULL
;

284 
´iv_£t_t
 *
lPrivS‘
 = 
NULL
;

290 ià((
pPrivS‘
 = 
	`´iv_¡r_to_£t
("basic", ",", 
NULL
)) == NULL) {

295 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_FILE_LINK_ANY
);

296 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_PROC_INFO
);

297 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_PROC_SESSION
);

298 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_PROC_EXEC
);

299 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_PROC_FORK
);

302 (è
	`´iv_add£t
(
pPrivS‘
, 
PRIV_SYS_DEVICES
);

305 (è
	`´iv_add£t
(
pPrivS‘
, 
PRIV_FILE_DAC_READ
);

308 ià(
	`£´iv
(
PRIV_SET
, 
PRIV_PERMITTED
, 
pPrivS‘
) != 0) {

313 ià((
lPrivS‘
 = 
	`´iv_®loc£t
()è=ğ
NULL
) {

317 
	`´iv_em±y£t
(
lPrivS‘
);

319 ià(
	`£´iv
(
PRIV_SET
, 
PRIV_LIMIT
, 
lPrivS‘
) != 0) {

323 
	`´iv_ä“£t
(
lPrivS‘
);

324 
	}
}

327 
	$maš
 (
¬gc
, *
¬gv
[])

329 
»t
 = 1;

330 
fd
 = -1;

331 
rfd
 = -1;

332 *
udi
;

333 *
deviû_fe
;

334 *
¿w_deviû_fe
;

335 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

336 
DBusE¼Ü
 
”rÜ
;

337 *
bus
;

338 *
drive_ty³
;

339 
dbus_boŞ_t
 
is_cdrom
;

340 
dbus_boŞ_t
 
is_æİpy
;

341 
dk_mšfo
 
mšfo
;

342 
dbus_boŞ_t
 
Úly_check_fÜ_medŸ
;

343 
gÙ_medŸ
 = 
FALSE
;

344 
dbus_boŞ_t
 
is_wr™e_´Ùeùed
 = 
FALSE
;

345 
dbus_boŞ_t
 
is_mbr
 = 
FALSE
;

346 
dbus_boŞ_t
 
is_smi
 = 
FALSE
;

347 
dbus_boŞ_t
 
is_g±
 = 
FALSE
;

348 
dbus_boŞ_t
 
is_·¹™iÚed
 = 
FALSE
;

349 
dbus_boŞ_t
 
vtoc_¦iûs
 = 
FALSE
;

350 
dos_út
 = 0;

351 cÚ¡ *
scheme
 = "";

352 
vtoc
 vtoc;

353 
dk_g±_t
 *
g±
;

354 
LibH®ChªgeS‘
 *
cs
 = 
NULL
;

356 ià((
udi
 = 
	`g‘’v
 ("UDI")è=ğ
NULL
)

357 
out
;

358 ià((
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_DEVICE")è=ğ
NULL
)

359 
out
;

360 ià((
¿w_deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_SOLARIS_RAW_DEVICE")è=ğ
NULL
)

361 
out
;

362 ià((
bus
 = 
	`g‘’v
 ("HAL_PROP_STORAGE_BUS")è=ğ
NULL
)

363 
out
;

364 ià((
drive_ty³
 = 
	`g‘’v
 ("HAL_PROP_STORAGE_DRIVE_TYPE")è=ğ
NULL
)

365 
out
;

367 
	`drİ_´iveges
 ();

369 
	`£tup_logg”
 ();

371 ià(
¬gc
 =ğ2 && 
	`¡rcmp
 (
¬gv
[1], "--only-check-for-media") == 0)

372 
Úly_check_fÜ_medŸ
 = 
TRUE
;

374 
Úly_check_fÜ_medŸ
 = 
FALSE
;

376 
is_cdrom
 = (
	`¡rcmp
 (
drive_ty³
, "cdrom") == 0);

377 
is_æİpy
 = (
	`¡rcmp
 (
drive_ty³
, "floppy") == 0);

379 
	`dbus_”rÜ_š™
 (&
”rÜ
);

380 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
)

381 
out
;

383 ià((
cs
 = 
	`libh®_deviû_Ãw_chªge£t
 (
udi
)è=ğ
NULL
) {

384 
	`HAL_DEBUG
 (("Cannot‡llocate changeset"));

385 
out
;

388 
	`HAL_DEBUG
 (("Doing…robe-storage for %s (bus %s) (drive_type %s) (udi=%s) (--only-check-for-media==%d)",

389 
deviû_fe
, 
bus
, 
drive_ty³
, 
udi
, 
Úly_check_fÜ_medŸ
));

391 ià((
rfd
 = 
	`İ’
 (
¿w_deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
)) < 0) {

392 
	`HAL_DEBUG
 (("CªnÙ o³À%s: %s", 
¿w_deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

393 
out
;

396 ià(!
Úly_check_fÜ_medŸ
) {

397 ià(
	`¡rcmp
 (
drive_ty³
, "cdrom") == 0) {

398 
	`g‘_cdrom_´İ”t›s
 (
rfd
, 
cs
);

399 } ià(
	`¡rcmp
 (
drive_ty³
, "disk") == 0) {

400 
	`g‘_disk_´İ”t›s
 (
rfd
, 
cs
);

404 
»t
 = 0;

406 ià(
is_cdrom
) {

407 
	`HAL_DEBUG
 (("Checkšg fÜ o±iÿÈdisøÚ %s", 
¿w_deviû_fe
));

408 
gÙ_medŸ
 = 
	`g‘_medŸ_šfo
(
rfd
, &
mšfo
);

409 ià(!
gÙ_medŸ
) {

410 
out_cs
;

413 
is_wr™e_´Ùeùed
 = 
TRUE
;

414 } ià(
is_æİpy
) {

415 
	`HAL_DEBUG
 (("Checkšg fÜ flİpy oÀ%s", 
¿w_deviû_fe
));

416 ià(
	`check_æİpy
(
rfd
, &
is_wr™e_´Ùeùed
)) {

417 
gÙ_medŸ
 = 
TRUE
;

420 
out_cs
;

422 
gÙ_medŸ
 = 
TRUE
;

425 
	`HAL_DEBUG
 (("Checkšg fÜ…¬t™iÚ Ú %s", 
deviû_fe
));

427 ià((
fd
 = 
	`İ’
 (
deviû_fe
, 
O_RDONLY
 | 
O_NONBLOCK
)) < 0) {

428 
	`HAL_DEBUG
 (("CªnÙ o³À%s: %s", 
deviû_fe
, 
	`¡»¼Ü
 (
”ºo
)));

429 
out_cs
;

432 
dos_út
 = 
	`g‘_num_dos_drives
(
fd
);

433 
is_mbr
 = (
dos_út
 > 0);

434 ià(
is_mbr
) {

435 
scheme
 = "mbr";

437 ià(
	`»ad_vtoc
(
rfd
, &
vtoc
) >= 0) {

438 ià(!
	`vtoc_Úe_¦iû_’tœe_disk
(&
vtoc
)) {

439 
is_smi
 = 
TRUE
;

440 ià(!
is_mbr
) {

442 
scheme
 = "smi";

444 
vtoc_¦iûs
 = 
TRUE
;

446 } ià(!
is_cdrom
 && (
	`efi_®loc_ªd_»ad
(
rfd
, &
g±
) >= 0)) {

451 
is_g±
 = 
TRUE
;

452 
scheme
 = "gpt";

453 
	`efi_ä“
(
g±
);

456 
out_cs
:

457 
is_·¹™iÚed
 = 
is_mbr
 || 
is_smi
 || 
is_g±
;

458 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.no_·¹™iÚs_hšt", !
is_·¹™iÚed
);

459 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "block.no_·¹™iÚs", !
is_·¹™iÚed
);

460 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "¡Üage.·¹™iÚšg_scheme", 
scheme
);

461 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.sŞ¬is.vtoc_¦iûs", 
vtoc_¦iûs
);

462 
	`libh®_chªge£t_£t_´İ”ty_št
 (
cs
, "¡Üage.sŞ¬is.num_dos_·¹™iÚs", 
dos_út
);

464 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.»movabË.medŸ_avaabË", 
gÙ_medŸ
);

465 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "¡Üage.»movabË.sŞ¬is.»ad_Úly", 
is_wr™e_´Ùeùed
);

467 
	`libh®_deviû_comm™_chªge£t
 (
ùx
, 
cs
, &
”rÜ
);

469 
out
:

470 ià(
cs
 !ğ
NULL
) {

471 
	`libh®_deviû_ä“_chªge£t
 (
cs
);

473 ià(
fd
 >= 0) {

474 
	`şo£
 (
fd
);

476 ià(
rfd
 >= 0) {

477 
	`şo£
 (
rfd
);

479 ià(
ùx
 !ğ
NULL
) {

480 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

481 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

483 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

484 
	`libh®_ùx_ä“
 (
ùx
);

487  
»t
;

488 
	}
}

	@hald/solaris/probing/probe-volume.c

12 #´agm¨
id’t
 "@(#)probe-volume.c 1.4 06/10/27 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<”ºo.h
>

19 
	~<¡ršg.h
>

20 
	~<¡dlib.h
>

21 
	~<¡dio.h
>

22 
	~<sys/ioùl.h
>

23 
	~<sys/ty³s.h
>

24 
	~<sys/¡©.h
>

25 
	~<fú.h
>

26 
	~<uni¡d.h
>

27 
	~<ùy³.h
>

28 
	~<time.h
>

29 
	~<sys/time.h
>

30 
	~<sys/dkio.h
>

31 
	~<sys/cdio.h
>

32 
	~<sys/fdio.h
>

33 
	~<libnv·œ.h
>

34 
	~<libf¡yp.h
>

35 
	~<sys/vtoc.h
>

36 
	~<sys/efi_·¹™iÚ.h
>

37 
	~<sys/fs/hsfs_¥ec.h
>

38 
	~<sys/fs/hsfs_iso¥ec.h
>

39 
	~<´iv.h
>

41 
	~<libh®.h
>

42 
	~<cduts.h
>

43 
	~<fsuts.h
>

44 
	~<logg”.h
>

47 
	$my_dbus_”rÜ_ä“
(
DBusE¼Ü
 *
”rÜ
)

49 ià(
	`dbus_”rÜ_is_£t
(
”rÜ
)) {

50 
	`dbus_”rÜ_ä“
(
”rÜ
);

52 
	}
}

59 
	$¹rim_cİy
(*
¤c
, 
Ën
)

61 *
d¡
, *
p
;

63 ià(
Ën
 == 0) {

64 
Ën
 = 
	`¡¾’
(
¤c
);

66 ià((
d¡
 = 
	`ÿÎoc
(1, 
Ën
 + 1)è!ğ
NULL
) {

67 
	`¡ºıy
(
d¡
, 
¤c
, 
Ën
);

68 
p
 = 
d¡
 + 
Ën
 - 1;

69 (
p
 >ğ
d¡
è&& (
	`is¥aû
(*p))) {

70 *
p
-- = '\0';

73  (
d¡
);

74 
	}
}

77 
	$£t_f¡yp_´İ”t›s
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, cÚ¡ *
f¡y³
, 
nvli¡_t
 *
f§‰r
)

79 
buf
[256];

80 
DBusE¼Ü
 
”rÜ
;

81 *
uuid
 = 
NULL
;

82 *
Ïb–_Üig
 = 
NULL
;

83 *
Ïb–
 = 
NULL
;

84 
LibH®ChªgeS‘
 *
cs
;

86 
	`dbus_”rÜ_š™
 (&
”rÜ
);

88 ià((
cs
 = 
	`libh®_deviû_Ãw_chªge£t
 (
udi
)è=ğ
NULL
) {

92 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.fsusage", "filesystem");

93 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.f¡y³", 
f¡y³
);

96 (è
	`nvli¡_lookup_¡ršg
(
f§‰r
, "g’_vŞume_Ïb–", &
Ïb–_Üig
);

97 ià(
Ïb–_Üig
 !ğ
NULL
) {

98 
Ïb–
 = 
	`¹rim_cİy
(
Ïb–_Üig
, 0);

100 ià((
Ïb–
 !ğ
NULL
) && (label[0] != '\0')) {

101 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.Ïb–", 
Ïb–
);

102 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "šfo.´oduù", 
Ïb–
);

104 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.label", "");

105 
	`¢´štf
 (
buf
,  (buf), "VŞum(%s)", 
f¡y³
);

106 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "šfo.´oduù", 
buf
);

108 
	`ä“
(
Ïb–
);

111 ià(
	`nvli¡_lookup_¡ršg
(
f§‰r
, "g’_uuid", &
uuid
) == 0) {

112 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.uuid", 
uuid
);

114 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "volume.uuid", "");

117 
	`libh®_deviû_comm™_chªge£t
 (
ùx
, 
cs
, &
”rÜ
);

118 
	`libh®_deviû_ä“_chªge£t
 (
cs
);

120 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

121 
	}
}

127 
	$hsfs_cÚ‹Ás
(
fd
, 
off_t
 
´obe_off£t
, 
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
)

129 
size_t
 
£csz
 = 
ISO_SECTOR_SIZE
;

130 
uch¬_t
 
buf
[
ISO_SECTOR_SIZE
];

131 
±bl_lbn
, 
±bl_size
;

132 
off
, 
»loff
, 
»adoff
;

133 
uch¬_t
 *
p
;

134 *
Çme
;

135 
Çme_Ën
;

136 
e_Ën
;

137 
DBusE¼Ü
 
”rÜ
;

142 
»adoff
 = 
´obe_off£t
 + 
ISO_VOLDESC_SEC
 * 
£csz
;

143 ià(
	`´—d
 (
fd
, 
buf
, 
£csz
, 
»adoff
) != secsz) {

146 
	`ISO_DESC_TYPE
 (
buf
è!ğ
ISO_VD_PVD
) {

147 ià(
	`ISO_DESC_TYPE
 (
buf
è=ğ
ISO_VD_EOV
) {

150 
»adoff
 +ğ
£csz
;

151 ià(
	`´—d
 (
fd
, 
buf
, 
£csz
, 
»adoff
) != secsz) {

159 
±bl_size
 = 
	`ISO_PTBL_SIZE
 (
buf
);

160 #ià
	`defšed
(
_LITTLE_ENDIAN
)

161 
±bl_lbn
 = 
	`ISO_PTBL_MAN_LS
 (
buf
);

163 
±bl_lbn
 = 
	`ISO_PTBL_MAN_MS
 (
buf
);

169 
»adoff
 = 
´obe_off£t
 + 
±bl_lbn
 * 
£csz
;

170 ià(
	`´—d
 (
fd
, 
buf
, 
£csz
, 
»adoff
) != secsz) {

173 
	`dbus_”rÜ_š™
 (&
”rÜ
);

175 
off
 = 
»loff
 = 0;

176 
off
 < 
±bl_size
;

177 
off
 +ğ
e_Ën
, 
»loff
 += ipe_len) {

180 ià(
»loff
 >ğ
£csz
) {

181 
»adoff
 +ğ
£csz
;

182 ià(
	`´—d
 (
fd
, 
buf
, 
£csz
, 
»adoff
) != secsz) {

185 
»loff
 -ğ
£csz
;

188 
p
 = 
buf
 + 
»loff
;

189 
Çme_Ën
 = 
	`IPE_NAME_LEN
(
p
);

190 
e_Ën
 = 
IPE_FPESIZE
 + 
Çme_Ën
 + (name_len % 2);

193 ià(
	`IPE_PARENT_NO
 (
p
) != 1) {

196 ià((
Çme_Ën
 < 2è|| (Çme_ËÀ> 
IDE_MAX_NAME_LEN
)) {

200 
Çme
 = (*)
	`IPE_NAME
 (
p
);

201 ià(
	`¡ºÿ£cmp
 (
Çme
, "VIDEO_TS", 
	`mš
 (8, 
Çme_Ën
)) == 0) {

202 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
udi
,

203 "vŞume.disc.is_videodvd", 
TRUE
, &
”rÜ
);

204 } ià(
	`¡ºÿ£cmp
 (
Çme
, "VCD", 
	`mš
 (3, 
Çme_Ën
)) == 0) {

205 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
udi
,

206 "vŞume.disc.is_vcd", 
TRUE
, &
”rÜ
);

207 } ià(
	`¡ºÿ£cmp
 (
Çme
, "SVCD", 
	`mš
 (4, 
Çme_Ën
)) == 0) {

208 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
udi
,

209 "vŞume.disc.is_svcd", 
TRUE
, &
”rÜ
);

213 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

214 
	}
}

216 
dbus_boŞ_t


217 
	$´obe_disc
 (
fd
, 
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
dbus_boŞ_t
 *
should_´obe_fÜ_fs
)

219 
DBusE¼Ü
 
”rÜ
;

220 
disc_šfo_t
 
di
;

221 
´ofe
;

222 
dbus_boŞ_t
 
has_audio
, 
has_d©a
, 
is_bÏnk
, 
is_­³ndabË
, 
is_»wr™abË
;

223 *
disc_ty³
 = "cd_rom";

224 
ušt64_t
 
ÿ·c™y
 = 0;

225 
i
;

226 
LibH®ChªgeS‘
 *
cs
;

228 
	`dbus_”rÜ_š™
 (&
”rÜ
);

230 ià(
	`g‘_disc_šfo
 (
fd
, &
di
)) {

231 
is_bÏnk
 = (
di
.
disc_¡©us
 == 0);

232 
is_­³ndabË
 = (
di
.
disc_¡©us
 == 1);

233 
is_»wr™abË
 = (
di
.
”a§bË
 != 0);

235 
is_bÏnk
 = 
is_­³ndabË
 = 
is_»wr™abË
 = 
FALSE
;

238 ià(
	`g‘_cu¼’t_´ofe
 (
fd
, &
´ofe
)) {

239 
´ofe
) {

241 
disc_ty³
 = "cd_rom";

244 
disc_ty³
 = "cd_r";

247 
disc_ty³
 = "cd_rw";

248 
is_»wr™abË
 = 
TRUE
;

251 
disc_ty³
 = "dvd_rom";

254 
disc_ty³
 = "dvd_r";

257 
disc_ty³
 = "dvd_ram";

258 
is_»wr™abË
 = 
TRUE
;

261 
disc_ty³
 = "dvd_rw";

262 
is_»wr™abË
 = 
TRUE
;

265 
disc_ty³
 = "dvd_rw";

266 
is_»wr™abË
 = 
TRUE
;

269 
disc_ty³
 = "dvd_plus_rw";

270 
is_»wr™abË
 = 
TRUE
;

273 
disc_ty³
 = "dvd_plus_r";

276 
disc_ty³
 = "dvd_plus_r_dl";

279 
disc_ty³
 = "bd_rom";

283 
disc_ty³
 = "bd_r";

286 
disc_ty³
 = "bd_re";

287 
is_»wr™abË
 = 
TRUE
;

290 
disc_ty³
 = "hddvd_rom";

293 
disc_ty³
 = "hddvd_r";

296 
disc_ty³
 = "hddvd_rw";

297 
is_»wr™abË
 = 
TRUE
;

301 (è
	`g‘_disc_ÿ·c™y_fÜ_´ofe
(
fd
, 
´ofe
, &
ÿ·c™y
);

304 
has_audio
 = 
has_d©a
 = 
FALSE
;

305 ià(!
is_bÏnk
) {

306 
uch¬_t
 
sm®Éoc
[12];

307 
size_t
 
toc_size
;

308 
uch¬_t
 *
toc
, *
p
;

314 ià(!
	`»ad_toc
(
fd
, 0, 1, 4, 
sm®Éoc
)) {

315 
	`HAL_DEBUG
(("read_toc failed"));

316 
has_d©a
 = 
B_TRUE
;

318 
toc_size
 = 
sm®Éoc
[0] * 256 + smalltoc[1] + 2;

319 
toc
 = (
uch¬_t
 *)
	`ÿÎoc
(1, 
toc_size
);

320 ià(
toc
 =ğ
NULL
 || !
	`»ad_toc
(
fd
, 0, 1, 
toc_size
,oc)) {

321 
	`HAL_DEBUG
 (("read_toc‡gain failed"));

323 
p
 = &
toc
[4];… < (toø+ 
toc_size
);… += 8) {

325 ià(
p
[2] == 0xAA) {

328 ià(
p
[1] & 4) {

329 
has_d©a
 = 
B_TRUE
;

331 
has_audio
 = 
B_TRUE
;

335 
	`ä“
(
toc
);

339 ià((
cs
 = 
	`libh®_deviû_Ãw_chªge£t
 (
udi
)è=ğ
NULL
) {

340  (
FALSE
);

342 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
cs
, "vŞume.disc.ty³", 
disc_ty³
);

343 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_bÏnk", 
is_bÏnk
);

344 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.has_audio", 
has_audio
);

345 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.has_d©a", 
has_d©a
);

346 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_­³ndabË", 
is_­³ndabË
);

347 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_»wr™abË", 
is_»wr™abË
);

348 
	`libh®_chªge£t_£t_´İ”ty_ušt64
 (
cs
, "vŞume.disc.ÿ·c™y", 
ÿ·c™y
);

350 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_videodvd", 
FALSE
);

351 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_vcd", 
FALSE
);

352 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "vŞume.disc.is_svcd", 
FALSE
);

354 
	`libh®_deviû_comm™_chªge£t
 (
ùx
, 
cs
, &
”rÜ
);

355 
	`libh®_deviû_ä“_chªge£t
 (
cs
);

357 
out
:

359 *
should_´obe_fÜ_fs
 = 
has_d©a
;

361 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

363  (
TRUE
);

364 
	}
}

367 
	$drİ_´iveges
 ()

369 
´iv_£t_t
 *
pPrivS‘
 = 
NULL
;

370 
´iv_£t_t
 *
lPrivS‘
 = 
NULL
;

376 ià((
pPrivS‘
 = 
	`´iv_¡r_to_£t
("basic", ",", 
NULL
)) == NULL) {

381 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_FILE_LINK_ANY
);

382 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_PROC_INFO
);

383 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_PROC_SESSION
);

384 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_PROC_EXEC
);

385 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_PROC_FORK
);

388 (è
	`´iv_add£t
(
pPrivS‘
, 
PRIV_SYS_DEVICES
);

392 (è
	`´iv_add£t
(
pPrivS‘
, 
PRIV_FILE_DAC_READ
);

395 ià(
	`£´iv
(
PRIV_SET
, 
PRIV_PERMITTED
, 
pPrivS‘
) != 0) {

400 ià((
lPrivS‘
 = 
	`´iv_®loc£t
()è=ğ
NULL
) {

404 
	`´iv_em±y£t
(
lPrivS‘
);

406 ià(
	`£´iv
(
PRIV_SET
, 
PRIV_LIMIT
, 
lPrivS‘
) != 0) {

410 
	`´iv_ä“£t
(
lPrivS‘
);

411 
	}
}

414 
	$maš
 (
¬gc
, *
¬gv
[])

416 
fd
, 
rfd
;

417 
»t
;

418 *
udi
;

419 *
deviû_fe
, *
¿w_deviû_fe
;

420 *
dev·th
, *
rdev·th
;

421 
boŞ—n_t
 
is_dos
;

422 
dos_num
;

423 
LibH®CÚ‹xt
 *
ùx
 = 
NULL
;

424 
DBusE¼Ü
 
”rÜ
;

425 
DBusCÚÃùiÚ
 *
cÚn
;

426 *
·»Á_udi
;

427 *
¡Üage_deviû
;

428 *
is_disc_¡r
;

429 
fdc
;

430 
dbus_boŞ_t
 
is_disc
 = 
FALSE
;

431 
dbus_boŞ_t
 
is_æİpy
 = 
FALSE
;

432 
block_size
;

433 
dbus_ušt64_t
 
vŞ_size
;

434 
dbus_boŞ_t
 
should_´obe_fÜ_fs
;

435 *
·¹™iÚ_scheme
 = 
NULL
;

436 
dbus_ušt64_t
 
·¹™iÚ_¡¬t
 = 0;

437 
·¹™iÚ_numb”
 = 0;

438 
vtoc
 vtoc;

439 
dk_g±_t
 *
g±
;

440 
dk_mšfo
 
mi
;

441 
i
, 
dos_út
;

442 
f¡yp_hªdË_t
 
f¡yp_hªdË
;

443 
sy¡id
, 
»l£ù
, 
num£ù
;

444 
off_t
 
´obe_off£t
 = 0;

445 
num_vŞumes
;

446 **
vŞumes
;

447 
dbus_ušt64_t
 
v_¡¬t
;

448 cÚ¡ *
f¡y³
;

449 
nvli¡_t
 *
f§‰r
;

451 
fd
 = 
rfd
 = -1;

453 
»t
 = 1;

455 ià((
udi
 = 
	`g‘’v
 ("UDI")è=ğ
NULL
) {

456 
out
;

458 ià((
deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_DEVICE")è=ğ
NULL
) {

459 
out
;

461 ià((
¿w_deviû_fe
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_SOLARIS_RAW_DEVICE")è=ğ
NULL
) {

462 
out
;

464 ià(!
	`dos_to_dev
(
deviû_fe
, &
rdev·th
, &
dos_num
)) {

465 
rdev·th
 = 
¿w_deviû_fe
;

467 ià(!(
is_dos
 = 
	`dos_to_dev
(
deviû_fe
, &
dev·th
, &
dos_num
))) {

468 
dev·th
 = 
deviû_fe
;

470 ià((
·»Á_udi
 = 
	`g‘’v
 ("HAL_PROP_INFO_PARENT")è=ğ
NULL
) {

471 
out
;

473 ià((
¡Üage_deviû
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_STORAGE_DEVICE")è=ğ
NULL
) {

474 
out
;

477 
is_disc_¡r
 = 
	`g‘’v
 ("HAL_PROP_VOLUME_IS_DISC");

478 ià(
is_disc_¡r
 !ğ
NULL
 && 
	`¡rcmp
 (is_disc_str, "true") == 0) {

479 
is_disc
 = 
TRUE
;

481 
is_disc
 = 
FALSE
;

484 
	`drİ_´iveges
 ();

486 
	`£tup_logg”
 ();

488 
	`dbus_”rÜ_š™
 (&
”rÜ
);

489 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
)

490 
out
;

492 
	`HAL_DEBUG
 (("Došg…robe-vŞumfÜ %s\n", 
deviû_fe
));

494 
fd
 = 
	`İ’
 (
dev·th
, 
O_RDONLY
 | 
O_NONBLOCK
);

495 ià(
fd
 < 0) {

496 
out
;

498 
rfd
 = 
	`İ’
 (
rdev·th
, 
O_RDONLY
 | 
O_NONBLOCK
);

499 ià(
rfd
 < 0) {

500 
out
;

504 ià(
	`ioùl
(
rfd
, 
FDGETCHANGE
, &
fdc
) == 0) {

505 
is_æİpy
 = 
TRUE
;

506 ià(
fdc
 & 
FDGC_CURRENT
) {

507 
out
;

512 ià(
	`ioùl
(
rfd
, 
DKIOCGMEDIAINFO
, &
mi
) != -1) {

513 
block_size
 = 
mi
.
dki_lbsize
;

514 
vŞ_size
 = 
mi
.
dki_ÿ·c™y
 * 
block_size
;

516 
block_size
 = 512;

517 
vŞ_size
 = 0;

519 
	`libh®_deviû_£t_´İ”ty_št
 (
ùx
, 
udi
, "vŞume.block_size", 
block_size
, &
”rÜ
);

520 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

521 
	`libh®_deviû_£t_´İ”ty_ušt64
 (
ùx
, 
udi
, "vŞume.size", 
vŞ_size
, &
”rÜ
);

522 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

524 
should_´obe_fÜ_fs
 = 
TRUE
;

526 ià(
is_disc
) {

527 ià(!
	`´obe_disc
 (
rfd
, 
ùx
, 
udi
, &
should_´obe_fÜ_fs
)) {

528 
	`HAL_DEBUG
 (("probe_disc failed, skipping fstyp"));

529 
out
;

534 ià(!
should_´obe_fÜ_fs
) {

535 
sk_fs
;

539 ià(
is_æİpy
) {

540 
sk_·¹
;

546 ià(
is_dos
) {

548 ià(!
	`fšd_dos_drive
(
fd
, 
dos_num
, &
»l£ù
, &
num£ù
, &
sy¡id
)) {

549 
out
;

551 
·¹™iÚ_scheme
 = "mbr";

552 
·¹™iÚ_¡¬t
 = (
dbus_ušt64_t
)
»l£ù
 * 512;

553 
·¹™iÚ_numb”
 = 
dos_num
;

554 
´obe_off£t
 = (
off_t
)
»l£ù
 * 512;

556 ià((
·¹™iÚ_numb”
 = 
	`»ad_vtoc
(
rfd
, &
vtoc
)) >= 0) {

557 ià(!
	`vtoc_Úe_¦iû_’tœe_disk
(&
vtoc
)) {

558 
·¹™iÚ_scheme
 = "smi";

559 ià(
·¹™iÚ_numb”
 < 
vtoc
.
v_Å¬ts
) {

560 ià(
vtoc
.
v_·¹
[
·¹™iÚ_numb”
].
p_size
 == 0) {

561 
	`HAL_DEBUG
 (("zero size…artition"));

563 
·¹™iÚ_¡¬t
 = 
vtoc
.
v_·¹
[
·¹™iÚ_numb”
].
p_¡¬t
 * 
block_size
;

566 } ià((
·¹™iÚ_numb”
 = 
	`efi_®loc_ªd_»ad
(
rfd
, &
g±
)) >= 0) {

567 
·¹™iÚ_scheme
 = "gpt";

568 ià(
·¹™iÚ_numb”
 < 
g±
->
efi_Å¬ts
) {

569 ià(
g±
->
efi_·¹s
[
·¹™iÚ_numb”
].
p_size
 == 0) {

570 
	`HAL_DEBUG
 (("zero size…artition"));

572 
·¹™iÚ_¡¬t
 = 
g±
->
efi_·¹s
[
·¹™iÚ_numb”
].
p_¡¬t
 * 
block_size
;

574 
	`efi_ä“
(
g±
);

576 
´obe_off£t
 = 0;

579 ià(
·¹™iÚ_scheme
 !ğ
NULL
) {

580 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
ùx
, 
udi
, "vŞume.·¹™iÚ.scheme", 
·¹™iÚ_scheme
, &
”rÜ
);

581 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

582 
	`libh®_deviû_£t_´İ”ty_št
 (
ùx
, 
udi
, "vŞume.·¹™iÚ.numb”", 
·¹™iÚ_numb”
, &
”rÜ
);

583 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

584 
	`libh®_deviû_£t_´İ”ty_ušt64
 (
ùx
, 
udi
, "vŞume.·¹™iÚ.¡¬t", 
·¹™iÚ_¡¬t
, &
”rÜ
);

585 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

586 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
udi
, "vŞume.is_·¹™iÚ", 
TRUE
, &
”rÜ
);

587 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

589 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
ùx
, 
udi
, "vŞume.is_·¹™iÚ", 
FALSE
, &
”rÜ
);

590 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

596 ià((
vŞumes
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (

597 
ùx
, "block.¡Üage_deviû", 
¡Üage_deviû
, &
num_vŞumes
, &
”rÜ
)è!ğ
NULL
) {

598 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

599 
i
 = 0; i < 
num_vŞumes
; i++) {

600 ià(
	`¡rcmp
 (
udi
, 
vŞumes
[
i
]) == 0) {

603 
v_¡¬t
 = 
	`libh®_deviû_g‘_´İ”ty_ušt64
 (
ùx
, 
vŞumes
[
i
], "vŞume.·¹™iÚ.¡¬t", &
”rÜ
);

604 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

605 
	`dbus_”rÜ_ä“
(&
”rÜ
);

608 ià(
v_¡¬t
 =ğ
·¹™iÚ_¡¬t
) {

609 
	`HAL_DEBUG
 (("duplicate…artition"));

610 
out
;

613 
	`libh®_ä“_¡ršg_¬¿y
 (
vŞumes
);

616 
sk_·¹
:

621 ià(
	`f¡yp_š™
(
fd
, 
´obe_off£t
, 
NULL
, &
f¡yp_hªdË
) != 0) {

622 
	`HAL_DEBUG
 (("fstyp_init failed"));

623 
out
;

625 ià((
	`f¡yp_id’t
(
f¡yp_hªdË
, 
NULL
, &
f¡y³
) != 0) ||

626 (
	`f¡yp_g‘_©Œ
(
f¡yp_hªdË
, &
f§‰r
) != 0)) {

627 
	`HAL_DEBUG
 (("fstyp ident or get_attr failed"));

634 
	`HAL_DEBUG
 (("trying udfs workaround"));

635 
	`f¡yp_fši
(
f¡yp_hªdË
);

636 ià(
	`f¡yp_š™
(
rfd
, 
´obe_off£t
, 
NULL
, &
f¡yp_hªdË
) != 0) {

637 
out
;

639 ià((
	`f¡yp_id’t
(
f¡yp_hªdË
, "udfs", &
f¡y³
) != 0) ||

640 (
	`f¡yp_g‘_©Œ
(
f¡yp_hªdË
, &
f§‰r
) != 0)) {

641 
	`f¡yp_fši
(
f¡yp_hªdË
);

642 
out
;

645 
	`£t_f¡yp_´İ”t›s
 (
ùx
, 
udi
, 
f¡y³
, 
f§‰r
);

647 ià(
	`¡rcmp
 (
f¡y³
, "hsfs") == 0) {

648 
	`hsfs_cÚ‹Ás
 (
fd
, 
´obe_off£t
, 
ùx
, 
udi
);

651 
	`f¡yp_fši
(
f¡yp_hªdË
);

653 
sk_fs
:

655 
»t
 = 0;

657 
out
:

658 ià(
fd
 >= 0)

659 
	`şo£
 (
fd
);

660 ià(
rfd
 >= 0)

661 
	`şo£
 (
rfd
);

663 ià(
ùx
 !ğ
NULL
) {

664 
	`my_dbus_”rÜ_ä“
 (&
”rÜ
);

665 
	`libh®_ùx_shutdown
 (
ùx
, &
”rÜ
);

666 
	`libh®_ùx_ä“
 (
ùx
);

669  
»t
;

671 
	}
}

	@hald/solaris/sysevent.c

12 #´agm¨
id’t
 "@(#)sysevent.c 1.2 06/10/13 SMI"

14 #ifdeà
HAVE_CONFIG_H


15 
	~<cÚfig.h
>

18 
	~<¡dio.h
>

19 
	~<uni¡d.h
>

20 
	~<¡dlib.h
>

21 
	~<¡ršg.h
>

22 
	~<”ºo.h
>

23 
	~<fú.h
>

24 
	~<sys/dkio.h
>

25 
	~<sys/¡©.h
>

26 
	~<libdevšfo.h
>

27 
	~<libsy£v’t.h
>

28 
	~<sys/sy£v’t/dev.h
>

29 
	~<glib.h
>

31 
	~"../os¥ec.h
"

32 
	~"../logg”.h
"

33 
	~"../h®d.h
"

34 
	~"../h®d_dbus.h
"

35 
	~"../deviû_šfo.h
"

36 
	~"../ut.h
"

37 
	~"os¥ec_sŞ¬is.h
"

38 
	~"hÙ¶ug.h
"

39 
	~"devšfo.h
"

40 
	~"devšfo_¡Üage.h
"

41 
	~"sy£v’t.h
"

43 #iâdeà
ESC_LOFI


44 
	#ESC_LOFI
 "lofi"

	)

47 
sy£v’t_dev_hªdËr
(
sy£v’t_t
 *);

48 
gboŞ—n
 
sy£v’t_iochªÃl_d©a
(
GIOChªÃl
 *, 
GIOCÚd™iÚ
, 
gpoš‹r
);

49 
sy£v’t_dev_add
(
gch¬
 *, gchar *);

50 
sy£v’t_dev_»move
(
gch¬
 *, gchar *);

51 
sy£v’t_dev_b¿nch
(
gch¬
 *);

52 
sy£v’t_lofi_add
(
gch¬
 *, gchar *);

53 
sy£v’t_lofi_»move
(
gch¬
 *, gchar *);

55 
sy£v’t_hªdË_t
 *
	gshp
;

57 
	gsy£v’t_pe_fds
[2];

58 
GIOChªÃl
 *
	gsy£v’t_iochªÃl
;

59 
gušt
 
	gsy£v’t_sourû_id
;

61 
gboŞ—n


62 
	$sy£v’t_š™
()

64 
GE¼Ü
 *
”r
 = 
NULL
;

65 cÚ¡ *
subş
[2];

70 ià(
	`pe
 (
sy£v’t_pe_fds
) != 0) {

71 
	`HAL_INFO
 (("pe(èçedƒ¼no=%d", 
”ºo
));

72  (
FALSE
);

74 
sy£v’t_iochªÃl
 = 
	`g_io_chªÃl_unix_Ãw
 (
sy£v’t_pe_fds
[0]);

75 ià(
sy£v’t_iochªÃl
 =ğ
NULL
) {

76 
	`HAL_INFO
 (("g_io_channel_unix_new failed"));

77  (
FALSE
);

79 
	`g_io_chªÃl_£t_æags
 (
sy£v’t_iochªÃl
, 
G_IO_FLAG_NONBLOCK
, &
”r
);

80 
sy£v’t_sourû_id
 = 
	`g_io_add_w©ch
 (

81 
sy£v’t_iochªÃl
, 
G_IO_IN
, 
sy£v’t_iochªÃl_d©a
, 
NULL
);

83 
shp
 = 
	`sy£v’t_bšd_hªdË
(
sy£v’t_dev_hªdËr
);

84 ià(
shp
 =ğ
NULL
) {

85 
	`HAL_INFO
 (("sy£v’t_bšd_hªdË faed %d", 
”ºo
));

86  (
FALSE
);

89 
subş
[0] = 
ESC_DISK
;

90 
subş
[1] = 
ESC_LOFI
;

91 ià(
	`sy£v’t_subsüibe_ev’t
(
shp
, 
EC_DEV_ADD
, 
subş
, 2) != 0) {

92 
	`HAL_INFO
 (("subsüibe(dev_addèçed %d", 
”ºo
));

93 
	`sy£v’t_unbšd_hªdË
(
shp
);

94  (
FALSE
);

96 ià(
	`sy£v’t_subsüibe_ev’t
(
shp
, 
EC_DEV_REMOVE
, 
subş
, 2) != 0) {

97 
	`HAL_INFO
 (("subsüibe(dev_»moveèçed %d", 
”ºo
));

98 
	`sy£v’t_unbšd_hªdË
(
shp
);

99  (
FALSE
);

102 
subş
[0] = 
ESC_DEV_BRANCH_REMOVE
;

103 ià(
	`sy£v’t_subsüibe_ev’t
(
shp
, 
EC_DEV_BRANCH
, 
subş
, 1) != 0) {

104 
	`HAL_INFO
 (("subsüibe(dev_b¿nchèçed %d", 
”ºo
));

105 
	`sy£v’t_unbšd_hªdË
(
shp
);

106  (
FALSE
);

109  (
B_TRUE
);

110 
	}
}

113 
	$sy£v’t_fši
()

115 
	`sy£v’t_unbšd_hªdË
(
shp
);

116 
shp
 = 
NULL
;

117 
	}
}

120 
	$sy£v’t_dev_hªdËr
(
sy£v’t_t
 *
ev
)

122 *
şass
;

123 *
subşass
;

124 
nvli¡_t
 *
©Œ_li¡
;

125 *
phys_·th
;

126 *
dev_Çme
;

127 
s
[1024];

128 
ssize_t
 
nwr™‹n
;

130 ià((
şass
 = 
	`sy£v’t_g‘_şass_Çme
(
ev
)è=ğ
NULL
)

133 ià((
subşass
 = 
	`sy£v’t_g‘_subşass_Çme
(
ev
)è=ğ
NULL
)

136 ià(
	`sy£v’t_g‘_©Œ_li¡
(
ev
, &
©Œ_li¡
) != 0)

139 ià(
	`nvli¡_lookup_¡ršg
(
©Œ_li¡
, 
DEV_PHYS_PATH
, &
phys_·th
) != 0)

140 
out
;

142 ià(
	`nvli¡_lookup_¡ršg
(
©Œ_li¡
, 
DEV_NAME
, &
dev_Çme
) != 0)

143 
dev_Çme
 = "";

145 
	`¢´štf
(
s
,  (s), "%s %s %s %s\n",

146 
şass
, 
subşass
, 
phys_·th
, 
dev_Çme
);

147 
nwr™‹n
 = 
	`wr™e
(
sy£v’t_pe_fds
[1], 
s
, 
	`¡¾’
(s) + 1);

149 
	`HAL_INFO
 (("sy£v’t_dev_hªdËr: wrÙ%d by‹s", 
nwr™‹n
));

151 
out
:

152 
	`nvli¡_ä“
(
©Œ_li¡
);

153 
	}
}

155 
gboŞ—n


156 
	$sy£v’t_iochªÃl_d©a
 (
GIOChªÃl
 *
sourû
,

157 
GIOCÚd™iÚ
 
cÚd™iÚ
,

158 
gpoš‹r
 
u£r_d©a
)

160 
GE¼Ü
 *
”r
 = 
NULL
;

161 
gch¬
 *
s
 = 
NULL
;

162 
gsize
 
Ën
;

163 
m©ches
;

164 
gch¬
 
şass
[1024];

165 
gch¬
 
subşass
[1024];

166 
gch¬
 
phys_·th
[1024];

167 
gch¬
 
dev_Çme
[1024];

169 
	`HAL_INFO
 (("sysevent_iochannel_data"));

171 
	`g_io_chªÃl_»ad_lše
 (
sy£v’t_iochªÃl
, &
s
, &
Ën
, 
NULL
,

172 &
”r
è=ğ
G_IO_STATUS_NORMAL
) {

173 ià(
Ën
 == 0) {

177 
şass
[0] = 
subşass
[0] = 
phys_·th
[0] = 
dev_Çme
[0] = '\0';

178 
m©ches
 = 
	`ssÿnf
(
s
, "% % % %s", 
şass
, 
subşass
, 
phys_·th
, 
dev_Çme
);

179 
	`g_ä“
 (
s
);

180 
s
 = 
NULL
;

181 ià(
m©ches
 < 3) {

184 
	`HAL_INFO
 (("sy£v’t: cÏss=%s, sub=%s", 
şass
, 
subşass
));

186 ià(
	`¡rcmp
(
şass
, 
EC_DEV_ADD
) == 0) {

187 ià(
	`¡rcmp
(
subşass
, 
ESC_DISK
) == 0) {

188 
	`sy£v’t_dev_add
(
phys_·th
, 
dev_Çme
);

189 } ià(
	`¡rcmp
(
subşass
, 
ESC_LOFI
) == 0) {

190 
	`sy£v’t_lofi_add
(
phys_·th
, 
dev_Çme
);

192 } ià(
	`¡rcmp
(
şass
, 
EC_DEV_REMOVE
) == 0) {

193 ià(
	`¡rcmp
(
subşass
, 
ESC_DISK
) == 0) {

194 
	`sy£v’t_dev_»move
(
phys_·th
, 
dev_Çme
);

195 } ià(
	`¡rcmp
(
subşass
, 
ESC_LOFI
) == 0) {

196 
	`sy£v’t_lofi_»move
(
phys_·th
, 
dev_Çme
);

198 } ià(
	`¡rcmp
(
şass
, 
EC_DEV_BRANCH
) == 0) {

199 
	`sy£v’t_dev_b¿nch
(
phys_·th
);

203 ià(
”r
) {

204 
	`g_”rÜ_ä“
 (
”r
);

207  (
TRUE
);

208 
	}
}

211 
	$sy£v’t_dev_add
(
gch¬
 *
devfs_·th
, gch¬ *
Çme
)

213 
gch¬
 *
·»Á_devfs_·th
, *
hÙ¶ug_devfs_·th
;

214 
H®Deviû
 *
·»Á
;

216 
	`HAL_INFO
 (("dev_add: % %s", 
Çme
, 
devfs_·th
));

218 
·»Á
 = 
	`h®_ut_fšd_şo£¡_ªû¡Ü
 (
devfs_·th
, &
·»Á_devfs_·th
, &
hÙ¶ug_devfs_·th
);

219 ià(
·»Á
 =ğ
NULL
) {

223 
	`HAL_INFO
 (("dev_add:…¬’t=%s", 
·»Á_devfs_·th
));

224 
	`HAL_INFO
 (("dev_add:„—l=%s", 
hÙ¶ug_devfs_·th
));

226 
	`devšfo_add
 (
·»Á
, 
hÙ¶ug_devfs_·th
);

228 
	`g_ä“
 (
·»Á_devfs_·th
);

229 
	`g_ä“
 (
hÙ¶ug_devfs_·th
);

231 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

232 
	}
}

235 
	$sy£v’t_dev_»move
(
gch¬
 *
devfs_·th
, gch¬ *
Çme
)

237 
	`HAL_INFO
 (("dev_»move: % %s", 
Çme
, 
devfs_·th
));

239 
	`devšfo_»move_b¿nch
 (
devfs_·th
, 
NULL
);

240 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

241 
	}
}

244 
	$sy£v’t_dev_b¿nch
(
gch¬
 *
devfs_·th
)

246 
	`HAL_INFO
 (("b¿nch_»move: %s", 
devfs_·th
));

248 
	`devšfo_»move_b¿nch
 (
devfs_·th
, 
NULL
);

249 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

250 
	}
}

253 
	$sy£v’t_lofi_add
(
gch¬
 *
devfs_·th
, gch¬ *
Çme
)

255 
di_node_t
 
node
;

256 cÚ¡ *
·»Á_udi
;

257 
H®Deviû
 *
d
, *
·»Á
;

259 
	`HAL_INFO
 (("lofi_add: % %s", 
Çme
, 
devfs_·th
));

261 ià((
d
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

262 "sŞ¬is.devfs_·th", 
devfs_·th
)è=ğ
NULL
) {

263 
	`HAL_INFO
 (("deviû‚Ù found iÀGDL %s", 
devfs_·th
));

266 
·»Á_udi
 = 
	`h®_deviû_´İ”ty_g‘_¡ršg
 (
d
, "info.parent");

267 ià((
·»Á_udi
 =ğ
NULL
è|| (
	`¡¾’
(parent_udi) == 0)) {

268 
	`HAL_INFO
 (("·»Á‚Ù found iÀGDL %s", 
·»Á_udi
));

271 ià((
·»Á
 = 
	`h®_deviû_¡Üe_m©ch_key_v®ue_¡ršg
 (
	`h®d_g‘_gdl
 (),

272 "šfo.udi", 
·»Á_udi
)è=ğ
NULL
) {

273 
	`HAL_INFO
 (("·»Á‚Ù found iÀGDL %s", 
·»Á_udi
));

277 ià((
node
 = 
	`di_š™
 (
devfs_·th
, 
DINFOCPYALL
)è=ğ
DI_NODE_NIL
) {

278 
	`HAL_INFO
 (("deviû‚Ù found iÀdevšfØ%s", 
devfs_·th
));

282 
	`HAL_INFO
 (("deviû % ·»Á %s", 
	`h®_deviû_g‘_udi
 (
d
), 
·»Á_udi
));

283 
	`devšfo_lofi_add_majÜ
 (
·»Á
, 
node
, 
devfs_·th
, 
NULL
, 
TRUE
, 
d
);

285 
	`di_fši
 (
node
);

287 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

288 
	}
}

291 
	$sy£v’t_lofi_»move
(
gch¬
 *
·»Á_devfs_·th
, gch¬ *
Çme
)

293 
	`devšfo_lofi_»move_mšÜ
(
·»Á_devfs_·th
, 
Çme
);

294 
	`hÙ¶ug_ev’t_´oûss_queue
 ();

295 
	}
}

	@hald/solaris/sysevent.h

12 #´agm¨
id’t
 "@(#)sysevent.h 1.2 06/10/13 SMI"

14 #iâdeà
SYSEVENT_H


15 
	#SYSEVENT_H


	)

17 
	~<glib.h
>

19 
gboŞ—n
 
sy£v’t_š™
();

20 
sy£v’t_fši
();

	@hald/util.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<¡dio.h
>

31 
	~<¡d¬g.h
>

32 
	~<¡ršg.h
>

33 
	~<”ºo.h
>

34 
	~<time.h
>

35 
	~<ùy³.h
>

36 
	~<¡dšt.h
>

37 
	~<sys/¡©.h
>

38 
	~<uni¡d.h
>

39 
	~<fú.h
>

40 
	~<sigÇl.h
>

41 
	~<sys/wa™.h
>

42 
	~<sys/fe.h
>

44 
	~<glib.h
>

45 
	~<dbus/dbus.h
>

46 
	~<dbus/dbus-glib.h
>

48 
	~"os¥ec.h
"

49 
	~"logg”.h
"

50 
	~"h®d.h
"

51 
	~"h®d_ruÂ”.h
"

52 
	~"h®d_dbus.h
"

53 
	~"deviû_šfo.h
"

55 
	~"ut.h
"

61 
	#VALID_INITIAL_NAME_CHARACTER
(
c
) \

62 Ğ((
c
) >= 'A' && (c) <= 'Z') || \

63 ((
c
) >= 'a' && (c) <= 'z') || \

64 ((
c
è=ğ'_'è)

	)

70 
	#VALID_NAME_CHARACTER
(
c
) \

71 Ğ((
c
) >= '0' && (c) <= '9') || \

72 ((
c
) >= 'A' && (c) <= 'Z') || \

73 ((
c
) >= 'a' && (c) <= 'z') || \

74 ((
c
è=ğ'_'è)

	)

77 
gboŞ—n


78 
	$h®_ut_»move_Œašg_¦ash
 (
gch¬
 *
·th
)

80 
gch¬
 *
c
 = 
NULL
;

82 ià(
·th
 =ğ
NULL
) {

83  
FALSE
;

86 
c
 = 
	`¡¼chr
 (
·th
, '/');

87 ià(
c
 =ğ
NULL
) {

88 
	`HAL_WARNING
 (("Inv®id…©h %s", 
·th
));

91 ià(*(
c
+1) == '\0')

92 *
c
 = '\0';

94  
TRUE
;

95 
	}
}

103 cÚ¡ 
gch¬
 *

104 
	$h®_ut_g‘_Ï¡_–em’t
 (cÚ¡ 
gch¬
 *
s
)

106 
Ën
;

107 cÚ¡ 
gch¬
 *
p
;

109 
Ën
 = 
	`¡¾’
 (
s
);

110 
p
 = 
s
 + 
Ën
 - 1;… > s; --p) {

111 ià((*
p
) == '/')

112  
p
 + 1;

115  
s
;

116 
	}
}

124 
gch¬
 *

125 
	$h®_ut_g‘_·»Á_·th
 (cÚ¡ 
gch¬
 *
·th
)

127 
gušt
 
i
;

128 
gušt
 
Ën
;

129 
gch¬
 *
·»Á_·th
;

132 
·»Á_·th
 = 
	`g_¡ºdup
 (
·th
, 
HAL_PATH_MAX
);

133 
Ën
 = 
	`¡¾’
 (
·»Á_·th
);

134 
i
 = 
Ën
 - 1; 
·»Á_·th
[i] != '/'; --i) {

135 
·»Á_·th
[
i
] = '\0';

137 
·»Á_·th
[
i
] = '\0';

139  
·»Á_·th
;

140 
	}
}

142 
gch¬
 *

143 
	$h®_ut_g‘_nÜm®ized_·th
 (cÚ¡ 
gch¬
 *
·th1
, cÚ¡ gch¬ *
·th2
)

145 
Ën1
;

146 
Ën2
;

147 cÚ¡ 
gch¬
 *
p1
;

148 cÚ¡ 
gch¬
 *
p2
;

149 
gch¬
 
buf
[
HAL_PATH_MAX
];

151 
Ën1
 = 
	`¡¾’
 (
·th1
);

152 
Ën2
 = 
	`¡¾’
 (
·th2
);

154 
p1
 = 
·th1
 + 
Ën1
;

156 
p2
 = 
·th2
;

157 
p2
 < 
·th2
 + 
Ën2
 && 
	`¡ºcmp
 (p2, "../", 3) == 0) {

158 
p2
 += 3;

160 
p1
 >ğ
·th1
 && *(--p1)!='/')

164 ià((
p1
-
·th1
) < 0) {

165 
	`HAL_ERROR
 (("Could‚Ù‚Üm®iz'%s'‡nd '%s',„‘uº 'NULL'", 
·th1
, 
·th2
));

166  
NULL
;

169 
	`¡ºıy
 (
buf
, 
·th1
, (
p1
-path1));

170 
buf
[
p1
-
·th1
] = '\0';

172  
	`g_¡rdup_´štf
 ("%s/%s", 
buf
, 
p2
);

173 
	}
}

175 
gboŞ—n


176 
	$h®_ut_g‘_št_äom_fe
 (cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
, 
gšt
 *
»suÉ
, gšˆ
ba£
)

178 
FILE
 *
f
;

179 
buf
[64];

180 
gch¬
 
·th
[
HAL_PATH_MAX
];

181 
gboŞ—n
 
»t
;

182 
gšt
 
_»suÉ
;

184 
f
 = 
NULL
;

185 
»t
 = 
FALSE
;

187 
	`g_¢´štf
 (
·th
,  (·th), "%s/%s", 
dœeùÜy
, 
fe
);

189 
f
 = 
	`fİ’
 (
·th
, "rb");

190 ià(
f
 =ğ
NULL
) {

192 
out
;

195 ià(
	`fg‘s
 (
buf
,  (buf), 
f
è=ğ
NULL
) {

197 
out
;

200 
”ºo
 = 0;

201 
_»suÉ
 = 
	`¡¹Ş
 (
buf
, 
NULL
, 
ba£
);

202 ià(
”ºo
 == 0) {

203 
»t
 = 
TRUE
;

204 *
»suÉ
 = 
_»suÉ
;

207 
out
:

208 ià(
f
 !ğ
NULL
)

209 
	`fşo£
 (
f
);

211  
»t
;

212 
	}
}

214 
gboŞ—n


215 
	$h®_ut_£t_št_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
, cÚ¡ gch¬ *
dœeùÜy
, cÚ¡ gch¬ *
fe
, 
gšt
 
ba£
)

217 
gšt
 
v®ue
;

218 
gboŞ—n
 
»t
;

220 
»t
 = 
FALSE
;

222 ià(
	`h®_ut_g‘_št_äom_fe
 (
dœeùÜy
, 
fe
, &
v®ue
, 
ba£
))

223 
»t
 = 
	`h®_deviû_´İ”ty_£t_št
 (
d
, 
key
, 
v®ue
);

225  
»t
;

226 
	}
}

229 
gboŞ—n


230 
	$h®_ut_g‘_ušt64_äom_fe
 (cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
, 
gušt64
 *
»suÉ
, 
gšt
 
ba£
)

232 
FILE
 *
f
;

233 
buf
[64];

234 
gch¬
 
·th
[
HAL_PATH_MAX
];

235 
gboŞ—n
 
»t
;

236 
gušt64
 
_»suÉ
;

238 
f
 = 
NULL
;

239 
»t
 = 
FALSE
;

241 
	`g_¢´štf
 (
·th
,  (·th), "%s/%s", 
dœeùÜy
, 
fe
);

243 
f
 = 
	`fİ’
 (
·th
, "rb");

244 ià(
f
 =ğ
NULL
) {

246 
out
;

249 ià(
	`fg‘s
 (
buf
,  (buf), 
f
è=ğ
NULL
) {

251 
out
;

254 
”ºo
 = 0;

255 
_»suÉ
 = 
	`¡¹Şl
 (
buf
, 
NULL
, 
ba£
);

256 ià(
”ºo
 == 0) {

257 
»t
 = 
TRUE
;

258 *
»suÉ
 = 
_»suÉ
;

261 
out
:

262 ià(
f
 !ğ
NULL
)

263 
	`fşo£
 (
f
);

265  
»t
;

266 
	}
}

268 
gboŞ—n


269 
	$h®_ut_£t_ušt64_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
, cÚ¡ gch¬ *
dœeùÜy
, cÚ¡ gch¬ *
fe
, 
gšt
 
ba£
)

271 
gušt64
 
v®ue
;

272 
gboŞ—n
 
»t
;

274 
»t
 = 
FALSE
;

276 ià(
	`h®_ut_g‘_ušt64_äom_fe
 (
dœeùÜy
, 
fe
, &
v®ue
, 
ba£
))

277 
»t
 = 
	`h®_deviû_´İ”ty_£t_ušt64
 (
d
, 
key
, 
v®ue
);

279  
»t
;

280 
	}
}

282 
gch¬
 *

283 
	$h®_ut_g‘_¡ršg_äom_fe
 (cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
)

285 
FILE
 *
f
;

286 
gch¬
 
buf
[256];

287 
gch¬
 
·th
[
HAL_PATH_MAX
];

288 
gch¬
 *
»suÉ
;

289 
gsize
 
Ën
;

290 
gšt
 
i
;

292 
f
 = 
NULL
;

293 
»suÉ
 = 
NULL
;

295 
	`g_¢´štf
 (
·th
,  (·th), "%s/%s", 
dœeùÜy
, 
fe
);

297 
f
 = 
	`fİ’
 (
·th
, "rb");

298 ià(
f
 =ğ
NULL
) {

300 
out
;

303 
buf
[0] = '\0';

304 ià(
	`fg‘s
 (
buf
,  (buf), 
f
è=ğ
NULL
) {

306 
out
;

310 
Ën
 = 
	`¡¾’
 (
buf
);

311 ià(
Ën
 == 0)

312 
out
;

315 
i
 = 
Ën
 - 1; i >= 0; --i) {

316 ià(!
	`g_ascii_is¥aû
 (
buf
[
i
]))

318 
buf
[
i
] = '\0';

321 
»suÉ
 = 
buf
;

323 
out
:

324 ià(
f
 !ğ
NULL
)

325 
	`fşo£
 (
f
);

327  
»suÉ
;

328 
	}
}

331 
gboŞ—n


332 
	$h®_ut_g‘_boŞ_äom_fe
 (cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
, 
gboŞ—n
 *
»tv®
, cÚ¡ gch¬ *
Œue_v®
)

334 
gch¬
 *
v®ue
;

335 
v®ue
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
dœeùÜy
, 
fe
);

336 ià(
v®ue
 =ğ
NULL
) {

338  
FALSE
;

340 ià(
	`¡rcmp
 (
v®ue
, 
Œue_v®
) == 0) {

341 *
»tv®
 = 
TRUE
;

343 *
»tv®
 = 
FALSE
;

345  
TRUE
;

346 
	}
}

348 
gboŞ—n


349 
	$h®_ut_£t_¡ršg_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
, cÚ¡ gch¬ *
dœeùÜy
, cÚ¡ gch¬ *
fe
)

351 
gch¬
 *
buf
;

352 
gboŞ—n
 
»t
;

354 
»t
 = 
FALSE
;

356 ià((
buf
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
dœeùÜy
, 
fe
)è!ğ
NULL
)

357 
»t
 = 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, 
key
, 
buf
);

359  
»t
;

360 
	}
}

362 
gboŞ—n


363 
	$h®_ut_£t_doubË_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
, cÚ¡ gch¬ *
dœeùÜy
, cÚ¡ gch¬ *
fe
)

365 
v®ue
;

366 
gch¬
 *
buf
, *
’d
;

367 
gboŞ—n
 
»t
;

369 
»t
 = 
FALSE
;

371 ià((
buf
 = 
	`h®_ut_g‘_¡ršg_äom_fe
 (
dœeùÜy
, 
fe
)è!ğ
NULL
) {

372 
”ºo
 = 0;

373 
v®ue
 = 
	`¡¹od
(
buf
, &
’d
);

374 ià(
”ºo
 !ğ
ERANGE
) {

375 
»t
 = 
	`h®_deviû_´İ”ty_£t_doubË
 (
d
, 
key
, 
v®ue
);

379  
»t
;

380 
	}
}

383 
	$h®_ut_make_udi_unique
 (
H®DeviûStÜe
 *
¡Üe
, 
gch¬
 *
udi
, 
gsize
 
udisize
, cÚ¡ *
Üigš®_udi
)

385 
i
;

387 ià(
	`h®_deviû_¡Üe_fšd
 (
¡Üe
, 
Üigš®_udi
è=ğ
NULL
) {

388 
	`g_¡¾ıy
 (
udi
, 
Üigš®_udi
, 
udisize
);

389 
out
;

392 
i
 = 0; ; i++) {

393 
	`g_¢´štf
 (
udi
, 
udisize
, "%s_%d", 
Üigš®_udi
, 
i
);

394 ià(
	`h®_deviû_¡Üe_fšd
 (
¡Üe
, 
udi
è=ğ
NULL
) {

395 
out
;

399 
out
:

401 
	}
}

404 
	$h®_ut_compu‹_udi_v®i¡
 (
H®DeviûStÜe
 *
¡Üe
, 
gch¬
 *
d¡
, 
gsize
 
d¡size
, cÚ¡ gch¬ *
fÜm©
, 
va_li¡
 
¬gs
)

406 
	`g_v¢´štf
 (
d¡
, 
d¡size
, 
fÜm©
, 
¬gs
);

408 
	`g_¡rÿnÚ
 (
d¡
,

413 
	}
}

417 
	$h®_ut_compu‹_udi
 (
H®DeviûStÜe
 *
¡Üe
, 
gch¬
 *
d¡
, 
gsize
 
d¡size
, cÚ¡ gch¬ *
fÜm©
, ...)

419 
va_li¡
 
¬gs
;

421 
	`va_¡¬t
 (
¬gs
, 
fÜm©
);

422 
	`h®_ut_compu‹_udi_v®i¡
 (
¡Üe
, 
d¡
, 
d¡size
, 
fÜm©
, 
¬gs
);

423 
	`va_’d
 (
¬gs
);

424 
	}
}

427 
	$h®_ut_v®id©e_udi
 (
gch¬
 *
udi
, 
gsize
 
size
) {

429 
’d
[
size
];

431 ià(
	`ssÿnf
 (
udi
, "/Üg/ä“desktİ/H®/deviûs/%s", 
’d
) == 1) {

432 ià(
	`¡r¡r
(
’d
, "/"è!ğ
NULL
) {

433 
	`HAL_DEBUG
 (("UDIƒnd cÚš šv®id ch¬ '/': '%s'", 
udi
));

435 
	`g_¡rÿnÚ
 (
’d
, "_"

439 
	`g_¢´štf
 (
udi
, 
size
, "/Üg/ä“desktİ/H®/deviûs/%s", 
’d
);

441 
	`HAL_DEBUG
 (("Fixed UDI,„•Ïûd '/',‚ew UDI: %s", 
udi
));

444 
	}
}

447 
gboŞ—n


448 
	$h®_ut_·th_asûnd
 (
gch¬
 *
·th
)

450 
gch¬
 *
p
;

452 ià(
·th
 =ğ
NULL
)

453  
FALSE
;

455 
p
 = 
	`¡¼chr
 (
·th
, '/');

456 ià(
p
 =ğ
NULL
)

457  
FALSE
;

459 *
p
 = '\0';

460  
TRUE
;

461 
	}
}

463 
gboŞ—n
 
	g_g»p_ÿn_»u£
 = 
FALSE
;

466 
	$h®_ut_g»p_disÿrd_exi¡šg_d©a
 ()

468 
_g»p_ÿn_»u£
 = 
FALSE
;

469 
	}
}

487 
gch¬
 *

488 
	$h®_ut_g»p_fe
 (cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
, cÚ¡ gch¬ *
lše¡¬t
, 
gboŞ—n
 
»u£
)

490 
gch¬
 
buf
[2048];

491 
bufsize
;

492 
gch¬
 
f’ame
[
HAL_PATH_MAX
];

493 
gch¬
 
Şdf’ame
[
HAL_PATH_MAX
];

494 
gch¬
 *
»suÉ
;

495 
gsize
 
lše¡¬t_Ën
;

496 
gch¬
 *
p
;

498 
»suÉ
 = 
NULL
;

504 ià(
fe
 !ğ
NULL
 && 
	`¡¾’
 (file) > 0)

505 
	`¢´štf
 (
f’ame
,  (f’ame), "%s/%s", 
dœeùÜy
, 
fe
);

507 
	`¡ºıy
 (
f’ame
, 
dœeùÜy
,  (filename));

509 ià(
_g»p_ÿn_»u£
 && 
»u£
 && 
	`¡rcmp
 (
Şdf’ame
, 
f’ame
) == 0) {

513 
FILE
 *
f
;

515 
f
 = 
	`fİ’
 (
f’ame
, "r");

516 ià(
f
 =ğ
NULL
)

517 
out
;

518 
bufsize
 = 
	`ä—d
 (
buf
,  (),  (bufè- 1, 
f
);

519 
buf
[
bufsize
] = '\0';

520 
	`fşo£
 (
f
);

526 
_g»p_ÿn_»u£
 = 
TRUE
;

527 
	`¡ºıy
 (
Şdf’ame
, 
f’ame
, (oldfilename));

529 
lše¡¬t_Ën
 = 
	`¡¾’
 (
lše¡¬t
);

532 
p
 = 
buf
;

534 
lš–’
;

535 
lše
[256];

537 
lš–’
 = 0; 
p
[linelen] != '\n' &&…[linelen] != '\0';†inelen++)

540 ià(
lš–’
 <  (
lše
)) {

542 
	`¡ºıy
 (
lše
, 
p
, 
lš–’
);

543 
lše
[
lš–’
] = '\0';

545 ià(
	`¡ºcmp
 (
lše
, 
lše¡¬t
, 
lše¡¬t_Ën
) == 0) {

546 
»suÉ
 = 
lše
 + 
lše¡¬t_Ën
;

547 
out
;

551 
p
 +ğ
lš–’
 + 1;

553 } 
p
 < 
buf
 + 
bufsize
);

555 
out
:

556  
»suÉ
;

557 
	}
}

573 
gch¬
 *

574 
	$h®_ut_g»p_fe_Ãxt_lše
 (cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
, cÚ¡ gch¬ *
lše¡¬t
, 
gboŞ—n
 
»u£
)

576 
gch¬
 
buf
[2048];

577 
bufsize
;

578 
gch¬
 
f’ame
[
HAL_PATH_MAX
];

579 
gch¬
 
Şdf’ame
[
HAL_PATH_MAX
];

580 
gch¬
 *
»suÉ
;

581 
gsize
 
lše¡¬t_Ën
;

582 
gch¬
 *
p
;

584 
»suÉ
 = 
NULL
;

590 ià(
fe
 !ğ
NULL
 && 
	`¡¾’
 (file) > 0)

591 
	`¢´štf
 (
f’ame
,  (f’ame), "%s/%s", 
dœeùÜy
, 
fe
);

593 
	`¡ºıy
 (
f’ame
, 
dœeùÜy
,  (filename));

595 ià(
_g»p_ÿn_»u£
 && 
»u£
 && 
	`¡rcmp
 (
Şdf’ame
, 
f’ame
) == 0) {

599 
FILE
 *
f
;

601 
f
 = 
	`fİ’
 (
f’ame
, "r");

602 ià(
f
 =ğ
NULL
)

603 
out
;

604 
bufsize
 = 
	`ä—d
 (
buf
,  (),  (bufè- 1, 
f
);

605 
buf
[
bufsize
] = '\0';

606 
	`fşo£
 (
f
);

612 
_g»p_ÿn_»u£
 = 
TRUE
;

613 
	`¡ºıy
 (
Şdf’ame
, 
f’ame
, (oldfilename));

615 
lše¡¬t_Ën
 = 
	`¡¾’
 (
lše¡¬t
);

618 
p
 = 
buf
;

620 
lš–’
;

621 
lše
[256];

623 
lš–’
 = 0; 
p
[linelen] != '\n' &&…[linelen] != '\0';†inelen++)

626 ià(
lš–’
 <  (
lše
)) {

628 
	`¡ºıy
 (
lše
, 
p
, 
lš–’
);

629 
lše
[
lš–’
] = '\0';

631 ià(
	`¡ºcmp
 (
lše
, 
lše¡¬t
, 
lše¡¬t_Ën
) == 0) {

633 
p
 +ğ
lš–’
 + 1;

634 ià(
p
 < 
buf
 + 
bufsize
) {

635 
lš–’
 = 0; 
p
[linelen] != '\n' &&…[linelen] != '\0';†inelen++)

637 
	`¡ºıy
 (
lše
, 
p
, 
lš–’
);

638 
lše
[
lš–’
] = '\0';

640 
»suÉ
 = 
lše
;

642 
out
;

646 
p
 +ğ
lš–’
 + 1;

648 } 
p
 < 
buf
 + 
bufsize
);

650 
out
:

651  
»suÉ
;

652 
	}
}

654 
gch¬
 *

655 
	$h®_ut_g»p_¡ršg_–em_äom_fe
 (cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
,

656 cÚ¡ 
gch¬
 *
lše¡¬t
, 
gušt
 
–em
, 
gboŞ—n
 
»u£
)

658 
gch¬
 *
lše
;

659 
gch¬
 *
»s
;

660 
gch¬
 
buf
[256];

661 
gch¬
 **
tok’s
;

662 
gušt
 
i
, 
j
;

664 
»s
 = 
NULL
;

665 
tok’s
 = 
NULL
;

667 ià(((
lše
 = 
	`h®_ut_g»p_fe
 (
dœeùÜy
, 
fe
, 
lše¡¬t
, 
»u£
)è=ğ
NULL
è|| (
	`¡¾’
 (line) == 0))

668 
out
;

671 ià(
–em
 =ğ
G_MAXUINT
) {

673 ià(
	`¡¾’
 (
lše
) < 2) {

674 
»s
 = 
NULL
;

675 
out
;

678 
lše
 = 
	`g_¡rchug
 (line + 1);

679 
	`¡ºıy
 (
buf
, 
lše
,  (buf));

680 
»s
 = 
buf
;

681 
out
;

684 
tok’s
 = 
	`g_¡r¥l™_£t
 (
lše
, " \t:", 0);

685 
i
 = 0, 
j
 = 0; 
tok’s
[i] !ğ
NULL
; i++) {

686 ià(
	`¡¾’
 (
tok’s
[
i
]) == 0)

688 ià(
j
 =ğ
–em
) {

689 
	`¡ºıy
 (
buf
, 
tok’s
[
i
],  (buf));

690 
»s
 = 
buf
;

691 
out
;

693 
j
++;

696 
out
:

697 ià(
tok’s
 !ğ
NULL
)

698 
	`g_¡rä“v
 (
tok’s
);

699  
»s
;

700 
	}
}

702 
gšt


703 
	$h®_ut_g»p_št_–em_äom_fe
 (cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
,

704 cÚ¡ 
gch¬
 *
lše¡¬t
, 
gušt
 
–em
, gušˆ
ba£
, 
gboŞ—n
 
»u£
)

706 
gch¬
 *
’d±r
;

707 
gch¬
 *
¡rv®ue
;

708 
v®ue
;

710 
v®ue
 = 
G_MAXINT
;

712 
¡rv®ue
 = 
	`h®_ut_g»p_¡ršg_–em_äom_fe
 (
dœeùÜy
, 
fe
, 
lše¡¬t
, 
–em
, 
»u£
);

713 ià(
¡rv®ue
 =ğ
NULL
)

714 
out
;

716 
v®ue
 = 
	`¡¹Ş
 (
¡rv®ue
, &
’d±r
, 
ba£
);

717 ià(
’d±r
 =ğ
¡rv®ue
) {

718 
v®ue
 = 
G_MAXINT
;

719 
out
;

722 
out
:

723  
v®ue
;

724 
	}
}

752 
gboŞ—n


753 
	$h®_ut_£t_¡ršg_–em_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
,

754 cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
,

755 cÚ¡ 
gch¬
 *
lše¡¬t
, 
gušt
 
–em
, 
gboŞ—n
 
»u£
)

757 
gboŞ—n
 
»s
;

758 
gch¬
 *
v®ue
;

760 
»s
 = 
FALSE
;

762 ià((
v®ue
 = 
	`h®_ut_g»p_¡ršg_–em_äom_fe
 (
dœeùÜy
, 
fe
, 
lše¡¬t
, 
–em
, 
»u£
)è=ğ
NULL
)

763 
out
;

765 
»s
 = 
	`h®_deviû_´İ”ty_£t_¡ršg
 (
d
, 
key
, 
v®ue
);

766 
out
:

767  
»s
;

768 
	}
}

795 
gboŞ—n


796 
	$h®_ut_£t_št_–em_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
,

797 cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
,

798 cÚ¡ 
gch¬
 *
lše¡¬t
, 
gušt
 
–em
, gušˆ
ba£
, 
gboŞ—n
 
»u£
)

800 
gch¬
 *
’d±r
;

801 
gboŞ—n
 
»s
;

802 
gch¬
 *
¡rv®ue
;

803 
v®ue
;

805 
»s
 = 
FALSE
;

807 
¡rv®ue
 = 
	`h®_ut_g»p_¡ršg_–em_äom_fe
 (
dœeùÜy
, 
fe
, 
lše¡¬t
, 
–em
, 
»u£
);

808 ià(
¡rv®ue
 =ğ
NULL
)

809 
out
;

811 
v®ue
 = 
	`¡¹Ş
 (
¡rv®ue
, &
’d±r
, 
ba£
);

812 ià(
’d±r
 =ğ
¡rv®ue
)

813 
out
;

815 
»s
 = 
	`h®_deviû_´İ”ty_£t_št
 (
d
, 
key
, 
v®ue
);

817 
out
:

818  
»s
;

820 
	}
}

855 
gboŞ—n


856 
	$h®_ut_£t_boŞ_–em_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
,

857 cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
,

858 cÚ¡ 
gch¬
 *
lše¡¬t
, 
gušt
 
–em
, cÚ¡ gch¬ *
ex³ùed
, 
gboŞ—n
 
»u£
)

860 
gch¬
 *
lše
;

861 
gboŞ—n
 
»s
;

862 
gch¬
 **
tok’s
;

863 
gušt
 
i
, 
j
;

865 
»s
 = 
FALSE
;

866 
tok’s
 = 
NULL
;

868 ià(((
lše
 = 
	`h®_ut_g»p_fe
 (
dœeùÜy
, 
fe
, 
lše¡¬t
, 
»u£
)è=ğ
NULL
è|| (
	`¡¾’
 (line) == 0))

869 
out
;

871 
tok’s
 = 
	`g_¡r¥l™_£t
 (
lše
, " \t:", 0);

873 
i
 = 0, 
j
 = 0; 
tok’s
[i] !ğ
NULL
; i++) {

874 ià(
	`¡¾’
 (
tok’s
[
i
]) == 0)

876 ià(
j
 =ğ
–em
) {

877 
	`h®_deviû_´İ”ty_£t_boŞ
 (
d
, 
key
, 
	`¡rcmp
 (
tok’s
[
i
], 
ex³ùed
) == 0);

878 
»s
 = 
TRUE
;

879 
out
;

881 
j
++;

885 
out
:

886 ià(
tok’s
 !ğ
NULL
)

887 
	`g_¡rä“v
 (
tok’s
);

889  
»s
;

890 
	}
}

892 
gch¬
 **

893 
	$h®_ut_dup_¡rv_äom_g_¦i¡
 (
GSLi¡
 *
¡¾i¡
)

895 
gušt
 
j
;

896 
gušt
 
Ën
;

897 
gch¬
 **
¡rv
;

898 
GSLi¡
 *
i
;

900 
Ën
 = 
	`g_¦i¡_Ëngth
 (
¡¾i¡
);

901 
¡rv
 = 
	`g_Ãw
 (*, 
Ën
 + 1);

903 
i
 = 
¡¾i¡
, 
j
 = 0; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i), j++) {

904 
¡rv
[
j
] = 
	`g_¡rdup
 ((cÚ¡ 
gch¬
 *è
i
->
d©a
);

906 
¡rv
[
j
] = 
NULL
;

908  
¡rv
;

909 
	}
}

914 
H®Deviû
 *
	md
;

915 
gch¬
 **
	m´og¿ms
;

916 
gch¬
 **
	mexŒa_’v
;

917 
gušt
 
	mÃxt_´og¿m
;

919 
H®C®loutsDÚe
 
	mÿÎback
;

920 
gpoš‹r
 
	mu£rd©a1
;

921 
gpoš‹r
 
	mu£rd©a2
;

923 } 
	tC®lout
;

925 
ÿÎout_do_Ãxt
 (
C®lout
 *
c
);

928 
	$ÿÎout_‹rmš©ed
 (
H®Deviû
 *
d
, 
gušt32
 
ex™_ty³
,

929 
gšt
 
»tuº_code
, 
gch¬
 **
”rÜ
,

930 
gpoš‹r
 
d©a1
, gpoš‹¸
d©a2
)

932 
C®lout
 *
c
;

934 
c
 = (
C®lout
 *è
d©a1
;

935 
	`ÿÎout_do_Ãxt
 (
c
);

936 
	}
}

939 
	$ÿÎout_do_Ãxt
 (
C®lout
 *
c
)

943 ià(
c
->
´og¿ms
[c->
Ãxt_´og¿m
] =ğ
NULL
) {

944 
H®Deviû
 *
d
;

945 
gpoš‹r
 
u£rd©a1
;

946 
gpoš‹r
 
u£rd©a2
;

947 
H®C®loutsDÚe
 
ÿÎback
;

949 
d
 = 
c
->d;

950 
u£rd©a1
 = 
c
->userdata1;

951 
u£rd©a2
 = 
c
->userdata2;

952 
ÿÎback
 = 
c
->callback;

954 
	`g_¡rä“v
 (
c
->
´og¿ms
);

955 
	`g_¡rä“v
 (
c
->
exŒa_’v
);

956 
	`g_ä“
 (
c
);

958 ià(
ÿÎback
 !ğ
NULL
) {

959 
	`ÿÎback
 (
d
, 
u£rd©a1
, 
u£rd©a2
);

963 
	`h®d_ruÂ”_run
(
c
->
d
, c->
´og¿ms
[c->
Ãxt_´og¿m
], c->
exŒa_’v
,

964 
HAL_HELPER_TIMEOUT
, 
ÿÎout_‹rmš©ed
,

965 (
gpoš‹r
)
c
, 
NULL
);

966 
c
->
Ãxt_´og¿m
++;

968 
	}
}

971 
	$h®_ÿÎout_deviû
 (
H®Deviû
 *
d
, 
H®C®loutsDÚe
 
ÿÎback
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
,

972 **
´og¿ms
, 
gch¬
 **
exŒa_’v
)

974 
C®lout
 *
c
;

976 
c
 = 
	`g_Ãw0
 (
C®lout
, 1);

977 
c
->
d
 = d;

978 
c
->
ÿÎback
 = callback;

979 
c
->
u£rd©a1
 = userdata1;

980 
c
->
u£rd©a2
 = userdata2;

981 
c
->
´og¿ms
 =…rograms;

982 
c
->
exŒa_’v
 = 
	`g_¡rdupv
 (extra_env);

983 
c
->
Ãxt_´og¿m
 = 0;

985 
	`ÿÎout_do_Ãxt
 (
c
);

986 
	}
}

989 
	$h®_ut_ÿÎout_deviû_add
 (
H®Deviû
 *
d
, 
H®C®loutsDÚe
 
ÿÎback
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

991 **
´og¿ms
;

992 
gch¬
 *
exŒa_’v
[2] = {"HALD_ACTION÷dd", 
NULL
};

994 
´og¿ms
 = 
	`h®_deviû_´İ”ty_dup_¡¾i¡_as_¡rv
 (
d
, "info.callouts.add");

995 ià(
´og¿ms
 =ğ
NULL
) {

996 
	`ÿÎback
 (
d
, 
u£rd©a1
, 
u£rd©a2
);

997 
out
;

1001 
	`HAL_INFO
 (("Add c®lout fÜ udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1003 
	`h®_ÿÎout_deviû
 (
d
, 
ÿÎback
, 
u£rd©a1
, 
u£rd©a2
, 
´og¿ms
, 
exŒa_’v
);

1004 
out
:

1006 
	}
}

1009 
	$h®_ut_ÿÎout_deviû_»move
 (
H®Deviû
 *
d
, 
H®C®loutsDÚe
 
ÿÎback
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

1011 **
´og¿ms
;

1012 
gch¬
 *
exŒa_’v
[2] = {"HALD_ACTIONôemove", 
NULL
};

1014 
´og¿ms
 = 
	`h®_deviû_´İ”ty_dup_¡¾i¡_as_¡rv
 (
d
, "info.callouts.remove");

1015 ià(
´og¿ms
 =ğ
NULL
) {

1016 
	`ÿÎback
 (
d
, 
u£rd©a1
, 
u£rd©a2
);

1017 
out
;

1020 
	`HAL_INFO
 (("RemovÿÎout fÜ udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1022 
	`h®_ÿÎout_deviû
 (
d
, 
ÿÎback
, 
u£rd©a1
, 
u£rd©a2
, 
´og¿ms
, 
exŒa_’v
);

1023 
out
:

1025 
	}
}

1028 
	$h®_ut_ÿÎout_deviû_´•robe
 (
H®Deviû
 *
d
, 
H®C®loutsDÚe
 
ÿÎback
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
)

1030 **
´og¿ms
;

1031 
gch¬
 *
exŒa_’v
[2] = {"HALD_ACTIONõ»´obe", 
NULL
};

1033 
´og¿ms
 = 
	`h®_deviû_´İ”ty_dup_¡¾i¡_as_¡rv
 (
d
, "info.callouts.preprobe");

1034 ià(
´og¿ms
 =ğ
NULL
) {

1035 
	`ÿÎback
 (
d
, 
u£rd©a1
, 
u£rd©a2
);

1036 
out
;

1039 
	`HAL_INFO
 (("P»´obÿÎout fÜ udi=%s", 
	`h®_deviû_g‘_udi
 (
d
)));

1041 
	`h®_ÿÎout_deviû
 (
d
, 
ÿÎback
, 
u£rd©a1
, 
u£rd©a2
, 
´og¿ms
, 
exŒa_’v
);

1042 
out
:

1044 
	}
}

1047 
	$h®_ut_hexdump
 (cÚ¡ *
mem
, 
size
)

1049 
i
;

1050 
j
;

1051 
n
;

1052 cÚ¡ *
buf
 = (cÚ¡ *è
mem
;

1054 
n
 = 0;

1055 
	`´štf
 ("Dumpšg %u=0x%x by‹s\n", 
size
, size);

1056 
n
 < 
size
) {

1058 
	`´štf
 ("0x%04x: ", 
n
);

1060 
j
 = 
n
;

1061 
i
 = 0; i < 16; i++) {

1062 ià(
j
 >ğ
size
)

1064 
	`´štf
 ("%02x ", 
buf
[
j
]);

1065 
j
++;

1068  ; 
i
 < 16; i++) {

1069 
	`´štf
 (" ");

1072 
	`´štf
 (" ");

1074 
j
 = 
n
;

1075 
i
 = 0; i < 16; i++) {

1076 ià(
j
 >ğ
size
)

1078 
	`´štf
 ("%c", 
	`i¥ršt
(
buf
[
j
]) ? buf[j] : '.');

1079 
j
++;

1082 
	`´štf
 ("\n");

1084 
n
 += 16;

1086 
	}
}

1088 
gboŞ—n


1089 
	$h®_ut_is_mouÁed_by_h®d
 (cÚ¡ *
mouÁ_pošt
)

1091 
i
;

1092 
FILE
 *
h®_mb
;

1093 
h®_mb_Ën
;

1094 
num_»ad
;

1095 *
h®_mb_buf
;

1096 **
lšes
;

1097 
gboŞ—n
 
found
;

1099 
h®_mb
 = 
NULL
;

1100 
h®_mb_buf
 = 
NULL
;

1101 
found
 = 
FALSE
;

1105 
h®_mb
 = 
	`fİ’
 ("/media/.hal-mtab", "r");

1106 ià(
h®_mb
 =ğ
NULL
) {

1107 
	`HAL_ERROR
 (("Cannot open /media/.hal-mtab"));

1108 
out
;

1110 ià(
	`f£ek
 (
h®_mb
, 0L, 
SEEK_END
) != 0) {

1111 
	`HAL_ERROR
 (("Cannot seekoƒnd of /media/.hal-mtab"));

1112 
out
;

1114 
h®_mb_Ën
 = 
	`á–l
 (
h®_mb
);

1115 ià(
h®_mb_Ën
 < 0) {

1116 
	`HAL_ERROR
 (("Cannot determine size of /media/.hal-mtab"));

1117 
out
;

1119 
	`»wšd
 (
h®_mb
);

1121 
h®_mb_buf
 = 
	`g_Ãw0
 (, 
h®_mb_Ën
 + 1);

1122 
num_»ad
 = 
	`ä—d
 (
h®_mb_buf
, 1, 
h®_mb_Ën
, 
h®_mb
);

1123 ià(
num_»ad
 !ğ
h®_mb_Ën
) {

1124 
	`HAL_ERROR
 (("Cannot„ead from /media/.hal-mtab"));

1125 
out
;

1127 
	`fşo£
 (
h®_mb
);

1128 
h®_mb
 = 
NULL
;

1132 
lšes
 = 
	`g_¡r¥l™
 (
h®_mb_buf
, "\n", 0);

1133 
	`g_ä“
 (
h®_mb_buf
);

1134 
h®_mb_buf
 = 
NULL
;

1137 
i
 = 0; 
lšes
[i] !ğ
NULL
 && !
found
; i++) {

1138 **
lše_–em’ts
;

1142 ià((
lšes
[
i
])[0] == '#')

1145 
lše_–em’ts
 = 
	`g_¡r¥l™
 (
lšes
[
i
], "\t", 6);

1146 ià(
	`g_¡rv_Ëngth
 (
lše_–em’ts
) == 6) {

1157 ià(
	`¡rcmp
 (
lše_–em’ts
[5], 
mouÁ_pošt
) == 0) {

1158 
found
 = 
TRUE
;

1164 
	`g_¡rä“v
 (
lše_–em’ts
);

1167 
	`g_¡rä“v
 (
lšes
);

1169 
out
:

1170 ià(
h®_mb
 !ğ
NULL
)

1171 
	`fşo£
 (
h®_mb
);

1172 ià(
h®_mb_buf
 !ğ
NULL
)

1173 
	`g_ä“
 (
h®_mb_buf
);

1175  
found
;

1176 
	}
}

1179 
gch¬
 
	g·th_bufãr
 [
HAL_PATH_MAX
];

1182 
	$h®_ut_»adlšk
 (cÚ¡ *
lšk
)

1184 
	`mem£t
 (
·th_bufãr
, 0, 
HAL_PATH_MAX
);

1185 if(
	`»adlšk
(
lšk
, 
·th_bufãr
, 
HAL_PATH_MAX
-1) < 0)

1186  
NULL
;

1188  
·th_bufãr
;

1189 
	}
}

1191 
gboŞ—n


1192 
	$is_v®id_š‹rçû_Çme
 (cÚ¡ *
Çme
) {

1194 cÚ¡ *
’d
;

1195 cÚ¡ *
Ï¡_dÙ
;

1197 
Ï¡_dÙ
 = 
NULL
;

1199 ià(
	`¡¾’
(
Çme
) == 0)

1200  
FALSE
;

1202 
’d
 = 
Çme
 + 
	`¡¾’
(name);

1204 ià(*
Çme
 == '.')

1205  
FALSE
;

1206 ià(!
	`VALID_INITIAL_NAME_CHARACTER
 (*
Çme
))

1207  
FALSE
;

1209 ++
Çme
;

1211 
Çme
 !ğ
’d
) {

1212 ià(*
Çme
 == '.') {

1213 ià((
Çme
 + 1è=ğ
’d
)

1214  
FALSE
;

1215 ià(!
	`VALID_INITIAL_NAME_CHARACTER
 (*(
Çme
 + 1)))

1216  
FALSE
;

1217 
Ï¡_dÙ
 = 
Çme
;

1218 ++
Çme
;

1220 ià(!
	`VALID_NAME_CHARACTER
 (*
Çme
)) {

1221  
FALSE
;

1223 ++
Çme
;

1225 ià(
Ï¡_dÙ
 =ğ
NULL
)

1226  
FALSE
;

1228  
TRUE
;

1229 
	}
}

	@hald/util.h

26 #iâdeà
UTIL_H


27 
	#UTIL_H


	)

29 
	~"deviû.h
"

30 
	~"deviû_¡Üe.h
"

32 #iâdeà
__FUNCTION__


33 
	#__FUNCTION__
 
__func__


	)

36 #iâdeà
__GNUC__


37 
	#__©Œibu‹__
(
x
)

	)

40 
	#HAL_NAME_MAX
 256

	)

41 
	#HAL_PATH_MAX
 512

	)

43 
gboŞ—n
 
h®_ut_»move_Œašg_¦ash
 (
gch¬
 *
·th
);

45 cÚ¡ 
gch¬
 *
h®_ut_g‘_Ï¡_–em’t
 (cÚ¡ gch¬ *
s
);

47 
gch¬
 *
h®_ut_g‘_·»Á_·th
 (cÚ¡ gch¬ *
·th
);

49 
gch¬
 *
h®_ut_g‘_nÜm®ized_·th
 (cÚ¡ gch¬ *
·th1
, cÚ¡ gch¬ *
·th2
);

51 
gboŞ—n
 
h®_ut_g‘_št_äom_fe
 (cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
, 
gšt
 *
»suÉ
, gšˆ
ba£
);

53 
gboŞ—n
 
h®_ut_£t_št_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
, cÚ¡ gch¬ *
dœeùÜy
, cÚ¡ gch¬ *
fe
, 
gšt
 
ba£
);

55 
gboŞ—n
 
h®_ut_g‘_ušt64_äom_fe
 (cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
, 
gušt64
 *
»suÉ
, 
gšt
 
ba£
);

57 
gboŞ—n
 
h®_ut_£t_ušt64_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
, cÚ¡ gch¬ *
dœeùÜy
, cÚ¡ gch¬ *
fe
, 
gšt
 
ba£
);

59 
gch¬
 *
h®_ut_g‘_¡ršg_äom_fe
 (cÚ¡ gch¬ *
dœeùÜy
, cÚ¡ gch¬ *
fe
);

61 
gboŞ—n
 
h®_ut_g‘_boŞ_äom_fe
 (cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
, gboŞ—À*
»tv®
, cÚ¡ *
Œue_v®
);

63 
gboŞ—n
 
h®_ut_£t_¡ršg_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
, cÚ¡ gch¬ *
dœeùÜy
, cÚ¡ gch¬ *
fe
);

65 
gboŞ—n
 
h®_ut_£t_doubË_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
, cÚ¡ gch¬ *
dœeùÜy
, cÚ¡ gch¬ *
fe
);

67 
h®_ut_make_udi_unique
 (
H®DeviûStÜe
 *
¡Üe
, 
gch¬
 *
udi
, 
gsize
 
udisize
, cÚ¡ *
Üigš®_udi
);

69 
h®_ut_compu‹_udi_v®i¡
 (
H®DeviûStÜe
 *
¡Üe
, 
gch¬
 *
d¡
, 
gsize
 
d¡size
, cÚ¡ gch¬ *
fÜm©
, 
va_li¡
 
¬gs
);

71 
h®_ut_compu‹_udi
 (
H®DeviûStÜe
 *
¡Üe
, 
gch¬
 *
d¡
, 
gsize
 
d¡size
, cÚ¡ gch¬ *
fÜm©
, ...);

73 
h®_ut_v®id©e_udi
 (
gch¬
 *
udi
, 
gsize
 
size
);

75 
gboŞ—n
 
h®_ut_·th_asûnd
 (
gch¬
 *
·th
);

77 
h®_ut_g»p_disÿrd_exi¡šg_d©a
 ();

79 
gch¬
 *
h®_ut_g»p_fe
 (cÚ¡ gch¬ *
dœeùÜy
, cÚ¡ gch¬ *
fe
, cÚ¡ gch¬ *
lše¡¬t
, 
gboŞ—n
 
»u£
);

80 
gch¬
 *
h®_ut_g»p_fe_Ãxt_lše
 (cÚ¡ gch¬ *
dœeùÜy
, cÚ¡ gch¬ *
fe
, cÚ¡ gch¬ *
lše¡¬t
, 
gboŞ—n
 
»u£
);

82 
gšt
 
h®_ut_g»p_št_–em_äom_fe
 (cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
,

83 cÚ¡ 
gch¬
 *
lše¡¬t
, 
gušt
 
–em
, gušˆ
ba£
, 
gboŞ—n
 
»u£_fe
);

85 
gch¬
 *
h®_ut_g»p_¡ršg_–em_äom_fe
 (cÚ¡ gch¬ *
dœeùÜy
, cÚ¡ gch¬ *
fe
,

86 cÚ¡ 
gch¬
 *
lše¡¬t
, 
gušt
 
–em
, 
gboŞ—n
 
»u£_fe
);

88 
gboŞ—n
 
h®_ut_£t_¡ršg_–em_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
,

89 cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
,

90 cÚ¡ 
gch¬
 *
lše¡¬t
, 
gušt
 
–em
, 
gboŞ—n
 
»u£_fe
);

92 
gboŞ—n
 
h®_ut_£t_št_–em_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
,

93 cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
,

94 cÚ¡ 
gch¬
 *
lše¡¬t
, 
gušt
 
–em
, gušˆ
ba£
, 
gboŞ—n
 
»u£_fe
);

96 
gboŞ—n
 
h®_ut_£t_boŞ_–em_äom_fe
 (
H®Deviû
 *
d
, cÚ¡ 
gch¬
 *
key
,

97 cÚ¡ 
gch¬
 *
dœeùÜy
, cÚ¡ gch¬ *
fe
,

98 cÚ¡ 
gch¬
 *
lše¡¬t
, 
gušt
 
–em
, cÚ¡ gch¬ *
ex³ùed
,

99 
gboŞ—n
 
»u£_fe
);

101 
gch¬
 **
h®_ut_dup_¡rv_äom_g_¦i¡
 (
GSLi¡
 *
¡¾i¡
);

103 (*
	tH®C®loutsDÚe
è(
	tH®Deviû
 *
	td
, 
	tgpoš‹r
 
	tu£rd©a1
, gpoš‹¸
	tu£rd©a2
);

105 
	`h®_ÿÎout_deviû
 (
H®Deviû
 *
d
, 
H®C®loutsDÚe
 
ÿÎback
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
,

106 **
´og¿ms
, 
gch¬
 **
exŒa_’v
);

108 
	`h®_ut_ÿÎout_deviû_add
 (
H®Deviû
 *
d
, 
H®C®loutsDÚe
 
ÿÎback
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
);

109 
	`h®_ut_ÿÎout_deviû_»move
 (
H®Deviû
 *
d
, 
H®C®loutsDÚe
 
ÿÎback
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
);

110 
	`h®_ut_ÿÎout_deviû_´•robe
 (
H®Deviû
 *
d
, 
H®C®loutsDÚe
 
ÿÎback
, 
gpoš‹r
 
u£rd©a1
, gpoš‹¸
u£rd©a2
);

112 
	`h®_ut_hexdump
 (cÚ¡ *
buf
, 
size
);

114 
gboŞ—n
 
	`h®_ut_is_mouÁed_by_h®d
 (cÚ¡ *
mouÁ_pošt
);

116 *
	`h®_ut_»adlšk
 (cÚ¡ *
lšk
);

118 
gboŞ—n
 
	`is_v®id_š‹rçû_Çme
 (cÚ¡ *
Çme
);

	@hald/util_helper.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<g½.h
>

30 
	~<¡d¬g.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ršg.h
>

33 
	~<sys/time.h
>

34 
	~<time.h
>

35 
	~<pwd.h
>

36 
	~<uni¡d.h
>

38 
	~<glib.h
>

40 
	~"logg”.h
"

42 
	~"ut_h–³r.h
"

44 #ifdeà
__lšux__


45 **
’vœÚ
;

48 **
	g¬gv_bufãr
 = 
NULL
;

49 
size_t
 
	g¬gv_size
 = 0;

51 #ifdeà
sun


52 
	~<´iv.h
>

54 
	$drİ_´iveges
 (
k“p_auxgroups
)

56 
´iv_£t_t
 *
pPrivS‘
 = 
NULL
;

57 
´iv_£t_t
 *
lPrivS‘
 = 
NULL
;

63 ià((
pPrivS‘
 = 
	`´iv_¡r_to_£t
("basic", ",", 
NULL
)) == NULL) {

68 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_FILE_LINK_ANY
);

69 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_PROC_INFO
);

70 (è
	`´iv_d–£t
(
pPrivS‘
, 
PRIV_PROC_SESSION
);

73 (è
	`´iv_add£t
(
pPrivS‘
, 
PRIV_SYS_CONFIG
);

76 ià(
	`£´iv
(
PRIV_SET
, 
PRIV_PERMITTED
, 
pPrivS‘
) != 0) {

81 ià((
lPrivS‘
 = 
	`´iv_®loc£t
()è=ğ
NULL
) {

85 
	`´iv_em±y£t
(
lPrivS‘
);

87 ià(
	`£´iv
(
PRIV_SET
, 
PRIV_LIMIT
, 
lPrivS‘
) != 0) {

91 
	`´iv_ä“£t
(
lPrivS‘
);

92 
	}
}

99 
	$drİ_´iveges
 (
k“p_auxgroups
)

101 
·sswd
 *
pw
 = 
NULL
;

102 
group
 *
gr
 = 
NULL
;

105 
pw
 = 
	`g‘pwÇm
 (
HAL_USER
);

106 ià(!
pw
) {

107 
	`HAL_DEBUG
 (("drİ_´iveges: u£¸" 
HAL_USER
 " does‚otƒxist"));

108 
	`ex™
 (-1);

112 
gr
 = 
	`g‘gºam
 (
HAL_GROUP
);

113 ià(!
gr
) {

114 
	`HAL_DEBUG
 (("drİ_´iveges: grou°" 
HAL_GROUP
 " does‚otƒxist"));

115 
	`ex™
 (-1);

118 ià(
k“p_auxgroups
) {

119 ià(
	`š™groups
 (
HAL_USER
, 
gr
->
gr_gid
)) {

120 
	`HAL_DEBUG
(("drop_privileges: could‚ot initialize groups"));

121 
	`ex™
 (-1);

125 ià(
	`£tgid
 (
gr
->
gr_gid
)) {

126 
	`HAL_DEBUG
 (("drop_privileges: could‚ot set group id"));

127 
	`ex™
 (-1);

130 ià(
	`£tuid
 (
pw
->
pw_uid
)) {

131 
	`HAL_DEBUG
 (("drop_privileges: could‚ot set user id"));

132 
	`ex™
 (-1);

134 
	}
}

138 
	$h®_£t_´oc_t™Ë_š™
 (
¬gc
, *
¬gv
[])

140 #ifdeà
__lšux__


141 
i
;

142 **
Ãw_’vœÚ
, *
’d±r
;

148 
i
 = 0; 
’vœÚ
[i] !ğ
NULL
; i++)

151 
’d±r
 = 
i
 ? 
’vœÚ
[i-1] + 
	`¡¾’
 (’vœÚ[i-1]è: 
¬gv
[
¬gc
-1] + strlen (argv[argc-1]);

153 
¬gv_bufãr
 = 
¬gv
;

154 
¬gv_size
 = 
’d±r
 - 
¬gv_bufãr
[0];

158 
Ãw_’vœÚ
 = 
	`m®loc
 ((*è* (
i
 + 1));

159 
i
 = 0; 
’vœÚ
[i] !ğ
NULL
; i++)

160 
Ãw_’vœÚ
[
i
] = 
	`¡rdup
 (
’vœÚ
[i]);

161 
Ãw_’vœÚ
[
i
] = 
NULL
;

163 
’vœÚ
 = 
Ãw_’vœÚ
;

165 
	}
}

169 
	$h®_£t_´oc_t™Ë
 (cÚ¡ *
fÜm©
, ...)

171 #ifdeà
__lšux__


172 
size_t
 
Ën
;

173 
va_li¡
 
­
;

175 ià(
¬gv_bufãr
 =ğ
NULL
)

176 
out
;

178 
	`va_¡¬t
 (
­
, 
fÜm©
);

179 
	`v¢´štf
 (
¬gv_bufãr
[0], 
¬gv_size
, 
fÜm©
, 
­
);

180 
	`va_’d
 (
­
);

182 
Ën
 = 
	`¡¾’
 (
¬gv_bufãr
[0]);

184 
	`mem£t
 (
¬gv_bufãr
[0] + 
Ën
, 0, 
¬gv_size
 -†en);

185 
¬gv_bufãr
[1] = 
NULL
;

186 
out
:

189 
	}
}

191 
gch¬
 *

192 
	$h®_ut_¡rdup_v®id_utf8
 (cÚ¡ *
¡r
)

194 *
’dch¬
;

195 *
Ãw¡r
;

196 
couÁ
 = 0;

198 ià(
¡r
 =ğ
NULL
)

199  
NULL
;

201 
Ãw¡r
 = 
	`g_¡rdup
 (
¡r
);

203 !
	`g_utf8_v®id©e
 (
Ãw¡r
, -1, (cÚ¡ **è&
’dch¬
)) {

204 *
’dch¬
 = '?';

205 
couÁ
++;

208 ià(
	`¡¾’
(
Ãw¡r
è=ğ
couÁ
) {

209 
	`g_ä“
 (
Ãw¡r
);

210  
NULL
;

212  
Ãw¡r
;

214 
	}
}

	@hald/util_helper.h

26 #iâdeà
UTIL_HELPER_H


27 
	#UTIL_HELPER_H


	)

29 
	~<glib.h
>

31 
drİ_´iveges
 (
k“p_auxgroups
);

32 
h®_£t_´oc_t™Ë_š™
 (
¬gc
, *
¬gv
[]);

33 
h®_£t_´oc_t™Ë
 (cÚ¡ *
fÜm©
, ...);

34 
gch¬
 *
h®_ut_¡rdup_v®id_utf8
 (cÚ¡ *
¡r
);

	@hald/util_helper_priv.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<¡dlib.h
>

31 
	~<¡ršg.h
>

32 
	~<uni¡d.h
>

34 
	~"ut_h–³r_´iv.h
"

36 
gboŞ—n


37 
	$check_´iv
 (
LibH®CÚ‹xt
 *
h®ùx
, 
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, cÚ¡ *
udi
, cÚ¡ *
aùiÚ
)

38 #ifdeà
HAVE_POLKIT


40 
gboŞ—n
 
»t
;

41 *
pŞk™_»suÉ
;

42 cÚ¡ *
švoked_by_syscÚ_Çme
;

43 
DBusMes§ge
 *
»¶y
;

44 
DBusE¼Ü
 
”rÜ
;

46 
»t
 = 
FALSE
;

47 
pŞk™_»suÉ
 = 
NULL
;

49 
švoked_by_syscÚ_Çme
 = 
	`dbus_mes§ge_g‘_£nd”
 (
mes§ge
);

51 
	`dbus_”rÜ_š™
 (&
”rÜ
);

52 
pŞk™_»suÉ
 = 
	`libh®_deviû_is_ÿÎ”_´iveged
 (
h®ùx
,

53 
udi
,

54 
aùiÚ
,

55 
švoked_by_syscÚ_Çme
,

56 &
”rÜ
);

57 ià(
pŞk™_»suÉ
 =ğ
NULL
) {

58 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ_´štf
 (
mes§ge
,

61 
aùiÚ
, 
pŞk™_»suÉ
);

62 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

63 
out
;

65 ià(
	`¡rcmp
 (
pŞk™_»suÉ
, "yes") != 0) {

67 
»¶y
 = 
	`dbus_mes§ge_Ãw_”rÜ_´štf
 (
mes§ge
,

70 
aùiÚ
, 
pŞk™_»suÉ
);

71 
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
);

72 
out
;

75 
»t
 = 
TRUE
;

77 
out
:

78 ià(
pŞk™_»suÉ
 !ğ
NULL
)

79 
	`libh®_ä“_¡ršg
 (
pŞk™_»suÉ
);

80  
»t
;

81 
	}
}

84  
	gTRUE
;

	@hald/util_helper_priv.h

25 #iâdeà
UTIL_HELPER_PRIV_H


26 
	#UTIL_HELPER_PRIV_H


	)

28 
	~<glib.h
>

29 
	~"../libh®/libh®.h
"

31 
gboŞ—n
 
check_´iv
 ( 
LibH®CÚ‹xt
 *
h®ùx
, 
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
mes§ge
, cÚ¡ *
udi
, cÚ¡ *
aùiÚ
);

	@hald/util_pm.c

27 
	~<¡dio.h
>

28 
	~<¡ršg.h
>

29 
	~<time.h
>

30 
	~<ùy³.h
>

31 
	~<¡dšt.h
>

33 
	~<glib.h
>

35 
	~"logg”.h
"

37 
	~"ut_pm.h
"

40 
	mÏ¡_Ëv–
;

41 
	mÏ¡_ch¬geR©e
;

42 
	mhigh_time_w¬n_couÁ
;

43 
time_t
 
	mÏ¡_time
;

44 } 
	tb©‹ryInfo
;

46 
GHashTabË
 *
	g§ved_b©‹ry_šfo
 = 
NULL
;

60 
	$ut_g‘_b©‹ry_‹chnŞogy
 (cÚ¡ *
ty³
)

62 ià(
ty³
 =ğ
NULL
) {

66 ià(
	`¡rÿ£cmp
 (
ty³
, "li-ion") == 0 ||

67 
	`¡rÿ£cmp
 (
ty³
, "lion") == 0) {

70 ià(
	`¡rÿ£cmp
 (
ty³
, "pb") == 0 ||

71 
	`¡rÿ£cmp
 (
ty³
, "pbac") == 0) {

74 ià(
	`¡rÿ£cmp
 (
ty³
, "lip") == 0 ||

75 
	`¡rÿ£cmp
 (
ty³
, "lipo") == 0) {

78 ià(
	`¡rÿ£cmp
 (
ty³
, "nimh") == 0) {

81 ià(
	`¡rÿ£cmp
 (
ty³
, "lifo") == 0) {

85 
	}
}

104 
	$ut_compu‹_time_»maššg
 (cÚ¡ *
id
,

105 
ch¬geR©e
,

106 
ch¬geLev–
,

107 
ch¬geLa¡FuÎ
,

108 
gboŞ—n
 
isDisch¬gšg
,

109 
gboŞ—n
 
isCh¬gšg
,

110 
gboŞ—n
 
guessCh¬geR©e
)

112 
»maššg_time
 = 0;

115 ià(
ch¬geR©e
 < 0 || 
ch¬geLev–
 < 0 || 
ch¬geLa¡FuÎ
 < 0) {

116 
	`HAL_WARNING
 (("chargeRate, chargeLevel or chargeLastFull < 0,„eturning -1"));

120 ià(
isDisch¬gšg
 && 
isCh¬gšg
) {

121 
	`HAL_WARNING
 (("isDischarging & isCharging TRUE,„eturning -1"));

129 ià(
ch¬geR©e
 =ğ0 || 
guessCh¬geR©e
) {

130 
b©‹ryInfo
 *
b©‹ry_šfo
;

131 
time_t
 
cur_time
 = 
	`time
(
NULL
);

134 ià(!
§ved_b©‹ry_šfo
)

135 
§ved_b©‹ry_šfo
 = 
	`g_hash_bË_Ãw
(
g_¡r_hash
, 
g_¡r_equ®
);

137 ià((
b©‹ry_šfo
 = 
	`g_hash_bË_lookup
(
§ved_b©‹ry_šfo
, 
id
))) {

139 ià((
cur_time
 =ğ
b©‹ry_šfo
->
Ï¡_time
è|| (
ch¬geLev–
 =ğb©‹ry_šfo->
Ï¡_Ëv–
)) {

143 
ch¬geR©e
 = 
b©‹ry_šfo
->
Ï¡_ch¬geR©e
;

145 
ch¬geR©e
 = ((
ch¬geLev–
 - 
b©‹ry_šfo
->
Ï¡_Ëv–
è* 60 * 60è/ (
cur_time
 - b©‹ry_šfo->
Ï¡_time
);

149 
ch¬geR©e
 = (chargeRate > 0) ? chargeRate : -chargeRate;

151 
b©‹ry_šfo
->
Ï¡_Ëv–
 = 
ch¬geLev–
;

152 
b©‹ry_šfo
->
Ï¡_time
 = 
cur_time
;

153 
b©‹ry_šfo
->
Ï¡_ch¬geR©e
 = 
ch¬geR©e
;

156 
b©‹ry_šfo
 = 
	`g_Ãw0
(
b©‹ryInfo
, 1);

157 
	`g_hash_bË_š£¹
(
§ved_b©‹ry_šfo
, (*è
id
, 
b©‹ry_šfo
);

159 
b©‹ry_šfo
->
Ï¡_Ëv–
 = 
ch¬geLev–
;

160 
b©‹ry_šfo
->
Ï¡_time
 = 
cur_time
;

161 
b©‹ry_šfo
->
Ï¡_ch¬geR©e
 = 0;

162 
b©‹ry_šfo
->
high_time_w¬n_couÁ
 = 0;

167 ià(
ch¬geR©e
 == 0)

170 ià(
isDisch¬gšg
) {

171 
»maššg_time
 = ((è
ch¬geLev–
 / (è
ch¬geR©e
) * 60 * 60;

172 } ià(
isCh¬gšg
) {

177 ià(
ch¬geLev–
 > 
ch¬geLa¡FuÎ
 ) {

178 
	`HAL_WARNING
 (("chargeLevel > chargeLastFull,„eturning -1"));

181 
»maššg_time
 = ((è(
ch¬geLa¡FuÎ
 - 
ch¬geLev–
è/ (è
ch¬geR©e
) * 60 * 60;

185 ià(
»maššg_time
 < 0) {

186 
	`HAL_WARNING
 (("»maššg_tim%i,„‘uºšg -1", 
»maššg_time
));

187 
»maššg_time
 = -1;

190 ià(
»maššg_time
 > 60*60*60) {

191 
b©‹ryInfo
 *
b©‹ry_šfo
;

194 ià(!
§ved_b©‹ry_šfo
)

195 
§ved_b©‹ry_šfo
 = 
	`g_hash_bË_Ãw
(
g_¡r_hash
, 
g_¡r_equ®
);

197 ià(!(
b©‹ry_šfo
 = 
	`g_hash_bË_lookup
(
§ved_b©‹ry_šfo
, 
id
))) {

198 
b©‹ry_šfo
 = 
	`g_Ãw0
(
b©‹ryInfo
, 1);

199 
	`g_hash_bË_š£¹
(
§ved_b©‹ry_šfo
, (*è
id
, 
b©‹ry_šfo
);

200 
b©‹ry_šfo
->
Ï¡_Ëv–
 = -1;

201 
b©‹ry_šfo
->
Ï¡_time
 = -1;

202 
b©‹ry_šfo
->
Ï¡_ch¬geR©e
 = -1;

203 
b©‹ry_šfo
->
high_time_w¬n_couÁ
 = 0;

207 ià(
b©‹ry_šfo
->
high_time_w¬n_couÁ
 < 10 || !(battery_info->high_time_warn_count % 100)) {

208 
	`HAL_WARNING
 (("remaining_time *very* high,„eturning -1"));

209 
b©‹ry_šfo
->
high_time_w¬n_couÁ
 += 1;

212 
»maššg_time
 = -1;

215  
»maššg_time
;

216 
	}
}

	@hald/util_pm.h

27 #iâdeà
UTIL_PM_H


28 
	#UTIL_PM_H


	)

30 cÚ¡ *
ut_g‘_b©‹ry_‹chnŞogy
 (cÚ¡ *
ty³
);

32 
ut_compu‹_time_»maššg
 (cÚ¡ *
id
, 
ch¬geR©e
, 
ch¬geLev–
, 
ch¬geLa¡FuÎ
,

33 
gboŞ—n
 
isDisch¬gšg
, gboŞ—À
isCh¬gšg
, gboŞ—À
guessCh¬geR©e
);

	@libhal-storage/libhal-storage.c

28 #ifdeà
HAVE_CONFIG_H


29 
	~<cÚfig.h
>

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<¡ršg.h
>

35 
	~<dbus/dbus.h
>

37 
	~<libh®.h
>

38 
	~"libh®-¡Üage.h
"

41 #ifdeà
ENABLE_NLS


42 
	~<libš.h
>

43 
	#_
(
SŒšg
è
	`dg‘‹xt
 (
GETTEXT_PACKAGE
, SŒšg)

	)

44 #ifdeà
g‘‹xt_noİ


45 
	#N_
(
SŒšg
è
	`g‘‹xt_noİ
 (SŒšg)

	)

47 
	#N_
(
SŒšg
è(SŒšg)

	)

51 
	#‹xtdomaš
(
SŒšg
è(SŒšg)

	)

52 
	#g‘‹xt
(
SŒšg
è(SŒšg)

	)

53 
	#dg‘‹xt
(
Domaš
,
Mes§ge
è(Mes§ge)

	)

54 
	#dcg‘‹xt
(
Domaš
,
Mes§ge
,
Ty³
è(Mes§ge)

	)

55 
	#bšd‹xtdomaš
(
Domaš
,
DœeùÜy
è(Domaš)

	)

56 
	#_
(
SŒšg
è(SŒšg)

	)

57 
	#N_
(
SŒšg
è(SŒšg)

	)

60 
	sIcÚM­pšgEÁry_s
 {

61 
LibH®StÜagePŞicyIcÚ
 
	micÚ
;

62 *
	m·th
;

63 
IcÚM­pšgEÁry_s
 *
	mÃxt
;

64 } 
	tIcÚM­pšgEÁry
;

66 
	sLibH®StÜagePŞicy_s
 {

67 
IcÚM­pšgEÁry
 *
	micÚ_m­pšgs
;

70 
LibH®StÜagePŞicy
 *

71 
	$libh®_¡Üage_pŞicy_Ãw
 ()

73 
LibH®StÜagePŞicy
 *
p
;

75 
p
 = 
	`m®loc
 ( (
LibH®StÜagePŞicy
));

76 ià(
p
 =ğ
NULL
)

77 
out
;

79 
p
->
icÚ_m­pšgs
 = 
NULL
;

80 
out
:

81  
p
;

82 
	}
}

85 
	$libh®_¡Üage_pŞicy_ä“
 (
LibH®StÜagePŞicy
 *
pŞicy
)

87 
IcÚM­pšgEÁry
 *
i
;

88 
IcÚM­pšgEÁry
 *
j
;

91 
i
 = 
pŞicy
->
icÚ_m­pšgs
; i !ğ
NULL
; i = 
j
) {

92 
j
 = 
i
->
Ãxt
;

93 
	`ä“
 (
i
->
·th
);

94 
	`ä“
 (
i
);

97 
	`ä“
 (
pŞicy
);

98 
	}
}

101 
	$libh®_¡Üage_pŞicy_£t_icÚ_·th
 (
LibH®StÜagePŞicy
 *
pŞicy
, 
LibH®StÜagePŞicyIcÚ
 
icÚ
, cÚ¡ *
·th
)

103 
IcÚM­pšgEÁry
 *
i
;

106 
i
 = 
pŞicy
->
icÚ_m­pšgs
; i !ğ
NULL
; i = i->
Ãxt
) {

107 ià(
i
->
icÚ
 == icon) {

108 
	`ä“
 (
i
->
·th
);

109 
i
->
·th
 = 
	`¡rdup
 (path);

110 
out
;

114 
i
 = 
	`m®loc
 ( (
IcÚM­pšgEÁry
));

115 ià(
i
 =ğ
NULL
)

116 
out
;

117 
i
->
icÚ
 = icon;

118 
i
->
·th
 = 
	`¡rdup
 (path);

119 
i
->
Ãxt
 = 
pŞicy
->
icÚ_m­pšgs
;

120 
pŞicy
->
icÚ_m­pšgs
 = 
i
;

122 
out
:

124 
	}
}

127 
	$libh®_¡Üage_pŞicy_£t_icÚ_m­pšg
 (
LibH®StÜagePŞicy
 *
pŞicy
, 
LibH®StÜagePŞicyIcÚPaœ
 *
·œs
)

129 
LibH®StÜagePŞicyIcÚPaœ
 *
i
;

131 
i
 = 
·œs
; i->
icÚ
 != 0x00; i++) {

132 
	`libh®_¡Üage_pŞicy_£t_icÚ_·th
 (
pŞicy
, 
i
->
icÚ
, i->
icÚ_·th
);

134 
	}
}

137 
	$libh®_¡Üage_pŞicy_lookup_icÚ
 (
LibH®StÜagePŞicy
 *
pŞicy
, 
LibH®StÜagePŞicyIcÚ
 
icÚ
)

139 
IcÚM­pšgEÁry
 *
i
;

140 cÚ¡ *
·th
;

142 
·th
 = 
NULL
;

143 
i
 = 
pŞicy
->
icÚ_m­pšgs
; i !ğ
NULL
; i = i->
Ãxt
) {

144 ià(
i
->
icÚ
 == icon) {

145 
·th
 = 
i
->path;

146 
out
;

149 
out
:

150  
·th
;

151 
	}
}

154 
	#MAX_STRING_SZ
 256

	)

157 
	$libh®_vŞume_pŞicy_compu‹_size_as_¡ršg
 (
LibH®VŞume
 *
vŞume
)

159 
dbus_ušt64_t
 
size
;

160 *
»suÉ
;

161 * 
sizes_¡r
[] = {"K", "M", "G", "T", 
NULL
};

162 
dbus_ušt64_t
 
cur
 = 1000L;

163 
dbus_ušt64_t
 
ba£
 = 10L;

164 
dbus_ušt64_t
 
¡•
 = 10L*10L*10L;

165 
cur_¡r
 = 0;

166 
buf
[
MAX_STRING_SZ
];

168 
»suÉ
 = 
NULL
;

170 
size
 = 
	`libh®_vŞume_g‘_size
 (
vŞume
);

173 ià(
sizes_¡r
[
cur_¡r
+1] =ğ
NULL
 || 
size
 < 
cur
*
¡•
) {

175 ià(
size
 < 
cur
*
ba£
) {

176 
	`¢´štf
 (
buf
, 
MAX_STRING_SZ
, "%.01f%s",

177 (()
size
)/(()
cur
), 
sizes_¡r
[
cur_¡r
]);

178 
»suÉ
 = 
	`¡rdup
 (
buf
);

180 
	`¢´štf
 (
buf
, 
MAX_STRING_SZ
, "%Îu%s", (è
size
 / 
cur
, 
sizes_¡r
[
cur_¡r
]);

181 
»suÉ
 = 
	`¡rdup
 (
buf
);

183 
out
;

186 
cur
 *ğ
¡•
;

187 
cur_¡r
++;

190 
out
:

191  
»suÉ
;

192 
	}
}

196 
	$libh®_drive_pŞicy_compu‹_di¥Ïy_Çme
 (
LibH®Drive
 *
drive
, 
LibH®VŞume
 *
vŞume
, 
LibH®StÜagePŞicy
 *
pŞicy
)

198 *
Çme
;

199 *
size_¡r
;

200 *
v’dÜmod–_¡r
;

201 cÚ¡ *
mod–
;

202 cÚ¡ *
v’dÜ
;

203 
LibH®DriveTy³
 
drive_ty³
;

204 
dbus_boŞ_t
 
drive_is_hÙ¶uggabË
;

205 
dbus_boŞ_t
 
drive_is_»movabË
;

206 
LibH®DriveCdromC­s
 
drive_cdrom_ÿps
;

207 
buf
[
MAX_STRING_SZ
];

209 
mod–
 = 
	`libh®_drive_g‘_mod–
 (
drive
);

210 
v’dÜ
 = 
	`libh®_drive_g‘_v’dÜ
 (
drive
);

211 
drive_ty³
 = 
	`libh®_drive_g‘_ty³
 (
drive
);

212 
drive_is_hÙ¶uggabË
 = 
	`libh®_drive_is_hÙ¶uggabË
 (
drive
);

213 
drive_is_»movabË
 = 
	`libh®_drive_u£s_»movabË_medŸ
 (
drive
);

214 
drive_cdrom_ÿps
 = 
	`libh®_drive_g‘_cdrom_ÿps
 (
drive
);

216 ià(
vŞume
 !ğ
NULL
)

217 
size_¡r
 = 
	`libh®_vŞume_pŞicy_compu‹_size_as_¡ršg
 (
vŞume
);

219 
size_¡r
 = 
NULL
;

221 ià(
v’dÜ
 =ğ
NULL
 || 
	`¡¾’
 (vendor) == 0) {

222 ià(
mod–
 =ğ
NULL
 || 
	`¡¾’
 (model) == 0)

223 
v’dÜmod–_¡r
 = 
	`¡rdup
 ("");

225 
v’dÜmod–_¡r
 = 
	`¡rdup
 (
mod–
);

227 ià(
mod–
 =ğ
NULL
 || 
	`¡¾’
 (model) == 0)

228 
v’dÜmod–_¡r
 = 
	`¡rdup
 (
v’dÜ
);

230 
	`¢´štf
 (
buf
, 
MAX_STRING_SZ
, "% %s", 
v’dÜ
, 
mod–
);

231 
v’dÜmod–_¡r
 = 
	`¡rdup
 (
buf
);

235 ià(
drive_ty³
==
LIBHAL_DRIVE_TYPE_CDROM
) {

238 *
fœ¡
;

239 *
£cÚd
;

242 
fœ¡
 = "CD-ROM";

243 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_CDR
)

244 
fœ¡
 = "CD-R";

245 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_CDRW
)

246 
fœ¡
 = "CD-RW";

248 
£cÚd
 = "";

249 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDROM
)

250 
£cÚd
 = "/DVD-ROM";

251 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSR
)

252 
£cÚd
 = "/DVD+R";

253 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSRW
)

254 
£cÚd
 = "/DVD+RW";

255 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDR
)

256 
£cÚd
 = "/DVD-R";

257 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDRW
)

258 
£cÚd
 = "/DVD-RW";

259 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDRAM
)

260 
£cÚd
 = "/DVD-RAM";

261 ià((
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDR
) &&

262 (
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSR
)) {

263 if(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSRDL
)

264 
£cÚd
 = "/DVDÂ±R DL";

266 
£cÚd
 = "/DVDÂ±R";

268 ià((
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDRW
) &&

269 (
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSRW
)) {

270 if(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSRDL
 ||

271 
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSRWDL
)

272 
£cÚd
 = "/DVDÂ±RW DL";

274 
£cÚd
 = "/DVDÂ±RW";

276 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_BDROM
)

277 
£cÚd
 = "/BD-ROM";

278 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_BDR
)

279 
£cÚd
 = "/BD-R";

280 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_BDRE
)

281 
£cÚd
 = "/BD-RE";

282 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_HDDVDROM
)

283 
£cÚd
 = "/HD DVD-ROM";

284 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_HDDVDR
)

285 
£cÚd
 = "/HD DVD-R";

286 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_HDDVDRW
)

287 
£cÚd
 = "/HD DVD-RW";

288 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_MRW
)

289 
£cÚd
 = "/MRW";

290 ià(
drive_cdrom_ÿps
 & 
LIBHAL_DRIVE_CDROM_CAPS_MRWW
)

291 
£cÚd
 = "/MRW-W";

293 ià(
drive_is_hÙ¶uggabË
) {

294 
	`¢´štf
 (
buf
, 
MAX_STRING_SZ
, 
	`_
("Ex‹º® %s% Drive"), 
fœ¡
, 
£cÚd
);

295 
Çme
 = 
	`¡rdup
 (
buf
);

297 
	`¢´štf
 (
buf
, 
MAX_STRING_SZ
, 
	`_
("%s% Drive"), 
fœ¡
, 
£cÚd
);

298 
Çme
 = 
	`¡rdup
 (
buf
);

301 } ià(
drive_ty³
==
LIBHAL_DRIVE_TYPE_MO
) {

303 ià(
drive_is_hÙ¶uggabË
)

304 
Çme
 = 
	`¡rdup
 (
	`_
("External Magneto Optical Drive"));

306 
Çme
 = 
	`¡rdup
 (
	`_
("Magneto Optical Drive"));

307 } ià(
drive_ty³
==
LIBHAL_DRIVE_TYPE_FLOPPY
) {

311 ià(
drive_is_hÙ¶uggabË
)

312 
Çme
 = 
	`¡rdup
 (
	`_
("External Floppy Drive"));

314 
Çme
 = 
	`¡rdup
 (
	`_
("Floppy Drive"));

315 } ià(
drive_ty³
==
LIBHAL_DRIVE_TYPE_DISK
 && !
drive_is_»movabË
) {

319 ià(
size_¡r
 !ğ
NULL
) {

320 ià(
drive_is_hÙ¶uggabË
) {

321 
	`¢´štf
 (
buf
, 
MAX_STRING_SZ
, 
	`_
("% Ex‹º® H¬d Drive"), 
size_¡r
);

322 
Çme
 = 
	`¡rdup
 (
buf
);

324 
	`¢´štf
 (
buf
, 
MAX_STRING_SZ
, 
	`_
("% H¬d Drive"), 
size_¡r
);

325 
Çme
 = 
	`¡rdup
 (
buf
);

328 ià(
drive_is_hÙ¶uggabË
)

329 
Çme
 = 
	`¡rdup
 (
	`_
("External Hard Drive"));

331 
Çme
 = 
	`¡rdup
 (
	`_
("Hard Drive"));

337 ià(
	`¡¾’
 (
v’dÜmod–_¡r
) > 0)

338 
Çme
 = 
	`¡rdup
 (
v’dÜmod–_¡r
);

340 
Çme
 = 
	`¡rdup
 (
	`_
("Drive"));

343 
	`ä“
 (
v’dÜmod–_¡r
);

344 
	`ä“
 (
size_¡r
);

346  
Çme
;

347 
	}
}

350 
	$libh®_vŞume_pŞicy_compu‹_di¥Ïy_Çme
 (
LibH®Drive
 *
drive
, 
LibH®VŞume
 *
vŞume
, 
LibH®StÜagePŞicy
 *
pŞicy
)

352 *
Çme
;

353 *
size_¡r
;

354 cÚ¡ *
vŞume_Ïb–
;

355 
LibH®DriveTy³
 
drive_ty³
;

356 
dbus_boŞ_t
 
drive_is_»movabË
;

357 
buf
[
MAX_STRING_SZ
];

359 
vŞume_Ïb–
 = 
	`libh®_vŞume_g‘_Ïb–
 (
vŞume
);

360 
drive_ty³
 = 
	`libh®_drive_g‘_ty³
 (
drive
);

361 
drive_is_»movabË
 = 
	`libh®_drive_u£s_»movabË_medŸ
 (
drive
);

363 
size_¡r
 = 
	`libh®_vŞume_pŞicy_compu‹_size_as_¡ršg
 (
vŞume
);

369 ià(
vŞume_Ïb–
 !ğ
NULL
) {

370 
Çme
 = 
	`¡rdup
 (
vŞume_Ïb–
);

371 
out
;

375 ià(
drive_ty³
==
LIBHAL_DRIVE_TYPE_CDROM
) {

376 
	`libh®_vŞume_g‘_disc_ty³
 (
vŞume
)) {

380 
LIBHAL_VOLUME_DISC_TYPE_CDROM
:

381 
Çme
 = 
	`¡rdup
 (
	`_
("CD-ROM "));

384 
LIBHAL_VOLUME_DISC_TYPE_CDR
:

385 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

386 
Çme
 = 
	`¡rdup
 (
	`_
("Blank CD-R"));

388 
Çme
 = 
	`¡rdup
 (
	`_
("CD-R"));

391 
LIBHAL_VOLUME_DISC_TYPE_CDRW
:

392 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

393 
Çme
 = 
	`¡rdup
 (
	`_
("Blank CD-RW"));

395 
Çme
 = 
	`¡rdup
 (
	`_
("CD-RW"));

398 
LIBHAL_VOLUME_DISC_TYPE_DVDROM
:

399 
Çme
 = 
	`¡rdup
 (
	`_
("DVD-ROM"));

402 
LIBHAL_VOLUME_DISC_TYPE_DVDRAM
:

403 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

404 
Çme
 = 
	`¡rdup
 (
	`_
("Blank DVD-RAM"));

406 
Çme
 = 
	`¡rdup
 (
	`_
("DVD-RAM"));

409 
LIBHAL_VOLUME_DISC_TYPE_DVDR
:

410 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

411 
Çme
 = 
	`¡rdup
 (
	`_
("Blank DVD-R"));

413 
Çme
 = 
	`¡rdup
 (
	`_
("DVD-R"));

416 
LIBHAL_VOLUME_DISC_TYPE_DVDR_DL
:

417 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

418 
Çme
 = 
	`¡rdup
 (
	`_
("Blank DVD-R Dual-Layer"));

420 
Çme
 = 
	`¡rdup
 (
	`_
("DVD-R Dual-Layer"));

423 
LIBHAL_VOLUME_DISC_TYPE_DVDRW
:

424 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

425 
Çme
 = 
	`¡rdup
 (
	`_
("Blank DVD-RW"));

427 
Çme
 = 
	`¡rdup
 (
	`_
("DVD-RW"));

430 
LIBHAL_VOLUME_DISC_TYPE_DVDPLUSR
:

431 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

432 
Çme
 = 
	`¡rdup
 (
	`_
("Blank DVD+R"));

434 
Çme
 = 
	`¡rdup
 (
	`_
("DVD+R"));

437 
LIBHAL_VOLUME_DISC_TYPE_DVDPLUSRW
:

438 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

439 
Çme
 = 
	`¡rdup
 (
	`_
("Blank DVD+RW"));

441 
Çme
 = 
	`¡rdup
 (
	`_
("DVD+RW"));

444 
LIBHAL_VOLUME_DISC_TYPE_DVDPLUSR_DL
:

445 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

446 
Çme
 = 
	`¡rdup
 (
	`_
("Blank DVD+R Dual-Layer"));

448 
Çme
 = 
	`¡rdup
 (
	`_
("DVD+R Dual-Layer"));

451 
LIBHAL_VOLUME_DISC_TYPE_BDROM
:

452 
Çme
 = 
	`¡rdup
 (
	`_
("BD-ROM"));

455 
LIBHAL_VOLUME_DISC_TYPE_BDR
:

456 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

457 
Çme
 = 
	`¡rdup
 (
	`_
("Blank BD-R"));

459 
Çme
 = 
	`¡rdup
 (
	`_
("BD-R"));

462 
LIBHAL_VOLUME_DISC_TYPE_BDRE
:

463 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

464 
Çme
 = 
	`¡rdup
 (
	`_
("Blank BD-RE"));

466 
Çme
 = 
	`¡rdup
 (
	`_
("BD-RE"));

469 
LIBHAL_VOLUME_DISC_TYPE_HDDVDROM
:

470 
Çme
 = 
	`¡rdup
 (
	`_
("HD DVD-ROM"));

473 
LIBHAL_VOLUME_DISC_TYPE_HDDVDR
:

474 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

475 
Çme
 = 
	`¡rdup
 (
	`_
("Blank HD DVD-R"));

477 
Çme
 = 
	`¡rdup
 (
	`_
("HD DVD-R"));

480 
LIBHAL_VOLUME_DISC_TYPE_HDDVDRW
:

481 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

482 
Çme
 = 
	`¡rdup
 (
	`_
("Blank HD DVD-RW"));

484 
Çme
 = 
	`¡rdup
 (
	`_
("HD DVD-RW"));

490 ià(
	`libh®_vŞume_disc_has_audio
 (
vŞume
è&& !
	`libh®_vŞume_disc_has_d©a
 (volume)) {

491 
	`ä“
 (
Çme
);

492 
Çme
 = 
	`¡rdup
 (
	`_
("Audio CD"));

495 
out
;

496 } ià(
drive_ty³
==
LIBHAL_DRIVE_TYPE_MO
) {

497 ià(
	`libh®_vŞume_g‘_disc_ty³
 (
vŞume
è=ğ
LIBHAL_VOLUME_DISC_TYPE_MO
) {

498 ià(
	`libh®_vŞume_disc_is_bÏnk
 (
vŞume
))

499 
Çme
 = 
	`¡rdup
 (
	`_
("Blank Magneto Optical"));

501 
Çme
 = 
	`¡rdup
 (
	`_
("Magneto Optical"));

504 
out
;

508 ià(
drive_is_»movabË
) {

509 
	`¢´štf
 (
buf
, 
MAX_STRING_SZ
, 
	`_
("% RemovabË MedŸ"), 
size_¡r
);

510 
Çme
 = 
	`¡rdup
 (
buf
);

512 
	`¢´štf
 (
buf
, 
MAX_STRING_SZ
, 
	`_
("% MedŸ"), 
size_¡r
);

513 
Çme
 = 
	`¡rdup
 (
buf
);

519 
out
:

520 
	`ä“
 (
size_¡r
);

521  
Çme
;

522 
	}
}

525 
	$libh®_drive_pŞicy_compu‹_icÚ_Çme
 (
LibH®Drive
 *
drive
, 
LibH®VŞume
 *
vŞume
, 
LibH®StÜagePŞicy
 *
pŞicy
)

527 cÚ¡ *
Çme
;

528 
LibH®DriveBus
 
bus
;

529 
LibH®DriveTy³
 
drive_ty³
;

531 
bus
 = 
	`libh®_drive_g‘_bus
 (
drive
);

532 
drive_ty³
 = 
	`libh®_drive_g‘_ty³
 (
drive
);

536 
drive_ty³
) {

537 
LIBHAL_DRIVE_TYPE_REMOVABLE_DISK
:

538 
LIBHAL_DRIVE_TYPE_DISK
:

539 
LIBHAL_DRIVE_TYPE_CDROM
:

540 
LIBHAL_DRIVE_TYPE_MO
:

541 
LIBHAL_DRIVE_TYPE_FLOPPY
:

542 
Çme
 = 
	`libh®_¡Üage_pŞicy_lookup_icÚ
 (
pŞicy
, 0x10000 + 
drive_ty³
*0x100 + 
bus
);

546 
Çme
 = 
	`libh®_¡Üage_pŞicy_lookup_icÚ
 (
pŞicy
, 0x10000 + 
drive_ty³
*0x100);

549 ià(
Çme
 !ğ
NULL
)

550  
	`¡rdup
 (
Çme
);

552  
NULL
;

553 
	}
}

556 
	$libh®_vŞume_pŞicy_compu‹_icÚ_Çme
 (
LibH®Drive
 *
drive
, 
LibH®VŞume
 *
vŞume
, 
LibH®StÜagePŞicy
 *
pŞicy
)

558 cÚ¡ *
Çme
;

559 
LibH®DriveBus
 
bus
;

560 
LibH®DriveTy³
 
drive_ty³
;

561 
LibH®VŞumeDiscTy³
 
disc_ty³
;

565 ià(
	`libh®_vŞume_is_disc
 (
vŞume
)) {

566 
disc_ty³
 = 
	`libh®_vŞume_g‘_disc_ty³
 (
vŞume
);

567 
Çme
 = 
	`libh®_¡Üage_pŞicy_lookup_icÚ
 (
pŞicy
, 0x30000 + 
disc_ty³
);

568 
out
;

571 ià(
drive
 =ğ
NULL
) {

572 
Çme
 = 
	`libh®_¡Üage_pŞicy_lookup_icÚ
 (
pŞicy
, 
LIBHAL_STORAGE_ICON_VOLUME_REMOVABLE_DISK
);

573 
out
;

576 
bus
 = 
	`libh®_drive_g‘_bus
 (
drive
);

577 
drive_ty³
 = 
	`libh®_drive_g‘_ty³
 (
drive
);

579 
drive_ty³
) {

580 
LIBHAL_DRIVE_TYPE_REMOVABLE_DISK
:

581 
LIBHAL_DRIVE_TYPE_DISK
:

582 
LIBHAL_DRIVE_TYPE_CDROM
:

583 
LIBHAL_DRIVE_TYPE_MO
:

584 
LIBHAL_DRIVE_TYPE_FLOPPY
:

585 
Çme
 = 
	`libh®_¡Üage_pŞicy_lookup_icÚ
 (
pŞicy
, 0x20000 + 
drive_ty³
*0x100 + 
bus
);

589 
Çme
 = 
	`libh®_¡Üage_pŞicy_lookup_icÚ
 (
pŞicy
, 0x20000 + 
drive_ty³
*0x100);

591 
out
:

592 ià(
Çme
 !ğ
NULL
)

593  
	`¡rdup
 (
Çme
);

595  
NULL
;

596 
	}
}

615 
dbus_boŞ_t


616 
	$libh®_vŞume_pŞicy_should_be_visibË
 (
LibH®Drive
 *
drive
, 
LibH®VŞume
 *
vŞume
, 
LibH®StÜagePŞicy
 *
pŞicy
,

617 cÚ¡ *
rg‘_mouÁ_pošt
)

619 
i
;

620 
dbus_boŞ_t
 
is_visibË
;

621 cÚ¡ *
Ïb–
;

622 cÚ¡ *
mouÁ_pošt
;

623 cÚ¡ *
f¡y³
;

624 cÚ¡ *
fhs23_tİËv–_mouÁ_pošts
[] = {

644 
NULL


647 
is_visibË
 = 
FALSE
;

650 ià(
	`libh®_vŞume_g‘_fsu§ge
 (
vŞume
è!ğ
LIBHAL_VOLUME_USAGE_MOUNTABLE_FILESYSTEM
)

651 
out
;

653 
Ïb–
 = 
	`libh®_vŞume_g‘_Ïb–
 (
vŞume
);

654 
mouÁ_pošt
 = 
	`libh®_vŞume_g‘_mouÁ_pošt
 (
vŞume
);

655 
f¡y³
 = 
	`libh®_vŞume_g‘_f¡y³
 (
vŞume
);

658 ià(
mouÁ_pošt
 =ğ
NULL
)

659 
mouÁ_pošt
 = 
rg‘_mouÁ_pošt
;

662 ià(
f¡y³
 =ğ
NULL
)

663 
out
;

666 ià(
mouÁ_pošt
 !ğ
NULL
) {

667 
i
 = 0; 
fhs23_tİËv–_mouÁ_pošts
[i] !ğ
NULL
; i++) {

668 ià(
	`¡rcmp
 (
mouÁ_pošt
, 
fhs23_tİËv–_mouÁ_pošts
[
i
]) == 0)

669 
out
;

674 ià(
Ïb–
 !ğ
NULL
 && 
	`¡rcmp
 (Ïb–, "boÙ¡¿p"è=ğ0 && sŒcm°(
f¡y³
, "hfs") == 0)

675 
out
;

678 
is_visibË
 = 
TRUE
;

680 
out
:

681  
is_visibË
;

682 
	}
}

686 
	#MOUNT_OPTIONS_SIZE
 256

	)

688 
	sLibH®Drive_s
 {

689 *
	mudi
;

691 
	mdeviû_majÜ
;

692 
	mdeviû_mšÜ
;

693 *
	mdeviû_fe
;

695 
LibH®DriveBus
 
	mbus
;

696 *
	mv’dÜ
;

697 *
	mmod–
;

698 
dbus_boŞ_t
 
	mis_hÙ¶uggabË
;

699 
dbus_boŞ_t
 
	mis_»movabË
;

700 
dbus_boŞ_t
 
	mis_medŸ_d‘eùed
;

701 
dbus_boŞ_t
 
	mis_medŸ_d‘eùiÚ_autom©ic
;

702 
dbus_boŞ_t
 
	m»quœes_ejeù
;

704 
LibH®DriveTy³
 
	mty³
;

705 *
	mty³_‹xtu®
;

707 *
	mphysiÿl_deviû
;

710 *
	mdediÿ‹d_icÚ_drive
;

711 *
	mdediÿ‹d_icÚ_vŞume
;

713 *
	m£rŸl
;

714 *
	mfœmw¬e_v”siÚ
;

715 
LibH®DriveCdromC­s
 
	mcdrom_ÿps
;

717 *
	mdesœed_mouÁ_pošt
;

718 *
	mmouÁ_fesy¡em
;

719 
dbus_boŞ_t
 
	mshould_mouÁ
;

721 
dbus_boŞ_t
 
	mno_·¹™iÚs_hšt
;

723 
dbus_ušt64_t
 
	mdrive_size
;

724 
dbus_ušt64_t
 
	mdrive_medŸ_size
;

725 *
	m·¹™iÚ_scheme
;

727 
LibH®CÚ‹xt
 *
	mh®_ùx
;

729 **
	mÿ·b™›s
;

731 
	mmouÁ_İtiÚs
[
MOUNT_OPTIONS_SIZE
];

734 
	sLibH®VŞume_s
 {

735 *
	mudi
;

737 
	mdeviû_majÜ
;

738 
	mdeviû_mšÜ
;

739 *
	mdeviû_fe
;

740 *
	mvŞume_Ïb–
;

741 
dbus_boŞ_t
 
	mis_mouÁed
;

742 
dbus_boŞ_t
 
	mis_mouÁed_»ad_Úly
;

743 *
	mmouÁ_pošt
;

744 *
	mf¡y³
;

745 *
	mfsv”siÚ
;

746 *
	muuid
;

747 *
	m¡Üage_deviû
;

749 
LibH®VŞumeU§ge
 
	mfsu§ge
;

751 
dbus_boŞ_t
 
	mis_·¹™iÚ
;

752 
	m·¹™iÚ_numb”
;

753 *
	m·¹™iÚ_scheme
;

754 *
	m·¹™iÚ_ty³
;

755 *
	m·¹™iÚ_Ïb–
;

756 *
	m·¹™iÚ_uuid
;

757 **
	m·¹™iÚ_æags
;

759 
	mmsdos_·¹_bË_ty³
;

760 
dbus_ušt64_t
 
	mmsdos_·¹_bË_¡¬t
;

761 
dbus_ušt64_t
 
	mmsdos_·¹_bË_size
;

763 
dbus_boŞ_t
 
	mis_disc
;

764 
LibH®VŞumeDiscTy³
 
	mdisc_ty³
;

765 
dbus_boŞ_t
 
	mdisc_has_audio
;

766 
dbus_boŞ_t
 
	mdisc_has_d©a
;

767 
dbus_boŞ_t
 
	mdisc_is_­³ndabË
;

768 
dbus_boŞ_t
 
	mdisc_is_bÏnk
;

769 
dbus_boŞ_t
 
	mdisc_is_»wr™abË
;

771 
	mblock_size
;

772 
	mnum_blocks
;

774 *
	mdesœed_mouÁ_pošt
;

775 *
	mmouÁ_fesy¡em
;

776 
dbus_boŞ_t
 
	mshould_mouÁ
;

778 
dbus_boŞ_t
 
	mignÜe_vŞume
;

780 *
	müy±o_backšg_vŞume
;

782 
	mmouÁ_İtiÚs
[
MOUNT_OPTIONS_SIZE
];

784 
dbus_ušt64_t
 
	mvŞume_size
;

785 
dbus_ušt64_t
 
	mdisc_ÿ·c™y
;

787 
dbus_ušt64_t
 
	m·¹™iÚ_¡¬t_off£t
;

788 
dbus_ušt64_t
 
	m·¹™iÚ_medŸ_size
;

792 
	$libh®_drive_g‘_dediÿ‹d_icÚ_drive
 (
LibH®Drive
 *
drive
)

794  
drive
->
dediÿ‹d_icÚ_drive
;

795 
	}
}

798 
	$libh®_drive_g‘_dediÿ‹d_icÚ_vŞume
 (
LibH®Drive
 *
drive
)

800  
drive
->
dediÿ‹d_icÚ_vŞume
;

801 
	}
}

810 
	$libh®_drive_ä“
 (
LibH®Drive
 *
drive
)

812 ià(
drive
 =ğ
NULL
 )

815 
	`ä“
 (
drive
->
udi
);

816 
	`libh®_ä“_¡ršg
 (
drive
->
deviû_fe
);

817 
	`libh®_ä“_¡ršg
 (
drive
->
v’dÜ
);

818 
	`libh®_ä“_¡ršg
 (
drive
->
mod–
);

819 
	`libh®_ä“_¡ršg
 (
drive
->
ty³_‹xtu®
);

820 
	`libh®_ä“_¡ršg
 (
drive
->
physiÿl_deviû
);

821 
	`libh®_ä“_¡ršg
 (
drive
->
dediÿ‹d_icÚ_drive
);

822 
	`libh®_ä“_¡ršg
 (
drive
->
dediÿ‹d_icÚ_vŞume
);

823 
	`libh®_ä“_¡ršg
 (
drive
->
£rŸl
);

824 
	`libh®_ä“_¡ršg
 (
drive
->
fœmw¬e_v”siÚ
);

825 
	`libh®_ä“_¡ršg
 (
drive
->
desœed_mouÁ_pošt
);

826 
	`libh®_ä“_¡ršg
 (
drive
->
mouÁ_fesy¡em
);

827 
	`libh®_ä“_¡ršg_¬¿y
 (
drive
->
ÿ·b™›s
);

828 
	`libh®_ä“_¡ršg
 (
drive
->
·¹™iÚ_scheme
);

830 
	`ä“
 (
drive
);

831 
	}
}

841 
	$libh®_vŞume_ä“
 (
LibH®VŞume
 *
vŞume
)

843 ià(
vŞume
 =ğ
NULL
 )

846 
	`ä“
 (
vŞume
->
udi
);

847 
	`libh®_ä“_¡ršg
 (
vŞume
->
deviû_fe
);

848 
	`libh®_ä“_¡ršg
 (
vŞume
->
vŞume_Ïb–
);

849 
	`libh®_ä“_¡ršg
 (
vŞume
->
f¡y³
);

850 
	`libh®_ä“_¡ršg
 (
vŞume
->
mouÁ_pošt
);

851 
	`libh®_ä“_¡ršg
 (
vŞume
->
fsv”siÚ
);

852 
	`libh®_ä“_¡ršg
 (
vŞume
->
uuid
);

853 
	`libh®_ä“_¡ršg
 (
vŞume
->
desœed_mouÁ_pošt
);

854 
	`libh®_ä“_¡ršg
 (
vŞume
->
mouÁ_fesy¡em
);

855 
	`libh®_ä“_¡ršg
 (
vŞume
->
üy±o_backšg_vŞume
);

856 
	`libh®_ä“_¡ršg
 (
vŞume
->
¡Üage_deviû
);

858 
	`libh®_ä“_¡ršg
 (
vŞume
->
·¹™iÚ_scheme
);

859 
	`libh®_ä“_¡ršg
 (
vŞume
->
·¹™iÚ_ty³
);

860 
	`libh®_ä“_¡ršg
 (
vŞume
->
·¹™iÚ_Ïb–
);

861 
	`libh®_ä“_¡ršg
 (
vŞume
->
·¹™iÚ_uuid
);

862 
	`libh®_ä“_¡ršg_¬¿y
 (
vŞume
->
·¹™iÚ_æags
);

864 
	`ä“
 (
vŞume
);

865 
	}
}

869 
	$my_¡rvdup
 (**
¡rv
)

871 
num_–ems
;

872 
i
;

873 **
»s
;

875 
num_–ems
 = 0; 
¡rv
[num_–ems] !ğ
NULL
;‚um_elems++)

878 
»s
 = 
	`ÿÎoc
 (
num_–ems
 + 1,  (*));

879 ià(
»s
 =ğ
NULL
)

880 
out
;

882 
i
 = 0; i < 
num_–ems
; i++)

883 
»s
[
i
] = 
	`¡rdup
 (
¡rv
[i]);

884 
»s
[
i
] = 
NULL
;

886 
out
:

887  
»s
;

888 
	}
}

892 
	#LIBHAL_PROP_EXTRACT_BEGIN
 ià(
FALSE
)

	)

893 
	#LIBHAL_PROP_EXTRACT_END
 ;

	)

894 
	#LIBHAL_PROP_EXTRACT_INT
(
_´İ”ty_
, 
_wh”e_
èià(
	`¡rcmp
 (
key
, _´İ”ty_è=ğ0 && 
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_INT32
è_wh”e_ = 
	`libh®_psi_g‘_št
 (&
™
)

	)

895 
	#LIBHAL_PROP_EXTRACT_UINT64
(
_´İ”ty_
, 
_wh”e_
èià(
	`¡rcmp
 (
key
, _´İ”ty_è=ğ0 && 
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_UINT64
è_wh”e_ = 
	`libh®_psi_g‘_ušt64
 (&
™
)

	)

896 
	#LIBHAL_PROP_EXTRACT_STRING
(
_´İ”ty_
, 
_wh”e_
èià(
	`¡rcmp
 (
key
, _´İ”ty_è=ğ0 && 
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_STRING
è_wh”e_ = (
	`libh®_psi_g‘_¡ršg
 (&
™
è!ğ
NULL
 && 
	`¡¾’
 (libh®_psi_g‘_¡ršg (&™)è> 0è? 
	`¡rdup
 (libh®_psi_g‘_¡ršg (&™)è: 
	)
NULL

897 
	#LIBHAL_PROP_EXTRACT_BOOL
(
_´İ”ty_
, 
_wh”e_
èià(
	`¡rcmp
 (
key
, _´İ”ty_è=ğ0 && 
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_BOOLEAN
è_wh”e_ = 
	`libh®_psi_g‘_boŞ
 (&
™
)

	)

898 
	#LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
(
_´İ”ty_
, 
_wh”e_
, 
_f›ld_
èià(
	`¡rcmp
 (
key
, _´İ”ty_è=ğ0 && 
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_BOOLEAN
è_wh”e_ |ğ
	`libh®_psi_g‘_boŞ
 (&
™
è? _f›ld_ : 0

	)

899 
	#LIBHAL_PROP_EXTRACT_STRLIST
(
_´İ”ty_
, 
_wh”e_
èià(
	`¡rcmp
 (
key
, _´İ”ty_è=ğ0 && 
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_STRLIST
è_wh”e_ = 
	`my_¡rvdup
 (
	`libh®_psi_g‘_¡¾i¡
 (&
™
))

	)

912 
LibH®Drive
 *

913 
	$libh®_drive_äom_udi
 (
LibH®CÚ‹xt
 *
h®_ùx
, cÚ¡ *
udi
)

915 *
bus_‹xtu®
;

916 
LibH®Drive
 *
drive
;

917 
LibH®Prİ”tyS‘
 *
´İ”t›s
;

918 
LibH®Prİ”tyS‘I‹¿tÜ
 
™
;

919 
DBusE¼Ü
 
”rÜ
;

920 
i
;

922 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
h®_ùx
, 
NULL
);

924 
drive
 = 
NULL
;

925 
´İ”t›s
 = 
NULL
;

926 
bus_‹xtu®
 = 
NULL
;

928 
	`dbus_”rÜ_š™
 (&
”rÜ
);

929 ià(!
	`libh®_deviû_qu”y_ÿ·b™y
 (
h®_ùx
, 
udi
, "¡Üage", &
”rÜ
))

930 
”rÜ
;

932 
drive
 = 
	`m®loc
 ( (
LibH®Drive
));

933 ià(
drive
 =ğ
NULL
)

934 
”rÜ
;

935 
	`mem£t
 (
drive
, 0x00,  (
LibH®Drive
));

937 
drive
->
h®_ùx
 = hal_ctx;

939 
drive
->
udi
 = 
	`¡rdup
 (udi);

940 ià(
drive
->
udi
 =ğ
NULL
)

941 
”rÜ
;

943 
´İ”t›s
 = 
	`libh®_deviû_g‘_®l_´İ”t›s
 (
h®_ùx
, 
udi
, &
”rÜ
);

944 ià(
´İ”t›s
 =ğ
NULL
)

945 
”rÜ
;

948 
	`libh®_psi_š™
 (&
™
, 
´İ”t›s
); 
	`libh®_psi_has_mÜe
 (&™); 
	`libh®_psi_Ãxt
 (&it)) {

949 
ty³
;

950 *
key
;

952 
ty³
 = 
	`libh®_psi_g‘_ty³
 (&
™
);

953 
key
 = 
	`libh®_psi_g‘_key
 (&
™
);

955 
LIBHAL_PROP_EXTRACT_BEGIN
;

957 
	`LIBHAL_PROP_EXTRACT_INT
 ("block.mšÜ", 
drive
->
deviû_mšÜ
);

958 
	`LIBHAL_PROP_EXTRACT_INT
 ("block.majÜ", 
drive
->
deviû_majÜ
);

959 
	`LIBHAL_PROP_EXTRACT_STRING
 ("block.deviû", 
drive
->
deviû_fe
);

960 
	`LIBHAL_PROP_EXTRACT_STRING
 ("¡Üage.bus", 
bus_‹xtu®
);

961 
	`LIBHAL_PROP_EXTRACT_STRING
 ("¡Üage.v’dÜ", 
drive
->
v’dÜ
);

962 
	`LIBHAL_PROP_EXTRACT_STRING
 ("¡Üage.mod–", 
drive
->
mod–
);

963 
	`LIBHAL_PROP_EXTRACT_STRING
 ("¡Üage.drive_ty³", 
drive
->
ty³_‹xtu®
);

964 
	`LIBHAL_PROP_EXTRACT_UINT64
 ("¡Üage.size", 
drive
->
drive_size
);

966 
	`LIBHAL_PROP_EXTRACT_STRING
 ("¡Üage.icÚ.drive", 
drive
->
dediÿ‹d_icÚ_drive
);

967 
	`LIBHAL_PROP_EXTRACT_STRING
 ("¡Üage.icÚ.vŞume", 
drive
->
dediÿ‹d_icÚ_vŞume
);

969 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("¡Üage.hÙ¶uggabË", 
drive
->
is_hÙ¶uggabË
);

970 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("¡Üage.»movabË", 
drive
->
is_»movabË
);

971 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("¡Üage.»movabË.medŸ_avaabË", 
drive
->
is_medŸ_d‘eùed
);

972 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("¡Üage.medŸ_check_’abËd", 
drive
->
is_medŸ_d‘eùiÚ_autom©ic
);

973 
	`LIBHAL_PROP_EXTRACT_UINT64
 ("¡Üage.»movabË.medŸ_size", 
drive
->
drive_medŸ_size
);

974 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("¡Üage.»quœes_ejeù", 
drive
->
»quœes_ejeù
);

976 
	`LIBHAL_PROP_EXTRACT_STRING
 ("¡Üage.·¹™iÚšg_scheme", 
drive
->
·¹™iÚ_scheme
);

978 
	`LIBHAL_PROP_EXTRACT_STRING
 ("¡Üage.Üigš©šg_deviû", 
drive
->
physiÿl_deviû
);

979 
	`LIBHAL_PROP_EXTRACT_STRING
 ("¡Üage.fœmw¬e_v”siÚ", 
drive
->
fœmw¬e_v”siÚ
);

980 
	`LIBHAL_PROP_EXTRACT_STRING
 ("¡Üage.£rŸl", 
drive
->
£rŸl
);

982 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.cdr", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_CDR
);

983 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.cdrw", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_CDRW
);

984 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.dvd", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_DVDROM
);

985 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.dvd¶u¤", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSR
);

986 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.dvd¶u¤w", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSRW
);

987 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.dvd¶u¤wdl", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSRWDL
);

988 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.dvd¶u¤dl", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSRDL
);

989 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.dvdr", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_DVDR
);

990 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.dvdrw", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_DVDRW
);

991 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.dvd¿m", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_DVDRAM
);

992 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.bd", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_BDROM
);

993 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.bdr", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_BDR
);

994 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.bd»", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_BDRE
);

995 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.hddvd", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_HDDVDROM
);

996 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.hddvdr", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_HDDVDR
);

997 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.hddvdrw", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_HDDVDRW
);

998 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.mo", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_MO
);

999 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.mrw", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_MRW
);

1000 
	`LIBHAL_PROP_EXTRACT_BOOL_BITFIELD
 ("¡Üage.cdrom.mrw_w", 
drive
->
cdrom_ÿps
, 
LIBHAL_DRIVE_CDROM_CAPS_MRWW
);

1002 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("¡Üage.pŞicy.should_mouÁ", 
drive
->
should_mouÁ
);

1003 
	`LIBHAL_PROP_EXTRACT_STRING
 ("¡Üage.pŞicy.desœed_mouÁ_pošt", 
drive
->
desœed_mouÁ_pošt
);

1004 
	`LIBHAL_PROP_EXTRACT_STRING
 ("¡Üage.pŞicy.mouÁ_fesy¡em", 
drive
->
mouÁ_fesy¡em
);

1006 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("¡Üage.no_·¹™iÚs_hšt", 
drive
->
no_·¹™iÚs_hšt
);

1008 
	`LIBHAL_PROP_EXTRACT_STRLIST
 ("šfo.ÿ·b™›s", 
drive
->
ÿ·b™›s
);

1010 
LIBHAL_PROP_EXTRACT_END
;

1013 ià(
drive
->
ty³_‹xtu®
 !ğ
NULL
) {

1014 ià(
	`¡rcmp
 (
drive
->
ty³_‹xtu®
, "cdrom") == 0) {

1015 
drive
->
cdrom_ÿps
 |ğ
LIBHAL_DRIVE_CDROM_CAPS_CDROM
;

1016 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_CDROM
;

1017 } ià(
	`¡rcmp
 (
drive
->
ty³_‹xtu®
, "optical") == 0) {

1018 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_MO
;

1019 } ià(
	`¡rcmp
 (
drive
->
ty³_‹xtu®
, "floppy") == 0) {

1020 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_FLOPPY
;

1021 } ià(
	`¡rcmp
 (
drive
->
ty³_‹xtu®
, "disk") == 0) {

1022 ià(
drive
->
is_»movabË
)

1023 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_REMOVABLE_DISK
;

1025 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_DISK
;

1026 } ià(
	`¡rcmp
 (
drive
->
ty³_‹xtu®
, "tape") == 0) {

1027 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_TAPE
;

1028 } ià(
	`¡rcmp
 (
drive
->
ty³_‹xtu®
, "compact_flash") == 0) {

1029 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_COMPACT_FLASH
;

1030 } ià(
	`¡rcmp
 (
drive
->
ty³_‹xtu®
, "memory_stick") == 0) {

1031 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_MEMORY_STICK
;

1032 } ià(
	`¡rcmp
 (
drive
->
ty³_‹xtu®
, "smart_media") == 0) {

1033 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_SMART_MEDIA
;

1034 } ià(
	`¡rcmp
 (
drive
->
ty³_‹xtu®
, "sd_mmc") == 0) {

1035 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_SD_MMC
;

1036 } ià(
	`¡rcmp
 (
drive
->
ty³_‹xtu®
, "zip") == 0) {

1037 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_ZIP
;

1038 } ià(
	`¡rcmp
 (
drive
->
ty³_‹xtu®
, "jaz") == 0) {

1039 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_JAZ
;

1040 } ià(
	`¡rcmp
 (
drive
->
ty³_‹xtu®
, "flashkey") == 0) {

1041 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_FLASHKEY
;

1043 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_DISK
;

1048 ià(
drive
->
ÿ·b™›s
 !ğ
NULL
) {

1049 
i
 = 0; 
drive
->
ÿ·b™›s
[i] !ğ
NULL
; i++) {

1050 ià(
	`¡rcmp
 (
drive
->
ÿ·b™›s
[
i
], "portable_audio_player") == 0) {

1051 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_PORTABLE_AUDIO_PLAYER
;

1053 } ià(
	`¡rcmp
 (
drive
->
ÿ·b™›s
[
i
], "camera") == 0) {

1054 
drive
->
ty³
 = 
LIBHAL_DRIVE_TYPE_CAMERA
;

1060 ià(
bus_‹xtu®
 !ğ
NULL
) {

1061 ià(
	`¡rcmp
 (
bus_‹xtu®
, "usb") == 0) {

1062 
drive
->
bus
 = 
LIBHAL_DRIVE_BUS_USB
;

1063 } ià(
	`¡rcmp
 (
bus_‹xtu®
, "ieee1394") == 0) {

1064 
drive
->
bus
 = 
LIBHAL_DRIVE_BUS_IEEE1394
;

1065 } ià(
	`¡rcmp
 (
bus_‹xtu®
, "ide") == 0) {

1066 
drive
->
bus
 = 
LIBHAL_DRIVE_BUS_IDE
;

1067 } ià(
	`¡rcmp
 (
bus_‹xtu®
, "scsi") == 0) {

1068 
drive
->
bus
 = 
LIBHAL_DRIVE_BUS_SCSI
;

1069 } ià(
	`¡rcmp
 (
bus_‹xtu®
, "ccw") == 0) {

1070 
drive
->
bus
 = 
LIBHAL_DRIVE_BUS_CCW
;

1074 
	`libh®_ä“_¡ršg
 (
bus_‹xtu®
);

1075 
	`libh®_ä“_´İ”ty_£t
 (
´İ”t›s
);

1077  
drive
;

1079 
”rÜ
:

1080 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1081 
	`libh®_ä“_¡ršg
 (
bus_‹xtu®
);

1082 
	`libh®_ä“_´İ”ty_£t
 (
´İ”t›s
);

1083 
	`libh®_drive_ä“
 (
drive
);

1084  
NULL
;

1085 
	}
}

1088 
	$libh®_vŞume_g‘_¡Üage_deviû_udi
 (
LibH®VŞume
 *
vŞume
)

1090  
vŞume
->
¡Üage_deviû
;

1091 
	}
}

1093 cÚ¡ *
	$libh®_drive_g‘_physiÿl_deviû_udi
 (
LibH®Drive
 *
drive
)

1095  
drive
->
physiÿl_deviû
;

1096 
	}
}

1098 
dbus_boŞ_t


1099 
	$libh®_drive_»quœes_ejeù
 (
LibH®Drive
 *
drive
)

1101  
drive
->
»quœes_ejeù
;

1102 
	}
}

1115 
LibH®VŞume
 *

1116 
	$libh®_vŞume_äom_udi
 (
LibH®CÚ‹xt
 *
h®_ùx
, cÚ¡ *
udi
)

1118 *
disc_ty³_‹xtu®
;

1119 *
vŞ_fsu§ge_‹xtu®
;

1120 
LibH®VŞume
 *
vŞ
;

1121 
LibH®Prİ”tyS‘
 *
´İ”t›s
;

1122 
LibH®Prİ”tyS‘I‹¿tÜ
 
™
;

1123 
DBusE¼Ü
 
”rÜ
;

1125 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
h®_ùx
, 
NULL
);

1127 
vŞ
 = 
NULL
;

1128 
´İ”t›s
 = 
NULL
;

1129 
disc_ty³_‹xtu®
 = 
NULL
;

1130 
vŞ_fsu§ge_‹xtu®
 = 
NULL
;

1132 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1133 ià(!
	`libh®_deviû_qu”y_ÿ·b™y
 (
h®_ùx
, 
udi
, "vŞume", &
”rÜ
))

1134 
”rÜ
;

1136 
vŞ
 = 
	`m®loc
 ( (
LibH®VŞume
));

1137 ià(
vŞ
 =ğ
NULL
)

1138 
”rÜ
;

1139 
	`mem£t
 (
vŞ
, 0x00,  (
LibH®VŞume
));

1141 
vŞ
->
udi
 = 
	`¡rdup
 (udi);

1143 
´İ”t›s
 = 
	`libh®_deviû_g‘_®l_´İ”t›s
 (
h®_ùx
, 
udi
, &
”rÜ
);

1144 ià(
´İ”t›s
 =ğ
NULL
)

1145 
”rÜ
;

1148 
	`libh®_psi_š™
 (&
™
, 
´İ”t›s
); 
	`libh®_psi_has_mÜe
 (&™); 
	`libh®_psi_Ãxt
 (&it)) {

1149 
ty³
;

1150 *
key
;

1152 
ty³
 = 
	`libh®_psi_g‘_ty³
 (&
™
);

1153 
key
 = 
	`libh®_psi_g‘_key
 (&
™
);

1155 
LIBHAL_PROP_EXTRACT_BEGIN
;

1157 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("vŞume.is_·¹™iÚ", 
vŞ
->
is_·¹™iÚ
);

1158 
	`LIBHAL_PROP_EXTRACT_INT
 ("vŞume.·¹™iÚ.numb”", 
vŞ
->
·¹™iÚ_numb”
);

1159 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.·¹™iÚ.scheme", 
vŞ
->
·¹™iÚ_scheme
);

1160 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.·¹™iÚ.ty³", 
vŞ
->
·¹™iÚ_ty³
);

1161 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.·¹™iÚ.Ïb–", 
vŞ
->
·¹™iÚ_Ïb–
);

1162 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.·¹™iÚ.uuid", 
vŞ
->
·¹™iÚ_uuid
);

1163 
	`LIBHAL_PROP_EXTRACT_STRLIST
 ("vŞume.·¹™iÚ.æags", 
vŞ
->
·¹™iÚ_æags
);

1165 
	`LIBHAL_PROP_EXTRACT_UINT64
 ("vŞume.·¹™iÚ.¡¬t", 
vŞ
->
·¹™iÚ_¡¬t_off£t
);

1166 
	`LIBHAL_PROP_EXTRACT_UINT64
 ("vŞume.·¹™iÚ.medŸ_size", 
vŞ
->
·¹™iÚ_medŸ_size
);

1167 
	`LIBHAL_PROP_EXTRACT_INT
 ("vŞume.·¹™iÚ.msdos_·¹_bË_ty³", 
vŞ
->
msdos_·¹_bË_ty³
);

1168 
	`LIBHAL_PROP_EXTRACT_UINT64
 ("vŞume.·¹™iÚ.msdos_·¹_bË_¡¬t", 
vŞ
->
msdos_·¹_bË_¡¬t
);

1169 
	`LIBHAL_PROP_EXTRACT_UINT64
 ("vŞume.·¹™iÚ.msdos_·¹_bË_size", 
vŞ
->
msdos_·¹_bË_size
);

1171 
	`LIBHAL_PROP_EXTRACT_INT
 ("block.mšÜ", 
vŞ
->
deviû_mšÜ
);

1172 
	`LIBHAL_PROP_EXTRACT_INT
 ("block.majÜ", 
vŞ
->
deviû_majÜ
);

1173 
	`LIBHAL_PROP_EXTRACT_STRING
 ("block.deviû", 
vŞ
->
deviû_fe
);

1175 
	`LIBHAL_PROP_EXTRACT_STRING
 ("block.¡Üage_deviû", 
vŞ
->
¡Üage_deviû
);

1177 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.üy±o_luks.ş—r.backšg_vŞume", 
vŞ
->
üy±o_backšg_vŞume
);

1179 
	`LIBHAL_PROP_EXTRACT_INT
 ("vŞume.block_size", 
vŞ
->
block_size
);

1180 
	`LIBHAL_PROP_EXTRACT_INT
 ("vŞume.num_blocks", 
vŞ
->
num_blocks
);

1181 
	`LIBHAL_PROP_EXTRACT_UINT64
 ("vŞume.size", 
vŞ
->
vŞume_size
);

1182 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.Ïb–", 
vŞ
->
vŞume_Ïb–
);

1183 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.mouÁ_pošt", 
vŞ
->
mouÁ_pošt
);

1184 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.f¡y³", 
vŞ
->
f¡y³
);

1185 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.fsv”siÚ", 
vŞ
->
fsv”siÚ
);

1186 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("vŞume.is_mouÁed", 
vŞ
->
is_mouÁed
);

1187 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("vŞume.is_mouÁed_»ad_Úly", 
vŞ
->
is_mouÁed_»ad_Úly
);

1188 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.fsu§ge", 
vŞ_fsu§ge_‹xtu®
);

1189 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.uuid", 
vŞ
->
uuid
);

1191 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("vŞume.ignÜe", 
vŞ
->
ignÜe_vŞume
);

1193 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("vŞume.is_disc", 
vŞ
->
is_disc
);

1194 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.disc.ty³", 
disc_ty³_‹xtu®
);

1195 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("vŞume.disc.has_audio", 
vŞ
->
disc_has_audio
);

1196 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("vŞume.disc.has_d©a", 
vŞ
->
disc_has_d©a
);

1197 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("vŞume.disc.is_­³ndabË", 
vŞ
->
disc_is_­³ndabË
);

1198 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("vŞume.disc.is_bÏnk", 
vŞ
->
disc_is_bÏnk
);

1199 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("vŞume.disc.is_»wr™abË", 
vŞ
->
disc_is_»wr™abË
);

1200 
	`LIBHAL_PROP_EXTRACT_UINT64
 ("vŞume.disc.ÿ·c™y", 
vŞ
->
disc_ÿ·c™y
);

1202 
	`LIBHAL_PROP_EXTRACT_BOOL
 ("vŞume.pŞicy.should_mouÁ", 
vŞ
->
should_mouÁ
);

1203 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.pŞicy.desœed_mouÁ_pošt", 
vŞ
->
desœed_mouÁ_pošt
);

1204 
	`LIBHAL_PROP_EXTRACT_STRING
 ("vŞume.pŞicy.mouÁ_fesy¡em", 
vŞ
->
mouÁ_fesy¡em
);

1206 
LIBHAL_PROP_EXTRACT_END
;

1209 ià(
disc_ty³_‹xtu®
 !ğ
NULL
) {

1210 ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "cd_rom") == 0) {

1211 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_CDROM
;

1212 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "cd_r") == 0) {

1213 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_CDR
;

1214 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "cd_rw") == 0) {

1215 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_CDRW
;

1216 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "dvd_rom") == 0) {

1217 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_DVDROM
;

1218 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "dvd_ram") == 0) {

1219 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_DVDRAM
;

1220 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "dvd_r") == 0) {

1221 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_DVDR
;

1222 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "dvd_rw") == 0) {

1223 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_DVDRW
;

1224 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "dvd_r_dl") == 0) {

1225 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_DVDR_DL
;

1226 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "dvd_plus_r") == 0) {

1227 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_DVDPLUSR
;

1228 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "dvd_plus_rw") == 0) {

1229 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_DVDPLUSRW
;

1230 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "dvd_plus_r_dl") == 0) {

1231 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_DVDPLUSR_DL
;

1232 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "bd_rom") == 0) {

1233 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_BDROM
;

1234 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "bd_r") == 0) {

1235 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_BDR
;

1236 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "bd_re") == 0) {

1237 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_BDRE
;

1238 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "hddvd_rom") == 0) {

1239 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_HDDVDROM
;

1240 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "hddvd_r") == 0) {

1241 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_HDDVDR
;

1242 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "hddvd_rw") == 0) {

1243 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_HDDVDRW
;

1244 } ià(
	`¡rcmp
 (
disc_ty³_‹xtu®
, "mo") == 0) {

1245 
vŞ
->
disc_ty³
 = 
LIBHAL_VOLUME_DISC_TYPE_MO
;

1249 
vŞ
->
fsu§ge
 = 
LIBHAL_VOLUME_USAGE_UNKNOWN
;

1250 ià(
vŞ_fsu§ge_‹xtu®
 !ğ
NULL
) {

1251 ià(
	`¡rcmp
 (
vŞ_fsu§ge_‹xtu®
, "filesystem") == 0) {

1252 
vŞ
->
fsu§ge
 = 
LIBHAL_VOLUME_USAGE_MOUNTABLE_FILESYSTEM
;

1253 } ià(
	`¡rcmp
 (
vŞ_fsu§ge_‹xtu®
, "partitiontable") == 0) {

1254 
vŞ
->
fsu§ge
 = 
LIBHAL_VOLUME_USAGE_PARTITION_TABLE
;

1255 } ià(
	`¡rcmp
 (
vŞ_fsu§ge_‹xtu®
, "raid") == 0) {

1256 
vŞ
->
fsu§ge
 = 
LIBHAL_VOLUME_USAGE_RAID_MEMBER
;

1257 } ià(
	`¡rcmp
 (
vŞ_fsu§ge_‹xtu®
, "crypto") == 0) {

1258 
vŞ
->
fsu§ge
 = 
LIBHAL_VOLUME_USAGE_CRYPTO
;

1259 } ià(
	`¡rcmp
 (
vŞ_fsu§ge_‹xtu®
, "other") == 0) {

1260 
vŞ
->
fsu§ge
 = 
LIBHAL_VOLUME_USAGE_OTHER
;

1262 
vŞ
->
fsu§ge
 = 
LIBHAL_VOLUME_USAGE_UNKNOWN
;

1266 
	`libh®_ä“_¡ršg
 (
vŞ_fsu§ge_‹xtu®
);

1267 
	`libh®_ä“_¡ršg
 (
disc_ty³_‹xtu®
);

1268 
	`libh®_ä“_´İ”ty_£t
 (
´İ”t›s
);

1269  
vŞ
;

1270 
”rÜ
:

1271 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

1272 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

1274 
	`libh®_ä“_¡ršg
 (
vŞ_fsu§ge_‹xtu®
);

1275 
	`libh®_ä“_¡ršg
 (
disc_ty³_‹xtu®
);

1276 
	`libh®_ä“_´İ”ty_£t
 (
´İ”t›s
);

1277 
	`libh®_vŞume_ä“
 (
vŞ
);

1278  
NULL
;

1279 
	}
}

1294 
	$libh®_vŞume_g‘_msdos_·¹_bË_ty³
 (
LibH®VŞume
 *
vŞume
)

1296  
vŞume
->
msdos_·¹_bË_ty³
;

1297 
	}
}

1310 
dbus_ušt64_t


1311 
	$libh®_vŞume_g‘_msdos_·¹_bË_¡¬t
 (
LibH®VŞume
 *
vŞume
)

1313  
vŞume
->
msdos_·¹_bË_¡¬t
;

1314 
	}
}

1327 
dbus_ušt64_t


1328 
	$libh®_vŞume_g‘_msdos_·¹_bË_size
 (
LibH®VŞume
 *
vŞume
)

1330  
vŞume
->
msdos_·¹_bË_size
;

1331 
	}
}

1345 
LibH®Drive
 *

1346 
	$libh®_drive_äom_deviû_fe
 (
LibH®CÚ‹xt
 *
h®_ùx
, cÚ¡ *
deviû_fe
)

1348 
i
;

1349 **
h®_udis
;

1350 
num_h®_udis
;

1351 
LibH®Drive
 *
»suÉ
;

1352 *
found_udi
;

1353 
DBusE¼Ü
 
”rÜ
;

1355 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
h®_ùx
, 
NULL
);

1357 
»suÉ
 = 
NULL
;

1358 
found_udi
 = 
NULL
;

1360 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1361 ià((
h®_udis
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
h®_ùx
, "block.device",

1362 
deviû_fe
, &
num_h®_udis
, &
”rÜ
)è=ğ
NULL
) {

1363 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1364 
out
;

1367 
i
 = 0; i < 
num_h®_udis
; i++) {

1368 *
udi
;

1369 *
¡Üage_udi
;

1370 
DBusE¼Ü
 
”r1
;

1371 
DBusE¼Ü
 
”r2
;

1372 
udi
 = 
h®_udis
[
i
];

1374 
	`dbus_”rÜ_š™
 (&
”r1
);

1375 
	`dbus_”rÜ_š™
 (&
”r2
);

1376 ià(
	`libh®_deviû_qu”y_ÿ·b™y
 (
h®_ùx
, 
udi
, "vŞume", &
”r1
)) {

1378 
¡Üage_udi
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
h®_ùx
, 
udi
, "block.¡Üage_deviû", &
”r1
);

1379 ià(
¡Üage_udi
 =ğ
NULL
)

1381 
found_udi
 = 
	`¡rdup
 (
¡Üage_udi
);

1382 
	`libh®_ä“_¡ršg
 (
¡Üage_udi
);

1384 } ià(
	`libh®_deviû_qu”y_ÿ·b™y
 (
h®_ùx
, 
udi
, "¡Üage", &
”r2
)) {

1385 
found_udi
 = 
	`¡rdup
 (
udi
);

1387 
	`LIBHAL_FREE_DBUS_ERROR
(&
”r1
);

1388 
	`LIBHAL_FREE_DBUS_ERROR
(&
”r2
);

1391 
	`libh®_ä“_¡ršg_¬¿y
 (
h®_udis
);

1393 ià(
found_udi
 !ğ
NULL
)

1394 
»suÉ
 = 
	`libh®_drive_äom_udi
 (
h®_ùx
, 
found_udi
);

1396 
	`ä“
 (
found_udi
);

1397 
out
:

1398  
»suÉ
;

1399 
	}
}

1411 
LibH®VŞume
 *

1412 
	$libh®_vŞume_äom_mouÁ_pošt
 (
LibH®CÚ‹xt
 *
h®_ùx
,

1413 cÚ¡ *
mouÁ_pošt
)

1415 
i
;

1416 **
h®_udis
;

1417 
num_h®_udis
;

1418 
LibH®VŞume
 *
»suÉ
;

1419 *
found_udi
;

1420 
DBusE¼Ü
 
”rÜ
;

1422 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
h®_ùx
, 
NULL
);

1424 
»suÉ
 = 
NULL
;

1425 
found_udi
 = 
NULL
;

1427 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1428 ià((
h®_udis
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
h®_ùx
, "volume.mount_point",

1429 
mouÁ_pošt
, &
num_h®_udis
, &
”rÜ
)è=ğ
NULL
)

1430 
out
;

1432 
i
 = 0; i < 
num_h®_udis
; i++) {

1433 *
udi
;

1434 
udi
 = 
h®_udis
[
i
];

1435 ià(
	`libh®_deviû_qu”y_ÿ·b™y
 (
h®_ùx
, 
udi
, "vŞume", &
”rÜ
)) {

1436 
found_udi
 = 
	`¡rdup
 (
udi
);

1441 
	`libh®_ä“_¡ršg_¬¿y
 (
h®_udis
);

1443 ià(
found_udi
 !ğ
NULL
)

1444 
»suÉ
 = 
	`libh®_vŞume_äom_udi
 (
h®_ùx
, 
found_udi
);

1446 
	`ä“
 (
found_udi
);

1447 
out
:

1448 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1449  
»suÉ
;

1450 
	}
}

1461 
LibH®VŞume
 *

1462 
	$libh®_vŞume_äom_deviû_fe
 (
LibH®CÚ‹xt
 *
h®_ùx
, cÚ¡ *
deviû_fe
)

1464 
i
;

1465 **
h®_udis
;

1466 
num_h®_udis
;

1467 
LibH®VŞume
 *
»suÉ
;

1468 *
found_udi
;

1469 
DBusE¼Ü
 
”rÜ
;

1471 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
h®_ùx
, 
NULL
);

1473 
»suÉ
 = 
NULL
;

1474 
found_udi
 = 
NULL
;

1476 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1477 ià((
h®_udis
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
h®_ùx
, "block.device",

1478 
deviû_fe
, &
num_h®_udis
, &
”rÜ
)è=ğ
NULL
)

1479 
out
;

1481 
i
 = 0; i < 
num_h®_udis
; i++) {

1482 *
udi
;

1483 
udi
 = 
h®_udis
[
i
];

1484 ià(
	`libh®_deviû_qu”y_ÿ·b™y
 (
h®_ùx
, 
udi
, "vŞume", &
”rÜ
)) {

1485 
found_udi
 = 
	`¡rdup
 (
udi
);

1490 
	`libh®_ä“_¡ršg_¬¿y
 (
h®_udis
);

1492 ià(
found_udi
 !ğ
NULL
)

1493 
»suÉ
 = 
	`libh®_vŞume_äom_udi
 (
h®_ùx
, 
found_udi
);

1495 
	`ä“
 (
found_udi
);

1496 
out
:

1497 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1498  
»suÉ
;

1499 
	}
}

1501 
dbus_ušt64_t


1502 
	$libh®_vŞume_g‘_size
 (
LibH®VŞume
 *
vŞume
)

1504 ià(
vŞume
->
vŞume_size
 > 0)

1505  
vŞume
->
vŞume_size
;

1507  ((
dbus_ušt64_t
)
vŞume
->
block_size
è* ((dbus_ušt64_t)vŞume->
num_blocks
);

1508 
	}
}

1510 
dbus_ušt64_t


1511 
	$libh®_vŞume_g‘_disc_ÿ·c™y
 (
LibH®VŞume
 *
vŞume
)

1513  
vŞume
->
disc_ÿ·c™y
;

1514 
	}
}

1517 
dbus_boŞ_t


1518 
	$libh®_drive_is_hÙ¶uggabË
 (
LibH®Drive
 *
drive
)

1520  
drive
->
is_hÙ¶uggabË
;

1521 
	}
}

1523 
dbus_boŞ_t


1524 
	$libh®_drive_u£s_»movabË_medŸ
 (
LibH®Drive
 *
drive
)

1526  
drive
->
is_»movabË
;

1527 
	}
}

1529 
dbus_boŞ_t


1530 
	$libh®_drive_is_medŸ_d‘eùed
 (
LibH®Drive
 *
drive
)

1532  
drive
->
is_medŸ_d‘eùed
;

1533 
	}
}

1535 
dbus_boŞ_t


1536 
	$libh®_drive_is_medŸ_d‘eùiÚ_autom©ic
 (
LibH®Drive
 *
drive
)

1538  
drive
->
is_medŸ_d‘eùiÚ_autom©ic
;

1539 
	}
}

1541 
dbus_ušt64_t


1542 
	$libh®_drive_g‘_size
 (
LibH®Drive
 *
drive
)

1544  
drive
->
drive_size
;

1545 
	}
}

1547 
dbus_ušt64_t


1548 
	$libh®_drive_g‘_medŸ_size
 (
LibH®Drive
 *
drive
)

1550  
drive
->
drive_medŸ_size
;

1551 
	}
}

1554 
	$libh®_drive_g‘_·¹™iÚ_scheme
 (
LibH®Drive
 *
drive
)

1556  
drive
->
·¹™iÚ_scheme
;

1557 
	}
}

1560 
LibH®DriveTy³


1561 
	$libh®_drive_g‘_ty³
 (
LibH®Drive
 *
drive
)

1563  
drive
->
ty³
;

1564 
	}
}

1566 
LibH®DriveBus


1567 
	$libh®_drive_g‘_bus
 (
LibH®Drive
 *
drive
)

1569  
drive
->
bus
;

1570 
	}
}

1572 
LibH®DriveCdromC­s


1573 
	$libh®_drive_g‘_cdrom_ÿps
 (
LibH®Drive
 *
drive
)

1575  
drive
->
cdrom_ÿps
;

1576 
	}
}

1579 
	$libh®_drive_g‘_deviû_majÜ
 (
LibH®Drive
 *
drive
)

1581  
drive
->
deviû_majÜ
;

1582 
	}
}

1585 
	$libh®_drive_g‘_deviû_mšÜ
 (
LibH®Drive
 *
drive
)

1587  
drive
->
deviû_mšÜ
;

1588 
	}
}

1591 
	$libh®_drive_g‘_ty³_‹xtu®
 (
LibH®Drive
 *
drive
)

1593  
drive
->
ty³_‹xtu®
;

1594 
	}
}

1597 
	$libh®_drive_g‘_deviû_fe
 (
LibH®Drive
 *
drive
)

1599  
drive
->
deviû_fe
;

1600 
	}
}

1603 
	$libh®_drive_g‘_udi
 (
LibH®Drive
 *
drive
)

1605  
drive
->
udi
;

1606 
	}
}

1609 
	$libh®_drive_g‘_£rŸl
 (
LibH®Drive
 *
drive
)

1611  
drive
->
£rŸl
;

1612 
	}
}

1615 
	$libh®_drive_g‘_fœmw¬e_v”siÚ
 (
LibH®Drive
 *
drive
)

1617  
drive
->
fœmw¬e_v”siÚ
;

1618 
	}
}

1621 
	$libh®_drive_g‘_mod–
 (
LibH®Drive
 *
drive
)

1623  
drive
->
mod–
;

1624 
	}
}

1627 
	$libh®_drive_g‘_v’dÜ
 (
LibH®Drive
 *
drive
)

1629  
drive
->
v’dÜ
;

1630 
	}
}

1635 
	$libh®_vŞume_g‘_udi
 (
LibH®VŞume
 *
vŞume
)

1637  
vŞume
->
udi
;

1638 
	}
}

1641 
	$libh®_vŞume_g‘_deviû_fe
 (
LibH®VŞume
 *
vŞume
)

1643  
vŞume
->
deviû_fe
;

1644 
	}
}

1646 
	$libh®_vŞume_g‘_deviû_majÜ
 (
LibH®VŞume
 *
vŞume
)

1648  
vŞume
->
deviû_majÜ
;

1649 
	}
}

1651 
	$libh®_vŞume_g‘_deviû_mšÜ
 (
LibH®VŞume
 *
vŞume
)

1653  
vŞume
->
deviû_mšÜ
;

1654 
	}
}

1657 
	$libh®_vŞume_g‘_f¡y³
 (
LibH®VŞume
 *
vŞume
)

1659  
vŞume
->
f¡y³
;

1660 
	}
}

1663 
	$libh®_vŞume_g‘_fsv”siÚ
 (
LibH®VŞume
 *
vŞume
)

1665  
vŞume
->
fsv”siÚ
;

1666 
	}
}

1668 
LibH®VŞumeU§ge


1669 
	$libh®_vŞume_g‘_fsu§ge
 (
LibH®VŞume
 *
vŞume
)

1671  
vŞume
->
fsu§ge
;

1672 
	}
}

1674 
dbus_boŞ_t


1675 
	$libh®_vŞume_is_mouÁed
 (
LibH®VŞume
 *
vŞume
)

1677  
vŞume
->
is_mouÁed
;

1678 
	}
}

1680 
dbus_boŞ_t


1681 
	$libh®_vŞume_is_mouÁed_»ad_Úly
 (
LibH®VŞume
 *
vŞume
)

1683  
vŞume
->
is_mouÁed_»ad_Úly
;

1684 
	}
}

1686 
dbus_boŞ_t


1687 
	$libh®_vŞume_is_·¹™iÚ
 (
LibH®VŞume
 *
vŞume
)

1689  
vŞume
->
is_·¹™iÚ
;

1690 
	}
}

1692 
dbus_boŞ_t


1693 
	$libh®_vŞume_is_disc
 (
LibH®VŞume
 *
vŞume
)

1695  
vŞume
->
is_disc
;

1696 
	}
}

1699 
	$libh®_vŞume_g‘_·¹™iÚ_numb”
 (
LibH®VŞume
 *
vŞume
)

1701  
vŞume
->
·¹™iÚ_numb”
;

1702 
	}
}

1705 
	$libh®_vŞume_g‘_·¹™iÚ_scheme
 (
LibH®VŞume
 *
vŞume
)

1707  
vŞume
->
·¹™iÚ_scheme
;

1708 
	}
}

1711 
	$libh®_vŞume_g‘_·¹™iÚ_ty³
 (
LibH®VŞume
 *
vŞume
)

1713  
vŞume
->
·¹™iÚ_ty³
;

1714 
	}
}

1717 
	$libh®_vŞume_g‘_·¹™iÚ_Ïb–
 (
LibH®VŞume
 *
vŞume
)

1719  
vŞume
->
·¹™iÚ_Ïb–
;

1720 
	}
}

1723 
	$libh®_vŞume_g‘_·¹™iÚ_uuid
 (
LibH®VŞume
 *
vŞume
)

1725  
vŞume
->
·¹™iÚ_uuid
;

1726 
	}
}

1729 
	$libh®_vŞume_g‘_·¹™iÚ_æags
 (
LibH®VŞume
 *
vŞume
)

1731  (cÚ¡ **è
vŞume
->
·¹™iÚ_æags
;

1732 
	}
}

1735 
dbus_ušt64_t


1736 
	$libh®_vŞume_g‘_·¹™iÚ_¡¬t_off£t
 (
LibH®VŞume
 *
vŞume
)

1738  
vŞume
->
·¹™iÚ_¡¬t_off£t
;

1739 
	}
}

1741 
dbus_ušt64_t


1742 
	$libh®_vŞume_g‘_·¹™iÚ_medŸ_size
 (
LibH®VŞume
 *
vŞume
)

1744  
vŞume
->
·¹™iÚ_medŸ_size
;

1745 
	}
}

1748 
	$libh®_vŞume_g‘_Ïb–
 (
LibH®VŞume
 *
vŞume
)

1750  
vŞume
->
vŞume_Ïb–
;

1751 
	}
}

1754 
	$libh®_vŞume_g‘_mouÁ_pošt
 (
LibH®VŞume
 *
vŞume
)

1756  
vŞume
->
mouÁ_pošt
;

1757 
	}
}

1760 
	$libh®_vŞume_g‘_uuid
 (
LibH®VŞume
 *
vŞume
)

1762  
vŞume
->
uuid
;

1763 
	}
}

1765 
dbus_boŞ_t


1766 
	$libh®_vŞume_disc_has_audio
 (
LibH®VŞume
 *
vŞume
)

1768  
vŞume
->
disc_has_audio
;

1769 
	}
}

1771 
dbus_boŞ_t


1772 
	$libh®_vŞume_disc_has_d©a
 (
LibH®VŞume
 *
vŞume
)

1774  
vŞume
->
disc_has_d©a
;

1775 
	}
}

1777 
dbus_boŞ_t


1778 
	$libh®_vŞume_disc_is_bÏnk
 (
LibH®VŞume
 *
vŞume
)

1780  
vŞume
->
disc_is_bÏnk
;

1781 
	}
}

1783 
dbus_boŞ_t


1784 
	$libh®_vŞume_disc_is_»wr™abË
 (
LibH®VŞume
 *
vŞume
)

1786  
vŞume
->
disc_is_»wr™abË
;

1787 
	}
}

1789 
dbus_boŞ_t


1790 
	$libh®_vŞume_disc_is_­³ndabË
 (
LibH®VŞume
 *
vŞume
)

1792  
vŞume
->
disc_is_­³ndabË
;

1793 
	}
}

1795 
LibH®VŞumeDiscTy³


1796 
	$libh®_vŞume_g‘_disc_ty³
 (
LibH®VŞume
 *
vŞume
)

1798  
vŞume
->
disc_ty³
;

1799 
	}
}

1801 
dbus_boŞ_t


1802 
	$libh®_vŞume_should_ignÜe
 (
LibH®VŞume
 *
vŞume
)

1804  
vŞume
->
ignÜe_vŞume
;

1805 
	}
}

1808 
	$libh®_drive_fšd_®l_vŞumes
 (
LibH®CÚ‹xt
 *
h®_ùx
, 
LibH®Drive
 *
drive
, *
num_vŞumes
)

1810 
i
;

1811 **
udis
;

1812 
num_udis
;

1813 cÚ¡ *
drive_udi
;

1814 **
»suÉ
;

1815 
DBusE¼Ü
 
”rÜ
;

1817 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
h®_ùx
, 
NULL
);

1819 
udis
 = 
NULL
;

1820 
»suÉ
 = 
NULL
;

1821 *
num_vŞumes
 = 0;

1823 
drive_udi
 = 
	`libh®_drive_g‘_udi
 (
drive
);

1824 ià(
drive_udi
 =ğ
NULL
)

1825 
out
;

1828 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1829 ià((
udis
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
h®_ùx
, "block.storage_device",

1830 
drive_udi
, &
num_udis
, &
”rÜ
)è=ğ
NULL
) {

1831 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1832 
out
;

1835 
»suÉ
 = 
	`m®loc
 ( (*è* 
num_udis
);

1836 ià(
»suÉ
 =ğ
NULL
)

1837 
out
;

1840 
i
 = 0; i < 
num_udis
; i++) {

1841 ià(
	`¡rcmp
 (
udis
[
i
], 
drive_udi
) == 0)

1843 
»suÉ
[*
num_vŞumes
] = 
	`¡rdup
 (
udis
[
i
]);

1844 *
num_vŞumes
 = (*num_volumes) + 1;

1847 
»suÉ
[*
num_vŞumes
] = 
NULL
;

1849 
out
:

1850 
	`libh®_ä“_¡ršg_¬¿y
 (
udis
);

1851  
»suÉ
;

1852 
	}
}

1855 
	$libh®_vŞume_üy±o_g‘_backšg_vŞume_udi
 (
LibH®VŞume
 *
vŞume
)

1857  
vŞume
->
üy±o_backšg_vŞume
;

1858 
	}
}

1861 
	$libh®_vŞume_üy±o_g‘_ş—r_vŞume_udi
 (
LibH®CÚ‹xt
 *
h®_ùx
, 
LibH®VŞume
 *
vŞume
)

1863 
DBusE¼Ü
 
”rÜ
;

1864 **
ş—r_deviûs
;

1865 
num_ş—r_deviûs
;

1866 *
»suÉ
;

1868 
»suÉ
 = 
NULL
;

1870 
	`LIBHAL_CHECK_LIBHALCONTEXT
 (
h®_ùx
, 
NULL
);

1872 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1873 
ş—r_deviûs
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
h®_ùx
,

1875 
vŞume
->
udi
,

1876 &
num_ş—r_deviûs
,

1877 &
”rÜ
);

1878 ià(
ş—r_deviûs
 !ğ
NULL
) {

1880 ià(
num_ş—r_deviûs
 >= 1) {

1881 
»suÉ
 = 
	`¡rdup
 (
ş—r_deviûs
[0]);

1883 
	`libh®_ä“_¡ršg_¬¿y
 (
ş—r_deviûs
);

1886  
»suÉ
;

1887 
	}
}

1893 
	$libh®_drive_pŞicy_deçuÉ_g‘_mouÁ_roÙ
 (
LibH®CÚ‹xt
 *
h®_ùx
)

1895 *
»suÉ
;

1896 
DBusE¼Ü
 
”rÜ
;

1898 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
h®_ùx
, 
NULL
);

1900 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1901 ià((
»suÉ
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
h®_ùx
, "/org/freedesktop/Hal/devices/computer",

1902 "¡Üage.pŞicy.deçuÉ.mouÁ_roÙ", &
”rÜ
)è=ğ
NULL
)

1903 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1905  
»suÉ
;

1906 
	}
}

1908 
dbus_boŞ_t


1909 
	$libh®_drive_pŞicy_deçuÉ_u£_mªaged_keywÜd
 (
LibH®CÚ‹xt
 *
h®_ùx
)

1911 
dbus_boŞ_t
 
»suÉ
;

1912 
DBusE¼Ü
 
”rÜ
;

1914 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
h®_ùx
, 
FALSE
);

1916 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1917 ià((
»suÉ
 = 
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
h®_ùx
, "/org/freedesktop/Hal/devices/computer",

1918 "¡Üage.pŞicy.deçuÉ.u£_mªaged_keywÜd", &
”rÜ
)è=ğ
FALSE
)

1919 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1921  
»suÉ
;

1922 
	}
}

1925 
	$libh®_drive_pŞicy_deçuÉ_g‘_mªaged_keywÜd_´im¬y
 (
LibH®CÚ‹xt
 *
h®_ùx
)

1927 *
»suÉ
;

1928 
DBusE¼Ü
 
”rÜ
;

1930 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
h®_ùx
, 
NULL
);

1932 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1933 ià((
»suÉ
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
h®_ùx
, "/org/freedesktop/Hal/devices/computer",

1934 "¡Üage.pŞicy.deçuÉ.mªaged_keywÜd.´im¬y", &
”rÜ
)è=ğ
NULL
)

1935 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1937  
»suÉ
;

1938 
	}
}

1941 
	$libh®_drive_pŞicy_deçuÉ_g‘_mªaged_keywÜd_£cÚd¬y
 (
LibH®CÚ‹xt
 *
h®_ùx
)

1943 *
»suÉ
;

1944 
DBusE¼Ü
 
”rÜ
;

1946 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
h®_ùx
, 
NULL
);

1948 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1949 ià((
»suÉ
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
h®_ùx
, "/org/freedesktop/Hal/devices/computer",

1950 "¡Üage.pŞicy.deçuÉ.mªaged_keywÜd.£cÚd¬y", &
”rÜ
)è=ğ
NULL
)

1951 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1953  
»suÉ
;

1954 
	}
}

1958 
dbus_boŞ_t


1959 
	$libh®_drive_pŞicy_is_mouÁabË
 (
LibH®Drive
 *
drive
, 
LibH®StÜagePŞicy
 *
pŞicy
)

1961 
	`´štf
 ("should_mouÁ=%u,‚o_·¹™iÚs_hšt=%u\n", 
drive
->
should_mouÁ
, drive->
no_·¹™iÚs_hšt
);

1963  
drive
->
should_mouÁ
 && drive->
no_·¹™iÚs_hšt
;

1964 
	}
}

1967 
	$libh®_drive_pŞicy_g‘_desœed_mouÁ_pošt
 (
LibH®Drive
 *
drive
, 
LibH®StÜagePŞicy
 *
pŞicy
)

1969  
drive
->
desœed_mouÁ_pošt
;

1970 
	}
}

1973 
	#¡rÿt_Ën
(
d¡
, 
¤c
, 
d¡maxËn
) do { \

1974 
d¡
[
d¡maxËn
 - 1] = '\0'; \

1975 
	`¡ºÿt
 (
d¡
, 
¤c
, 
d¡maxËn
 - 
	`¡¾’
 (dst) - 1); \

1976 } 0)

	)

1980 
	$mİts_cŞËù
 (
LibH®CÚ‹xt
 *
h®_ùx
, cÚ¡ *
Çme¥aû
, 
Çme¥aû_Ën
,

1981 cÚ¡ *
udi
, *
İtiÚs_¡ršg
, 
size_t
 
İtiÚs_max_Ën
, 
dbus_boŞ_t
 
Úly_cŞËù_im¶y_İts
)

1983 
LibH®Prİ”tyS‘
 *
´İ”t›s
;

1984 
LibH®Prİ”tyS‘I‹¿tÜ
 
™
;

1985 
DBusE¼Ü
 
”rÜ
;

1987 if(
h®_ùx
 =ğ
NULL
) {

1988 
	`årštf
 (
¡d”r
,"% %d : LibH®CÚ‹xˆ*ùx i NULL\n",
__FILE__
, 
__LINE__
);

1992 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1995 
´İ”t›s
 = 
	`libh®_deviû_g‘_®l_´İ”t›s
 (
h®_ùx
, 
udi
, &
”rÜ
);

1996 ià(
´İ”t›s
 =ğ
NULL
 ) {

1997 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

2001 
	`libh®_psi_š™
 (&
™
, 
´İ”t›s
); 
	`libh®_psi_has_mÜe
 (&™); 
	`libh®_psi_Ãxt
 (&it)) {

2002 *
key
;

2004 
key
 = 
	`libh®_psi_g‘_key
 (&
™
);

2005 ià(
	`libh®_psi_g‘_ty³
 (&
™
è=ğ
LIBHAL_PROPERTY_TYPE_BOOLEAN
 &&

2006 
	`¡ºcmp
 (
key
, 
Çme¥aû
, 
Çme¥aû_Ën
 - 1) == 0) {

2007 cÚ¡ *
İtiÚ
 = 
key
 + 
Çme¥aû_Ën
 - 1;

2008 *
loÿtiÚ
;

2009 
dbus_boŞ_t
 
is_im¶y_İt
;

2011 
is_im¶y_İt
 = 
FALSE
;

2012 ià(
	`¡rcmp
 (
İtiÚ
, "user") == 0 ||

2013 
	`¡rcmp
 (
İtiÚ
, "users") == 0 ||

2014 
	`¡rcmp
 (
İtiÚ
, "defaults") == 0 ||

2015 
	`¡rcmp
 (
İtiÚ
, "pamconsole") == 0)

2016 
is_im¶y_İt
 = 
TRUE
;

2019 ià(
Úly_cŞËù_im¶y_İts
) {

2020 ià(!
is_im¶y_İt
)

2023 ià(
is_im¶y_İt
)

2027 ià(
	`libh®_psi_g‘_boŞ
 (&
™
)) {

2029 
loÿtiÚ
 = 
	`¡r¡r
 (
İtiÚs_¡ršg
, 
İtiÚ
);

2030 ià(
loÿtiÚ
 =ğ
NULL
) {

2031 ià(
	`¡¾’
 (
İtiÚs_¡ršg
) > 0)

2032 
	`¡rÿt_Ën
 (
İtiÚs_¡ršg
, ",", 
İtiÚs_max_Ën
);

2033 
	`¡rÿt_Ën
 (
İtiÚs_¡ršg
, 
İtiÚ
, 
İtiÚs_max_Ën
);

2037 
loÿtiÚ
 = 
	`¡r¡r
 (
İtiÚs_¡ršg
, 
İtiÚ
);

2038 ià(
loÿtiÚ
 !ğ
NULL
) {

2039 *
’d
;

2041 
’d
 = 
	`¡rchr
 (
loÿtiÚ
, ',');

2042 ià(
’d
 =ğ
NULL
) {

2043 
loÿtiÚ
[0] = '\0';

2045 
	`¡rıy
 (
loÿtiÚ
, 
’d
 + 1);

2053 
	`libh®_ä“_´İ”ty_£t
 (
´İ”t›s
);

2054 
	}
}

2058 
	$libh®_drive_pŞicy_g‘_mouÁ_İtiÚs
 (
LibH®Drive
 *
drive
, 
LibH®StÜagePŞicy
 *
pŞicy
)

2060 cÚ¡ *
»suÉ
;

2061 
¡Ü_mouÁ_İtiÚ_deçuÉ_begš
[] = "storage.policy.default.mount_option.";

2062 
¡Ü_mouÁ_İtiÚ_begš
[] = "storage.policy.mount_option.";

2064 
»suÉ
 = 
NULL
;

2065 
drive
->
mouÁ_İtiÚs
[0] = '\0';

2068 
	`mİts_cŞËù
 (
drive
->
h®_ùx
, 
¡Ü_mouÁ_İtiÚ_deçuÉ_begš
,  (stor_mount_option_default_begin),

2069 "/Üg/ä“desktİ/H®/deviûs/compu‹r", 
drive
->
mouÁ_İtiÚs
, 
MOUNT_OPTIONS_SIZE
, 
TRUE
);

2070 
	`mİts_cŞËù
 (
drive
->
h®_ùx
, 
¡Ü_mouÁ_İtiÚ_begš
,  (stor_mount_option_begin),

2071 
drive
->
udi
, drive->
mouÁ_İtiÚs
, 
MOUNT_OPTIONS_SIZE
, 
TRUE
);

2073 
	`mİts_cŞËù
 (
drive
->
h®_ùx
, 
¡Ü_mouÁ_İtiÚ_deçuÉ_begš
,  (stor_mount_option_default_begin),

2074 "/Üg/ä“desktİ/H®/deviûs/compu‹r", 
drive
->
mouÁ_İtiÚs
, 
MOUNT_OPTIONS_SIZE
, 
FALSE
);

2075 
	`mİts_cŞËù
 (
drive
->
h®_ùx
, 
¡Ü_mouÁ_İtiÚ_begš
,  (stor_mount_option_begin),

2076 
drive
->
udi
, drive->
mouÁ_İtiÚs
, 
MOUNT_OPTIONS_SIZE
, 
FALSE
);

2078 
»suÉ
 = 
drive
->
mouÁ_İtiÚs
;

2080  
»suÉ
;

2081 
	}
}

2084 
	$libh®_drive_pŞicy_g‘_mouÁ_fs
 (
LibH®Drive
 *
drive
, 
LibH®StÜagePŞicy
 *
pŞicy
)

2086  
drive
->
mouÁ_fesy¡em
;

2087 
	}
}

2090 
dbus_boŞ_t


2091 
	$libh®_vŞume_pŞicy_is_mouÁabË
 (
LibH®Drive
 *
drive
, 
LibH®VŞume
 *
vŞume
, 
LibH®StÜagePŞicy
 *
pŞicy
)

2093  
drive
->
should_mouÁ
 && 
vŞume
->should_mount;

2094 
	}
}

2096 cÚ¡ *
	$libh®_vŞume_pŞicy_g‘_desœed_mouÁ_pošt
 (
LibH®Drive
 *
drive
, 
LibH®VŞume
 *
vŞume
, 
LibH®StÜagePŞicy
 *
pŞicy
)

2098  
vŞume
->
desœed_mouÁ_pošt
;

2099 
	}
}

2101 cÚ¡ *
	$libh®_vŞume_pŞicy_g‘_mouÁ_İtiÚs
 (
LibH®Drive
 *
drive
, 
LibH®VŞume
 *
vŞume
, 
LibH®StÜagePŞicy
 *
pŞicy
)

2103 cÚ¡ *
»suÉ
;

2104 
¡Ü_mouÁ_İtiÚ_deçuÉ_begš
[] = "storage.policy.default.mount_option.";

2105 
vŞ_mouÁ_İtiÚ_begš
[] = "volume.policy.mount_option.";

2107 
»suÉ
 = 
NULL
;

2108 
vŞume
->
mouÁ_İtiÚs
[0] = '\0';

2111 
	`mİts_cŞËù
 (
drive
->
h®_ùx
, 
¡Ü_mouÁ_İtiÚ_deçuÉ_begš
,  (stor_mount_option_default_begin),

2112 "/Üg/ä“desktİ/H®/deviûs/compu‹r", 
vŞume
->
mouÁ_İtiÚs
, 
MOUNT_OPTIONS_SIZE
, 
TRUE
);

2113 
	`mİts_cŞËù
 (
drive
->
h®_ùx
, 
vŞ_mouÁ_İtiÚ_begš
,  (vol_mount_option_begin),

2114 
vŞume
->
udi
, vŞume->
mouÁ_İtiÚs
, 
MOUNT_OPTIONS_SIZE
, 
TRUE
);

2116 
	`mİts_cŞËù
 (
drive
->
h®_ùx
, 
¡Ü_mouÁ_İtiÚ_deçuÉ_begš
,  (stor_mount_option_default_begin),

2117 "/Üg/ä“desktİ/H®/deviûs/compu‹r", 
vŞume
->
mouÁ_İtiÚs
, 
MOUNT_OPTIONS_SIZE
, 
FALSE
);

2118 
	`mİts_cŞËù
 (
drive
->
h®_ùx
, 
vŞ_mouÁ_İtiÚ_begš
,  (vol_mount_option_begin),

2119 
vŞume
->
udi
, vŞume->
mouÁ_İtiÚs
, 
MOUNT_OPTIONS_SIZE
, 
FALSE
);

2121 
»suÉ
 = 
vŞume
->
mouÁ_İtiÚs
;

2123  
»suÉ
;

2124 
	}
}

2126 cÚ¡ *
	$libh®_vŞume_pŞicy_g‘_mouÁ_fs
 (
LibH®Drive
 *
drive
, 
LibH®VŞume
 *
vŞume
, 
LibH®StÜagePŞicy
 *
pŞicy
)

2128  
vŞume
->
mouÁ_fesy¡em
;

2129 
	}
}

2131 
dbus_boŞ_t


2132 
	$libh®_drive_no_·¹™iÚs_hšt
 (
LibH®Drive
 *
drive
)

2134  
drive
->
no_·¹™iÚs_hšt
;

2135 
	}
}

	@libhal-storage/libhal-storage.h

28 #iâdeà
LIBHAL_STORAGE_H


29 
	#LIBHAL_STORAGE_H


	)

31 
	~<libh®.h
>

33 #ià
defšed
(
__ılu¥lus
)

40 
LibH®Drive_s
;

41 
LibH®Drive_s
 
	tLibH®Drive
;

42 
	gLibH®VŞume_s
;

43 
LibH®VŞume_s
 
	tLibH®VŞume
;

44 
	gLibH®StÜagePŞicy_s
;

45 
LibH®StÜagePŞicy_s
 
	tLibH®StÜagePŞicy
;

49 
	mLIBHAL_STORAGE_ICON_DRIVE_REMOVABLE_DISK
 = 0x10000,

50 
	mLIBHAL_STORAGE_ICON_DRIVE_REMOVABLE_DISK_IDE
 = 0x10001,

51 
	mLIBHAL_STORAGE_ICON_DRIVE_REMOVABLE_DISK_SCSI
 = 0x10002,

52 
	mLIBHAL_STORAGE_ICON_DRIVE_REMOVABLE_DISK_USB
 = 0x10003,

53 
	mLIBHAL_STORAGE_ICON_DRIVE_REMOVABLE_DISK_IEEE1394
 = 0x10004,

54 
	mLIBHAL_STORAGE_ICON_DRIVE_DISK
 = 0x10100,

55 
	mLIBHAL_STORAGE_ICON_DRIVE_DISK_IDE
 = 0x10101,

56 
	mLIBHAL_STORAGE_ICON_DRIVE_DISK_SCSI
 = 0x10102,

57 
	mLIBHAL_STORAGE_ICON_DRIVE_DISK_USB
 = 0x10103,

58 
	mLIBHAL_STORAGE_ICON_DRIVE_DISK_IEEE1394
 = 0x10104,

59 
	mLIBHAL_STORAGE_ICON_DRIVE_CDROM
 = 0x10200,

60 
	mLIBHAL_STORAGE_ICON_DRIVE_CDROM_IDE
 = 0x10201,

61 
	mLIBHAL_STORAGE_ICON_DRIVE_CDROM_SCSI
 = 0x10202,

62 
	mLIBHAL_STORAGE_ICON_DRIVE_CDROM_USB
 = 0x10203,

63 
	mLIBHAL_STORAGE_ICON_DRIVE_CDROM_IEEE1394
 = 0x10204,

64 
	mLIBHAL_STORAGE_ICON_DRIVE_FLOPPY
 = 0x10300,

65 
	mLIBHAL_STORAGE_ICON_DRIVE_FLOPPY_IDE
 = 0x10301,

66 
	mLIBHAL_STORAGE_ICON_DRIVE_FLOPPY_SCSI
 = 0x10302,

67 
	mLIBHAL_STORAGE_ICON_DRIVE_FLOPPY_USB
 = 0x10303,

68 
	mLIBHAL_STORAGE_ICON_DRIVE_FLOPPY_IEEE1394
 = 0x10304,

69 
	mLIBHAL_STORAGE_ICON_DRIVE_TAPE
 = 0x10400,

70 
	mLIBHAL_STORAGE_ICON_DRIVE_COMPACT_FLASH
 = 0x10500,

71 
	mLIBHAL_STORAGE_ICON_DRIVE_MEMORY_STICK
 = 0x10600,

72 
	mLIBHAL_STORAGE_ICON_DRIVE_SMART_MEDIA
 = 0x10700,

73 
	mLIBHAL_STORAGE_ICON_DRIVE_SD_MMC
 = 0x10800,

74 
	mLIBHAL_STORAGE_ICON_DRIVE_CAMERA
 = 0x10900,

75 
	mLIBHAL_STORAGE_ICON_DRIVE_PORTABLE_AUDIO_PLAYER
 = 0x10a00,

76 
	mLIBHAL_STORAGE_ICON_DRIVE_ZIP
 = 0x10b00,

77 
	mLIBHAL_STORAGE_ICON_DRIVE_JAZ
 = 0x10c00,

78 
	mLIBHAL_STORAGE_ICON_DRIVE_FLASH_KEY
 = 0x10d00,

80 
	mLIBHAL_STORAGE_ICON_VOLUME_REMOVABLE_DISK
 = 0x20000,

81 
	mLIBHAL_STORAGE_ICON_VOLUME_REMOVABLE_DISK_IDE
 = 0x20001,

82 
	mLIBHAL_STORAGE_ICON_VOLUME_REMOVABLE_DISK_SCSI
 = 0x20002,

83 
	mLIBHAL_STORAGE_ICON_VOLUME_REMOVABLE_DISK_USB
 = 0x20003,

84 
	mLIBHAL_STORAGE_ICON_VOLUME_REMOVABLE_DISK_IEEE1394
 = 0x20004,

85 
	mLIBHAL_STORAGE_ICON_VOLUME_DISK
 = 0x20100,

86 
	mLIBHAL_STORAGE_ICON_VOLUME_DISK_IDE
 = 0x20101,

87 
	mLIBHAL_STORAGE_ICON_VOLUME_DISK_SCSI
 = 0x20102,

88 
	mLIBHAL_STORAGE_ICON_VOLUME_DISK_USB
 = 0x20103,

89 
	mLIBHAL_STORAGE_ICON_VOLUME_DISK_IEEE1394
 = 0x20104,

90 
	mLIBHAL_STORAGE_ICON_VOLUME_CDROM
 = 0x20200,

91 
	mLIBHAL_STORAGE_ICON_VOLUME_CDROM_IDE
 = 0x20201,

92 
	mLIBHAL_STORAGE_ICON_VOLUME_CDROM_SCSI
 = 0x20202,

93 
	mLIBHAL_STORAGE_ICON_VOLUME_CDROM_USB
 = 0x20203,

94 
	mLIBHAL_STORAGE_ICON_VOLUME_CDROM_IEEE1394
 = 0x20204,

95 
	mLIBHAL_STORAGE_ICON_VOLUME_FLOPPY
 = 0x20300,

96 
	mLIBHAL_STORAGE_ICON_VOLUME_FLOPPY_IDE
 = 0x20301,

97 
	mLIBHAL_STORAGE_ICON_VOLUME_FLOPPY_SCSI
 = 0x20302,

98 
	mLIBHAL_STORAGE_ICON_VOLUME_FLOPPY_USB
 = 0x20303,

99 
	mLIBHAL_STORAGE_ICON_VOLUME_FLOPPY_IEEE1394
 = 0x20304,

100 
	mLIBHAL_STORAGE_ICON_VOLUME_TAPE
 = 0x20400,

101 
	mLIBHAL_STORAGE_ICON_VOLUME_COMPACT_FLASH
 = 0x20500,

102 
	mLIBHAL_STORAGE_ICON_VOLUME_MEMORY_STICK
 = 0x20600,

103 
	mLIBHAL_STORAGE_ICON_VOLUME_SMART_MEDIA
 = 0x20700,

104 
	mLIBHAL_STORAGE_ICON_VOLUME_SD_MMC
 = 0x20800,

105 
	mLIBHAL_STORAGE_ICON_VOLUME_CAMERA
 = 0x20900,

106 
	mLIBHAL_STORAGE_ICON_VOLUME_PORTABLE_AUDIO_PLAYER
 = 0x20a00,

107 
	mLIBHAL_STORAGE_ICON_VOLUME_ZIP
 = 0x20b00,

108 
	mLIBHAL_STORAGE_ICON_VOLUME_JAZ
 = 0x20c00,

109 
	mLIBHAL_STORAGE_ICON_VOLUME_FLASH_KEY
 = 0x20d00,

111 
	mLIBHAL_STORAGE_ICON_DISC_CDROM
 = 0x30000,

112 
	mLIBHAL_STORAGE_ICON_DISC_CDR
 = 0x30001,

113 
	mLIBHAL_STORAGE_ICON_DISC_CDRW
 = 0x30002,

114 
	mLIBHAL_STORAGE_ICON_DISC_DVDROM
 = 0x30003,

115 
	mLIBHAL_STORAGE_ICON_DISC_DVDRAM
 = 0x30004,

116 
	mLIBHAL_STORAGE_ICON_DISC_DVDR
 = 0x30005,

117 
	mLIBHAL_STORAGE_ICON_DISC_DVDRW
 = 0x30006,

118 
	mLIBHAL_STORAGE_ICON_DISC_DVDPLUSR
 = 0x30007,

119 
	mLIBHAL_STORAGE_ICON_DISC_DVDPLUSRW
 = 0x30008,

120 
	mLIBHAL_STORAGE_ICON_DISC_DVDPLUSRWDL
 = 0x30009,

121 
	mLIBHAL_STORAGE_ICON_DISC_BDROM
 = 0x3000a,

122 
	mLIBHAL_STORAGE_ICON_DISC_BDR
 = 0x3000b,

123 
	mLIBHAL_STORAGE_ICON_DISC_BDRE
 = 0x3000c,

124 
	mLIBHAL_STORAGE_ICON_DISC_HDDVDROM
 = 0x3000d,

125 
	mLIBHAL_STORAGE_ICON_DISC_HDDVDR
 = 0x3000e,

126 
	mLIBHAL_STORAGE_ICON_DISC_HDDVDRW
 = 0x3000f,

127 
	mLIBHAL_STORAGE_ICON_DISC_MRW
 = 0x30010,

128 
	mLIBHAL_STORAGE_ICON_DISC_MRWW
 = 0x30011,

129 
	mLIBHAL_STORAGE_ICON_DISC_MO
 = 0x30012

130 } 
	tLibH®StÜagePŞicyIcÚ
;

133 
LibH®StÜagePŞicyIcÚ
 
	micÚ
;

134 cÚ¡ *
	micÚ_·th
;

135 } 
	tLibH®StÜagePŞicyIcÚPaœ
;

137 
LibH®StÜagePŞicy
 *
	$libh®_¡Üage_pŞicy_Ãw
 (è
LIBHAL_DEPRECATED
;

138 
	$libh®_¡Üage_pŞicy_ä“
 (
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

140 
	$libh®_¡Üage_pŞicy_£t_icÚ_·th
 (
LibH®StÜagePŞicy
 *
pŞicy
,

141 
LibH®StÜagePŞicyIcÚ
 
icÚ
,

142 cÚ¡ *
·th
è
LIBHAL_DEPRECATED
;

144 
	$libh®_¡Üage_pŞicy_£t_icÚ_m­pšg
 (
LibH®StÜagePŞicy
 *
pŞicy
,

145 
LibH®StÜagePŞicyIcÚPaœ
 *
·œs
è
LIBHAL_DEPRECATED
;

146 cÚ¡ *
	$libh®_¡Üage_pŞicy_lookup_icÚ
 (
LibH®StÜagePŞicy
 *
pŞicy
,

147 
LibH®StÜagePŞicyIcÚ
 
icÚ
è
LIBHAL_DEPRECATED
;

150 
LIBHAL_DRIVE_BUS_UNKNOWN
 = 0x00,

151 
LIBHAL_DRIVE_BUS_IDE
 = 0x01,

152 
LIBHAL_DRIVE_BUS_SCSI
 = 0x02,

153 
LIBHAL_DRIVE_BUS_USB
 = 0x03,

154 
LIBHAL_DRIVE_BUS_IEEE1394
 = 0x04,

155 
LIBHAL_DRIVE_BUS_CCW
 = 0x05

156 } 
	tLibH®DriveBus
;

159 
LIBHAL_DRIVE_TYPE_REMOVABLE_DISK
 = 0x00,

160 
LIBHAL_DRIVE_TYPE_DISK
 = 0x01,

161 
LIBHAL_DRIVE_TYPE_CDROM
 = 0x02,

162 
LIBHAL_DRIVE_TYPE_FLOPPY
 = 0x03,

163 
LIBHAL_DRIVE_TYPE_TAPE
 = 0x04,

164 
LIBHAL_DRIVE_TYPE_COMPACT_FLASH
 = 0x05,

165 
LIBHAL_DRIVE_TYPE_MEMORY_STICK
 = 0x06,

166 
LIBHAL_DRIVE_TYPE_SMART_MEDIA
 = 0x07,

167 
LIBHAL_DRIVE_TYPE_SD_MMC
 = 0x08,

168 
LIBHAL_DRIVE_TYPE_CAMERA
 = 0x09,

169 
LIBHAL_DRIVE_TYPE_PORTABLE_AUDIO_PLAYER
 = 0x0a,

170 
LIBHAL_DRIVE_TYPE_ZIP
 = 0x0b,

171 
LIBHAL_DRIVE_TYPE_JAZ
 = 0x0c,

172 
LIBHAL_DRIVE_TYPE_FLASHKEY
 = 0x0d,

173 
LIBHAL_DRIVE_TYPE_MO
 = 0x0e

174 } 
	tLibH®DriveTy³
;

177 
LIBHAL_DRIVE_CDROM_CAPS_CDROM
 = 0x00001,

178 
LIBHAL_DRIVE_CDROM_CAPS_CDR
 = 0x00002,

179 
LIBHAL_DRIVE_CDROM_CAPS_CDRW
 = 0x00004,

180 
LIBHAL_DRIVE_CDROM_CAPS_DVDRAM
 = 0x00008,

181 
LIBHAL_DRIVE_CDROM_CAPS_DVDROM
 = 0x00010,

182 
LIBHAL_DRIVE_CDROM_CAPS_DVDR
 = 0x00020,

183 
LIBHAL_DRIVE_CDROM_CAPS_DVDRW
 = 0x00040,

184 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSR
 = 0x00080,

185 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSRW
 = 0x00100,

186 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSRDL
 = 0x00200,

187 
LIBHAL_DRIVE_CDROM_CAPS_DVDPLUSRWDL
 = 0x00400,

188 
LIBHAL_DRIVE_CDROM_CAPS_BDROM
 = 0x00800,

189 
LIBHAL_DRIVE_CDROM_CAPS_BDR
 = 0x01000,

190 
LIBHAL_DRIVE_CDROM_CAPS_BDRE
 = 0x02000,

191 
LIBHAL_DRIVE_CDROM_CAPS_HDDVDROM
 = 0x04000,

192 
LIBHAL_DRIVE_CDROM_CAPS_HDDVDR
 = 0x08000,

193 
LIBHAL_DRIVE_CDROM_CAPS_HDDVDRW
 = 0x10000,

194 
LIBHAL_DRIVE_CDROM_CAPS_MRW
 = 0x20000,

195 
LIBHAL_DRIVE_CDROM_CAPS_MRWW
 = 0x40000,

196 
LIBHAL_DRIVE_CDROM_CAPS_MO
 = 0x80000

197 } 
	tLibH®DriveCdromC­s
;

199 
LibH®Drive
 *
	`libh®_drive_äom_udi
 (
LibH®CÚ‹xt
 *
h®_ùx
,

200 cÚ¡ *
udi
);

201 
LibH®Drive
 *
	`libh®_drive_äom_deviû_fe
 (
LibH®CÚ‹xt
 *
h®_ùx
,

202 cÚ¡ *
deviû_fe
);

203 
	`libh®_drive_ä“
 (
LibH®Drive
 *
drive
);

205 
dbus_boŞ_t
 
	`libh®_drive_is_hÙ¶uggabË
 (
LibH®Drive
 *
drive
);

206 
dbus_boŞ_t
 
	`libh®_drive_u£s_»movabË_medŸ
 (
LibH®Drive
 *
drive
);

207 
dbus_boŞ_t
 
	`libh®_drive_is_medŸ_d‘eùed
 (
LibH®Drive
 *
drive
);

208 
dbus_boŞ_t
 
	`libh®_drive_is_medŸ_d‘eùiÚ_autom©ic
 (
LibH®Drive
 *
drive
);

209 
dbus_ušt64_t
 
	`libh®_drive_g‘_size
 (
LibH®Drive
 *
drive
);

210 
dbus_ušt64_t
 
	`libh®_drive_g‘_medŸ_size
 (
LibH®Drive
 *
drive
);

211 cÚ¡ *
	`libh®_drive_g‘_·¹™iÚ_scheme
 (
LibH®Drive
 *
drive
);

212 
dbus_boŞ_t
 
	`libh®_drive_no_·¹™iÚs_hšt
 (
LibH®Drive
 *
drive
);

213 
dbus_boŞ_t
 
	`libh®_drive_»quœes_ejeù
 (
LibH®Drive
 *
drive
);

214 
LibH®DriveTy³
 
	`libh®_drive_g‘_ty³
 (
LibH®Drive
 *
drive
);

215 
LibH®DriveBus
 
	`libh®_drive_g‘_bus
 (
LibH®Drive
 *
drive
);

216 
LibH®DriveCdromC­s
 
	`libh®_drive_g‘_cdrom_ÿps
 (
LibH®Drive
 *
drive
);

217 
	`libh®_drive_g‘_deviû_majÜ
 (
LibH®Drive
 *
drive
);

218 
	`libh®_drive_g‘_deviû_mšÜ
 (
LibH®Drive
 *
drive
);

219 cÚ¡ *
	`libh®_drive_g‘_ty³_‹xtu®
 (
LibH®Drive
 *
drive
);

220 cÚ¡ *
	`libh®_drive_g‘_deviû_fe
 (
LibH®Drive
 *
drive
);

221 cÚ¡ *
	`libh®_drive_g‘_udi
 (
LibH®Drive
 *
drive
);

222 cÚ¡ *
	`libh®_drive_g‘_£rŸl
 (
LibH®Drive
 *
drive
);

223 cÚ¡ *
	`libh®_drive_g‘_fœmw¬e_v”siÚ
 (
LibH®Drive
 *
drive
);

224 cÚ¡ *
	`libh®_drive_g‘_mod–
 (
LibH®Drive
 *
drive
);

225 cÚ¡ *
	`libh®_drive_g‘_v’dÜ
 (
LibH®Drive
 *
drive
);

226 cÚ¡ *
	`libh®_drive_g‘_physiÿl_deviû_udi
 (
LibH®Drive
 *
drive
);

228 cÚ¡ *
	`libh®_drive_g‘_dediÿ‹d_icÚ_drive
 (
LibH®Drive
 *
drive
);

229 cÚ¡ *
	`libh®_drive_g‘_dediÿ‹d_icÚ_vŞume
 (
LibH®Drive
 *
drive
);

231 *
	$libh®_drive_pŞicy_compu‹_di¥Ïy_Çme
 (
LibH®Drive
 *
drive
,

232 
LibH®VŞume
 *
vŞume
,

233 
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

234 *
	$libh®_drive_pŞicy_compu‹_icÚ_Çme
 (
LibH®Drive
 *
drive
,

235 
LibH®VŞume
 *
vŞume
,

236 
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

238 
dbus_boŞ_t
 
	$libh®_drive_pŞicy_is_mouÁabË
 (
LibH®Drive
 *
drive
,

239 
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

240 cÚ¡ *
	$libh®_drive_pŞicy_g‘_desœed_mouÁ_pošt
 (
LibH®Drive
 *
drive
,

241 
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

242 cÚ¡ *
	$libh®_drive_pŞicy_g‘_mouÁ_İtiÚs
 (
LibH®Drive
 *
drive
,

243 
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

244 cÚ¡ *
	$libh®_drive_pŞicy_g‘_mouÁ_fs
 (
LibH®Drive
 *
drive
,

245 
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

247 **
	`libh®_drive_fšd_®l_vŞumes
 (
LibH®CÚ‹xt
 *
h®_ùx
,

248 
LibH®Drive
 *
drive
,

249 *
num_vŞumes
);

252 *
	$libh®_drive_pŞicy_deçuÉ_g‘_mouÁ_roÙ
 (
LibH®CÚ‹xt
 *
h®_ùx
è
LIBHAL_DEPRECATED
;

253 
dbus_boŞ_t
 
	$libh®_drive_pŞicy_deçuÉ_u£_mªaged_keywÜd
 (
LibH®CÚ‹xt
 *
h®_ùx
è
LIBHAL_DEPRECATED
;

254 *
	$libh®_drive_pŞicy_deçuÉ_g‘_mªaged_keywÜd_´im¬y
 (
LibH®CÚ‹xt
 *
h®_ùx
è
LIBHAL_DEPRECATED
;

255 *
	$libh®_drive_pŞicy_deçuÉ_g‘_mªaged_keywÜd_£cÚd¬y
 (
LibH®CÚ‹xt
 *
h®_ùx
è
LIBHAL_DEPRECATED
;

259 
LIBHAL_VOLUME_USAGE_MOUNTABLE_FILESYSTEM
,

260 
LIBHAL_VOLUME_USAGE_PARTITION_TABLE
,

261 
LIBHAL_VOLUME_USAGE_RAID_MEMBER
,

262 
LIBHAL_VOLUME_USAGE_CRYPTO
,

263 
LIBHAL_VOLUME_USAGE_UNKNOWN
,

264 
LIBHAL_VOLUME_USAGE_OTHER


265 } 
	tLibH®VŞumeU§ge
;

268 
LIBHAL_VOLUME_DISC_TYPE_CDROM
 = 0x00,

269 
LIBHAL_VOLUME_DISC_TYPE_CDR
 = 0x01,

270 
LIBHAL_VOLUME_DISC_TYPE_CDRW
 = 0x02,

271 
LIBHAL_VOLUME_DISC_TYPE_DVDROM
 = 0x03,

272 
LIBHAL_VOLUME_DISC_TYPE_DVDRAM
 = 0x04,

273 
LIBHAL_VOLUME_DISC_TYPE_DVDR
 = 0x05,

274 
LIBHAL_VOLUME_DISC_TYPE_DVDRW
 = 0x06,

275 
LIBHAL_VOLUME_DISC_TYPE_DVDPLUSR
 = 0x07,

276 
LIBHAL_VOLUME_DISC_TYPE_DVDPLUSRW
 = 0x08,

277 
LIBHAL_VOLUME_DISC_TYPE_DVDPLUSR_DL
 = 0x09,

278 
LIBHAL_VOLUME_DISC_TYPE_BDROM
 = 0x0a,

279 
LIBHAL_VOLUME_DISC_TYPE_BDR
 = 0x0b,

280 
LIBHAL_VOLUME_DISC_TYPE_BDRE
 = 0x0c,

281 
LIBHAL_VOLUME_DISC_TYPE_HDDVDROM
 = 0x0d,

282 
LIBHAL_VOLUME_DISC_TYPE_HDDVDR
 = 0x0e,

283 
LIBHAL_VOLUME_DISC_TYPE_HDDVDRW
 = 0x0f,

284 
LIBHAL_VOLUME_DISC_TYPE_MO
 = 0x10,

285 
LIBHAL_VOLUME_DISC_TYPE_DVDR_DL
 = 0x11

286 } 
	tLibH®VŞumeDiscTy³
;

288 
LibH®VŞume
 *
	`libh®_vŞume_äom_udi
 (
LibH®CÚ‹xt
 *
h®_ùx
,

289 cÚ¡ *
udi
);

290 
LibH®VŞume
 *
	`libh®_vŞume_äom_deviû_fe
 (
LibH®CÚ‹xt
 *
h®_ùx
,

291 cÚ¡ *
deviû_fe
);

292 
LibH®VŞume
 *
	`libh®_vŞume_äom_mouÁ_pošt
 (
LibH®CÚ‹xt
 *
h®_ùx
,

293 cÚ¡ *
mouÁ_pošt
);

294 
	`libh®_vŞume_ä“
 (
LibH®VŞume
 *
vŞume
);

295 
dbus_ušt64_t
 
	`libh®_vŞume_g‘_size
 (
LibH®VŞume
 *
vŞume
);

296 
dbus_ušt64_t
 
	`libh®_vŞume_g‘_disc_ÿ·c™y
 (
LibH®VŞume
 *
vŞume
);

298 cÚ¡ *
	`libh®_vŞume_g‘_udi
 (
LibH®VŞume
 *
vŞume
);

299 cÚ¡ *
	`libh®_vŞume_g‘_deviû_fe
 (
LibH®VŞume
 *
vŞume
);

300 
	`libh®_vŞume_g‘_deviû_majÜ
 (
LibH®VŞume
 *
vŞume
);

301 
	`libh®_vŞume_g‘_deviû_mšÜ
 (
LibH®VŞume
 *
vŞume
);

302 cÚ¡ *
	`libh®_vŞume_g‘_f¡y³
 (
LibH®VŞume
 *
vŞume
);

303 cÚ¡ *
	`libh®_vŞume_g‘_fsv”siÚ
 (
LibH®VŞume
 *
vŞume
);

304 
LibH®VŞumeU§ge
 
	`libh®_vŞume_g‘_fsu§ge
 (
LibH®VŞume
 *
vŞume
);

305 
dbus_boŞ_t
 
	`libh®_vŞume_is_mouÁed
 (
LibH®VŞume
 *
vŞume
);

306 
dbus_boŞ_t
 
	`libh®_vŞume_is_mouÁed_»ad_Úly
 (
LibH®VŞume
 *
vŞume
);

307 
dbus_boŞ_t
 
	`libh®_vŞume_is_·¹™iÚ
 (
LibH®VŞume
 *
vŞume
);

308 
dbus_boŞ_t
 
	`libh®_vŞume_is_disc
 (
LibH®VŞume
 *
vŞume
);

310 cÚ¡ *
	`libh®_vŞume_g‘_·¹™iÚ_scheme
 (
LibH®VŞume
 *
vŞume
);

311 cÚ¡ *
	`libh®_vŞume_g‘_·¹™iÚ_ty³
 (
LibH®VŞume
 *
vŞume
);

312 cÚ¡ *
	`libh®_vŞume_g‘_·¹™iÚ_Ïb–
 (
LibH®VŞume
 *
vŞume
);

313 cÚ¡ *
	`libh®_vŞume_g‘_·¹™iÚ_uuid
 (
LibH®VŞume
 *
vŞume
);

314 cÚ¡ **
	`libh®_vŞume_g‘_·¹™iÚ_æags
 (
LibH®VŞume
 *
vŞume
);

315 
	`libh®_vŞume_g‘_·¹™iÚ_numb”
 (
LibH®VŞume
 *
vŞume
);

316 
dbus_ušt64_t
 
	`libh®_vŞume_g‘_·¹™iÚ_¡¬t_off£t
 (
LibH®VŞume
 *
vŞume
);

317 
dbus_ušt64_t
 
	`libh®_vŞume_g‘_·¹™iÚ_medŸ_size
 (
LibH®VŞume
 *
vŞume
);

319 cÚ¡ *
	`libh®_vŞume_g‘_Ïb–
 (
LibH®VŞume
 *
vŞume
);

320 cÚ¡ *
	`libh®_vŞume_g‘_mouÁ_pošt
 (
LibH®VŞume
 *
vŞume
);

321 cÚ¡ *
	`libh®_vŞume_g‘_uuid
 (
LibH®VŞume
 *
vŞume
);

322 cÚ¡ *
	`libh®_vŞume_g‘_¡Üage_deviû_udi
 (
LibH®VŞume
 *
vŞume
);

324 cÚ¡ *
	`libh®_vŞume_üy±o_g‘_backšg_vŞume_udi
 (
LibH®VŞume
 *
vŞume
);

325 *
	`libh®_vŞume_üy±o_g‘_ş—r_vŞume_udi
 (
LibH®CÚ‹xt
 *
h®_ùx
, 
LibH®VŞume
 *
vŞume
);

328 
dbus_boŞ_t
 
	`libh®_vŞume_disc_has_audio
 (
LibH®VŞume
 *
vŞume
);

329 
dbus_boŞ_t
 
	`libh®_vŞume_disc_has_d©a
 (
LibH®VŞume
 *
vŞume
);

330 
dbus_boŞ_t
 
	`libh®_vŞume_disc_is_bÏnk
 (
LibH®VŞume
 *
vŞume
);

331 
dbus_boŞ_t
 
	`libh®_vŞume_disc_is_»wr™abË
 (
LibH®VŞume
 *
vŞume
);

332 
dbus_boŞ_t
 
	`libh®_vŞume_disc_is_­³ndabË
 (
LibH®VŞume
 *
vŞume
);

333 
LibH®VŞumeDiscTy³
 
	`libh®_vŞume_g‘_disc_ty³
 (
LibH®VŞume
 *
vŞume
);

335 
	$libh®_vŞume_g‘_msdos_·¹_bË_ty³
 (
LibH®VŞume
 *
vŞume
è
LIBHAL_DEPRECATED
;

336 
dbus_ušt64_t
 
	$libh®_vŞume_g‘_msdos_·¹_bË_¡¬t
 (
LibH®VŞume
 *
vŞume
è
LIBHAL_DEPRECATED
;

337 
dbus_ušt64_t
 
	$libh®_vŞume_g‘_msdos_·¹_bË_size
 (
LibH®VŞume
 *
vŞume
è
LIBHAL_DEPRECATED
;

340 
dbus_boŞ_t
 
	`libh®_vŞume_should_ignÜe
 (
LibH®VŞume
 *
vŞume
);

342 *
	$libh®_vŞume_pŞicy_compu‹_size_as_¡ršg
 (
LibH®VŞume
 *
vŞume
è
LIBHAL_DEPRECATED
;

344 *
	$libh®_vŞume_pŞicy_compu‹_di¥Ïy_Çme
 (
LibH®Drive
 *
drive
,

345 
LibH®VŞume
 *
vŞume
,

346 
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

347 *
	$libh®_vŞume_pŞicy_compu‹_icÚ_Çme
 (
LibH®Drive
 *
drive
,

348 
LibH®VŞume
 *
vŞume
,

349 
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

351 
dbus_boŞ_t
 
	$libh®_vŞume_pŞicy_should_be_visibË
 (
LibH®Drive
 *
drive
,

352 
LibH®VŞume
 *
vŞume
,

353 
LibH®StÜagePŞicy
 *
pŞicy
,

354 cÚ¡ *
rg‘_mouÁ_pošt
è
LIBHAL_DEPRECATED
;

356 
dbus_boŞ_t
 
	$libh®_vŞume_pŞicy_is_mouÁabË
 (
LibH®Drive
 *
drive
,

357 
LibH®VŞume
 *
vŞume
,

358 
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

359 cÚ¡ *
	$libh®_vŞume_pŞicy_g‘_desœed_mouÁ_pošt
 (
LibH®Drive
 *
drive
,

360 
LibH®VŞume
 *
vŞume
,

361 
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

362 cÚ¡ *
	$libh®_vŞume_pŞicy_g‘_mouÁ_İtiÚs
 (
LibH®Drive
 *
drive
,

363 
LibH®VŞume
 *
vŞume
,

364 
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

365 cÚ¡ *
	$libh®_vŞume_pŞicy_g‘_mouÁ_fs
 (
LibH®Drive
 *
drive
,

366 
LibH®VŞume
 *
vŞume
,

367 
LibH®StÜagePŞicy
 *
pŞicy
è
LIBHAL_DEPRECATED
;

370 #ià
	`defšed
(
__ılu¥lus
)

371 
	}
}

	@libhal/libhal.c

28 #ifdeà
HAVE_CONFIG_H


29 
	~<cÚfig.h
>

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<¡ršg.h
>

35 
	~<dbus/dbus.h
>

37 
	~"uthash.h
"

38 
	~"libh®.h
"

40 #ifdeà
ENABLE_NLS


41 
	~<libš.h
>

42 
	#_
(
SŒšg
è
	`dg‘‹xt
 (
GETTEXT_PACKAGE
, SŒšg)

	)

43 #ifdeà
g‘‹xt_noİ


44 
	#N_
(
SŒšg
è
	`g‘‹xt_noİ
 (SŒšg)

	)

46 
	#N_
(
SŒšg
è(SŒšg)

	)

50 
	#‹xtdomaš
(
SŒšg
è(SŒšg)

	)

51 
	#g‘‹xt
(
SŒšg
è(SŒšg)

	)

52 
	#dg‘‹xt
(
Domaš
,
Mes§ge
è(Mes§ge)

	)

53 
	#dcg‘‹xt
(
Domaš
,
Mes§ge
,
Ty³
è(Mes§ge)

	)

54 
	#bšd‹xtdomaš
(
Domaš
,
DœeùÜy
è(Domaš)

	)

55 
	#_
(
SŒšg
)

	)

56 
	#N_
(
SŒšg
è(SŒšg)

	)

67 
	#LIBHAL_CHECK_PARAM_VALID
(
_·¿m_
,
_Çme_
,
_»t_
) \

69 ià(
_·¿m_
 =ğ
NULL
) { \

70 
	`årštf
 (
¡d”r
, \

72 
__FILE__
, 
__LINE__
, 
_Çme_
); \

73  
_»t_
; \

75 } 0)

	)

84 
	#LIBHAL_CHECK_UDI_VALID
(
_udi_
,
_»t_
) \

86 ià(
_udi_
 =ğ
NULL
) { \

87 
	`årštf
 (
¡d”r
, \

89 
__FILE__
, 
__LINE__
, 
_udi_
); \

90  
_»t_
; \

92 if(
	`¡ºcmp
(
_udi_
, "/org/freedesktop/Hal/devices/", 29) != 0) { \

93 
	`årštf
 (
¡d”r
, \

96 
__FILE__
, 
__LINE__
, 
_udi_
); \

97  
_»t_
; \

100 } 0)

	)

102 **
libh®_g‘_¡ršg_¬¿y_äom_™”
 (
DBusMes§geI‹r
 *
™”
, *
num_–em’ts
);

104 
dbus_boŞ_t
 
libh®_´İ”ty_fl_v®ue_äom_v¬ŸÁ
 (
LibH®Prİ”ty
 *
p
, 
DBusMes§geI‹r
 *
v¬_™”
);

114 
	$libh®_ä“_¡ršg_¬¿y
 (**
¡r_¬¿y
)

116 ià(
¡r_¬¿y
 !ğ
NULL
) {

117 
i
;

119 
i
 = 0; 
¡r_¬¿y
[i] !ğ
NULL
; i++) {

120 
	`ä“
 (
¡r_¬¿y
[
i
]);

121 
¡r_¬¿y
[
i
] = 
NULL
;

123 
	`ä“
 (
¡r_¬¿y
);

124 
¡r_¬¿y
 = 
NULL
;

126 
	}
}

139 
	$libh®_g‘_¡ršg_¬¿y_äom_™”
 (
DBusMes§geI‹r
 *
™”
, *
num_–em’ts
)

141 
couÁ
;

142 **
bufãr
;

143 **
t
;

145 
couÁ
 = 0;

146 
bufãr
 = (**)
	`m®loc
 ( (*) * 8);

148 ià(
bufãr
 =ğ
NULL
)

149 
oom
;

151 
bufãr
[0] = 
NULL
;

152 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (
™”
è=ğ
DBUS_TYPE_STRING
) {

153 cÚ¡ *
v®ue
;

154 *
¡r
;

156 ià((
couÁ
 % 8) == 0 && count != 0) {

157 
t
 = 
	`»®loc
 (
bufãr
,  (*è* (
couÁ
 + 8));

158 ià(
t
 =ğ
NULL
)

159 
oom
;

161 
bufãr
 = 
t
;

164 
	`dbus_mes§ge_™”_g‘_basic
 (
™”
, &
v®ue
);

165 
¡r
 = 
	`¡rdup
 (
v®ue
);

166 ià(
¡r
 =ğ
NULL
)

167 
oom
;

169 
bufãr
[
couÁ
] = 
¡r
;

171 
	`dbus_mes§ge_™”_Ãxt
(
™”
);

172 
couÁ
++;

175 ià((
couÁ
 % 8) == 0) {

176 
t
 = 
	`»®loc
 (
bufãr
,  (*è* (
couÁ
 + 1));

177 ià(
t
 =ğ
NULL
)

178 
oom
;

180 
bufãr
 = 
t
;

183 
bufãr
[
couÁ
] = 
NULL
;

184 ià(
num_–em’ts
 !ğ
NULL
)

185 *
num_–em’ts
 = 
couÁ
;

186  
bufãr
;

188 
oom
:

189 ià(
bufãr
 !ğ
NULL
)

190 
	`ä“
 (
bufãr
);

191 
	`årštf
 (
¡d”r
, "% %d :ƒ¼Ü‡Îoÿtšg memÜy\n", 
__FILE__
, 
__LINE__
);

192  
NULL
;

194 
	}
}

203 
	$libh®_ä“_¡ršg
 (*
¡r
)

205 ià(
¡r
 !ğ
NULL
) {

206 
	`ä“
 (
¡r
);

207 
¡r
 = 
NULL
;

209 
	}
}

218 
	sLibH®Prİ”tyS‘_s
 {

219 
LibH®Prİ”ty
 *
	m´İ”t›s
;

227 
	sLibH®Prİ”ty_s
 {

228 
LibH®Prİ”tyTy³
 
	mty³
;

229 *
	mkey
;

233 *
	m¡r_v®ue
;

234 
dbus_št32_t
 
	mšt_v®ue
;

235 
dbus_ušt64_t
 
	mušt64_v®ue
;

236 
	mdoubË_v®ue
;

237 
dbus_boŞ_t
 
	mboŞ_v®ue
;

238 **
	m¡¾i¡_v®ue
;

239 } 
	mv
;

241 
UT_hash_hªdË
 
	mhh
;

250 
	sLibH®CÚ‹xt_s
 {

251 
DBusCÚÃùiÚ
 *
	mcÚÃùiÚ
;

252 
dbus_boŞ_t
 
	mis_š™Ÿlized
;

253 
dbus_boŞ_t
 
	mis_shutdown
;

254 
dbus_boŞ_t
 
	mÿche_’abËd
;

255 
dbus_boŞ_t
 
	mis_dœeù
;

258 
LibH®DeviûAdded
 
	mdeviû_added
;

261 
LibH®DeviûRemoved
 
	mdeviû_»moved
;

264 
LibH®DeviûNewC­ab™y
 
	mdeviû_Ãw_ÿ·b™y
;

267 
LibH®DeviûLo¡C­ab™y
 
	mdeviû_lo¡_ÿ·b™y
;

270 
LibH®DeviûPrİ”tyModif›d
 
	mdeviû_´İ”ty_modif›d
;

273 
LibH®DeviûCÚd™iÚ
 
	mdeviû_cÚd™iÚ
;

276 
LibH®Glob®IÁ”çûLockAcquœed
 
	mglob®_š‹rçû_lock_acquœed
;

279 
LibH®Glob®IÁ”çûLockR–—£d
 
	mglob®_š‹rçû_lock_»Ëa£d
;

282 
LibH®IÁ”çûLockAcquœed
 
	mš‹rçû_lock_acquœed
;

285 
LibH®IÁ”çûLockR–—£d
 
	mš‹rçû_lock_»Ëa£d
;

288 
LibH®SšgËtÚDeviûAdded
 
	msšgËtÚ_deviû_added
;

291 
LibH®SšgËtÚDeviûRemoved
 
	msšgËtÚ_deviû_»moved
;

293 *
	mu£r_d©a
;

305 
dbus_boŞ_t


306 
	$libh®_ùx_£t_u£r_d©a
(
LibH®CÚ‹xt
 *
ùx
, *
u£r_d©a
)

308 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

309 
ùx
->
u£r_d©a
 = user_data;

310  
TRUE
;

311 
	}
}

322 
	$libh®_ùx_g‘_u£r_d©a
(
LibH®CÚ‹xt
 *
ùx
)

324 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
NULL
);

325  
ùx
->
u£r_d©a
;

326 
	}
}

338 
dbus_boŞ_t


339 
	$libh®_´İ”ty_fl_v®ue_äom_v¬ŸÁ
 (
LibH®Prİ”ty
 *
p
, 
DBusMes§geI‹r
 *
v¬_™”
)

341 
DBusMes§geI‹r
 
™”_¬¿y
;

343 
	`LIBHAL_CHECK_PARAM_VALID
(
p
, "LibH®Prİ”ty *p", 
FALSE
);

344 
	`LIBHAL_CHECK_PARAM_VALID
(
v¬_™”
, "DBusMes§geI‹¸*v¬_™”", 
FALSE
);

346 
p
->
ty³
) {

347 
DBUS_TYPE_ARRAY
:

348 ià(
	`dbus_mes§ge_™”_g‘_–em’t_ty³
 (
v¬_™”
è!ğ
DBUS_TYPE_STRING
)

349  
FALSE
;

351 
	`dbus_mes§ge_™”_»cur£
 (
v¬_™”
, &
™”_¬¿y
);

352 
p
->
v
.
¡¾i¡_v®ue
 = 
	`libh®_g‘_¡ršg_¬¿y_äom_™”
 (&
™”_¬¿y
, 
NULL
);

354 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_STRLIST
;

357 
DBUS_TYPE_STRING
:

359 cÚ¡ *
v
;

361 
	`dbus_mes§ge_™”_g‘_basic
 (
v¬_™”
, &
v
);

363 
p
->
v
.
¡r_v®ue
 = 
	`¡rdup
 (v);

364 ià(
p
->
v
.
¡r_v®ue
 =ğ
NULL
)

365  
FALSE
;

366 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_STRING
;

370 
DBUS_TYPE_INT32
:

372 
dbus_št32_t
 
v
;

374 
	`dbus_mes§ge_™”_g‘_basic
 (
v¬_™”
, &
v
);

376 
p
->
v
.
št_v®ue
 = v;

377 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_INT32
;

381 
DBUS_TYPE_UINT64
:

383 
dbus_ušt64_t
 
v
;

385 
	`dbus_mes§ge_™”_g‘_basic
 (
v¬_™”
, &
v
);

387 
p
->
v
.
ušt64_v®ue
 = v;

388 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_UINT64
;

392 
DBUS_TYPE_DOUBLE
:

394 
v
;

396 
	`dbus_mes§ge_™”_g‘_basic
 (
v¬_™”
, &
v
);

398 
p
->
v
.
doubË_v®ue
 = v;

399 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_DOUBLE
;

403 
DBUS_TYPE_BOOLEAN
:

405 
v
;

407 
	`dbus_mes§ge_™”_g‘_basic
 (
v¬_™”
, &
v
);

409 
p
->
v
.
doubË_v®ue
 = v;

410 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_BOOLEAN
;

419  
TRUE
;

420 
	}
}

422 
LibH®Prİ”tyS‘
 *

423 
	$g‘_´İ”ty_£t
 (
DBusMes§geI‹r
 *
™”
)

425 
LibH®Prİ”tyS‘
 *
»suÉ
;

426 
DBusMes§geI‹r
 
diù_™”
;

428 
»suÉ
 = 
	`m®loc
 ( (
LibH®Prİ”tyS‘
));

429 ià(
»suÉ
 =ğ
NULL
)

430 
oom
;

441 
»suÉ
->
´İ”t›s
 = 
NULL
;

443 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (
™”
è!ğ
DBUS_TYPE_ARRAY
 &&

444 
	`dbus_mes§ge_™”_g‘_–em’t_ty³
 (
™”
è!ğ
DBUS_TYPE_DICT_ENTRY
) {

445 
	`årštf
 (
¡d”r
, "%s %d :ƒrror,ƒxpecting‡n‡rray of dictƒntries\n",

446 
__FILE__
, 
__LINE__
);

447 
	`ä“
 (
»suÉ
);

448  
NULL
;

451 
	`dbus_mes§ge_™”_»cur£
 (
™”
, &
diù_™”
);

453 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
diù_™”
è=ğ
DBUS_TYPE_DICT_ENTRY
)

455 
DBusMes§geI‹r
 
diù_’Œy_™”
, 
v¬_™”
;

456 cÚ¡ *
key
;

457 
LibH®Prİ”ty
 *
p
;

459 
	`dbus_mes§ge_™”_»cur£
 (&
diù_™”
, &
diù_’Œy_™”
);

461 
	`dbus_mes§ge_™”_g‘_basic
 (&
diù_’Œy_™”
, &
key
);

463 
p
 = 
	`m®loc
 ( (
LibH®Prİ”ty
));

464 ià(
p
 =ğ
NULL
)

465 
oom
;

467 
p
->
key
 = 
	`¡rdup
 (key);

468 ià(
p
->
key
 =ğ
NULL
) {

469 
	`ä“
 (
p
);

470 
oom
;

473 
	`dbus_mes§ge_™”_Ãxt
 (&
diù_’Œy_™”
);

475 
	`dbus_mes§ge_™”_»cur£
 (&
diù_’Œy_™”
, &
v¬_™”
);

477 
p
->
ty³
 = (
LibH®Prİ”tyTy³
è
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
v¬_™”
);

479 ià(!
	`libh®_´İ”ty_fl_v®ue_äom_v¬ŸÁ
 (
p
, &
v¬_™”
)) {

480 
	`ä“
 (
p
);

481 
oom
;

484 
	`HASH_ADD_KEYPTR
 (
hh
, 
»suÉ
->
´İ”t›s
, 
p
->
key
, 
	`¡¾’
 (p->key),…);

486 
	`dbus_mes§ge_™”_Ãxt
 (&
diù_™”
);

489  
»suÉ
;

491 
oom
:

492 ià(
»suÉ
 !ğ
NULL
)

493 
	`libh®_ä“_´İ”ty_£t
 (
»suÉ
);

495 
	`årštf
 (
¡d”r
,

497 
__FILE__
, 
__LINE__
);

499  
NULL
;

500 
	}
}

512 
LibH®Prİ”tyS‘
 *

513 
	$libh®_deviû_g‘_®l_´İ”t›s
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
)

515 
DBusMes§ge
 *
mes§ge
;

516 
DBusMes§ge
 *
»¶y
;

517 
DBusMes§geI‹r
 
»¶y_™”
;

518 
LibH®Prİ”tyS‘
 *
»suÉ
;

519 
DBusE¼Ü
 
_”rÜ
;

521 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
NULL
);

522 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
NULL
);

524 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

528 ià(
mes§ge
 =ğ
NULL
) {

529 
	`årštf
 (
¡d”r
,

531 
__FILE__
, 
__LINE__
);

532  
NULL
;

535 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

536 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

537 
mes§ge
, -1,

538 &
_”rÜ
);

540 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

542 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

543 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

544 
	`årštf
 (
¡d”r
,

546 
__FILE__
, 
__LINE__
, 
”rÜ
->
mes§ge
);

547  
NULL
;

550 ià(
»¶y
 =ğ
NULL
) {

551  
NULL
;

554 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

556 
»suÉ
 = 
	`g‘_´İ”ty_£t
 (&
»¶y_™”
);

558 
	`dbus_mes§ge_uÄef
 (
»¶y
);

560  
»suÉ
;

561 
	}
}

564 
	$key_sÜt
 (
LibH®Prİ”ty
 *
a
, LibH®Prİ”ty *
b
)

566  
	`¡rcmp
 (
a
->
key
, 
b
->key);

567 
	}
}

576 
	$libh®_´İ”ty_£t_sÜt
 (
LibH®Prİ”tyS‘
 *
£t
)

578 ià(
£t
 =ğ
NULL
)

581 
	`HASH_SORT
 (
£t
->
´İ”t›s
, 
key_sÜt
);

582 
	}
}

591 
	$libh®_ä“_´İ”ty_£t
 (
LibH®Prİ”tyS‘
 * 
£t
)

593 
LibH®Prİ”ty
 *
p
, *
p_Şd
;

595 ià(
£t
 =ğ
NULL
)

598 
p
 = 
£t
->
´İ”t›s
;… !ğ
NULL
;) {

599 
	`HASH_DELETE
 (
hh
, 
£t
->
´İ”t›s
, 
p
);

600 
	`ä“
 (
p
->
key
);

601 ià(
p
->
ty³
 =ğ
DBUS_TYPE_STRING
)

602 
	`ä“
 (
p
->
v
.
¡r_v®ue
);

603 ià(
p
->
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_STRLIST
)

604 
	`libh®_ä“_¡ršg_¬¿y
 (
p
->
v
.
¡¾i¡_v®ue
);

605 
p_Şd
 = 
p
;

606 
p
 =…->
hh
.
Ãxt
;

607 
	`ä“
 (
p_Şd
);

609 
	`ä“
 (
£t
);

610 
	}
}

621 
	$libh®_´İ”ty_£t_g‘_num_–ems
 (
LibH®Prİ”tyS‘
 *
£t
)

623 
num_–ems
;

624 
LibH®Prİ”ty
 *
p
;

626 
	`LIBHAL_CHECK_PARAM_VALID
(
£t
, "*set", 0);

628 
num_–ems
 = 0;

629 
p
 = 
£t
->
´İ”t›s
;… !ğ
NULL
;… =…->
hh
.
Ãxt
)

630 
num_–ems
++;

632  
num_–ems
;

633 
	}
}

635 
LibH®Prİ”ty
 *

636 
	$´İ”ty_£t_lookup
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
)

638 
LibH®Prİ”ty
 *
p
;

640 
	`LIBHAL_CHECK_PARAM_VALID
(
£t
, "*£t", 
NULL
);

641 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
NULL
);

643 
	`HASH_FIND_STR
 (
£t
->
´İ”t›s
, 
key
, 
p
);

644  
p
;

645 
	}
}

657 
LibH®Prİ”tyTy³


658 
	$libh®_ps_g‘_ty³
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
)

660 
LibH®Prİ”ty
 *
p
;

662 
	`LIBHAL_CHECK_PARAM_VALID
(
£t
, "*£t", 
LIBHAL_PROPERTY_TYPE_INVALID
);

663 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
LIBHAL_PROPERTY_TYPE_INVALID
);

665 
p
 = 
	`´İ”ty_£t_lookup
 (
£t
, 
key
);

666 ià(
p
è…->
ty³
;

667  
LIBHAL_PROPERTY_TYPE_INVALID
;

668 
	}
}

682 
	$libh®_ps_g‘_¡ršg
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
)

684 
LibH®Prİ”ty
 *
p
;

686 
	`LIBHAL_CHECK_PARAM_VALID
(
£t
, "*£t", 
NULL
);

687 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
NULL
);

689 
p
 = 
	`´İ”ty_£t_lookup
 (
£t
, 
key
);

690 ià(
p
 &&…->
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_STRING
)

691  
p
->
v
.
¡r_v®ue
;

692  
NULL
;

693 
	}
}

704 
dbus_št32_t


705 
	$libh®_ps_g‘_št32
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
)

707 
LibH®Prİ”ty
 *
p
;

709 
	`LIBHAL_CHECK_PARAM_VALID
(
£t
, "*set", 0);

710 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 0);

712 
p
 = 
	`´İ”ty_£t_lookup
 (
£t
, 
key
);

713 ià(
p
 &&…->
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_INT32
)

714  
p
->
v
.
št_v®ue
;

716 
	}
}

727 
dbus_ušt64_t


728 
	$libh®_ps_g‘_ušt64
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
)

730 
LibH®Prİ”ty
 *
p
;

732 
	`LIBHAL_CHECK_PARAM_VALID
(
£t
, "*set", 0);

733 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 0);

735 
p
 = 
	`´İ”ty_£t_lookup
 (
£t
, 
key
);

736 ià(
p
 &&…->
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_UINT64
)

737  
p
->
v
.
ušt64_v®ue
;

739 
	}
}

751 
	$libh®_ps_g‘_doubË
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
)

753 
LibH®Prİ”ty
 *
p
;

755 
	`LIBHAL_CHECK_PARAM_VALID
(
£t
, "*set", 0.0);

756 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 0.0);

758 
p
 = 
	`´İ”ty_£t_lookup
 (
£t
, 
key
);

759 ià(
p
 &&…->
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_DOUBLE
)

760  
p
->
v
.
doubË_v®ue
;

762 
	}
}

773 
dbus_boŞ_t


774 
	$libh®_ps_g‘_boŞ
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
)

776 
LibH®Prİ”ty
 *
p
;

778 
	`LIBHAL_CHECK_PARAM_VALID
(
£t
, "*£t", 
FALSE
);

779 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

781 
p
 = 
	`´İ”ty_£t_lookup
 (
£t
, 
key
);

782 ià(
p
 &&…->
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_BOOLEAN
)

783  
p
->
v
.
boŞ_v®ue
;

784  
FALSE
;

785 
	}
}

797 
	$libh®_ps_g‘_¡¾i¡
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
)

799 
LibH®Prİ”ty
 *
p
;

801 
	`LIBHAL_CHECK_PARAM_VALID
(
£t
, "*£t", 
NULL
);

802 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
NULL
);

804 
p
 = 
	`´İ”ty_£t_lookup
 (
£t
, 
key
);

805 ià(
p
 &&…->
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_STRLIST
)

806  (cÚ¡ *cÚ¡ *è
p
->
v
.
¡¾i¡_v®ue
;

807  
NULL
;

808 
	}
}

820 
	$libh®_psi_š™
 (
LibH®Prİ”tyS‘I‹¿tÜ
 * 
™”
, 
LibH®Prİ”tyS‘
 * 
£t
)

822 ià(
£t
 =ğ
NULL
)

825 
™”
->
£t
 = set;

826 
™”
->
idx
 = -1;

827 
™”
->
cur_´İ
 = 
£t
->
´İ”t›s
;

828 
	}
}

839 
dbus_boŞ_t


840 
	$libh®_psi_has_mÜe
 (
LibH®Prİ”tyS‘I‹¿tÜ
 * 
™”
)

842  (
™”
->
cur_´İ
 !ğ
NULL
);

843 
	}
}

852 
	$libh®_psi_Ãxt
 (
LibH®Prİ”tyS‘I‹¿tÜ
 * 
™”
)

854 
™”
->
cur_´İ
 = i‹r->cur_´İ->
hh
.
Ãxt
;

855 
	}
}

865 
LibH®Prİ”tyTy³


866 
	$libh®_psi_g‘_ty³
 (
LibH®Prİ”tyS‘I‹¿tÜ
 * 
™”
)

868  
™”
->
cur_´İ
->
ty³
;

869 
	}
}

882 
	$libh®_psi_g‘_key
 (
LibH®Prİ”tyS‘I‹¿tÜ
 * 
™”
)

884  
™”
->
cur_´İ
->
key
;

885 
	}
}

898 
	$libh®_psi_g‘_¡ršg
 (
LibH®Prİ”tyS‘I‹¿tÜ
 * 
™”
)

900  
™”
->
cur_´İ
->
v
.
¡r_v®ue
;

901 
	}
}

911 
dbus_št32_t


912 
	$libh®_psi_g‘_št
 (
LibH®Prİ”tyS‘I‹¿tÜ
 * 
™”
)

914  
™”
->
cur_´İ
->
v
.
št_v®ue
;

915 
	}
}

925 
dbus_ušt64_t


926 
	$libh®_psi_g‘_ušt64
 (
LibH®Prİ”tyS‘I‹¿tÜ
 * 
™”
)

928  
™”
->
cur_´İ
->
v
.
ušt64_v®ue
;

929 
	}
}

940 
	$libh®_psi_g‘_doubË
 (
LibH®Prİ”tyS‘I‹¿tÜ
 * 
™”
)

942  
™”
->
cur_´İ
->
v
.
doubË_v®ue
;

943 
	}
}

953 
dbus_boŞ_t


954 
	$libh®_psi_g‘_boŞ
 (
LibH®Prİ”tyS‘I‹¿tÜ
 * 
™”
)

956  
™”
->
cur_´İ
->
v
.
boŞ_v®ue
;

957 
	}
}

968 
	$libh®_psi_g‘_¡¾i¡
 (
LibH®Prİ”tyS‘I‹¿tÜ
 * 
™”
)

970  
™”
->
cur_´İ
->
v
.
¡¾i¡_v®ue
;

971 
	}
}

973 
DBusHªdËrResuÉ


974 
	$sšgËtÚ_deviû_chªged
 (
LibH®CÚ‹xt
 *
ùx
, 
DBusCÚÃùiÚ
 *
cÚÃùiÚ
, 
DBusMes§ge
 *
msg
, 
dbus_boŞ_t
 
added
)

976 
DBusMes§ge
 *
»¶y
;

977 
DBusMes§geI‹r
 
™”
;

978 
LibH®Prİ”tyS‘
 *
£t
;

979 cÚ¡ *
udi
;

981 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
);

983 
	`dbus_mes§ge_™”_š™
 (
msg
, &
™”
);

986 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”
è!ğ
DBUS_TYPE_STRING
)

987 
m®fÜmed
;

989 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
udi
);

991 
	`dbus_mes§ge_™”_Ãxt
 (&
™”
);

994 
£t
 = 
	`g‘_´İ”ty_£t
 (&
™”
);

996 ià(!
£t
)

997 
m®fÜmed
;

998 ià(
added
)

999 (
ùx
->
sšgËtÚ_deviû_added
)(ùx, 
udi
, 
£t
);

1001 (
ùx
->
sšgËtÚ_deviû_»moved
)(ùx, 
udi
, 
£t
);

1003 
	`libh®_ä“_´İ”ty_£t
 (
£t
);

1005 
»¶y
 = 
	`dbus_mes§ge_Ãw_m‘hod_»tuº
 (
msg
);

1006 ià(
»¶y
 =ğ
NULL
)

1007 
oom
;

1009 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
»¶y
, 
NULL
)) {

1010 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1011 
oom
;

1014 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1016  
DBUS_HANDLER_RESULT_HANDLED
;

1018 
m®fÜmed
:

1019 
	`årštf
 (
¡d”r
, "% %d : sšgÉÚ deviû chªged mes§gm®fÜmed\n", 
__FILE__
, 
__LINE__
);

1020  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1021 
oom
:

1022 
	`årštf
 (
¡d”r
, "% %d :ƒ¼Ü‡Îoÿtšg memÜy\n", 
__FILE__
, 
__LINE__
);

1023  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1024 
	}
}

1026 
DBusHªdËrResuÉ


1027 
	$f‹r_func
 (
DBusCÚÃùiÚ
 * 
cÚÃùiÚ
,

1028 
DBusMes§ge
 * 
mes§ge
, *
u£r_d©a
)

1030 cÚ¡ *
objeù_·th
;

1031 
DBusE¼Ü
 
”rÜ
;

1032 
LibH®CÚ‹xt
 *
ùx
 = (LibH®CÚ‹xˆ*è
u£r_d©a
;

1034 ià(
ùx
->
is_shutdown
)

1035  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1037 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1039 
objeù_·th
 = 
	`dbus_mes§ge_g‘_·th
 (
mes§ge
);

1048 ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.Hal.Manager",

1050 *
udi
;

1051 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1052 
DBUS_TYPE_STRING
, &
udi
,

1053 
DBUS_TYPE_INVALID
)) {

1054 ià(
ùx
->
deviû_added
 !ğ
NULL
) {

1055 
ùx
->
	`deviû_added
 (ùx, 
udi
);

1058 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1060  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1061 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.Hal.Manager", "DeviceRemoved")) {

1062 *
udi
;

1063 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1064 
DBUS_TYPE_STRING
, &
udi
,

1065 
DBUS_TYPE_INVALID
)) {

1066 ià(
ùx
->
deviû_»moved
 !ğ
NULL
) {

1067 
ùx
->
	`deviû_»moved
 (ùx, 
udi
);

1070 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1072  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1073 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.Hal.Manager","NewCapability")) {

1074 *
udi
;

1075 *
ÿ·b™y
;

1076 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1077 
DBUS_TYPE_STRING
, &
udi
,

1078 
DBUS_TYPE_STRING
, &
ÿ·b™y
,

1079 
DBUS_TYPE_INVALID
)) {

1080 ià(
ùx
->
deviû_Ãw_ÿ·b™y
 !ğ
NULL
) {

1081 
ùx
->
	`deviû_Ãw_ÿ·b™y
 (ùx, 
udi
, 
ÿ·b™y
);

1084 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1086  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1087 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.Hal.Manager","GlobalInterfaceLockAcquired")) {

1088 *
lock_Çme
;

1089 *
lock_owÃr
;

1090 
num_locks
;

1091 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1092 
DBUS_TYPE_STRING
, &
lock_Çme
,

1093 
DBUS_TYPE_STRING
, &
lock_owÃr
,

1094 
DBUS_TYPE_INT32
, &
num_locks
,

1095 
DBUS_TYPE_INVALID
)) {

1096 ià(
ùx
->
glob®_š‹rçû_lock_acquœed
 !ğ
NULL
) {

1097 
ùx
->
	`glob®_š‹rçû_lock_acquœed
 (ùx, 
lock_Çme
, 
lock_owÃr
, 
num_locks
);

1100 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1102  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1103 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.Hal.Manager","GlobalInterfaceLockReleased")) {

1104 *
lock_Çme
;

1105 *
lock_owÃr
;

1106 
num_locks
;

1107 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1108 
DBUS_TYPE_STRING
, &
lock_Çme
,

1109 
DBUS_TYPE_STRING
, &
lock_owÃr
,

1110 
DBUS_TYPE_INT32
, &
num_locks
,

1111 
DBUS_TYPE_INVALID
)) {

1112 ià(
ùx
->
glob®_š‹rçû_lock_»Ëa£d
 !ğ
NULL
) {

1113 
ùx
->
	`glob®_š‹rçû_lock_»Ëa£d
 (ùx, 
lock_Çme
, 
lock_owÃr
, 
num_locks
);

1116 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1118  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1119 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.Hal.Device", "Condition")) {

1120 *
cÚd™iÚ_Çme
;

1121 *
cÚd™iÚ_d‘a
;

1122 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1123 
DBUS_TYPE_STRING
, &
cÚd™iÚ_Çme
,

1124 
DBUS_TYPE_STRING
, &
cÚd™iÚ_d‘a
,

1125 
DBUS_TYPE_INVALID
)) {

1126 ià(
ùx
->
deviû_cÚd™iÚ
 !ğ
NULL
) {

1127 
ùx
->
	`deviû_cÚd™iÚ
 (ùx, 
objeù_·th
, 
cÚd™iÚ_Çme
, 
cÚd™iÚ_d‘a
);

1130 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1132  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1133 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.Hal.Device","InterfaceLockAcquired")) {

1134 *
lock_Çme
;

1135 *
lock_owÃr
;

1136 
num_locks
;

1137 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1138 
DBUS_TYPE_STRING
, &
lock_Çme
,

1139 
DBUS_TYPE_STRING
, &
lock_owÃr
,

1140 
DBUS_TYPE_INT32
, &
num_locks
,

1141 
DBUS_TYPE_INVALID
)) {

1142 ià(
ùx
->
š‹rçû_lock_acquœed
 !ğ
NULL
) {

1143 
ùx
->
	`š‹rçû_lock_acquœed
 (ùx, 
objeù_·th
, 
lock_Çme
, 
lock_owÃr
, 
num_locks
);

1146 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1148  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1149 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.Hal.Device","InterfaceLockReleased")) {

1150 *
lock_Çme
;

1151 *
lock_owÃr
;

1152 
num_locks
;

1153 ià(
	`dbus_mes§ge_g‘_¬gs
 (
mes§ge
, &
”rÜ
,

1154 
DBUS_TYPE_STRING
, &
lock_Çme
,

1155 
DBUS_TYPE_STRING
, &
lock_owÃr
,

1156 
DBUS_TYPE_INT32
, &
num_locks
,

1157 
DBUS_TYPE_INVALID
)) {

1158 ià(
ùx
->
š‹rçû_lock_»Ëa£d
 !ğ
NULL
) {

1159 
ùx
->
	`š‹rçû_lock_»Ëa£d
 (ùx, 
objeù_·th
, 
lock_Çme
, 
lock_owÃr
, 
num_locks
);

1162 
	`LIBHAL_FREE_DBUS_ERROR
(&
”rÜ
);

1164  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1165 } ià(
	`dbus_mes§ge_is_sigÇl
 (
mes§ge
, "org.freedesktop.Hal.Device", "PropertyModified")) {

1166 ià(
ùx
->
deviû_´İ”ty_modif›d
 !ğ
NULL
) {

1167 
i
;

1168 *
key
;

1169 
dbus_boŞ_t
 
»moved
;

1170 
dbus_boŞ_t
 
added
;

1171 
num_modifiÿtiÚs
;

1172 
DBusMes§geI‹r
 
™”
;

1173 
DBusMes§geI‹r
 
™”_¬¿y
;

1175 
	`dbus_mes§ge_™”_š™
 (
mes§ge
, &
™”
);

1176 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”
, &
num_modifiÿtiÚs
);

1177 
	`dbus_mes§ge_™”_Ãxt
 (&
™”
);

1179 
	`dbus_mes§ge_™”_»cur£
 (&
™”
, &
™”_¬¿y
);

1181 
i
 = 0; i < 
num_modifiÿtiÚs
; i++) {

1182 
DBusMes§geI‹r
 
™”_¡ruù
;

1184 
	`dbus_mes§ge_™”_»cur£
 (&
™”_¬¿y
, &
™”_¡ruù
);

1186 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”_¡ruù
, &
key
);

1187 
	`dbus_mes§ge_™”_Ãxt
 (&
™”_¡ruù
);

1188 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”_¡ruù
, &
»moved
);

1189 
	`dbus_mes§ge_™”_Ãxt
 (&
™”_¡ruù
);

1190 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”_¡ruù
, &
added
);

1192 
ùx
->
	`deviû_´İ”ty_modif›d
 (ctx,

1193 
objeù_·th
,

1194 
key
, 
»moved
,

1195 
added
);

1197 
	`dbus_mes§ge_™”_Ãxt
 (&
™”_¬¿y
);

1201  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1202 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

1205 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

1207  
	`sšgËtÚ_deviû_chªged
 (
ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
TRUE
);

1208 } ià(
	`dbus_mes§ge_is_m‘hod_ÿÎ
 (
mes§ge
,

1211 
	`¡rcmp
 (
	`dbus_mes§ge_g‘_·th
 (
mes§ge
),

1213  
	`sšgËtÚ_deviû_chªged
 (
ùx
, 
cÚÃùiÚ
, 
mes§ge
, 
FALSE
);

1216  
DBUS_HANDLER_RESULT_NOT_YET_HANDLED
;

1217 
	}
}

1232 
	$libh®_g‘_®l_deviûs
 (
LibH®CÚ‹xt
 *
ùx
, *
num_deviûs
, 
DBusE¼Ü
 *
”rÜ
)

1234 
DBusMes§ge
 *
mes§ge
;

1235 
DBusMes§ge
 *
»¶y
;

1236 
DBusMes§geI‹r
 
™”_¬¿y
, 
»¶y_™”
;

1237 **
h®_deviû_Çmes
;

1238 
DBusE¼Ü
 
_”rÜ
;

1240 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
NULL
);

1242 *
num_deviûs
 = 0;

1244 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

1248 ià(
mes§ge
 =ğ
NULL
) {

1249 
	`årštf
 (
¡d”r
, "% %d : Could‚Ù‡Îoÿ‹ D-BUS mes§ge\n", 
__FILE__
, 
__LINE__
);

1250  
NULL
;

1253 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

1254 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
, 
mes§ge
, -1, &
_”rÜ
);

1256 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

1258 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

1259 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

1260  
NULL
;

1262 ià(
»¶y
 =ğ
NULL
) {

1263  
NULL
;

1267 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

1269 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_ARRAY
) {

1270 
	`årštf
 (
¡d”r
, "% %d : wrÚg„•ly from h®d. Ex³ùšg‡À¬¿y.\n", 
__FILE__
, 
__LINE__
);

1271 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1272  
NULL
;

1275 
	`dbus_mes§ge_™”_»cur£
 (&
»¶y_™”
, &
™”_¬¿y
);

1277 
h®_deviû_Çmes
 = 
	`libh®_g‘_¡ršg_¬¿y_äom_™”
 (&
™”_¬¿y
, 
num_deviûs
);

1279 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1280  
h®_deviû_Çmes
;

1281 
	}
}

1295 
LibH®Prİ”tyTy³


1296 
	$libh®_deviû_g‘_´İ”ty_ty³
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, cÚ¡ *
key
, 
DBusE¼Ü
 *
”rÜ
)

1298 
DBusMes§ge
 *
mes§ge
;

1299 
DBusMes§ge
 *
»¶y
;

1300 
DBusMes§geI‹r
 
™”
, 
»¶y_™”
;

1301 
LibH®Prİ”tyTy³
 
ty³
;

1302 
DBusE¼Ü
 
_”rÜ
;

1304 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
LIBHAL_PROPERTY_TYPE_INVALID
);

1305 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
LIBHAL_PROPERTY_TYPE_INVALID
);

1306 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
LIBHAL_PROPERTY_TYPE_INVALID
);

1308 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

1311 ià(
mes§ge
 =ğ
NULL
) {

1312 
	`årštf
 (
¡d”r
, "% %d : Couldn'ˆ®loÿ‹ D-BUS mes§ge\n", 
__FILE__
, 
__LINE__
);

1313  
LIBHAL_PROPERTY_TYPE_INVALID
;

1316 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

1317 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

1319 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

1320 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

1321 
mes§ge
, -1,

1322 &
_”rÜ
);

1324 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

1326 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

1327 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

1328  
LIBHAL_PROPERTY_TYPE_INVALID
;

1330 ià(
»¶y
 =ğ
NULL
) {

1331  
LIBHAL_PROPERTY_TYPE_INVALID
;

1334 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

1335 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
ty³
);

1337 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1338  
ty³
;

1339 
	}
}

1356 
	$libh®_deviû_g‘_´İ”ty_¡¾i¡
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, cÚ¡ *
key
, 
DBusE¼Ü
 *
”rÜ
)

1358 
DBusMes§ge
 *
mes§ge
;

1359 
DBusMes§ge
 *
»¶y
;

1360 
DBusMes§geI‹r
 
™”
, 
™”_¬¿y
, 
»¶y_™”
;

1361 **
our_¡ršgs
;

1362 
DBusE¼Ü
 
_”rÜ
;

1364 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
NULL
);

1365 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
NULL
);

1366 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
NULL
);

1368 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

1371 ià(
mes§ge
 =ğ
NULL
) {

1372 
	`årštf
 (
¡d”r
,

1374 
__FILE__
, 
__LINE__
);

1375  
NULL
;

1378 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

1379 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

1381 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

1382 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

1383 
mes§ge
, -1,

1384 &
_”rÜ
);

1386 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

1388 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

1389 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

1390  
NULL
;

1392 ià(
»¶y
 =ğ
NULL
) {

1393  
NULL
;

1396 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

1398 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_ARRAY
) {

1399 
	`årštf
 (
¡d”r
, "% %d : wrÚg„•ly from h®d. Ex³ùšg‡À¬¿y.\n", 
__FILE__
, 
__LINE__
);

1400 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1401  
NULL
;

1404 
	`dbus_mes§ge_™”_»cur£
 (&
»¶y_™”
, &
™”_¬¿y
);

1406 
our_¡ršgs
 = 
	`libh®_g‘_¡ršg_¬¿y_äom_™”
 (&
™”_¬¿y
, 
NULL
);

1408 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1409  
our_¡ršgs
;

1410 
	}
}

1426 
	$libh®_deviû_g‘_´İ”ty_¡ršg
 (
LibH®CÚ‹xt
 *
ùx
,

1427 cÚ¡ *
udi
, cÚ¡ *
key
, 
DBusE¼Ü
 *
”rÜ
)

1429 
DBusMes§ge
 *
mes§ge
;

1430 
DBusMes§ge
 *
»¶y
;

1431 
DBusMes§geI‹r
 
™”
, 
»¶y_™”
;

1432 *
v®ue
;

1433 *
dbus_¡r
;

1434 
DBusE¼Ü
 
_”rÜ
;

1436 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
NULL
);

1437 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
NULL
);

1438 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
NULL
);

1440 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

1444 ià(
mes§ge
 =ğ
NULL
) {

1445 
	`årštf
 (
¡d”r
,

1447 
__FILE__
, 
__LINE__
);

1448  
NULL
;

1451 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

1452 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

1454 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

1455 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

1456 
mes§ge
, -1,

1457 &
_”rÜ
);

1459 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

1461 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

1462 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

1463  
NULL
;

1465 ià(
»¶y
 =ğ
NULL
) {

1466  
NULL
;

1469 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

1472 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
) !=

1473 
DBUS_TYPE_STRING
) {

1474 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1475  
NULL
;

1478 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
dbus_¡r
);

1479 
v®ue
 = (*è((
dbus_¡r
 !ğ
NULL
è? 
	`¡rdup
 (dbus_str) : NULL);

1480 ià(
v®ue
 =ğ
NULL
) {

1481 
	`årštf
 (
¡d”r
, "%s %d :ƒrror‡llocating memory\n",

1482 
__FILE__
, 
__LINE__
);

1485 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1486  
v®ue
;

1487 
	}
}

1500 
dbus_št32_t


1501 
	$libh®_deviû_g‘_´İ”ty_št
 (
LibH®CÚ‹xt
 *
ùx
,

1502 cÚ¡ *
udi
, cÚ¡ *
key
, 
DBusE¼Ü
 *
”rÜ
)

1504 
DBusMes§ge
 *
mes§ge
;

1505 
DBusMes§ge
 *
»¶y
;

1506 
DBusMes§geI‹r
 
™”
, 
»¶y_™”
;

1507 
dbus_št32_t
 
v®ue
;

1508 
DBusE¼Ü
 
_”rÜ
;

1510 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, -1);

1511 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, -1);

1512 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", -1);

1514 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

1517 ià(
mes§ge
 =ğ
NULL
) {

1518 
	`årštf
 (
¡d”r
,

1520 
__FILE__
, 
__LINE__
);

1524 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

1525 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

1527 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

1528 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

1529 
mes§ge
, -1,

1530 &
_”rÜ
);

1532 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

1534 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

1535 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

1538 ià(
»¶y
 =ğ
NULL
) {

1542 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

1545 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
) !=

1546 
DBUS_TYPE_INT32
) {

1547 
	`årštf
 (
¡d”r
,

1549 "oàty³ iÁeg”\n", 
__FILE__
, 
__LINE__
, 
key
,

1550 
udi
);

1551 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1554 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
v®ue
);

1556 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1557  
v®ue
;

1558 
	}
}

1571 
dbus_ušt64_t


1572 
	$libh®_deviû_g‘_´İ”ty_ušt64
 (
LibH®CÚ‹xt
 *
ùx
,

1573 cÚ¡ *
udi
, cÚ¡ *
key
, 
DBusE¼Ü
 *
”rÜ
)

1575 
DBusMes§ge
 *
mes§ge
;

1576 
DBusMes§ge
 *
»¶y
;

1577 
DBusMes§geI‹r
 
™”
, 
»¶y_™”
;

1578 
dbus_ušt64_t
 
v®ue
;

1579 
DBusE¼Ü
 
_”rÜ
;

1581 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, -1);

1582 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, -1);

1583 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", -1);

1585 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

1588 ià(
mes§ge
 =ğ
NULL
) {

1589 
	`årštf
 (
¡d”r
,

1591 
__FILE__
, 
__LINE__
);

1595 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

1596 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

1598 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

1599 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

1600 
mes§ge
, -1,

1601 &
_”rÜ
);

1603 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

1605 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

1606 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

1609 ià(
»¶y
 =ğ
NULL
) {

1613 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

1615 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
) !=

1616 
DBUS_TYPE_UINT64
) {

1617 
	`årštf
 (
¡d”r
,

1619 "oàty³ iÁeg”\n", 
__FILE__
, 
__LINE__
, 
key
,

1620 
udi
);

1621 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1624 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
v®ue
);

1626 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1627  
v®ue
;

1628 
	}
}

1642 
	$libh®_deviû_g‘_´İ”ty_doubË
 (
LibH®CÚ‹xt
 *
ùx
,

1643 cÚ¡ *
udi
, cÚ¡ *
key
, 
DBusE¼Ü
 *
”rÜ
)

1645 
DBusMes§ge
 *
mes§ge
;

1646 
DBusMes§ge
 *
»¶y
;

1647 
DBusMes§geI‹r
 
™”
, 
»¶y_™”
;

1648 
v®ue
;

1649 
DBusE¼Ü
 
_”rÜ
;

1651 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, -1.0);

1652 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, -1.0);

1653 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", -1.0);

1655 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

1658 ià(
mes§ge
 =ğ
NULL
) {

1659 
	`årštf
 (
¡d”r
,

1661 
__FILE__
, 
__LINE__
);

1665 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

1666 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

1668 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

1669 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

1670 
mes§ge
, -1,

1671 &
_”rÜ
);

1673 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

1675 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

1676 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

1679 ià(
»¶y
 =ğ
NULL
) {

1683 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

1686 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
) !=

1687 
DBUS_TYPE_DOUBLE
) {

1688 
	`årštf
 (
¡d”r
,

1690 "oàty³ doubË\n", 
__FILE__
, 
__LINE__
, 
key
, 
udi
);

1691 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1694 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
v®ue
);

1696 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1697  (è
v®ue
;

1698 
	}
}

1711 
dbus_boŞ_t


1712 
	$libh®_deviû_g‘_´İ”ty_boŞ
 (
LibH®CÚ‹xt
 *
ùx
,

1713 cÚ¡ *
udi
, cÚ¡ *
key
, 
DBusE¼Ü
 *
”rÜ
)

1715 
DBusMes§ge
 *
mes§ge
;

1716 
DBusMes§ge
 *
»¶y
;

1717 
DBusMes§geI‹r
 
™”
, 
»¶y_™”
;

1718 
dbus_boŞ_t
 
v®ue
;

1719 
DBusE¼Ü
 
_”rÜ
;

1721 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

1722 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

1723 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

1725 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

1728 ià(
mes§ge
 =ğ
NULL
) {

1729 
	`årštf
 (
¡d”r
,

1731 
__FILE__
, 
__LINE__
);

1732  
FALSE
;

1735 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

1736 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

1738 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

1739 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

1740 
mes§ge
, -1,

1741 &
_”rÜ
);

1743 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

1745 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

1746 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

1747  
FALSE
;

1749 ià(
»¶y
 =ğ
NULL
) {

1750  
FALSE
;

1753 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

1756 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
) !=

1757 
DBUS_TYPE_BOOLEAN
) {

1758 
	`årštf
 (
¡d”r
,

1760 "oàty³ boŞ\n", 
__FILE__
, 
__LINE__
, 
key
, 
udi
);

1761 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1762  
FALSE
;

1764 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
v®ue
);

1766 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1767  
v®ue
;

1768 
	}
}

1772 
dbus_boŞ_t


1773 
	$libh®_deviû_£t_´İ”ty_h–³r
 (
LibH®CÚ‹xt
 *
ùx
,

1774 cÚ¡ *
udi
,

1775 cÚ¡ *
key
,

1776 
ty³
,

1777 cÚ¡ *
¡r_v®ue
,

1778 
dbus_št32_t
 
št_v®ue
,

1779 
dbus_ušt64_t
 
ušt64_v®ue
,

1780 
doubË_v®ue
,

1781 
dbus_boŞ_t
 
boŞ_v®ue
,

1782 
DBusE¼Ü
 *
”rÜ
)

1784 
DBusMes§ge
 *
mes§ge
;

1785 
DBusMes§ge
 *
»¶y
;

1786 
DBusMes§geI‹r
 
™”
;

1787 *
m‘hod_Çme
 = 
NULL
;

1789 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

1790 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

1791 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

1794 
ty³
) {

1795 
DBUS_TYPE_INVALID
:

1796 
m‘hod_Çme
 = "RemoveProperty";

1798 
DBUS_TYPE_STRING
:

1799 
m‘hod_Çme
 = "SetPropertyString";

1801 
DBUS_TYPE_INT32
:

1802 
DBUS_TYPE_UINT64
:

1803 
m‘hod_Çme
 = "SetPropertyInteger";

1805 
DBUS_TYPE_DOUBLE
:

1806 
m‘hod_Çme
 = "SetPropertyDouble";

1808 
DBUS_TYPE_BOOLEAN
:

1809 
m‘hod_Çme
 = "SetPropertyBoolean";

1817 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

1819 
m‘hod_Çme
);

1820 ià(
mes§ge
 =ğ
NULL
) {

1821 
	`årštf
 (
¡d”r
,

1823 
__FILE__
, 
__LINE__
);

1824  
FALSE
;

1827 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

1828 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

1829 
ty³
) {

1830 
DBUS_TYPE_STRING
:

1831 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
¡r_v®ue
);

1833 
DBUS_TYPE_INT32
:

1834 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_INT32
, &
št_v®ue
);

1836 
DBUS_TYPE_UINT64
:

1837 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_UINT64
, &
ušt64_v®ue
);

1839 
DBUS_TYPE_DOUBLE
:

1840 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_DOUBLE
, &
doubË_v®ue
);

1842 
DBUS_TYPE_BOOLEAN
:

1843 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
boŞ_v®ue
);

1848 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

1849 
mes§ge
, -1,

1850 
”rÜ
);

1852 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

1854 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

1855  
FALSE
;

1857 ià(
»¶y
 =ğ
NULL
) {

1858  
FALSE
;

1861 
	`dbus_mes§ge_uÄef
 (
»¶y
);

1863  
TRUE
;

1864 
	}
}

1879 
dbus_boŞ_t


1880 
	$libh®_deviû_£t_´İ”ty_¡ršg
 (
LibH®CÚ‹xt
 *
ùx
,

1881 cÚ¡ *
udi
,

1882 cÚ¡ *
key
,

1883 cÚ¡ *
v®ue
,

1884 
DBusE¼Ü
 *
”rÜ
)

1886 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

1887 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

1888 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

1889 
	`LIBHAL_CHECK_PARAM_VALID
(
v®ue
, "*v®ue", 
FALSE
);

1891  
	`libh®_deviû_£t_´İ”ty_h–³r
 (
ùx
, 
udi
, 
key
,

1892 
DBUS_TYPE_STRING
,

1893 
v®ue
, 0, 0, 0.0f, 
FALSE
, 
”rÜ
);

1894 
	}
}

1909 
dbus_boŞ_t


1910 
	$libh®_deviû_£t_´İ”ty_št
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
,

1911 cÚ¡ *
key
, 
dbus_št32_t
 
v®ue
, 
DBusE¼Ü
 *
”rÜ
)

1913 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

1914 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

1915 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

1917  
	`libh®_deviû_£t_´İ”ty_h–³r
 (
ùx
, 
udi
, 
key
,

1918 
DBUS_TYPE_INT32
,

1919 
NULL
, 
v®ue
, 0, 0.0f, 
FALSE
, 
”rÜ
);

1920 
	}
}

1935 
dbus_boŞ_t


1936 
	$libh®_deviû_£t_´İ”ty_ušt64
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
,

1937 cÚ¡ *
key
, 
dbus_ušt64_t
 
v®ue
, 
DBusE¼Ü
 *
”rÜ
)

1939 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

1940 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

1941 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

1943  
	`libh®_deviû_£t_´İ”ty_h–³r
 (
ùx
, 
udi
, 
key
,

1944 
DBUS_TYPE_UINT64
,

1945 
NULL
, 0, 
v®ue
, 0.0f, 
FALSE
, 
”rÜ
);

1946 
	}
}

1961 
dbus_boŞ_t


1962 
	$libh®_deviû_£t_´İ”ty_doubË
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
,

1963 cÚ¡ *
key
, 
v®ue
, 
DBusE¼Ü
 *
”rÜ
)

1965 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

1966 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

1967 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

1969  
	`libh®_deviû_£t_´İ”ty_h–³r
 (
ùx
, 
udi
, 
key
,

1970 
DBUS_TYPE_DOUBLE
,

1971 
NULL
, 0, 0, 
v®ue
, 
FALSE
, 
”rÜ
);

1972 
	}
}

1987 
dbus_boŞ_t


1988 
	$libh®_deviû_£t_´İ”ty_boŞ
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
,

1989 cÚ¡ *
key
, 
dbus_boŞ_t
 
v®ue
, 
DBusE¼Ü
 *
”rÜ
)

1991 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

1992 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

1993 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

1995  
	`libh®_deviû_£t_´İ”ty_h–³r
 (
ùx
, 
udi
, 
key
,

1996 
DBUS_TYPE_BOOLEAN
,

1997 
NULL
, 0, 0, 0.0f, 
v®ue
, 
”rÜ
);

1998 
	}
}

2013 
dbus_boŞ_t


2014 
	$libh®_deviû_»move_´İ”ty
 (
LibH®CÚ‹xt
 *
ùx
,

2015 cÚ¡ *
udi
, cÚ¡ *
key
, 
DBusE¼Ü
 *
”rÜ
)

2017 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2018 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

2019 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

2021  
	`libh®_deviû_£t_´İ”ty_h–³r
 (
ùx
, 
udi
, 
key
, 
DBUS_TYPE_INVALID
,

2023 
NULL
, 0, 0, 0.0f, 
FALSE
, 
”rÜ
);

2024 
	}
}

2039 
dbus_boŞ_t


2040 
	$libh®_deviû_´İ”ty_¡¾i¡_­³nd
 (
LibH®CÚ‹xt
 *
ùx
,

2041 cÚ¡ *
udi
,

2042 cÚ¡ *
key
,

2043 cÚ¡ *
v®ue
,

2044 
DBusE¼Ü
 *
”rÜ
)

2046 
DBusMes§ge
 *
mes§ge
;

2047 
DBusMes§ge
 *
»¶y
;

2048 
DBusMes§geI‹r
 
™”
;

2050 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2051 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

2052 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

2053 
	`LIBHAL_CHECK_PARAM_VALID
(
v®ue
, "*v®ue", 
FALSE
);

2055 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

2058 ià(
mes§ge
 =ğ
NULL
) {

2059 
	`årštf
 (
¡d”r
,

2061 
__FILE__
, 
__LINE__
);

2062  
FALSE
;

2064 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2065 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

2066 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
v®ue
);

2068 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2069 
mes§ge
, -1,

2070 
”rÜ
);

2072 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2074 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2075  
FALSE
;

2077 ià(
»¶y
 =ğ
NULL
) {

2078  
FALSE
;

2081 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2082  
TRUE
;

2083 
	}
}

2098 
dbus_boŞ_t


2099 
	$libh®_deviû_´İ”ty_¡¾i¡_´•’d
 (
LibH®CÚ‹xt
 *
ùx
,

2100 cÚ¡ *
udi
,

2101 cÚ¡ *
key
,

2102 cÚ¡ *
v®ue
,

2103 
DBusE¼Ü
 *
”rÜ
)

2105 
DBusMes§ge
 *
mes§ge
;

2106 
DBusMes§ge
 *
»¶y
;

2107 
DBusMes§geI‹r
 
™”
;

2109 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2110 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

2111 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

2112 
	`LIBHAL_CHECK_PARAM_VALID
(
v®ue
, "*v®ue", 
FALSE
);

2114 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

2117 ià(
mes§ge
 =ğ
NULL
) {

2118 
	`årštf
 (
¡d”r
,

2120 
__FILE__
, 
__LINE__
);

2121  
FALSE
;

2123 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2124 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

2125 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
v®ue
);

2127 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2128 
mes§ge
, -1,

2129 
”rÜ
);

2131 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2133 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2134  
FALSE
;

2136 ià(
»¶y
 =ğ
NULL
) {

2137  
FALSE
;

2140 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2141  
TRUE
;

2142 
	}
}

2157 
dbus_boŞ_t


2158 
	$libh®_deviû_´İ”ty_¡¾i¡_»move_šdex
 (
LibH®CÚ‹xt
 *
ùx
,

2159 cÚ¡ *
udi
,

2160 cÚ¡ *
key
,

2161 
idx
,

2162 
DBusE¼Ü
 *
”rÜ
)

2164 
DBusMes§ge
 *
mes§ge
;

2165 
DBusMes§ge
 *
»¶y
;

2166 
DBusMes§geI‹r
 
™”
;

2168 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2169 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

2170 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

2172 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

2175 ià(
mes§ge
 =ğ
NULL
) {

2176 
	`årštf
 (
¡d”r
,

2178 
__FILE__
, 
__LINE__
);

2179  
FALSE
;

2181 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2182 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

2183 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_UINT32
, &
idx
);

2185 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2186 
mes§ge
, -1,

2187 
”rÜ
);

2189 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2191 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2192  
FALSE
;

2194 ià(
»¶y
 =ğ
NULL
) {

2195  
FALSE
;

2198 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2199  
TRUE
;

2200 
	}
}

2215 
dbus_boŞ_t


2216 
	$libh®_deviû_´İ”ty_¡¾i¡_»move
 (
LibH®CÚ‹xt
 *
ùx
,

2217 cÚ¡ *
udi
,

2218 cÚ¡ *
key
,

2219 cÚ¡ *
v®ue
, 
DBusE¼Ü
 *
”rÜ
)

2221 
DBusMes§ge
 *
mes§ge
;

2222 
DBusMes§ge
 *
»¶y
;

2223 
DBusMes§geI‹r
 
™”
;

2225 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2226 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

2227 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

2228 
	`LIBHAL_CHECK_PARAM_VALID
(
v®ue
, "*v®ue", 
FALSE
);

2230 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

2233 ià(
mes§ge
 =ğ
NULL
) {

2234 
	`årštf
 (
¡d”r
,

2236 
__FILE__
, 
__LINE__
);

2237  
FALSE
;

2239 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2240 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

2241 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
v®ue
);

2243 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2244 
mes§ge
, -1,

2245 
”rÜ
);

2247 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2249 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2250  
FALSE
;

2252 ià(
»¶y
 =ğ
NULL
) {

2253  
FALSE
;

2256 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2257  
TRUE
;

2258 
	}
}

2273 
dbus_boŞ_t


2274 
	$libh®_deviû_lock
 (
LibH®CÚ‹xt
 *
ùx
,

2275 cÚ¡ *
udi
,

2276 cÚ¡ *
»asÚ_to_lock
,

2277 **
»asÚ_why_locked
, 
DBusE¼Ü
 *
”rÜ
)

2279 
DBusMes§ge
 *
mes§ge
;

2280 
DBusMes§geI‹r
 
™”
;

2281 
DBusMes§ge
 *
»¶y
;

2283 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2284 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

2286 ià(
»asÚ_why_locked
 !ğ
NULL
)

2287 *
»asÚ_why_locked
 = 
NULL
;

2289 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

2290 
udi
,

2294 ià(
mes§ge
 =ğ
NULL
) {

2295 
	`årštf
 (
¡d”r
,

2297 
__FILE__
, 
__LINE__
);

2298  
FALSE
;

2301 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2302 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
»asÚ_to_lock
);

2305 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2306 
mes§ge
, -1,

2307 
”rÜ
);

2309 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2311 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2312 ià(
	`¡rcmp
 (
”rÜ
->
Çme
,

2314 ià(
»asÚ_why_locked
 !ğ
NULL
) {

2315 *
»asÚ_why_locked
 =

2316 
	`dbus_m®loc0
 (
	`¡¾’
 (
”rÜ
->
mes§ge
) + 1);

2317 ià(*
»asÚ_why_locked
 =ğ
NULL
)

2318  
FALSE
;

2319 
	`¡rıy
 (*
»asÚ_why_locked
, 
”rÜ
->
mes§ge
);

2323  
FALSE
;

2325 ià(
»¶y
 =ğ
NULL
)

2326  
FALSE
;

2328 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2330  
TRUE
;

2331 
	}
}

2344 
dbus_boŞ_t


2345 
	$libh®_deviû_uÆock
 (
LibH®CÚ‹xt
 *
ùx
,

2346 cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
)

2348 
DBusMes§ge
 *
mes§ge
;

2349 
DBusMes§ge
 *
»¶y
;

2351 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2352 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

2354 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

2355 
udi
,

2359 ià(
mes§ge
 =ğ
NULL
) {

2360 
	`årštf
 (
¡d”r
,

2362 
__FILE__
, 
__LINE__
);

2363  
FALSE
;

2367 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2368 
mes§ge
, -1,

2369 
”rÜ
);

2371 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2373 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2374  
FALSE
;

2376 ià(
»¶y
 =ğ
NULL
)

2377  
FALSE
;

2379 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2381  
TRUE
;

2382 
	}
}

2399 
	$libh®_Ãw_deviû
 (
LibH®CÚ‹xt
 *
ùx
, 
DBusE¼Ü
 *
”rÜ
)

2401 
DBusMes§ge
 *
mes§ge
;

2402 
DBusMes§ge
 *
»¶y
;

2403 
DBusMes§geI‹r
 
»¶y_™”
;

2404 *
v®ue
;

2405 *
dbus_¡r
;

2407 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
NULL
);

2409 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

2413 ià(
mes§ge
 =ğ
NULL
) {

2414 
	`årštf
 (
¡d”r
,

2416 
__FILE__
, 
__LINE__
);

2417  
NULL
;

2421 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2422 
mes§ge
, -1,

2423 
”rÜ
);

2425 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2427 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2428  
NULL
;

2430 ià(
»¶y
 =ğ
NULL
) {

2431  
NULL
;

2434 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

2437 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_STRING
) {

2438 
	`årštf
 (
¡d”r
,

2440 
__FILE__
, 
__LINE__
);

2441 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2442  
NULL
;

2445 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
dbus_¡r
);

2446 
v®ue
 = (*è((
dbus_¡r
 !ğ
NULL
è? 
	`¡rdup
 (dbus_str) : NULL);

2447 ià(
v®ue
 =ğ
NULL
) {

2448 
	`årštf
 (
¡d”r
, "%s %d :ƒrror‡llocating memory\n",

2449 
__FILE__
, 
__LINE__
);

2452 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2453  
v®ue
;

2454 
	}
}

2477 
dbus_boŞ_t


2478 
	$libh®_deviû_comm™_to_gdl
 (
LibH®CÚ‹xt
 *
ùx
,

2479 cÚ¡ *
‹mp_udi
, cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
)

2481 
DBusMes§ge
 *
mes§ge
;

2482 
DBusMes§ge
 *
»¶y
;

2483 
DBusMes§geI‹r
 
™”
;

2485 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2486 
	`LIBHAL_CHECK_UDI_VALID
(
‹mp_udi
, 
FALSE
);

2487 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

2489 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

2493 ià(
mes§ge
 =ğ
NULL
) {

2494 
	`årštf
 (
¡d”r
,

2496 
__FILE__
, 
__LINE__
);

2497  
FALSE
;

2500 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2501 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
‹mp_udi
);

2502 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
udi
);

2505 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2506 
mes§ge
, -1,

2507 
”rÜ
);

2509 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2511 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2512  
FALSE
;

2514 ià(
»¶y
 =ğ
NULL
) {

2515  
FALSE
;

2518 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2519  
TRUE
;

2520 
	}
}

2537 
dbus_boŞ_t


2538 
	$libh®_»move_deviû
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
)

2540 
DBusMes§ge
 *
mes§ge
;

2541 
DBusMes§ge
 *
»¶y
;

2542 
DBusMes§geI‹r
 
™”
;

2544 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2545 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

2547 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

2551 ià(
mes§ge
 =ğ
NULL
) {

2552 
	`årštf
 (
¡d”r
,

2554 
__FILE__
, 
__LINE__
);

2555  
FALSE
;

2558 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2559 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
udi
);

2562 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2563 
mes§ge
, -1,

2564 
”rÜ
);

2566 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2568 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2569  
FALSE
;

2571 ià(
»¶y
 =ğ
NULL
) {

2572  
FALSE
;

2575 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2576  
TRUE
;

2577 
	}
}

2589 
dbus_boŞ_t


2590 
	$libh®_deviû_exi¡s
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
)

2592 
DBusMes§ge
 *
mes§ge
;

2593 
DBusMes§ge
 *
»¶y
;

2594 
DBusMes§geI‹r
 
™”
, 
»¶y_™”
;

2595 
dbus_boŞ_t
 
v®ue
;

2596 
DBusE¼Ü
 
_”rÜ
;

2598 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2599 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

2601 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

2605 ià(
mes§ge
 =ğ
NULL
) {

2606 
	`årštf
 (
¡d”r
,

2608 
__FILE__
, 
__LINE__
);

2609  
FALSE
;

2612 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2613 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
udi
);

2615 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

2616 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2617 
mes§ge
, -1,

2618 &
_”rÜ
);

2620 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2622 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

2623 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2624  
FALSE
;

2626 ià(
»¶y
 =ğ
NULL
) {

2627  
FALSE
;

2630 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

2633 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_BOOLEAN
) {

2634 
	`årštf
 (
¡d”r
,

2636 
__FILE__
, 
__LINE__
);

2637 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2638  
FALSE
;

2641 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
v®ue
);

2643 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2644  
v®ue
;

2645 
	}
}

2658 
dbus_boŞ_t


2659 
	$libh®_deviû_´İ”ty_exi¡s
 (
LibH®CÚ‹xt
 *
ùx
,

2660 cÚ¡ *
udi
, cÚ¡ *
key
, 
DBusE¼Ü
 *
”rÜ
)

2662 
DBusMes§ge
 *
mes§ge
;

2663 
DBusMes§ge
 *
»¶y
;

2664 
DBusMes§geI‹r
 
™”
, 
»¶y_™”
;

2665 
dbus_boŞ_t
 
v®ue
;

2666 
DBusE¼Ü
 
_”rÜ
;

2668 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2669 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

2670 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

2672 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

2675 ià(
mes§ge
 =ğ
NULL
) {

2676 
	`årštf
 (
¡d”r
,

2678 
__FILE__
, 
__LINE__
);

2679  
FALSE
;

2682 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2683 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

2685 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

2686 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2687 
mes§ge
, -1,

2688 &
_”rÜ
);

2690 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2692 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

2693 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2694  
FALSE
;

2696 ià(
»¶y
 =ğ
NULL
) {

2697  
FALSE
;

2700 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

2703 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_BOOLEAN
) {

2704 
	`årštf
 (
¡d”r
, "%s %d :ƒxpected‡ bool in„eplyo "

2705 "Prİ”tyExi¡s\n", 
__FILE__
, 
__LINE__
);

2706 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2707  
FALSE
;

2710 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
v®ue
);

2712 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2713  
v®ue
;

2714 
	}
}

2727 
dbus_boŞ_t


2728 
	$libh®_m”ge_´İ”t›s
 (
LibH®CÚ‹xt
 *
ùx
,

2729 cÚ¡ *
rg‘_udi
, cÚ¡ *
sourû_udi
, 
DBusE¼Ü
 *
”rÜ
)

2731 
DBusMes§ge
 *
mes§ge
;

2732 
DBusMes§ge
 *
»¶y
;

2733 
DBusMes§geI‹r
 
™”
;

2735 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2736 
	`LIBHAL_CHECK_UDI_VALID
(
rg‘_udi
, 
FALSE
);

2737 
	`LIBHAL_CHECK_UDI_VALID
(
sourû_udi
, 
FALSE
);

2739 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

2743 ià(
mes§ge
 =ğ
NULL
) {

2744 
	`årštf
 (
¡d”r
,

2746 
__FILE__
, 
__LINE__
);

2747  
FALSE
;

2750 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2751 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
rg‘_udi
);

2752 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
sourû_udi
);

2755 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2756 
mes§ge
, -1,

2757 
”rÜ
);

2759 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2761 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2762  
FALSE
;

2764 ià(
»¶y
 =ğ
NULL
) {

2765  
FALSE
;

2768 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2769  
TRUE
;

2770 
	}
}

2793 
dbus_boŞ_t


2794 
	$libh®_deviû_m©ches
 (
LibH®CÚ‹xt
 *
ùx
,

2795 cÚ¡ *
udi1
, cÚ¡ *
udi2
,

2796 cÚ¡ *
´İ”ty_Çme¥aû
, 
DBusE¼Ü
 *
”rÜ
)

2798 
DBusMes§ge
 *
mes§ge
;

2799 
DBusMes§ge
 *
»¶y
;

2800 
DBusMes§geI‹r
 
™”
, 
»¶y_™”
;

2801 
dbus_boŞ_t
 
v®ue
;

2802 
DBusE¼Ü
 
_”rÜ
;

2804 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2805 
	`LIBHAL_CHECK_UDI_VALID
(
udi1
, 
FALSE
);

2806 
	`LIBHAL_CHECK_UDI_VALID
(
udi2
, 
FALSE
);

2807 
	`LIBHAL_CHECK_PARAM_VALID
(
´İ”ty_Çme¥aû
, "*´İ”ty_Çme¥aû", 
FALSE
);

2809 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

2813 ià(
mes§ge
 =ğ
NULL
) {

2814 
	`årštf
 (
¡d”r
,

2816 
__FILE__
, 
__LINE__
);

2817  
FALSE
;

2820 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2821 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, 
udi1
);

2822 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, 
udi2
);

2823 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, 
´İ”ty_Çme¥aû
);

2825 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

2826 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2827 
mes§ge
, -1,

2828 &
_”rÜ
);

2830 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2832 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

2833 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2834  
FALSE
;

2836 ià(
»¶y
 =ğ
NULL
) {

2837  
FALSE
;

2840 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

2842 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_BOOLEAN
) {

2843 
	`årštf
 (
¡d”r
,

2845 
__FILE__
, 
__LINE__
);

2846 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2847  
FALSE
;

2850 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
v®ue
);

2852 
	`dbus_mes§ge_uÄef
 (
»¶y
);

2853  
v®ue
;

2854 
	}
}

2866 
dbus_boŞ_t


2867 
	$libh®_deviû_´št
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
)

2869 
ty³
;

2870 *
key
;

2871 
LibH®Prİ”tyS‘
 *
p£t
;

2872 
LibH®Prİ”tyS‘I‹¿tÜ
 
i
;

2874 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

2875 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

2877 
	`´štf
 ("deviû_id = %s\n", 
udi
);

2879 ià((
p£t
 = 
	`libh®_deviû_g‘_®l_´İ”t›s
 (
ùx
, 
udi
, 
”rÜ
)è=ğ
NULL
)

2880  
FALSE
;

2882 
	`libh®_psi_š™
 (&
i
, 
p£t
); 
	`libh®_psi_has_mÜe
 (&i);

2883 
	`libh®_psi_Ãxt
 (&
i
)) {

2884 
ty³
 = 
	`libh®_psi_g‘_ty³
 (&
i
);

2885 
key
 = 
	`libh®_psi_g‘_key
 (&
i
);

2887 
ty³
) {

2888 
LIBHAL_PROPERTY_TYPE_STRING
:

2889 
	`´štf
 (" % ğ'%s' (¡ršg)\n", 
key
,

2890 
	`libh®_psi_g‘_¡ršg
 (&
i
));

2892 
LIBHAL_PROPERTY_TYPE_INT32
:

2893 
	`´štf
 (" % ğ%d = 0x%x (št)\n", 
key
,

2894 
	`libh®_psi_g‘_št
 (&
i
),

2895 
	`libh®_psi_g‘_št
 (&
i
));

2897 
LIBHAL_PROPERTY_TYPE_UINT64
:

2898 
	`´štf
 (" % ğ%Îu = 0x%Îx (ušt64)\n", 
key
,

2899 (è
	`libh®_psi_g‘_ušt64
 (&
i
),

2900 (è
	`libh®_psi_g‘_ušt64
 (&
i
));

2902 
LIBHAL_PROPERTY_TYPE_BOOLEAN
:

2903 
	`´štf
 (" % ğ% (boŞ)\n", 
key
,

2904 (
	`libh®_psi_g‘_boŞ
 (&
i
) ? "true" :

2907 
LIBHAL_PROPERTY_TYPE_DOUBLE
:

2908 
	`´štf
 (" % ğ%g (doubË)\n", 
key
,

2909 
	`libh®_psi_g‘_doubË
 (&
i
));

2911 
LIBHAL_PROPERTY_TYPE_STRLIST
:

2913 
j
;

2914 **
¡r_li¡
;

2916 
¡r_li¡
 = 
	`libh®_psi_g‘_¡¾i¡
 (&
i
);

2917 
	`´štf
 (" % ğ[", 
key
);

2918 
j
 = 0; 
¡r_li¡
[j] !ğ
NULL
; j++) {

2919 
	`´štf
 ("'%s'", 
¡r_li¡
[
j
]);

2920 ià(
¡r_li¡
[
j
+1] !ğ
NULL
)

2921 
	`´štf
 (", ");

2923 
	`´štf
 ("] (string†ist)\n");

2928 
	`´štf
 (" *** unknowÀty³ fÜ key %s\n", 
key
);

2933 
	`libh®_ä“_´İ”ty_£t
 (
p£t
);

2935  
TRUE
;

2936 
	}
}

2952 
	$libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
LibH®CÚ‹xt
 *
ùx
,

2953 cÚ¡ *
key
,

2954 cÚ¡ *
v®ue
, *
num_deviûs
, 
DBusE¼Ü
 *
”rÜ
)

2956 
DBusMes§ge
 *
mes§ge
;

2957 
DBusMes§ge
 *
»¶y
;

2958 
DBusMes§geI‹r
 
™”
, 
™”_¬¿y
, 
»¶y_™”
;

2959 **
h®_deviû_Çmes
;

2960 
DBusE¼Ü
 
_”rÜ
;

2962 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
NULL
);

2963 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
NULL
);

2964 
	`LIBHAL_CHECK_PARAM_VALID
(
v®ue
, "*v®ue", 
NULL
);

2966 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

2970 ià(
mes§ge
 =ğ
NULL
) {

2971 
	`årštf
 (
¡d”r
,

2973 
__FILE__
, 
__LINE__
);

2974  
NULL
;

2977 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

2978 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
key
);

2979 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
v®ue
);

2981 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

2982 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

2983 
mes§ge
, -1,

2984 &
_”rÜ
);

2986 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

2988 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

2989 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

2990  
NULL
;

2992 ià(
»¶y
 =ğ
NULL
) {

2993  
NULL
;

2996 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

2998 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_ARRAY
) {

2999 
	`årštf
 (
¡d”r
, "% %d : wrÚg„•ly from h®d. Ex³ùšg‡À¬¿y.\n", 
__FILE__
, 
__LINE__
);

3000  
NULL
;

3003 
	`dbus_mes§ge_™”_»cur£
 (&
»¶y_™”
, &
™”_¬¿y
);

3005 
h®_deviû_Çmes
 = 
	`libh®_g‘_¡ršg_¬¿y_äom_™”
 (&
™”_¬¿y
, 
num_deviûs
);

3007 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3008  
h®_deviû_Çmes
;

3009 
	}
}

3023 
dbus_boŞ_t


3024 
	$libh®_deviû_add_ÿ·b™y
 (
LibH®CÚ‹xt
 *
ùx
,

3025 cÚ¡ *
udi
, cÚ¡ *
ÿ·b™y
, 
DBusE¼Ü
 *
”rÜ
)

3027 
DBusMes§ge
 *
mes§ge
;

3028 
DBusMes§ge
 *
»¶y
;

3029 
DBusMes§geI‹r
 
™”
;

3031 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3032 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

3033 
	`LIBHAL_CHECK_PARAM_VALID
(
ÿ·b™y
, "*ÿ·b™y", 
FALSE
);

3035 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

3038 ià(
mes§ge
 =ğ
NULL
) {

3039 
	`årštf
 (
¡d”r
,

3041 
__FILE__
, 
__LINE__
);

3042  
FALSE
;

3045 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

3046 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
ÿ·b™y
);

3049 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

3050 
mes§ge
, -1,

3051 
”rÜ
);

3053 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

3055 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3056  
FALSE
;

3058 ià(
»¶y
 =ğ
NULL
) {

3059  
FALSE
;

3062 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3063  
TRUE
;

3064 
	}
}

3078 
dbus_boŞ_t


3079 
	$libh®_deviû_qu”y_ÿ·b™y
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, cÚ¡ *
ÿ·b™y
, 
DBusE¼Ü
 *
”rÜ
)

3081 **
ÿps
;

3082 
i
;

3083 
dbus_boŞ_t
 
»t
;

3085 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3086 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

3087 
	`LIBHAL_CHECK_PARAM_VALID
(
ÿ·b™y
, "*ÿ·b™y", 
FALSE
);

3089 
»t
 = 
FALSE
;

3091 
ÿps
 = 
	`libh®_deviû_g‘_´İ”ty_¡¾i¡
 (
ùx
, 
udi
, "šfo.ÿ·b™›s", 
”rÜ
);

3092 ià(
ÿps
 !ğ
NULL
) {

3093 
i
 = 0; 
ÿps
[i] !ğ
NULL
; i++) {

3094 ià(
	`¡rcmp
 (
ÿps
[
i
], 
ÿ·b™y
) == 0) {

3095 
»t
 = 
TRUE
;

3099 
	`libh®_ä“_¡ršg_¬¿y
 (
ÿps
);

3102  
»t
;

3103 
	}
}

3117 
	$libh®_fšd_deviû_by_ÿ·b™y
 (
LibH®CÚ‹xt
 *
ùx
,

3118 cÚ¡ *
ÿ·b™y
, *
num_deviûs
, 
DBusE¼Ü
 *
”rÜ
)

3120 
DBusMes§ge
 *
mes§ge
;

3121 
DBusMes§ge
 *
»¶y
;

3122 
DBusMes§geI‹r
 
™”
, 
™”_¬¿y
, 
»¶y_™”
;

3123 **
h®_deviû_Çmes
;

3124 
DBusE¼Ü
 
_”rÜ
;

3126 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
NULL
);

3127 
	`LIBHAL_CHECK_PARAM_VALID
(
ÿ·b™y
, "*ÿ·b™y", 
NULL
);

3129 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

3133 ià(
mes§ge
 =ğ
NULL
) {

3134 
	`årštf
 (
¡d”r
,

3136 
__FILE__
, 
__LINE__
);

3137  
NULL
;

3140 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

3141 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
ÿ·b™y
);

3143 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

3144 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

3145 
mes§ge
, -1,

3146 &
_”rÜ
);

3148 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

3150 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

3151 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3152  
NULL
;

3154 ià(
»¶y
 =ğ
NULL
) {

3155  
NULL
;

3158 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

3160 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_ARRAY
) {

3161 
	`årštf
 (
¡d”r
, "% %d : wrÚg„•ly from h®d. Ex³ùšg‡À¬¿y.\n", 
__FILE__
, 
__LINE__
);

3162  
NULL
;

3165 
	`dbus_mes§ge_™”_»cur£
 (&
»¶y_™”
, &
™”_¬¿y
);

3167 
h®_deviû_Çmes
 = 
	`libh®_g‘_¡ršg_¬¿y_äom_™”
 (&
™”_¬¿y
, 
num_deviûs
);

3169 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3170  
h®_deviû_Çmes
;

3171 
	}
}

3183 
dbus_boŞ_t


3184 
	$libh®_deviû_´İ”ty_w©ch_®l
 (
LibH®CÚ‹xt
 *
ùx
, 
DBusE¼Ü
 *
”rÜ
)

3186 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3188 
	`dbus_bus_add_m©ch
 (
ùx
->
cÚÃùiÚ
,

3191 "£nd”='Üg.ä“desktİ.H®'", 
”rÜ
);

3192 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3193  
FALSE
;

3195  
TRUE
;

3196 
	}
}

3213 
dbus_boŞ_t


3214 
	$libh®_deviû_add_´İ”ty_w©ch
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
)

3216 
buf
[512];

3218 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3219 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

3221 
	`¢´štf
 (
buf
, 512,

3224 "£nd”='Üg.ä“desktİ.H®'," "·th=%s", 
udi
);

3226 
	`dbus_bus_add_m©ch
 (
ùx
->
cÚÃùiÚ
, 
buf
, 
”rÜ
);

3227 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3228  
FALSE
;

3230  
TRUE
;

3231 
	}
}

3244 
dbus_boŞ_t


3245 
	$libh®_deviû_»move_´İ”ty_w©ch
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
)

3247 
buf
[512];

3249 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3250 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

3252 
	`¢´štf
 (
buf
, 512,

3255 "£nd”='Üg.ä“desktİ.H®'," "·th=%s", 
udi
);

3257 
	`dbus_bus_»move_m©ch
 (
ùx
->
cÚÃùiÚ
, 
buf
, 
”rÜ
);

3258 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3259  
FALSE
;

3261  
TRUE
;

3262 
	}
}

3272 
LibH®CÚ‹xt
 *

3273 
	$libh®_ùx_Ãw
 ()

3275 
LibH®CÚ‹xt
 *
ùx
;

3277 
ùx
 = 
	`ÿÎoc
 (1,  (
LibH®CÚ‹xt
));

3278 ià(
ùx
 =ğ
NULL
) {

3279 
	`årštf
 (
¡d”r
,

3281 
__FILE__
, 
__LINE__
, (è (
LibH®CÚ‹xt
));

3282  
NULL
;

3285 
ùx
->
is_š™Ÿlized
 = 
FALSE
;

3286 
ùx
->
is_shutdown
 = 
FALSE
;

3287 
ùx
->
cÚÃùiÚ
 = 
NULL
;

3288 
ùx
->
is_dœeù
 = 
FALSE
;

3290  
ùx
;

3291 
	}
}

3303 
dbus_boŞ_t


3304 
	$libh®_ùx_£t_ÿche
 (
LibH®CÚ‹xt
 *
ùx
, 
dbus_boŞ_t
 
u£_ÿche
)

3306 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3308 
ùx
->
ÿche_’abËd
 = 
u£_ÿche
;

3309  
TRUE
;

3310 
	}
}

3321 
dbus_boŞ_t


3322 
	$libh®_ùx_£t_dbus_cÚÃùiÚ
 (
LibH®CÚ‹xt
 *
ùx
, 
DBusCÚÃùiÚ
 *
cÚn
)

3324 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3326 ià(
cÚn
 =ğ
NULL
)

3327  
FALSE
;

3329 
ùx
->
cÚÃùiÚ
 = 
cÚn
;

3330  
TRUE
;

3331 
	}
}

3341 
DBusCÚÃùiÚ
 *

3342 
	$libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
LibH®CÚ‹xt
 *
ùx
)

3344 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
NULL
);

3346  
ùx
->
cÚÃùiÚ
;

3347 
	}
}

3359 
dbus_boŞ_t


3360 
	$libh®_ùx_š™
 (
LibH®CÚ‹xt
 *
ùx
, 
DBusE¼Ü
 *
”rÜ
)

3362 
DBusE¼Ü
 
_”rÜ
;

3363 
dbus_boŞ_t
 
h®d_exi¡s
;

3365 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3367 ià(
ùx
->
cÚÃùiÚ
 =ğ
NULL
)

3368  
FALSE
;

3370 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

3371 
h®d_exi¡s
 = 
	`dbus_bus_Çme_has_owÃr
 (
ùx
->
cÚÃùiÚ
, "Üg.ä“desktİ.H®", &
_”rÜ
);

3372 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

3373 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3374  
FALSE
;

3377 ià(!
h®d_exi¡s
) {

3378  
FALSE
;

3382 ià(!
	`dbus_cÚÃùiÚ_add_f‹r
 (
ùx
->
cÚÃùiÚ
, 
f‹r_func
, ctx, 
NULL
)) {

3383  
FALSE
;

3386 
	`dbus_bus_add_m©ch
 (
ùx
->
cÚÃùiÚ
,

3390 "·th='/Üg/ä“desktİ/H®/Mªag”'", &
_”rÜ
);

3391 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

3392 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3393  
FALSE
;

3395 
ùx
->
is_š™Ÿlized
 = 
TRUE
;

3396 
ùx
->
is_dœeù
 = 
FALSE
;

3398  
TRUE
;

3399 
	}
}

3409 
LibH®CÚ‹xt
 *

3410 
	$libh®_ùx_š™_dœeù
 (
DBusE¼Ü
 *
”rÜ
)

3412 *
h®d_addr
;

3413 
LibH®CÚ‹xt
 *
ùx
;

3414 
DBusE¼Ü
 
_”rÜ
;

3416 
ùx
 = 
	`libh®_ùx_Ãw
 ();

3417 ià(
ùx
 =ğ
NULL
)

3418 
out
;

3420 ià(((
h®d_addr
 = 
	`g‘’v
 ("HALD_DIRECT_ADDR"))è=ğ
NULL
) {

3421 
	`libh®_ùx_ä“
 (
ùx
);

3422 
ùx
 = 
NULL
;

3423 
out
;

3426 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

3427 
ùx
->
cÚÃùiÚ
 = 
	`dbus_cÚÃùiÚ_İ’
 (
h®d_addr
, &
_”rÜ
);

3428 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

3429 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3430 
	`libh®_ùx_ä“
 (
ùx
);

3431 
ùx
 = 
NULL
;

3432 
out
;

3435 ià(!
	`dbus_cÚÃùiÚ_add_f‹r
 (
ùx
->
cÚÃùiÚ
, 
f‹r_func
, ctx, 
NULL
)) {

3436 
	`libh®_ùx_ä“
 (
ùx
);

3437 
ùx
 = 
NULL
;

3438 
out
;

3442 
ùx
->
is_š™Ÿlized
 = 
TRUE
;

3443 
ùx
->
is_dœeù
 = 
TRUE
;

3445 
out
:

3446  
ùx
;

3447 
	}
}

3458 
dbus_boŞ_t


3459 
	$libh®_ùx_shutdown
 (
LibH®CÚ‹xt
 *
ùx
, 
DBusE¼Ü
 *
”rÜ
)

3461 
DBusE¼Ü
 
my”rÜ
;

3463 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3465 ià(
ùx
->
is_dœeù
) {

3469 
	`dbus_”rÜ_š™
 (&
my”rÜ
);

3470 
	`dbus_bus_»move_m©ch
 (
ùx
->
cÚÃùiÚ
,

3474 "·th='/Üg/ä“desktİ/H®/Mªag”'", &
my”rÜ
);

3475 
	`dbus_move_”rÜ
 (&
my”rÜ
, 
”rÜ
);

3476 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3477 
	`årštf
 (
¡d”r
, "%s %d : Error unsubscribingo signals,ƒrror=%s\n",

3478 
__FILE__
, 
__LINE__
, 
”rÜ
->
mes§ge
);

3484 
	`dbus_cÚÃùiÚ_»move_f‹r
 (
ùx
->
cÚÃùiÚ
, 
f‹r_func
, ctx);

3487 
ùx
->
is_š™Ÿlized
 = 
FALSE
;

3489  
TRUE
;

3490 
	}
}

3500 
dbus_boŞ_t


3501 
	$libh®_ùx_ä“
 (
LibH®CÚ‹xt
 *
ùx
)

3503 
	`ä“
 (
ùx
);

3504  
TRUE
;

3505 
	}
}

3516 
dbus_boŞ_t


3517 
	$libh®_ùx_£t_deviû_added
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®DeviûAdded
 
ÿÎback
)

3519 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3521 
ùx
->
deviû_added
 = 
ÿÎback
;

3522  
TRUE
;

3523 
	}
}

3534 
dbus_boŞ_t


3535 
	$libh®_ùx_£t_deviû_»moved
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®DeviûRemoved
 
ÿÎback
)

3537 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3539 
ùx
->
deviû_»moved
 = 
ÿÎback
;

3540  
TRUE
;

3541 
	}
}

3552 
dbus_boŞ_t


3553 
	$libh®_ùx_£t_deviû_Ãw_ÿ·b™y
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®DeviûNewC­ab™y
 
ÿÎback
)

3555 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3557 
ùx
->
deviû_Ãw_ÿ·b™y
 = 
ÿÎback
;

3558  
TRUE
;

3559 
	}
}

3570 
dbus_boŞ_t


3571 
	$libh®_ùx_£t_deviû_lo¡_ÿ·b™y
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®DeviûLo¡C­ab™y
 
ÿÎback
)

3573 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3575 
ùx
->
deviû_lo¡_ÿ·b™y
 = 
ÿÎback
;

3576  
TRUE
;

3577 
	}
}

3588 
dbus_boŞ_t


3589 
	$libh®_ùx_£t_deviû_´İ”ty_modif›d
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®DeviûPrİ”tyModif›d
 
ÿÎback
)

3591 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3593 
ùx
->
deviû_´İ”ty_modif›d
 = 
ÿÎback
;

3594  
TRUE
;

3595 
	}
}

3606 
dbus_boŞ_t


3607 
	$libh®_ùx_£t_deviû_cÚd™iÚ
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®DeviûCÚd™iÚ
 
ÿÎback
)

3609 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3611 
ùx
->
deviû_cÚd™iÚ
 = 
ÿÎback
;

3612  
TRUE
;

3613 
	}
}

3624 
dbus_boŞ_t


3625 
	$libh®_ùx_£t_sšgËtÚ_deviû_added
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®SšgËtÚDeviûAdded
 
ÿÎback
)

3627 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3629 
ùx
->
sšgËtÚ_deviû_added
 = 
ÿÎback
;

3630  
TRUE
;

3631 
	}
}

3642 
dbus_boŞ_t


3643 
	$libh®_ùx_£t_sšgËtÚ_deviû_»moved
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®SšgËtÚDeviûRemoved
 
ÿÎback
)

3645 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3647 
ùx
->
sšgËtÚ_deviû_»moved
 = 
ÿÎback
;

3648  
TRUE
;

3649 
	}
}

3660 
	$libh®_¡ršg_¬¿y_Ëngth
 (**
¡r_¬¿y
)

3662 
i
;

3664 ià(
¡r_¬¿y
 =ğ
NULL
)

3667 
i
 = 0; 
¡r_¬¿y
[i] !ğ
NULL
; i++)

3670  
i
;

3671 
	}
}

3684 
dbus_boŞ_t


3685 
	$libh®_deviû_»sÿn
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
)

3687 
DBusMes§ge
 *
mes§ge
;

3688 
DBusMes§geI‹r
 
»¶y_™”
;

3689 
DBusMes§ge
 *
»¶y
;

3690 
dbus_boŞ_t
 
»suÉ
;

3692 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3693 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

3695 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
udi
,

3699 ià(
mes§ge
 =ğ
NULL
) {

3700 
	`årštf
 (
¡d”r
,

3702 
__FILE__
, 
__LINE__
);

3703  
FALSE
;

3706 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

3707 
mes§ge
, -1,

3708 
”rÜ
);

3710 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

3712 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3713  
FALSE
;

3715 ià(
»¶y
 =ğ
NULL
)

3716  
FALSE
;

3718 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

3719 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
) !=

3720 
DBUS_TYPE_BOOLEAN
) {

3721 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3722  
FALSE
;

3724 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
»suÉ
);

3726 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3728  
»suÉ
;

3729 
	}
}

3741 
dbus_boŞ_t


3742 
	$libh®_deviû_»´obe
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
)

3744 
DBusMes§ge
 *
mes§ge
;

3745 
DBusMes§geI‹r
 
»¶y_™”
;

3746 
DBusMes§ge
 *
»¶y
;

3747 
dbus_boŞ_t
 
»suÉ
;

3749 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3750 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

3752 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

3753 
udi
,

3757 ià(
mes§ge
 =ğ
NULL
) {

3758 
	`årštf
 (
¡d”r
,

3760 
__FILE__
, 
__LINE__
);

3761  
FALSE
;

3764 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

3765 
mes§ge
, -1,

3766 
”rÜ
);

3768 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

3770 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3771  
FALSE
;

3773 ià(
»¶y
 =ğ
NULL
)

3774  
FALSE
;

3776 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

3777 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
) !=

3778 
DBUS_TYPE_BOOLEAN
) {

3779 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3780  
FALSE
;

3782 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
»suÉ
);

3784 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3786  
»suÉ
;

3787 
	}
}

3802 
dbus_boŞ_t
 
	$libh®_deviû_em™_cÚd™iÚ
 (
LibH®CÚ‹xt
 *
ùx
,

3803 cÚ¡ *
udi
,

3804 cÚ¡ *
cÚd™iÚ_Çme
,

3805 cÚ¡ *
cÚd™iÚ_d‘as
,

3806 
DBusE¼Ü
 *
”rÜ
)

3808 
DBusMes§ge
 *
mes§ge
;

3809 
DBusMes§geI‹r
 
™”
;

3810 
DBusMes§geI‹r
 
»¶y_™”
;

3811 
DBusMes§ge
 *
»¶y
;

3812 
dbus_boŞ_t
 
»suÉ
;

3814 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3815 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

3816 
	`LIBHAL_CHECK_PARAM_VALID
(
cÚd™iÚ_Çme
, "*cÚd™iÚ_Çme", 
FALSE
);

3817 
	`LIBHAL_CHECK_PARAM_VALID
(
cÚd™iÚ_d‘as
, "*cÚd™iÚ_d‘as", 
FALSE
);

3819 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

3820 
udi
,

3824 ià(
mes§ge
 =ğ
NULL
) {

3825 
	`årštf
 (
¡d”r
,

3827 
__FILE__
, 
__LINE__
);

3828  
FALSE
;

3831 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

3832 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
cÚd™iÚ_Çme
);

3833 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
cÚd™iÚ_d‘as
);

3835 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

3836 
mes§ge
, -1,

3837 
”rÜ
);

3839 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

3841 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3842 
	`årštf
 (
¡d”r
,

3844 
__FILE__
, 
__LINE__
, 
”rÜ
->
Çme
,ƒ¼Ü->
mes§ge
);

3845  
FALSE
;

3848 ià(
»¶y
 =ğ
NULL
) {

3849 
	`årštf
 (
¡d”r
,

3851 
__FILE__
, 
__LINE__
);

3852  
FALSE
;

3855 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

3856 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
) !=

3857 
DBUS_TYPE_BOOLEAN
) {

3858 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3859 
	`årštf
 (
¡d”r
,

3861 
__FILE__
, 
__LINE__
);

3862  
FALSE
;

3864 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
»suÉ
);

3866 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3868  
»suÉ
;

3869 
	}
}

3871 
dbus_boŞ_t


3872 
	$addÚ_is_»ady
(
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
id’tif›r
,

3873 
dbus_boŞ_t
 
sšgËtÚ
, 
DBusE¼Ü
 *
”rÜ
)

3875 
DBusMes§ge
 *
mes§ge
;

3876 
DBusMes§geI‹r
 
™”
;

3877 
DBusMes§ge
 *
»¶y
;

3879 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3880 
	`LIBHAL_CHECK_PARAM_VALID
(
id’tif›r
, "*id’tif›r", 
FALSE
);

3882 ià(
sšgËtÚ
) {

3883 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

3888 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

3889 
id’tif›r
,

3894 ià(
mes§ge
 =ğ
NULL
) {

3895 
	`årštf
 (
¡d”r
,

3897 
__FILE__
, 
__LINE__
);

3898  
FALSE
;

3901 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

3903 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
id’tif›r
);

3905 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

3906 
mes§ge
, -1,

3907 
”rÜ
);

3909 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

3911 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

3912  
FALSE
;

3914 ià(
»¶y
 =ğ
NULL
)

3915  
FALSE
;

3917 
	`dbus_mes§ge_uÄef
 (
»¶y
);

3918  
TRUE
;

3919 
	}
}

3935 
dbus_boŞ_t


3936 
	$libh®_deviû_addÚ_is_»ady
 (
LibH®CÚ‹xt
 *
ùx
,

3937 cÚ¡ *
udi
,

3938 
DBusE¼Ü
 *
”rÜ
)

3941 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3942 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

3944  
	`addÚ_is_»ady
 (
ùx
, 
udi
, 
FALSE
, 
”rÜ
);

3945 
	}
}

3960 
dbus_boŞ_t


3961 
	$libh®_deviû_sšgËtÚ_addÚ_is_»ady
 (
LibH®CÚ‹xt
 *
ùx
,

3962 cÚ¡ *
commªd_lše
,

3963 
DBusE¼Ü
 *
”rÜ
)

3965 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

3966 
	`LIBHAL_CHECK_PARAM_VALID
(
commªd_lše
, "*commªd_lše", 
FALSE
);

3968  
	`addÚ_is_»ady
 (
ùx
, 
commªd_lše
, 
TRUE
, 
”rÜ
);

3969 
	}
}

3986 
dbus_boŞ_t


3987 
	$libh®_deviû_şaim_š‹rçû
 (
LibH®CÚ‹xt
 *
ùx
,

3988 cÚ¡ *
udi
,

3989 cÚ¡ *
š‹rçû_Çme
,

3990 cÚ¡ *
šŒo¥eùiÚ_xml
,

3991 
DBusE¼Ü
 *
”rÜ
)

3993 
DBusMes§ge
 *
mes§ge
;

3994 
DBusMes§geI‹r
 
™”
;

3995 
DBusMes§geI‹r
 
»¶y_™”
;

3996 
DBusMes§ge
 *
»¶y
;

3997 
dbus_boŞ_t
 
»suÉ
;

3999 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

4000 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

4001 
	`LIBHAL_CHECK_PARAM_VALID
(
š‹rçû_Çme
, "*š‹rçû_Çme", 
FALSE
);

4003 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

4004 
udi
,

4008 ià(
mes§ge
 =ğ
NULL
) {

4009 
	`årštf
 (
¡d”r
,

4011 
__FILE__
, 
__LINE__
);

4012  
FALSE
;

4015 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

4016 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
š‹rçû_Çme
);

4017 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
šŒo¥eùiÚ_xml
);

4019 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

4020 
mes§ge
, -1,

4021 
”rÜ
);

4023 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

4025 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

4026  
FALSE
;

4028 ià(
»¶y
 =ğ
NULL
)

4029  
FALSE
;

4031 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

4032 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
) !=

4033 
DBUS_TYPE_BOOLEAN
) {

4034 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4035  
FALSE
;

4037 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
»suÉ
);

4039 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4041  
»suÉ
;

4042 
	}
}

4046 
	gLibH®ChªgeS‘EËm’t_s
;

4048 
LibH®ChªgeS‘EËm’t_s
 
	tLibH®ChªgeS‘EËm’t
;

4050 
	sLibH®ChªgeS‘EËm’t_s
 {

4051 *
	mkey
;

4052 
	mchªge_ty³
;

4054 *
	mv®_¡r
;

4055 
dbus_št32_t
 
	mv®_št
;

4056 
dbus_ušt64_t
 
	mv®_ušt64
;

4057 
	mv®_doubË
;

4058 
dbus_boŞ_t
 
	mv®_boŞ
;

4059 **
	mv®_¡¾i¡
;

4060 } 
	mv®ue
;

4061 
LibH®ChªgeS‘EËm’t
 *
	mÃxt
;

4062 
LibH®ChªgeS‘EËm’t
 *
	m´ev
;

4065 
	sLibH®ChªgeS‘_s
 {

4066 *
	mudi
;

4067 
LibH®ChªgeS‘EËm’t
 *
	mh—d
;

4068 
LibH®ChªgeS‘EËm’t
 *
	m
;

4080 
LibH®ChªgeS‘
 *

4081 
	$libh®_deviû_Ãw_chªge£t
 (cÚ¡ *
udi
)

4083 
LibH®ChªgeS‘
 *
chªge£t
;

4085 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
NULL
);

4087 
chªge£t
 = 
	`ÿÎoc
 (1,  (
LibH®ChªgeS‘
));

4088 ià(
chªge£t
 =ğ
NULL
)

4089 
out
;

4091 
chªge£t
->
udi
 = 
	`¡rdup
 (udi);

4092 ià(
chªge£t
->
udi
 =ğ
NULL
) {

4093 
	`ä“
 (
chªge£t
);

4094 
chªge£t
 = 
NULL
;

4095 
out
;

4098 
chªge£t
->
h—d
 = 
NULL
;

4099 
chªge£t
->

 = 
NULL
;

4101 
out
:

4102  
chªge£t
;

4103 
	}
}

4106 
	$libh®_chªge£t_­³nd
 (
LibH®ChªgeS‘
 *
chªge£t
, 
LibH®ChªgeS‘EËm’t
 *
–em
)

4108 
	`LIBHAL_CHECK_PARAM_VALID
(
chªge£t
, "*chªge£t", (è
NULL
 );

4109 
	`LIBHAL_CHECK_PARAM_VALID
(
–em
, "*–em", (è
NULL
);

4111 ià(
chªge£t
->
h—d
 =ğ
NULL
) {

4112 
chªge£t
->
h—d
 = 
–em
;

4113 
chªge£t
->

 = 
–em
;

4114 
–em
->
Ãxt
 = 
NULL
;

4115 
–em
->
´ev
 = 
NULL
;

4117 
–em
->
´ev
 = 
chªge£t
->

;

4118 
–em
->
Ãxt
 = 
NULL
;

4119 
–em
->
´ev
->
Ãxt
 =ƒlem;

4120 
chªge£t
->

 = 
–em
;

4122 
	}
}

4135 
dbus_boŞ_t


4136 
	$libh®_chªge£t_£t_´İ”ty_¡ršg
 (
LibH®ChªgeS‘
 *
chªge£t
, cÚ¡ *
key
, cÚ¡ *
v®ue
)

4138 
LibH®ChªgeS‘EËm’t
 *
–em
;

4140 
	`LIBHAL_CHECK_PARAM_VALID
(
chªge£t
, "*chªge£t", 
FALSE
);

4141 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

4142 
	`LIBHAL_CHECK_PARAM_VALID
(
v®ue
, "*v®ue", 
FALSE
);

4144 
–em
 = 
	`ÿÎoc
 (1,  (
LibH®ChªgeS‘EËm’t
));

4145 ià(
–em
 =ğ
NULL
)

4146 
out
;

4147 
–em
->
key
 = 
	`¡rdup
 (key);

4148 ià(
–em
->
key
 =ğ
NULL
) {

4149 
	`ä“
 (
–em
);

4150 
–em
 = 
NULL
;

4151 
out
;

4154 
–em
->
chªge_ty³
 = 
LIBHAL_PROPERTY_TYPE_STRING
;

4155 
–em
->
v®ue
.
v®_¡r
 = 
	`¡rdup
 (value);

4156 ià(
–em
->
v®ue
.
v®_¡r
 =ğ
NULL
) {

4157 
	`ä“
 (
–em
->
key
);

4158 
	`ä“
 (
–em
);

4159 
–em
 = 
NULL
;

4160 
out
;

4163 
	`libh®_chªge£t_­³nd
 (
chªge£t
, 
–em
);

4164 
out
:

4165  
–em
 !ğ
NULL
;

4166 
	}
}

4178 
dbus_boŞ_t


4179 
	$libh®_chªge£t_£t_´İ”ty_št
 (
LibH®ChªgeS‘
 *
chªge£t
, cÚ¡ *
key
, 
dbus_št32_t
 
v®ue
)

4181 
LibH®ChªgeS‘EËm’t
 *
–em
;

4183 
	`LIBHAL_CHECK_PARAM_VALID
(
chªge£t
, "*chªge£t", 
FALSE
);

4184 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

4186 
–em
 = 
	`ÿÎoc
 (1,  (
LibH®ChªgeS‘EËm’t
));

4187 ià(
–em
 =ğ
NULL
)

4188 
out
;

4189 
–em
->
key
 = 
	`¡rdup
 (key);

4190 ià(
–em
->
key
 =ğ
NULL
) {

4191 
	`ä“
 (
–em
);

4192 
–em
 = 
NULL
;

4193 
out
;

4196 
–em
->
chªge_ty³
 = 
LIBHAL_PROPERTY_TYPE_INT32
;

4197 
–em
->
v®ue
.
v®_št
 = value;

4199 
	`libh®_chªge£t_­³nd
 (
chªge£t
, 
–em
);

4200 
out
:

4201  
–em
 !ğ
NULL
;

4202 
	}
}

4214 
dbus_boŞ_t


4215 
	$libh®_chªge£t_£t_´İ”ty_ušt64
 (
LibH®ChªgeS‘
 *
chªge£t
, cÚ¡ *
key
, 
dbus_ušt64_t
 
v®ue
)

4217 
LibH®ChªgeS‘EËm’t
 *
–em
;

4219 
	`LIBHAL_CHECK_PARAM_VALID
(
chªge£t
, "*chªge£t", 
FALSE
);

4220 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

4222 
–em
 = 
	`ÿÎoc
 (1,  (
LibH®ChªgeS‘EËm’t
));

4223 ià(
–em
 =ğ
NULL
)

4224 
out
;

4225 
–em
->
key
 = 
	`¡rdup
 (key);

4226 ià(
–em
->
key
 =ğ
NULL
) {

4227 
	`ä“
 (
–em
);

4228 
–em
 = 
NULL
;

4229 
out
;

4232 
–em
->
chªge_ty³
 = 
LIBHAL_PROPERTY_TYPE_UINT64
;

4233 
–em
->
v®ue
.
v®_ušt64
 = value;

4235 
	`libh®_chªge£t_­³nd
 (
chªge£t
, 
–em
);

4236 
out
:

4237  
–em
 !ğ
NULL
;

4238 
	}
}

4250 
dbus_boŞ_t


4251 
	$libh®_chªge£t_£t_´İ”ty_doubË
 (
LibH®ChªgeS‘
 *
chªge£t
, cÚ¡ *
key
, 
v®ue
)

4253 
LibH®ChªgeS‘EËm’t
 *
–em
;

4255 
	`LIBHAL_CHECK_PARAM_VALID
(
chªge£t
, "*chªge£t", 
FALSE
);

4256 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

4258 
–em
 = 
	`ÿÎoc
 (1,  (
LibH®ChªgeS‘EËm’t
));

4259 ià(
–em
 =ğ
NULL
)

4260 
out
;

4261 
–em
->
key
 = 
	`¡rdup
 (key);

4262 ià(
–em
->
key
 =ğ
NULL
) {

4263 
	`ä“
 (
–em
);

4264 
–em
 = 
NULL
;

4265 
out
;

4268 
–em
->
chªge_ty³
 = 
LIBHAL_PROPERTY_TYPE_DOUBLE
;

4269 
–em
->
v®ue
.
v®_doubË
 = value;

4271 
	`libh®_chªge£t_­³nd
 (
chªge£t
, 
–em
);

4272 
out
:

4273  
–em
 !ğ
NULL
;

4274 
	}
}

4286 
dbus_boŞ_t


4287 
	$libh®_chªge£t_£t_´İ”ty_boŞ
 (
LibH®ChªgeS‘
 *
chªge£t
, cÚ¡ *
key
, 
dbus_boŞ_t
 
v®ue
)

4289 
LibH®ChªgeS‘EËm’t
 *
–em
;

4291 
	`LIBHAL_CHECK_PARAM_VALID
(
chªge£t
, "*chªge£t", 
FALSE
);

4292 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

4294 
–em
 = 
	`ÿÎoc
 (1,  (
LibH®ChªgeS‘EËm’t
));

4295 ià(
–em
 =ğ
NULL
)

4296 
out
;

4297 
–em
->
key
 = 
	`¡rdup
 (key);

4298 ià(
–em
->
key
 =ğ
NULL
) {

4299 
	`ä“
 (
–em
);

4300 
–em
 = 
NULL
;

4301 
out
;

4304 
–em
->
chªge_ty³
 = 
LIBHAL_PROPERTY_TYPE_BOOLEAN
;

4305 
–em
->
v®ue
.
v®_boŞ
 = value;

4307 
	`libh®_chªge£t_­³nd
 (
chªge£t
, 
–em
);

4308 
out
:

4309  
–em
 !ğ
NULL
;

4310 
	}
}

4322 
dbus_boŞ_t


4323 
	$libh®_chªge£t_£t_´İ”ty_¡¾i¡
 (
LibH®ChªgeS‘
 *
chªge£t
, cÚ¡ *
key
, cÚ¡ **
v®ue
)

4325 
LibH®ChªgeS‘EËm’t
 *
–em
;

4326 **
v®ue_cİy
;

4327 
Ën
;

4328 
i
, 
j
;

4330 
	`LIBHAL_CHECK_PARAM_VALID
(
chªge£t
, "*chªge£t", 
FALSE
);

4331 
	`LIBHAL_CHECK_PARAM_VALID
(
key
, "*key", 
FALSE
);

4333 
–em
 = 
	`ÿÎoc
 (1,  (
LibH®ChªgeS‘EËm’t
));

4334 ià(
–em
 =ğ
NULL
)

4335 
out
;

4336 
–em
->
key
 = 
	`¡rdup
 (key);

4337 ià(
–em
->
key
 =ğ
NULL
) {

4338 
	`ä“
 (
–em
);

4339 
–em
 = 
NULL
;

4340 
out
;

4343 
i
 = 0; 
v®ue
[i] !ğ
NULL
; i++)

4345 
Ën
 = 
i
;

4347 
v®ue_cİy
 = 
	`ÿÎoc
 (
Ën
 + 1,  (*));

4348 ià(
v®ue_cİy
 =ğ
NULL
) {

4349 
	`ä“
 (
–em
->
key
);

4350 
	`ä“
 (
–em
);

4351 
–em
 = 
NULL
;

4352 
out
;

4355 
i
 = 0; i < 
Ën
; i++) {

4356 
v®ue_cİy
[
i
] = 
	`¡rdup
 (
v®ue
[i]);

4357 ià(
v®ue_cİy
[
i
] =ğ
NULL
) {

4358 
j
 = 0; j < 
i
; j++) {

4359 
	`ä“
 (
v®ue_cİy
[
j
]);

4361 
	`ä“
 (
v®ue_cİy
);

4362 
	`ä“
 (
–em
->
key
);

4363 
	`ä“
 (
–em
);

4364 
–em
 = 
NULL
;

4365 
out
;

4368 
v®ue_cİy
[
i
] = 
NULL
;

4370 
–em
->
chªge_ty³
 = 
LIBHAL_PROPERTY_TYPE_STRLIST
;

4371 
–em
->
v®ue
.
v®_¡¾i¡
 = 
v®ue_cİy
;

4373 
	`libh®_chªge£t_­³nd
 (
chªge£t
, 
–em
);

4374 
out
:

4375  
–em
 !ğ
NULL
;

4376 
	}
}

4388 
dbus_boŞ_t


4389 
	$libh®_deviû_comm™_chªge£t
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®ChªgeS‘
 *
chªge£t
, 
DBusE¼Ü
 *
”rÜ
)

4391 
LibH®ChªgeS‘EËm’t
 *
–em
;

4392 
DBusMes§ge
 *
mes§ge
;

4393 
DBusMes§ge
 *
»¶y
;

4394 
DBusE¼Ü
 
_”rÜ
;

4395 
DBusMes§geI‹r
 
™”
;

4396 
DBusMes§geI‹r
 
sub
;

4397 
DBusMes§geI‹r
 
sub2
;

4398 
DBusMes§geI‹r
 
sub3
;

4399 
DBusMes§geI‹r
 
sub4
;

4400 
i
;

4402 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

4403 
	`LIBHAL_CHECK_UDI_VALID
(
chªge£t
->
udi
, 
FALSE
);

4405 ià(
chªge£t
->
h—d
 =ğ
NULL
) {

4406  
TRUE
;

4409 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("Üg.ä“desktİ.H®", 
chªge£t
->
udi
,

4413 ià(
mes§ge
 =ğ
NULL
) {

4414 
	`årštf
 (
¡d”r
, "% %d : Couldn'ˆ®loÿ‹ D-BUS mes§ge\n", 
__FILE__
, 
__LINE__
);

4415  
FALSE
;

4418 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

4420 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
™”
,

4421 
DBUS_TYPE_ARRAY
,

4422 
DBUS_DICT_ENTRY_BEGIN_CHAR_AS_STRING


4423 
DBUS_TYPE_STRING_AS_STRING


4424 
DBUS_TYPE_VARIANT_AS_STRING


4425 
DBUS_DICT_ENTRY_END_CHAR_AS_STRING
,

4426 &
sub
);

4428 
–em
 = 
chªge£t
->
h—d
;ƒËm !ğ
NULL
;ƒËm =ƒËm->
Ãxt
) {

4429 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
sub
,

4430 
DBUS_TYPE_DICT_ENTRY
,

4431 
NULL
,

4432 &
sub2
);

4433 
	`dbus_mes§ge_™”_­³nd_basic
 (&
sub2
, 
DBUS_TYPE_STRING
, &(
–em
->
key
));

4435 
–em
->
chªge_ty³
) {

4436 
LIBHAL_PROPERTY_TYPE_STRING
:

4437 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
sub2
, 
DBUS_TYPE_VARIANT
, 
DBUS_TYPE_STRING_AS_STRING
, &
sub3
);

4438 
	`dbus_mes§ge_™”_­³nd_basic
 (&
sub3
, 
DBUS_TYPE_STRING
, &(
–em
->
v®ue
.
v®_¡r
));

4439 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
sub2
, &
sub3
);

4441 
LIBHAL_PROPERTY_TYPE_STRLIST
:

4442 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
sub2
, 
DBUS_TYPE_VARIANT
,

4443 
DBUS_TYPE_ARRAY_AS_STRING
 
DBUS_TYPE_STRING_AS_STRING
, &
sub3
);

4444 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
sub3
, 
DBUS_TYPE_ARRAY
,

4445 
DBUS_TYPE_STRING_AS_STRING
, &
sub4
);

4446 
i
 = 0; 
–em
->
v®ue
.
v®_¡¾i¡
[i] !ğ
NULL
; i++) {

4447 
	`dbus_mes§ge_™”_­³nd_basic
 (&
sub4
, 
DBUS_TYPE_STRING
,

4448 &(
–em
->
v®ue
.
v®_¡¾i¡
[
i
]));

4450 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
sub3
, &
sub4
);

4451 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
sub2
, &
sub3
);

4453 
LIBHAL_PROPERTY_TYPE_INT32
:

4454 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
sub2
, 
DBUS_TYPE_VARIANT
, 
DBUS_TYPE_INT32_AS_STRING
, &
sub3
);

4455 
	`dbus_mes§ge_™”_­³nd_basic
 (&
sub3
, 
DBUS_TYPE_INT32
, &(
–em
->
v®ue
.
v®_št
));

4456 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
sub2
, &
sub3
);

4458 
LIBHAL_PROPERTY_TYPE_UINT64
:

4459 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
sub2
, 
DBUS_TYPE_VARIANT
, 
DBUS_TYPE_UINT64_AS_STRING
, &
sub3
);

4460 
	`dbus_mes§ge_™”_­³nd_basic
 (&
sub3
, 
DBUS_TYPE_UINT64
, &(
–em
->
v®ue
.
v®_ušt64
));

4461 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
sub2
, &
sub3
);

4463 
LIBHAL_PROPERTY_TYPE_DOUBLE
:

4464 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
sub2
, 
DBUS_TYPE_VARIANT
, 
DBUS_TYPE_DOUBLE_AS_STRING
, &
sub3
);

4465 
	`dbus_mes§ge_™”_­³nd_basic
 (&
sub3
, 
DBUS_TYPE_DOUBLE
, &(
–em
->
v®ue
.
v®_doubË
));

4466 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
sub2
, &
sub3
);

4468 
LIBHAL_PROPERTY_TYPE_BOOLEAN
:

4469 
	`dbus_mes§ge_™”_İ’_cÚš”
 (&
sub2
, 
DBUS_TYPE_VARIANT
, 
DBUS_TYPE_BOOLEAN_AS_STRING
,&
sub3
);

4470 
	`dbus_mes§ge_™”_­³nd_basic
 (&
sub3
, 
DBUS_TYPE_BOOLEAN
, &(
–em
->
v®ue
.
v®_boŞ
));

4471 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
sub2
, &
sub3
);

4474 
	`årštf
 (
¡d”r
, "% %d : unknowÀchªge_ty³ %d\n", 
__FILE__
, 
__LINE__
, 
–em
->
chªge_ty³
);

4477 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
sub
, &
sub2
);

4480 
	`dbus_mes§ge_™”_şo£_cÚš”
 (&
™”
, &
sub
);

4483 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

4484 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

4485 
mes§ge
, -1,

4486 &
_”rÜ
);

4488 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

4490 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

4491 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

4492 
	`årštf
 (
¡d”r
,

4494 
__FILE__
, 
__LINE__
, 
”rÜ
->
mes§ge
);

4496  
FALSE
;

4498 ià(
»¶y
 =ğ
NULL
) {

4499  
FALSE
;

4502 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4503  
TRUE
;

4504 
	}
}

4513 
	$libh®_deviû_ä“_chªge£t
 (
LibH®ChªgeS‘
 *
chªge£t
)

4515 
LibH®ChªgeS‘EËm’t
 *
–em
;

4516 
LibH®ChªgeS‘EËm’t
 *
–em2
;

4518 
–em
 = 
chªge£t
->
h—d
;ƒËm !ğ
NULL
;ƒËm = 
–em2
) {

4519 
–em2
 = 
–em
->
Ãxt
;

4521 
–em
->
chªge_ty³
) {

4522 
LIBHAL_PROPERTY_TYPE_STRING
:

4523 
	`ä“
 (
–em
->
v®ue
.
v®_¡r
);

4525 
LIBHAL_PROPERTY_TYPE_STRLIST
:

4526 
	`libh®_ä“_¡ršg_¬¿y
 (
–em
->
v®ue
.
v®_¡¾i¡
);

4529 
LIBHAL_PROPERTY_TYPE_INT32
:

4530 
LIBHAL_PROPERTY_TYPE_UINT64
:

4531 
LIBHAL_PROPERTY_TYPE_DOUBLE
:

4532 
LIBHAL_PROPERTY_TYPE_BOOLEAN
:

4535 
	`årštf
 (
¡d”r
, "% %d : unknowÀchªge_ty³ %d\n", 
__FILE__
, 
__LINE__
, 
–em
->
chªge_ty³
);

4538 
	`ä“
 (
–em
->
key
);

4539 
	`ä“
 (
–em
);

4542 
	`ä“
 (
chªge£t
->
udi
);

4543 
	`ä“
 (
chªge£t
);

4544 
	}
}

4559 
dbus_boŞ_t


4560 
	$libh®_deviû_acquœe_š‹rçû_lock
 (
LibH®CÚ‹xt
 *
ùx
,

4561 cÚ¡ *
udi
,

4562 cÚ¡ *
š‹rçû
,

4563 
dbus_boŞ_t
 
exşusive
,

4564 
DBusE¼Ü
 *
”rÜ
)

4566 
DBusMes§ge
 *
mes§ge
;

4567 
DBusMes§geI‹r
 
™”
;

4568 
DBusMes§ge
 *
»¶y
;

4570 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

4571 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

4572 
	`LIBHAL_CHECK_PARAM_VALID
(
š‹rçû
, "*š‹rçû", 
FALSE
);

4574 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

4575 
udi
,

4579 ià(
mes§ge
 =ğ
NULL
) {

4580 
	`årštf
 (
¡d”r
,

4582 
__FILE__
, 
__LINE__
);

4583  
FALSE
;

4586 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

4587 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
š‹rçû
);

4588 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
exşusive
);

4590 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

4591 
mes§ge
, -1,

4592 
”rÜ
);

4594 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

4596 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

4597  
FALSE
;

4599 ià(
»¶y
 =ğ
NULL
)

4600  
FALSE
;

4602 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4603  
TRUE
;

4604 
	}
}

4617 
dbus_boŞ_t
 
	$libh®_deviû_»Ëa£_š‹rçû_lock
 (
LibH®CÚ‹xt
 *
ùx
,

4618 cÚ¡ *
udi
,

4619 cÚ¡ *
š‹rçû
,

4620 
DBusE¼Ü
 *
”rÜ
)

4622 
DBusMes§ge
 *
mes§ge
;

4623 
DBusMes§geI‹r
 
™”
;

4624 
DBusMes§ge
 *
»¶y
;

4626 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

4627 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
FALSE
);

4628 
	`LIBHAL_CHECK_PARAM_VALID
(
š‹rçû
, "*š‹rçû", 
FALSE
);

4630 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

4631 
udi
,

4635 ià(
mes§ge
 =ğ
NULL
) {

4636 
	`årštf
 (
¡d”r
,

4638 
__FILE__
, 
__LINE__
);

4639  
FALSE
;

4642 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

4643 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
š‹rçû
);

4645 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

4646 
mes§ge
, -1,

4647 
”rÜ
);

4649 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

4651 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

4652  
FALSE
;

4654 ià(
»¶y
 =ğ
NULL
)

4655  
FALSE
;

4657 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4658  
TRUE
;

4659 
	}
}

4672 
dbus_boŞ_t
 
	$libh®_acquœe_glob®_š‹rçû_lock
 (
LibH®CÚ‹xt
 *
ùx
,

4673 cÚ¡ *
š‹rçû
,

4674 
dbus_boŞ_t
 
exşusive
,

4675 
DBusE¼Ü
 *
”rÜ
)

4677 
DBusMes§ge
 *
mes§ge
;

4678 
DBusMes§geI‹r
 
™”
;

4679 
DBusMes§ge
 *
»¶y
;

4681 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

4682 
	`LIBHAL_CHECK_PARAM_VALID
(
š‹rçû
, "*š‹rçû", 
FALSE
);

4684 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

4689 ià(
mes§ge
 =ğ
NULL
) {

4690 
	`årštf
 (
¡d”r
,

4692 
__FILE__
, 
__LINE__
);

4693  
FALSE
;

4696 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

4697 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
š‹rçû
);

4698 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_BOOLEAN
, &
exşusive
);

4700 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

4701 
mes§ge
, -1,

4702 
”rÜ
);

4704 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

4706 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

4707  
FALSE
;

4709 ià(
»¶y
 =ğ
NULL
)

4710  
FALSE
;

4712 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4713  
TRUE
;

4714 
	}
}

4726 
dbus_boŞ_t
 
	$libh®_»Ëa£_glob®_š‹rçû_lock
 (
LibH®CÚ‹xt
 *
ùx
,

4727 cÚ¡ *
š‹rçû
,

4728 
DBusE¼Ü
 *
”rÜ
)

4730 
DBusMes§ge
 *
mes§ge
;

4731 
DBusMes§geI‹r
 
™”
;

4732 
DBusMes§ge
 *
»¶y
;

4734 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
FALSE
);

4735 
	`LIBHAL_CHECK_PARAM_VALID
(
š‹rçû
, "*š‹rçû", 
FALSE
);

4737 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

4742 ià(
mes§ge
 =ğ
NULL
) {

4743 
	`årštf
 (
¡d”r
,

4745 
__FILE__
, 
__LINE__
);

4746  
FALSE
;

4749 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

4750 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
š‹rçû
);

4752 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

4753 
mes§ge
, -1,

4754 
”rÜ
);

4756 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

4758 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

4759  
FALSE
;

4761 ià(
»¶y
 =ğ
NULL
)

4762  
FALSE
;

4764 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4765  
TRUE
;

4766 
	}
}

4782 
dbus_boŞ_t


4783 
	$libh®_deviû_is_ÿÎ”_locked_out
 (
LibH®CÚ‹xt
 *
ùx
,

4784 cÚ¡ *
udi
,

4785 cÚ¡ *
š‹rçû
,

4786 cÚ¡ *
ÿÎ”
,

4787 
DBusE¼Ü
 *
”rÜ
)

4789 
DBusMes§ge
 *
mes§ge
;

4790 
DBusMes§geI‹r
 
™”
;

4791 
DBusMes§ge
 *
»¶y
;

4792 
DBusMes§geI‹r
 
»¶y_™”
;

4793 
dbus_boŞ_t
 
v®ue
;

4795 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
TRUE
);

4796 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
TRUE
);

4797 
	`LIBHAL_CHECK_PARAM_VALID
(
š‹rçû
, "*š‹rçû", 
TRUE
);

4798 
	`LIBHAL_CHECK_PARAM_VALID
(
ÿÎ”
, "*ÿÎ”", 
TRUE
);

4800 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

4801 
udi
,

4805 ià(
mes§ge
 =ğ
NULL
) {

4806 
	`årštf
 (
¡d”r
,

4808 
__FILE__
, 
__LINE__
);

4809  
TRUE
;

4812 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

4813 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
š‹rçû
);

4814 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
ÿÎ”
);

4816 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

4817 
mes§ge
, -1,

4818 
”rÜ
);

4820 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

4822 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

4823  
TRUE
;

4825 ià(
»¶y
 =ğ
NULL
)

4826  
TRUE
;

4829 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

4830 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_BOOLEAN
) {

4831 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4832  
TRUE
;

4834 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
v®ue
);

4835 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4836  
v®ue
;

4837 
	}
}

4849 
dbus_boŞ_t


4850 
	$libh®_ùx_£t_glob®_š‹rçû_lock_acquœed
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®Glob®IÁ”çûLockAcquœed
 
ÿÎback
)

4852 
	`LIBHAL_CHECK_LIBHALCONTEXT
 (
ùx
, 
FALSE
);

4854 
ùx
->
glob®_š‹rçû_lock_acquœed
 = 
ÿÎback
;

4855  
TRUE
;

4856 
	}
}

4867 
dbus_boŞ_t


4868 
	$libh®_ùx_£t_glob®_š‹rçû_lock_»Ëa£d
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®Glob®IÁ”çûLockR–—£d
 
ÿÎback
)

4870 
	`LIBHAL_CHECK_LIBHALCONTEXT
 (
ùx
, 
FALSE
);

4872 
ùx
->
glob®_š‹rçû_lock_»Ëa£d
 = 
ÿÎback
;

4873  
TRUE
;

4874 
	}
}

4886 
dbus_boŞ_t


4887 
	$libh®_ùx_£t_š‹rçû_lock_acquœed
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®IÁ”çûLockAcquœed
 
ÿÎback
)

4889 
	`LIBHAL_CHECK_LIBHALCONTEXT
 (
ùx
, 
FALSE
);

4891 
ùx
->
š‹rçû_lock_acquœed
 = 
ÿÎback
;

4892  
TRUE
;

4893 
	}
}

4904 
dbus_boŞ_t


4905 
	$libh®_ùx_£t_š‹rçû_lock_»Ëa£d
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®IÁ”çûLockR–—£d
 
ÿÎback
)

4907 
	`LIBHAL_CHECK_LIBHALCONTEXT
 (
ùx
, 
FALSE
);

4909 
ùx
->
š‹rçû_lock_»Ëa£d
 = 
ÿÎback
;

4910  
TRUE
;

4911 
	}
}

4926 
dbus_boŞ_t


4927 
	$libh®_deviû_is_locked_by_Ùh”s
 (
LibH®CÚ‹xt
 *
ùx
,

4928 cÚ¡ *
udi
,

4929 cÚ¡ *
š‹rçû
,

4930 
DBusE¼Ü
 *
”rÜ
)

4932 
DBusMes§ge
 *
mes§ge
;

4933 
DBusMes§geI‹r
 
™”
;

4934 
DBusMes§ge
 *
»¶y
;

4935 
DBusMes§geI‹r
 
»¶y_™”
;

4936 
dbus_boŞ_t
 
v®ue
;

4938 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
TRUE
);

4939 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
TRUE
);

4940 
	`LIBHAL_CHECK_PARAM_VALID
(
š‹rçû
, "*š‹rçû", 
TRUE
);

4942 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

4943 
udi
,

4947 ià(
mes§ge
 =ğ
NULL
) {

4948 
	`årštf
 (
¡d”r
,

4950 
__FILE__
, 
__LINE__
);

4951  
TRUE
;

4954 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

4955 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
š‹rçû
);

4957 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

4958 
mes§ge
, -1,

4959 
”rÜ
);

4961 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

4963 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

4964  
TRUE
;

4966 ià(
»¶y
 =ğ
NULL
)

4967  
TRUE
;

4970 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

4971 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_BOOLEAN
) {

4972 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4973  
TRUE
;

4975 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
v®ue
);

4976 
	`dbus_mes§ge_uÄef
 (
»¶y
);

4977  
v®ue
;

4978 
	}
}

4998 
	$libh®_deviû_is_ÿÎ”_´iveged
 (
LibH®CÚ‹xt
 *
ùx
,

4999 cÚ¡ *
udi
,

5000 cÚ¡ *
aùiÚ
,

5001 cÚ¡ *
ÿÎ”
,

5002 
DBusE¼Ü
 *
”rÜ
)

5004 
DBusMes§ge
 *
mes§ge
;

5005 
DBusMes§geI‹r
 
™”
;

5006 
DBusMes§ge
 *
»¶y
;

5007 
DBusMes§geI‹r
 
»¶y_™”
;

5008 *
dbus_¡r
;

5009 *
v®ue
;

5011 
	`LIBHAL_CHECK_LIBHALCONTEXT
(
ùx
, 
NULL
);

5012 
	`LIBHAL_CHECK_UDI_VALID
(
udi
, 
NULL
);

5013 
	`LIBHAL_CHECK_PARAM_VALID
(
aùiÚ
, "*aùiÚ", 
NULL
);

5014 
	`LIBHAL_CHECK_PARAM_VALID
(
ÿÎ”
, "*ÿÎ”", 
NULL
);

5016 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

5017 
udi
,

5021 ià(
mes§ge
 =ğ
NULL
) {

5022 
	`årštf
 (
¡d”r
,

5024 
__FILE__
, 
__LINE__
);

5025  
NULL
;

5028 
	`dbus_mes§ge_™”_š™_­³nd
 (
mes§ge
, &
™”
);

5029 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
aùiÚ
);

5030 
	`dbus_mes§ge_™”_­³nd_basic
 (&
™”
, 
DBUS_TYPE_STRING
, &
ÿÎ”
);

5032 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
,

5033 
mes§ge
, -1,

5034 
”rÜ
);

5036 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

5038 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

5039  
NULL
;

5041 ià(
»¶y
 =ğ
NULL
)

5042  
NULL
;

5045 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

5046 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_STRING
) {

5047 
	`dbus_mes§ge_uÄef
 (
»¶y
);

5048  
NULL
;

5050 
	`dbus_mes§ge_™”_g‘_basic
 (&
»¶y_™”
, &
dbus_¡r
);

5051 
v®ue
 = (*è((
dbus_¡r
 !ğ
NULL
è? 
	`¡rdup
 (dbus_str) : NULL);

5052 ià(
v®ue
 =ğ
NULL
) {

5053 
	`årštf
 (
¡d”r
, "% %d :ƒ¼Ü‡Îoÿtšg memÜy\n", 
__FILE__
, 
__LINE__
);

5055 
	`dbus_mes§ge_uÄef
 (
»¶y
);

5056  
v®ue
;

5057 
	}
}

5070 
dbus_boŞ_t
 
	$libh®_g‘_®l_deviûs_w™h_´İ”t›s
 (
LibH®CÚ‹xt
 *
ùx
,

5071 *
out_num_deviûs
,

5072 ***
out_udi
,

5073 
LibH®Prİ”tyS‘
 ***
out_´İ”t›s
,

5074 
DBusE¼Ü
 *
”rÜ
)

5077 
DBusMes§ge
 *
mes§ge
;

5078 
DBusMes§ge
 *
»¶y
;

5079 
DBusMes§geI‹r
 
™”_¬¿y
, 
»¶y_™”
;

5080 
DBusE¼Ü
 
_”rÜ
;

5081 **
udi_¬¿y
;

5082 **
_udi_¬¿y
;

5083 
LibH®Prİ”tyS‘
 **
´İ_¬¿y
;

5084 
LibH®Prİ”tyS‘
 **
_´İ_¬¿y
;

5085 
size_t
 
couÁ
;

5086 
n
;

5088 
	`LIBHAL_CHECK_LIBHALCONTEXT
 (
ùx
, 
FALSE
);

5089 
	`LIBHAL_CHECK_PARAM_VALID
 (
out_num_deviûs
, "*out_num_deviûs",
FALSE
);

5090 
	`LIBHAL_CHECK_PARAM_VALID
 (
out_udi
, "***out_udi", 
FALSE
);

5091 
	`LIBHAL_CHECK_PARAM_VALID
 (
out_´İ”t›s
, "***out_´İ”t›s", 
FALSE
);

5093 *
out_num_deviûs
 = 0;

5094 *
out_udi
 = 
NULL
;

5095 *
out_´İ”t›s
 = 
NULL
;

5097 
couÁ
 = 0;

5098 
udi_¬¿y
 = 
NULL
;

5099 
´İ_¬¿y
 = 
NULL
;

5101 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

5105 ià(
mes§ge
 =ğ
NULL
) {

5106 
	`årštf
 (
¡d”r
, "% %d : Could‚Ù‡Îoÿ‹ D-BUS mes§ge\n", 
__FILE__
, 
__LINE__
);

5107 
ç
;

5110 
	`dbus_”rÜ_š™
 (&
_”rÜ
);

5111 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
ùx
->
cÚÃùiÚ
, 
mes§ge
, -1, &
_”rÜ
);

5113 
	`dbus_move_”rÜ
 (&
_”rÜ
, 
”rÜ
);

5114 ià(
”rÜ
 !ğ
NULL
 && 
	`dbus_”rÜ_is_£t
 (error)) {

5115 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

5116 
ç
;

5118 ià(
»¶y
 =ğ
NULL
) {

5119 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

5120 
ç
;

5124 
	`dbus_mes§ge_™”_š™
 (
»¶y
, &
»¶y_™”
);

5126 ià(
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
»¶y_™”
è!ğ
DBUS_TYPE_ARRAY
) {

5127 
	`årštf
 (
¡d”r
, "% %d : wrÚg„•ly from h®d. Ex³ùšg‡À¬¿y.\n", 
__FILE__
, 
__LINE__
);

5128 
ç
;

5131 
	`dbus_mes§ge_™”_»cur£
 (&
»¶y_™”
, &
™”_¬¿y
);

5133 
	#_BLOCK_SIZE
 32

	)

5135 
udi_¬¿y
 = (**è
	`m®loc
 ( (*è* 
_BLOCK_SIZE
);

5136 ià(
udi_¬¿y
 =ğ
NULL
)

5137 
ç
;

5139 
´İ_¬¿y
 = (
LibH®Prİ”tyS‘
 **è
	`m®loc
 ( (*è* 
_BLOCK_SIZE
);

5140 ià(
´İ_¬¿y
 =ğ
NULL
)

5141 
ç
;

5143 
	`dbus_mes§ge_™”_g‘_¬g_ty³
 (&
™”_¬¿y
è=ğ
DBUS_TYPE_STRUCT
) {

5144 
DBusMes§geI‹r
 
™”_¡ruù
;

5145 cÚ¡ *
v®ue
;

5146 
LibH®Prİ”tyS‘
 *
p£t
;

5147 *
udi
;

5149 ià((
couÁ
 % 
_BLOCK_SIZE
) == 0 && count > 0) {

5150 
_udi_¬¿y
 = (**è
	`»®loc
 (
udi_¬¿y
,  (*è* (
couÁ
 + 
_BLOCK_SIZE
));

5151 
_´İ_¬¿y
 = (
LibH®Prİ”tyS‘
 **è
	`»®loc
 (
´İ_¬¿y
,  (*è* (
couÁ
+
_BLOCK_SIZE
));

5152 ià(
_udi_¬¿y
 =ğ
NULL
 || 
_´İ_¬¿y
 == NULL)

5153 
ç
;

5154 
udi_¬¿y
 = 
_udi_¬¿y
;

5155 
´İ_¬¿y
 = 
_´İ_¬¿y
;

5158 
	`dbus_mes§ge_™”_»cur£
 (&
™”_¬¿y
, &
™”_¡ruù
);

5160 
	`dbus_mes§ge_™”_g‘_basic
 (&
™”_¡ruù
, &
v®ue
);

5161 
udi
 = 
	`¡rdup
 (
v®ue
);

5162 ià(
udi
 =ğ
NULL
)

5163 
ç
;

5165 
	`dbus_mes§ge_™”_Ãxt
(&
™”_¡ruù
);

5167 
p£t
 = 
	`g‘_´İ”ty_£t
 (&
™”_¡ruù
);

5169 
udi_¬¿y
[
couÁ
] = 
udi
;

5170 
´İ_¬¿y
[
couÁ
] = 
p£t
;

5171 
couÁ
++;

5173 
	`dbus_mes§ge_™”_Ãxt
 (&
™”_¬¿y
);

5176 ià((
couÁ
 % 
_BLOCK_SIZE
) == 0 && count > 0) {

5177 
_udi_¬¿y
 = (**è
	`»®loc
 (
udi_¬¿y
,  (*è* (
couÁ
 + 
_BLOCK_SIZE
));

5178 
_´İ_¬¿y
 = (
LibH®Prİ”tyS‘
 **è
	`»®loc
 (
´İ_¬¿y
,  (*è* (
couÁ
 + 
_BLOCK_SIZE
));

5179 ià(
_udi_¬¿y
 =ğ
NULL
 || 
_´İ_¬¿y
 == NULL)

5180 
ç
;

5181 
udi_¬¿y
 = 
_udi_¬¿y
;

5182 
´İ_¬¿y
 = 
_´İ_¬¿y
;

5184 
udi_¬¿y
[
couÁ
] = 
NULL
;

5185 
´İ_¬¿y
[
couÁ
] = 
NULL
;

5187 *
out_num_deviûs
 = 
couÁ
;

5188 *
out_udi
 = 
udi_¬¿y
;

5189 *
out_´İ”t›s
 = 
´İ_¬¿y
;

5191 
	`dbus_mes§ge_uÄef
 (
»¶y
);

5192 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

5194  
TRUE
;

5196 
ç
:

5197 ià(
udi_¬¿y
 !ğ
NULL
) {

5198 
n
 = 0;‚ < 
couÁ
;‚++) {

5199 
	`ä“
 (
udi_¬¿y
[
n
]);

5201 
	`ä“
 (
udi_¬¿y
);

5204 ià(
´İ_¬¿y
 !ğ
NULL
) {

5205 
n
 = 0;‚ < 
couÁ
;‚++) {

5206 
	`ä“
 (
´İ_¬¿y
[
n
]);

5208 
	`ä“
 (
´İ_¬¿y
);

5211  
FALSE
;

5212 
	}
}

	@libhal/libhal.h

27 #iâdeà
LIBHAL_H


28 
	#LIBHAL_H


	)

30 #iâdeà
DBUS_API_SUBJECT_TO_CHANGE


31 
	#DBUS_API_SUBJECT_TO_CHANGE


	)

34 
	~<dbus/dbus.h
>

36 #ià
defšed
(
__ılu¥lus
)

43 #ià
defšed
(
__GNUC__
)

44 
	#LIBHAL_DEPRECATED
 
	`__©Œibu‹__
 ((
d•»ÿ‹d
))

	)

46 
	#LIBHAL_DEPRECATED


	)

57 
	#LIBHAL_FREE_DBUS_ERROR
(
_dbus_”rÜ_
) \

59 ià(
	`dbus_”rÜ_is_£t
(
_dbus_”rÜ_
)) \

60 
	`dbus_”rÜ_ä“
 (
_dbus_”rÜ_
); \

61 } 0)

	)

71 
	#LIBHAL_CHECK_LIBHALCONTEXT
(
_ùx_
, 
_»t_
) \

73 ià(
_ùx_
 =ğ
NULL
) { \

74 
	`årštf
 (
¡d”r
, \

76 
__FILE__
, 
__LINE__
); \

77  
_»t_
; \

79 } 0)

	)

88 
LIBHAL_PROPERTY_TYPE_INVALID
 = 
DBUS_TYPE_INVALID
,

91 
LIBHAL_PROPERTY_TYPE_INT32
 = 
DBUS_TYPE_INT32
,

94 
LIBHAL_PROPERTY_TYPE_UINT64
 = 
DBUS_TYPE_UINT64
,

97 
LIBHAL_PROPERTY_TYPE_DOUBLE
 = 
DBUS_TYPE_DOUBLE
,

100 
LIBHAL_PROPERTY_TYPE_BOOLEAN
 = 
DBUS_TYPE_BOOLEAN
,

103 
LIBHAL_PROPERTY_TYPE_STRING
 = 
DBUS_TYPE_STRING
,

106 
LIBHAL_PROPERTY_TYPE_STRLIST
 = ((è(
DBUS_TYPE_STRING
<<8)+('l'))

107 } 
	tLibH®Prİ”tyTy³
;

110 
LibH®CÚ‹xt_s
 
	tLibH®CÚ‹xt
;

111 
LibH®Prİ”ty_s
 
	tLibH®Prİ”ty
;

112 
LibH®Prİ”tyS‘_s
 
	tLibH®Prİ”tyS‘
;

123 (*
	tLibH®IÁeg¿‹DBusIÁoMašLoİ
è(
	tLibH®CÚ‹xt
 *
	tùx
,

124 
	tDBusCÚÃùiÚ
 *
	tdbus_cÚÃùiÚ
);

133 (*
	tLibH®DeviûAdded
è(
	tLibH®CÚ‹xt
 *
	tùx
,

134 cÚ¡ *
	tudi
);

143 (*
	tLibH®DeviûRemoved
è(
	tLibH®CÚ‹xt
 *
	tùx
,

144 cÚ¡ *
	tudi
);

155 (*
	tLibH®DeviûNewC­ab™y
è(
	tLibH®CÚ‹xt
 *
	tùx
,

156 cÚ¡ *
	tudi
,

157 cÚ¡ *
	tÿ·b™y
);

168 (*
	tLibH®DeviûLo¡C­ab™y
è(
	tLibH®CÚ‹xt
 *
	tùx
,

169 cÚ¡ *
	tudi
,

170 cÚ¡ *
	tÿ·b™y
);

182 (*
	tLibH®DeviûPrİ”tyModif›d
è(
	tLibH®CÚ‹xt
 *
	tùx
,

183 cÚ¡ *
	tudi
,

184 cÚ¡ *
	tkey
,

185 
	tdbus_boŞ_t
 
	tis_»moved
,

186 
	tdbus_boŞ_t
 
	tis_added
);

197 (*
	tLibH®DeviûCÚd™iÚ
è(
	tLibH®CÚ‹xt
 *
	tùx
,

198 cÚ¡ *
	tudi
,

199 cÚ¡ *
	tcÚd™iÚ_Çme
,

200 cÚ¡ *
	tcÚd™iÚ_d‘a
);

211 (*
	tLibH®Glob®IÁ”çûLockAcquœed
è(
	tLibH®CÚ‹xt
 *
	tùx
,

212 cÚ¡ *
	tš‹rçû_Çme
,

213 cÚ¡ *
	tlock_owÃr
,

214 
	tnum_locks
);

225 (*
	tLibH®Glob®IÁ”çûLockR–—£d
è(
	tLibH®CÚ‹xt
 *
	tùx
,

226 cÚ¡ *
	tš‹rçû_Çme
,

227 cÚ¡ *
	tlock_owÃr
,

228 
	tnum_locks
);

240 (*
	tLibH®IÁ”çûLockAcquœed
è(
	tLibH®CÚ‹xt
 *
	tùx
,

241 cÚ¡ *
	tudi
,

242 cÚ¡ *
	tš‹rçû_Çme
,

243 cÚ¡ *
	tlock_owÃr
,

244 
	tnum_locks
);

256 (*
	tLibH®IÁ”çûLockR–—£d
è(
	tLibH®CÚ‹xt
 *
	tùx
,

257 cÚ¡ *
	tudi
,

258 cÚ¡ *
	tš‹rçû_Çme
,

259 cÚ¡ *
	tlock_owÃr
,

260 
	tnum_locks
);

270 (*
	tLibH®SšgËtÚDeviûAdded
è(
	tLibH®CÚ‹xt
 *
	tùx
,

271 cÚ¡ *
	tudi
,

272 cÚ¡ 
	tLibH®Prİ”tyS‘
 *
	t´İ”t›s
);

282 (*
	tLibH®SšgËtÚDeviûRemoved
è(
	tLibH®CÚ‹xt
 *
	tùx
,

283 cÚ¡ *
	tudi
,

284 cÚ¡ 
	tLibH®Prİ”tyS‘
 *
	t´İ”t›s
);

289 
LibH®CÚ‹xt
 *
	`libh®_ùx_Ãw
 ();

292 
dbus_boŞ_t
 
	`libh®_ùx_£t_ÿche
 (
LibH®CÚ‹xt
 *
ùx
, dbus_boŞ_ˆ
u£_ÿche
);

295 
dbus_boŞ_t
 
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
LibH®CÚ‹xt
 *
ùx
, 
DBusCÚÃùiÚ
 *
cÚn
);

298 
DBusCÚÃùiÚ
 *
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
LibH®CÚ‹xt
 *
ùx
);

301 
dbus_boŞ_t
 
	`libh®_ùx_£t_u£r_d©a
 (
LibH®CÚ‹xt
 *
ùx
, *
u£r_d©a
);

304 * 
	`libh®_ùx_g‘_u£r_d©a
 (
LibH®CÚ‹xt
 *
ùx
);

307 
dbus_boŞ_t
 
	`libh®_ùx_£t_deviû_added
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®DeviûAdded
 
ÿÎback
);

310 
dbus_boŞ_t
 
	`libh®_ùx_£t_deviû_»moved
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®DeviûRemoved
 
ÿÎback
);

313 
dbus_boŞ_t
 
	`libh®_ùx_£t_deviû_Ãw_ÿ·b™y
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®DeviûNewC­ab™y
 
ÿÎback
);

316 
dbus_boŞ_t
 
	`libh®_ùx_£t_deviû_lo¡_ÿ·b™y
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®DeviûLo¡C­ab™y
 
ÿÎback
);

319 
dbus_boŞ_t
 
	`libh®_ùx_£t_deviû_´İ”ty_modif›d
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®DeviûPrİ”tyModif›d
 
ÿÎback
);

322 
dbus_boŞ_t
 
	`libh®_ùx_£t_deviû_cÚd™iÚ
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®DeviûCÚd™iÚ
 
ÿÎback
);

325 
dbus_boŞ_t
 
	`libh®_ùx_£t_glob®_š‹rçû_lock_acquœed
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®Glob®IÁ”çûLockAcquœed
 
ÿÎback
);

328 
dbus_boŞ_t
 
	`libh®_ùx_£t_glob®_š‹rçû_lock_»Ëa£d
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®Glob®IÁ”çûLockR–—£d
 
ÿÎback
);

331 
dbus_boŞ_t
 
	`libh®_ùx_£t_š‹rçû_lock_acquœed
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®IÁ”çûLockAcquœed
 
ÿÎback
);

334 
dbus_boŞ_t
 
	`libh®_ùx_£t_š‹rçû_lock_»Ëa£d
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®IÁ”çûLockR–—£d
 
ÿÎback
);

337 
dbus_boŞ_t
 
	`libh®_ùx_£t_sšgËtÚ_deviû_added
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®SšgËtÚDeviûAdded
 
ÿÎback
);

340 
dbus_boŞ_t
 
	`libh®_ùx_£t_sšgËtÚ_deviû_»moved
 (
LibH®CÚ‹xt
 *
ùx
, 
LibH®SšgËtÚDeviûRemoved
 
ÿÎback
);

343 
dbus_boŞ_t
 
	`libh®_ùx_š™
 (
LibH®CÚ‹xt
 *
ùx
, 
DBusE¼Ü
 *
”rÜ
);

346 
dbus_boŞ_t
 
	`libh®_ùx_shutdown
 (
LibH®CÚ‹xt
 *
ùx
, 
DBusE¼Ü
 *
”rÜ
);

349 
dbus_boŞ_t
 
	`libh®_ùx_ä“
 (
LibH®CÚ‹xt
 *
ùx
);

352 
LibH®CÚ‹xt
 *
	`libh®_ùx_š™_dœeù
 (
DBusE¼Ü
 *
”rÜ
);

355 **
	`libh®_g‘_®l_deviûs
 (
LibH®CÚ‹xt
 *
ùx
, *
num_deviûs
, 
DBusE¼Ü
 *
”rÜ
);

358 
dbus_boŞ_t
 
	`libh®_deviû_exi¡s
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
);

361 
dbus_boŞ_t
 
	`libh®_deviû_´št
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
);

364 
dbus_boŞ_t
 
	`libh®_deviû_´İ”ty_exi¡s
 (
LibH®CÚ‹xt
 *
ùx
,

365 cÚ¡ *
udi
,

366 cÚ¡ *
key
,

367 
DBusE¼Ü
 *
”rÜ
);

370 *
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
LibH®CÚ‹xt
 *
ùx
,

371 cÚ¡ *
udi
,

372 cÚ¡ *
key
,

373 
DBusE¼Ü
 *
”rÜ
);

376 
dbus_št32_t
 
	`libh®_deviû_g‘_´İ”ty_št
 (
LibH®CÚ‹xt
 *
ùx
,

377 cÚ¡ *
udi
,

378 cÚ¡ *
key
,

379 
DBusE¼Ü
 *
”rÜ
);

382 
dbus_ušt64_t
 
	`libh®_deviû_g‘_´İ”ty_ušt64
 (
LibH®CÚ‹xt
 *
ùx
,

383 cÚ¡ *
udi
,

384 cÚ¡ *
key
,

385 
DBusE¼Ü
 *
”rÜ
);

388 
	`libh®_deviû_g‘_´İ”ty_doubË
 (
LibH®CÚ‹xt
 *
ùx
,

389 cÚ¡ *
udi
,

390 cÚ¡ *
key
,

391 
DBusE¼Ü
 *
”rÜ
);

394 
dbus_boŞ_t
 
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
LibH®CÚ‹xt
 *
ùx
,

395 cÚ¡ *
udi
,

396 cÚ¡ *
key
,

397 
DBusE¼Ü
 *
”rÜ
);

400 **
	`libh®_deviû_g‘_´İ”ty_¡¾i¡
 (
LibH®CÚ‹xt
 *
ùx
,

401 cÚ¡ *
udi
,

402 cÚ¡ *
key
,

403 
DBusE¼Ü
 *
”rÜ
);

406 
dbus_boŞ_t
 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
LibH®CÚ‹xt
 *
ùx
,

407 cÚ¡ *
udi
,

408 cÚ¡ *
key
,

409 cÚ¡ *
v®ue
,

410 
DBusE¼Ü
 *
”rÜ
);

413 
dbus_boŞ_t
 
	`libh®_deviû_£t_´İ”ty_št
 (
LibH®CÚ‹xt
 *
ùx
,

414 cÚ¡ *
udi
,

415 cÚ¡ *
key
,

416 
dbus_št32_t
 
v®ue
,

417 
DBusE¼Ü
 *
”rÜ
);

420 
dbus_boŞ_t
 
	`libh®_deviû_£t_´İ”ty_ušt64
 (
LibH®CÚ‹xt
 *
ùx
,

421 cÚ¡ *
udi
,

422 cÚ¡ *
key
,

423 
dbus_ušt64_t
 
v®ue
,

424 
DBusE¼Ü
 *
”rÜ
);

427 
dbus_boŞ_t
 
	`libh®_deviû_£t_´İ”ty_doubË
 (
LibH®CÚ‹xt
 *
ùx
,

428 cÚ¡ *
udi
,

429 cÚ¡ *
key
,

430 
v®ue
,

431 
DBusE¼Ü
 *
”rÜ
);

434 
dbus_boŞ_t
 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
LibH®CÚ‹xt
 *
ùx
,

435 cÚ¡ *
udi
,

436 cÚ¡ *
key
,

437 
dbus_boŞ_t
 
v®ue
,

438 
DBusE¼Ü
 *
”rÜ
);

441 
dbus_boŞ_t
 
	`libh®_deviû_´İ”ty_¡¾i¡_­³nd
 (
LibH®CÚ‹xt
 *
ùx
,

442 cÚ¡ *
udi
,

443 cÚ¡ *
key
,

444 cÚ¡ *
v®ue
,

445 
DBusE¼Ü
 *
”rÜ
);

448 
dbus_boŞ_t
 
	`libh®_deviû_´İ”ty_¡¾i¡_´•’d
 (
LibH®CÚ‹xt
 *
ùx
,

449 cÚ¡ *
udi
,

450 cÚ¡ *
key
,

451 cÚ¡ *
v®ue
,

452 
DBusE¼Ü
 *
”rÜ
);

455 
dbus_boŞ_t
 
	`libh®_deviû_´İ”ty_¡¾i¡_»move_šdex
 (
LibH®CÚ‹xt
 *
ùx
,

456 cÚ¡ *
udi
,

457 cÚ¡ *
key
,

458 
idx
,

459 
DBusE¼Ü
 *
”rÜ
);

462 
dbus_boŞ_t
 
	`libh®_deviû_´İ”ty_¡¾i¡_»move
 (
LibH®CÚ‹xt
 *
ùx
,

463 cÚ¡ *
udi
,

464 cÚ¡ *
key
,

465 cÚ¡ *
v®ue
,

466 
DBusE¼Ü
 *
”rÜ
);

469 
dbus_boŞ_t
 
	`libh®_deviû_»move_´İ”ty
 (
LibH®CÚ‹xt
 *
ùx
,

470 cÚ¡ *
udi
,

471 cÚ¡ *
key
,

472 
DBusE¼Ü
 *
”rÜ
);

475 
LibH®Prİ”tyTy³
 
	`libh®_deviû_g‘_´İ”ty_ty³
 (
LibH®CÚ‹xt
 *
ùx
,

476 cÚ¡ *
udi
,

477 cÚ¡ *
key
,

478 
DBusE¼Ü
 *
”rÜ
);

480 
LibH®ChªgeS‘_s
;

481 
LibH®ChªgeS‘_s
 
	tLibH®ChªgeS‘
;

483 
LibH®ChªgeS‘
 *
	`libh®_deviû_Ãw_chªge£t
 (cÚ¡ *
udi
);

485 
dbus_boŞ_t
 
	`libh®_chªge£t_£t_´İ”ty_¡ršg
 (
LibH®ChªgeS‘
 *
chªge£t
,

486 cÚ¡ *
key
,

487 cÚ¡ *
v®ue
);

489 
dbus_boŞ_t
 
	`libh®_chªge£t_£t_´İ”ty_št
 (
LibH®ChªgeS‘
 *
chªge£t
,

490 cÚ¡ *
key
,

491 
dbus_št32_t
 
v®ue
);

493 
dbus_boŞ_t
 
	`libh®_chªge£t_£t_´İ”ty_ušt64
 (
LibH®ChªgeS‘
 *
chªge£t
,

494 cÚ¡ *
key
,

495 
dbus_ušt64_t
 
v®ue
);

497 
dbus_boŞ_t
 
	`libh®_chªge£t_£t_´İ”ty_doubË
 (
LibH®ChªgeS‘
 *
chªge£t
,

498 cÚ¡ *
key
,

499 
v®ue
);

501 
dbus_boŞ_t
 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
LibH®ChªgeS‘
 *
chªge£t
,

502 cÚ¡ *
key
,

503 
dbus_boŞ_t
 
v®ue
);

505 
dbus_boŞ_t
 
	`libh®_chªge£t_£t_´İ”ty_¡¾i¡
 (
LibH®ChªgeS‘
 *
chªge£t
,

506 cÚ¡ *
key
,

507 cÚ¡ **
v®ue
);

509 
dbus_boŞ_t
 
	`libh®_deviû_comm™_chªge£t
 (
LibH®CÚ‹xt
 *
ùx
,

510 
LibH®ChªgeS‘
 *
chªge£t
,

511 
DBusE¼Ü
 *
”rÜ
);

513 
	`libh®_deviû_ä“_chªge£t
 (
LibH®ChªgeS‘
 *
chªge£t
);

517 
LibH®Prİ”tyS‘
 *
	`libh®_deviû_g‘_®l_´İ”t›s
 (
LibH®CÚ‹xt
 *
ùx
,

518 cÚ¡ *
udi
,

519 
DBusE¼Ü
 *
”rÜ
);

522 
dbus_boŞ_t
 
	`libh®_g‘_®l_deviûs_w™h_´İ”t›s
 (
LibH®CÚ‹xt
 *
ùx
,

523 *
out_num_deviûs
,

524 ***
out_udi
,

525 
LibH®Prİ”tyS‘
 ***
out_´İ”t›s
,

526 
DBusE¼Ü
 *
”rÜ
);

529 
	`libh®_´İ”ty_£t_sÜt
 (
LibH®Prİ”tyS‘
 *
£t
);

532 
	`libh®_ä“_´İ”ty_£t
 (
LibH®Prİ”tyS‘
 *
£t
);

535 
	`libh®_´İ”ty_£t_g‘_num_–ems
 (
LibH®Prİ”tyS‘
 *
£t
);

538 
LibH®Prİ”tyTy³
 
	`libh®_ps_g‘_ty³
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
);

541 cÚ¡ *
	`libh®_ps_g‘_¡ršg
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
);

544 
dbus_št32_t
 
	`libh®_ps_g‘_št32
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
);

547 
dbus_ušt64_t
 
	`libh®_ps_g‘_ušt64
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
);

550 
	`libh®_ps_g‘_doubË
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
);

553 
dbus_boŞ_t
 
	`libh®_ps_g‘_boŞ
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
);

556 cÚ¡ * cÚ¡ *
	`libh®_ps_g‘_¡¾i¡
 (cÚ¡ 
LibH®Prİ”tyS‘
 *
£t
, cÚ¡ *
key
);

565 
	sLibH®Prİ”tyS‘I‹¿tÜ_s
 {

566 
LibH®Prİ”tyS‘
 *
£t
;

567 
idx
;

568 
LibH®Prİ”ty
 *
cur_´İ
;

569 *
»£rv”ed0
;

570 *
»£rv”ed1
;

574 
LibH®Prİ”tyS‘I‹¿tÜ_s
 
	tLibH®Prİ”tyS‘I‹¿tÜ
;

577 
	`libh®_psi_š™
 (
LibH®Prİ”tyS‘I‹¿tÜ
 *
™”
, 
LibH®Prİ”tyS‘
 *
£t
);

580 
dbus_boŞ_t
 
	`libh®_psi_has_mÜe
 (
LibH®Prİ”tyS‘I‹¿tÜ
 *
™”
);

583 
	`libh®_psi_Ãxt
 (
LibH®Prİ”tyS‘I‹¿tÜ
 *
™”
);

586 
LibH®Prİ”tyTy³
 
	`libh®_psi_g‘_ty³
 (
LibH®Prİ”tyS‘I‹¿tÜ
 *
™”
);

589 *
	`libh®_psi_g‘_key
 (
LibH®Prİ”tyS‘I‹¿tÜ
 *
™”
);

592 *
	`libh®_psi_g‘_¡ršg
 (
LibH®Prİ”tyS‘I‹¿tÜ
 *
™”
);

595 
dbus_št32_t
 
	`libh®_psi_g‘_št
 (
LibH®Prİ”tyS‘I‹¿tÜ
 *
™”
);

598 
dbus_ušt64_t
 
	`libh®_psi_g‘_ušt64
 (
LibH®Prİ”tyS‘I‹¿tÜ
 *
™”
);

601 
	`libh®_psi_g‘_doubË
 (
LibH®Prİ”tyS‘I‹¿tÜ
 *
™”
);

604 
dbus_boŞ_t
 
	`libh®_psi_g‘_boŞ
 (
LibH®Prİ”tyS‘I‹¿tÜ
 *
™”
);

607 **
	`libh®_psi_g‘_¡¾i¡
 (
LibH®Prİ”tyS‘I‹¿tÜ
 *
™”
);

610 
	`libh®_¡ršg_¬¿y_Ëngth
 (**
¡r_¬¿y
);

613 
	`libh®_ä“_¡ršg_¬¿y
 (**
¡r_¬¿y
);

616 
	`libh®_ä“_¡ršg
 (*
¡r
);

621 *
	`libh®_Ãw_deviû
 (
LibH®CÚ‹xt
 *
ùx
, 
DBusE¼Ü
 *
”rÜ
);

627 
dbus_boŞ_t
 
	`libh®_deviû_comm™_to_gdl
 (
LibH®CÚ‹xt
 *
ùx
,

628 cÚ¡ *
‹mp_udi
,

629 cÚ¡ *
udi
,

630 
DBusE¼Ü
 *
”rÜ
);

636 
dbus_boŞ_t
 
	`libh®_»move_deviû
 (
LibH®CÚ‹xt
 *
ùx
,

637 cÚ¡ *
udi
,

638 
DBusE¼Ü
 *
”rÜ
);

641 
dbus_boŞ_t
 
	`libh®_m”ge_´İ”t›s
 (
LibH®CÚ‹xt
 *
ùx
,

642 cÚ¡ *
rg‘_udi
,

643 cÚ¡ *
sourû_udi
,

644 
DBusE¼Ü
 *
”rÜ
);

647 
dbus_boŞ_t
 
	`libh®_deviû_m©ches
 (
LibH®CÚ‹xt
 *
ùx
,

648 cÚ¡ *
udi1
,

649 cÚ¡ *
udi2
,

650 cÚ¡ *
´İ”ty_Çme¥aû
,

651 
DBusE¼Ü
 *
”rÜ
);

656 **
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
LibH®CÚ‹xt
 *
ùx
,

657 cÚ¡ *
key
,

658 cÚ¡ *
v®ue
,

659 *
num_deviûs
,

660 
DBusE¼Ü
 *
”rÜ
);

663 
dbus_boŞ_t
 
	`libh®_deviû_add_ÿ·b™y
 (
LibH®CÚ‹xt
 *
ùx
,

664 cÚ¡ *
udi
,

665 cÚ¡ *
ÿ·b™y
,

666 
DBusE¼Ü
 *
”rÜ
);

671 
dbus_boŞ_t
 
	`libh®_deviû_qu”y_ÿ·b™y
 (
LibH®CÚ‹xt
 *
ùx
,

672 cÚ¡ *
udi
,

673 cÚ¡ *
ÿ·b™y
,

674 
DBusE¼Ü
 *
”rÜ
);

677 **
	`libh®_fšd_deviû_by_ÿ·b™y
 (
LibH®CÚ‹xt
 *
ùx
,

678 cÚ¡ *
ÿ·b™y
,

679 *
num_deviûs
,

680 
DBusE¼Ü
 *
”rÜ
);

685 
dbus_boŞ_t
 
	`libh®_deviû_´İ”ty_w©ch_®l
 (
LibH®CÚ‹xt
 *
ùx
,

686 
DBusE¼Ü
 *
”rÜ
);

691 
dbus_boŞ_t
 
	`libh®_deviû_add_´İ”ty_w©ch
 (
LibH®CÚ‹xt
 *
ùx
,

692 cÚ¡ *
udi
,

693 
DBusE¼Ü
 *
”rÜ
);

696 
dbus_boŞ_t
 
	`libh®_deviû_»move_´İ”ty_w©ch
 (
LibH®CÚ‹xt
 *
ùx
,

697 cÚ¡ *
udi
,

698 
DBusE¼Ü
 *
”rÜ
);

701 
dbus_boŞ_t
 
	`libh®_deviû_lock
 (
LibH®CÚ‹xt
 *
ùx
,

702 cÚ¡ *
udi
,

703 cÚ¡ *
»asÚ_to_lock
,

704 **
»asÚ_why_locked
,

705 
DBusE¼Ü
 *
”rÜ
);

708 
dbus_boŞ_t
 
	`libh®_deviû_uÆock
 (
LibH®CÚ‹xt
 *
ùx
,

709 cÚ¡ *
udi
,

710 
DBusE¼Ü
 *
”rÜ
);

712 
dbus_boŞ_t
 
	`libh®_deviû_»sÿn
 (
LibH®CÚ‹xt
 *
ùx
,

713 cÚ¡ *
udi
,

714 
DBusE¼Ü
 *
”rÜ
);

716 
dbus_boŞ_t
 
	`libh®_deviû_»´obe
 (
LibH®CÚ‹xt
 *
ùx
,

717 cÚ¡ *
udi
,

718 
DBusE¼Ü
 *
”rÜ
);

721 
dbus_boŞ_t
 
	`libh®_deviû_em™_cÚd™iÚ
 (
LibH®CÚ‹xt
 *
ùx
,

722 cÚ¡ *
udi
,

723 cÚ¡ *
cÚd™iÚ_Çme
,

724 cÚ¡ *
cÚd™iÚ_d‘as
,

725 
DBusE¼Ü
 *
”rÜ
);

728 
dbus_boŞ_t
 
	`libh®_deviû_şaim_š‹rçû
 (
LibH®CÚ‹xt
 *
ùx
,

729 cÚ¡ *
udi
,

730 cÚ¡ *
š‹rçû_Çme
,

731 cÚ¡ *
šŒo¥eùiÚ_xml
,

732 
DBusE¼Ü
 *
”rÜ
);

735 
dbus_boŞ_t
 
	`libh®_deviû_addÚ_is_»ady
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
udi
, 
DBusE¼Ü
 *
”rÜ
);

737 
dbus_boŞ_t
 
	`libh®_deviû_sšgËtÚ_addÚ_is_»ady
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
commªd_lše
, 
DBusE¼Ü
 *
”rÜ
);

740 
dbus_boŞ_t
 
	`libh®_deviû_acquœe_š‹rçû_lock
 (
LibH®CÚ‹xt
 *
ùx
,

741 cÚ¡ *
udi
,

742 cÚ¡ *
š‹rçû
,

743 
dbus_boŞ_t
 
exşusive
,

744 
DBusE¼Ü
 *
”rÜ
);

747 
dbus_boŞ_t
 
	`libh®_deviû_»Ëa£_š‹rçû_lock
 (
LibH®CÚ‹xt
 *
ùx
,

748 cÚ¡ *
udi
,

749 cÚ¡ *
š‹rçû
,

750 
DBusE¼Ü
 *
”rÜ
);

753 
dbus_boŞ_t
 
	`libh®_acquœe_glob®_š‹rçû_lock
 (
LibH®CÚ‹xt
 *
ùx
,

754 cÚ¡ *
š‹rçû
,

755 
dbus_boŞ_t
 
exşusive
,

756 
DBusE¼Ü
 *
”rÜ
);

759 
dbus_boŞ_t
 
	`libh®_»Ëa£_glob®_š‹rçû_lock
 (
LibH®CÚ‹xt
 *
ùx
,

760 cÚ¡ *
š‹rçû
,

761 
DBusE¼Ü
 *
”rÜ
);

764 
dbus_boŞ_t
 
	`libh®_deviû_is_ÿÎ”_locked_out
 (
LibH®CÚ‹xt
 *
ùx
,

765 cÚ¡ *
udi
,

766 cÚ¡ *
š‹rçû
,

767 cÚ¡ *
ÿÎ”
,

768 
DBusE¼Ü
 *
”rÜ
);

771 
dbus_boŞ_t
 
	`libh®_deviû_is_locked_by_Ùh”s
 (
LibH®CÚ‹xt
 *
ùx
,

772 cÚ¡ *
udi
,

773 cÚ¡ *
š‹rçû
,

774 
DBusE¼Ü
 *
”rÜ
);

777 * 
	`libh®_deviû_is_ÿÎ”_´iveged
 (
LibH®CÚ‹xt
 *
ùx
,

778 cÚ¡ *
udi
,

779 cÚ¡ *
aùiÚ
,

780 cÚ¡ *
ÿÎ”
,

781 
DBusE¼Ü
 *
”rÜ
);

784 #ià
	`defšed
(
__ılu¥lus
)

785 
	}
}

	@libhal/uthash.h

31 
	~<¡ršg.h
>

33 #iâdeà
UTHASH_H


34 
	#UTHASH_H


	)

36 
	#uthash_çl
(
msg
è
	`ex™
(-1è

	)

37 
	#uthash_bkt_m®loc
(
sz
è
	`m®loc
(szè

	)

38 
	#uthash_bkt_ä“
(
±r
è
	`ä“
ÕŒè

	)

39 
	#uthash_tbl_m®loc
(
sz
è
	`m®loc
(szè

	)

40 
	#uthash_tbl_ä“
(
±r
è
	`ä“
ÕŒè

	)

42 
	#uthash_nÛx·nd_fyi
(
tbl
è

	)

43 
	#uthash_ex·nd_fyi
(
tbl
è

	)

46 
	#HASH_INITIAL_NUM_BUCKETS
 32

	)

47 
	#HASH_BKT_CAPACITY_THRESH
 10

	)

49 
	#HASH_FIND
(
hh
,
h—d
,
key±r
,
keyËn_š
,
out
) \

51 
out
=
h—d
; \

52 ià(
h—d
) { \

53 (
h—d
)->
hh
.
tbl
->
key
 = (*)(
key±r
); \

54 (
h—d
)->
hh
.
tbl
->
keyËn
 = 
keyËn_š
; \

55 
	`HASH_FCN
((
h—d
)->
hh
.
tbl
->
key
,(h—d)->hh.tbl->
keyËn
, \

56 (
h—d
)->
hh
.
tbl
->
num_buck‘s
,(h—d)->hh.tbl->
bkt
, \

57 (
h—d
)->
hh
.
tbl
->
i
, (h—d)->hh.tbl->
j
,(h—d)->hh.tbl->
k
); \

58 
	`HASH_FIND_IN_BKT
(
hh
, (
h—d
)->hh.
tbl
->
buck‘s
[ (h—d)->hh.tbl->
bkt
], \

59 
key±r
,
keyËn_š
,
out
); \

61 } 0)

	)

63 
	#HASH_ADD
(
hh
,
h—d
,
f›ldÇme
,
keyËn_š
,
add
) \

64 
	`HASH_ADD_KEYPTR
(
hh
,
h—d
,&
add
->
f›ldÇme
,
keyËn_š
,add)

	)

66 
	#HASH_ADD_KEYPTR
(
hh
,
h—d
,
key±r
,
keyËn_š
,
add
) \

68 
add
->
hh
.
Ãxt
 = 
NULL
; \

69 
add
->
hh
.
key
 = (*)
key±r
; \

70 
add
->
hh
.
keyËn
 = 
keyËn_š
; \

71 
add
->
hh
.
–mt
 =‡dd; \

72 ià(!(
h—d
)) { \

73 
h—d
 = 
add
; \

74 (
h—d
)->
hh
.
´ev
 = 
NULL
; \

75 (
h—d
)->
hh
.
tbl
 = (
UT_hash_bË
*)
	`uthash_tbl_m®loc
( \

76 (
UT_hash_bË
)); \

77 ià(!((
h—d
)->
hh
.
tbl
)è{ 
	`uthash_çl
( "out of memory"); } \

78 (
h—d
)->
hh
.
tbl
->
Çme
 = #head; \

79 (
h—d
)->
hh
.
tbl
->

 = &(
add
->hh); \

80 (
h—d
)->
hh
.
tbl
->
nÛx·nd
 = 0; \

81 (
h—d
)->
hh
.
tbl
->
hash_q
 = 1<<16; \

82 (
h—d
)->
hh
.
tbl
->
num_buck‘s
 = 
HASH_INITIAL_NUM_BUCKETS
; \

83 (
h—d
)->
hh
.
tbl
->
num_™ems
 = 0; \

84 (
h—d
)->
hh
.
tbl
->
hho
 = (()(&
add
->hh) - ()(add)); \

85 (
h—d
)->
hh
.
tbl
->
buck‘s
 = (
UT_hash_buck‘
*)
	`uthash_bkt_m®loc
( \

86 
HASH_INITIAL_NUM_BUCKETS
*(
UT_hash_buck‘
)); \

87 ià(! (
h—d
)->
hh
.
tbl
->
buck‘s
è{ 
	`uthash_çl
( "out of memory"); } \

88 
	`mem£t
((
h—d
)->
hh
.
tbl
->
buck‘s
, 0, \

89 
HASH_INITIAL_NUM_BUCKETS
*(
UT_hash_buck‘
)); \

91 (
h—d
)->
hh
.
tbl
->

->
Ãxt
 = 
add
; \

92 
add
->
hh
.
´ev
 = (
h—d
)->hh.
tbl
->

->
–mt
; \

93 (
h—d
)->
hh
.
tbl
->

 = &(
add
->hh); \

95 (
h—d
)->
hh
.
tbl
->
num_™ems
++; \

96 
add
->
hh
.
tbl
 = (
h—d
)->hh.tbl; \

97 (
h—d
)->
hh
.
tbl
->
key
 = (*)
key±r
; \

98 (
h—d
)->
hh
.
tbl
->
keyËn
 = 
keyËn_š
; \

99 
	`HASH_FCN
((
h—d
)->
hh
.
tbl
->
key
,(h—d)->hh.tbl->
keyËn
, \

100 (
h—d
)->
hh
.
tbl
->
num_buck‘s
, \

101 (
h—d
)->
hh
.
tbl
->
bkt
, \

102 (
h—d
)->
hh
.
tbl
->
i
, (h—d)->hh.tbl->
j
, (h—d)->hh.tbl->
k
 ); \

103 
	`HASH_ADD_TO_BKT
(
hh
,(
h—d
)->hh.
tbl
->
buck‘s
[(h—d)->hh.tbl->
bkt
],
add
); \

104 
	`HASH_EMIT_KEY
(
hh
,
h—d
,
key±r
,
keyËn_š
); \

105 
	`HASH_FSCK
(
h—d
); \

106 } 0)

	)

108 
	#HASH_DELETE
(
hh
,
h—d
,
d–±r
) \

110 iàĞ((
d–±r
)->
hh
.
´ev
 =ğ
NULL
è&& ((d–±r)->hh.
Ãxt
 == NULL) ) { \

111 
	`uthash_bkt_ä“
((
h—d
)->
hh
.
tbl
->
buck‘s
 ); \

112 
	`uthash_tbl_ä“
((
h—d
)->
hh
.
tbl
); \

113 
h—d
 = 
NULL
; \

115 ià((
d–±r
è=ğ(
h—d
)->
hh
.
tbl
->

->
–mt
) { \

116 (
h—d
)->
hh
.
tbl
->

 = (*)((()((
d–±r
)->hh.
´ev
)) + \

117 (
h—d
)->
hh
.
tbl
->
hho
); \

119 ià((
d–±r
)->
hh
.
´ev
) { \

120 ((
UT_hash_hªdË
*)((()((
d–±r
)->
hh
.
´ev
)) + \

121 (
h—d
)->
hh
.
tbl
->
hho
))->
Ãxt
 = (
d–±r
)->hh.next; \

123 
h—d
 = (
d–±r
)->
hh
.
Ãxt
; \

125 ià((
d–±r
)->
hh
.
Ãxt
) { \

126 ((
UT_hash_hªdË
*)((()((
d–±r
)->
hh
.
Ãxt
)) + \

127 (
h—d
)->
hh
.
tbl
->
hho
))->
´ev
 = (
d–±r
)->hh.prev; \

129 (
h—d
)->
hh
.
tbl
->
key
 = (*)((
d–±r
)->hh.key); \

130 (
h—d
)->
hh
.
tbl
->
keyËn
 = (
d–±r
)->hh.keylen; \

131 
	`HASH_FCN
((
h—d
)->
hh
.
tbl
->
key
,(h—d)->hh.tbl->
keyËn
, \

132 (
h—d
)->
hh
.
tbl
->
num_buck‘s
,(h—d)->hh.tbl->
bkt
, \

133 (
h—d
)->
hh
.
tbl
->
i
,(h—d)->hh.tbl->
j
,(h—d)->hh.tbl->
k
 ); \

134 
	`HASH_DEL_IN_BKT
(
hh
,(
h—d
)->hh.
tbl
->
buck‘s
[(h—d)->hh.tbl->
bkt
], \

135 
d–±r
); \

136 (
h—d
)->
hh
.
tbl
->
num_™ems
--; \

138 
	`HASH_FSCK
(
h—d
); \

139 } 0)

	)

143 
	#HASH_FIND_STR
(
h—d
,
fšd¡r
,
out
) \

144 
	`HASH_FIND
(
hh
,
h—d
,
fšd¡r
,
	`¡¾’
(fšd¡r),
out
)

	)

145 
	#HASH_ADD_STR
(
h—d
,
¡rf›ld
,
add
) \

146 
	`HASH_ADD
(
hh
,
h—d
,
¡rf›ld
,
	`¡¾’
(
add
->¡rf›ld),add)

	)

147 
	#HASH_FIND_INT
(
h—d
,
fšdšt
,
out
) \

148 
	`HASH_FIND
(
hh
,
h—d
,
fšdšt
,(),
out
)

	)

149 
	#HASH_ADD_INT
(
h—d
,
štf›ld
,
add
) \

150 
	`HASH_ADD
(
hh
,
h—d
,
štf›ld
,(),
add
)

	)

151 
	#HASH_DEL
(
h—d
,
d–±r
) \

152 
	`HASH_DELETE
(
hh
,
h—d
,
d–±r
)

	)

158 #ifdeà
HASH_DEBUG


159 
	#HASH_OOPS
(...èdØ{ 
	`årštf
(
¡d”r
,
__VA_ARGS__
); 
	`ex™
(-1); } 0)

	)

160 
	#HASH_FSCK
(
h—d
) \

162 ià(
h—d
) { \

163 (
h—d
)->
hh
.
tbl
->
keyËn
 = 0; \

164  (
h—d
)->
hh
.
tbl
->
bkt_i
 = 0; \

165 (
h—d
)->
hh
.
tbl
->
bkt_i
 < (h—d)->hh.tbl->
num_buck‘s
; \

166 (
h—d
)->
hh
.
tbl
->
bkt_i
++) \

168 (
h—d
)->
hh
.
tbl
->
bkt_id—l
 = 0; \

169 (
h—d
)->
hh
.
tbl
->hh = \

170 (
h—d
)->
hh
.
tbl
->
buck‘s
[(h—d)->hh.tbl->
bkt_i
].
hh_h—d
; \

171 (
h—d
)->
hh
.
tbl
->
key
 = 
NULL
; \

172 (
h—d
)->
hh
.
tbl
->hh) { \

173 ià((
h—d
)->
hh
.
tbl
->
key
 != \

174 (*)((
h—d
)->
hh
.
tbl
->hh->
hh_´ev
)) { \

175 
	`HASH_OOPS
("invalid hh_prev %x,‡ctual %x\n", \

176 (
h—d
)->
hh
.
tbl
->hh->
hh_´ev
, \

177 (
h—d
)->
hh
.
tbl
->
key
 ); \

179 (
h—d
)->
hh
.
tbl
->
bkt_id—l
++; \

180 (
h—d
)->
hh
.
tbl
->
key
 = (*)((head)->hh.tbl->hh); \

181 (
h—d
)->
hh
.
tbl
->hh = (h—d)->hh.tbl->hh->
hh_Ãxt
; \

183 (
h—d
)->
hh
.
tbl
->
keyËn
 +ğ(h—d)->hh.tbl->
bkt_id—l
; \

184 ià((
h—d
)->
hh
.
tbl
->
buck‘s
[(h—d)->hh.tbl->
bkt_i
].
couÁ
 \

185 !ğ(
h—d
)->
hh
.
tbl
->
bkt_id—l
) { \

186 
	`HASH_OOPS
("invalid bucket count %d,‡ctual %d\n", \

187 (
h—d
)->
hh
.
tbl
->
buck‘s
[(h—d)->hh.tbl->
bkt_i
].
couÁ
, \

188 (
h—d
)->
hh
.
tbl
->
bkt_id—l
); \

191 ià((
h—d
)->
hh
.
tbl
->
keyËn
 !ğ(h—d)->hh.tbl->
num_™ems
) { \

192 
	`HASH_OOPS
("invalid hh item count %d,‡ctual %d\n", \

193 (
h—d
)->
hh
.
tbl
->
num_™ems
, (h—d)->hh.tbl->
keyËn
 ); \

196 (
h—d
)->
hh
.
tbl
->
keyËn
 = 0; \

197 (
h—d
)->
hh
.
tbl
->
key
 = 
NULL
; \

198 (
h—d
)->
hh
.
tbl
->hh = &(head)->hh; \

199 (
h—d
)->
hh
.
tbl
->hh) { \

200 (
h—d
)->
hh
.
tbl
->
keyËn
++; \

201 ià((
h—d
)->
hh
.
tbl
->
key
 !=(*)((h—d)->hh.tbl->hh->
´ev
)) {\

202 
	`HASH_OOPS
("invalid…rev %x,‡ctual %x\n", \

203 (
h—d
)->
hh
.
tbl
->hh->
´ev
, \

204 (
h—d
)->
hh
.
tbl
->
key
 ); \

206 (
h—d
)->
hh
.
tbl
->
key
 = (h—d)->hh.tbl->hh->
–mt
; \

207 (
h—d
)->
hh
.
tbl
->hh = ( (h—d)->hh.tbl->hh->
Ãxt
 ? \

208 (
UT_hash_hªdË
*)(()((
h—d
)->
hh
.
tbl
->hh->
Ãxt
) + \

209 (
h—d
)->
hh
.
tbl
->
hho
) \

210 : 
NULL
 ); \

212 ià((
h—d
)->
hh
.
tbl
->
keyËn
 !ğ(h—d)->hh.tbl->
num_™ems
) { \

213 
	`HASH_OOPS
("invalid‡pp item count %d,‡ctual %d\n", \

214 (
h—d
)->
hh
.
tbl
->
num_™ems
, (h—d)->hh.tbl->
keyËn
 ); \

217 } 0)

	)

219 
	#HASH_FSCK
(
h—d
)

	)

225 #ifdeà
HASH_EMIT_KEYS


226 
	#HASH_EMIT_KEY
(
hh
,
h—d
,
key±r
,
f›ldËn
) \

227 (
h—d
)->
hh
.
tbl
->
keyËn
 = 
f›ldËn
; \

228 
	`wr™e
(
HASH_EMIT_KEYS
, &((
h—d
)->
hh
.
tbl
->
keyËn
), ()); \

229 
	`wr™e
(
HASH_EMIT_KEYS
, 
key±r
, 
f›ldËn
);

	)

231 
	#HASH_EMIT_KEY
(
hh
,
h—d
,
key±r
,
f›ldËn
)

	)

235 #ifdeà
HASH_FUNCTION


236 
	#HASH_FCN
 
HASH_FUNCTION


	)

238 
	#HASH_FCN
 
HASH_JEN


	)

242 
	#HASH_BER
(
key
,
keyËn
,
num_bkts
,
bkt
,
i
,
j
,
k
) \

243 
bkt
 = 0; \

244 
keyËn
--è
bkt
 = (bkˆ* 33è+ *
key
++; \

245 
bkt
 &ğ(
num_bkts
-1);

	)

250 
	#HASH_SAX
(
key
,
keyËn
,
num_bkts
,
bkt
,
i
,
j
,
k
) \

251 
bkt
 = 0; \

252 
i
=0; i < 
keyËn
; i++) \

253 
bkt
 ^ğ(bkˆ<< 5è+ (bkˆ>> 2è+ 
key
[
i
]; \

254 
bkt
 &ğ(
num_bkts
-1);

	)

256 
	#HASH_FNV
(
key
,
keyËn
,
num_bkts
,
bkt
,
i
,
j
,
k
) \

257 
bkt
 = 2166136261UL; \

258 
i
=0; i < 
keyËn
; i++) \

259 
bkt
 = (bkˆ* 16777619è^ 
key
[
i
]; \

260 
bkt
 &ğ(
num_bkts
-1);

	)

262 
	#HASH_OAT
(
key
,
keyËn
,
num_bkts
,
bkt
,
i
,
j
,
k
) \

263 
bkt
 = 0; \

264 
i
=0; i < 
keyËn
; i++) { \

265 
bkt
 +ğ
key
[
i
]; \

266 
bkt
 += (bkt << 10); \

267 
bkt
 ^= (bkt >> 6); \

269 
bkt
 += (bkt << 3); \

270 
bkt
 ^= (bkt >> 11); \

271 
bkt
 += (bkt << 15); \

272 
bkt
 &ğ(
num_bkts
-1);

	)

274 
	#HASH_JEN_MIX
(
a
,
b
,
c
) \

276 
a
 -ğ
b
;‡ -ğ
c
;‡ ^= ( c >> 13 ); \

277 
b
 -ğ
c
; b -ğ
a
; b ^= (‡ << 8 ); \

278 
c
 -ğ
a
; c -ğ
b
; c ^= ( b >> 13 ); \

279 
a
 -ğ
b
;‡ -ğ
c
;‡ ^= ( c >> 12 ); \

280 
b
 -ğ
c
; b -ğ
a
; b ^= (‡ << 16 ); \

281 
c
 -ğ
a
; c -ğ
b
; c ^= ( b >> 5 ); \

282 
a
 -ğ
b
;‡ -ğ
c
;‡ ^= ( c >> 3 ); \

283 
b
 -ğ
c
; b -ğ
a
; b ^= (‡ << 10 ); \

284 
c
 -ğ
a
; c -ğ
b
; c ^= ( b >> 15 ); \

285 }

	)

287 
	#HASH_JEN
(
key
,
keyËn
,
num_bkts
,
bkt
,
i
,
j
,
k
) \

288 
bkt
 = 0xfeedbeef; \

289 
i
 = 
j
 = 0x9e3779b9; \

290 
k
 = 
keyËn
; \

291 
k
 >= 12) { \

292 
i
 +ğ(
key
[0] + ( ()key[1] << 8 ) \

293 + ( ()
key
[2] << 16 ) \

294 + ( ()
key
[3] << 24 ) ); \

295 
j
 +ğ(
key
[4] + ( ()key[5] << 8 ) \

296 + ( ()
key
[6] << 16 ) \

297 + ( ()
key
[7] << 24 ) ); \

298 
bkt
 +ğ(
key
[8] + ( ()key[9] << 8 ) \

299 + ( ()
key
[10] << 16 ) \

300 + ( ()
key
[11] << 24 ) ); \

302 
	`HASH_JEN_MIX
(
i
, 
j
, 
bkt
); \

304 
key
 += 12; \

305 
k
 -= 12; \

307 
bkt
 +ğ
keyËn
; \

308  
k
 ) { \

309 11: 
bkt
 +ğĞ()
key
[10] << 24 ); \

310 10: 
bkt
 +ğĞ()
key
[9] << 16 ); \

311 9: 
bkt
 +ğĞ()
key
[8] << 8 ); \

312 8: 
j
 +ğĞ()
key
[7] << 24 ); \

313 7: 
j
 +ğĞ()
key
[6] << 16 ); \

314 6: 
j
 +ğĞ()
key
[5] << 8 ); \

315 5: 
j
 +ğ
key
[4]; \

316 4: 
i
 +ğĞ()
key
[3] << 24 ); \

317 3: 
i
 +ğĞ()
key
[2] << 16 ); \

318 2: 
i
 +ğĞ()
key
[1] << 8 ); \

319 1: 
i
 +ğ
key
[0]; \

321 
	`HASH_JEN_MIX
(
i
, 
j
, 
bkt
); \

322 
bkt
 &ğ(
num_bkts
-1);

	)

324 
	#HASH_JSW
(
key
,
keyËn
,
num_bkts
,
bkt
,
i
,
j
,
k
) \

325 
bkt
 = 16777551; \

326 
i
=0; i < 
keyËn
; i++) { \

327 
bkt
 = (bkt << 1 | bkt >> 31) ^ \

398 + ( ()
key
[
i
] * () )); \

400 
bkt
 &ğ(
num_bkts
-1);

	)

403 
	#HASH_KEYCMP
(
a
,
b
,
Ën
è
	`memcmp
×,b,Ën)

	)

406 
	#HASH_FIND_IN_BKT
(
hh
,
h—d
,
key±r
,
keyËn_š
,
out
) \

407 
out
 = (
h—d
.
hh_h—d
è? (h—d.hh_h—d->
–mt
è: 
NULL
; \

408 
out
) { \

409 ià(
out
->
hh
.
keyËn
 =ğ
keyËn_š
) { \

410 ià((
	`HASH_KEYCMP
(
out
->
hh
.
key
,
key±r
,
keyËn_š
)) == 0) ; \

412 
out
ğ(out->
hh
.
hh_Ãxt
è? (out->hh.hh_Ãxt->
–mt
è: 
NULL
; \

413 }

	)

416 
	#HASH_ADD_TO_BKT
(
hh
,
h—d
,
add
) \

417 
h—d
.
couÁ
++; \

418 
add
->
hh
.
hh_Ãxt
 = 
h—d
.
hh_h—d
; \

419 
add
->
hh
.
hh_´ev
 = 
NULL
; \

420 ià(
h—d
.
hh_h—d
èh—d.hh_h—d->
hh_´ev
 = &
add
->
hh
; \

421 
h—d
.
hh_h—d
=&
add
->
hh
; \

422 ià(
h—d
.
couÁ
 >ğ((h—d.
ex·nd_muÉ
+1è* 
HASH_BKT_CAPACITY_THRESH
) \

423 && 
add
->
hh
.
tbl
->
nÛx·nd
 != 1) { \

424 
	`HASH_EXPAND_BUCKETS
(
add
->
hh
.
tbl
) \

425 }

	)

428 
	#HASH_DEL_IN_BKT
(
hh
,
h—d
,
d–±r
) \

429 (
h—d
).
couÁ
--; \

430 ià((
h—d
).
hh_h—d
->
–mt
 =ğ
d–±r
) { \

431 (
h—d
).
hh_h—d
 = 
d–±r
->
hh
.
hh_Ãxt
; \

433 ià(
d–±r
->
hh
.
hh_´ev
) { \

434 
d–±r
->
hh
.
hh_´ev
->
hh_Ãxt
 = delptr->hh.hh_next; \

436 ià(
d–±r
->
hh
.
hh_Ãxt
) { \

437 
d–±r
->
hh
.
hh_Ãxt
->
hh_´ev
 = delptr->hh.hh_prev; \

438 }

	)

440 
	#HASH_EXPAND_BUCKETS
(
tbl
) \

441 
tbl
->
Ãw_buck‘s
 = (
UT_hash_buck‘
*)
	`uthash_bkt_m®loc
( \

442 2 * 
tbl
->
num_buck‘s
 * (
UT_hash_buck‘
)); \

443 ià(!
tbl
->
Ãw_buck‘s
è{ 
	`uthash_çl
( "out of memory"); } \

444 
	`mem£t
(
tbl
->
Ãw_buck‘s
, 0, \

445 2 * 
tbl
->
num_buck‘s
 * (
UT_hash_buck‘
)); \

446 
tbl
->
bkt_id—l
ğÑbl->
num_™ems
 /bl->
num_buck‘s
*2) + \

447 ((
tbl
->
num_™ems
 % (tbl->
num_buck‘s
*2)) ? 1 : 0);\

448 
tbl
->
sum_of_d–s
 = 0; \

449 
tbl
->
bkt_i
 = 0;bl->bkt_˜<bl->
num_buck‘s
;bl->bkt_i++) \

451 
tbl
->
hh
 =bl->
buck‘s
[bl->
bkt_i
 ].
hh_h—d
; \

452 
tbl
->
hh
) { \

453 
tbl
->
hh_nxt
 =bl->
hh
->
hh_Ãxt
; \

454 
tbl
->
key
 =bl->
hh
->key; \

455 
tbl
->
keyËn
 =bl->
hh
->keylen; \

456 
	`HASH_FCN
(
tbl
->
key
,tbl->
keyËn
,tbl->
num_buck‘s
*2,tbl->
bkt
,\

457 
tbl
->
i
,tbl->
j
,tbl->
k
); \

458 
tbl
->
Ãwbkt
 = &Ñbl->
Ãw_buck‘s
[bl->
bkt
 ]); \

459 ià(++(
tbl
->
Ãwbkt
->
couÁ
è>bl->
bkt_id—l
) { \

460 
tbl
->
sum_of_d–s
++; \

461 
tbl
->
Ãwbkt
->
ex·nd_muÉ
 =bl->Ãwbkt->
couÁ
 / \

462 
tbl
->
bkt_id—l
; \

464 
tbl
->
hh
->
hh_´ev
 = 
NULL
; \

465 
tbl
->
hh
->
hh_Ãxt
 =bl->
Ãwbkt
->
hh_h—d
; \

466 ià(
tbl
->
Ãwbkt
->
hh_h—d
ètbl->Ãwbkt->hh_h—d->
hh_´ev
 = \

467 
tbl
->
hh
; \

468 
tbl
->
Ãwbkt
->
hh_h—d
 =bl->
hh
; \

469 
tbl
->
hh
 =bl->
hh_nxt
; \

472 
tbl
->
num_buck‘s
 *= 2; \

473 
	`uthash_bkt_ä“
Ğ
tbl
->
buck‘s
 ); \

474 
tbl
->
buck‘s
 =bl->
Ãw_buck‘s
; \

475 
tbl
->
Ãw_hash_q
 = (1<<16è- (Ñbl->
sum_of_d–s
 << 16è/bl->
num_™ems
); \

476 ià(
tbl
->
hash_q
 < (1<<15è&&bl->
Ãw_hash_q
 < (1<<15)) { \

477 
tbl
->
nÛx·nd
=1; \

478 
	`uthash_nÛx·nd_fyi
(
tbl
); \

480 
tbl
->
hash_q
 =bl->
Ãw_hash_q
; \

481 
	`uthash_ex·nd_fyi
(
tbl
);

	)

485 
	#HASH_SORT
(
h—d
,
cmpfú
) \

486 ià(
h—d
) { \

487 (
h—d
)->
hh
.
tbl
->
šsize
 = 1; \

488 (
h—d
)->
hh
.
tbl
->
loİšg
 = 1; \

489 (
h—d
)->
hh
.
tbl
->
li¡
 = &((head)->hh); \

490 (
h—d
)->
hh
.
tbl
->
loİšg
) { \

491 (
h—d
)->
hh
.
tbl
->
p
 = (h—d)->hh.tbl->
li¡
; \

492 (
h—d
)->
hh
.
tbl
->
li¡
 = 
NULL
; \

493 (
h—d
)->
hh
.
tbl
->
Ë
 = 
NULL
; \

494 (
h—d
)->
hh
.
tbl
->
nm”ges
 = 0; \

495 (
h—d
)->
hh
.
tbl
->
p
) { \

496 (
h—d
)->
hh
.
tbl
->
nm”ges
++; \

497 (
h—d
)->
hh
.
tbl
->
q
 = (h—d)->hh.tbl->
p
; \

498 (
h—d
)->
hh
.
tbl
->
psize
 = 0; \

499  (
h—d
)->
hh
.
tbl
->
i
 = 0; \

500 (
h—d
)->
hh
.
tbl
->
i
 < (h—d)->hh.tbl->
šsize
; \

501 (
h—d
)->
hh
.
tbl
->
i
++ ) { \

502 (
h—d
)->
hh
.
tbl
->
psize
++; \

503 (
h—d
)->
hh
.
tbl
->
q
 = (((h—d)->hh.tbl->q->
Ãxt
) ? \

504 ((*)((()((
h—d
)->
hh
.
tbl
->
q
->
Ãxt
)) + \

505 (
h—d
)->
hh
.
tbl
->
hho
)è: 
NULL
); \

506 ià(! ((
h—d
)->
hh
.
tbl
->
q
) ) ; \

508 (
h—d
)->
hh
.
tbl
->
qsize
 = (h—d)->hh.tbl->
šsize
; \

509 ((
h—d
)->
hh
.
tbl
->
psize
 > 0) || \

510 (((
h—d
)->
hh
.
tbl
->
qsize
 > 0è&& (h—d)->hh.tbl->
q
 )) { \

511 ià((
h—d
)->
hh
.
tbl
->
psize
 == 0) { \

512 (
h—d
)->
hh
.
tbl
->
e
 = (h—d)->hh.tbl->
q
; \

513 (
h—d
)->
hh
.
tbl
->
q
 = (((h—d)->hh.tbl->q->
Ãxt
) ? \

514 ((*)((()((
h—d
)->
hh
.
tbl
->
q
->
Ãxt
)) + \

515 (
h—d
)->
hh
.
tbl
->
hho
)è: 
NULL
); \

516 (
h—d
)->
hh
.
tbl
->
qsize
--; \

517 } iàĞ((
h—d
)->
hh
.
tbl
->
qsize
 == 0) || \

518 !((
h—d
)->
hh
.
tbl
->
q
) ) { \

519 (
h—d
)->
hh
.
tbl
->
e
 = (h—d)->hh.tbl->
p
; \

520 (
h—d
)->
hh
.
tbl
->
p
 = (((h—d)->hh.tbl->p->
Ãxt
) ? \

521 ((*)((()((
h—d
)->
hh
.
tbl
->
p
->
Ãxt
)) + \

522 (
h—d
)->
hh
.
tbl
->
hho
)è: 
NULL
); \

523 (
h—d
)->
hh
.
tbl
->
psize
--; \

525 
	`cmpfú
((
h—d
)->
hh
.
tbl
->
p
->
–mt
,(h—d)->hh.tbl->
q
->elmt)) \

527 (
h—d
)->
hh
.
tbl
->
e
 = (h—d)->hh.tbl->
p
; \

528 (
h—d
)->
hh
.
tbl
->
p
 = (((h—d)->hh.tbl->p->
Ãxt
) ? \

529 ((*)((()((
h—d
)->
hh
.
tbl
->
p
->
Ãxt
)) + \

530 (
h—d
)->
hh
.
tbl
->
hho
)è: 
NULL
); \

531 (
h—d
)->
hh
.
tbl
->
psize
--; \

533 (
h—d
)->
hh
.
tbl
->
e
 = (h—d)->hh.tbl->
q
; \

534 (
h—d
)->
hh
.
tbl
->
q
 = (((h—d)->hh.tbl->q->
Ãxt
) ? \

535 ((*)((()((
h—d
)->
hh
.
tbl
->
q
->
Ãxt
)) + \

536 (
h—d
)->
hh
.
tbl
->
hho
)è: 
NULL
); \

537 (
h—d
)->
hh
.
tbl
->
qsize
--; \

539 iàĞ(
h—d
)->
hh
.
tbl
->
Ë
 ) { \

540 (
h—d
)->
hh
.
tbl
->
Ë
->
Ãxt
 = (((h—d)->hh.tbl->
e
) ? \

541 ((
h—d
)->
hh
.
tbl
->
e
->
–mt
è: 
NULL
); \

543 (
h—d
)->
hh
.
tbl
->
li¡
 = (h—d)->hh.tbl->
e
; \

545 (
h—d
)->
hh
.
tbl
->
e
->
´ev
 = (((h—d)->hh.tbl->
Ë
) ? \

546 ((
h—d
)->
hh
.
tbl
->
Ë
->
–mt
è: 
NULL
); \

547 (
h—d
)->
hh
.
tbl
->
Ë
 = (h—d)->hh.tbl->
e
; \

549 (
h—d
)->
hh
.
tbl
->
p
 = (h—d)->hh.tbl->
q
; \

551 (
h—d
)->
hh
.
tbl
->
Ë
->
Ãxt
 = 
NULL
; \

552 iàĞ(
h—d
)->
hh
.
tbl
->
nm”ges
 <= 1 ) { \

553 (
h—d
)->
hh
.
tbl
->
loİšg
=0; \

554 (
h—d
)->
hh
.
tbl
->

 = (h—d)->hh.tbl->
Ë
; \

555 (
h—d
èğ(h—d)->
hh
.
tbl
->
li¡
->
–mt
; \

557 (
h—d
)->
hh
.
tbl
->
šsize
 *= 2; \

559 
	`HASH_FSCK
(
h—d
); \

560 }

	)

562 
	sUT_hash_buck‘
 {

563 
UT_hash_hªdË
 *
	mhh_h—d
;

564 
	mcouÁ
;

565 
	mex·nd_muÉ
;

566 } 
	tUT_hash_buck‘
;

568 
	sUT_hash_bË
 {

569 
UT_hash_buck‘
 *
	mbuck‘s
;

570 
	mnum_buck‘s
;

571 
	mnum_™ems
;

572 
	mnÛx·nd
;

573 
	mhash_q
;

574 
UT_hash_hªdË
 *
	m
;

575 *
	mÇme
;

576 
	mhho
;

578 
	mbkt
;

579 *
	mkey
;

580 
size_t
 
	mkeyËn
;

581 
	mi
,
	mj
,
	mk
;

583 
UT_hash_buck‘
 *
	mÃw_buck‘s
, *
	mÃwbkt
;

584 
UT_hash_hªdË
 *
	mhh
, *
	mhh_nxt
;

585 
	mbkt_i
, 
	mbkt_id—l
, 
	msum_of_d–s
;

586 
	mÃw_hash_q
;

588 
	mloİšg
,
	mnm”ges
,
	mšsize
,
	mpsize
,
	mqsize
;

589 
UT_hash_hªdË
 *
	mp
, *
	mq
, *
	me
, *
	mli¡
, *
	mË
;

591 } 
	tUT_hash_bË
;

594 
	sUT_hash_hªdË
 {

595 
UT_hash_bË
 *
	mtbl
;

596 *
	m–mt
;

597 *
	m´ev
;

598 *
	mÃxt
;

599 
UT_hash_hªdË
 *
	mhh_´ev
;

600 
UT_hash_hªdË
 *
	mhh_Ãxt
;

601 *
	mkey
;

602 
size_t
 
	mkeyËn
;

603 } 
	tUT_hash_hªdË
;

	@partutil/partutil.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡ršg.h
>

29 
	~<sys/ty³s.h
>

30 
	~<uni¡d.h
>

31 
	~<sys/¡©.h
>

32 
	~<fú.h
>

33 
	~<sys/time.h
>

34 
	~<”ºo.h
>

35 
	~<sys/ioùl.h
>

36 
	~<ùy³.h
>

38 
	~<lšux/hd»g.h
>

40 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
)

	)

42 
	~"../h®d/logg”.h
"

43 
	~"·¹ut.h
"

47 #ifdeà
USE_PARTED


48 
	~<·¹ed/·¹ed.h
>

52 
	$·¹_g‘_scheme_Çme
 (
P¬t™iÚScheme
 
scheme
)

54 cÚ¡ *
s
;

56 
scheme
) {

57 
PART_TYPE_GPT
:

58 
s
 = "gpt";

60 
PART_TYPE_MSDOS
:

61 
s
 = "mbr";

63 
PART_TYPE_MSDOS_EXTENDED
:

64 
s
 = "embr";

66 
PART_TYPE_APPLE
:

67 
s
 = "apm";

70 
s
 = 
NULL
;

74  
s
;

75 
	}
}

77 
	gP¬t™iÚEÁry_s
;

78 
P¬t™iÚEÁry_s
 
	tP¬t™iÚEÁry
;

80 
	sP¬t™iÚEÁry_s


82 
gboŞ—n
 
	mis_·¹_bË
;

85 
P¬t™iÚTabË
 *
	m·¹_bË
;

88 
gušt8
 *
	md©a
;

89 
	mËngth
;

92 
gušt64
 
	moff£t
;

95 
	sP¬t™iÚTabË_s


98 
P¬t™iÚScheme
 
	mscheme
;

101 
gušt64
 
	moff£t
;

102 
gušt64
 
	msize
;

105 
GSLi¡
 *
	m’Œ›s
;

109 
	$·¹_bË_fšd
 (
P¬t™iÚTabË
 *
p
, 
gušt64
 
off£t
,

110 
P¬t™iÚTabË
 **
out_·¹_bË
, *
out_’Œy
)

112 
n
;

113 
num_’Œ›s
;

115 *
out_·¹_bË
 = 
p
;

116 *
out_’Œy
 = -1;

118 
num_’Œ›s
 = 
	`·¹_bË_g‘_num_’Œ›s
 (
p
);

119 
n
 = 0;‚ < 
num_’Œ›s
;‚++) {

120 
gušt64
 
³_off£t
;

121 
gušt64
 
³_size
;

123 
³_off£t
 = 
	`·¹_bË_’Œy_g‘_off£t
 (
p
, 
n
);

124 
³_size
 = 
	`·¹_bË_’Œy_g‘_size
 (
p
, 
n
);

126 ià((
off£t
 >ğ
³_off£t
è&& (off£ˆ<…e_off£ˆ+ 
³_size
)) {

127 
P¬t™iÚTabË
 *
·¹_bË_Ã¡ed
;

129 
·¹_bË_Ã¡ed
 = 
	`·¹_bË_’Œy_g‘_Ã¡ed
 (
p
, 
n
);

133 ià(
·¹_bË_Ã¡ed
 !ğ
NULL
 && 
off£t
 > 
³_off£t
) {

134 
	`·¹_bË_fšd
 (
·¹_bË_Ã¡ed
, 
off£t
, 
out_·¹_bË
, 
out_’Œy
);

136 *
out_’Œy
 = 
n
;

143 
	}
}

146 
gušt16


147 
	$g‘_Ë16
 (cÚ¡ *
buf
)

149 
gušt16
 
i
;

151 
	`memıy
 (&
i
, 
buf
,  (i));

152  
	`GUINT16_FROM_LE
 (
i
);

153 
	}
}

156 
gušt32


157 
	$g‘_Ë32
 (cÚ¡ *
buf
)

159 
gušt32
 
i
;

161 
	`memıy
 (&
i
, 
buf
,  (i));

162  
	`GUINT32_FROM_LE
 (
i
);

163 
	}
}

165 
gušt64


166 
	$g‘_Ë64
 (cÚ¡ *
buf
)

168 
gušt64
 
i
;

170 
	`memıy
 (&
i
, 
buf
,  (i));

171  
	`GUINT64_FROM_LE
 (
i
);

172 
	}
}

175 
gušt32


176 
	$g‘_be32
 (cÚ¡ *
buf
)

178 
gušt32
 
i
;

180 
	`memıy
 (&
i
, 
buf
,  (i));

181  
	`GUINT32_FROM_BE
 (
i
);

182 
	}
}

214 
	sefi_guid_s
 {

215 
gušt32
 
	md©a1
;

216 
gušt16
 
	md©a2
;

217 
gušt16
 
	md©a3
;

218 
gušt8
 
	md©a4
[8];

219 } 
	t__©Œibu‹__
 ((
	t·cked
)è
	tefi_guid
;

222 
	$g‘_Ë_guid
 (cÚ¡ 
gušt8
 *
buf
)

224 
efi_guid
 *
guid
 = (efi_guid *è
buf
;

226  
	`g_¡rdup_´štf
("%08X-%04X-%04X-%02X%02X-%02X%02X%02X%02X%02X%02X",

227 
	`g‘_Ë32
 (&(
guid
->
d©a1
)),

228 
	`g‘_Ë16
 (&(
guid
->
d©a2
)),

229 
	`g‘_Ë16
 (&(
guid
->
d©a3
)),

230 
guid
->
d©a4
[0],

231 
guid
->
d©a4
[1],

232 
guid
->
d©a4
[2],

233 
guid
->
d©a4
[3],

234 
guid
->
d©a4
[4],

235 
guid
->
d©a4
[5],

236 
guid
->
d©a4
[6],

237 
guid
->
d©a4
[7]);

238 
	}
}

240 #ifdeà
USE_PARTED


241 
gboŞ—n


242 
	$£t_Ë_guid
 (
gušt8
 *
buf
, cÚ¡ *
sourû
)

244 
efi_guid
 *
guid
 = (efi_guid *è
buf
;

245 
gušt32
 
	`__©Œibu‹__
((
__unu£d__
)è
d©a1
;

246 
gušt16
 
	`__©Œibu‹__
((
__unu£d__
)è
d©a2
;

247 
gušt16
 
	`__©Œibu‹__
((
__unu£d__
)è
d©a3
;

248 
gušt8
 
	`__©Œibu‹__
((
__unu£d__
)è
d©a4
[8];

249 
gboŞ—n
 
»t
;

250 
n
;

252 
n
 = 
	`ssÿnf
 (
sourû
, "%x-%hx-%hx-%02hhx%02hhx-%02hhx%02hhx%02hhx%02hhx%02hhx%02hhx",

253 &
guid
->
d©a1
,

254 &
guid
->
d©a2
,

255 &
guid
->
d©a3
,

256 &(
guid
->
d©a4
[0]),

257 &(
guid
->
d©a4
[1]),

258 &(
guid
->
d©a4
[2]),

259 &(
guid
->
d©a4
[3]),

260 &(
guid
->
d©a4
[4]),

261 &(
guid
->
d©a4
[5]),

262 &(
guid
->
d©a4
[6]),

263 &(
guid
->
d©a4
[7]));

265 ià(
n
 != 11) {

266 
	`HAL_INFO
 (("guid '%s' is‚ot valid"));

267 
out
;

271 
	`HAL_INFO
 (("sourû = %s", 
sourû
));

272 
	`HAL_INFO
 (("d©a1 = %08x", 
guid
->
d©a1
));

273 
	`HAL_INFO
 (("d©a2 = %04x", 
guid
->
d©a2
));

274 
	`HAL_INFO
 (("d©a3 = %04x", 
guid
->
d©a3
));

275 
	`HAL_INFO
 (("d©a4[0] = %02x", 
guid
->
d©a4
[0]));

276 
	`HAL_INFO
 (("d©a4[1] = %02x", 
guid
->
d©a4
[1]));

277 
	`HAL_INFO
 (("d©a4[2] = %02x", 
guid
->
d©a4
[2]));

278 
	`HAL_INFO
 (("d©a4[3] = %02x", 
guid
->
d©a4
[3]));

279 
	`HAL_INFO
 (("d©a4[4] = %02x", 
guid
->
d©a4
[4]));

280 
	`HAL_INFO
 (("d©a4[5] = %02x", 
guid
->
d©a4
[5]));

281 
	`HAL_INFO
 (("d©a4[6] = %02x", 
guid
->
d©a4
[6]));

282 
	`HAL_INFO
 (("d©a4[7] = %02x", 
guid
->
d©a4
[7]));

285 
guid
->
d©a1
 = 
	`GUINT32_TO_LE
 (guid->data1);

286 
guid
->
d©a2
 = 
	`GUINT16_TO_LE
 (guid->data2);

287 
guid
->
d©a3
 = 
	`GUINT16_TO_LE
 (guid->data3);

289 
»t
 = 
TRUE
;

291 
out
:

292  
»t
;

293 
	}
}

296 
P¬t™iÚEÁry
 *

297 
	$·¹_’Œy_Ãw
 (
P¬t™iÚTabË
 *
e_·¹_bË
, cÚ¡ 
gušt8
 *
d©a
, 
Ëngth
, 
gušt64
 
off£t
)

299 
P¬t™iÚEÁry
 *
³
;

301 
³
 = 
	`g_Ãw0
 (
P¬t™iÚEÁry
, 1);

302 
³
->
is_·¹_bË
 = (
e_·¹_bË
 !ğ
NULL
);

303 
³
->
·¹_bË
 = 
e_·¹_bË
;

304 
³
->
off£t
 = offset;

305 
³
->
Ëngth
 =†ength;

306 
³
->
d©a
 = 
	`g_Ãw0
 (
gušt8
, 
Ëngth
);

307 
	`memıy
 (
³
->
d©a
, d©a, 
Ëngth
);

309  
³
;

310 
	}
}

313 
	$·¹_’Œy_ä“
 (
P¬t™iÚEÁry
 *
³
)

315 ià(
³
->
·¹_bË
 !ğ
NULL
) {

316 
	`·¹_bË_ä“
 (
³
->
·¹_bË
);

318 
	`g_ä“
 (
³
->
d©a
);

319 
	`g_ä“
 (
³
);

320 
	}
}

322 
P¬t™iÚTabË
 *

323 
	$·¹_bË_Ãw_em±y
 (
P¬t™iÚScheme
 
scheme
)

325 
P¬t™iÚTabË
 *
p
;

327 
p
 = 
	`g_Ãw0
 (
P¬t™iÚTabË
, 1);

328 
p
->
scheme
 = scheme;

329 
p
->
off£t
 = 0;

330 
p
->
’Œ›s
 = 
NULL
;

332  
p
;

333 
	}
}

336 
	$·¹_bË_ä“
 (
P¬t™iÚTabË
 *
p
)

338 
GSLi¡
 *
i
;

340 ià(
p
 =ğ
NULL
)

343 
i
 = 
p
->
’Œ›s
; i !ğ
NULL
; i = i->
Ãxt
) {

344 
P¬t™iÚEÁry
 *
³
 = 
i
->
d©a
;

345 
	`·¹_’Œy_ä“
 (
³
);

347 
	`g_¦i¡_ä“
 (
p
->
’Œ›s
);

348 
	`g_ä“
 (
p
);

349 
	}
}

352 
P¬t™iÚTabË
 *

353 
	$·¹_bË_·r£_bsd
 (
fd
, 
gušt64
 
off£t
, gušt64 
size
)

355 
P¬t™iÚTabË
 *
p
;

357 
p
 = 
NULL
;

361  
p
;

362 
	}
}

366 
	#MSDOS_MAGIC
 "\x55\x¯"

	)

367 
	#MSDOS_PARTTABLE_OFFSET
 0x1be

	)

368 
	#MSDOS_SIG_OFF
 0x1ã

	)

372 
	$hexdump
 (cÚ¡ 
gušt8
 *
mem
, 
size
)

374 
i
;

375 
j
;

376 
n
;

377 cÚ¡ 
gušt8
 *
buf
 = (cÚ¡ gušt8 *è
mem
;

379 
n
 = 0;

380 
	`´štf
 ("Dumpšg %d=0x%x by‹s\n", 
size
, size);

381 
n
 < 
size
) {

383 
	`´štf
 ("0x%04x: ", 
n
);

385 
j
 = 
n
;

386 
i
 = 0; i < 16; i++) {

387 ià(
j
 >ğ
size
)

389 
	`´štf
 ("%02x ", 
buf
[
j
]);

390 
j
++;

393  ; 
i
 < 16; i++) {

394 
	`´štf
 (" ");

397 
	`´štf
 (" ");

399 
j
 = 
n
;

400 
i
 = 0; i < 16; i++) {

401 ià(
j
 >ğ
size
)

403 
	`´štf
 ("%c", 
	`i¥ršt
(
buf
[
j
]) ? buf[j] : '.');

404 
j
++;

407 
	`´štf
 ("\n");

409 
n
 += 16;

411 
	}
}

414 
P¬t™iÚTabË
 *

415 
	$·¹_bË_·r£_msdos_ex‹nded
 (
fd
, 
gušt64
 
off£t
, gušt64 
size
)

417 
n
;

418 
P¬t™iÚTabË
 *
p
;

419 
gušt64
 
Ãxt
;

423 
p
 = 
NULL
;

425 
Ãxt
 = 
off£t
;

427 
Ãxt
 != 0) {

428 
gušt64
 
»adäom
;

429 cÚ¡ 
gušt8
 
embr
[512];

431 
»adäom
 = 
Ãxt
;

432 
Ãxt
 = 0;

436 ià(
	`l£ek
 (
fd
, 
»adäom
, 
SEEK_SET
) < 0) {

437 
	`HAL_INFO
 (("l£ek faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

438 
out
;

440 ià(
	`»ad
 (
fd
, &
embr
,  (embr)) !=  (embr)) {

441 
	`HAL_INFO
 (("»ad faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

442 
out
;

445 ià(
	`memcmp
 (&
embr
[
MSDOS_SIG_OFF
], 
MSDOS_MAGIC
, 2) != 0) {

446 
	`HAL_INFO
 (("No MSDOS_MAGIC found"));

447 
out
;

452 ià(
p
 =ğ
NULL
) {

453 
p
 = 
	`·¹_bË_Ãw_em±y
 (
PART_TYPE_MSDOS_EXTENDED
);

454 
p
->
off£t
 = offset;

455 
p
->
size
 = size;

459 
n
 = 0;‚ < 2;‚++) {

460 
P¬t™iÚEÁry
 *
³
;

461 
gušt64
 
p¡¬t
;

462 
gušt64
 
psize
;

464 
p¡¬t
 = 0x200 * ((
gušt64
è
	`g‘_Ë32
 (&(
embr
[
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16 + 8])));

465 
psize
 = 0x200 * ((
gušt64
è
	`g‘_Ë32
 (&(
embr
[
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16 + 12])));

467 ià(
psize
 == 0)

470 
³
 = 
NULL
;

472 ià(
n
 == 0) {

480 
³
 = 
	`·¹_’Œy_Ãw
 (
NULL
,

481 &(
embr
[
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16]),

483 
»adäom
 + 
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16);

485 ià(
p¡¬t
 != 0) {

487 
Ãxt
 = 
off£t
 + 
p¡¬t
;

493 ià(
³
 !ğ
NULL
) {

494 
p
->
’Œ›s
 = 
	`g_¦i¡_­³nd
 (p->’Œ›s, 
³
);

500 
out
:

502  
p
;

503 
	}
}

505 
P¬t™iÚTabË
 *

506 
	$·¹_bË_·r£_msdos
 (
fd
, 
gušt64
 
off£t
, gušt64 
size
, 
gboŞ—n
 *
found_g±
)

508 
n
;

509 cÚ¡ 
gušt8
 
mbr
[512] 
	`__©Œibu‹__
 ((
®igÃd
));

510 
P¬t™iÚTabË
 *
p
;

514 *
found_g±
 = 
FALSE
;

516 
p
 = 
NULL
;

518 ià(
	`l£ek
 (
fd
, 
off£t
, 
SEEK_SET
) < 0) {

519 
	`HAL_INFO
 (("l£ek faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

520 
out
;

522 ià(
	`»ad
 (
fd
, &
mbr
,  (mbr)) !=  (mbr)) {

523 
	`HAL_INFO
 (("»ad faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

524 
out
;

527 ià(
	`memcmp
 (&
mbr
[
MSDOS_SIG_OFF
], 
MSDOS_MAGIC
, 2) != 0) {

528 
	`HAL_INFO
 (("No MSDOS_MAGIC found"));

529 
out
;

535 
n
 = 0;‚ < 4;‚++) {

536 ià(
mbr
[
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16 + 0] != 0 &&

537 
mbr
[
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16 + 0] != 0x80) {

538 
	`HAL_INFO
 (("·¹™iÚšg fÏg fÜ…¬ˆ%d i nÙ 0x00 o¸0x80", 
n
));

539 
out
;

542 ià(
mbr
[
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16 + 4] == 0xee) {

543 
	`HAL_INFO
 (("found…¬t™iÚy³ 0x“ =>…rÙeùivMBR fÜ GPT", 
n
));

544 *
found_g±
 = 
TRUE
;

545 
out
;

549 
p
 = 
	`·¹_bË_Ãw_em±y
 (
PART_TYPE_MSDOS
);

550 
p
->
off£t
 = offset;

551 
p
->
size
 = size;

554 
n
 = 0;‚ < 4;‚++) {

555 
P¬t™iÚEÁry
 *
³
;

556 
gušt64
 
p¡¬t
;

557 
gušt64
 
psize
;

558 
gušt8
 
±y³
;

559 
P¬t™iÚTabË
 *
e_·¹_bË
;

561 
p¡¬t
 = 0x200 * ((
gušt64
è
	`g‘_Ë32
 (&(
mbr
[
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16 + 8])));

562 
psize
 = 0x200 * ((
gušt64
è
	`g‘_Ë32
 (&(
mbr
[
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16 + 12])));

563 
±y³
 = 
mbr
[
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16 + 4];

567 
³
 = 
NULL
;

568 
e_·¹_bË
 = 
NULL
;

571 
±y³
) {

577 
e_·¹_bË
 = 
	`·¹_bË_·r£_msdos_ex‹nded
 (
fd
, 
p¡¬t
, 
psize
);

578 ià(
e_·¹_bË
 !ğ
NULL
) {

579 
³
 = 
	`·¹_’Œy_Ãw
 (
e_·¹_bË
,

580 &(
mbr
[
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16]),

582 
off£t
 + 
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16);

594 
³
 = 
	`·¹_’Œy_Ãw
 (
NULL
,

595 &(
mbr
[
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16]),

597 
off£t
 + 
MSDOS_PARTTABLE_OFFSET
 + 
n
 * 16);

603 ià(
³
 !ğ
NULL
) {

604 
p
->
’Œ›s
 = 
	`g_¦i¡_­³nd
 (p->’Œ›s, 
³
);

608 
out
:

610  
p
;

611 
	}
}

613 
	#GPT_MAGIC
 "EFI PART"

	)

615 
	#GPT_PART_TYPE_GUID_EMPTY
 "00000000-0000-0000-0000-000000000000"

	)

617 
P¬t™iÚTabË
 *

618 
	$·¹_bË_·r£_g±
 (
fd
, 
gušt64
 
off£t
, gušt64 
size
)

620 
n
;

621 
P¬t™iÚTabË
 *
p
;

622 
gušt8
 
buf
[16];

623 
gušt64
 
·¹™iÚ_’Œy_lba
;

624 
num_’Œ›s
;

625 
size_of_’Œy
;

627 
	`HAL_INFO
 (("Entering EFI GPT…arser"));

631 
p
 = 
NULL
;

634 ià(
	`l£ek
 (
fd
, 
off£t
 + 512 + 0, 
SEEK_SET
) < 0) {

635 
	`HAL_INFO
 (("l£ek faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

636 
out
;

638 ià(
	`»ad
 (
fd
, 
buf
, 8) != 8) {

639 
	`HAL_INFO
 (("»ad faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

640 
out
;

642 ià(
	`memcmp
 (
buf
, 
GPT_MAGIC
, 8) != 0) {

643 
	`HAL_INFO
 (("No GPT_MAGIC found"));

644 
out
;

647 
	`HAL_INFO
 (("GPT magic found"));

650 ià(
	`l£ek
 (
fd
, 
off£t
 + 512 + 56, 
SEEK_SET
) < 0) {

651 
	`HAL_INFO
 (("l£ek faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

652 
out
;

654 ià(
	`»ad
 (
fd
, 
buf
, 16) != 16) {

655 
	`HAL_INFO
 (("»ad faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

656 
out
;

660 ià(
	`l£ek
 (
fd
, 
off£t
 + 512 + 72, 
SEEK_SET
) < 0) {

661 
	`HAL_INFO
 (("l£ek faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

662 
out
;

664 ià(
	`»ad
 (
fd
, 
buf
, 8) != 8) {

665 
	`HAL_INFO
 (("»ad faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

666 
out
;

668 
·¹™iÚ_’Œy_lba
 = 
	`g‘_Ë64
 (
buf
);

670 ià(
	`l£ek
 (
fd
, 
off£t
 + 512 + 80, 
SEEK_SET
) < 0) {

671 
	`HAL_INFO
 (("l£ek faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

672 
out
;

674 ià(
	`»ad
 (
fd
, 
buf
, 4) != 4) {

675 
	`HAL_INFO
 (("»ad faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

676 
out
;

678 
num_’Œ›s
 = 
	`g‘_Ë32
 (
buf
);

680 ià(
	`l£ek
 (
fd
, 
off£t
 + 512 + 84, 
SEEK_SET
) < 0) {

681 
	`HAL_INFO
 (("l£ek faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

682 
out
;

684 ià(
	`»ad
 (
fd
, 
buf
, 4) != 4) {

685 
	`HAL_INFO
 (("»ad faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

686 
out
;

688 
size_of_’Œy
 = 
	`g‘_Ë32
(
buf
);

691 
p
 = 
	`·¹_bË_Ãw_em±y
 (
PART_TYPE_GPT
);

692 
p
->
off£t
 = offset;

693 
p
->
size
 = size;

695 
	`HAL_INFO
 (("·¹™iÚ_’Œy_lba=%d", 
·¹™iÚ_’Œy_lba
));

696 
	`HAL_INFO
 (("num_’Œ›s=%d", 
num_’Œ›s
));

697 
	`HAL_INFO
 (("size_of_’Œy=%d", 
size_of_’Œy
));

699 
n
 = 0;‚ < 
num_’Œ›s
;‚++) {

700 
P¬t™iÚEÁry
 *
³
;

702 
gušt8
 
·¹™iÚ_ty³_guid
[16];

703 
gušt8
 
·¹™iÚ_guid
[16];

704 
gušt8
 
¡¬tšg_lba
[8];

705 
gušt8
 
’dšg_lba
[8];

706 
gušt8
 
©Œibu‹s
[8];

707 
gušt8
 
·¹™iÚ_Çme
[72];

708 } 
g±_·¹_’Œy
;

709 *
·¹™iÚ_ty³_guid
;

711 ià(
	`l£ek
 (
fd
, 
off£t
 + 
·¹™iÚ_’Œy_lba
 * 512 + 
n
 * 
size_of_’Œy
, 
SEEK_SET
) < 0) {

712 
	`HAL_INFO
 (("l£ek faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

713 
out
;

715 ià(
	`»ad
 (
fd
, &
g±_·¹_’Œy
, 128) != 128) {

716 
	`HAL_INFO
 (("»ad faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

717 
out
;

720 
·¹™iÚ_ty³_guid
 = 
	`g‘_Ë_guid
 (
g±_·¹_’Œy
.partition_type_guid);

722 ià(
	`¡rcmp
 (
·¹™iÚ_ty³_guid
, 
GPT_PART_TYPE_GUID_EMPTY
) == 0) {

723 
	`g_ä“
 (
·¹™iÚ_ty³_guid
);

727 
³
 = 
	`·¹_’Œy_Ãw
 (
NULL
,

728 (
gušt8
*è&
g±_·¹_’Œy
,

730 
off£t
 + 
·¹™iÚ_’Œy_lba
 * 512 + 
n
 * 
size_of_’Œy
);

731 
p
->
’Œ›s
 = 
	`g_¦i¡_­³nd
 (p->’Œ›s, 
³
);

733 
	`g_ä“
 (
·¹™iÚ_ty³_guid
);

740 
out
:

741 
	`HAL_INFO
 (("Leaving EFI GPT…arser"));

742  
p
;

743 
	}
}

745 
	#MAC_MAGIC
 "ER"

	)

746 
	#MAC_PART_MAGIC
 "PM"

	)

748 
P¬t™iÚTabË
 *

749 
	$·¹_bË_·r£_­¶e
 (
fd
, 
gušt64
 
off£t
, gušt64 
size
)

751 
n
;

752 
P¬t™iÚTabË
 *
p
;

754 
gušt16
 
sigÇtu»
;

755 
gušt16
 
block_size
;

756 
gušt32
 
block_couÁ
;

758 } 
	`__©Œibu‹__
 ((
·cked
)è
mac_h—d”
;

760 
gušt16
 
sigÇtu»
;

761 
gušt16
 
»s1
;

762 
gušt32
 
m­_couÁ
;

763 
gušt32
 
¡¬t_block
;

764 
gušt32
 
block_couÁ
;

765 
Çme
[32];

766 
ty³
[32];

767 
gušt32
 
d©a_¡¬t
;

768 
gušt32
 
d©a_couÁ
;

769 
gušt32
 
¡©us
;

770 
gušt32
 
boÙ_¡¬t
;

771 
gušt32
 
boÙ_size
;

772 
gušt32
 
boÙ_lßd
;

773 
gušt32
 
boÙ_lßd2
;

774 
gušt32
 
boÙ_’Œy
;

775 
gušt32
 
boÙ_’Œy2
;

776 
gušt32
 
boÙ_cksum
;

777 
´oûssÜ
[16];

779 } 
	`__©Œibu‹__
 ((
·cked
)è
mac_·¹
;

780 
block_size
;

781 
m­_couÁ
;

783 
	`HAL_INFO
 (("Entering Apple…arser"));

785 
p
 = 
NULL
;

788 ià(
	`l£ek
 (
fd
, 
off£t
 + 0, 
SEEK_SET
) < 0) {

789 
	`HAL_INFO
 (("l£ek faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

790 
out
;

792 ià(
	`»ad
 (
fd
, &
mac_h—d”
,  (mac_header)) !=  (mac_header)) {

793 
	`HAL_INFO
 (("»ad faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

794 
out
;

796 ià(
	`memcmp
 (&(
mac_h—d”
.
sigÇtu»
), 
MAC_MAGIC
, 2) != 0) {

797 
	`HAL_INFO
 (("No MAC_MAGIC found"));

798 
out
;

801 
block_size
 = 
	`GUINT16_FROM_BE
 (
mac_h—d”
.block_size);

803 
	`HAL_INFO
 (("MaøMAGIC found, block_size=%d", 
block_size
));

805 
p
 = 
	`·¹_bË_Ãw_em±y
 (
PART_TYPE_APPLE
);

806 
p
->
off£t
 = offset;

807 
p
->
size
 = size;

810 ià(
	`l£ek
 (
fd
, 
off£t
 + 
block_size
, 
SEEK_SET
) < 0) {

811 
	`HAL_INFO
 (("l£ek faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

812 
out
;

814 ià(
	`»ad
 (
fd
, &
mac_·¹
,  (mac_part)) !=  (mac_part)) {

815 
	`HAL_INFO
 (("»ad faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

816 
out
;

818 
m­_couÁ
 = 
	`GUINT32_FROM_BE
 (
mac_·¹
.map_count);

820 
	`HAL_INFO
 (("m­_couÁ = %d", 
m­_couÁ
));

822 
n
 = 0;‚ < 
m­_couÁ
;‚++) {

823 
P¬t™iÚEÁry
 *
³
;

825 ià(
	`memcmp
 (&(
mac_·¹
.
sigÇtu»
), 
MAC_PART_MAGIC
, 2) != 0) {

826 
	`HAL_INFO
 (("No MAC_PART_MAGIC found"));

830 ià(
	`l£ek
 (
fd
, 
off£t
 + (
n
 + 1è* 
block_size
, 
SEEK_SET
) < 0) {

831 
	`HAL_INFO
 (("l£ek faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

832 
out
;

834 ià(
	`»ad
 (
fd
, &
mac_·¹
,  (mac_part)) !=  (mac_part)) {

835 
	`HAL_INFO
 (("»ad faed (%s)", 
	`¡»¼Ü
 (
”ºo
)));

836 
out
;

839 
³
 = 
	`·¹_’Œy_Ãw
 (
NULL
,

840 (
gušt8
*è&
mac_·¹
,

841  (
mac_·¹
),

842 
off£t
 + (
n
 + 1è* 
block_size
);

843 
p
->
’Œ›s
 = 
	`g_¦i¡_­³nd
 (p->’Œ›s, 
³
);

847 
out
:

848 
	`HAL_INFO
 (("Leaving Apple…arser"));

849  
p
;

850 
	}
}

852 
P¬t™iÚTabË
 *

853 
	$·¹_bË_lßd_äom_disk
 (*
deviû
)

855 
fd
;

856 
gušt64
 
size
;

857 
P¬t™iÚTabË
 *
p
;

858 
gboŞ—n
 
found_g±
;

860 
p
 = 
NULL
;

862 
fd
 = 
	`İ’
 (
deviû
, 
O_RDONLY
);

863 ià(
fd
 < 0) {

864 
	`HAL_INFO
 (("CªnÙ o³Àdeviû %s", 
deviû
));

865 
out
;

868 ià(
	`ioùl
 (
fd
, 
BLKGETSIZE64
, &
size
) != 0) {

869 
	`HAL_INFO
 (("Cannot determine size of device"));

870 
out
;

873 
p
 = 
	`·¹_bË_·r£_msdos
 (
fd
, 0, 
size
, &
found_g±
);

874 ià(
p
 !ğ
NULL
) {

875 
	`HAL_INFO
 (("MSDOS…artitionable detected"));

876 
out
;

879 ià(
found_g±
) {

880 
p
 = 
	`·¹_bË_·r£_g±
 (
fd
, 0, 
size
);

881 ià(
p
 !ğ
NULL
) {

882 
	`HAL_INFO
 (("EFI GPT…artitionable detected"));

883 
out
;

887 
p
 = 
	`·¹_bË_·r£_­¶e
 (
fd
, 0, 
size
);

888 ià(
p
 !ğ
NULL
) {

889 
	`HAL_INFO
 (("Apple…artitionable detected"));

890 
out
;

893 
	`HAL_INFO
 (("No known…artitionable found"));

896 
out
:

897 ià(
fd
 >= 0)

898 
	`şo£
 (
fd
);

900  
p
;

901 
	}
}

905 
P¬t™iÚScheme


906 
	$·¹_bË_g‘_scheme
 (
P¬t™iÚTabË
 *
p
)

908  
p
->
scheme
;

909 
	}
}

912 
	$·¹_bË_g‘_num_’Œ›s
 (
P¬t™iÚTabË
 *
p
)

914  
	`g_¦i¡_Ëngth
 (
p
->
’Œ›s
);

915 
	}
}

917 
gušt64


918 
	$·¹_bË_g‘_off£t
 (
P¬t™iÚTabË
 *
p
)

920  
p
->
off£t
;

921 
	}
}

923 
gušt64


924 
	$·¹_bË_g‘_size
 (
P¬t™iÚTabË
 *
p
)

926  
p
->
size
;

927 
	}
}

929 
P¬t™iÚTabË
 *

930 
	$·¹_bË_’Œy_g‘_Ã¡ed
 (
P¬t™iÚTabË
 *
p
, 
’Œy
)

932 
P¬t™iÚEÁry
 *
³
;

934 ià(
p
 =ğ
NULL
)

935  
NULL
;

937 ià((
³
 = 
	`g_¦i¡_Áh_d©a
 (
p
->
’Œ›s
, 
’Œy
)è=ğ
NULL
)

938  
NULL
;

940 ià(
³
->
is_·¹_bË
)

941  
³
->
·¹_bË
;

943  
NULL
;

944 
	}
}

949 
	$·¹_bË_’Œy_g‘_ty³
 (
P¬t™iÚTabË
 *
p
, 
’Œy
)

951 *
s
 = 
NULL
;

952 
P¬t™iÚEÁry
 *
³
;

954 ià(
p
 =ğ
NULL
)

955 
out
;

957 ià((
³
 = 
	`g_¦i¡_Áh_d©a
 (
p
->
’Œ›s
, 
’Œy
)è=ğ
NULL
)

958 
out
;

960 
p
->
scheme
) {

961 
PART_TYPE_GPT
:

962 
s
 = 
	`g‘_Ë_guid
 (&(
³
->
d©a
[0]));

964 
PART_TYPE_MSDOS
:

965 
PART_TYPE_MSDOS_EXTENDED
:

966 
s
 = 
	`g_¡rdup_´štf
 ("0x%02x", 
³
->
d©a
[4]);

968 
PART_TYPE_APPLE
:

969 
s
 = 
	`g_¡rdup
 ((*è
³
->
d©a
 + 2*2 + 3*4 + 32);

970 
	`g_¡rchomp
 (
s
);

975 
out
:

976 ià(
s
 !ğ
NULL
) {

977 
	`g_¡rchomp
 (
s
);

979  
s
;

980 
	}
}

983 
	$·¹_bË_’Œy_g‘_uuid
 (
P¬t™iÚTabË
 *
p
, 
’Œy
)

985 *
s
 = 
NULL
;

986 
P¬t™iÚEÁry
 *
³
;

988 ià(
p
 =ğ
NULL
)

989 
out
;

991 ià((
³
 = 
	`g_¦i¡_Áh_d©a
 (
p
->
’Œ›s
, 
’Œy
)è=ğ
NULL
)

992 
out
;

994 
p
->
scheme
) {

995 
PART_TYPE_GPT
:

996 
s
 = 
	`g‘_Ë_guid
 (&(
³
->
d©a
[16]));

1001 
out
:

1002 ià(
s
 !ğ
NULL
) {

1003 
	`g_¡rchomp
 (
s
);

1005  
s
;

1006 
	}
}

1009 
	$·¹_bË_’Œy_g‘_Ïb–
 (
P¬t™iÚTabË
 *
p
, 
’Œy
)

1011 *
s
 = 
NULL
;

1012 
P¬t™iÚEÁry
 *
³
;

1014 ià(
p
 =ğ
NULL
)

1015 
out
;

1017 ià((
³
 = 
	`g_¦i¡_Áh_d©a
 (
p
->
’Œ›s
, 
’Œy
)è=ğ
NULL
)

1018 
out
;

1020 
p
->
scheme
) {

1021 
PART_TYPE_GPT
:

1022 
s
 = 
	`g_utf16_to_utf8
 ((cÚ¡ 
gunich¬2
 *è&(
³
->
d©a
[56]), 36, 
NULL
, NULL, NULL);

1024 
PART_TYPE_APPLE
:

1025 
s
 = 
	`g_¡rdup
 ((*è
³
->
d©a
 + 2*2 + 3*4);

1026 
	`g_¡rchomp
 (
s
);

1031 
out
:

1032 ià(
s
 !ğ
NULL
) {

1033 
	`g_¡rchomp
 (
s
);

1035  
s
;

1036 
	}
}

1039 
	$·¹_bË_’Œy_g‘_æags
 (
P¬t™iÚTabË
 *
p
, 
’Œy
)

1041 
n
;

1042 **
ss
 = 
NULL
;

1043 
gušt32
 
­m_¡©us
;

1044 
gušt64
 
g±_©Œibu‹s
;

1045 
P¬t™iÚEÁry
 *
³
;

1047 ià(
p
 =ğ
NULL
)

1048 
out
;

1050 ià((
³
 = 
	`g_¦i¡_Áh_d©a
 (
p
->
’Œ›s
, 
’Œy
)è=ğ
NULL
)

1051 
out
;

1053 
ss
 = 
	`g_Ãw0
 (*, 6 + 1);

1054 
ss
[0] = 
NULL
;

1055 
n
 = 0;

1057 
p
->
scheme
) {

1058 
PART_TYPE_GPT
:

1059 
g±_©Œibu‹s
 = 
	`g‘_Ë64
 (&(
³
->
d©a
[48]));

1073 ià(
g±_©Œibu‹s
 & (1<<0)) {

1074 
ss
[
n
++] = 
	`g_¡rdup
 ("required");

1088 
PART_TYPE_MSDOS
:

1089 
PART_TYPE_MSDOS_EXTENDED
:

1090 ià(
³
->
d©a
[0] == 0x80) {

1091 
ss
[
n
++] = 
	`g_¡rdup
 ("boot");

1095 
PART_TYPE_APPLE
:

1096 
­m_¡©us
 = 
	`g‘_be32
 (&(
³
->
d©a
[2*2 + 3*4 + 2*32 + 2*4]));

1097 ià(
­m_¡©us
&(1<<1))

1098 
ss
[
n
++] = 
	`g_¡rdup
 ("allocated");

1099 ià(
­m_¡©us
&(1<<2))

1100 
ss
[
n
++] = 
	`g_¡rdup
 ("in_use");

1101 ià(
­m_¡©us
&(1<<3))

1102 
ss
[
n
++] = 
	`g_¡rdup
 ("boot");

1103 ià(
­m_¡©us
&(1<<4))

1104 
ss
[
n
++] = 
	`g_¡rdup
 ("allow_read");

1105 ià(
­m_¡©us
&(1<<5))

1106 
ss
[
n
++] = 
	`g_¡rdup
 ("allow_write");

1107 ià(
­m_¡©us
&(1<<6))

1108 
ss
[
n
++] = 
	`g_¡rdup
 ("boot_code_is_pic");

1113 
ss
[
n
] = 
NULL
;

1115 
out
:

1116  
ss
;

1117 
	}
}

1119 
gušt64


1120 
	$·¹_bË_’Œy_g‘_off£t
 (
P¬t™iÚTabË
 *
p
, 
’Œy
)

1122 
gušt64
 
v®
;

1123 
P¬t™iÚEÁry
 *
³
;

1125 
v®
 = 
G_MAXUINT64
;

1126 ià(
p
 =ğ
NULL
)

1127 
out
;

1129 ià((
³
 = 
	`g_¦i¡_Áh_d©a
 (
p
->
’Œ›s
, 
’Œy
)è=ğ
NULL
)

1130 
out
;

1132 
p
->
scheme
) {

1133 
PART_TYPE_GPT
:

1134 
v®
 = 0x200 * ((
gušt64
è
	`g‘_Ë64
 (
³
->
d©a
 + 32));

1137 
PART_TYPE_MSDOS
:

1138 
v®
 = 0x200 * ((
gušt64
è
	`g‘_Ë32
 (
³
->
d©a
 + 8));

1140 
PART_TYPE_MSDOS_EXTENDED
:

1145 
v®
 = 0x200 * ((
gušt64
è
	`g‘_Ë32
 (
³
->
d©a
 + 8)è+…e->
off£t
 - 
MSDOS_PARTTABLE_OFFSET
;

1147 
PART_TYPE_APPLE
:

1148 
v®
 = 0x200 * ((
gušt64
è
	`g‘_be32
 (
³
->
d©a
 + 2*2 + 1*4));

1153 
out
:

1154  
v®
;

1155 
	}
}

1157 
gušt64


1158 
	$·¹_bË_’Œy_g‘_size
 (
P¬t™iÚTabË
 *
p
, 
’Œy
)

1160 
gušt64
 
v®
;

1161 
P¬t™iÚEÁry
 *
³
;

1163 
v®
 = 
G_MAXUINT64
;

1164 ià(
p
 =ğ
NULL
)

1165 
out
;

1167 ià((
³
 = 
	`g_¦i¡_Áh_d©a
 (
p
->
’Œ›s
, 
’Œy
)è=ğ
NULL
)

1168 
out
;

1170 
p
->
scheme
) {

1171 
PART_TYPE_GPT
:

1172 
v®
 = 0x200 * (((
gušt64
è
	`g‘_Ë64
 (
³
->
d©a
 + 40)) - ((guint64) get_le64 (pe->data + 32)) + 1);

1174 
PART_TYPE_MSDOS
:

1175 
PART_TYPE_MSDOS_EXTENDED
:

1176 
v®
 = 0x200 * ((
gušt64
è
	`g‘_Ë32
 (
³
->
d©a
 + 12));

1178 
PART_TYPE_APPLE
:

1179 
v®
 = 0x200 * ((
gušt64
è
	`g‘_be32
 (
³
->
d©a
 + 2*2 + 2*4));

1184 
out
:

1185  
v®
;

1186 
	}
}

1190 #ifdeà
USE_PARTED


1196 
gboŞ—n


1197 
	$·¹_add_chªge_·¹™iÚ
 (*
deviû_fe
,

1198 
gušt64
 
¡¬t
, gušt64 
size
,

1199 
gušt64
 
Ãw_¡¬t
, gušt64 
Ãw_size
,

1200 
gušt64
 *
out_¡¬t
, gušt64 *
out_size
,

1201 *
ty³
, *
Ïb–
, **
æags
,

1202 
geom‘ry_hps
, 
geom‘ry_¥t
)

1204 
n
;

1205 
gboŞ—n
 
is_chªge
;

1206 
gboŞ—n
 
»s
;

1207 
PedDeviû
 *
deviû
;

1208 
PedDisk
 *
disk
;

1209 
PedP¬t™iÚ
 *
·¹
;

1210 
PedCÚ¡¿št
* 
cÚ¡¿št
;

1211 
PedP¬t™iÚTy³
 
³d_ty³
;

1212 
gušt64
 
¡¬t_£ùÜ
;

1213 
gušt64
 
’d_£ùÜ
;

1214 
gušt64
 
Ãw_¡¬t_£ùÜ
;

1215 
gušt64
 
Ãw_’d_£ùÜ
;

1216 
P¬t™iÚTabË
 *
p
;

1217 
P¬t™iÚTabË
 *
cÚš”_p
;

1218 
cÚš”_’Œy
;

1219 
P¬t™iÚScheme
 
scheme
;

1220 
gušt8
 
mbr_æags
 = 0;

1221 
gušt8
 
mbr_·¹_ty³
 = 0;

1222 *
’dp
;

1223 
gušt64
 
g±_©Œibu‹s
 = 0;

1224 
gušt32
 
­m_¡©us
 = 0;

1226 
»s
 = 
FALSE
;

1228 
is_chªge
 = 
FALSE
;

1229 ià(
size
 == 0) {

1230 
is_chªge
 = 
TRUE
;

1233 ià(
is_chªge
) {

1234 
	`HAL_INFO
 (("IÀ·¹_chªge_·¹™iÚ: deviû_fe=%s, s¹=%Îd,‚ew_¡¬t=%Îd,‚ew_size=%Îd,y³=%s", 
deviû_fe
, 
¡¬t
, 
Ãw_¡¬t
, 
Ãw_size
, 
ty³
));

1236 
	`HAL_INFO
 (("IÀ·¹_add_·¹™iÚ: deviû_fe=%s, s¹=%Îd, size=%Îd,y³=%s", 
deviû_fe
, 
¡¬t
, 
size
, 
ty³
));

1240 
p
 = 
	`·¹_bË_lßd_äom_disk
 (
deviû_fe
);

1241 ià(
p
 =ğ
NULL
) {

1242 
	`HAL_INFO
 (("CªnÙ†ßd…¬t™iÚabË from %s", 
deviû_fe
));

1243 
out
;

1246 
	`·¹_bË_fšd
 (
p
, 
¡¬t
 + 512, &
cÚš”_p
, &
cÚš”_’Œy
);

1247 
scheme
 = 
	`·¹_bË_g‘_scheme
 (
cÚš”_p
);

1249 ià(
is_chªge
) {

1251 ià(
cÚš”_’Œy
 < 0) {

1252 
	`HAL_INFO
 (("Couldn't find…artitiono change"));

1253 
out
;

1257 ià(
cÚš”_’Œy
 >= 0) {

1258 *
·¹_ty³
;

1261 
·¹_ty³
 = 
	`·¹_bË_’Œy_g‘_ty³
 (
p
, 
cÚš”_’Œy
);

1262 ià(! (
p
->
scheme
 =ğ
PART_TYPE_APPLE
 && 
·¹_ty³
 !ğ
NULL
 && (
	`¡rcmp
 (part_type, "Apple_Free") == 0))) {

1263 
	`·¹_bË_ä“
 (
p
);

1264 
	`HAL_INFO
 (("Th”i ¨·¹™iÚ iÀthway oÀ%s", 
deviû_fe
));

1265 
out
;

1270 
	`HAL_INFO
 (("cÚššg…¬t™iÚabË schemğ%d", 
scheme
));

1272 
	`·¹_bË_ä“
 (
p
);

1273 
p
 = 
NULL
;

1275 ià(!
is_chªge
) {

1276 ià(
ty³
 =ğ
NULL
) {

1277 
	`HAL_INFO
 (("Noype specified"));

1278 
out
;

1283 
scheme
) {

1284 
PART_TYPE_MSDOS
:

1285 
PART_TYPE_MSDOS_EXTENDED
:

1286 
mbr_æags
 = 0;

1287 ià(
æags
 !ğ
NULL
) {

1288 
n
 = 0; 
æags
[n] !ğ
NULL
;‚++) {

1289 ià(
	`¡rcmp
 (
æags
[
n
], "boot") == 0) {

1290 
mbr_æags
 |= 0x80;

1292 
	`HAL_INFO
 (("unknowÀæag '%s'", 
æags
[
n
]));

1293 
out
;

1298 ià(
ty³
 !ğ
NULL
) {

1299 
mbr_·¹_ty³
 = (
gušt8
è(
	`¡¹Ş
 (
ty³
, &
’dp
, 0));

1300 ià(*
’dp
 != '\0') {

1301 
	`HAL_INFO
 (("šv®idy³ '%s' giv’", 
ty³
));

1302 
out
;

1306 ià(
Ïb–
 !ğ
NULL
) {

1307 
	`HAL_INFO
 (("labeled…artitions‚ot supported on MSDOS or MSDOS_EXTENDED"));

1308 
out
;

1313 
PART_TYPE_GPT
:

1314 
g±_©Œibu‹s
 = 0;

1315 ià(
æags
 !ğ
NULL
) {

1316 
n
 = 0; 
æags
[n] !ğ
NULL
;‚++) {

1317 ià(
	`¡rcmp
 (
æags
[
n
], "required") == 0) {

1318 
g±_©Œibu‹s
 |= 1;

1320 
	`HAL_INFO
 (("unknowÀæag '%s'", 
æags
[
n
]));

1321 
out
;

1327 
PART_TYPE_APPLE
:

1328 
­m_¡©us
 = 0;

1329 ià(
æags
 !ğ
NULL
) {

1330 
n
 = 0; 
æags
[n] !ğ
NULL
;‚++) {

1331 ià(
	`¡rcmp
 (
æags
[
n
], "allocated") == 0) {

1332 
­m_¡©us
 |= (1<<1);

1333 } ià(
	`¡rcmp
 (
æags
[
n
], "in_use") == 0) {

1334 
­m_¡©us
 |= (1<<2);

1335 } ià(
	`¡rcmp
 (
æags
[
n
], "boot") == 0) {

1336 
­m_¡©us
 |= (1<<3);

1337 } ià(
	`¡rcmp
 (
æags
[
n
], "allow_read") == 0) {

1338 
­m_¡©us
 |= (1<<4);

1339 } ià(
	`¡rcmp
 (
æags
[
n
], "allow_write") == 0) {

1340 
­m_¡©us
 |= (1<<5);

1341 } ià(
	`¡rcmp
 (
æags
[
n
], "boot_code_is_pic") == 0) {

1342 
­m_¡©us
 |= (1<<6);

1344 
	`HAL_INFO
 (("unknowÀæag '%s'", 
æags
[
n
]));

1345 
out
;

1352 
	`HAL_INFO
 (("·¹™iÚšg schem%d‚Ù suµÜ‹d", 
scheme
));

1353 
out
;

1356 
scheme
) {

1357 
PART_TYPE_MSDOS
:

1358 ià(
mbr_·¹_ty³
 == 0x05 || mbr_part_type == 0x85 || mbr_part_type == 0x0f) {

1359 
³d_ty³
 = 
PED_PARTITION_EXTENDED
;

1361 
³d_ty³
 = 
PED_PARTITION_NORMAL
;

1365 
PART_TYPE_MSDOS_EXTENDED
:

1366 
³d_ty³
 = 
PED_PARTITION_LOGICAL
;

1367 ià(
mbr_·¹_ty³
 == 0x05 || mbr_part_type == 0x85 || mbr_part_type == 0x0f) {

1368 
	`HAL_INFO
 (("Cannot create‡nƒxtended…artition inside‡nƒxtended…artition"));

1369 
out
;

1374 
³d_ty³
 = 
PED_PARTITION_NORMAL
;

1380 
¡¬t_£ùÜ
 = 
¡¬t
 / 512;

1381 
’d_£ùÜ
 = (
¡¬t
 + 
size
) / 512 - 1;

1382 
Ãw_¡¬t_£ùÜ
 = 
Ãw_¡¬t
 / 512;

1383 
Ãw_’d_£ùÜ
 = (
Ãw_¡¬t
 + 
Ãw_size
) / 512 - 1;

1385 
deviû
 = 
	`³d_deviû_g‘
 (
deviû_fe
);

1386 ià(
deviû
 =ğ
NULL
) {

1387 
	`HAL_INFO
 (("ped_device_get() failed"));

1388 
out
;

1390 
	`HAL_INFO
 (("got it"));

1393 ià(
geom‘ry_hps
 > 0 && 
geom‘ry_¥t
 > 0 ) {

1395 
deviû
->
hw_geom
.
cylšd”s
 = deviû->
bios_geom
.cylšd” ğdeviû->
Ëngth
 / 
geom‘ry_hps
 / 
geom‘ry_¥t
;

1396 
deviû
->
hw_geom
.
h—ds
 = deviû->
bios_geom
.h—d ğ
geom‘ry_hps
;

1397 
deviû
->
hw_geom
.
£ùÜs
 = deviû->
bios_geom
.£ùÜ ğ
geom‘ry_¥t
;

1400 
disk
 = 
	`³d_disk_Ãw
 (
deviû
);

1401 ià(
disk
 =ğ
NULL
) {

1402 
	`HAL_INFO
 (("ped_disk_new() failed"));

1403 
out_³d_deviû
;

1405 
	`HAL_INFO
 (("got disk"));

1407 ià(!
is_chªge
) {

1408 
·¹
 = 
	`³d_·¹™iÚ_Ãw
 (
disk
,

1409 
³d_ty³
,

1410 
NULL
,

1411 
¡¬t_£ùÜ
,

1412 
’d_£ùÜ
);

1413 ià(
·¹
 =ğ
NULL
) {

1414 
	`HAL_INFO
 (("ped_partition_new() failed"));

1415 
out_³d_disk
;

1417 
	`HAL_INFO
 (("new…artition"));

1419 
·¹
 = 
	`³d_disk_g‘_·¹™iÚ_by_£ùÜ
 (
disk
,

1420 
¡¬t_£ùÜ
);

1421 ià(
·¹
 =ğ
NULL
) {

1422 
	`HAL_INFO
 (("ped_partition_get_by_sector() failed"));

1423 
out_³d_disk
;

1425 
	`HAL_INFO
 (("got…artition"));

1434 ià(
scheme
 =ğ
PART_TYPE_GPT
) {

1436 
efi_guid
 
ty³
;

1437 
efi_guid
 
uuid
;

1438 
Çme
[37];

1439 
lvm
;

1440 
¿id
;

1441 
boÙ
;

1442 
hp_£rviû
;

1443 
hidd’
;

1445 } *
g±_d©a
 = (*è
·¹
->
disk_¥ecific
;

1447 ià(
ty³
 !ğ
NULL
) {

1448 ià(!
	`£t_Ë_guid
 ((
gušt8
*è&
g±_d©a
->
ty³
,ype)) {

1449 
	`HAL_INFO
 (("ty³ '%s' fÜ GPT‡µ—¸tØbm®fÜmed", 
ty³
));

1450 
out_³d_·¹™iÚ
;

1454 ià(
æags
 !ğ
NULL
) {

1455 ià(
g±_©Œibu‹s
 & 1) {

1456 
g±_d©a
->
hidd’
 = 1;

1458 
g±_d©a
->
hidd’
 = 0;

1462 } ià(
scheme
 =ğ
PART_TYPE_MSDOS
 || schem=ğ
PART_TYPE_MSDOS_EXTENDED
) {

1464 
sy¡em
;

1465 
boÙ
;

1467 } *
dos_d©a
 = (*è
·¹
->
disk_¥ecific
;

1469 ià(
ty³
 !ğ
NULL
) {

1470 
dos_d©a
->
sy¡em
 = 
mbr_·¹_ty³
;

1472 ià(
æags
 !ğ
NULL
) {

1473 ià(
mbr_æags
 & 0x80) {

1474 
dos_d©a
->
boÙ
 = 1;

1476 
dos_d©a
->
boÙ
 = 0;

1480 } ià(
scheme
 =ğ
PART_TYPE_APPLE
) {

1482 
vŞume_Çme
[33];

1483 
sy¡em_Çme
[33];

1484 
´oûssÜ_Çme
[17];

1485 
is_boÙ
;

1486 
is_driv”
;

1487 
has_driv”
;

1488 
is_roÙ
;

1489 
is_sw­
;

1490 
is_lvm
;

1491 
is_¿id
;

1492 
PedSeùÜ
 
d©a_»giÚ_Ëngth
;

1493 
PedSeùÜ
 
boÙ_»giÚ_Ëngth
;

1494 
gušt32
 
boÙ_ba£_add»ss
;

1495 
gušt32
 
boÙ_’Œy_add»ss
;

1496 
gušt32
 
boÙ_checksum
;

1497 
gušt32
 
¡©us
;

1499 } *
mac_d©a
 = (*è
·¹
->
disk_¥ecific
;

1501 ià(
ty³
 !ğ
NULL
) {

1502 
	`mem£t
 (
mac_d©a
->
sy¡em_Çme
, 0, 33);

1503 
	`¡ºıy
 (
mac_d©a
->
sy¡em_Çme
, 
ty³
, 32);

1506 ià(
æags
 !ğ
NULL
) {

1507 
mac_d©a
->
¡©us
 = 
­m_¡©us
;

1511 ià(
Ïb–
 !ğ
NULL
) {

1512 
	`³d_·¹™iÚ_£t_Çme
 (
·¹
, 
Ïb–
);

1515 ià(
geom‘ry_hps
 > 0 && 
geom‘ry_¥t
 > 0 ) {

1517 
cÚ¡¿št
 = 
	`³d_cÚ¡¿št_ªy
 (
deviû
);

1518 } ià(
geom‘ry_hps
 =ğ-1 && 
geom‘ry_¥t
 == -1 ) {

1523 
deviû
->
bios_geom
.
cylšd”s
 = deviû->
hw_geom
.cylinders;

1524 
deviû
->
bios_geom
.
h—ds
 = deviû->
hw_geom
.heads;

1525 
deviû
->
bios_geom
.
£ùÜs
 = deviû->
hw_geom
.sectors;

1527 
cÚ¡¿št
 = 
	`³d_cÚ¡¿št_ªy
 (
deviû
);

1529 
PedGeom‘ry
 *
geo_¡¬t
;

1530 
PedGeom‘ry
 *
geo_’d
;

1533 ià(
is_chªge
) {

1534 
geo_¡¬t
 = 
	`³d_geom‘ry_Ãw
 (
deviû
, 
Ãw_¡¬t_£ùÜ
, 1);

1535 
geo_’d
 = 
	`³d_geom‘ry_Ãw
 (
deviû
, 
Ãw_’d_£ùÜ
, 1);

1537 
geo_¡¬t
 = 
	`³d_geom‘ry_Ãw
 (
deviû
, 
¡¬t_£ùÜ
, 1);

1538 
geo_’d
 = 
	`³d_geom‘ry_Ãw
 (
deviû
, 
’d_£ùÜ
, 1);

1541 
cÚ¡¿št
 = 
	`³d_cÚ¡¿št_Ãw
 (
³d_®ignm’t_ªy
,…ed_alignment_any,

1542 
geo_¡¬t
, 
geo_’d
, 1, 
deviû
->
Ëngth
);

1545 
Œy_chªge_agaš
:

1546 ià(
is_chªge
) {

1547 ià(
	`³d_disk_£t_·¹™iÚ_geom
 (
disk
,

1548 
·¹
,

1549 
cÚ¡¿št
,

1550 
Ãw_¡¬t_£ùÜ
, 
Ãw_’d_£ùÜ
) == 0) {

1551 
	`HAL_INFO
 (("ped_disk_set_partition_geom() failed"));

1552 
out_³d_cÚ¡¿št
;

1555 ià(
	`³d_disk_add_·¹™iÚ
 (
disk
,

1556 
·¹
,

1557 
cÚ¡¿št
) == 0) {

1558 
	`HAL_INFO
 (("ped_disk_add_partition() failed"));

1559 
out_³d_cÚ¡¿št
;

1563 *
out_¡¬t
 = 
·¹
->
geom
.
¡¬t
 * 512;

1564 *
out_size
 = 
·¹
->
geom
.
Ëngth
 * 512;

1566 ià(
is_chªge
) {

1570 ià(*
out_size
 < 
Ãw_size
) {

1571 
	`HAL_INFO
 (("Ãw_size=%Îd buˆ»suÉšg size, %Îd, sm®Ë¸thª„eque¡ed", 
Ãw_size
, *
out_size
));

1572 
Ãw_’d_£ùÜ
++;

1573 
Œy_chªge_agaš
;

1575 
	`HAL_INFO
 (("chªged…¬t™iÚØ¡¬t=%Îd size=%Îd", *
out_¡¬t
, *
out_size
));

1578 
	`HAL_INFO
 (("added…¬t™iÚ s¹=%Îd size=%Îd", *
out_¡¬t
, *
out_size
));

1587 
·¹
 = 
NULL
;

1593 ià(
	`³d_disk_comm™_to_dev
 (
disk
) == 0) {

1594 
	`HAL_INFO
 (("ped_disk_commit_to_dev() failed"));

1595 
out_³d_cÚ¡¿št
;

1597 
	`HAL_INFO
 (("committedo disk"));

1599 
»s
 = 
TRUE
;

1601 
	`³d_cÚ¡¿št_de¡roy
 (
cÚ¡¿št
);

1602 
	`³d_disk_de¡roy
 (
disk
);

1603 
	`³d_deviû_de¡roy
 (
deviû
);

1604 
out
;

1606 
out_³d_cÚ¡¿št
:

1607 
	`³d_cÚ¡¿št_de¡roy
 (
cÚ¡¿št
);

1609 
out_³d_·¹™iÚ
:

1610 ià(
·¹
 !ğ
NULL
) {

1611 
	`³d_·¹™iÚ_de¡roy
 (
·¹
);

1614 
out_³d_disk
:

1615 
	`³d_disk_de¡roy
 (
disk
);

1617 
out_³d_deviû
:

1618 
	`³d_deviû_de¡roy
 (
deviû
);

1620 
out
:

1621  
»s
;

1622 
	}
}

1624 
gboŞ—n


1625 
	$·¹_add_·¹™iÚ
 (*
deviû_fe
,

1626 
gušt64
 
¡¬t
, gušt64 
size
,

1627 
gušt64
 *
out_¡¬t
, gušt64 *
out_size
,

1628 *
ty³
, *
Ïb–
, **
æags
,

1629 
geom‘ry_hps
, 
geom‘ry_¥t
)

1631  
	`·¹_add_chªge_·¹™iÚ
 (
deviû_fe
,

1632 
¡¬t
, 
size
,

1634 
out_¡¬t
, 
out_size
,

1635 
ty³
, 
Ïb–
, 
æags
,

1636 
geom‘ry_hps
, 
geom‘ry_¥t
);

1637 
	}
}

1639 
gboŞ—n


1640 
	$·¹_chªge_·¹™iÚ
 (*
deviû_fe
,

1641 
gušt64
 
¡¬t
,

1642 
gušt64
 
Ãw_¡¬t
, gušt64 
Ãw_size
,

1643 
gušt64
 *
out_¡¬t
, gušt64 *
out_size
,

1644 *
ty³
, *
Ïb–
, **
æags
,

1645 
geom‘ry_hps
, 
geom‘ry_¥t
)

1647  
	`·¹_add_chªge_·¹™iÚ
 (
deviû_fe
,

1648 
¡¬t
, 0,

1649 
Ãw_¡¬t
, 
Ãw_size
,

1650 
out_¡¬t
, 
out_size
,

1651 
ty³
, 
Ïb–
, 
æags
,

1652 
geom‘ry_hps
, 
geom‘ry_¥t
);

1653 
	}
}

1655 
gboŞ—n


1656 
	$·¹_d–_·¹™iÚ
 (*
deviû_fe
, 
gušt64
 
off£t
)

1658 
gboŞ—n
 
»t
;

1659 
PedDeviû
 *
deviû
;

1660 
PedDisk
 *
disk
;

1661 
PedP¬t™iÚ
 *
·¹
;

1662 
P¬t™iÚTabË
 *
p
;

1663 
gboŞ—n
 
is_ex‹nded
;

1664 
n
;

1666 
	`HAL_INFO
 (("IÀ·¹_d–_·¹™iÚ: deviû_fe=%s, off£t=%Îd", 
deviû_fe
, 
off£t
));

1668 
»t
 = 
FALSE
;

1680 
is_ex‹nded
 = 
FALSE
;

1681 
p
 = 
	`·¹_bË_lßd_äom_disk
 (
deviû_fe
);

1682 ià(
p
 =ğ
NULL
) {

1683 
	`HAL_INFO
 (("CªnÙ†ßd…¬t™iÚabË from %s", 
deviû_fe
));

1684 
out
;

1686 
n
 = 0;‚ < 
	`·¹_bË_g‘_num_’Œ›s
 (
p
);‚++) {

1687 
P¬t™iÚTabË
 *
Ã¡ed
;

1688 
Ã¡ed
 = 
	`·¹_bË_’Œy_g‘_Ã¡ed
 (
p
, 
n
);

1689 ià(
Ã¡ed
 !ğ
NULL
) {

1690 ià(
	`·¹_bË_g‘_off£t
 (
Ã¡ed
è=ğ
off£t
) {

1691 
	`HAL_INFO
 (("partitiono delete is‡nƒxtended…artition"));

1692 
is_ex‹nded
 = 
TRUE
;

1696 
	`·¹_bË_ä“
 (
p
);

1698 
deviû
 = 
	`³d_deviû_g‘
 (
deviû_fe
);

1699 ià(
deviû
 =ğ
NULL
) {

1700 
	`HAL_INFO
 (("ped_device_get() failed"));

1701 
out
;

1703 
	`HAL_INFO
 (("got it"));

1705 
disk
 = 
	`³d_disk_Ãw
 (
deviû
);

1706 ià(
disk
 =ğ
NULL
) {

1707 
	`HAL_INFO
 (("ped_disk_new() failed"));

1708 
out_³d_deviû
;

1710 
	`HAL_INFO
 (("got disk"));

1712 ià(
is_ex‹nded
) {

1713 
·¹
 = 
	`³d_disk_ex‹nded_·¹™iÚ
 (
disk
);

1715 
·¹
 = 
	`³d_disk_g‘_·¹™iÚ_by_£ùÜ
 (
disk
, 
off£t
 / 512);

1718 ià(
·¹
 =ğ
NULL
) {

1719 
	`HAL_INFO
 (("ped_disk_get_partition_by_sector() failed"));

1720 
out_³d_disk
;

1723 
	`HAL_INFO
 (("gÙ…¬t™iÚ -…¬t->ty³=%d", 
·¹
->
ty³
));

1725 ià(! ((
·¹
->
ty³
 =ğ
PED_PARTITION_NORMAL
) ||

1726 (
·¹
->
ty³
 =ğ
PED_PARTITION_LOGICAL
) ||

1727 (
·¹
->
ty³
 =ğ
PED_PARTITION_EXTENDED
))) {

1728 
	`HAL_INFO
 (("nØd©¨·¹™iÚ‡ˆgiv’ off£ˆ%Îd fÜ deviû %s", 
off£t
, 
deviû_fe
));

1729 
out_³d_disk
;

1732 ià(
	`³d_disk_d–‘e_·¹™iÚ
 (
disk
, 
·¹
) == 0) {

1733 
	`HAL_INFO
 (("ped_disk_delete_partition() failed"));

1734 
out_³d_disk
;

1742 ià(
	`³d_disk_comm™_to_dev
 (
disk
) == 0) {

1743 
	`HAL_INFO
 (("ped_disk_commit_to_dev() failed"));

1744 
out_³d_disk
;

1746 
	`HAL_INFO
 (("committedo disk"));

1748 
»t
 = 
TRUE
;

1750 
	`³d_disk_de¡roy
 (
disk
);

1751 
	`³d_deviû_de¡roy
 (
deviû
);

1752 
out
;

1754 
out_³d_disk
:

1755 
	`³d_disk_de¡roy
 (
disk
);

1757 
out_³d_deviû
:

1758 
	`³d_deviû_de¡roy
 (
deviû
);

1760 
out
:

1761  
»t
;

1762 
	}
}

1764 
gboŞ—n


1765 
	$·¹_ü—‹_·¹™iÚ_bË
 (*
deviû_fe
, 
P¬t™iÚScheme
 
scheme
)

1767 
PedDeviû
 *
deviû
;

1768 
PedDisk
 *
disk
;

1769 
PedDiskTy³
 *
disk_ty³
;

1770 
gboŞ—n
 
»t
;

1772 
»t
 = 
FALSE
;

1774 
	`HAL_INFO
 (("IÀ·¹_ü—‹_·¹™iÚ_bË: deviû_fe=%s, scheme=%d", 
deviû_fe
, 
scheme
));

1776 
deviû
 = 
	`³d_deviû_g‘
 (
deviû_fe
);

1777 ià(
deviû
 =ğ
NULL
) {

1778 
	`HAL_INFO
 (("ped_device_get() failed"));

1779 
out
;

1781 
	`HAL_INFO
 (("got it"));

1783 
scheme
) {

1784 
PART_TYPE_MSDOS
:

1785 
disk_ty³
 = 
	`³d_disk_ty³_g‘
 ("msdos");

1787 
PART_TYPE_APPLE
:

1788 
disk_ty³
 = 
	`³d_disk_ty³_g‘
 ("mac");

1790 
PART_TYPE_GPT
:

1791 
disk_ty³
 = 
	`³d_disk_ty³_g‘
 ("gpt");

1794 
disk_ty³
 = 
NULL
;

1798 ià(
disk_ty³
 =ğ
NULL
) {

1799 
	`HAL_INFO
 (("UnknowÀÜ unsuµÜ‹d…¬t™iÚšg schem%d", 
scheme
));

1800 
out
;

1803 
disk
 = 
	`³d_disk_Ãw_äesh
 (
deviû
, 
disk_ty³
);

1804 ià(
disk
 =ğ
NULL
) {

1805 
	`HAL_INFO
 (("ped_disk_new_fresh() failed"));

1806 
out_³d_deviû
;

1808 
	`HAL_INFO
 (("got disk"));

1810 ià(
	`³d_disk_comm™_to_dev
 (
disk
) == 0) {

1811 
	`HAL_INFO
 (("ped_disk_commit_to_dev() failed"));

1812 
out_³d_disk
;

1814 
	`HAL_INFO
 (("committedo disk"));

1816 
»t
 = 
TRUE
;

1818 
	`³d_disk_de¡roy
 (
disk
);

1819 
	`³d_deviû_de¡roy
 (
deviû
);

1820 
out
;

1822 
out_³d_disk
:

1823 
	`³d_disk_de¡roy
 (
disk
);

1825 
out_³d_deviû
:

1826 
	`³d_deviû_de¡roy
 (
deviû
);

1828 
out
:

1829  
»t
;

1830 
	}
}

	@partutil/partutil.h

24 #iâdeà
PARTUTIL_H


25 
	#PARTUTIL_H


	)

27 
	~<¡dio.h
>

28 
	~<glib.h
>

32 
	mPART_TYPE_MSDOS
 = 0,

33 
	mPART_TYPE_MSDOS_EXTENDED
 = 1,

34 
	mPART_TYPE_APPLE
 = 2,

35 
	mPART_TYPE_GPT
 = 3

36 } 
	tP¬t™iÚScheme
;

51 cÚ¡ *
·¹_g‘_scheme_Çme
 (
P¬t™iÚScheme
 
scheme
);

53 
	gP¬t™iÚTabË_s
;

54 
P¬t™iÚTabË_s
 
	tP¬t™iÚTabË
;

65 
P¬t™iÚTabË
 *
·¹_bË_lßd_äom_disk
 (*
deviû
);

73 
·¹_bË_ä“
 (
P¬t™iÚTabË
 *
·¹_bË
);

85 
P¬t™iÚScheme
 
·¹_bË_g‘_scheme
 (
P¬t™iÚTabË
 *
·¹_bË
);

95 
·¹_bË_g‘_num_’Œ›s
 (
P¬t™iÚTabË
 *
·¹_bË
);

107 
gušt64
 
·¹_bË_g‘_off£t
 (
P¬t™iÚTabË
 *
·¹_bË
);

119 
gušt64
 
·¹_bË_g‘_size
 (
P¬t™iÚTabË
 *
·¹_bË
);

141 
·¹_bË_fšd
 (
P¬t™iÚTabË
 *
·¹_bË
,

142 
gušt64
 
off£t
,

143 
P¬t™iÚTabË
 **
out_·¹_bË
,

144 *
out_’Œy
);

159 
P¬t™iÚTabË
 *
·¹_bË_’Œy_g‘_Ã¡ed
 (P¬t™iÚTabË *
·¹_bË
, 
’Œy
);

185 *
·¹_bË_’Œy_g‘_ty³
 (
P¬t™iÚTabË
 *
·¹_bË
, 
’Œy
);

199 *
·¹_bË_’Œy_g‘_Ïb–
 (
P¬t™iÚTabË
 *
·¹_bË
, 
’Œy
);

211 *
·¹_bË_’Œy_g‘_uuid
 (
P¬t™iÚTabË
 *
·¹_bË
, 
’Œy
);

247 **
·¹_bË_’Œy_g‘_æags
 (
P¬t™iÚTabË
 *
·¹_bË
, 
’Œy
);

259 
gušt64
 
·¹_bË_’Œy_g‘_off£t
 (
P¬t™iÚTabË
 *
·¹_bË
, 
’Œy
);

270 
gušt64
 
·¹_bË_’Œy_g‘_size
 (
P¬t™iÚTabË
 *
·¹_bË
, 
’Œy
);

282 
gboŞ—n
 
·¹_ü—‹_·¹™iÚ_bË
 (*
deviû
, 
P¬t™iÚScheme
 
scheme
);

338 
gboŞ—n
 
·¹_add_·¹™iÚ
 (*
deviû
,

339 
gušt64
 
¡¬t
, gušt64 
size
,

340 
gušt64
 *
out_¡¬t
, gušt64 *
out_size
,

341 *
ty³
, *
Ïb–
, **
æags
,

342 
geom‘ry_hps
, 
geom‘ry_¥t
);

388 
gboŞ—n
 
·¹_chªge_·¹™iÚ
 (*
deviû_fe
,

389 
gušt64
 
¡¬t
,

390 
gušt64
 
Ãw_¡¬t
, gušt64 
Ãw_size
,

391 
gušt64
 *
out_¡¬t
, gušt64 *
out_size
,

392 *
ty³
, *
Ïb–
, **
æags
,

393 
geom‘ry_hps
, 
geom‘ry_¥t
);

410 
gboŞ—n
 
·¹_d–_·¹™iÚ
 (*
deviû
, 
gušt64
 
off£t
);

	@tools/hal-acl-tool.c

23 
	~<¡dio.h
>

24 
	~<¡dlib.h
>

25 
	~<sys/fe.h
>

26 
	~<sys/ty³s.h
>

27 
	~<sys/¡©.h
>

28 
	~<uni¡d.h
>

29 
	~<”ºo.h
>

30 
	~<¡ršg.h
>

31 
	~<pwd.h
>

32 
	~<g½.h
>

34 
	~<glib.h
>

35 
	~<libh®.h
>

36 
	~<pŞk™/pŞk™.h
>

99 
	sACLCu¼’t_s
 {

100 *
	mudi
;

101 *
	mdeviû
;

102 
	mty³
;

104 
uid_t
 
	muid
;

105 
gid_t
 
	mgid
;

106 } 
	mv
;

107 
gboŞ—n
 
	m»move
;

108 
gboŞ—n
 
	madd
;

109 } 
	tACLCu¼’t
;

113 
	mHAL_ACL_UID
,

114 
	mHAL_ACL_GID


117 
PŞK™CÚ‹xt
 *
	gpk_cÚ‹xt
 = 
NULL
;

119 
LibH®CÚ‹xt
 *
	gh®_ùx
 = 
NULL
;

121 
gboŞ—n
 
	gš_deviû_added
 = 
FALSE
;

123 
gboŞ—n


124 
	$’su»_h®_ùx
 ()

126 
gboŞ—n
 
»t
;

127 
DBusE¼Ü
 
”rÜ
;

129 
»t
 = 
FALSE
;

130 ià(
h®_ùx
 !ğ
NULL
) {

131 
»t
 = 
TRUE
;

132 
out
;

135 
	`dbus_”rÜ_š™
 (&
”rÜ
);

136 ià((
h®_ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

137 
	`´štf
 ("%d: CªnÙ cÚÃùØh®d: %s: %s\n", 
	`g‘pid
 (), 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

138 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

139 
out
;

142 
»t
 = 
TRUE
;

144 
out
:

145  
»t
;

146 
	}
}

149 
	$h®_aş_ä“
 (
ACLCu¼’t
 *
ha
)

151 
	`g_ä“
 (
ha
->
udi
);

152 
	`g_ä“
 (
ha
->
deviû
);

153 
	`g_ä“
 (
ha
);

154 
	}
}

157 
	$ha_sÜt
 (
ACLCu¼’t
 *
a
, ACLCu¼’ˆ*
b
)

159  
	`¡rcmp
 (
a
->
deviû
, 
b
->device);

160 
	}
}

162 
gboŞ—n


163 
	$aş_­¶y_chªges
 (
GSLi¡
 *
Ãw_aş_li¡
, 
gboŞ—n
 
Úly_upd©e_aşli¡
, gboŞ—À
missšg_fes_ok
)

165 
GSŒšg
 *
¡r
;

166 
GSŒšg
 *
£tçş_cmdlše
;

167 *
Ãw_aş_fe_cÚ‹Ás
 = 
NULL
;

168 *
£tçş_cmdlše_¡r
 = 
NULL
;

169 
GSLi¡
 *
i
;

170 
gboŞ—n
 
»t
;

171 
GE¼Ü
 *
”rÜ
 = 
NULL
;

172 
ex™_¡©us
;

173 
gboŞ—n
 
mes§ges_w”e_£Á
 = 
FALSE
;

175 
»t
 = 
FALSE
;

177 
Ãw_aş_li¡
 = 
	`g_¦i¡_sÜt
 (Ãw_aş_li¡, (
GCom·»Func
è
ha_sÜt
);

182 
¡r
 = 
	`g_¡ršg_Ãw
 ("");

183 
£tçş_cmdlše
 = 
	`g_¡ršg_Ãw
 ("");

184 
i
 = 
Ãw_aş_li¡
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

185 
ACLCu¼’t
 *
ha
 = (ACLCu¼’ˆ*è
i
->
d©a
;

187 ià(
ha
->
»move
) {

188 ià(
£tçş_cmdlše
->
Ën
 > 0) {

189 
	`g_¡ršg_­³nd_c
 (
£tçş_cmdlše
, ' ');

191 
	`g_¡ršg_­³nd_´štf
 (
£tçş_cmdlše
, "-x %c:%d %s",

192 (
ha
->
ty³
 =ğ
HAL_ACL_UID
) ? 'u' : 'g',

193 (
ha
->
ty³
 =ğ
HAL_ACL_UID
è? ha->
v
.
uid
 : ha->v.
gid
,

194 
ha
->
deviû
);

197 ià(
ha
->
add
) {

198 ià(
£tçş_cmdlše
->
Ën
 > 0) {

199 
	`g_¡ršg_­³nd_c
 (
£tçş_cmdlše
, ' ');

201 
	`g_¡ršg_­³nd_´štf
 (
£tçş_cmdlše
, "-m %c:%d:rw %s",

202 (
ha
->
ty³
 =ğ
HAL_ACL_UID
) ? 'u' : 'g',

203 (
ha
->
ty³
 =ğ
HAL_ACL_UID
è? ha->
v
.
uid
 : ha->v.
gid
,

204 
ha
->
deviû
);

208 ià(!
ha
->
»move
) {

209 
	`g_¡ršg_­³nd_´štf
 (
¡r
,

211 
ha
->
deviû
,

212 
ha
->
udi
,

213 (
ha
->
ty³
 =ğ
HAL_ACL_UID
) ? 'u' : 'g',

214 (
ha
->
ty³
 =ğ
HAL_ACL_UID
è? ha->
v
.
uid
 : ha->v.
gid
);

217 
Ãw_aş_fe_cÚ‹Ás
 = 
	`g_¡ršg_ä“
 (
¡r
, 
FALSE
);

235 ià(
£tçş_cmdlše
->
Ën
 =ğ0 || 
Úly_upd©e_aşli¡
) {

236 
	`g_¡ršg_ä“
 (
£tçş_cmdlše
, 
TRUE
);

237 
£tçş_cmdlše_¡r
 = 
NULL
;

239 
	`g_¡ršg_´•’d
 (
£tçş_cmdlše
, "setfacl ");

240 
£tçş_cmdlše_¡r
 = 
	`g_¡ršg_ä“
 (
£tçş_cmdlše
, 
FALSE
);

242 
	`´štf
 ("%d: invokšg '%s'\n", 
	`g‘pid
 (), 
£tçş_cmdlše_¡r
);

243 ià(!
	`g_¥awn_commªd_lše_sync
 (
£tçş_cmdlše_¡r
, 
NULL
, NULL, &
ex™_¡©us
, &
”rÜ
)) {

244 
	`´štf
 ("%d: E¼Ü - couldn'ˆšvok£tçş(1): %s\n", 
	`g‘pid
 (), 
”rÜ
->
mes§ge
);

245 
	`g_”rÜ_ä“
 (
”rÜ
);

246 
out
;

249 ià(
ex™_¡©us
 != 0) {

250 ià(!
missšg_fes_ok
) {

251 
	`´štf
 ("%d: setfacl(1)ƒxit code != 0 but OK‡s some missing files‡reƒxpected\n",

252 
	`g‘pid
 ());

254 
	`´štf
 ("%d: E¼Ü - s‘çş(1èçed\n", 
	`g‘pid
 ());

255 
out
;

261 
	`g_fe_£t_cÚ‹Ás
 (
PACKAGE_LOCALSTATEDIR
 "/run/hald/acl-list",

262 
Ãw_aş_fe_cÚ‹Ás
,

263 
	`¡¾’
 (
Ãw_aş_fe_cÚ‹Ás
),

264 
NULL
);

269 
mes§ges_w”e_£Á
 = 
FALSE
;

270 
i
 = 
Ãw_aş_li¡
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

271 
ACLCu¼’t
 *
ha
 = (ACLCu¼’ˆ*è
i
->
d©a
;

276 ià(
ha
->
ty³
 =ğ
HAL_ACL_UID
 && ha->
udi
 !ğ
NULL
 && (ha->
add
 || ha->
»move
è&& !
š_deviû_added
) {

277 
DBusMes§ge
 *
mes§ge
;

278 
DBusCÚÃùiÚ
 *
cÚÃùiÚ
;

280 
	`´štf
 ("Emmitting %s for udi %s, uid %d\n",

281 
ha
->
add
 ? "ACLAdded" : "ACLRemoved",

282 
ha
->
udi
,

283 
ha
->
v
.
uid
);

285 ià(!
	`’su»_h®_ùx
 ()) {

286 
	`´štf
 ("%d: cªnÙ g‘†ibh® cÚ‹xt\n", 
	`g‘pid
 ());

287 
no_dbus_sigÇl
;

290 
cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
h®_ùx
);

291 ià(
cÚÃùiÚ
 =ğ
NULL
) {

292 
	`´štf
 ("%d: cªnÙ g‘ D-Bu cÚÃùiÚ\n", 
	`g‘pid
());

293 
no_dbus_sigÇl
;

296 
mes§ge
 = 
	`dbus_mes§ge_Ãw_sigÇl
 (
ha
->
udi
,

298 
ha
->
add
 ? "ACLAdded" : "ACLRemoved");

299 ià(
mes§ge
 =ğ
NULL
) {

300 
	`´štf
 ("%d: cªnÙ c»©mes§ge\n", 
	`g‘pid
());

301 
no_dbus_sigÇl
;

304 ià(!
	`dbus_mes§ge_­³nd_¬gs
 (
mes§ge
,

305 
DBUS_TYPE_UINT32
, &(
ha
->
v
.
uid
),

306 
DBUS_TYPE_INVALID
)) {

307 
	`´štf
 ("%d: cªnÙ‡µ’dØmes§ge\n", 
	`g‘pid
());

308 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

309 
no_dbus_sigÇl
;

312 ià(!
	`dbus_cÚÃùiÚ_£nd
 (
cÚÃùiÚ
, 
mes§ge
, 
NULL
)) {

313 
	`´štf
 ("%d: cªnÙ s’d mes§ge\n", 
	`g‘pid
());

314 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

315 
no_dbus_sigÇl
;

317 
	`dbus_mes§ge_uÄef
 (
mes§ge
);

319 
mes§ges_w”e_£Á
 = 
TRUE
;

322 
no_dbus_sigÇl
:

329 ià(
mes§ges_w”e_£Á
) {

330 ià(
	`’su»_h®_ùx
 ()) {

331 
DBusCÚÃùiÚ
 *
cÚÃùiÚ
;

332 
cÚÃùiÚ
 = 
	`libh®_ùx_g‘_dbus_cÚÃùiÚ
 (
h®_ùx
);

333 ià(
cÚÃùiÚ
 !ğ
NULL
) {

334 
	`dbus_cÚÃùiÚ_æush
 (
cÚÃùiÚ
);

339 
»t
 = 
TRUE
;

341 
out
:

342 ià(
Ãw_aş_fe_cÚ‹Ás
 !ğ
NULL
)

343 
	`g_ä“
 (
Ãw_aş_fe_cÚ‹Ás
);

345 ià(
£tçş_cmdlše_¡r
 !ğ
NULL
)

346 
	`g_ä“
 (
£tçş_cmdlše_¡r
);

348  
»t
;

349 
	}
}

352 
gboŞ—n


353 
	$g‘_cu¼’t_aş_li¡
 (
GSLi¡
 **
l
)

355 
FILE
 *
f
;

356 
gboŞ—n
 
»t
;

357 
buf
[1024];

359 *
l
 = 
NULL
;

360 
f
 = 
NULL
;

361 
»t
 = 
FALSE
;

363 
f
 = 
	`fİ’
 (
PACKAGE_LOCALSTATEDIR
 "/run/hald/acl-list", "r");

364 ià(
f
 =ğ
NULL
) {

365 
	`´štf
 ("%d: cªnÙ o³À" 
PACKAGE_LOCALSTATEDIR
 "/run/h®d/aş-li¡\n", 
	`g‘pid
 ());

366 
out
;

369 
	`fg‘s
 (
buf
, (buf), 
f
è!ğ
NULL
) {

370 
ACLCu¼’t
 *
ha
;

371 **
v®
;

372 *
’d±r
;

373 
gboŞ—n
 
Şd_fÜm©
 = 
FALSE
;

374 
n
;

378 
ha
 = 
	`g_Ãw0
 (
ACLCu¼’t
, 1);

379 
v®
 = 
	`g_¡r¥l™
(
buf
, "\t", 0);

380 ià(
	`g_¡rv_Ëngth
 (
v®
) == 3) {

381 
	`´štf
 ("Lši äom old fÜm©: '%s'\n", 
buf
);

382 
Şd_fÜm©
 = 
TRUE
;

384 ià(
	`g_¡rv_Ëngth
 (
v®
) != 4) {

385 
	`´štf
 ("Lši m®fÜmed: '%s'\n", 
buf
);

386 
	`g_¡rä“v
 (
v®
);

387 
out
;

391 
n
 = 0;

393 
ha
->
deviû
 = 
	`g_¡rdup
 (
v®
[
n
++]);

395 ià(
Şd_fÜm©
) {

396 
ha
->
udi
 = 
NULL
;

398 
ha
->
udi
 = 
	`g_¡rdup
 (
v®
[
n
++]);

401 ià(
	`¡rcmp
 (
v®
[
n
], "u") == 0) {

402 
ha
->
ty³
 = 
HAL_ACL_UID
;

403 
ha
->
v
.
uid
 = 
	`¡¹Ş
 (
v®
[
n
 + 1], &
’d±r
, 10);

404 ià(*
’d±r
 != '\0' && *endptr != '\n') {

405 
	`´štf
 ("Lši m®fÜmed: '%s'\n", 
buf
);

406 
	`g_¡rä“v
 (
v®
);

407 
out
;

409 } ià(
	`¡rcmp
 (
v®
[
n
], "g") == 0) {

410 
ha
->
ty³
 = 
HAL_ACL_GID
;

411 
ha
->
v
.
gid
 = 
	`¡¹Ş
 (
v®
[
n
 + 1], &
’d±r
, 10);

412 ià(*
’d±r
 != '\0' && *endptr != '\n') {

413 
	`´štf
 ("Lši m®fÜmed: '%s'\n", 
buf
);

414 
	`g_¡rä“v
 (
v®
);

415 
out
;

418 
	`´štf
 ("Lši m®fÜmed: '%s'\n", 
buf
);

419 
	`g_¡rä“v
 (
v®
);

420 
out
;

422 
	`g_¡rä“v
 (
v®
);

426 *
l
 = 
	`g_¦i¡_´•’d
 (*l, 
ha
);

429 
»t
 = 
TRUE
;

431 
out
:

432 ià(
f
 !ğ
NULL
)

433 
	`fşo£
 (
f
);

434  
»t
;

435 
	}
}

437 (*
	tS—tSessiÚVis™Ü
è(cÚ¡ *
	t£©_id
,

438 
	tnum_£ssiÚs_Ú_£©
,

439 cÚ¡ *
	t£ssiÚ_id
,

440 
	tuid_t
 
	t£ssiÚ_uid
,

441 
	tgboŞ—n
 
	t£©_is_loÿl
,

442 
	tgboŞ—n
 
	t£ssiÚ_is_aùive
,

443 
	tgpoš‹r
 
	tu£r_d©a
);

449 
gboŞ—n


450 
	$vis™_£©s_ªd_£ssiÚs
 (
S—tSessiÚVis™Ü
 
vis™Ü_cb
, 
gpoš‹r
 
u£r_d©a
)

452 
i
;

453 
j
;

454 *
s
;

455 *
p
;

456 **
£©s
;

457 
gboŞ—n
 
»t
;

459 
»t
 = 
FALSE
;

461 ià((
s
 = 
	`g‘’v
 ("CK_SEATS")è=ğ
NULL
) {

462 
	`´štf
 ("%d: CK_SEATS i nÙ s‘!\n", 
	`g‘pid
());

463 
out
;

465 
£©s
 = 
	`g_¡r¥l™
 (
s
, "\t", 0);

467 
i
 = 0; 
£©s
[i] !ğ
NULL
; i++) {

468 *
£©
 = 
£©s
[
i
];

469 *
£©_id
;

470 **
£ssiÚs
;

471 
num_£ssiÚs_Ú_£©
;

473 
p
 = 
	`g_¡rdup_´štf
 ("CK_SEAT_%s", 
£©
);

474 ià((
s
 = 
	`g‘’v
 (
p
)è=ğ
NULL
) {

475 
	`´štf
 ("%d: CK_SEAT_% i nÙ s‘!\n", 
	`g‘pid
(), 
£©
);

476 
	`g_ä“
 (
p
);

477 
out
;

479 
	`g_ä“
 (
p
);

480 
£ssiÚs
 = 
	`g_¡r¥l™
 (
s
, "\t", 0);

481 
num_£ssiÚs_Ú_£©
 = 
	`g_¡rv_Ëngth
 (
£ssiÚs
);

483 
£©_id
 = 
	`g_¡rdup_´štf
 ("/Üg/ä“desktİ/CÚsŞeK™/%s", 
£©
);

484 
	`vis™Ü_cb
 (
£©_id
, 
num_£ssiÚs_Ú_£©
, 
NULL
, 0, 
FALSE
, FALSE, 
u£r_d©a
);

487 
j
 = 0; 
£ssiÚs
[j] !ğ
NULL
; j++) {

488 *
£ssiÚ
 = 
£ssiÚs
[
j
];

489 *
£ssiÚ_id
;

490 
gboŞ—n
 
£ssiÚ_is_loÿl
;

491 
gboŞ—n
 
£ssiÚ_is_aùive
;

492 
uid_t
 
£ssiÚ_uid
;

493 *
’d±r
;

495 
p
 = 
	`g_¡rdup_´štf
 ("CK_SESSION_IS_LOCAL_%s", 
£ssiÚ
);

496 ià((
s
 = 
	`g‘’v
 (
p
)è=ğ
NULL
) {

497 
	`´štf
 ("%d: CK_SESSION_IS_LOCAL_% i nÙ s‘!\n", 
	`g‘pid
(), 
£ssiÚ
);

498 
	`g_ä“
 (
p
);

499 
out
;

501 
	`g_ä“
 (
p
);

502 
£ssiÚ_is_loÿl
 = (
	`¡rcmp
 (
s
, "true") == 0);

504 
p
 = 
	`g_¡rdup_´štf
 ("CK_SESSION_IS_ACTIVE_%s", 
£ssiÚ
);

505 ià((
s
 = 
	`g‘’v
 (
p
)è=ğ
NULL
) {

506 
	`´štf
 ("%d: CK_SESSION_IS_ACTIVE_% i nÙ s‘!\n", 
	`g‘pid
(), 
£ssiÚ
);

507 
	`g_ä“
 (
p
);

508 
out
;

510 
	`g_ä“
 (
p
);

511 
£ssiÚ_is_aùive
 = (
	`¡rcmp
 (
s
, "true") == 0);

513 
p
 = 
	`g_¡rdup_´štf
 ("CK_SESSION_UID_%s", 
£ssiÚ
);

514 ià((
s
 = 
	`g‘’v
 (
p
)è=ğ
NULL
) {

515 
	`´štf
 ("%d: CK_SESSION_UID_% i nÙ s‘!\n", 
	`g‘pid
(), 
£ssiÚ
);

516 
	`g_ä“
 (
p
);

517 
out
;

519 
	`g_ä“
 (
p
);

520 
£ssiÚ_uid
 = 
	`¡¹Ş
 (
s
, &
’d±r
, 10);

521 ià(*
’d±r
 != '\0') {

522 
	`´štf
 ("%d: CK_SESSION_UID_% £ˆtØ'%s' i m®fÜmed!\n", 
	`g‘pid
(), 
£ssiÚ
, 
s
);

523 
out
;

526 
£ssiÚ_id
 = 
	`g_¡rdup_´štf
 ("/Üg/ä“desktİ/CÚsŞeK™/%s", 
£ssiÚ
);

528 
	`vis™Ü_cb
 (
£©_id
, 
num_£ssiÚs_Ú_£©
,

529 
£ssiÚ_id
, 
£ssiÚ_uid
, 
£ssiÚ_is_loÿl
, 
£ssiÚ_is_aùive
, 
u£r_d©a
);

531 
	`g_ä“
 (
£ssiÚ_id
);

533 
	`g_¡rä“v
 (
£ssiÚs
);

534 
	`g_ä“
 (
£©_id
);

536 
	`g_¡rä“v
 (
£©s
);

538 
»t
 = 
TRUE
;

540 
out
:

541  
»t
;

542 
	}
}

547 *
	mudi
;

548 *
	mdeviû
;

549 *
	mty³
;

552 
GSLi¡
 *
	muid
;

553 
GSLi¡
 *
	mgid
;

554 } 
	tACLFÜDeviû
;

557 
	$afd_g¿Á_to_uid
 (
ACLFÜDeviû
 *
afd
, 
uid_t
 
uid
)

559 
GSLi¡
 *
i
;

561 
i
 = 
afd
->
uid
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

562 
uid_t
 
iuid
 = 
	`GPOINTER_TO_INT
 (
i
->
d©a
);

563 ià(
uid
 =ğ
iuid
)

564 
out
;

566 
afd
->
uid
 = 
	`g_¦i¡_´•’d
 (afd->uid, 
	`GINT_TO_POINTER
 (uid));

567 
out
:

569 
	}
}

572 
	$afd_g¿Á_to_gid
 (
ACLFÜDeviû
 *
afd
, 
gid_t
 
gid
)

574 
GSLi¡
 *
i
;

576 
i
 = 
afd
->
gid
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

577 
gid_t
 
igid
 = 
	`GPOINTER_TO_INT
 (
i
->
d©a
);

578 ià(
gid
 =ğ
igid
)

579 
out
;

581 
afd
->
gid
 = 
	`g_¦i¡_´•’d
 (afd->gid, 
	`GINT_TO_POINTER
 (gid));

582 
out
:

584 
	}
}

586 
uid_t


587 
	$ut_Çme_to_uid
 (cÚ¡ *
u£ºame
, 
gid_t
 *
deçuÉ_gid
)

589 
rc
;

590 
uid_t
 
»s
;

591 *
buf
 = 
NULL
;

592 
bufsize
;

593 
·sswd
 
pwd
;

594 
·sswd
 *
pwdp
;

596 
»s
 = (
uid_t
) -1;

598 
bufsize
 = 
	`syscÚf
 (
_SC_GETPW_R_SIZE_MAX
);

599 
buf
 = 
	`g_Ãw0
 (, 
bufsize
);

601 
rc
 = 
	`g‘pwÇm_r
 (
u£ºame
, &
pwd
, 
buf
, 
bufsize
, &
pwdp
);

602 ià(
rc
 !ğ0 || 
pwdp
 =ğ
NULL
) {

604 
out
;

607 
»s
 = 
pwdp
->
pw_uid
;

608 ià(
deçuÉ_gid
 !ğ
NULL
)

609 *
deçuÉ_gid
 = 
pwdp
->
pw_gid
;

611 
out
:

612 
	`g_ä“
 (
buf
);

613  
»s
;

614 
	}
}

616 
gid_t


617 
	$ut_Çme_to_gid
 (cÚ¡ *
grou²ame
)

619 
rc
;

620 
gid_t
 
»s
;

621 *
buf
 = 
NULL
;

622 
bufsize
;

623 
group
 
gbuf
;

624 
group
 *
gbuå
;

626 
»s
 = (
gid_t
) -1;

628 
bufsize
 = 
	`syscÚf
 (
_SC_GETGR_R_SIZE_MAX
);

629 
buf
 = 
	`g_Ãw0
 (, 
bufsize
);

631 
rc
 = 
	`g‘gºam_r
 (
grou²ame
, &
gbuf
, 
buf
, 
bufsize
, &
gbuå
);

632 ià(
rc
 !ğ0 || 
gbuå
 =ğ
NULL
) {

634 
out
;

637 
»s
 = 
gbuå
->
gr_gid
;

639 
out
:

640 
	`g_ä“
 (
buf
);

641  
»s
;

642 
	}
}

645 
	$afd_g¿Á_to_uid_äom_u£¾i¡
 (
ACLFÜDeviû
 *
afd
, **
sv
)

647 
i
;

648 
uid_t
 
uid
;

649 *
’d±r
;

651 
i
 = 0; 
sv
[i] !ğ
NULL
; i++) {

652 
uid
 = 
	`¡¹Ş
 (
sv
[
i
], &
’d±r
, 10);

653 ià(*
’d±r
 != '\0') {

654 
uid
 = 
	`ut_Çme_to_uid
 (
sv
[
i
], 
NULL
);

655 ià((è
uid
 == -1) {

656 
	`´štf
 ("%d: w¬nšg; u£ºam'%s' i unknown\n", 
	`g‘pid
 (), 
sv
[
i
]);

660 
	`afd_g¿Á_to_uid
 (
afd
, 
uid
);

662 
	}
}

665 
	$afd_g¿Á_to_gid_äom_grou¶i¡
 (
ACLFÜDeviû
 *
afd
, **
sv
)

667 
i
;

668 
gid_t
 
gid
;

669 *
’d±r
;

671 
i
 = 0; 
sv
[i] !ğ
NULL
; i++) {

672 
gid
 = 
	`¡¹Ş
 (
sv
[
i
], &
’d±r
, 10);

673 ià(*
’d±r
 != '\0') {

674 
gid
 = 
	`ut_Çme_to_gid
 (
sv
[
i
]);

675 ià((è
gid
 == -1) {

676 
	`´štf
 ("%d: w¬nšg; grou°'%s' i unknown\n", 
	`g‘pid
 (), 
sv
[
i
]);

680 
	`afd_g¿Á_to_gid
 (
afd
, 
gid
);

682 
	}
}

684 
ACLFÜDeviû
 *

685 
	$aş_fÜ_deviû_Ãw
 (cÚ¡ *
udi
)

687 
ACLFÜDeviû
 *
afd
;

689 
afd
 = 
	`g_Ãw0
 (
ACLFÜDeviû
, 1);

690 
afd
->
udi
 = 
	`g_¡rdup
 (udi);

692  
afd
;

693 
	}
}

696 
	$aş_fÜ_deviû_£t_deviû
 (
ACLFÜDeviû
 *
afd
, cÚ¡ *
deviû
)

698 
afd
->
deviû
 = 
	`g_¡rdup
 (device);

699 
	}
}

702 
	$aş_fÜ_deviû_£t_ty³
 (
ACLFÜDeviû
 *
afd
, cÚ¡ *
ty³
)

704 
afd
->
ty³
 = 
	`g_¡rdup
 (type);

705 
	}
}

708 
	$aş_fÜ_deviû_ä“
 (
ACLFÜDeviû
* 
afd
)

710 
	`g_ä“
 (
afd
->
udi
);

711 
	`g_ä“
 (
afd
->
deviû
);

712 
	`g_ä“
 (
afd
->
ty³
);

713 
	`g_¦i¡_ä“
 (
afd
->
uid
);

714 
	`g_¦i¡_ä“
 (
afd
->
gid
);

715 
	`g_ä“
 (
afd
);

716 
	}
}

719 
	$aş_deviû_added_vis™Ü
 (cÚ¡ *
£©_id
,

720 
num_£ssiÚs_Ú_£©
,

721 cÚ¡ *
£ssiÚ_id
,

722 
uid_t
 
£ssiÚ_uid
,

723 
gboŞ—n
 
£ssiÚ_is_loÿl
,

724 
gboŞ—n
 
£ssiÚ_is_aùive
,

725 
gpoš‹r
 
u£r_d©a
)

727 
GSLi¡
 *
i
;

728 
GSLi¡
 *
afd_li¡
 = (GSLi¡ *è
u£r_d©a
;

731 ià(
£ssiÚ_id
 =ğ
NULL
) {

733 
	`´štf
 ("Visiting seat '%s' with %d sessions\n",

734 
£©_id
, 
num_£ssiÚs_Ú_£©
);

736 
	`´štf
 (" %s: Visiting session '%s' with uid %d (is_local=%d) (is_active=%d)\n",

737 
£©_id
, 
£ssiÚ_id
, 
£ssiÚ_uid
, 
£ssiÚ_is_loÿl
, 
£ssiÚ_is_aùive
);

745 
i
 = 
afd_li¡
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

746 
ACLFÜDeviû
 *
afd
 = (ACLFÜDeviû *è
i
->
d©a
;

747 
PŞK™ResuÉ
 
pk_»suÉ
;

748 
PŞK™S—t
 *
pk_£©
;

749 
PŞK™SessiÚ
 *
pk_£ssiÚ
;

750 
PŞK™AùiÚ
 *
pk_aùiÚ
;

751 *
´iv_Çme
;

753 ià(
£ssiÚ_id
 =ğ
NULL
) {

764 
pk_£©
 = 
	`pŞk™_£©_Ãw
 ();

765 
	`pŞk™_£©_£t_ck_obj»f
 (
pk_£©
, 
£©_id
);

767 
pk_£ssiÚ
 = 
	`pŞk™_£ssiÚ_Ãw
 ();

768 
	`pŞk™_£ssiÚ_£t_£©
 (
pk_£ssiÚ
, 
pk_£©
);

769 
	`pŞk™_£©_uÄef
 (
pk_£©
);

770 
	`pŞk™_£ssiÚ_£t_ck_obj»f
 (
pk_£ssiÚ
, 
£ssiÚ_id
);

771 
	`pŞk™_£ssiÚ_£t_uid
 (
pk_£ssiÚ
, 
£ssiÚ_uid
);

772 
	`pŞk™_£ssiÚ_£t_ck_is_aùive
 (
pk_£ssiÚ
, 
£ssiÚ_is_aùive
);

773 
	`pŞk™_£ssiÚ_£t_ck_is_loÿl
 (
pk_£ssiÚ
, 
£ssiÚ_is_loÿl
);

776 
pk_aùiÚ
 = 
	`pŞk™_aùiÚ_Ãw
();

777 
´iv_Çme
 = 
	`g_¡rdup_´štf
 ("Üg.ä“desktİ.h®.deviû-acûss.%s", 
afd
->
ty³
);

778 
	`pŞk™_aùiÚ_£t_aùiÚ_id
 (
pk_aùiÚ
, 
´iv_Çme
);

779 
	`g_ä“
 (
´iv_Çme
);

782 
pk_»suÉ
 = 
	`pŞk™_cÚ‹xt_ÿn_£ssiÚ_do_aùiÚ
 (
pk_cÚ‹xt
,

783 
pk_aùiÚ
,

784 
pk_£ssiÚ
);

785 ià(
pk_»suÉ
 =ğ
POLKIT_RESULT_YES
) {

786 
	`afd_g¿Á_to_uid
 (
afd
, 
£ssiÚ_uid
);

789 
	`pŞk™_aùiÚ_uÄef
 (
pk_aùiÚ
);

790 
	`pŞk™_£ssiÚ_uÄef
 (
pk_£ssiÚ
);

793 
	}
}

796 
	$aş_compu‹_chªges
 (
GSLi¡
 *
afd_li¡
, 
gboŞ—n
 
Úly_upd©e_aşli¡
)

798 
GSLi¡
 *
cu¼’t_aş_li¡
 = 
NULL
;

799 
GSLi¡
 *
i
;

800 
GSLi¡
 *
j
;

801 
GSLi¡
 *
k
;

804 ià(!
	`g‘_cu¼’t_aş_li¡
 (&
cu¼’t_aş_li¡
)) {

805 
	`´štf
 ("Error getting ACL's currently‡pplied\n");

817 
i
 = 
afd_li¡
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

818 
ACLFÜDeviû
 *
afd
 = (ACLFÜDeviû *è
i
->
d©a
;

835 
j
 = 
cu¼’t_aş_li¡
; j !ğ
NULL
; j = 
	`g_¦i¡_Ãxt
 (j)) {

836 
ACLCu¼’t
 *
ha
 = (ACLCu¼’ˆ*è
j
->
d©a
;

838 ià(
	`¡rcmp
 (
afd
->
deviû
, 
ha
->device) == 0) {

839 
ha
->
ty³
) {

840 
HAL_ACL_UID
:

842 
k
 = 
afd
->
uid
; k !ğ
NULL
; k = 
	`g_¦i¡_Ãxt
 (k)) {

843 
uid_t
 
uid
 = 
	`GPOINTER_TO_INT
 (
k
->
d©a
);

844 ià(
uid
 =ğ
ha
->
v
.uid) {

848 
afd
->
uid
 = 
	`g_¦i¡_d–‘e_lšk
 (afd->uid, 
k
);

852 ià(
k
 =ğ
NULL
) {

854 
ha
->
»move
 = 
TRUE
;

857 
HAL_ACL_GID
:

859 
k
 = 
afd
->
gid
; k !ğ
NULL
; k = 
	`g_¦i¡_Ãxt
 (k)) {

860 
gid_t
 
gid
 = 
	`GPOINTER_TO_INT
 (
k
->
d©a
);

861 ià(
gid
 =ğ
ha
->
v
.gid) {

865 
afd
->
gid
 = 
	`g_¦i¡_d–‘e_lšk
 (afd->gid, 
k
);

869 ià(
k
 =ğ
NULL
) {

871 
ha
->
»move
 = 
TRUE
;

882 
j
 = 
afd
->
uid
; j !ğ
NULL
; j = 
	`g_¦i¡_Ãxt
 (j)) {

883 
ACLCu¼’t
 *
ha
;

884 
uid_t
 
uid
;

886 
uid
 = 
	`GPOINTER_TO_INT
 (
j
->
d©a
);

888 ià(
uid
 == 0)

891 
ha
 = 
	`g_Ãw0
 (
ACLCu¼’t
, 1);

892 
ha
->
add
 = 
TRUE
;

893 
ha
->
deviû
 = 
	`g_¡rdup
 (
afd
->device);

894 
ha
->
udi
 = 
	`g_¡rdup
 (
afd
->udi);

895 
ha
->
ty³
 = 
HAL_ACL_UID
;

896 
ha
->
v
.
uid
 = uid;

897 
cu¼’t_aş_li¡
 = 
	`g_¦i¡_´•’d
 (cu¼’t_aş_li¡, 
ha
);

899 
j
 = 
afd
->
gid
; j !ğ
NULL
; j = 
	`g_¦i¡_Ãxt
 (j)) {

900 
ACLCu¼’t
 *
ha
;

901 
ha
 = 
	`g_Ãw0
 (
ACLCu¼’t
, 1);

902 
ha
->
add
 = 
TRUE
;

903 
ha
->
deviû
 = 
	`g_¡rdup
 (
afd
->device);

904 
ha
->
udi
 = 
	`g_¡rdup
 (
afd
->udi);

905 
ha
->
ty³
 = 
HAL_ACL_GID
;

906 
ha
->
v
.
gid
 = 
	`GPOINTER_TO_INT
 (
j
->
d©a
);

907 
cu¼’t_aş_li¡
 = 
	`g_¦i¡_´•’d
 (cu¼’t_aş_li¡, 
ha
);

912 
	`´štf
 ("====================================\n");

913 
i
 = 
cu¼’t_aş_li¡
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

914 
ACLCu¼’t
 *
ha
 = (ACLCu¼’ˆ*è
i
->
d©a
;

916 
	`´štf
 (" ACL '%s' %d %d„em=%d‡dd=%d\n", 
ha
->
deviû
, ha->
ty³
, ha->
v
.
uid
, ha->
»move
, ha->
add
);

919 
	`´štf
 ("====================================\n");

922 
	`aş_­¶y_chªges
 (
cu¼’t_aş_li¡
, 
Úly_upd©e_aşli¡
, 
FALSE
);

924 
out
:

925 ià(
cu¼’t_aş_li¡
 !ğ
NULL
) {

926 
	`g_¦i¡_fÜ—ch
 (
cu¼’t_aş_li¡
, (
GFunc
è
h®_aş_ä“
, 
NULL
);

927 
	`g_¦i¡_ä“
 (
cu¼’t_aş_li¡
);

929 
	}
}

933 
	$aş_deviû_added
 ()

935 *
s
;

936 *
udi
;

937 *
deviû
;

938 *
ty³
;

939 
GSLi¡
 *
afd_li¡
 = 
NULL
;

940 
ACLFÜDeviû
 *
afd
 = 
NULL
;

942 
š_deviû_added
 = 
TRUE
;

946 ià((
udi
 = 
	`g‘’v
 ("UDI")è=ğ
NULL
)

947 
out
;

949 ià((
deviû
 = 
	`g‘’v
 ("HAL_PROP_ACCESS_CONTROL_FILE")è=ğ
NULL
)

950 
out
;

952 ià((
ty³
 = 
	`g‘’v
 ("HAL_PROP_ACCESS_CONTROL_TYPE")è=ğ
NULL
)

953 
out
;

955 
afd
 = 
	`aş_fÜ_deviû_Ãw
 (
udi
);

956 
	`aş_fÜ_deviû_£t_deviû
 (
afd
, 
deviû
);

957 
	`aş_fÜ_deviû_£t_ty³
 (
afd
, 
ty³
);

958 
afd_li¡
 = 
	`g_¦i¡_´•’d
 (
NULL
, 
afd
);

961 ià((
s
 = 
	`g‘’v
 ("HAL_PROP_ACCESS_CONTROL_GRANT_USER")è!ğ
NULL
) {

962 **
sv
;

963 
sv
 = 
	`g_¡r¥l™
 (
s
, "\t", 0);

964 
	`afd_g¿Á_to_uid_äom_u£¾i¡
 (
afd
, 
sv
);

965 
	`g_¡rä“v
 (
sv
);

967 ià((
s
 = 
	`g‘’v
 ("HAL_PROP_ACCESS_CONTROL_GRANT_GROUP")è!ğ
NULL
) {

968 **
sv
;

969 
sv
 = 
	`g_¡r¥l™
 (
s
, "\t", 0);

970 
	`afd_g¿Á_to_gid_äom_grou¶i¡
 (
afd
, 
sv
);

971 
	`g_¡rä“v
 (
sv
);

980 ià(!
	`vis™_£©s_ªd_£ssiÚs
 (
aş_deviû_added_vis™Ü
, (
gpoš‹r
è
afd_li¡
)) {

981 
	`´štf
 ("Error visiting seats‡nd sessions\n");

982 
out
;

985 
	`´štf
 ("%d:‡ddšg ACL' fÜ %s\n", 
	`g‘pid
 (), 
deviû
);

987 
	`aş_compu‹_chªges
 (
afd_li¡
, 
FALSE
);

989 
out
:

990 ià(
afd
 !ğ
NULL
)

991 
	`aş_fÜ_deviû_ä“
 (
afd
);

992 ià(
afd_li¡
 !ğ
NULL
)

993 
	`g_¦i¡_ä“
 (
afd_li¡
);

994 
	}
}

997 
	$aş_deviû_»moved
 ()

999 *
udi
;

1000 *
deviû
;

1001 
GSLi¡
 *
afd_li¡
 = 
NULL
;

1002 
ACLFÜDeviû
 *
afd
 = 
NULL
;

1006 ià((
udi
 = 
	`g‘’v
 ("UDI")è=ğ
NULL
)

1007 
out
;

1009 ià((
deviû
 = 
	`g‘’v
 ("HAL_PROP_ACCESS_CONTROL_FILE")è=ğ
NULL
)

1010 
out
;

1012 
afd
 = 
	`aş_fÜ_deviû_Ãw
 (
udi
);

1013 
	`aş_fÜ_deviû_£t_deviû
 (
afd
, 
deviû
);

1014 
afd_li¡
 = 
	`g_¦i¡_´•’d
 (
NULL
, 
afd
);

1019 
	`´štf
 ("%d:„emovšg ACL' fÜ %s\n", 
	`g‘pid
 (), 
deviû
);

1024 
	`aş_compu‹_chªges
 (
afd_li¡
, 
TRUE
);

1026 
out
:

1027 ià(
afd
 !ğ
NULL
)

1028 
	`aş_fÜ_deviû_ä“
 (
afd
);

1029 ià(
afd_li¡
 !ğ
NULL
)

1030 
	`g_¦i¡_ä“
 (
afd_li¡
);

1031 
	}
}

1034 
	$aş_»cÚfigu»_®l
 ()

1036 
i
;

1037 
num_deviûs
;

1038 **
udis
;

1039 
DBusE¼Ü
 
”rÜ
;

1040 
GSLi¡
 *
afd_li¡
 = 
NULL
;

1042 
	`´štf
 ("%d:„ecÚfiguršg‡Î ACL's\n", 
	`g‘pid
 ());

1044 ià(!
	`’su»_h®_ùx
 ())

1045 
out
;

1047 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1048 ià((
udis
 = 
	`libh®_fšd_deviû_by_ÿ·b™y
 (
h®_ùx
, "acûss_cÚŒŞ", &
num_deviûs
, &
”rÜ
)è=ğ
NULL
) {

1049 
	`´štf
 ("%d: CªnÙ g‘†i¡ oàdeviû oàÿ·b™y 'aş'\n", 
	`g‘pid
 ());

1050 
out
;

1053 
i
 = 0; 
udis
[i] !ğ
NULL
; i++) {

1054 
LibH®Prİ”tyS‘
 *
´İs
;

1055 
LibH®Prİ”tyS‘I‹¿tÜ
 
psi
;

1056 *
deviû
 = 
NULL
;

1057 *
ty³
 = 
NULL
;

1058 
ACLFÜDeviû
 *
afd
;

1059 **
sv
;

1061 ià((
´İs
 = 
	`libh®_deviû_g‘_®l_´İ”t›s
 (
h®_ùx
, 
udis
[
i
], &
”rÜ
)è=ğ
NULL
) {

1062 
	`´štf
 ("%d: CªnÙ g‘†i¡…rİ”t› fÜ '%s'\n", 
	`g‘pid
 (), 
udis
[1]);

1063 
out
;

1066 
afd
 = 
	`aş_fÜ_deviû_Ãw
 (
udis
[
i
]);

1068 
	`libh®_psi_š™
 (&
psi
, 
´İs
);

1069 
	`libh®_psi_has_mÜe
 (&
psi
)) {

1070 *
key
;

1071 
key
 = 
	`libh®_psi_g‘_key
 (&
psi
);

1072 ià(
	`¡rcmp
 (
key
, "access_control.file") == 0) {

1073 
deviû
 = 
	`libh®_psi_g‘_¡ršg
 (&
psi
);

1074 } ià(
	`¡rcmp
 (
key
, "access_control.type") == 0) {

1075 
ty³
 = 
	`libh®_psi_g‘_¡ršg
 (&
psi
);

1076 } ià(
	`¡rcmp
 (
key
, "access_control.grant_user") == 0) {

1077 
sv
 = 
	`libh®_psi_g‘_¡¾i¡
 (&
psi
);

1078 
	`afd_g¿Á_to_uid_äom_u£¾i¡
 (
afd
, 
sv
);

1079 } ià(
	`¡rcmp
 (
key
, "access_control.grant_group") == 0) {

1080 
sv
 = 
	`libh®_psi_g‘_¡¾i¡
 (&
psi
);

1081 
	`afd_g¿Á_to_gid_äom_grou¶i¡
 (
afd
, 
sv
);

1083 
	`libh®_psi_Ãxt
 (&
psi
);

1086 ià(
deviû
 =ğ
NULL
) {

1087 
	`´štf
 ("%d:‡cûss_cÚŒŞ.fnÙ s‘ fÜ '%s'\n", 
	`g‘pid
 (), 
udis
[
i
]);

1088 
	`aş_fÜ_deviû_ä“
 (
afd
);

1089 
sk
;

1092 ià(
ty³
 =ğ
NULL
) {

1093 
	`´štf
 ("%d:‡cûss_cÚŒŞ.ty³‚Ù s‘ fÜ '%s'\n", 
	`g‘pid
 (), 
udis
[
i
]);

1094 
	`aş_fÜ_deviû_ä“
 (
afd
);

1095 
sk
;

1098 
	`aş_fÜ_deviû_£t_deviû
 (
afd
, 
deviû
);

1099 
	`aş_fÜ_deviû_£t_ty³
 (
afd
, 
ty³
);

1100 
afd_li¡
 = 
	`g_¦i¡_´•’d
 (afd_li¡, 
afd
);

1101 
sk
:

1102 
	`libh®_ä“_´İ”ty_£t
 (
´İs
);

1104 
	`libh®_ä“_¡ršg_¬¿y
 (
udis
);

1106 ià(
	`g_¦i¡_Ëngth
 (
afd_li¡
) > 0) {

1107 ià(!
	`vis™_£©s_ªd_£ssiÚs
 (
aş_deviû_added_vis™Ü
, (
gpoš‹r
è
afd_li¡
)) {

1108 
	`´štf
 ("Error visiting seats‡nd sessions\n");

1109 
out
;

1111 
	`aş_compu‹_chªges
 (
afd_li¡
, 
FALSE
);

1114 
out
:

1116 
	}
}

1119 
	$aş_»move_®l
 ()

1121 
GSLi¡
 *
cu¼’t_aş_li¡
 = 
NULL
;

1122 
GSLi¡
 *
i
;

1124 ià(!
	`g‘_cu¼’t_aş_li¡
 (&
cu¼’t_aş_li¡
)) {

1125 
	`´štf
 ("Error getting ACL's currently‡pplied\n");

1126 
out
;

1129 
i
 = 
cu¼’t_aş_li¡
; i !ğ
NULL
; i = 
	`g_¦i¡_Ãxt
 (i)) {

1130 
ACLCu¼’t
 *
ha
 = (ACLCu¼’ˆ*è
i
->
d©a
;

1131 
ha
->
»move
 = 
TRUE
;

1134 
	`aş_­¶y_chªges
 (
cu¼’t_aş_li¡
, 
FALSE
, FALSE);

1136 
out
:

1137 ià(
cu¼’t_aş_li¡
 !ğ
NULL
) {

1138 
	`g_¦i¡_fÜ—ch
 (
cu¼’t_aş_li¡
, (
GFunc
è
h®_aş_ä“
, 
NULL
);

1139 
	`g_¦i¡_ä“
 (
cu¼’t_aş_li¡
);

1141 
	}
}

1143 
	glock_aş_fd
 = -1;

1145 
gboŞ—n


1146 
	$aş_lock
 ()

1148 ià(
lock_aş_fd
 >= 0)

1149  
TRUE
;

1151 
	`´štf
 ("%d:‡‰em±šgØg‘†ock oÀ" 
PACKAGE_LOCALSTATEDIR
 "/run/h®d/aş-li¡\n", 
	`g‘pid
 ());

1153 
lock_aş_fd
 = 
	`İ’
 (
PACKAGE_LOCALSTATEDIR
 "/run/h®d/aş-li¡", 
O_CREAT
 | 
O_RDWR
, 0644);

1154 ià(
lock_aş_fd
 < 0) {

1155 
	`´štf
 ("%d:ƒ¼Ü o³nšg/ü—tšg " 
PACKAGE_LOCALSTATEDIR
 "/run/h®d/aş-li¡\n", 
	`g‘pid
 ());

1156  
FALSE
;

1160 
Œyagaš
:

1161 #ià
sun


1162 ià(
	`lockf
 (
lock_aş_fd
, 
F_LOCK
, 0) != 0)

1164 ià(
	`æock
 (
lock_aş_fd
, 
LOCK_EX
) != 0)

1167 ià(
”ºo
 =ğ
EINTR
)

1168 
Œyagaš
;

1169  
FALSE
;

1172 
	`´štf
 ("\n");

1173 
	`´štf
 ("****************************************************\n");

1174 
	`´štf
 ("%d: gÙ†ock oÀ" 
PACKAGE_LOCALSTATEDIR
 "/run/h®d/aş-li¡\n", 
	`g‘pid
 ());

1175  
TRUE
;

1176 
	}
}

1179 
	$aş_uÆock
 ()

1181 
	`´štf
 ("\n");

1182 
	`´štf
 ("****************************************************\n");

1183 
	`´štf
 ("%d:„–—sšg†ock oÀ" 
PACKAGE_LOCALSTATEDIR
 "/run/h®d/aş-li¡\n", 
	`g‘pid
 ());

1184 #ià
sun


1185 
	`lockf
 (
lock_aş_fd
, 
F_ULOCK
, 0);

1187 
	`æock
 (
lock_aş_fd
, 
LOCK_UN
);

1189 
	`şo£
 (
lock_aş_fd
);

1190 
lock_aş_fd
 = -1;

1191 
	}
}

1194 
	$maš
 (
¬gc
, *
¬gv
[])

1196 
PŞK™E¼Ü
 *
p_”rÜ
;

1198 ià(
¬gc
 != 2) {

1199 
	`´štf
 ("hal-acl-tool should only be invoked by hald\n");

1200 
out
;

1203 ià(!
	`aş_lock
 ()) {

1204 
out
;

1207 
p_”rÜ
 = 
NULL
;

1208 
pk_cÚ‹xt
 = 
	`pŞk™_cÚ‹xt_Ãw
 ();

1209 ià(!
	`pŞk™_cÚ‹xt_š™
 (
pk_cÚ‹xt
, &
p_”rÜ
)) {

1210 
	`´štf
 ("Could‚Ù in™ PŞicyK™ cÚ‹xt: %s\n", 
	`pŞk™_”rÜ_g‘_”rÜ_mes§ge
 (
p_”rÜ
));

1211 
out
;

1214 ià(
	`¡rcmp
 (
¬gv
[1], "--add-device") == 0) {

1215 
	`aş_deviû_added
 ();

1216 } ià(
	`¡rcmp
 (
¬gv
[1], "--remove-device") == 0) {

1217 
	`aş_deviû_»moved
 ();

1218 } ià(
	`¡rcmp
 (
¬gv
[1], "--reconfigure") == 0) {

1219 
	`aş_»cÚfigu»_®l
 ();

1220 } ià(
	`¡rcmp
 (
¬gv
[1], "--remove-all") == 0) {

1221 
	`aş_»move_®l
 ();

1224 
	`aş_uÆock
 ();

1226 
out
:

1228 
	}
}

	@tools/hal-device.c

29 
	#_GNU_SOURCE


	)

31 #ifdeà
HAVE_CONFIG_H


32 
	~<cÚfig.h
>

35 
	~<¡dio.h
>

36 
	~<¡ršg.h
>

37 
	~<uni¡d.h
>

38 
	~<¡dlib.h
>

39 
	~<ùy³.h
>

40 
	~<š‰y³s.h
>

41 
	~<g‘İt.h
>

43 #iâdeà
DBUS_API_SUBJECT_TO_CHANGE


44 
	#DBUS_API_SUBJECT_TO_CHANGE
 1

	)

47 
	~<dbus/dbus.h
>

48 
	~<libh®.h
>

51 *
	mudi
;

52 *
	m»®_udi
;

53 } 
	tÃw_dev_t
;

55 
	slh_´İ_s
 {

56 
lh_´İ_s
 *
	mÃxt
;

57 
LibH®Prİ”tyTy³
 
	mty³
;

58 *
	mkey
;

60 *
	m¡r_v®ue
;

61 
dbus_št32_t
 
	mšt_v®ue
;

62 
dbus_ušt64_t
 
	mušt64_v®ue
;

63 
	mdoubË_v®ue
;

64 
dbus_boŞ_t
 
	mboŞ_v®ue
;

65 **
	m¡¾i¡_v®ue
;

66 } 
	mv
;

67 } 
	tlh_´İ_t
;

70 
h–p
();

71 
dump_deviûs
(
LibH®CÚ‹xt
 *
h®_ùx
, *
¬g
);

72 
»move_udi
(
LibH®CÚ‹xt
 *
h®_ùx
, *
¬g
);

73 
add_udi
(
LibH®CÚ‹xt
 *
h®_ùx
, *
¬g
);

74 
´oûss_´İ”ty
(
LibH®CÚ‹xt
 *
h®_ùx
, *
buf
, 
lh_´İ_t
 **
´İ
);

75 
add_´İ”t›s
(
LibH®CÚ‹xt
 *
h®_ùx
, 
Ãw_dev_t
 *
nd
, 
lh_´İ_t
 *
´İ
);

76 
lh_´İ_t
 *
ä“_´İ”t›s
Öh_´İ_ˆ*
´İ
);

77 *
sk_¥aû
(*
s
);

78 *
sk_nÚ_eq_Ü_¥aû
(*
s
);

79 *
sk_numb”
(*
s
);

80 *
sk_nÚquÙe
(*
s
);

83 
Ãw_dev_t
 
	gÃw_dev
;

86 
	m»move
:1;

87 
	madd
:1;

88 
	mli¡
:1;

89 *
	mudi
;

90 } 
	gİt
;

92 
İtiÚ
 
	gİtiÚs
[] = {

93 { "»move", 1, 
NULL
, 'r' },

94 { "add", 1, 
NULL
, 'a' },

95 { "h–p", 0, 
NULL
, 'h' },

100 
	$maš
(
¬gc
, **
¬gv
)

102 
DBusE¼Ü
 
”rÜ
;

103 
DBusCÚÃùiÚ
 *
cÚn
;

104 
LibH®CÚ‹xt
 *
h®_ùx
;

105 
i
, 
”r
;

107 
İ‹¼
 = 0;

108 
İt
.
li¡
 = 1;

110 (
i
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "a:hr:", 
İtiÚs
, 
NULL
)) != -1) {

111 
i
) {

113 
İt
.
add
 = 1;

114 
İt
.
li¡
 = 0;

115 
İt
.
udi
 = 
İrg
;

118 
İt
.
»move
 = 1;

119 
İt
.
li¡
 = 0;

120 
İt
.
udi
 = 
İrg
;

123 
	`h–p
();

126 
	`h–p
();

131 
	`dbus_”rÜ_š™
(&
”rÜ
);

133 ià(!(
cÚn
 = 
	`dbus_bus_g‘
(
DBUS_BUS_SYSTEM
, &
”rÜ
))) {

134 
	`årštf
(
¡d”r
, "”rÜ: dbus_bus_g‘: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

135 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

140 ià(!(
h®_ùx
 = 
	`libh®_ùx_Ãw
()))  3;

141 ià(!
	`libh®_ùx_£t_dbus_cÚÃùiÚ
(
h®_ùx
, 
cÚn
))  4;

142 ià(!
	`libh®_ùx_š™
(
h®_ùx
, &
”rÜ
)) {

143 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

144 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_š™: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

145 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

147 
	`årštf
 (
¡d”r
, "Could‚ot initialise connectiono hald.\n"

152 
”r
 = 0;

153 ià(
İt
.
li¡
)

154 
”r
 = 
	`dump_deviûs
(
h®_ùx
, 
¬gv
[
İtšd
]);

155 ià(
İt
.
»move
)

156 
”r
 = 
	`»move_udi
(
h®_ùx
, 
İt
.
udi
);

157 ià(
İt
.
add
)

158 
”r
 = 
	`add_udi
(
h®_ùx
, 
İt
.
udi
);

160 
”r
 = 6;

162 
	`libh®_ùx_shutdown
(
h®_ùx
, &
”rÜ
);

163 
	`libh®_ùx_ä“
(
h®_ùx
);

164 
	`dbus_cÚÃùiÚ_uÄef
(
cÚn
);

165 
	`dbus_”rÜ_ä“
(&
”rÜ
);

167  
”r
;

168 
	}
}

171 
	$h–p
()

173 
	`årštf
(
¡d”r
,

182 
	}
}

188 
	$dump_deviûs
(
LibH®CÚ‹xt
 *
h®_ùx
, *
¬g
)

190 
i
;

191 
num_deviûs
;

192 
»tv®
;

193 **
deviû_Çmes
;

194 
DBusE¼Ü
 
”rÜ
;

195 *
udi
 = 
NULL
;

197 ià(
¬g
) {

198 ià(*
¬g
 == '/') {

199 
udi
 = 
¬g
;

201 #ifdeà
HAVE_ASPRINTF


202 ià(
	`a¥rštf
(&
udi
, "/Üg/ä“desktİ/H®/deviûs/%s", 
¬g
) == -1)

205 
udi
 = 
	`ÿÎoc
(1,  ("/Üg/ä“desktİ/H®/deviûs/%s"è+ 
	`¡¾’
(
¬g
));

206 
	`¥rštf
(
udi
, "/Üg/ä“desktİ/H®/deviûs/%s", 
¬g
);

212 
	`dbus_”rÜ_š™
(&
”rÜ
);

214 ià(!
udi
) {

215 ià(!(
deviû_Çmes
 = 
	`libh®_g‘_®l_deviûs
(
h®_ùx
, &
num_deviûs
, &
”rÜ
))) {

216 
	`årštf
(
¡d”r
, "Empty HAL device†ist.\n");

217 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

221 
deviû_Çmes
 = 
	`ÿÎoc
(2,  *device_names);

222 
deviû_Çmes
[0] = 
	`¡rdup
(
udi
);

223 
num_deviûs
 = 1;

227 
»tv®
 = 1;

229 
i
 = 0; i < 
num_deviûs
; i++) {

230 
LibH®Prİ”tyS‘
 *
´İs
;

231 
LibH®Prİ”tyS‘I‹¿tÜ
 
™
;

232 
ty³
;

234 ià(!(
´İs
 = 
	`libh®_deviû_g‘_®l_´İ”t›s
(
h®_ùx
, 
deviû_Çmes
[
i
], &
”rÜ
))) {

235 
	`årštf
(
¡d”r
, "%s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

236 
	`dbus_”rÜ_š™
(&
”rÜ
);

241 
»tv®
 = 0;

243 ià(!
udi
)

244 
	`´štf
("%d: ", 
i
);

245 
	`´štf
("ud˜ğ'%s'\n", 
deviû_Çmes
[
i
]);

247 
	`libh®_psi_š™
(&
™
, 
´İs
); 
	`libh®_psi_has_mÜe
(&™); 
	`libh®_psi_Ãxt
(&it)) {

248 
ty³
 = 
	`libh®_psi_g‘_ty³
(&
™
);

249 
ty³
) {

250 
LIBHAL_PROPERTY_TYPE_STRING
:

251 
	`´štf
(" %s = '%s' (string)\n",

252 
	`libh®_psi_g‘_key
(&
™
),

253 
	`libh®_psi_g‘_¡ršg
(&
™
)

256 
LIBHAL_PROPERTY_TYPE_INT32
:

257 
	`´štf
(" %s = %d (0x%x) (int)\n",

258 
	`libh®_psi_g‘_key
(&
™
),

259 
	`libh®_psi_g‘_št
(&
™
),

260 
	`libh®_psi_g‘_št
(&
™
)

263 
LIBHAL_PROPERTY_TYPE_UINT64
:

264 
	`´štf
(" %s = %lld (0x%llx) (uint64)\n",

265 
	`libh®_psi_g‘_key
(&
™
),

266 (è
	`libh®_psi_g‘_ušt64
(&
™
),

267 (è
	`libh®_psi_g‘_ušt64
(&
™
)

270 
LIBHAL_PROPERTY_TYPE_DOUBLE
:

271 
	`´štf
(" %s = %g (double)\n",

272 
	`libh®_psi_g‘_key
(&
™
),

273 
	`libh®_psi_g‘_doubË
(&
™
)

276 
LIBHAL_PROPERTY_TYPE_BOOLEAN
:

277 
	`´štf
(" %s = %s (bool)\n",

278 
	`libh®_psi_g‘_key
(&
™
),

279 
	`libh®_psi_g‘_boŞ
(&
™
) ? "true" : "false"

282 
LIBHAL_PROPERTY_TYPE_STRLIST
:

284 **
¡¾i¡
;

286 
	`´štf
 (" % ğ{ ", 
	`libh®_psi_g‘_key
(&
™
));

287 
¡¾i¡
 = 
	`libh®_psi_g‘_¡¾i¡
(&
™
);

288 *
¡¾i¡
) {

289 
	`´štf
("'%s'%s", *
¡¾i¡
, strlist[1] ? ", " : "");

290 
¡¾i¡
++;

292 
	`´štf
(" } (string†ist)\n");

296 
	`´štf
("UnknowÀty³ %d = 0x%02x\n", 
ty³
,ype);

301 
	`libh®_ä“_´İ”ty_£t
(
´İs
);

302 
	`´štf
("\n");

305 
	`libh®_ä“_¡ršg_¬¿y
(
deviû_Çmes
);

306 
	`dbus_”rÜ_ä“
(&
”rÜ
);

308  
»tv®
;

309 
	}
}

312 
	$»move_udi
(
LibH®CÚ‹xt
 *
h®_ùx
, *
¬g
)

314 
DBusE¼Ü
 
”rÜ
;

315 *
udi
;

317 ià(!
¬g
)  10;

319 ià(*
¬g
 == '/') {

320 
udi
 = 
¬g
;

322 #ifdeà
HAVE_ASPRINTF


323 if(
	`a¥rštf
(&
udi
, "/Üg/ä“desktİ/H®/deviûs/%s", 
¬g
) == -1)

326 
udi
 = 
	`ÿÎoc
(1,  ("/Üg/ä“desktİ/H®/deviûs/%s"è+ 
	`¡¾’
(
¬g
));

327 
	`¥rštf
(
udi
, "/Üg/ä“desktİ/H®/deviûs/%s", 
¬g
);

332 
	`dbus_”rÜ_š™
(&
”rÜ
);

334 ià(
İt
.
»move
) {

335 ià(!
	`libh®_»move_deviû
(
h®_ùx
, 
udi
, &
”rÜ
)) {

336 
	`årštf
(
¡d”r
, "%s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

337 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

341 
	`årštf
(
¡d”r
, "»moved: %s\n", 
udi
);

346 
	}
}

349 
	$add_udi
(
LibH®CÚ‹xt
 *
h®_ùx
, *
¬g
)

351 
DBusE¼Ü
 
”rÜ
;

352 
dbus_boŞ_t
 
dev_exi¡s
 = 
FALSE
;

353 *
udi
 = 
NULL
, 
buf
[1024];

354 
lh_´İ_t
 *
´İ
;

355 
”r
;

357 ià(!
¬g
)

360 ià(*
¬g
 == '/') {

361 
udi
 = 
¬g
;

363 #ifdeà
HAVE_ASPRINTF


364 ià(
	`a¥rštf
(&
udi
, "/Üg/ä“desktİ/H®/deviûs/%s", 
¬g
) == -1)

367 
udi
 = 
	`ÿÎoc
(1,  ("/Üg/ä“desktİ/H®/deviûs/%s"è+ 
	`¡¾’
(
¬g
));

368 
	`¥rštf
(
udi
, "/Üg/ä“desktİ/H®/deviûs/%s", 
¬g
);

372 ià(
udi
)

373 
Ãw_dev
.
udi
 = 
	`¡rdup
(udi);

375 
	`dbus_”rÜ_š™
(&
”rÜ
);

377 ià(
udi
)

378 
dev_exi¡s
 = 
	`libh®_deviû_exi¡s
(
h®_ùx
, 
udi
, &
”rÜ
);

380 ià(
dev_exi¡s
) {

381 
Ãw_dev
.
»®_udi
 = 
	`¡rdup
Òew_dev.
udi
);

383 
Ãw_dev
.
»®_udi
 = 
	`libh®_Ãw_deviû
(
h®_ùx
, &
”rÜ
);

385 ià(!
Ãw_dev
.
»®_udi
) {

386 
	`årštf
(
¡d”r
, "%s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

387 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

388 
	`ä“
(
Ãw_dev
.
»®_udi
);

393 
	`´štf
("tm°udi: %s\n", 
Ãw_dev
.
»®_udi
);

396 
´İ
 = 
NULL
;

398 
	`fg‘s
(
buf
,  buf, 
¡dš
)) {

399 
	`´oûss_´İ”ty
(
h®_ùx
, 
buf
, &
´İ
);

402 
”r
 = 
	`add_´İ”t›s
(
h®_ùx
, &
Ãw_dev
, 
´İ
);

404 
´İ
 = 
	`ä“_´İ”t›s
(prop);

406 ià(!
dev_exi¡s
) {

407 ià(!
	`libh®_deviû_comm™_to_gdl
(
h®_ùx
, 
Ãw_dev
.
»®_udi
,‚ew_dev.
udi
, &
”rÜ
)) {

408 
	`årštf
(
¡d”r
, "%s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

409 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

410 
	`ä“
(
Ãw_dev
.
»®_udi
);

412 
”r
 =ƒrr ?ƒrr : 23;

416 
	`´štf
("%s: %s\n", 
dev_exi¡s
 ? "m”ged": "ü—‹d", 
Ãw_dev
.
udi
);

418  
”r
;

419 
	}
}

422 *
	$sk_¥aû
(*
s
)

424 
	`is¥aû
(*
s
)) s++;

426  
s
;

427 
	}
}

430 *
	$sk_nÚ_eq_Ü_¥aû
(*
s
)

432 *
s
 && * !ğ'=' && !
	`is¥aû
(*s))

433 
s
++;

435  
s
;

436 
	}
}

439 *
	$sk_numb”
(*
s
)

441 *
s
 =ğ'-' || * =ğ'+' || * =ğ'.' || 
	`isdig™
(*s))

442 
s
++;

444  
s
;

445 
	}
}

448 *
	$sk_nÚquÙe
(*
s
)

450 *
s
 && *s != '\'')

451 
s
++;

453  
s
;

454 
	}
}

457 
	$´oûss_´İ”ty
(
LibH®CÚ‹xt
 *
h®_ùx
, *
buf
, 
lh_´İ_t
 **
´İ
)

459 *
s
, *
s1
;

460 *
key
, *
s_v®
 = 
NULL
;

461 
lh_´İ_t
 *
p
;

462 
Ën
;

463 
»move
 = 0;

465 
s
 = 
	`sk_¥aû
(
buf
);

467 ià(*
s
 == '-') {

468 
»move
 = 1;

469 
s
 = 
	`sk_¥aû
(s + 1);

472 ià((
s1
 = 
	`sk_numb”
(
s
), s1 !ğsè&& *s1 =ğ':'è ğ
	`sk_¥aû
(s1 + 1);

474 
s
 = 
	`sk_nÚ_eq_Ü_¥aû
(
key
 = s);

475 *
s
++ = 0;

476 ià(!*
key
)

479 ià(*
key
 == '#')

482 ià(*
s
 == '=')

483 
s
++;

484 
s
 = 
	`sk_¥aû
(s);

486 ià(!*
s
)

487 
»move
 = 1;

489 
p
 = 
	`ÿÎoc
(1,  *p);

490 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_INVALID
;

491 
p
->
key
 = 
	`¡rdup
(key);

493 ià(
»move
) {

494 
p
->
Ãxt
 = *
´İ
;

495 *
´İ
 = 
p
;

499 ià(*
s
 == '\'') {

500 
s_v®
 = 
s
 + 1;

501 
s
 = 
	`¡¼chr
(
s_v®
, '\'');

502 *(
s
 ? s : 
s_v®
) = 0;

503 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_STRING
;

504 
p
->
v
.
¡r_v®ue
 = 
	`¡rdup
(
s_v®
);

505 } ià(*
s
 == '{') {

506 
s_v®
 = 
s
 + 1;

507 
s1
 = 
	`¡¼chr
(
s_v®
, '}');

508 ià(
s1
) *s1 = 0;

509 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_STRLIST
;

510 
Ën
 = 0;

511 
p
->
v
.
¡¾i¡_v®ue
 = 
	`ÿÎoc
(1,  *p->v.strlist_value);

512 *
s_v®
++ == '\'') {

513 
s
 = 
	`sk_nÚquÙe
(
s_v®
);

514 ià(*
s
) *s++ = 0;

515 
p
->
v
.
¡¾i¡_v®ue
 = 
	`»®loc
Õ->v.¡¾i¡_v®ue, (
Ën
 + 2) *  *p->v.strlist_value);

516 
p
->
v
.
¡¾i¡_v®ue
[
Ën
] = 
	`¡rdup
(
s_v®
);

517 
p
->
v
.
¡¾i¡_v®ue
[++
Ën
] = 
NULL
;

518 
s_v®
 = 
	`sk_nÚquÙe
(
s
);

520 } ià(!
	`¡ºcmp
(
s
, "true", 4)) {

521 
s
 += 4;

522 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_BOOLEAN
;

523 
p
->
v
.
boŞ_v®ue
 = 
TRUE
;

524 } ià(!
	`¡ºcmp
(
s
, "false", 5)) {

525 
s
 += 5;

526 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_BOOLEAN
;

527 
p
->
v
.
boŞ_v®ue
 = 
FALSE
;

528 } ià((
s1
 = 
	`sk_numb”
(
s
)) != s) {

529 ià(
	`¡r¡r
(
s1
, "(int)")) {

530 *
s1
++ = 0;

531 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_INT32
;

532 
p
->
v
.
št_v®ue
 = 
	`¡¹Ş
(
s
, 
NULL
, 10);

533 } ià(
	`¡r¡r
(
s1
, "(uint64)")) {

534 *
s1
++ = 0;

535 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_UINT64
;

536 
p
->
v
.
ušt64_v®ue
 = 
	`¡¹ouÎ
(
s
, 
NULL
, 10);

537 } ià(
	`¡r¡r
(
s1
, "(double)")) {

538 
p
->
ty³
 = 
LIBHAL_PROPERTY_TYPE_DOUBLE
;

539 
p
->
v
.
doubË_v®ue
 = 
	`¡¹od
(
s
, 
NULL
);

542 
s
 = 
s1
;

545 ià(
p
->
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_INVALID
) {

546 
	`ä“
(
p
->
key
);

547 
	`ä“
(
p
);

549 
p
->
Ãxt
 = *
´İ
;

550 *
´İ
 = 
p
;

552 
	}
}

555 
	$add_´İ”t›s
(
LibH®CÚ‹xt
 *
h®_ùx
, 
Ãw_dev_t
 *
nd
, 
lh_´İ_t
 *
´İ
)

557 
DBusE¼Ü
 
”rÜ
;

558 
lh_´İ_t
 *
p
;

559 *
udi2
 = 
NULL
, *
udi3
 = NULL, **
s
;

560 
LibH®Prİ”tyTy³
 
Şd_ty³
;

562 
	`dbus_”rÜ_š™
(&
”rÜ
);

564 
p
 = 
´İ
;…;… =…->
Ãxt
) {

565 ià(!
	`¡rcmp
(
p
->
key
, "udi"è&&…->
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_STRING
) {

566 
udi2
 = 
p
->
v
.
¡r_v®ue
;

570 
Şd_ty³
 = 
	`libh®_deviû_g‘_´İ”ty_ty³
(
h®_ùx
, 
nd
->
»®_udi
, 
p
->
key
, &
”rÜ
);

571 
	`dbus_”rÜ_š™
(&
”rÜ
);

573 ià(
Şd_ty³
 !ğ
LIBHAL_PROPERTY_TYPE_INVALID
 &&

574 Ğ
p
->
ty³
 !ğ
Şd_ty³
 ||…->ty³ =ğ
LIBHAL_PROPERTY_TYPE_STRLIST
)) {

575 ià(!
	`libh®_deviû_»move_´İ”ty
(
h®_ùx
, 
nd
->
»®_udi
, 
p
->
key
, &
”rÜ
)) {

576 
	`årštf
(
¡d”r
, "%s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

577 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

582 
p
->
ty³
) {

583 
LIBHAL_PROPERTY_TYPE_INVALID
:

585 
LIBHAL_PROPERTY_TYPE_BOOLEAN
:

586 ià(!
	`libh®_deviû_£t_´İ”ty_boŞ
(
h®_ùx
, 
nd
->
»®_udi
, 
p
->
key
,…->
v
.
boŞ_v®ue
, &
”rÜ
)) {

587 
	`årštf
(
¡d”r
, "%s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

588 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

592 
LIBHAL_PROPERTY_TYPE_INT32
:

593 ià(!
	`libh®_deviû_£t_´İ”ty_št
(
h®_ùx
, 
nd
->
»®_udi
, 
p
->
key
,…->
v
.
št_v®ue
, &
”rÜ
)) {

594 
	`årštf
(
¡d”r
, "%s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

595 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

599 
LIBHAL_PROPERTY_TYPE_UINT64
:

600 ià(!
	`libh®_deviû_£t_´İ”ty_ušt64
(
h®_ùx
, 
nd
->
»®_udi
, 
p
->
key
,…->
v
.
ušt64_v®ue
, &
”rÜ
)) {

601 
	`årštf
(
¡d”r
, "%s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

602 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

606 
LIBHAL_PROPERTY_TYPE_DOUBLE
:

607 ià(!
	`libh®_deviû_£t_´İ”ty_doubË
(
h®_ùx
, 
nd
->
»®_udi
, 
p
->
key
,…->
v
.
doubË_v®ue
, &
”rÜ
)) {

608 
	`årštf
(
¡d”r
, "%s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

609 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

613 
LIBHAL_PROPERTY_TYPE_STRING
:

614 ià(!
	`¡rcmp
(
p
->
key
, "šfo.udi")è
udi3
 =…->
v
.
¡r_v®ue
;

615 ià(!
	`libh®_deviû_£t_´İ”ty_¡ršg
(
h®_ùx
, 
nd
->
»®_udi
, 
p
->
key
,…->
v
.
¡r_v®ue
, &
”rÜ
)) {

616 
	`årštf
(
¡d”r
, "%s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

617 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

621 
LIBHAL_PROPERTY_TYPE_STRLIST
:

622 
s
 = 
p
->
v
.
¡¾i¡_v®ue
; *s; s++) {

623 ià(!
	`libh®_deviû_´İ”ty_¡¾i¡_­³nd
(
h®_ùx
, 
nd
->
»®_udi
, 
p
->
key
, *
s
, &
”rÜ
)) {

624 
	`årštf
(
¡d”r
, "%s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

625 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

633 ià(
udi2
è
udi3
 = 
NULL
;

634 ià(
udi3
è
udi2
 = udi3;

636 ià(
udi2
 && !
nd
->
udi
)

637 
nd
->
udi
 = 
	`¡rdup
(
udi2
);

640 
	}
}

643 
lh_´İ_t
 *
	$ä“_´İ”t›s
(
lh_´İ_t
 *
´İ
)

645 
lh_´İ_t
 *
Ãxt
;

646 **
s
;

648 ; 
´İ
;…rİ = 
Ãxt
) {

649 
Ãxt
 = 
´İ
->next;

651 
	`ä“
(
´İ
->
key
);

652 ià(
´İ
->
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_STRING
è
	`ä“
Õrİ->
v
.
¡r_v®ue
);

653 ià(
´İ
->
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_STRLIST
 &&…rİ->
v
.
¡¾i¡_v®ue
) {

654 
s
 = 
´İ
->
v
.
¡¾i¡_v®ue
; *s; ) 
	`ä“
(*s++);

655 
	`ä“
(
´İ
->
v
.
¡¾i¡_v®ue
);

657 
	`ä“
(
´İ
);

660  
NULL
;

661 
	}
}

	@tools/hal-disable-polling.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dlib.h
>

32 
	~<¡dio.h
>

33 
	~<lim™s.h
>

34 
	~<¡dlib.h
>

35 
	~<¡ršg.h
>

36 
	~<uni¡d.h
>

37 
	~<g‘İt.h
>

38 
	~<glib.h
>

39 
	~<libh®.h
>

49 
	$u§ge
 (
¬gc
, *
¬gv
[])

51 
	`årštf
 (
¡d”r
,

56 
	`årštf
 (
¡d”r
,

67 
	}
}

79 
	$maš
 (
¬gc
, *
¬gv
[])

81 *
udi
 = 
NULL
;

82 *
deviû
 = 
NULL
;

83 
dbus_boŞ_t
 
is_v”siÚ
 = 
FALSE
;

84 
dbus_boŞ_t
 
’abË_pŞlšg
 = 
FALSE
;

85 
DBusE¼Ü
 
”rÜ
;

86 
LibH®CÚ‹xt
 *
h®_ùx
;

87 
FILE
 *
f
;

88 *
f’ame
;

90 ià(
¬gc
 <= 1) {

91 
	`u§ge
 (
¬gc
, 
¬gv
);

96 
c
;

97 
İtiÚ_šdex
 = 0;

98 cÚ¡ *
İt
;

99 
İtiÚ
 
lÚg_İtiÚs
[] = {

100 {"udi", 1, 
NULL
, 0},

101 {"deviû", 1, 
NULL
, 0},

102 {"’abË-pŞlšg", 0, 
NULL
, 0},

103 {"v”siÚ", 0, 
NULL
, 0},

104 {"h–p", 0, 
NULL
, 0},

105 {
NULL
, 0, NULL, 0}

108 
c
 = 
	`g‘İt_lÚg
 (
¬gc
, 
¬gv
, "",

109 
lÚg_İtiÚs
, &
İtiÚ_šdex
);

110 ià(
c
 == -1)

113 
c
) {

115 
İt
 = 
lÚg_İtiÚs
[
İtiÚ_šdex
].
Çme
;

117 ià(
	`¡rcmp
 (
İt
, "help") == 0) {

118 
	`u§ge
 (
¬gc
, 
¬gv
);

120 } ià(
	`¡rcmp
 (
İt
, "version") == 0) {

121 
is_v”siÚ
 = 
TRUE
;

122 } ià(
	`¡rcmp
 (
İt
, "udi") == 0) {

123 
udi
 = 
	`¡rdup
 (
İrg
);

124 } ià(
	`¡rcmp
 (
İt
, "device") == 0) {

125 
deviû
 = 
	`¡rdup
 (
İrg
);

126 } ià(
	`¡rcmp
 (
İt
, "enable-polling") == 0) {

127 
’abË_pŞlšg
 = 
TRUE
;

132 
	`u§ge
 (
¬gc
, 
¬gv
);

138 ià(
is_v”siÚ
) {

139 
	`´štf
 ("h®-di§bË-pŞlšg " 
PACKAGE_VERSION
 "\n");

143 ià(
udi
 =ğ
NULL
 && 
deviû
 == NULL) {

144 
	`u§ge
 (
¬gc
, 
¬gv
);

148 ià(
udi
 !ğ
NULL
 && 
deviû
 != NULL) {

149 
	`u§ge
 (
¬gc
, 
¬gv
);

153 
	`dbus_”rÜ_š™
 (&
”rÜ
);

154 ià((
h®_ùx
 = 
	`libh®_ùx_Ãw
 ()è=ğ
NULL
) {

155 
	`årštf
 (
¡d”r
, "error:†ibhal_ctx_new\n");

158 ià(!
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
h®_ùx
, 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
))) {

159 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_£t_dbus_cÚÃùiÚ: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

160 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

163 ià(!
	`libh®_ùx_š™
 (
h®_ùx
, &
”rÜ
)) {

164 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

165 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_š™: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

166 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

168 
	`årštf
 (
¡d”r
, "Could‚ot initialise connectiono hald.\n"

173 ià(
	`g‘uid
 () != 0) {

174 
	`årštf
 (
¡d”r
, "This…rogram„equires super user (root)…rivileges.\n");

178 ià(
deviû
 !ğ
NULL
) {

179 **
deviûs
;

180 
num_deviûs
;

181 
n
;

183 
deviûs
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
h®_ùx
, "block.deviû", 
deviû
, &
num_deviûs
, 
NULL
);

184 ià(
deviûs
 =ğ
NULL
 || devices[0] == NULL) {

185 
»®_deviû
[
PATH_MAX
];

187 ià(
	`»®·th
(
deviû
, 
»®_deviû
è=ğ
NULL
) {

188 
	`årštf
 (
¡d”r
, "CªnÙ fšd deviû %s.\n", 
deviû
);

192 
deviûs
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
h®_ùx
, "block.deviû", 
»®_deviû
,

193 &
num_deviûs
, 
NULL
);

195 ià(
deviûs
 =ğ
NULL
) {

196 
	`årštf
 (
¡d”r
, "CªnÙ fšd symlšked deviû % -> %s.\n", 
deviû
, 
»®_deviû
);

200 
	`årštf
 (
¡d”r
, "FŞlowšg symlšk from % tØ%s.\n", 
deviû
, 
»®_deviû
);

203 
n
 = 0; 
deviûs
[n] !ğ
NULL
;‚++) {

204 ià(
	`libh®_deviû_qu”y_ÿ·b™y
 (
h®_ùx
, 
deviûs
[
n
], "¡Üage", 
NULL
)) {

205 
udi
 = 
deviûs
[
n
];

210 ià(
udi
 =ğ
NULL
) {

211 
	`årštf
 (
¡d”r
, "CªnÙ fšd stÜagdeviû %s.\n", 
deviû
);

217 ià(!
	`libh®_deviû_exi¡s
 (
h®_ùx
, 
udi
, &
”rÜ
)) {

218 
	`årštf
 (
¡d”r
, "CªnÙ fšd deviû w™h ud˜%s.\n", 
udi
);

221 ià(!
	`libh®_deviû_qu”y_ÿ·b™y
 (
h®_ùx
, 
udi
, "¡Üage", 
NULL
)) {

222 
	`årštf
 (
¡d”r
, "Deviû w™h ud˜% i nÙ‡ stÜagdeviû.\n", 
udi
);

225 
deviû
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
h®_ùx
, 
udi
, "block.deviû", 
NULL
);

226 ià(
deviû
 =ğ
NULL
) {

227 
	`årštf
 (
¡d”r
, "Deviû w™h ud˜% dÛ nÙ havblock.deviû s‘.\n", 
udi
);

232 ià(!
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
h®_ùx
, 
udi
, "¡Üage.»movabË", 
NULL
)) {

233 
	`årštf
 (
¡d”r
, "The given drive don't use„emovable media so it's‚ot…olled‡nyway.\n");

237 
f’ame
 = 
	`g_¡rdup_´štf
 (
PACKAGE_SYSCONF_DIR
 "/hal/fdi/information/media-check-disable-%s.fdi",

238 
	`g_ba£Çme
 (
udi
));

240 ià(
’abË_pŞlšg
) {

241 ià(
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
h®_ùx
, 
udi
, "¡Üage.medŸ_check_’abËd", 
NULL
)) {

242 
	`årštf
 (
¡d”r
, "Polling is‡lreadyƒnabled onhe given drive.\n");

246 ià(!
	`g_fe_‹¡
 (
f’ame
, 
G_FILE_TEST_EXISTS
)) {

247 
	`årštf
 (
¡d”r
, "CªnÙ fšd fd˜f%s. P”h­ pŞlšg wa¢'ˆdi§bËd usšghi toŞ?\n", 
f’ame
);

250 ià(
	`uÆšk
 (
f’ame
) != 0) {

251 
	`årštf
 (
¡d”r
, "CªnÙ d–‘fd˜f%s.\n", 
f’ame
);

255 ià(!
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
h®_ùx
, 
udi
, "¡Üage.medŸ_check_’abËd", 
NULL
)) {

256 
	`årštf
 (
¡d”r
, "Polling is‡lready disabled onhe given drive.\n");

260 ià(
	`g_fe_‹¡
 (
f’ame
, 
G_FILE_TEST_EXISTS
)) {

261 
	`årštf
 (
¡d”r
, "Thfd˜f% ®»adyƒxi¡. Cow¬dly„efusšgØov”wr™™.\n", 
f’ame
);

265 
f
 = 
	`fİ’
 (
f’ame
, "w");

266 ià(
f
 =ğ
NULL
) {

267 
	`årštf
 (
¡d”r
, "CªnÙ o³À% fÜ wr™šg.\n", 
f’ame
);

270 
	`årštf
 (
f
, "<?xml version=\"1.0\"ƒncoding=\"UTF-8\"?>\n"

279 "\n", 
udi
);

280 
	`fşo£
 (
f
);

283 
	`libh®_deviû_»´obe
 (
h®_ùx
, 
udi
, &
”rÜ
);

285 ià(
’abË_pŞlšg
)

286 
	`´štf
 ("Polling for drive %s have beenƒnabled. The fdi file deleted was\n"

287 " %s\n", 
deviû
, 
f’ame
);

289 
	`´štf
 ("Polling for drive %s have been disabled. The fdi file written was\n"

290 " %s\n", 
deviû
, 
f’ame
);

293 
	}
}

	@tools/hal-is-caller-locked-out.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dio.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<g‘İt.h
>

36 
	~<libh®.h
>

46 
	$u§ge
 (
¬gc
, *
¬gv
[])

48 
	`årštf
 (
¡d”r
,

53 
	`årštf
 (
¡d”r
,

67 
	}
}

79 
	$maš
 (
¬gc
, *
¬gv
[])

81 *
udi
 = 
NULL
;

82 *
š‹rçû
 = 
NULL
;

83 *
ÿÎ”
 = 
NULL
;

84 
dbus_boŞ_t
 
is_v”siÚ
 = 
FALSE
;

85 
dbus_boŞ_t
 
locked_out
;

86 
DBusE¼Ü
 
”rÜ
;

87 
LibH®CÚ‹xt
 *
h®_ùx
;

90 ià(
¬gc
 <= 1) {

91 
	`u§ge
 (
¬gc
, 
¬gv
);

96 
c
;

97 
İtiÚ_šdex
 = 0;

98 cÚ¡ *
İt
;

99 
İtiÚ
 
lÚg_İtiÚs
[] = {

100 {"udi", 1, 
NULL
, 0},

101 {"š‹rçû", 1, 
NULL
, 0},

102 {"ÿÎ”", 1, 
NULL
, 0},

103 {"v”siÚ", 0, 
NULL
, 0},

104 {"h–p", 0, 
NULL
, 0},

105 {
NULL
, 0, NULL, 0}

108 
c
 = 
	`g‘İt_lÚg
 (
¬gc
, 
¬gv
, "",

109 
lÚg_İtiÚs
, &
İtiÚ_šdex
);

110 ià(
c
 == -1)

113 
c
) {

115 
İt
 = 
lÚg_İtiÚs
[
İtiÚ_šdex
].
Çme
;

117 ià(
	`¡rcmp
 (
İt
, "help") == 0) {

118 
	`u§ge
 (
¬gc
, 
¬gv
);

120 } ià(
	`¡rcmp
 (
İt
, "version") == 0) {

121 
is_v”siÚ
 = 
TRUE
;

122 } ià(
	`¡rcmp
 (
İt
, "udi") == 0) {

123 
udi
 = 
	`¡rdup
 (
İrg
);

124 } ià(
	`¡rcmp
 (
İt
, "caller") == 0) {

125 
ÿÎ”
 = 
	`¡rdup
 (
İrg
);

126 } ià(
	`¡rcmp
 (
İt
, "interface") == 0) {

127 
š‹rçû
 = 
	`¡rdup
 (
İrg
);

132 
	`u§ge
 (
¬gc
, 
¬gv
);

138 ià(
is_v”siÚ
) {

139 
	`´štf
 ("h®-is-ÿÎ”-locked-ouˆ" 
PACKAGE_VERSION
 "\n");

143 ià(
udi
 =ğ
NULL
 || 
ÿÎ”
 =ğNULL || 
š‹rçû
 == NULL) {

144 
	`u§ge
 (
¬gc
, 
¬gv
);

148 
	`dbus_”rÜ_š™
 (&
”rÜ
);

149 ià((
h®_ùx
 = 
	`libh®_ùx_Ãw
 ()è=ğ
NULL
) {

150 
	`årštf
 (
¡d”r
, "error:†ibhal_ctx_new\n");

153 ià(!
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
h®_ùx
, 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
))) {

154 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_£t_dbus_cÚÃùiÚ: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

155 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

158 ià(!
	`libh®_ùx_š™
 (
h®_ùx
, &
”rÜ
)) {

159 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

160 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_š™: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

161 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

163 
	`årštf
 (
¡d”r
, "Could‚ot initialise connectiono hald.\n"

168 
locked_out
 = 
	`libh®_deviû_is_ÿÎ”_locked_out
 (
h®_ùx
,

169 
udi
,

170 
š‹rçû
,

171 
ÿÎ”
,

172 &
”rÜ
);

173 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

174 
	`årštf
 (
¡d”r
, "”rÜ: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

175 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

179 ià(
locked_out
)

183 
	}
}

	@tools/hal-is-caller-privileged.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dio.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<g‘İt.h
>

35 
	~<glib.h
>

36 
	~<¡dlib.h
>

38 
	~<libh®.h
>

48 
	$u§ge
 (
¬gc
, *
¬gv
[])

50 
	`årštf
 (
¡d”r
,

55 
	`årštf
 (
¡d”r
,

70 
	}
}

82 
	$maš
 (
¬gc
, *
¬gv
[])

84 *
udi
 = 
NULL
;

85 *
aùiÚ
 = 
NULL
;

86 *
ÿÎ”
 = 
NULL
;

87 
dbus_boŞ_t
 
is_v”siÚ
 = 
FALSE
;

88 *
pŞk™_»suÉ
;

89 
DBusE¼Ü
 
”rÜ
;

90 
LibH®CÚ‹xt
 *
h®_ùx
;

92 ià(
¬gc
 <= 1) {

93 
	`u§ge
 (
¬gc
, 
¬gv
);

98 
c
;

99 
İtiÚ_šdex
 = 0;

100 cÚ¡ *
İt
;

101 
İtiÚ
 
lÚg_İtiÚs
[] = {

102 {"udi", 1, 
NULL
, 0},

103 {"aùiÚ", 1, 
NULL
, 0},

104 {"ÿÎ”", 1, 
NULL
, 0},

105 {"v”siÚ", 0, 
NULL
, 0},

106 {"h–p", 0, 
NULL
, 0},

107 {
NULL
, 0, NULL, 0}

110 
c
 = 
	`g‘İt_lÚg
 (
¬gc
, 
¬gv
, "",

111 
lÚg_İtiÚs
, &
İtiÚ_šdex
);

112 ià(
c
 == -1)

115 
c
) {

117 
İt
 = 
lÚg_İtiÚs
[
İtiÚ_šdex
].
Çme
;

119 ià(
	`¡rcmp
 (
İt
, "help") == 0) {

120 
	`u§ge
 (
¬gc
, 
¬gv
);

122 } ià(
	`¡rcmp
 (
İt
, "version") == 0) {

123 
is_v”siÚ
 = 
TRUE
;

124 } ià(
	`¡rcmp
 (
İt
, "udi") == 0) {

125 
udi
 = 
	`¡rdup
 (
İrg
);

126 } ià(
	`¡rcmp
 (
İt
, "caller") == 0) {

127 
ÿÎ”
 = 
	`¡rdup
 (
İrg
);

128 } ià(
	`¡rcmp
 (
İt
, "action") == 0) {

129 
aùiÚ
 = 
	`¡rdup
 (
İrg
);

134 
	`u§ge
 (
¬gc
, 
¬gv
);

140 ià(
is_v”siÚ
) {

141 
	`´štf
 ("h®-is-ÿÎ”-´iveged " 
PACKAGE_VERSION
 "\n");

145 ià(
udi
 =ğ
NULL
 || 
ÿÎ”
 =ğNULL || 
aùiÚ
 == NULL) {

146 
	`u§ge
 (
¬gc
, 
¬gv
);

150 
	`dbus_”rÜ_š™
 (&
”rÜ
);

151 ià(
	`g‘’v
 ("HALD_DIRECT_ADDR"è!ğ
NULL
) {

152 ià((
h®_ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

153 
	`årštf
 (
¡d”r
, "Cannot connecto hald\n");

154 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

155 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

160 ià((
h®_ùx
 = 
	`libh®_ùx_Ãw
 ()è=ğ
NULL
) {

161 
	`årštf
 (
¡d”r
, "error:†ibhal_ctx_new\n");

164 ià(!
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
h®_ùx
, 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
))) {

165 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_£t_dbus_cÚÃùiÚ: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

166 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

169 ià(!
	`libh®_ùx_š™
 (
h®_ùx
, &
”rÜ
)) {

170 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

171 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_š™: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

172 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

174 
	`årštf
 (
¡d”r
, "Could‚ot initialise connectiono hald.\n"

180 
pŞk™_»suÉ
 = 
	`libh®_deviû_is_ÿÎ”_´iveged
 (
h®_ùx
,

181 
udi
,

182 
aùiÚ
,

183 
ÿÎ”
,

184 &
”rÜ
);

185 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

186 
	`årštf
 (
¡d”r
, "”rÜ: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

187 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

191 
	`´štf
 ("%s\n", 
pŞk™_»suÉ
);

193 
	}
}

	@tools/hal-lock.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dio.h
>

32 
	~<¡dlib.h
>

33 
	~<¡ršg.h
>

34 
	~<uni¡d.h
>

35 
	~<g‘İt.h
>

36 
	~<sys/ty³s.h
>

37 
	~<sys/wa™.h
>

38 
	~<sigÇl.h
>

39 
	~<glib.h
>

40 
	~<dbus/dbus-glib-lowËv–.h
>

42 
	~"libh®.h
"

52 
	$u§ge
 (
¬gc
, *
¬gv
[])

54 
	`årštf
 (
¡d”r
,

63 
	`årštf
 (
¡d”r
,

83 
	}
}

85 *
	gudi
 = 
NULL
;

86 *
	gš‹rçû
 = 
NULL
;

87 cÚ¡ *
	gunique_Çme
;

88 
GPid
 
	gchd_pid
;

91 
	$gu¬dŸn
 (
GPid
 
pid
, 
¡©us
, 
gpoš‹r
 
d©a
)

94 
	`ex™
 (0);

95 
	}
}

98 
	$deviû_»moved
 (
LibH®CÚ‹xt
 *
ùx
, cÚ¡ *
_udi
)

100 ià(
	`¡rcmp
 (
udi
, 
_udi
) == 0) {

101 
	`årštf
 (
¡d”r
, "Losthe device; killing child...\n");

102 
	`kl
 (
chd_pid
, 
SIGTERM
);

104 
	}
}

107 
	$š‹rçû_lock_»Ëa£d
 (
LibH®CÚ‹xt
 *
ùx
,

108 cÚ¡ *
_udi
,

109 cÚ¡ *
_š‹rçû
,

110 cÚ¡ *
lock_owÃr
,

111 
num_locks
)

115 ià(
	`¡rcmp
 (
udi
, 
_udi
) == 0 &&

116 
	`¡rcmp
 (
š‹rçû
, 
_š‹rçû
) == 0 &&

117 
	`¡rcmp
 (
lock_owÃr
, 
unique_Çme
) == 0) {

118 
	`årštf
 (
¡d”r
, "Losthe†ock; killing child...\n");

119 
	`kl
 (
chd_pid
, 
SIGTERM
);

121 
	}
}

133 
	$maš
 (
¬gc
, *
¬gv
[])

135 *
run
 = 
NULL
;

136 
dbus_boŞ_t
 
is_v”siÚ
 = 
FALSE
;

137 
dbus_boŞ_t
 
exşusive
 = 
FALSE
;

138 
dbus_boŞ_t
 
gÙ_lock
 = 
FALSE
;

139 
dbus_boŞ_t
 
ex™_w™h_lock
 = 
FALSE
;

140 
dbus_boŞ_t
 
ex™_w™h_dev
 = 
FALSE
;

141 
DBusCÚÃùiÚ
 *
cÚ
;

142 
DBusE¼Ü
 
”rÜ
;

143 
LibH®CÚ‹xt
 *
h®_ùx
;

144 
»t
;

145 
GE¼Ü
 *
g_”rÜ
 = 
NULL
;

146 
GMašLoİ
 *
loİ
;

148 
»t
 = 1;

150 ià(
¬gc
 <= 1) {

151 
	`u§ge
 (
¬gc
, 
¬gv
);

152 
out
;

156 
c
;

157 
İtiÚ_šdex
 = 0;

158 cÚ¡ *
İt
;

159 
İtiÚ
 
lÚg_İtiÚs
[] = {

160 {"udi", 1, 
NULL
, 0},

161 {"š‹rçû", 1, 
NULL
, 0},

162 {"run", 1, 
NULL
, 0},

163 {"exşusive", 0, 
NULL
, 0},

164 {"ex™-w™h-lock", 0, 
NULL
, 0},

165 {"ex™-w™h-dev", 0, 
NULL
, 0},

166 {"v”siÚ", 0, 
NULL
, 0},

167 {"h–p", 0, 
NULL
, 0},

168 {
NULL
, 0, NULL, 0}

171 
c
 = 
	`g‘İt_lÚg
 (
¬gc
, 
¬gv
, "",

172 
lÚg_İtiÚs
, &
İtiÚ_šdex
);

173 ià(
c
 == -1)

176 
c
) {

178 
İt
 = 
lÚg_İtiÚs
[
İtiÚ_šdex
].
Çme
;

180 ià(
	`¡rcmp
 (
İt
, "help") == 0) {

181 
	`u§ge
 (
¬gc
, 
¬gv
);

183 } ià(
	`¡rcmp
 (
İt
, "version") == 0) {

184 
is_v”siÚ
 = 
TRUE
;

185 } ià(
	`¡rcmp
 (
İt
, "udi") == 0) {

186 
udi
 = 
	`¡rdup
 (
İrg
);

187 } ià(
	`¡rcmp
 (
İt
, "run") == 0) {

188 
run
 = 
	`¡rdup
 (
İrg
);

189 } ià(
	`¡rcmp
 (
İt
, "exclusive") == 0) {

190 
exşusive
 = 
TRUE
;

191 } ià(
	`¡rcmp
 (
İt
, "interface") == 0) {

192 
š‹rçû
 = 
	`¡rdup
 (
İrg
);

193 } ià(
	`¡rcmp
 (
İt
, "exit-with-lock") == 0) {

194 
ex™_w™h_lock
 = 
TRUE
;

195 } ià(
	`¡rcmp
 (
İt
, "exit-with-dev") == 0) {

196 
ex™_w™h_dev
 = 
TRUE
;

201 
	`u§ge
 (
¬gc
, 
¬gv
);

207 ià(
is_v”siÚ
) {

208 
	`´štf
 ("h®-lock " 
PACKAGE_VERSION
 "\n");

209 
»t
 = 0;

210 
out
;

213 ià(
š‹rçû
 =ğ
NULL
 || 
run
 == NULL) {

214 
	`u§ge
 (
¬gc
, 
¬gv
);

215 
out
;

218 ià(
ex™_w™h_lock
 && 
udi
 =ğ
NULL
) {

219 
	`årštf
 (
¡d”r
, "--exit-with-lock„equires UDIo be given.\n");

220 
	`u§ge
 (
¬gc
, 
¬gv
);

221 
out
;

224 ià(
ex™_w™h_dev
 && 
udi
 =ğ
NULL
) {

225 
	`årštf
 (
¡d”r
, "--exit-with-lock„equires UDIo be given.\n");

226 
	`u§ge
 (
¬gc
, 
¬gv
);

227 
out
;

230 ià(
ex™_w™h_lock
 || 
ex™_w™h_dev
)

231 
loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

233 
loİ
 = 
NULL
;

236 
	`dbus_”rÜ_š™
 (&
”rÜ
);

237 ià((
h®_ùx
 = 
	`libh®_ùx_Ãw
 ()è=ğ
NULL
) {

238 
	`årštf
 (
¡d”r
, "error:†ibhal_ctx_new\n");

239 
out
;

241 
cÚ
 = 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
);

242 ià(
cÚ
 =ğ
NULL
) {

243 
	`årštf
 (
¡d”r
, "”rÜ: dbus_bus_g‘: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

244 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

245 
out
;

247 ià(!
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
h®_ùx
, 
cÚ
)) {

248 
	`årštf
 (
¡d”r
, "error:†ibhal_ctx_set_dbus_connection\n");

249 
out
;

252 ià(
ex™_w™h_lock
 || 
ex™_w™h_dev
) {

253 
unique_Çme
 = 
	`dbus_bus_g‘_unique_Çme
 (
cÚ
);

254 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚ
, 
NULL
);

257 ià(
ex™_w™h_lock
)

258 
	`libh®_ùx_£t_š‹rçû_lock_»Ëa£d
 (
h®_ùx
, 
š‹rçû_lock_»Ëa£d
);

260 ià(
ex™_w™h_dev
)

261 
	`libh®_ùx_£t_deviû_»moved
 (
h®_ùx
, 
deviû_»moved
);

263 ià(!
	`libh®_ùx_š™
 (
h®_ùx
, &
”rÜ
)) {

264 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

265 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_š™: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

266 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

268 
	`årštf
 (
¡d”r
, "Could‚ot initialise connectiono hald.\n"

270 
out
;

273 ià(
ex™_w™h_lock
)

274 
	`libh®_deviû_add_´İ”ty_w©ch
 (
h®_ùx
, 
udi
, &
”rÜ
);

276 ià(
udi
 !ğ
NULL
) {

277 
gÙ_lock
 = 
	`libh®_deviû_acquœe_š‹rçû_lock
 (
h®_ùx
,

278 
udi
,

279 
š‹rçû
,

280 
exşusive
,

281 &
”rÜ
);

283 
gÙ_lock
 = 
	`libh®_acquœe_glob®_š‹rçû_lock
 (
h®_ùx
,

284 
š‹rçû
,

285 
exşusive
,

286 &
”rÜ
);

289 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

290 
	`årštf
 (
¡d”r
,

292 
udi
 !ğ
NULL
 ? "libhal_device_acquire_interface_lock" :

294 
”rÜ
.
Çme
,

295 
”rÜ
.
mes§ge
);

296 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

297 
out
;

300 ià(!
gÙ_lock
) {

301 
out
;

304 ià(
ex™_w™h_lock
 || 
ex™_w™h_dev
) {

305 
_¬gc
;

306 **
_¬gv
;

308 ià(!
	`g_sh–l_·r£_¬gv
 (
run
, &
_¬gc
, &
_¬gv
, &
g_”rÜ
)) {

309 
	`årštf
 (
¡d”r
, "”rÜ: g_sh–l_·r£_¬gv: %s\n", 
g_”rÜ
->
mes§ge
);

310 
	`g_”rÜ_ä“
 (
g_”rÜ
);

311 
out
;

314 ià(!
	`g_¥awn_async
 (
NULL
,

315 
_¬gv
,

316 
NULL
,

317 
G_SPAWN_SEARCH_PATH
 | 
G_SPAWN_DO_NOT_REAP_CHILD
,

318 
NULL
,

319 
NULL
,

320 &
chd_pid
,

321 &
g_”rÜ
)) {

322 
	`årštf
 (
¡d”r
, "”rÜ: g_¥awn_commªd_lše_async: %s\n", 
g_”rÜ
->
mes§ge
);

323 
	`g_”rÜ_ä“
 (
g_”rÜ
);

324 
out
;

326 
	`g_chd_w©ch_add
 (
chd_pid
, 
gu¬dŸn
, 
NULL
);

327 
	`g_maš_loİ_run
 (
loİ
);

331 ià(!
	`g_¥awn_commªd_lše_sync
 (
run
,

332 
NULL
,

333 
NULL
,

334 
NULL
,

335 &
g_”rÜ
)) {

337 
	`årštf
 (
¡d”r
, "”rÜ: g_¥awn_commªd_lše_sync: %s\n", 
g_”rÜ
->
mes§ge
);

338 
	`g_”rÜ_ä“
 (
g_”rÜ
);

339 
out
;

343 
»t
 = 0;

345 
out
:

346  
»t
;

347 
	}
}

	@tools/hal-setup-keymap.c

22 #ifdeà
HAVE_CONFIG_H


23 
	~<cÚfig.h
>

26 
	~<¡dio.h
>

27 
	~<¡dlib.h
>

28 
	~<”ºo.h
>

29 
	~<¡ršg.h
>

30 
	~<fú.h
>

31 
	~<uni¡d.h
>

32 
	~<sys/ioùl.h
>

34 
	~"h®d/lšux/šput_loÿl.h
"

36 
	~"libh®/libh®.h
"

37 
	~"h®-£tup-keym­-hash-Çme.h
"

39 
LibH®CÚ‹xt
 *
	gùx
 = 
NULL
;

40 * 
	gudi
;

43 
	$evdev_İ’
 (cÚ¡ *
dev
)

45 
fd
;

48 
fd
 = 
	`İ’
 (
dev
, 
O_RDWR
);

49 ià(
fd
 < 0) {

50 
	`årštf
 (
¡d”r
, "hal-setup-keymap: failedo open('%s'): %s\n",

51 
dev
, 
	`¡»¼Ü
 (
”ºo
));

55  
fd
;

56 
	}
}

59 
	$evdev_£t_keycode
 (
fd
, 
sÿncode
, 
keycode
)

61 
»t
;

62 
codes
[2];

64 
codes
[0] = 
sÿncode
;

65 
codes
[1] = 
keycode
;

67 
»t
 = 
	`ioùl
 (
fd
, 
EVIOCSKEYCODE
, 
codes
);

68 ià(
»t
 < 0) {

69 
	`årštf
 (
¡d”r
, "hal-setup-keymap: failedo set scancode %xo keycode %d: %s\n",

70 
sÿncode
, 
keycode
, 
	`¡»¼Ü
(
”ºo
));

75 
	}
}

78 
	$maš
 (
¬gc
, **
¬gv
)

80 **
keym­_li¡
;

81 
i
 = 0;

82 
fd
;

83 
sÿncode
 = 0;

84 
keycode
 = 0;

85 
keyÇme
[128];

86 
v®ues
;

87 *
deviû
;

88 
DBusE¼Ü
 
”rÜ
;

89 cÚ¡ 
key
 *
Çme
;

91 
udi
 = 
	`g‘’v
 ("UDI");

92 ià(
udi
 =ğ
NULL
) {

93 
	`årštf
 (
¡d”r
, "hal-setup-keymap: Failedo get UDI\n");

96 
	`dbus_”rÜ_š™
 (&
”rÜ
);

97 ià((
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

98 
	`årštf
 (
¡d”r
, "h®-£tup-keym­: UÇbËØš™Ÿli£†ibh® cÚ‹xt: %s\n", 
”rÜ
.
mes§ge
);

102 
	`dbus_”rÜ_š™
 (&
”rÜ
);

103 ià(!
	`libh®_deviû_addÚ_is_»ady
 (
ùx
, 
udi
, &
”rÜ
)) {

108 
	`dbus_”rÜ_š™
 (&
”rÜ
);

109 
keym­_li¡
 = 
	`libh®_deviû_g‘_´İ”ty_¡¾i¡
 (
ùx
, 
udi
, "šput.keym­.d©a", &
”rÜ
);

110 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
è=ğ
TRUE
) {

111 
	`årštf
 (
¡d”r
, "h®-£tup-keym­: FaedØg‘ keym­†i¡: '%s'\n", 
”rÜ
.
mes§ge
);

116 
deviû
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
ùx
, 
udi
, "šput.deviû", &
”rÜ
);

117 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
è=ğ
TRUE
) {

118 
	`årštf
 (
¡d”r
, "h®-£tup-keym­: FaedØg‘ iÅuˆdeviû†i¡: '%s'\n", 
”rÜ
.
mes§ge
);

123 
	`årštf
 (
¡d”r
, "h®-£tup-keym­: Usšg deviû %s\n", 
deviû
);

124 
fd
 = 
	`evdev_İ’
 (
deviû
);

125 ià(
fd
 < 0) {

126 
	`årštf
 (
¡d”r
, "hal-setup-keymap: Could‚ot open device\n");

132 
v®ues
 = 
	`ssÿnf
 (
keym­_li¡
[
i
], "%x:%s", &
sÿncode
, 
keyÇme
);

133 ià(
v®ues
 == 2) {

137 ià(
sÿncode
 > 127) {

138 
sÿncode
 -= 0xe000;

139 
sÿncode
 += 128;

143 
Çme
 = 
	`lookup_key
 (
keyÇme
, 
	`¡¾’
(keyname));

144 ià(
Çme
 !ğ
NULL
) {

145 
keycode
 = 
Çme
->
id
;

146 
	`årštf
 (
¡d”r
, "hal-setup-keymap:…arsed %so (0x%x, %i)\n",

147 
keym­_li¡
[
i
], 
sÿncode
, 
keycode
);

148 
	`evdev_£t_keycode
 (
fd
, 
sÿncode
, 
keycode
);

150 
	`årštf
 (
¡d”r
, "h®-£tup-keym­: faedØfšd key '%s'\n", 
keyÇme
);

153 
	`årštf
 (
¡d”r
, "h®-£tup-keym­: FaedØ·r£ %s\n", 
keym­_li¡
[
i
]);

155 } 
keym­_li¡
[++
i
] !ğ
NULL
);

157 
	`libh®_ä“_¡ršg_¬¿y
 (
keym­_li¡
);

158 
	`şo£
 (
fd
);

162 
	}
}

	@tools/hal-storage-cleanup-all-mountpoints.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<uni¡d.h
>

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ršg.h
>

33 
	~<glib.h
>

34 
	~<glib/g¡dio.h
>

36 
	~"h®-¡Üage-sh¬ed.h
"

39 
	#DEBUG


	)

42 
	$u§ge
 ()

44 
	`årštf
 (
¡d”r
, "This…rogram should only be started by hald.\n");

45 
	`ex™
 (1);

46 
	}
}

49 
	$do_ş—nup
 ()

51 
i
, 
j
;

52 
FILE
 *
h®_mb_Üig
;

53 
h®_mb_Üig_Ën
;

54 
num_»ad
;

55 *
h®_mb_buf
;

56 **
lšes
;

57 
FILE
 *
h®_mb_Ãw
;

59 
h®_mb_Üig
 = 
	`fİ’
 ("/media/.hal-mtab", "r");

60 ià(
h®_mb_Üig
 =ğ
NULL
) {

61 
	`unknown_”rÜ
 ("Cannot open /media/.hal-mtab");

63 ià(
	`f£ek
 (
h®_mb_Üig
, 0L, 
SEEK_END
) != 0) {

64 
	`unknown_”rÜ
 ("Cannot seekoƒnd of /media/.hal-mtab");

66 
h®_mb_Üig_Ën
 = 
	`á–l
 (
h®_mb_Üig
);

67 ià(
h®_mb_Üig_Ën
 < 0) {

68 
	`unknown_”rÜ
 ("Cannot determine size of /media/.hal-mtab");

70 
	`»wšd
 (
h®_mb_Üig
);

71 
h®_mb_buf
 = 
	`g_Ãw0
 (, 
h®_mb_Üig_Ën
 + 1);

72 
num_»ad
 = 
	`ä—d
 (
h®_mb_buf
, 1, 
h®_mb_Üig_Ën
, 
h®_mb_Üig
);

73 ià(
num_»ad
 !ğ
h®_mb_Üig_Ën
) {

74 
	`unknown_”rÜ
 ("Cannot„ead from /media/.hal-mtab");

76 
	`fşo£
 (
h®_mb_Üig
);

78 #ifdeà
DEBUG


79 
	`´štf
 ("h®_mb = '%s'\n", 
h®_mb_buf
);

82 
lšes
 = 
	`g_¡r¥l™
 (
h®_mb_buf
, "\n", 0);

83 
	`g_ä“
 (
h®_mb_buf
);

86 
i
 = 0; 
lšes
[i] !ğ
NULL
; i++) {

87 **
lše_–em’ts
;

89 #ifdeà
DEBUG


90 
	`´štf
 ("†šğ'%s'\n", 
lšes
[
i
]);

93 ià((
lšes
[
i
])[0] == '#')

96 
lše_–em’ts
 = 
	`g_¡r¥l™
 (
lšes
[
i
], "\t", 6);

97 ià(
	`g_¡rv_Ëngth
 (
lše_–em’ts
) == 6) {

98 *
mouÁ_pošt
;

100 #ifdeà
DEBUG


101 
	`´štf
 (" devf = '%s'\n", 
lše_–em’ts
[0]);

102 
	`´štf
 (" uid = '%s'\n", 
lše_–em’ts
[1]);

103 
	`´štf
 (" sessiÚ id = '%s'\n", 
lše_–em’ts
[2]);

104 
	`´štf
 (" f  = '%s'\n", 
lše_–em’ts
[3]);

105 
	`´štf
 (" o±iÚ  = '%s'\n", 
lše_–em’ts
[4]);

106 
	`´štf
 (" mouÁ_pošˆğ'%s'\n", 
lše_–em’ts
[5]);

112 
mouÁ_pošt
 = 
lše_–em’ts
[5];

115 ià(
	`g_rmdœ
 (
mouÁ_pošt
) == 0) {

116 *
lše_to_ä“
;

118 
	`´štf
 ("Removed mouÁ_pošˆ'%s'", 
mouÁ_pošt
);

120 
lše_to_ä“
 = 
lšes
[
i
];

121 
j
 = 
i
; 
lšes
[j] !ğ
NULL
; j++) {

122 
lšes
[
j
] =†ines[j+1];

124 
lšes
[
j
] = 
NULL
;

125 
	`g_ä“
 (
lše_to_ä“
);

128 
i
--;

132 
	`g_¡rä“v
 (
lše_–em’ts
);

136 
h®_mb_Ãw
 = 
	`fİ’
 ("/media/.hal-mtab~", "w");

137 ià(
h®_mb_Ãw
 =ğ
NULL
) {

138 
	`unknown_”rÜ
 ("Cannot create /media/.hal-mtab~");

140 
i
 = 0; 
lšes
[i] !ğ
NULL
; i++) {

141 ià(
	`¡¾’
 (
lšes
[
i
]) > 0) {

142 
ªewl
[2] = "\n\0";

143 ià(
	`fwr™e
 (
lšes
[
i
], 1, 
	`¡¾’
 (lšes[i]), 
h®_mb_Ãw
) != strlen (lines[i])) {

144 
	`unknown_”rÜ
 ("Cannot writeo /media/.hal-mtab~");

146 ià(
	`fwr™e
 (
ªewl
, 1, 1, 
h®_mb_Ãw
) != 1) {

147 
	`unknown_”rÜ
 ("Cannot writeo /media/.hal-mtab~");

151 
	`fşo£
 (
h®_mb_Ãw
);

153 
	`g_¡rä“v
 (
lšes
);

156 ià(
	`»Çme
 ("/media/.hal-mtab~", "/media/.hal-mtab") != 0) {

157 
	`uÆšk
 ("/media/.hal-mtab~");

158 
	`unknown_”rÜ
 ("Cannot„ename /media/.hal-mtab~o /media/.hal-mtab");

160 
	}
}

163 
	$maš
 (
¬gc
, *
¬gv
[])

166 
	`uÆšk
 ("/media/.hal-mtab-lock");

168 ià(
	`g‘’v
 ("HAL_PROP_INFO_UDI"è=ğ
NULL
)

169 
	`u§ge
 ();

171 #ifdeà
DEBUG


172 
	`´štf
 ("in hal-storage-cleanup-all-mountpoints\n");

174 
	`do_ş—nup
 ();

177 
	}
}

	@tools/hal-storage-cleanup-mountpoint.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<uni¡d.h
>

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ršg.h
>

33 
	~<glib.h
>

34 
	~<glib/g¡dio.h
>

36 
	~"h®-¡Üage-sh¬ed.h
"

39 
	#DEBUG


	)

42 
	$u§ge
 ()

44 
	`årštf
 (
¡d”r
, "This…rogram should only be started by hald.\n");

45 
	`ex™
 (1);

46 
	}
}

49 
	$do_ş—nup
 (cÚ¡ *
mouÁ_pošt
)

51 
i
, 
j
;

52 
FILE
 *
h®_mb_Üig
;

53 
h®_mb_Üig_Ën
;

54 
num_»ad
;

55 *
h®_mb_buf
;

56 **
lšes
;

57 
FILE
 *
h®_mb_Ãw
;

58 
gboŞ—n
 
found
;

60 
h®_mb_Üig
 = 
	`fİ’
 ("/media/.hal-mtab", "r");

61 ià(
h®_mb_Üig
 =ğ
NULL
) {

62 
	`unknown_”rÜ
 ("Cannot open /media/.hal-mtab");

64 ià(
	`f£ek
 (
h®_mb_Üig
, 0L, 
SEEK_END
) != 0) {

65 
	`unknown_”rÜ
 ("Cannot seekoƒnd of /media/.hal-mtab");

67 
h®_mb_Üig_Ën
 = 
	`á–l
 (
h®_mb_Üig
);

68 ià(
h®_mb_Üig_Ën
 < 0) {

69 
	`unknown_”rÜ
 ("Cannot determine size of /media/.hal-mtab");

71 
	`»wšd
 (
h®_mb_Üig
);

72 
h®_mb_buf
 = 
	`g_Ãw0
 (, 
h®_mb_Üig_Ën
 + 1);

73 
num_»ad
 = 
	`ä—d
 (
h®_mb_buf
, 1, 
h®_mb_Üig_Ën
, 
h®_mb_Üig
);

74 ià(
num_»ad
 !ğ
h®_mb_Üig_Ën
) {

75 
	`unknown_”rÜ
 ("Cannot„ead from /media/.hal-mtab");

77 
	`fşo£
 (
h®_mb_Üig
);

79 #ifdeà
DEBUG


80 
	`´štf
 ("h®_mb = '%s'\n", 
h®_mb_buf
);

83 
lšes
 = 
	`g_¡r¥l™
 (
h®_mb_buf
, "\n", 0);

84 
	`g_ä“
 (
h®_mb_buf
);

87 
found
 = 
FALSE
;

88 
i
 = 0; 
lšes
[i] !ğ
NULL
 && !
found
; i++) {

89 **
lše_–em’ts
;

91 #ifdeà
DEBUG


92 
	`´štf
 ("†šğ'%s'\n", 
lšes
[
i
]);

95 ià((
lšes
[
i
])[0] == '#')

98 
lše_–em’ts
 = 
	`g_¡r¥l™
 (
lšes
[
i
], "\t", 6);

99 ià(
	`g_¡rv_Ëngth
 (
lše_–em’ts
) == 6) {

101 #ifdeà
DEBUG


102 
	`´štf
 (" devf = '%s'\n", 
lše_–em’ts
[0]);

103 
	`´štf
 (" uid = '%s'\n", 
lše_–em’ts
[1]);

104 
	`´štf
 (" sessiÚ id = '%s'\n", 
lše_–em’ts
[2]);

105 
	`´štf
 (" f  = '%s'\n", 
lše_–em’ts
[3]);

106 
	`´štf
 (" o±iÚ  = '%s'\n", 
lše_–em’ts
[4]);

107 
	`´štf
 (" mouÁ_pošˆğ'%s'\n", 
lše_–em’ts
[5]);

110 ià(
	`¡rcmp
 (
lše_–em’ts
[5], 
mouÁ_pošt
) == 0) {

111 *
lše_to_ä“
;

113 
found
 = 
TRUE
;

115 
lše_to_ä“
 = 
lšes
[
i
];

116 
j
 = 
i
; 
lšes
[j] !ğ
NULL
; j++) {

117 
lšes
[
j
] =†ines[j+1];

119 
lšes
[
j
] = 
NULL
;

120 
	`g_ä“
 (
lše_to_ä“
);

124 
	`g_¡rä“v
 (
lše_–em’ts
);

127 ià(!
found
) {

128 
	`unknown_”rÜ
 ("mount…oint is‚ot /media/.hal-mtab");

131 #ifdeà
DEBUG


132 
	`´štf
 ("FoundƒÁry fÜ mouÁ…ošˆ'%s' iÀ/medŸ/.h®-mb", 
mouÁ_pošt
);

136 
h®_mb_Ãw
 = 
	`fİ’
 ("/media/.hal-mtab~", "w");

137 ià(
h®_mb_Ãw
 =ğ
NULL
) {

138 
	`unknown_”rÜ
 ("Cannot create /media/.hal-mtab~");

140 
i
 = 0; 
lšes
[i] !ğ
NULL
; i++) {

141 ià(
i
 > 0) {

142 
ªewl
[2] = "\n\0";

143 ià(
	`fwr™e
 (
ªewl
, 1, 1, 
h®_mb_Ãw
) != 1) {

144 
	`unknown_”rÜ
 ("Cannot writeo /media/.hal-mtab~");

148 ià(
	`fwr™e
 (
lšes
[
i
], 1, 
	`¡¾’
 (lšes[i]), 
h®_mb_Ãw
) != strlen (lines[i])) {

149 
	`unknown_”rÜ
 ("Cannot writeo /media/.hal-mtab~");

153 
	`fşo£
 (
h®_mb_Ãw
);

155 
	`g_¡rä“v
 (
lšes
);

157 
	`´štf
 ("»movšg dœeùÜy: %s", 
mouÁ_pošt
);

160 ià(
	`g_rmdœ
 (
mouÁ_pošt
) != 0) {

161 
	`uÆšk
 ("/media/.hal-mtab~");

162 
	`unknown_”rÜ
 ("Cannot„emove directory");

165 
	`´štf
 ("atomically creating‚ew /media/.hal-mtab file");

168 ià(
	`»Çme
 ("/media/.hal-mtab~", "/media/.hal-mtab") != 0) {

169 
	`uÆšk
 ("/media/.hal-mtab~");

170 
	`unknown_”rÜ
 ("Cannot„ename /media/.hal-mtab~o /media/.hal-mtab");

173 
	`´štf
 ("h®-¡Üage-ş—nup-mouÁpošˆdÚfÜ %s", 
mouÁ_pošt
);

174 
	}
}

177 
	$maš
 (
¬gc
, *
¬gv
[])

179 *
mouÁ_pošt
;

181 ià(!
	`lock_h®_mb
 ()) {

182 
	`unknown_”rÜ
 ("Cannot obtain†ock on /media/.hal-mtab");

185 
mouÁ_pošt
 = 
	`g‘’v
 ("HALD_CLEANUP");

186 ià(
mouÁ_pošt
 =ğ
NULL
)

187 
	`u§ge
 ();

189 #ifdeà
DEBUG


190 
	`´štf
 ("š h®-¡Üage-ş—nup-mouÁpošˆfÜ mouÁ…ošˆ'%s'\n", 
mouÁ_pošt
);

192 
	`do_ş—nup
 (
mouÁ_pošt
);

195 
	`uÆock_h®_mb
 ();

197 
	}
}

	@tools/hal-storage-closetray.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

31 
	~<¡ršg.h
>

32 
	~<glib.h
>

33 
	~<glib/g¡dio.h
>

34 
	~<sys/ty³s.h
>

35 
	~<uni¡d.h
>

37 
	~<libh®.h
>

38 
	~<libh®-¡Üage.h
>

40 
	~"h®-¡Üage-sh¬ed.h
"

44 
	$u§ge
 ()

46 
	`årštf
 (
¡d”r
, "This…rogram should only be started by hald.\n");

47 
	`ex™
 (1);

48 
	}
}

52 
	$unknown_şo£Œay_”rÜ
 (cÚ¡ *
d‘a
)

54 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Storage.UnknownFailure\n");

55 
	`årštf
 (
¡d”r
, "%s\n", 
d‘a
);

56 
	`ex™
 (1);

57 
	}
}

61 
	$šv®id_şo£Œay_İtiÚ
 (cÚ¡ *
İtiÚ
, cÚ¡ *
uid
)

63 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Storage.InvalidCloseTrayOption\n");

64 
	`årštf
 (
¡d”r
, "ThİtiÚ '%s' i nÙ‡Îowed fÜ uid=%s\n", 
İtiÚ
, 
uid
);

65 
	`ex™
 (1);

66 
	}
}

69 
	$maš
 (
¬gc
, *
¬gv
[])

71 *
udi
;

72 *
deviû
;

73 
LibH®Drive
 *
drive
;

74 
DBusE¼Ü
 
”rÜ
;

75 
LibH®CÚ‹xt
 *
h®_ùx
 = 
NULL
;

76 
DBusCÚÃùiÚ
 *
sy¡em_bus
 = 
NULL
;

77 *
švoked_by_uid
;

78 *
švoked_by_syscÚ_Çme
;

79 
i
;

80 
şo£Œay_İtiÚs
[1024];

81 **
giv’_İtiÚs
;

82 cÚ¡ *
’d
;

84 
deviû
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_DEVICE");

85 ià(
deviû
 =ğ
NULL
)

86 
	`u§ge
 ();

88 
udi
 = 
	`g‘’v
 ("HAL_PROP_INFO_UDI");

89 ià(
udi
 =ğ
NULL
)

90 
	`u§ge
 ();

92 
švoked_by_uid
 = 
	`g‘’v
 ("HAL_METHOD_INVOKED_BY_UID");

94 
švoked_by_syscÚ_Çme
 = 
	`g‘’v
 ("HAL_METHOD_INVOKED_BY_SYSTEMBUS_CONNECTION_NAME");

96 
	`dbus_”rÜ_š™
 (&
”rÜ
);

97 ià((
h®_ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

98 
	`´štf
 ("Cannot connecto hald\n");

99 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

100 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

102 
	`u§ge
 ();

105 
	`dbus_”rÜ_š™
 (&
”rÜ
);

106 
sy¡em_bus
 = 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
);

107 ià(
sy¡em_bus
 =ğ
NULL
) {

108 
	`´štf
 ("Cannot connectohe system bus\n");

109 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

110 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

112 
	`u§ge
 ();

116 ià(
	`¡¾’
 (
	`fg‘s
 (
şo£Œay_İtiÚs
,  (şo£Œay_İtiÚs), 
¡dš
)) > 0)

117 
şo£Œay_İtiÚs
 [
	`¡¾’
 (closetray_options) - 1] = '\0';

119 ià(!
	`g_utf8_v®id©e
 (
şo£Œay_İtiÚs
, -1, &
’d
))

120 
	`unknown_şo£Œay_”rÜ
 ("Error validating closetray_options‡s UTF-8");

121 #ifdeà
DEBUG


122 
	`´štf
 ("şo£Œay_İtiÚ  = '%s'\n", 
şo£Œay_İtiÚs
);

126 
giv’_İtiÚs
 = 
	`g_¡r¥l™
 (
şo£Œay_İtiÚs
, "\t", 0);

127 
i
 = 
	`g_¡rv_Ëngth
 (
giv’_İtiÚs
) - 1; i >= 0; --i) {

128 ià(
	`¡¾’
 (
giv’_İtiÚs
[
i
]) > 0)

130 
giv’_İtiÚs
[
i
] = 
NULL
;

134 
i
 = 0; 
giv’_İtiÚs
[i] !ğ
NULL
; i++) {

135 *
giv’
 = 
giv’_İtiÚs
[
i
];

139 
	`šv®id_şo£Œay_İtiÚ
 (
giv’
, 
švoked_by_uid
);

141 
	`g_¡rä“v
 (
giv’_İtiÚs
);

144 ià((
drive
 = 
	`libh®_drive_äom_udi
 (
h®_ùx
, 
udi
)è=ğ
NULL
) {

145 
	`unknown_şo£Œay_”rÜ
 ("Cannot get drive");

149 
	`hªdË_ejeù
 (
sy¡em_bus
,

150 
h®_ùx
,

151 
	`libh®_drive_g‘_udi
 (
drive
),

152 
drive
,

153 
	`libh®_drive_g‘_deviû_fe
 (
drive
),

154 
švoked_by_uid
,

155 
švoked_by_syscÚ_Çme
,

156 
TRUE
 );

159 
	}
}

	@tools/hal-storage-eject.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡dio.h
>

29 
	~<¡dlib.h
>

30 
	~<¡ršg.h
>

31 
	~<glib.h
>

32 
	~<glib/g¡dio.h
>

33 
	~<sys/ty³s.h
>

34 
	~<uni¡d.h
>

36 
	~<libh®.h
>

37 
	~<libh®-¡Üage.h
>

39 
	~"h®-¡Üage-sh¬ed.h
"

42 *
	gdevty³
 = "Volume";

46 
	$u§ge
 ()

48 
	`årštf
 (
¡d”r
, "This…rogram should only be started by hald.\n");

49 
	`ex™
 (1);

50 
	}
}

54 
	$unknown_ejeù_”rÜ
 (cÚ¡ *
d‘a
)

56 
	`årštf
 (
¡d”r
, "Üg.ä“desktİ.H®.Deviû.%s.UnknownFau»\n", 
devty³
);

57 
	`årštf
 (
¡d”r
, "%s\n", 
d‘a
);

58 
	`ex™
 (1);

59 
	}
}

63 
	$šv®id_ejeù_İtiÚ
 (cÚ¡ *
İtiÚ
, cÚ¡ *
uid
)

65 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.InvalidEjectOption\n");

66 
	`årštf
 (
¡d”r
, "ThİtiÚ '%s' i nÙ‡Îowed fÜ uid=%s\n", 
İtiÚ
, 
uid
);

67 
	`ex™
 (1);

68 
	}
}

72 
	$maš
 (
¬gc
, *
¬gv
[])

74 *
udi
;

75 *
deviû
;

76 cÚ¡ *
drive_udi
;

77 
LibH®Drive
 *
drive
;

78 
LibH®VŞume
 *
vŞume
;

79 
DBusE¼Ü
 
”rÜ
;

80 
LibH®CÚ‹xt
 *
h®_ùx
 = 
NULL
;

81 
DBusCÚÃùiÚ
 *
sy¡em_bus
 = 
NULL
;

82 *
švoked_by_uid
;

83 *
švoked_by_syscÚ_Çme
;

84 **
vŞume_udis
;

85 
num_vŞumes
;

86 
i
;

87 
ejeù_İtiÚs
[1024];

88 **
giv’_İtiÚs
;

89 cÚ¡ *
’d
;

91 
deviû
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_DEVICE");

92 ià(
deviû
 =ğ
NULL
)

93 
	`u§ge
 ();

95 
udi
 = 
	`g‘’v
 ("HAL_PROP_INFO_UDI");

96 ià(
udi
 =ğ
NULL
)

97 
	`u§ge
 ();

99 
švoked_by_uid
 = 
	`g‘’v
 ("HAL_METHOD_INVOKED_BY_UID");

101 
švoked_by_syscÚ_Çme
 = 
	`g‘’v
 ("HAL_METHOD_INVOKED_BY_SYSTEMBUS_CONNECTION_NAME");

103 
	`dbus_”rÜ_š™
 (&
”rÜ
);

104 ià((
h®_ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

105 
	`´štf
 ("Cannot connecto hald\n");

106 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

107 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

109 
	`u§ge
 ();

112 
	`dbus_”rÜ_š™
 (&
”rÜ
);

113 
sy¡em_bus
 = 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
);

114 ià(
sy¡em_bus
 =ğ
NULL
) {

115 
	`´štf
 ("Cannot connectohe system bus\n");

116 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

117 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

119 
	`u§ge
 ();

123 ià(
	`¡¾’
 (
	`fg‘s
 (
ejeù_İtiÚs
,  (ejeù_İtiÚs), 
¡dš
)) > 0)

124 
ejeù_İtiÚs
 [
	`¡¾’
 (eject_options) - 1] = '\0';

126 ià(!
	`g_utf8_v®id©e
 (
ejeù_İtiÚs
, -1, &
’d
))

127 
	`unknown_ejeù_”rÜ
 ("Error validatingƒject_options‡s UTF-8");

128 #ifdeà
DEBUG


129 
	`´štf
 ("ejeù_İtiÚ  = '%s'\n", 
ejeù_İtiÚs
);

133 
giv’_İtiÚs
 = 
	`g_¡r¥l™
 (
ejeù_İtiÚs
, "\t", 0);

134 
i
 = 
	`g_¡rv_Ëngth
 (
giv’_İtiÚs
) - 1; i >= 0; --i) {

135 ià(
	`¡¾’
 (
giv’_İtiÚs
[
i
]) > 0)

137 
giv’_İtiÚs
[
i
] = 
NULL
;

141 
i
 = 0; 
giv’_İtiÚs
[i] !ğ
NULL
; i++) {

142 *
giv’
 = 
giv’_İtiÚs
[
i
];

146 
	`šv®id_ejeù_İtiÚ
 (
giv’
, 
švoked_by_uid
);

148 
	`g_¡rä“v
 (
giv’_İtiÚs
);

151 ià((
vŞume
 = 
	`libh®_vŞume_äom_udi
 (
h®_ùx
, 
udi
)è!ğ
NULL
) {

152 
drive_udi
 = 
	`libh®_vŞume_g‘_¡Üage_deviû_udi
 (
vŞume
);

154 
drive_udi
 = 
	`g_¡rdup
 (
udi
);

155 
devty³
 = "Storage";

157 ià(
drive_udi
 =ğ
NULL
) {

158 
	`unknown_ejeù_”rÜ
 ("Cannot get drive udi");

160 ià((
drive
 = 
	`libh®_drive_äom_udi
 (
h®_ùx
, 
drive_udi
)è=ğ
NULL
) {

161 
	`unknown_ejeù_”rÜ
 ("Cannot get drive from udi");

165 
vŞume_udis
 = 
	`libh®_drive_fšd_®l_vŞumes
 (
h®_ùx
, 
drive
, &
num_vŞumes
);

166 ià(
vŞume_udis
 =ğ
NULL
)

167 
	`unknown_ejeù_”rÜ
 ("Cannot get‡llƒnclosed volumes");

168 
i
 = 0; i < 
num_vŞumes
; i++) {

169 *
vŞume_udi
;

170 
LibH®VŞume
 *
vŞume_to_unmouÁ
;

172 
vŞume_udi
 = 
vŞume_udis
[
i
];

174 #ifdeà
DEBUG


175 
	`´štf
 ("´oûssšg drive' vŞum% (%d oà%d)\n", 
vŞume_udi
, 
i
 + 1, 
num_vŞumes
);

177 
vŞume_to_unmouÁ
 = 
	`libh®_vŞume_äom_udi
 (
h®_ùx
, 
vŞume_udi
);

178 ià(
vŞume_to_unmouÁ
 =ğ
NULL
) {

179 
	`unknown_ejeù_”rÜ
 ("Cannot get volume object");

182 ià(
	`libh®_vŞume_is_mouÁed
 (
vŞume_to_unmouÁ
)) {

183 #ifdeà
DEBUG


184 
	`´štf
 (" unmounting\n");

189 ià(!
	`lock_h®_mb
 ()) {

190 
	`unknown_ejeù_”rÜ
 ("Cannot obtain†ock on /media/.hal-mtab");

192 
	`hªdË_unmouÁ
 (
h®_ùx
,

193 
udi
, 
vŞume_to_unmouÁ
, 
drive
,

194 
	`libh®_vŞume_g‘_deviû_fe
 (
vŞume_to_unmouÁ
),

195 
švoked_by_uid
, 
švoked_by_syscÚ_Çme
,

196 
FALSE
, FALSE);

197 
	`uÆock_h®_mb
 ();

199 #ifdeà
DEBUG


200 
	`´štf
 ("‚ot mounted\n");

204 
	`libh®_vŞume_ä“
 (
vŞume_to_unmouÁ
);

207 
	`libh®_ä“_¡ršg_¬¿y
 (
vŞume_udis
);

210 
	`hªdË_ejeù
 (
sy¡em_bus
,

211 
h®_ùx
,

212 
	`libh®_drive_g‘_udi
 (
drive
),

213 
drive
,

214 
	`libh®_drive_g‘_deviû_fe
 (
drive
),

215 
švoked_by_uid
,

216 
švoked_by_syscÚ_Çme
,

217 
FALSE
);

220 
	}
}

	@tools/hal-storage-mount.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

31 
	~<¡ršg.h
>

32 
	~<glib.h
>

33 
	~<glib/g¡dio.h
>

34 #ifdeà
__F»eBSD__


35 
	~<f¡ab.h
>

36 
	~<sys/·¿m.h
>

37 
	~<sys/uüed.h
>

38 
	~<sys/mouÁ.h
>

39 
	~<lim™s.h
>

40 
	~<pwd.h
>

41 #–ià
sun


42 
	~<sys/mÁb.h
>

43 
	~<sys/vf¡ab.h
>

45 
	~<mÁ’t.h
>

47 
	~<sys/ty³s.h
>

48 
	~<uni¡d.h
>

49 
	~<”ºo.h
>

50 
	~<sy¦og.h
>

52 
	~<libh®.h
>

53 
	~<libh®-¡Üage.h
>

55 
	~"h®-¡Üage-sh¬ed.h
"

57 #ifdeà
__F»eBSD__


58 
	#MOUNT
 "/sbš/mouÁ"

	)

59 
	#MOUNT_OPTIONS
 "nÛxec,nosuid"

	)

60 
	#MOUNT_TYPE_OPT
 "-t"

	)

61 #–ià
sun


62 
	#MOUNT
 "/sbš/mouÁ"

	)

63 
	#MOUNT_OPTIONS
 "nÛxec,nosuid"

	)

64 
	#MOUNT_TYPE_OPT
 "-F"

	)

66 
	#MOUNT
 "/bš/mouÁ"

	)

67 
	#MOUNT_OPTIONS
 "nosuid,nodev"

	)

68 
	#MOUNT_TYPE_OPT
 "-t"

	)

72 
	$u§ge
 ()

74 
	`årštf
 (
¡d”r
, "This…rogram should only be started by hald.\n");

75 
	`ex™
 (1);

76 
	}
}

79 
	$³rmissiÚ_d’›d_vŞume_ignÜe
 (cÚ¡ *
deviû
)

81 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.PermissionDenied\n");

82 
	`årštf
 (
¡d”r
, "Deviû ha % vŞume.ignÜ£ˆtØTRUE. RefusšgØmouÁ.\n", 
deviû
);

83 
	`ex™
 (1);

84 
	}
}

87 
	$³rmissiÚ_d’›d_‘c_f¡ab
 (cÚ¡ *
deviû
)

89 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.PermissionDenied\n");

90 
	`årštf
 (
¡d”r
, "Deviû % i li¡ed iÀ/‘c/f¡ab. RefusšgØmouÁ.\n", 
deviû
);

91 
	`ex™
 (1);

92 
	}
}

95 
	$®»ady_mouÁed
 (cÚ¡ *
deviû
)

97 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.AlreadyMounted\n");

98 
	`årštf
 (
¡d”r
, "Deviû % i ®»ady mouÁed.\n", 
deviû
);

99 
	`ex™
 (1);

100 
	}
}

103 
	$šv®id_mouÁ_İtiÚ
 (cÚ¡ *
İtiÚ
, cÚ¡ *
uid
)

105 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.InvalidMountOption\n");

106 
	`årštf
 (
¡d”r
, "ThİtiÚ '%s' i nÙ‡Îowed fÜ uid=%s\n", 
İtiÚ
, 
uid
);

107 
	`ex™
 (1);

108 
	}
}

111 
	$unknown_fesy¡em
 (cÚ¡ *
fesy¡em
)

113 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.UnknownFilesystemType\n");

114 
	`årštf
 (
¡d”r
, "UnknowÀfsy¡em '%s'\n", 
fesy¡em
);

115 
	`ex™
 (1);

116 
	}
}

119 
	$šv®id_mouÁ_pošt
 (cÚ¡ *
mouÁ_pošt
)

121 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.InvalidMountpoint\n");

122 
	`årštf
 (
¡d”r
, "ThmouÁ…ošˆ'%s' i šv®id\n", 
mouÁ_pošt
);

123 
	`ex™
 (1);

124 
	}
}

127 
	$mouÁ_pošt_nÙ_avaabË
 (cÚ¡ *
mouÁ_pošt
)

129 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.MountPointNotAvailable\n");

130 
	`årštf
 (
¡d”r
, "ThmouÁ…ošˆ'%s' i ®»ady occup›d\n", 
mouÁ_pošt
);

131 
	`ex™
 (1);

132 
	}
}

136 
	$ÿÂÙ_»mouÁ
 (cÚ¡ *
deviû
)

138 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.CannotRemount\n");

139 
	`årštf
 (
¡d”r
, "% nÙ mouÁed‡Ì—dy\n", 
deviû
);

140 
	`ex™
 (1);

141 
	}
}

143 #ifdeà
HAVE_POLKIT


145 
	$³rmissiÚ_d’›d_aùiÚ
 (cÚ¡ *
aùiÚ
, cÚ¡ *
»suÉ
)

147 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.PermissionDeniedByPolicy\n");

148 
	`årštf
 (
¡d”r
, "% % <-- (aùiÚ,„esuÉ)\n", 
aùiÚ
, 
»suÉ
);

149 
	`ex™
 (1);

150 
	}
}

155 
	$ÿnÚiÿlize_f’ame
 (
gch¬
 *
f’ame
)

157 
gch¬
 *
p
, *
q
;

158 
gboŞ—n
 
Ï¡_was_¦ash
 = 
FALSE
;

160 
p
 = 
f’ame
;

161 
q
 = 
f’ame
;

163 *
p
)

165 ià(*
p
 =ğ
G_DIR_SEPARATOR
)

167 ià(!
Ï¡_was_¦ash
)

168 *
q
++ = 
G_DIR_SEPARATOR
;

170 
Ï¡_was_¦ash
 = 
TRUE
;

174 ià(
Ï¡_was_¦ash
 && *
p
 == '.')

176 ià(*(
p
 + 1è=ğ
G_DIR_SEPARATOR
 ||

177 *(
p
 + 1) == '\0')

179 ià(*(
p
 + 1) == '\0')

182 
p
 += 1;

184 ià(*(
p
 + 1) == '.' &&

185 (*(
p
 + 2è=ğ
G_DIR_SEPARATOR
 ||

186 *(
p
 + 2) == '\0'))

188 ià(
q
 > 
f’ame
 + 1)

190 
q
--;

191 
q
 > 
f’ame
 + 1 &&

192 *(
q
 - 1è!ğ
G_DIR_SEPARATOR
)

193 
q
--;

196 ià(*(
p
 + 2) == '\0')

199 
p
 += 2;

203 *
q
++ = *
p
;

204 
Ï¡_was_¦ash
 = 
FALSE
;

209 *
q
++ = *
p
;

210 
Ï¡_was_¦ash
 = 
FALSE
;

214 
p
++;

217 ià(
q
 > 
f’ame
 + 1 && *(q - 1è=ğ
G_DIR_SEPARATOR
)

218 
q
--;

220 *
q
 = '\0';

221 
	}
}

224 
	$»sŞve_symlšk
 (cÚ¡ *
fe
)

226 
GE¼Ü
 *
”rÜ
;

227 *
dœ
;

228 *
lšk
;

229 *
f
;

230 *
f1
;

232 
f
 = 
	`g_¡rdup
 (
fe
);

234 
	`g_fe_‹¡
 (
f
, 
G_FILE_TEST_IS_SYMLINK
)) {

235 
lšk
 = 
	`g_fe_»ad_lšk
 (
f
, &
”rÜ
);

236 ià(
lšk
 =ğ
NULL
) {

237 
	`g_w¬nšg
 ("CªnÙ„esŞvsymlšk %s: %s", 
f
, 
”rÜ
->
mes§ge
);

238 
	`g_”rÜ_ä“
 (
”rÜ
);

239 
	`g_ä“
 (
f
);

240 
f
 = 
NULL
;

241 
out
;

244 
dœ
 = 
	`g_·th_g‘_dœÇme
 (
f
);

245 
f1
 = 
	`g_¡rdup_´štf
 ("%s/%s", 
dœ
, 
lšk
);

246 
	`g_ä“
 (
dœ
);

247 
	`g_ä“
 (
lšk
);

248 
	`g_ä“
 (
f
);

249 
f
 = 
f1
;

252 
out
:

253 ià(
f
 !ğ
NULL
)

254 
	`ÿnÚiÿlize_f’ame
 (
f
);

255  
f
;

256 
	}
}

258 
LibH®VŞume
 *

259 
	$vŞume_fšdby
 (
LibH®CÚ‹xt
 *
h®_ùx
, cÚ¡ *
´İ”ty
, cÚ¡ *
v®ue
)

261 
i
;

262 **
h®_udis
;

263 
num_h®_udis
;

264 
LibH®VŞume
 *
»suÉ
 = 
NULL
;

265 *
found_udi
 = 
NULL
;

266 
DBusE¼Ü
 
”rÜ
;

268 
	`dbus_”rÜ_š™
 (&
”rÜ
);

269 ià((
h®_udis
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
h®_ùx
, 
´İ”ty
,

270 
v®ue
, &
num_h®_udis
, &
”rÜ
)è=ğ
NULL
) {

271 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

272 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

274 
out
;

276 
i
 = 0; i < 
num_h®_udis
; i++) {

277 *
udi
;

278 
udi
 = 
h®_udis
[
i
];

279 ià(
	`libh®_deviû_qu”y_ÿ·b™y
 (
h®_ùx
, 
udi
, "vŞume", &
”rÜ
)) {

280 
found_udi
 = 
	`¡rdup
 (
udi
);

285 
	`libh®_ä“_¡ršg_¬¿y
 (
h®_udis
);

287 ià(
found_udi
 !ğ
NULL
)

288 
»suÉ
 = 
	`libh®_vŞume_äom_udi
 (
h®_ùx
, 
found_udi
);

290 
	`ä“
 (
found_udi
);

291 
out
:

292  
»suÉ
;

293 
	}
}

296 
	$baout_if_š_f¡ab
 (
LibH®CÚ‹xt
 *
h®_ùx
, cÚ¡ *
deviû
, cÚ¡ *
Ïb–
, cÚ¡ *
uuid
)

298 
gpoš‹r
 
hªdË
;

299 *
’Œy
;

300 *
_mouÁ_pošt
;

302 
	`´štf
 ("†ab– '%s' uuid '%s'\n", 
Ïb–
 ?†ab– : "" , 
uuid
 ? uuid : "");

305 ià(! 
	`f¡ab_İ’
 (&
hªdË
)) {

306 
	`´štf
 ("cannot open /etc/fstab\n");

307 
	`unknown_”rÜ
 ("Cannot open /etc/fstab");

309 (
’Œy
 = 
	`f¡ab_Ãxt
 (
hªdË
, &
_mouÁ_pošt
)è!ğ
NULL
) {

310 *
»sŞved
;

312 #ifdeà
DEBUG


313 
	`´štf
 ("Lookšg‡ˆ/‘c/f¡abƒÁry '%s'\n", 
’Œy
);

315 ià(
Ïb–
 !ğ
NULL
 && 
	`g_¡r_has_´efix
 (
’Œy
, "LABEL=")) {

316 ià(
	`¡rcmp
 (
’Œy
 + 6, 
Ïb–
) == 0) {

317 
gboŞ—n
 
sk_f¡ab_’Œy
;

319 
sk_f¡ab_’Œy
 = 
FALSE
;

340 ià(
_mouÁ_pošt
 !ğ
NULL
) {

341 
LibH®VŞume
 *
mouÁed_vŞ
;

343 
mouÁed_vŞ
 = 
	`vŞume_fšdby
 (
h®_ùx
, "vŞume.mouÁ_pošt", 
_mouÁ_pošt
);

344 ià(
mouÁed_vŞ
 !ğ
NULL
) {

345 cÚ¡ *
mouÁed_vŞ_deviû_fe
;

347 
mouÁed_vŞ_deviû_fe
 = 
	`libh®_vŞume_g‘_deviû_fe
 (
mouÁed_vŞ
);

349 ià(
mouÁed_vŞ_deviû_fe
 !ğ
NULL
 &&

350 
	`¡rcmp
 (
mouÁed_vŞ_deviû_fe
, 
deviû
) !=0) {

351 #ifdeà
DEBUG


352 
	`´štf
 ("Wantingo mount %shat has†abel %s, but /etc/fstab says LABEL=%s iso be mounted‡t mount…oint '%s'. However %s (that‡lso has†abel %s), is‡lready mounted‡t said mount…oint. So, skipping said /etc/fstabƒntry.\n",

353 
deviû
, 
Ïb–
,†ab–, 
_mouÁ_pošt
, 
mouÁed_vŞ_deviû_fe
, _mount_point);

355 
sk_f¡ab_’Œy
 = 
TRUE
;

357 
	`libh®_vŞume_ä“
 (
mouÁed_vŞ
);

361 ià(!
sk_f¡ab_’Œy
) {

362 
	`´štf
 ("% found iÀ/‘c/f¡ab. NÙ mouÁšg.\n", 
’Œy
);

363 
	`³rmissiÚ_d’›d_‘c_f¡ab
 (
deviû
);

366 } ià(
uuid
 !ğ
NULL
 && 
	`g_¡r_has_´efix
 (
’Œy
, "UUID=")) {

367 ià(
	`¡rcmp
 (
’Œy
 + 5, 
uuid
) == 0) {

368 
	`´štf
 ("% found iÀ/‘c/f¡ab. NÙ mouÁšg.\n", 
’Œy
);

369 
	`³rmissiÚ_d’›d_‘c_f¡ab
 (
deviû
);

373 
»sŞved
 = 
	`»sŞve_symlšk
 (
’Œy
);

374 #ifdeà
DEBUG


375 
	`´štf
 ("/‘c/f¡ab: deviû % -> % \n", 
’Œy
, 
»sŞved
);

377 ià(
	`¡rcmp
 (
deviû
, 
»sŞved
) == 0) {

378 
	`´štf
 ("% (-> %sèfound iÀ/‘c/f¡ab. NÙ mouÁšg.\n", 
’Œy
, 
»sŞved
);

379 
	`³rmissiÚ_d’›d_‘c_f¡ab
 (
deviû
);

382 
	`g_ä“
 (
»sŞved
);

385 
	`f¡ab_şo£
 (
hªdË
);

386 
	}
}

388 
gboŞ—n


389 
	$deviû_is_mouÁed
 (cÚ¡ *
deviû
, **
mouÁ_pošt
)

391 
gpoš‹r
 
hªdË
;

392 *
’Œy
;

393 
gboŞ—n
 
»t
;

395 
»t
 = 
FALSE
;

398 ià(! 
	`mb_İ’
 (&
hªdË
)) {

399 
	`´štf
 ("cannot open mount†ist\n");

400 
	`unknown_”rÜ
 ("Cannot open /etc/mtab orƒquivalent");

402 ((
’Œy
 = 
	`mb_Ãxt
 (
hªdË
, 
mouÁ_pošt
)è!ğ
NULL
è&& (
»t
 =ğ
FALSE
)) {

403 *
»sŞved
;

405 
»sŞved
 = 
	`»sŞve_symlšk
 (
’Œy
);

406 #ifdeà
DEBUG


407 
	`´štf
 ("/´oc/mouÁs: deviû % -> % \n", 
’Œy
, 
»sŞved
);

409 ià(
	`¡rcmp
 (
deviû
, 
»sŞved
) == 0) {

410 
	`´štf
 ("% (-> %sèfound iÀmouÁ†i¡. NÙ mouÁšg.\n", 
’Œy
, 
»sŞved
);

411 
»t
 = 
TRUE
;

414 
	`g_ä“
 (
»sŞved
);

416 
	`mb_şo£
 (
hªdË
);

417  
»t
;

418 
	}
}

422 
	$m­_f¡y³
 (cÚ¡ *
f¡y³
)

424 #ifdeà
__F»eBSD__


425 ià(! 
	`¡rcmp
 (
f¡y³
, "iso9660"))

427 ià(! 
	`¡rcmp
 (
f¡y³
, "ext2"))

429 ià(! 
	`¡rcmp
 (
f¡y³
, "ext3"))

431 ià(! 
	`¡rcmp
 (
f¡y³
, "vfat"))

433 #–ià
sun


434 ià(! 
	`¡rcmp
 (
f¡y³
, "iso9660"))

436 ià(! 
	`¡rcmp
 (
f¡y³
, "vfat"))

440  
f¡y³
;

441 
	}
}

444 
	$hªdË_mouÁ
 (
LibH®CÚ‹xt
 *
h®_ùx
,

445 cÚ¡ *
udi
,

446 
LibH®VŞume
 *
vŞume
, 
LibH®Drive
 *
drive
, cÚ¡ *
deviû
,

447 cÚ¡ *
švoked_by_uid
, cÚ¡ *
švoked_by_syscÚ_Çme
)

449 
i
, 
j
;

450 
DBusE¼Ü
 
”rÜ
;

451 
mouÁ_pošt
[256];

452 
mouÁ_f¡y³
[256];

453 
mouÁ_İtiÚs
[1024];

454 **
®lowed_İtiÚs
;

455 **
giv’_İtiÚs
;

456 
gboŞ—n
 
wªts_to_chªge_uid
;

457 *
mouÁ_dœ
;

458 
GE¼Ü
 *
”r
 = 
NULL
;

459 *
sout
 = 
NULL
;

460 *
£¼
 = 
NULL
;

461 *
mouÁ_İtiÚ_comma£p
 = 
NULL
;

462 *
mouÁ_do_f¡y³
 = 
NULL
;

463 
ex™_¡©us
;

464 *
¬gs
[10];

465 
Ç
;

466 
GSŒšg
 *
mouÁ_İtiÚ_¡r
;

467 
gboŞ—n
 
pŞ_is_fixed
;

468 
gboŞ—n
 
pŞ_chªge_uid
;

469 *
aùiÚ
;

470 
gboŞ—n
 
is_»mouÁ
;

471 
gboŞ—n
 
ex¶ic™_mouÁ_pošt_giv’
;

472 
gboŞ—n
 
found_®‹º©ive_f¡y³
 = 
FALSE
;

473 cÚ¡ *
’d
;

474 #ifdeà
__F»eBSD__


475 
·sswd
 *
pw
;

476 
uid_t
 
ÿÎšg_uid
;

477 
gid_t
 
ÿÎšg_gid
;

479 cÚ¡ *
Ïb–
;

480 cÚ¡ *
uuid
;

482 #ifdeà
DEBUG


483 
	`´štf
 ("deviû = %s\n", 
deviû
);

484 
	`´štf
 ("švoked by uid = %s\n", 
švoked_by_uid
);

485 
	`´štf
 ("švoked by sy¡em bu cÚÃùiÚ = %s\n", 
švoked_by_syscÚ_Çme
);

488 ià(
vŞume
 !ğ
NULL
) {

489 
	`dbus_”rÜ_š™
 (&
”rÜ
);

490 ià(
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
h®_ùx
, 
udi
, "vŞume.ignÜe", &
”rÜ
) ||

491 
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

492 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

493 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

495 
	`³rmissiÚ_d’›d_vŞume_ignÜe
 (
deviû
);

498 
Ïb–
 = 
	`libh®_vŞume_g‘_Ïb–
 (
vŞume
);

499 
uuid
 = 
	`libh®_vŞume_g‘_uuid
 (
vŞume
);

501 
Ïb–
 = 
NULL
;

502 
uuid
 = 
NULL
;

505 
	`baout_if_š_f¡ab
 (
h®_ùx
, 
deviû
, 
Ïb–
, 
uuid
);

507 
	`baout_if_drive_is_locked
 (
h®_ùx
, 
drive
, 
švoked_by_syscÚ_Çme
);

512 ià(
	`¡¾’
 (
	`fg‘s
 (
mouÁ_pošt
,  (mouÁ_pošt), 
¡dš
)) > 0)

513 
mouÁ_pošt
 [
	`¡¾’
 (mount_point) - 1] = '\0';

514 ià(
	`¡¾’
 (
	`fg‘s
 (
mouÁ_f¡y³
,  (mouÁ_f¡y³), 
¡dš
)) > 0)

515 
mouÁ_f¡y³
 [
	`¡¾’
 (mount_fstype) - 1] = '\0';

516 ià(
	`¡¾’
 (
	`fg‘s
 (
mouÁ_İtiÚs
,  (mouÁ_İtiÚs), 
¡dš
)) > 0)

517 
mouÁ_İtiÚs
 [
	`¡¾’
 (mount_options) - 1] = '\0';

519 ià(!
	`g_utf8_v®id©e
 (
mouÁ_pošt
, -1, &
’d
))

520 
	`unknown_”rÜ
 ("Error validating mount_point‡s UTF-8");

521 ià(!
	`g_utf8_v®id©e
 (
mouÁ_f¡y³
, -1, &
’d
))

522 
	`unknown_”rÜ
 ("Error validating mount_fstype‡s UTF-8");

523 ià(!
	`g_utf8_v®id©e
 (
mouÁ_İtiÚs
, -1, &
’d
))

524 
	`unknown_”rÜ
 ("Error validating mount_options‡s UTF-8");

526 
i
 = 0; 
mouÁ_pošt
[i] != '\0'; i++) {

527 ià(
mouÁ_pošt
[
i
] == '\n' ||

528 
mouÁ_pošt
[
i
] =ğ
G_DIR_SEPARATOR
) {

529 
	`unknown_”rÜ
 ("mount_point cannot containhe following characters:‚ewline, G_DIR_SEPARATOR (usually /)");

533 #ifdeà
DEBUG


534 
	`´štf
 ("mouÁ_pošˆ = '%s'\n", 
mouÁ_pošt
);

535 
	`´štf
 ("mouÁ_f¡y³ = '%s'\n", 
mouÁ_f¡y³
);

536 
	`´štf
 ("mouÁ_İtiÚ  = '%s'\n", 
mouÁ_İtiÚs
);

540 
giv’_İtiÚs
 = 
	`g_¡r¥l™
 (
mouÁ_İtiÚs
, "\t", 0);

541 
i
 = 
	`g_¡rv_Ëngth
 (
giv’_İtiÚs
) - 1; i >= 0; --i) {

542 ià(
	`¡¾’
 (
giv’_İtiÚs
[
i
]) > 0)

544 
giv’_İtiÚs
[
i
] = 
NULL
;

548 
is_»mouÁ
 = 
FALSE
;

549 
i
 = 0; i < (è
	`g_¡rv_Ëngth
 (
giv’_İtiÚs
); i++) {

550 ià(
	`¡rcmp
 (
giv’_İtiÚs
[
i
], "remount") == 0) {

551 
is_»mouÁ
 = 
TRUE
;

555 
mouÁ_dœ
 = 
NULL
;

556 ià(
is_»mouÁ
) {

557 ià(
vŞume
 !ğ
NULL
) {

558 ià(!
	`libh®_vŞume_is_mouÁed
 (
vŞume
)) {

559 
	`ÿÂÙ_»mouÁ
 (
deviû
);

561 
mouÁ_dœ
 = 
	`g_¡rdup
 (
	`libh®_vŞume_g‘_mouÁ_pošt
 (
vŞume
));

563 ià(!
	`deviû_is_mouÁed
 (
deviû
, &
mouÁ_dœ
)) {

564 
	`ÿÂÙ_»mouÁ
 (
deviû
);

568 ià(
mouÁ_dœ
 =ğ
NULL
) {

569 
	`unknown_”rÜ
 ("Cannot get mount_dir for„emountƒvenhough volume is mounted!");

573 ià(
vŞume
 !ğ
NULL
) {

574 ià(
	`libh®_vŞume_is_mouÁed
 (
vŞume
)) {

575 
	`®»ady_mouÁed
 (
deviû
);

578 ià(
	`deviû_is_mouÁed
 (
deviû
, 
NULL
)) {

579 
	`®»ady_mouÁed
 (
deviû
);

584 ià(!
is_»mouÁ
) {

586 
ex¶ic™_mouÁ_pošt_giv’
 = 
FALSE
;

587 ià(
	`¡¾’
 (
mouÁ_pošt
) == 0) {

588 *
p
;

590 ià(
Ïb–
 !ğ
NULL
) {

592 
	`g_¡¾ıy
 (
mouÁ_pošt
, 
Ïb–
,  (mount_point));

598 
	`g_¢´štf
 (
mouÁ_pošt
,  (mount_point), "%s", "disk");

602 
p
 = 
mouÁ_pošt
;

603 
TRUE
) {

604 
p
 = 
	`g_utf8_¡rchr
 (
mouÁ_pošt
, -1, 
G_DIR_SEPARATOR
);

605 ià(
p
 =ğ
NULL
)

607 *
p
 = '-';

611 
ex¶ic™_mouÁ_pošt_giv’
 = 
TRUE
;

615 ià(
	`g_utf8_¡rchr
 (
mouÁ_pošt
, -1, 
G_DIR_SEPARATOR
è!ğ
NULL
) {

616 
	`´štf
 ("'%s' i ª inv®id mouÁ…ošt\n", 
mouÁ_pošt
);

617 
	`šv®id_mouÁ_pošt
 (
mouÁ_pošt
);

621 
i
 = 0;

622 
mouÁ_dœ
 = 
NULL
;

623 
TRUE
) {

624 
	`g_ä“
 (
mouÁ_dœ
);

625 ià(
i
 == 0)

626 
mouÁ_dœ
 = 
	`g_¡rdup_´štf
 ("/medŸ/%s", 
mouÁ_pošt
);

628 
mouÁ_dœ
 = 
	`g_¡rdup_´štf
 ("/medŸ/%s-%d", 
mouÁ_pošt
, 
i
);

630 #ifdeà
DEBUG


631 
	`´štf
 ("Œyšg dœ %s\n", 
mouÁ_dœ
);

634 ià(!
	`g_fe_‹¡
 (
mouÁ_dœ
, 
G_FILE_TEST_EXISTS
)) {

638 ià(
ex¶ic™_mouÁ_pošt_giv’
) {

639 
	`mouÁ_pošt_nÙ_avaabË
 (
mouÁ_dœ
);

642 
i
++;

647 
Ç
 = 0;

649 
¬gs
[
Ç
++] = 
MOUNT
;

651 ià(
	`¡¾’
 (
mouÁ_f¡y³
) > 0) {

652 
mouÁ_do_f¡y³
 = (*è
	`m­_f¡y³
 (
mouÁ_f¡y³
);

653 ià(
vŞume
 && 
	`¡rcmp
(
mouÁ_do_f¡y³
, 
mouÁ_f¡y³
) == 0) {

655 cÚ¡ *
_f¡y³
;

657 
_f¡y³
 = 
	`libh®_vŞume_g‘_f¡y³
 (
vŞume
);

659 ià(
_f¡y³
 && (
	`¡rcmp
(_f¡y³, 
mouÁ_f¡y³
) != 0)) {

661 **
®‹º©ive
;

663 
	`dbus_”rÜ_š™
 (&
”rÜ
);

664 
®‹º©ive
 = 
	`libh®_deviû_g‘_´İ”ty_¡¾i¡
 (
h®_ùx
, 
udi
, "vŞume.f¡y³.®‹º©ive", &
”rÜ
);

665 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

666 
	`unknown_”rÜ
 ("Cannot get volume.fstype.alternative");

667 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

668 } ià(
®‹º©ive
 !ğ
NULL
) {

669 
i
 = 0; 
®‹º©ive
[i] !ğ
NULL
; i++) {

670 #ifdeà
DEBUG


671 
	`´štf
 ("check vŞume.f¡y³.®‹º©ive[%d]='%s' fÜ giv’ f¡y³ '%s'\n", 
i
, 
®‹º©ive
[i], 
mouÁ_f¡y³
);

673 ià(
	`¡rcmp
(
®‹º©ive
[
i
], 
mouÁ_f¡y³
) == 0) {

674 
	`´štf
 ("found_alternative_fstype = TRUE\n");

675 
found_®‹º©ive_f¡y³
 = 
TRUE
;

679 
	`libh®_ä“_¡ršg_¬¿y
(
®‹º©ive
);

681 ià(!
found_®‹º©ive_f¡y³
) {

691 } ià(
vŞume
 =ğ
NULL
) {

693 
mouÁ_do_f¡y³
 = "auto";

694 } ià(
	`libh®_vŞume_g‘_f¡y³
 (
vŞume
è!ğ
NULL
 && 
	`¡¾’
 (libhal_volume_get_fstype (volume)) > 0) {

695 
mouÁ_do_f¡y³
 = (*è
	`m­_f¡y³
 (
	`libh®_vŞume_g‘_f¡y³
 (
vŞume
));

697 
mouÁ_do_f¡y³
 = "auto";

701 
	`dbus_”rÜ_š™
 (&
”rÜ
);

703 ià(
found_®‹º©ive_f¡y³
) {

704 
key
[128];

706 
	`¥rštf
(
key
, "vŞume.mouÁ.%s.v®id_İtiÚs", 
mouÁ_do_f¡y³
);

707 #ifdeà
DEBUG


708 
	`´štf
 ("found‡É”Çtivf¡y³='mouÁ_do_f¡y³' checkšg‚ow '%s'", 
key
);

710 
®lowed_İtiÚs
 = 
	`libh®_deviû_g‘_´İ”ty_¡¾i¡
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
);

712 
®lowed_İtiÚs
 = 
	`libh®_deviû_g‘_´İ”ty_¡¾i¡
 (
h®_ùx
, 
udi
, "vŞume.mouÁ.v®id_İtiÚs", &
”rÜ
);

714 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

715 
	`unknown_”rÜ
 ("Cannot get volume.mount.valid_options");

716 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

719 #ifdeà
DEBUG


720 
i
 = 0; 
giv’_İtiÚs
[i] !ğ
NULL
; i++)

721 
	`´štf
 ("giv’_İtiÚs[%d] = '%s'\n", 
i
, 
giv’_İtiÚs
[i]);

722 
i
 = 0; 
®lowed_İtiÚs
[i] !ğ
NULL
; i++)

723 
	`´štf
 ("®lowed_İtiÚs[%d] = '%s'\n", 
i
, 
®lowed_İtiÚs
[i]);

726 
wªts_to_chªge_uid
 = 
FALSE
;

729 
i
 = 0; 
giv’_İtiÚs
[i] !ğ
NULL
; i++) {

730 *
giv’
 = 
giv’_İtiÚs
[
i
];

732 
j
 = 0; 
®lowed_İtiÚs
[j] !ğ
NULL
; j++) {

733 *
®low
 = 
®lowed_İtiÚs
[
j
];

734 
®low_Ën
 = 
	`¡¾’
 (
®low
);

736 ià(
	`¡rcmp
 (
giv’
, 
®low
) == 0) {

737 
İtiÚ_ok
;

740 ià((
®low
[
®low_Ën
 - 1] == '=') &&

741 (
	`¡ºcmp
 (
giv’
, 
®low
, 
®low_Ën
) == 0) &&

742 (è
	`¡¾’
 (
giv’
è> 
®low_Ën
) {

747 ià(
	`¡rcmp
 (
®low
, "uid=") == 0) {

748 
uid_t
 
uid
;

749 *
’dp
;

751 
uid
 = (
uid_t
è
	`¡¹Ş
 (
giv’
 + 
®low_Ën
, &
’dp
, 10);

752 ià(*
’dp
 != '\0') {

753 
	`´štf
 ("'%s' i nÙ‡‚umb”?\n", 
giv’
);

754 
	`unknown_”rÜ
 ("option uid is malformed");

756 #ifdeà
DEBUG


757 
	`´štf
 ("% w™h uid %u\n", 
®low
, 
uid
);

759 
wªts_to_chªge_uid
 = 
TRUE
;

761 
İtiÚ_ok
;

764 
İtiÚ_ok
;

770 
	`šv®id_mouÁ_İtiÚ
 (
giv’
, 
švoked_by_uid
);

772 
İtiÚ_ok
:

777 
pŞ_is_fixed
 = 
TRUE
;

778 ià(
	`libh®_drive_is_hÙ¶uggabË
 (
drive
è|| 
	`libh®_drive_u£s_»movabË_medŸ
 (drive))

779 
pŞ_is_fixed
 = 
FALSE
;

781 
pŞ_chªge_uid
 = 
FALSE
;

785 ià(
vŞume
 !ğ
NULL
) {

789 ià(
	`¡rcmp
 (
	`libh®_vŞume_g‘_f¡y³
 (
vŞume
), "vfat") != 0 &&

790 
	`¡rcmp
 (
	`libh®_vŞume_g‘_f¡y³
 (
vŞume
), "ntfs") != 0 &&

791 
	`¡rcmp
 (
	`libh®_vŞume_g‘_f¡y³
 (
vŞume
), "ntfs-3g") != 0 &&

792 
	`¡rcmp
 (
	`libh®_vŞume_g‘_f¡y³
 (
vŞume
), "iso9660") != 0 &&

793 
	`¡rcmp
 (
	`libh®_vŞume_g‘_f¡y³
 (
vŞume
), "hfs") != 0 &&

794 
	`¡rcmp
 (
	`libh®_vŞume_g‘_f¡y³
 (
vŞume
), "udf") != 0) {

795 
pŞ_chªge_uid
 = 
wªts_to_chªge_uid
;

799 
¬gs
[
Ç
++] = 
MOUNT_TYPE_OPT
;

800 
¬gs
[
Ç
++] = 
mouÁ_do_f¡y³
;

802 
¬gs
[
Ç
++] = "-o";

803 #ifdeà
HAVE_UMOUNT_HAL


804 
mouÁ_İtiÚ_¡r
 = 
	`g_¡ršg_Ãw
 (
MOUNT_OPTIONS
 ",uhelper=hal");

806 
mouÁ_İtiÚ_¡r
 = 
	`g_¡ršg_Ãw
 (
MOUNT_OPTIONS
);

808 
i
 = 0; 
giv’_İtiÚs
[i] !ğ
NULL
; i++) {

809 
	`g_¡ršg_­³nd
 (
mouÁ_İtiÚ_¡r
, ",");

810 
	`g_¡ršg_­³nd
 (
mouÁ_İtiÚ_¡r
, 
giv’_İtiÚs
[
i
]);

812 
mouÁ_İtiÚ_comma£p
 = 
	`g_¡ršg_ä“
 (
mouÁ_İtiÚ_¡r
, 
FALSE
);

813 
¬gs
[
Ç
++] = 
mouÁ_İtiÚ_comma£p
;

814 
¬gs
[
Ç
++] = (*è
deviû
;

815 
¬gs
[
Ç
++] = 
mouÁ_dœ
;

816 
¬gs
[
Ç
++] = 
NULL
;

818 ià(
pŞ_is_fixed
) {

819 ià(
pŞ_chªge_uid
) {

820 
aùiÚ
 = 
NULL
;

822 
aùiÚ
 = "org.freedesktop.hal.storage.mount-fixed";

825 ià(
pŞ_chªge_uid
) {

826 
aùiÚ
 = 
NULL
;

828 
aùiÚ
 = "org.freedesktop.hal.storage.mount-removable";

831 ià(
aùiÚ
 =ğ
NULL
) {

832 
	`unknown_”rÜ
 ("TODO: haveo„ethinkƒxtra options");

835 #ifdeà
DEBUG


836 
	`´štf
 ("usšg‡ùiÚ % fÜ uid %s, sy¡em_bus_cÚÃùiÚ %s\n", 
aùiÚ
, 
švoked_by_uid
,

837 
švoked_by_syscÚ_Çme
);

840 #ifdeà
HAVE_POLKIT


841 ià(
švoked_by_syscÚ_Çme
 !ğ
NULL
) {

842 *
pŞk™_»suÉ
;

844 
	`dbus_”rÜ_š™
 (&
”rÜ
);

845 
pŞk™_»suÉ
 = 
	`libh®_deviû_is_ÿÎ”_´iveged
 (
h®_ùx
,

846 
udi
,

847 
aùiÚ
,

848 
švoked_by_syscÚ_Çme
,

849 &
”rÜ
);

850 ià(
pŞk™_»suÉ
 =ğ
NULL
){

851 
	`unknown_”rÜ
 ("IsCallerPrivileged() failed");

853 ià(
	`¡rcmp
 (
pŞk™_»suÉ
, "yes") != 0) {

854 
	`³rmissiÚ_d’›d_aùiÚ
 (
aùiÚ
, 
pŞk™_»suÉ
);

856 
	`libh®_ä“_¡ršg
 (
pŞk™_»suÉ
);

860 #ifdeà
DEBUG


861 
	`´štf
 ("passed…rivilege\n");

864 ià(!
is_»mouÁ
) {

866 ià(
	`g_mkdœ
 (
mouÁ_dœ
, 0700) != 0) {

867 
	`´štf
 ("CªnÙ c»©'%s'\n", 
mouÁ_dœ
);

868 
	`unknown_”rÜ
 ("Cannot create mount directory");

871 #ifdeà
__F»eBSD__


872 
ÿÎšg_uid
 = (
uid_t
è
	`¡¹Ş
 (
švoked_by_uid
, (**è
NULL
, 10);

873 
pw
 = 
	`g‘pwuid
 (
ÿÎšg_uid
);

874 ià(
pw
 !ğ
NULL
) {

875 
ÿÎšg_gid
 = 
pw
->
pw_gid
;

877 
ÿÎšg_gid
 = 0;

879 ià(
	`chown
 (
mouÁ_dœ
, 
ÿÎšg_uid
, 
ÿÎšg_gid
) != 0) {

880 
	`´štf
 ("CªnÙ chowÀ'%s'Øuid: %d, gid: %d\n", 
mouÁ_dœ
,

881 
ÿÎšg_uid
, 
ÿÎšg_gid
);

882 
	`g_rmdœ
 (
mouÁ_dœ
);

883 
	`unknown_”rÜ
 ("Failedo chown mount directory");

891 ià(!
is_»mouÁ
) {

892 
FILE
 *
h®_mb
;

893 
FILE
 *
h®_mb_Üig
;

894 
h®_mb_Üig_Ën
;

895 
num_»ad
;

896 *
h®_mb_buf
;

897 *
h®_mb_buf_Şd
;

913 ià(
	`g_fe_‹¡
 ("/medŸ/.h®-mb", 
G_FILE_TEST_EXISTS
)) {

914 
h®_mb_Üig
 = 
	`fİ’
 ("/media/.hal-mtab", "r");

915 ià(
h®_mb_Üig
 =ğ
NULL
) {

916 
	`unknown_”rÜ
 ("Cannot open /media/.hal-mtab");

918 ià(
	`f£ek
 (
h®_mb_Üig
, 0L, 
SEEK_END
) != 0) {

919 
	`unknown_”rÜ
 ("Cannot seekoƒnd of /media/.hal-mtab");

921 
h®_mb_Üig_Ën
 = 
	`á–l
 (
h®_mb_Üig
);

922 ià(
h®_mb_Üig_Ën
 < 0) {

923 
	`unknown_”rÜ
 ("Cannot determine size of /media/.hal-mtab");

925 
	`»wšd
 (
h®_mb_Üig
);

926 
h®_mb_buf
 = 
	`g_Ãw0
 (, 
h®_mb_Üig_Ën
 + 1);

927 
num_»ad
 = 
	`ä—d
 (
h®_mb_buf
, 1, 
h®_mb_Üig_Ën
, 
h®_mb_Üig
);

928 ià(
num_»ad
 !ğ
h®_mb_Üig_Ën
) {

929 
	`unknown_”rÜ
 ("Cannot„ead from /media/.hal-mtab");

931 
	`fşo£
 (
h®_mb_Üig
);

933 
h®_mb_buf
 = 
	`g_¡rdup
 ("");

936 #ifdeà
DEBUG


937 
	`´štf
 ("%d: XYA c»©šg /medŸ/.h®-mb~\n", 
	`g‘pid
 ());

939 
h®_mb
 = 
	`fİ’
 ("/media/.hal-mtab~", "w");

940 ià(
h®_mb
 =ğ
NULL
) {

941 
	`unknown_”rÜ
 ("Cannot create /media/.hal-mtab~");

943 
h®_mb_buf_Şd
 = 
h®_mb_buf
;

944 
h®_mb_buf
 = 
	`g_¡rdup_´štf
 ("%s%s\t%s\t0\t%s\t%s\t%s\n",

945 
h®_mb_buf_Şd
,

946 
deviû
, 
švoked_by_uid
, 
mouÁ_do_f¡y³
,

947 
mouÁ_İtiÚ_comma£p
, 
mouÁ_dœ
);

948 
	`g_ä“
 (
h®_mb_buf_Şd
);

949 ià(
h®_mb_buf_Şd
 =ğ
NULL
) {

950 
	`unknown_”rÜ
 ("Out of memory‡ppendingo /media/.hal-mtab~");

952 ià(
	`fwr™e
 (
h®_mb_buf
, 1, 
	`¡¾’
 (h®_mb_buf), 
h®_mb
) != strlen (hal_mtab_buf)) {

953 
	`unknown_”rÜ
 ("Cannot writeo /media/.hal-mtab~");

955 
	`fşo£
 (
h®_mb
);

956 
	`g_ä“
 (
h®_mb_buf
);

957 #ifdeà
DEBUG


958 
	`´štf
 ("%d: XYA closšg /medŸ/.h®-mb~\n", 
	`g‘pid
 ());

963 ià(!
	`g_¥awn_sync
 ("/",

964 
¬gs
,

965 
NULL
,

967 
NULL
,

968 
NULL
,

969 &
sout
,

970 &
£¼
,

971 &
ex™_¡©us
,

972 &
”r
)) {

973 
	`´štf
 ("CªnÙƒxecu‹ %s\n", 
MOUNT
);

974 
	`g_rmdœ
 (
mouÁ_dœ
);

975 
	`uÆšk
 ("/media/.hal-mtab~");

976 
	`unknown_”rÜ
 ("CªnÙ s·wÀ" 
MOUNT
);

980 ià(
ex™_¡©us
 != 0) {

981 
”r¡r
[] = "mount: unknown filesystemype";

983 
	`´štf
 ("% ”rÜ %d, stdout='%s', std”r='%s'\n", 
MOUNT
, 
ex™_¡©us
, 
sout
, 
£¼
);

985 ià(!
is_»mouÁ
) {

986 
	`g_rmdœ
 (
mouÁ_dœ
);

987 
	`uÆšk
 ("/media/.hal-mtab~");

990 ià(
	`¡ºcmp
 (
”r¡r
, 
£¼
,  (errstr) - 1) == 0) {

991 
	`unknown_fesy¡em
 (
	`¡¾’
 (
mouÁ_f¡y³
) > 0 ?

992 
mouÁ_f¡y³
 :

993 (
vŞume
 !ğ
NULL
 ? 
	`libh®_vŞume_g‘_f¡y³
 (volume) : "") );

995 
n
;

996 
n
 = 0; 
£¼
[n] != '\0';‚++) {

997 ià(
£¼
[
n
] == '\n') {

998 
£¼
[
n
] = ' ';

1001 
	`unknown_”rÜ
 (
£¼
);

1005 ià(!
is_»mouÁ
) {

1006 ià(
	`»Çme
 ("/media/.hal-mtab~", "/media/.hal-mtab") != 0) {

1007 
	`´štf
 ("»Çme(2èçed,ƒ¼no=%d -> '%s'\n", 
”ºo
, 
	`¡»¼Ü
 (errno));

1008 
	`uÆšk
 ("/media/.hal-mtab~");

1009 #ifdeà
DEBUG


1010 
	`´štf
 ("%d: XYA faed„’amšg /medŸ/.h®-mb~Ø/medŸ/.h®-mb\n", 
	`g‘pid
 ());

1012 
	`unknown_”rÜ
 ("Cannot„ename /media/.hal-mtab~o /media/.hal-mtab");

1014 #ifdeà
DEBUG


1015 
	`´štf
 ("%d: XYA dÚ»Çmšg /medŸ/.h®-mb~Ø/medŸ/.h®-mb\n", 
	`g‘pid
 ());

1019 
	`İ’log
 ("h®d", 0, 
LOG_DAEMON
);

1020 ià(
is_»mouÁ
) {

1021 
	`sy¦og
 (
LOG_INFO
, "»mouÁed % © '%s' oÀbeh®àoàuid %s", 
deviû
, 
mouÁ_dœ
, 
švoked_by_uid
);

1023 
	`sy¦og
 (
LOG_INFO
, "mouÁed % Ú beh®àoàuid %s", 
deviû
, 
švoked_by_uid
);

1025 
	`şo£log
 ();

1027 
	`g_ä“
 (
sout
);

1028 
	`g_ä“
 (
£¼
);

1029 
	`g_ä“
 (
mouÁ_dœ
);

1030 
	`libh®_ä“_¡ršg_¬¿y
 (
®lowed_İtiÚs
);

1031 
	`g_¡rä“v
 (
giv’_İtiÚs
);

1032 
	}
}

1036 
	$maš
 (
¬gc
, *
¬gv
[])

1038 *
udi
;

1039 *
deviû
;

1040 
LibH®VŞume
 *
vŞume
;

1041 
DBusE¼Ü
 
”rÜ
;

1042 
LibH®CÚ‹xt
 *
h®_ùx
 = 
NULL
;

1043 
DBusCÚÃùiÚ
 *
sy¡em_bus
 = 
NULL
;

1044 *
švoked_by_uid
;

1045 *
švoked_by_syscÚ_Çme
;

1047 ià(!
	`lock_h®_mb
 ()) {

1048 
	`unknown_”rÜ
 ("Cannot obtain†ock on /media/.hal-mtab");

1051 
deviû
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_DEVICE");

1052 ià(
deviû
 =ğ
NULL
)

1053 
	`u§ge
 ();

1055 
udi
 = 
	`g‘’v
 ("HAL_PROP_INFO_UDI");

1056 ià(
udi
 =ğ
NULL
)

1057 
	`u§ge
 ();

1059 
švoked_by_uid
 = 
	`g‘’v
 ("HAL_METHOD_INVOKED_BY_UID");

1061 
švoked_by_syscÚ_Çme
 = 
	`g‘’v
 ("HAL_METHOD_INVOKED_BY_SYSTEMBUS_CONNECTION_NAME");

1063 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1064 ià((
h®_ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

1065 
	`´štf
 ("Cannot connecto hald\n");

1066 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

1067 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

1069 
	`u§ge
 ();

1072 
	`dbus_”rÜ_š™
 (&
”rÜ
);

1073 
sy¡em_bus
 = 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
);

1074 ià(
sy¡em_bus
 =ğ
NULL
) {

1075 
	`´štf
 ("Cannot connectohe system bus\n");

1076 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

1077 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

1079 
	`u§ge
 ();

1082 
vŞume
 = 
	`libh®_vŞume_äom_udi
 (
h®_ùx
, 
udi
);

1083 ià(
vŞume
 =ğ
NULL
) {

1084 
LibH®Drive
 *
drive
;

1086 
drive
 = 
	`libh®_drive_äom_udi
 (
h®_ùx
, 
udi
);

1087 ià(
drive
 =ğ
NULL
) {

1088 
	`u§ge
 ();

1090 
	`hªdË_mouÁ
 (
h®_ùx
,

1091 
udi
, 
NULL
, 
drive
, 
deviû
, 
švoked_by_uid
,

1092 
švoked_by_syscÚ_Çme
);

1096 cÚ¡ *
drive_udi
;

1097 
LibH®Drive
 *
drive
;

1099 
drive_udi
 = 
	`libh®_vŞume_g‘_¡Üage_deviû_udi
 (
vŞume
);

1101 ià(
drive_udi
 =ğ
NULL
)

1102 
	`unknown_”rÜ
 ("Cannot get drive_udi from volume");

1103 
drive
 = 
	`libh®_drive_äom_udi
 (
h®_ùx
, 
drive_udi
);

1104 ià(
drive
 =ğ
NULL
)

1105 
	`unknown_”rÜ
 ("Cannot get drive from hal");

1107 
	`hªdË_mouÁ
 (
h®_ùx
,

1108 
udi
, 
vŞume
, 
drive
, 
deviû
, 
švoked_by_uid
,

1109 
švoked_by_syscÚ_Çme
);

1113 
	`uÆock_h®_mb
 ();

1116 
	}
}

	@tools/hal-storage-shared.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

31 
	~<¡ršg.h
>

32 
	~<glib.h
>

33 
	~<glib/g¡dio.h
>

34 #ifdeà
__F»eBSD__


35 
	~<f¡ab.h
>

36 
	~<sys/·¿m.h
>

37 
	~<sys/uüed.h
>

38 
	~<sys/mouÁ.h
>

39 
	~<lim™s.h
>

40 
	~<pwd.h
>

41 #–ià
sun


42 
	~<fú.h
>

43 
	~<sys/mÁb.h
>

44 
	~<sys/vf¡ab.h
>

46 
	~<mÁ’t.h
>

48 
	~<sys/ty³s.h
>

49 
	~<uni¡d.h
>

50 
	~<sys/fe.h
>

51 
	~<”ºo.h
>

52 
	~<sy¦og.h
>

54 
	~"h®-¡Üage-sh¬ed.h
"

56 #ifdeà
__F»eBSD__


57 
	smb_hªdË


59 
¡©fs
 *
	mmouÁs
;

60 
	mn_mouÁs
;

61 
	m™”
;

66 
gboŞ—n


67 
	$mb_İ’
 (
gpoš‹r
 *
hªdË
)

69 #ifdeà
__F»eBSD__


70 
mb_hªdË
 *
mb
;

72 
mb
 = 
	`g_Ãw0
 (
mb_hªdË
, 1);

73 
mb
->
n_mouÁs
 = 
	`g‘mÁšfo
 (&mb->
mouÁs
, 
MNT_NOWAIT
);

74 ià(
mb
->
n_mouÁs
 == 0) {

75 
	`g_ä“
 (
mb
);

76  
FALSE
;

79 *
hªdË
 = 
mb
;

80  
TRUE
;

81 #–ià
sun


82 *
hªdË
 = 
	`fİ’
 (
MNTTAB
, "r");

83  *
hªdË
 !ğ
NULL
;

85 *
hªdË
 = 
	`fİ’
 ("/proc/mounts", "r");

86  *
hªdË
 !ğ
NULL
;

88 
	}
}

91 
	$mb_Ãxt
 (
gpoš‹r
 
hªdË
, **
mouÁ_pošt
)

93 #ifdeà
__F»eBSD__


94 
mb_hªdË
 *
mb
 = 
hªdË
;

96 ià(
mb
->
™”
 < mb->
n_mouÁs
) {

97 ià(
mouÁ_pošt
 !ğ
NULL
) {

98 *
mouÁ_pošt
 = 
	`g_¡rdup
 (
mb
->
mouÁs
[mb->
™”
].
f_mÁÚÇme
);

100  
mb
->
mouÁs
[mb->
™”
++].
f_mÁäomÇme
;

102  
NULL
;

104 #–ià
sun


105 
mÁb
 
mÁ
;

107 ià(
	`g‘mÁ’t
 (
hªdË
, &
mÁ
) == 0) {

108 ià(
mouÁ_pošt
 !ğ
NULL
) {

109 *
mouÁ_pošt
 = 
	`g_¡rdup
 (
mÁ
.
mÁ_mouÁp
);

111  
mÁ
.
mÁ_¥ecŸl
;

113  
NULL
;

116 
mÁ’t
 *
mÁ
;

118 
mÁ
 = 
	`g‘mÁ’t
 (
hªdË
);

120 ià(
mÁ
 !ğ
NULL
) {

121 ià(
mouÁ_pošt
 !ğ
NULL
) {

122 *
mouÁ_pošt
 = 
	`g_¡rdup
 (
mÁ
->
mÁ_dœ
);

124  
mÁ
->
mÁ_f¢ame
;

126  
NULL
;

129 
	}
}

132 
	$mb_şo£
 (
gpoš‹r
 
hªdË
)

134 #ifdeà
__F»eBSD__


135 
	`g_ä“
 (
hªdË
);

137 
	`fşo£
 (
hªdË
);

139 
	}
}

143 
gboŞ—n


144 
	$f¡ab_İ’
 (
gpoš‹r
 *
hªdË
)

146 #ifdeà
__F»eBSD__


147  
	`£tf£Á
 () == 1;

148 #–ià
sun


149 *
hªdË
 = 
	`fİ’
 (
VFSTAB
, "r");

150  *
hªdË
 !ğ
NULL
;

152 *
hªdË
 = 
	`fİ’
 ("/etc/fstab", "r");

153  *
hªdË
 !ğ
NULL
;

155 
	}
}

158 
	$f¡ab_Ãxt
 (
gpoš‹r
 
hªdË
, **
mouÁ_pošt
)

160 #ifdeà
__F»eBSD__


161 
f¡ab
 *fstab;

163 
f¡ab
 = 
	`g‘f£Á
 ();

166 ià(
mouÁ_pošt
 !ğ
NULL
 && 
f¡ab
 != NULL) {

167 *
mouÁ_pošt
 = 
f¡ab
->
fs_fe
;

170  
f¡ab
 ? f¡ab->
fs_¥ec
 : 
NULL
;

171 #–ià
sun


172 
vf¡ab
 
v
;

174  
	`g‘vf£Á
 (
hªdË
, &
v
è=ğ0 ? v.
vfs_¥ecŸl
 : 
NULL
;

176 
mÁ’t
 *
mÁ
;

178 
mÁ
 = 
	`g‘mÁ’t
 (
hªdË
);

180 ià(
mouÁ_pošt
 !ğ
NULL
 && 
mÁ
 != NULL) {

181 *
mouÁ_pošt
 = 
mÁ
->
mÁ_dœ
;

184  
mÁ
 ? mÁ->
mÁ_f¢ame
 : 
NULL
;

186 
	}
}

189 
	$f¡ab_şo£
 (
gpoš‹r
 
hªdË
)

191 #ifdeà
__F»eBSD__


192 
	`’df£Á
 ();

194 
	`fşo£
 (
hªdË
);

196 
	}
}

198 #ifdeà
__F»eBSD__


199 
	#UMOUNT
 "/sbš/umouÁ"

	)

200 #–ià
sun


201 
	#UMOUNT
 "/sbš/umouÁ"

	)

203 
	#UMOUNT
 "/bš/umouÁ"

	)

207 
	$baout_if_drive_is_locked
 (
LibH®CÚ‹xt
 *
h®_ùx
, 
LibH®Drive
 *
drive
, cÚ¡ *
švoked_by_syscÚ_Çme
)

209 
DBusE¼Ü
 
”rÜ
;

211 ià(
drive
 !ğ
NULL
 && 
švoked_by_syscÚ_Çme
 != NULL) {

212 
	`dbus_”rÜ_š™
 (&
”rÜ
);

213 ià(
	`libh®_deviû_is_ÿÎ”_locked_out
 (
h®_ùx
,

214 
	`libh®_drive_g‘_udi
 (
drive
),

216 
švoked_by_syscÚ_Çme
,

217 &
”rÜ
)) {

218 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.InterfaceLocked\n");

219 
	`årštf
 (
¡d”r
, "Theƒnclosing drive forhe volume is†ocked\n");

220 
	`ex™
 (1);

223 
	}
}

227 
	$unknown_”rÜ
 (cÚ¡ *
d‘a
)

229 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.UnknownFailure\n");

230 
	`årštf
 (
¡d”r
, "%s\n", 
d‘a
);

231 
	`ex™
 (1);

232 
	}
}

236 
	$deviû_busy
 (cÚ¡ *
d‘a
)

238 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.Busy\n");

239 
	`årštf
 (
¡d”r
, "%s\n", 
d‘a
);

240 
	`ex™
 (1);

241 
	}
}

245 
	$nÙ_mouÁed
 (cÚ¡ *
d‘a
)

247 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.NotMounted\n");

248 
	`årštf
 (
¡d”r
, "%s\n", 
d‘a
);

249 
	`ex™
 (1);

250 
	}
}

254 
	$nÙ_mouÁed_by_h®
 (cÚ¡ *
d‘a
)

256 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.NotMountedByHal\n");

257 
	`årštf
 (
¡d”r
, "%s\n", 
d‘a
);

258 
	`ex™
 (1);

259 
	}
}

262 
	$³rmissiÚ_d’›d_´ivege
 (cÚ¡ *
´ivege
, cÚ¡ *
»suÉ
)

264 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.PermissionDeniedByPolicy\n");

265 
	`årštf
 (
¡d”r
, "% % <-- (´ivege,„esuÉ)\n", 
´ivege
, 
»suÉ
);

266 
	`ex™
 (1);

267 
	}
}

270 
	$³rmissiÚ_d’›d_vŞume_ignÜe
 (cÚ¡ *
deviû
)

272 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.PermissionDenied\n");

273 
	`årštf
 (
¡d”r
, "Deviû ha % vŞume.ignÜ£ˆtØTRUE. RefusšgØmouÁ.\n", 
deviû
);

274 
	`ex™
 (1);

275 
	}
}

278 
	$hªdË_unmouÁ
 (
LibH®CÚ‹xt
 *
h®_ùx
,

279 cÚ¡ *
udi
,

280 
LibH®VŞume
 *
vŞume
, 
LibH®Drive
 *
drive
, cÚ¡ *
deviû
,

281 cÚ¡ *
švoked_by_uid
, cÚ¡ *
švoked_by_syscÚ_Çme
,

282 
gboŞ—n
 
İtiÚ_Ïzy
, gboŞ—À
İtiÚ_fÜû
)

284 
i
, 
j
;

285 
DBusE¼Ü
 
”rÜ
;

286 
GE¼Ü
 *
”r
 = 
NULL
;

287 *
sout
 = 
NULL
;

288 *
£¼
 = 
NULL
;

289 
ex™_¡©us
;

290 *
¬gs
[10];

291 
Ç
;

292 
FILE
 *
h®_mb_Üig
;

293 
h®_mb_Üig_Ën
;

294 
num_»ad
;

295 *
h®_mb_buf
;

296 **
lšes
;

297 *
mouÁ_pošt_to_unmouÁ
;

298 
gboŞ—n
 
mouÁed_by_Ùh”_uid
;

299 
FILE
 *
h®_mb_Ãw
;

301 #ifdeà
DEBUG


302 
	`´štf
 ("deviû = %s\n", 
deviû
);

303 
	`´štf
 ("švoked by uid = %s\n", 
švoked_by_uid
);

304 
	`´štf
 ("švoked by sy¡em bu cÚÃùiÚ = %s\n", 
švoked_by_syscÚ_Çme
);

307 ià(
vŞume
 !ğ
NULL
) {

308 
	`dbus_”rÜ_š™
 (&
”rÜ
);

309 ià(
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
h®_ùx
, 
udi
, "vŞume.ignÜe", &
”rÜ
)) {

310 
	`³rmissiÚ_d’›d_vŞume_ignÜe
 (
deviû
);

313 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

314 
	`dbus_”rÜ_ä“
(&
”rÜ
);

315 
	`unknown_”rÜ
("Error while get volume.ignore");

318 ià(!
	`libh®_vŞume_is_mouÁed
 (
vŞume
)) {

319 
	`nÙ_mouÁed
 ("Accordingo HAL,he volume is‚ot mounted");

323 
	`baout_if_drive_is_locked
 (
h®_ùx
, 
drive
, 
švoked_by_syscÚ_Çme
);

326 
h®_mb_Üig
 = 
	`fİ’
 ("/media/.hal-mtab", "r");

327 ià(
h®_mb_Üig
 =ğ
NULL
) {

328 
	`unknown_”rÜ
 ("Cannot open /media/.hal-mtab");

330 ià(
	`f£ek
 (
h®_mb_Üig
, 0L, 
SEEK_END
) != 0) {

331 
	`unknown_”rÜ
 ("Cannot seekoƒnd of /media/.hal-mtab");

333 
h®_mb_Üig_Ën
 = 
	`á–l
 (
h®_mb_Üig
);

334 ià(
h®_mb_Üig_Ën
 < 0) {

335 
	`unknown_”rÜ
 ("Cannot determine size of /media/.hal-mtab");

337 
	`»wšd
 (
h®_mb_Üig
);

338 
h®_mb_buf
 = 
	`g_Ãw0
 (, 
h®_mb_Üig_Ën
 + 1);

339 
num_»ad
 = 
	`ä—d
 (
h®_mb_buf
, 1, 
h®_mb_Üig_Ën
, 
h®_mb_Üig
);

340 ià(
num_»ad
 !ğ
h®_mb_Üig_Ën
) {

341 
	`unknown_”rÜ
 ("Cannot„ead from /media/.hal-mtab");

343 
	`fşo£
 (
h®_mb_Üig
);

345 #ifdeà
DEBUG


346 
	`´štf
 ("h®_mb = '%s'\n", 
h®_mb_buf
);

349 
lšes
 = 
	`g_¡r¥l™
 (
h®_mb_buf
, "\n", 0);

350 
	`g_ä“
 (
h®_mb_buf
);

352 
mouÁ_pošt_to_unmouÁ
 = 
NULL
;

353 
mouÁed_by_Ùh”_uid
 = 
TRUE
;

356 
i
 = 0; 
lšes
[i] !ğ
NULL
; i++) {

357 **
lše_–em’ts
;

359 #ifdeà
DEBUG


360 
	`´štf
 ("†šğ'%s'\n", 
lšes
[
i
]);

363 ià((
lšes
[
i
])[0] == '#')

366 
lše_–em’ts
 = 
	`g_¡r¥l™
 (
lšes
[
i
], "\t", 6);

367 ià(
	`g_¡rv_Ëngth
 (
lše_–em’ts
) == 6) {

369 #ifdeà
DEBUG


370 
	`´štf
 (" devf = '%s'\n", 
lše_–em’ts
[0]);

371 
	`´štf
 (" uid = '%s'\n", 
lše_–em’ts
[1]);

372 
	`´štf
 (" sessiÚ id = '%s'\n", 
lše_–em’ts
[2]);

373 
	`´štf
 (" f  = '%s'\n", 
lše_–em’ts
[3]);

374 
	`´štf
 (" o±iÚ  = '%s'\n", 
lše_–em’ts
[4]);

375 
	`´štf
 (" mouÁ_pošˆğ'%s'\n", 
lše_–em’ts
[5]);

378 ià(
	`¡rcmp
 (
lše_–em’ts
[0], 
deviû
) == 0) {

379 *
lše_to_ä“
;

381 ià(
	`¡rcmp
 (
lše_–em’ts
[1], 
švoked_by_uid
) == 0)

382 
mouÁed_by_Ùh”_uid
 = 
FALSE
;

384 
mouÁ_pošt_to_unmouÁ
 = 
	`g_¡rdup
 (
lše_–em’ts
[5]);

386 
lše_to_ä“
 = 
lšes
[
i
];

388 
j
 = 
i
; 
lšes
[j] !ğ
NULL
; j++) {

389 
lšes
[
j
] =†ines[j+1];

391 
lšes
[
j
] = 
NULL
;

393 
	`g_ä“
 (
lše_to_ä“
);

395 
	`g_¡rä“v
 (
lše_–em’ts
);

396 
lše_found
;

402 
	`g_¡rä“v
 (
lše_–em’ts
);

404 
lše_found
:

406 ià(
mouÁ_pošt_to_unmouÁ
 =ğ
NULL
) {

407 
	`nÙ_mouÁed_by_h®
 ("Deviceo unmount is‚ot in /media/.hal-mtab so it is‚ot mounted by HAL");

421 ià((
	`¡rcmp
 (
švoked_by_uid
, "0"è!ğ0è&& 
mouÁed_by_Ùh”_uid
) {

422 cÚ¡ *
aùiÚ
 = "org.freedesktop.hal.storage.unmount-others";

423 #ifdeà
HAVE_POLKIT


424 ià(
švoked_by_syscÚ_Çme
 !ğ
NULL
) {

425 *
pŞk™_»suÉ
;

426 
	`dbus_”rÜ_š™
 (&
”rÜ
);

427 
pŞk™_»suÉ
 = 
	`libh®_deviû_is_ÿÎ”_´iveged
 (
h®_ùx
,

428 
udi
,

429 
aùiÚ
,

430 
švoked_by_syscÚ_Çme
,

431 &
”rÜ
);

432 ià(
pŞk™_»suÉ
 =ğ
NULL
){

433 
	`unknown_”rÜ
 ("IsCallerPrivileged() failed");

435 ià(
	`¡rcmp
 (
pŞk™_»suÉ
, "yes") != 0) {

436 
	`³rmissiÚ_d’›d_´ivege
 (
aùiÚ
, 
pŞk™_»suÉ
);

438 
	`libh®_ä“_¡ršg
 (
pŞk™_»suÉ
);

441 
	`³rmissiÚ_d’›d_´ivege
 (
aùiÚ
, "no");

446 
h®_mb_Ãw
 = 
	`fİ’
 ("/media/.hal-mtab~", "w");

447 ià(
h®_mb_Ãw
 =ğ
NULL
) {

448 
	`unknown_”rÜ
 ("Cannot create /media/.hal-mtab~");

450 
i
 = 0; 
lšes
[i] !ğ
NULL
; i++) {

451 ià(
i
 > 0) {

452 
ªewl
[2] = "\n\0";

453 ià(
	`fwr™e
 (
ªewl
, 1, 1, 
h®_mb_Ãw
) != 1) {

454 
	`unknown_”rÜ
 ("Cannot writeo /media/.hal-mtab~");

458 ià(
	`fwr™e
 (
lšes
[
i
], 1, 
	`¡¾’
 (lšes[i]), 
h®_mb_Ãw
) != strlen (lines[i])) {

459 
	`unknown_”rÜ
 ("Cannot writeo /media/.hal-mtab~");

463 
	`fşo£
 (
h®_mb_Ãw
);

465 
	`g_¡rä“v
 (
lšes
);

468 
Ç
 = 0;

469 
¬gs
[
Ç
++] = 
UMOUNT
;

470 #iâdeà
__F»eBSD__


471 ià(
İtiÚ_Ïzy
)

472 
¬gs
[
Ç
++] = "-l";

474 ià(
İtiÚ_fÜû
)

475 
¬gs
[
Ç
++] = "-f";

476 
¬gs
[
Ç
++] = (*è
deviû
;

477 
¬gs
[
Ç
++] = 
NULL
;

479 #ifdeà
DEBUG


480 
	`´štf
 ("will umount %s (mounted‡t '%s'), mounted_by_other_uid=%d\n",

481 
deviû
, 
mouÁ_pošt_to_unmouÁ
, 
mouÁed_by_Ùh”_uid
);

485 ià(!
	`g_¥awn_sync
 ("/",

486 
¬gs
,

487 
NULL
,

488 
G_SPAWN_LEAVE_DESCRIPTORS_OPEN
,

489 
NULL
,

490 
NULL
,

491 &
sout
,

492 &
£¼
,

493 &
ex™_¡©us
,

494 &
”r
)) {

495 
	`´štf
 ("CªnÙƒxecu‹ %s\n", 
UMOUNT
);

496 
	`uÆšk
 ("/media/.hal-mtab~");

497 
	`unknown_”rÜ
 ("CªnÙ s·wÀ" 
UMOUNT
);

501 ià(
ex™_¡©us
 != 0) {

502 
	`´štf
 ("% ”rÜ %d, stdout='%s', std”r='%s'\n", 
UMOUNT
, 
ex™_¡©us
, 
sout
, 
£¼
);

504 ià(
	`¡r¡r
 (
£¼
, "deviû i busy"è!ğ
NULL
) {

505 
	`uÆšk
 ("/media/.hal-mtab~");

506 
	`deviû_busy
 (
£¼
);

508 
	`uÆšk
 ("/media/.hal-mtab~");

509 
	`unknown_”rÜ
 (
£¼
);

514 ià(
	`g_rmdœ
 (
mouÁ_pošt_to_unmouÁ
) != 0) {

515 
	`uÆšk
 ("/media/.hal-mtab~");

516 
	`unknown_”rÜ
 ("Cannot„emove directory");

520 ià(
	`»Çme
 ("/media/.hal-mtab~", "/media/.hal-mtab") != 0) {

521 
	`uÆšk
 ("/media/.hal-mtab~");

522 
	`unknown_”rÜ
 ("Cannot„ename /media/.hal-mtab~o /media/.hal-mtab");

525 #ifdeà
DEBUG


526 
	`´štf
 ("done unmounting\n");

528 
	`İ’log
 ("h®d", 0, 
LOG_DAEMON
);

529 
	`sy¦og
 (
LOG_INFO
, "unmouÁed % äom '%s' oÀbeh®àoàuid %s", 
deviû
, 
mouÁ_pošt_to_unmouÁ
, 
švoked_by_uid
);

530 
	`şo£log
 ();

532 
	`g_ä“
 (
sout
);

533 
	`g_ä“
 (
£¼
);

534 
	`g_ä“
 (
mouÁ_pošt_to_unmouÁ
);

535 
	}
}

538 
	$hªdË_ejeù
 (
DBusCÚÃùiÚ
 *
sy¡em_bus
,

539 
LibH®CÚ‹xt
 *
h®_ùx
,

540 cÚ¡ *
udi
,

541 
LibH®Drive
 *
drive
, cÚ¡ *
deviû
,

542 cÚ¡ *
švoked_by_uid
, cÚ¡ *
švoked_by_syscÚ_Çme
,

543 
gboŞ—n
 
şo£Œay
)

545 
GE¼Ü
 *
”r
 = 
NULL
;

546 *
sout
 = 
NULL
;

547 *
£¼
 = 
NULL
;

548 
ex™_¡©us
;

549 *
¬gs
[10];

550 
Ç
;

551 
fd
;

552 
num_exş_Œ›s
;

553 
DBusE¼Ü
 
”rÜ
;

577 
num_exş_Œ›s
 = 5;

578 
Œy_İ’_exş_agaš
:

579 
fd
 = 
	`İ’
 (
deviû
, 
O_RDONLY
 | 
O_NONBLOCK
 | 
O_EXCL
);

580 ià(
fd
 < 0 && 
”ºo
 =ğ
EBUSY
) {

587 
	`u¦“p
 (100 * 1000);

588 ià(
num_exş_Œ›s
-- > 0)

589 
Œy_İ’_exş_agaš
;

593 
	`deviû_busy
 ("Some‡pplication is usinghe device");

595 
	`şo£
 (
fd
);

597 #ifdeà
HAVE_POLKIT


598 ià(
švoked_by_syscÚ_Çme
 !ğ
NULL
) {

599 *
pŞk™_»suÉ
;

600 cÚ¡ *
aùiÚ
 = "org.freedesktop.hal.storage.eject";

601 
	`dbus_”rÜ_š™
 (&
”rÜ
);

602 
pŞk™_»suÉ
 = 
	`libh®_deviû_is_ÿÎ”_´iveged
 (
h®_ùx
,

603 
udi
,

604 
aùiÚ
,

605 
švoked_by_syscÚ_Çme
,

606 &
”rÜ
);

607 ià(
pŞk™_»suÉ
 =ğ
NULL
){

608 
	`unknown_”rÜ
 ("IsCallerPrivileged() failed");

610 ià(
	`¡rcmp
 (
pŞk™_»suÉ
, "yes") != 0) {

611 
	`³rmissiÚ_d’›d_´ivege
 (
aùiÚ
, 
pŞk™_»suÉ
);

613 
	`libh®_ä“_¡ršg
 (
pŞk™_»suÉ
);

617 #ifdeà
DEBUG


618 
	`´štf
 ("deviû = %s\n", 
deviû
);

619 
	`´štf
 ("švoked by uid = %s\n", 
švoked_by_uid
);

620 
	`´štf
 ("švoked by sy¡em bu cÚÃùiÚ = %s\n", 
švoked_by_syscÚ_Çme
);

623 
	`baout_if_drive_is_locked
 (
h®_ùx
, 
drive
, 
švoked_by_syscÚ_Çme
);

626 
Ç
 = 0;

627 
¬gs
[
Ç
++] = 
EJECT_PROGRAM
;

628 #ifdeà
__F»eBSD__


629 
¬gs
[
Ç
++] = "-f";

630 
¬gs
[
Ç
++] = (*è
deviû
;

631 ià(
şo£Œay
)

632 
¬gs
[
Ç
++] = "close";

634 
¬gs
[
Ç
++] = "eject";

636 ià(
şo£Œay
) {

637 
¬gs
[
Ç
++] = "-t";

639 
¬gs
[
Ç
++] = (*è
deviû
;

641 
¬gs
[
Ç
++] = 
NULL
;

643 #ifdeà
DEBUG


644 
	`´štf
 ("wÈejeù %s\n", 
deviû
);

648 ià(!
	`g_¥awn_sync
 ("/",

649 
¬gs
,

650 
NULL
,

651 
G_SPAWN_LEAVE_DESCRIPTORS_OPEN
,

652 
NULL
,

653 
NULL
,

654 &
sout
,

655 &
£¼
,

656 &
ex™_¡©us
,

657 &
”r
)) {

658 
	`´štf
 ("CªnÙƒxecu‹ %s\n", 
EJECT_PROGRAM
);

659 
	`unknown_”rÜ
 ("CªnÙ s·wÀ" 
EJECT_PROGRAM
);

663 ià(
ex™_¡©us
 != 0) {

664 
	`´štf
 ("% ”rÜ %d, stdout='%s', std”r='%s'\n", 
EJECT_PROGRAM
, 
ex™_¡©us
, 
sout
, 
£¼
);

666 
	`unknown_”rÜ
 (
£¼
);

673 ià(!
	`libh®_drive_is_medŸ_d‘eùiÚ_autom©ic
 (
drive
)) {

674 
DBusMes§ge
 *
mes§ge
;

675 
DBusMes§ge
 *
»¶y
;

677 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

678 
udi
,

681 
	`dbus_”rÜ_š™
 (&
”rÜ
);

682 
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
sy¡em_bus
, 
mes§ge
, -1, &
”rÜ
);

685 #ifdeà
DEBUG


686 
	`´štf
 ("doneƒjecting\n");

689 
	`g_ä“
 (
sout
);

690 
	`g_ä“
 (
£¼
);

691 
	}
}

694 
	glock_mb_fd
 = -1;

696 
gboŞ—n


697 
	$lock_h®_mb
 ()

699 ià(
lock_mb_fd
 >= 0)

700  
TRUE
;

702 
	`´štf
 ("%d: XYA‡‰em±šgØg‘†ock oÀ/medŸ/.h®-mb-lock\n", 
	`g‘pid
 ());

704 
lock_mb_fd
 = 
	`İ’
 ("/medŸ/.h®-mb-lock", 
O_CREAT
 | 
O_RDWR
, 0600);

706 ià(
lock_mb_fd
 < 0)

707  
FALSE
;

709 
	`fú
(
lock_mb_fd
, 
F_SETFD
, 
FD_CLOEXEC
);

711 
Œyagaš
:

712 #ià
sun


713 ià(
	`lockf
 (
lock_mb_fd
, 
F_LOCK
, 0) != 0) {

715 ià(
	`æock
 (
lock_mb_fd
, 
LOCK_EX
) != 0) {

717 ià(
”ºo
 =ğ
EINTR
)

718 
Œyagaš
;

719  
FALSE
;

722 
	`´štf
 ("%d: XYA gÙ†ock oÀ/medŸ/.h®-mb-lock\n", 
	`g‘pid
 ());

725  
TRUE
;

726 
	}
}

729 
	$uÆock_h®_mb
 ()

731 #ià
sun


732 
	`lockf
 (
lock_mb_fd
, 
F_ULOCK
, 0);

734 
	`æock
 (
lock_mb_fd
, 
LOCK_UN
);

736 
	`şo£
 (
lock_mb_fd
);

737 
lock_mb_fd
 = -1;

738 
	`´štf
 ("%d: XYA„–—£d†ock oÀ/medŸ/.h®-mb-lock\n", 
	`g‘pid
 ());

739 
	}
}

	@tools/hal-storage-shared.h

24 #iâdeà
HAL_STORAGE_SHARED_H


25 
	#HAL_STORAGE_SHARED_H


	)

27 
	~<libh®.h
>

28 
	~<libh®-¡Üage.h
>

31 
	#DEBUG


	)

33 
gboŞ—n
 
mb_İ’
 (
gpoš‹r
 *
hªdË
);

34 *
mb_Ãxt
 (
gpoš‹r
 
hªdË
, **
mouÁ_pošt
);

35 
mb_şo£
 (
gpoš‹r
 
hªdË
);

37 
gboŞ—n
 
f¡ab_İ’
 (
gpoš‹r
 *
hªdË
);

38 *
f¡ab_Ãxt
 (
gpoš‹r
 
hªdË
, **
mouÁ_pošt
);

39 
f¡ab_şo£
 (
gpoš‹r
 
hªdË
);

41 
gboŞ—n
 
lock_h®_mb
 ();

42 
uÆock_h®_mb
 ();

44 
unknown_”rÜ
 (cÚ¡ *
d‘a
);

46 
baout_if_drive_is_locked
 (
LibH®CÚ‹xt
 *
h®_ùx
, 
LibH®Drive
 *
drive
, cÚ¡ *
švoked_by_syscÚ_Çme
);

48 
hªdË_unmouÁ
 (
LibH®CÚ‹xt
 *
h®_ùx
,

49 cÚ¡ *
udi
,

50 
LibH®VŞume
 *
vŞume
, 
LibH®Drive
 *
drive
, cÚ¡ *
deviû
,

51 cÚ¡ *
švoked_by_uid
, cÚ¡ *
švoked_by_syscÚ_Çme
,

52 
gboŞ—n
 
İtiÚ_Ïzy
, gboŞ—À
İtiÚ_fÜû
);

54 
hªdË_ejeù
 (
DBusCÚÃùiÚ
 *
sy¡em_bus
,

55 
LibH®CÚ‹xt
 *
h®_ùx
,

56 cÚ¡ *
udi
,

57 
LibH®Drive
 *
drive
, cÚ¡ *
deviû
,

58 cÚ¡ *
švoked_by_uid
, cÚ¡ *
švoked_by_syscÚ_Çme
,

59 
gboŞ—n
 
şo£Œay
);

	@tools/hal-storage-unmount.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

31 
	~<¡ršg.h
>

32 
	~<glib.h
>

33 
	~<glib/g¡dio.h
>

34 #ifdeà
__F»eBSD__


35 
	~<f¡ab.h
>

36 
	~<sys/·¿m.h
>

37 
	~<sys/uüed.h
>

38 
	~<sys/mouÁ.h
>

39 
	~<lim™s.h
>

40 
	~<pwd.h
>

41 #–ià
sun


42 
	~<fú.h
>

43 
	~<sys/mÁb.h
>

44 
	~<sys/vf¡ab.h
>

46 
	~<mÁ’t.h
>

48 
	~<sys/ty³s.h
>

49 
	~<uni¡d.h
>

51 
	~<libh®.h
>

52 
	~<libh®-¡Üage.h
>

54 
	~"h®-¡Üage-sh¬ed.h
"

58 
	$u§ge
 ()

60 
	`årštf
 (
¡d”r
, "This…rogram should only be started by hald.\n");

61 
	`ex™
 (1);

62 
	}
}

65 
	$šv®id_unmouÁ_İtiÚ
 (cÚ¡ *
İtiÚ
, cÚ¡ *
uid
)

67 
	`årštf
 (
¡d”r
, "org.freedesktop.Hal.Device.Volume.InvalidUnmountOption\n");

68 
	`årštf
 (
¡d”r
, "ThİtiÚ '%s' i nÙ‡Îowed fÜ uid=%s\n", 
İtiÚ
, 
uid
);

69 
	`ex™
 (1);

70 
	}
}

73 
	$maš
 (
¬gc
, *
¬gv
[])

75 *
udi
;

76 *
deviû
;

77 
LibH®VŞume
 *
vŞume
;

78 
DBusE¼Ü
 
”rÜ
;

79 
LibH®CÚ‹xt
 *
h®_ùx
 = 
NULL
;

80 
DBusCÚÃùiÚ
 *
sy¡em_bus
 = 
NULL
;

81 *
švoked_by_uid
;

82 *
švoked_by_syscÚ_Çme
;

83 
i
;

84 
unmouÁ_İtiÚs
[1024];

85 **
giv’_İtiÚs
;

86 
gboŞ—n
 
u£_Ïzy
;

87 
gboŞ—n
 
u£_fÜû
;

88 cÚ¡ *
’d
;

90 ià(!
	`lock_h®_mb
 ()) {

91 
	`unknown_”rÜ
 ("Cannot obtain†ock on /media/.hal-mtab");

94 
deviû
 = 
	`g‘’v
 ("HAL_PROP_BLOCK_DEVICE");

95 ià(
deviû
 =ğ
NULL
)

96 
	`u§ge
 ();

98 
udi
 = 
	`g‘’v
 ("HAL_PROP_INFO_UDI");

99 ià(
udi
 =ğ
NULL
)

100 
	`u§ge
 ();

102 
švoked_by_uid
 = 
	`g‘’v
 ("HAL_METHOD_INVOKED_BY_UID");

104 
švoked_by_syscÚ_Çme
 = 
	`g‘’v
 ("HAL_METHOD_INVOKED_BY_SYSTEMBUS_CONNECTION_NAME");

106 
	`dbus_”rÜ_š™
 (&
”rÜ
);

107 ià((
h®_ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

108 
	`´štf
 ("Cannot connecto hald\n");

109 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

110 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

112 
	`u§ge
 ();

115 
	`dbus_”rÜ_š™
 (&
”rÜ
);

116 
sy¡em_bus
 = 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
);

117 ià(
sy¡em_bus
 =ğ
NULL
) {

118 
	`´štf
 ("Cannot connectohe system bus\n");

119 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

120 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

122 
	`u§ge
 ();

126 ià(
	`¡¾’
 (
	`fg‘s
 (
unmouÁ_İtiÚs
,  (unmouÁ_İtiÚs), 
¡dš
)) > 0)

127 
unmouÁ_İtiÚs
 [
	`¡¾’
 (unmount_options) - 1] = '\0';

129 ià(!
	`g_utf8_v®id©e
 (
unmouÁ_İtiÚs
, -1, &
’d
))

130 
	`unknown_”rÜ
 ("Error validating unmount_options‡s UTF-8");

131 #ifdeà
DEBUG


132 
	`´štf
 ("unmouÁ_İtiÚ  = '%s'\n", 
unmouÁ_İtiÚs
);

136 
giv’_İtiÚs
 = 
	`g_¡r¥l™
 (
unmouÁ_İtiÚs
, "\t", 0);

137 
i
 = 
	`g_¡rv_Ëngth
 (
giv’_İtiÚs
) - 1; i >= 0; --i) {

138 ià(
	`¡¾’
 (
giv’_İtiÚs
[
i
]) > 0)

140 
giv’_İtiÚs
[
i
] = 
NULL
;

143 
u£_Ïzy
 = 
FALSE
;

144 
u£_fÜû
 = 
FALSE
;

147 
i
 = 0; 
giv’_İtiÚs
[i] !ğ
NULL
; i++) {

148 *
giv’
 = 
giv’_İtiÚs
[
i
];

150 ià(
	`¡rcmp
 (
giv’
, "lazy") == 0) {

151 
u£_Ïzy
 = 
TRUE
;

152 } ià(
	`¡rcmp
 (
giv’
, "force") == 0) {

153 
u£_fÜû
 = 
TRUE
;

155 
	`šv®id_unmouÁ_İtiÚ
 (
giv’
, 
švoked_by_uid
);

158 
	`g_¡rä“v
 (
giv’_İtiÚs
);

161 
vŞume
 = 
	`libh®_vŞume_äom_udi
 (
h®_ùx
, 
udi
);

162 ià(
vŞume
 =ğ
NULL
) {

163 
LibH®Drive
 *
drive
;

165 
drive
 = 
	`libh®_drive_äom_udi
 (
h®_ùx
, 
udi
);

166 ià(
drive
 =ğ
NULL
) {

167 
	`u§ge
 ();

169 
	`hªdË_unmouÁ
 (
h®_ùx
,

170 
udi
, 
NULL
, 
drive
, 
deviû
, 
švoked_by_uid
,

171 
švoked_by_syscÚ_Çme
, 
u£_Ïzy
, 
u£_fÜû
);

175 cÚ¡ *
drive_udi
;

176 
LibH®Drive
 *
drive
;

178 
drive_udi
 = 
	`libh®_vŞume_g‘_¡Üage_deviû_udi
 (
vŞume
);

180 ià(
drive_udi
 =ğ
NULL
)

181 
	`unknown_”rÜ
 ("Cannot get drive_udi from volume");

182 
drive
 = 
	`libh®_drive_äom_udi
 (
h®_ùx
, 
drive_udi
);

183 ià(
drive
 =ğ
NULL
)

184 
	`unknown_”rÜ
 ("Cannot get drive from hal");

186 
	`hªdË_unmouÁ
 (
h®_ùx
,

187 
udi
, 
vŞume
, 
drive
, 
deviû
, 
švoked_by_uid
,

188 
švoked_by_syscÚ_Çme
, 
u£_Ïzy
, 
u£_fÜû
);

192 
	`uÆock_h®_mb
 ();

195 
	}
}

	@tools/hal-system-power-pm-is-supported.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

31 
	~<¡ršg.h
>

32 
	~<uni¡d.h
>

34 
	~<libh®.h
>

35 
	~<glib.h
>

38 
	$maš
 (
¬gc
, *
¬gv
[])

40 
»t
;

41 *
udi
;

42 
DBusE¼Ü
 
”rÜ
;

43 
LibH®CÚ‹xt
 *
h®_ùx
 = 
NULL
;

44 
LibH®ChªgeS‘
 *
cs
;

45 
gboŞ—n
 
ÿn_su¥’d
 = 
FALSE
;

46 
gboŞ—n
 
ÿn_su¥’d_hybrid
 = 
FALSE
;

47 
gboŞ—n
 
ÿn_hib”Ç‹
 = 
FALSE
;

48 
ex™_¡©us
;

50 
»t
 = 1;

52 
udi
 = 
	`g‘’v
 ("HAL_PROP_INFO_UDI");

53 ià(
udi
 =ğ
NULL
)

54 
out
;

56 
	`dbus_”rÜ_š™
 (&
”rÜ
);

57 ià((
h®_ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”rÜ
)è=ğ
NULL
) {

58 
	`´štf
 ("Cannot connecto hald\n");

59 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

60 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

62 
out
;

65 
cs
 = 
	`libh®_deviû_Ãw_chªge£t
 (
udi
);

66 ià(
cs
 =ğ
NULL
) {

67 
	`´štf
 ("Cannot initialize changeset\n");

68 
out
;

71 
	`g_¥awn_commªd_lše_sync
 ("/u¤/bš/pm-is-suµÜ‹d --su¥’d", 
NULL
, NULL, &
ex™_¡©us
, NULL);

72 
ÿn_su¥’d
 = (
ex™_¡©us
 == 0);

73 
	`g_¥awn_commªd_lše_sync
 ("/u¤/bš/pm-is-suµÜ‹d --su¥’d-hybrid", 
NULL
, NULL, &
ex™_¡©us
, NULL);

74 
ÿn_su¥’d_hybrid
 = (
ex™_¡©us
 == 0);

75 
	`g_¥awn_commªd_lše_sync
 ("/u¤/bš/pm-is-suµÜ‹d --hib”Ç‹", 
NULL
, NULL, &
ex™_¡©us
, NULL);

76 
ÿn_hib”Ç‹
 = (
ex™_¡©us
 == 0);

78 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "pow”_mªagem’t.ÿn_su¥’d", 
ÿn_su¥’d
);

79 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "pow”_mªagem’t.ÿn_su¥’d_hybrid", 
ÿn_su¥’d_hybrid
);

80 
	`libh®_chªge£t_£t_´İ”ty_boŞ
 (
cs
, "pow”_mªagem’t.ÿn_hib”Ç‹", 
ÿn_hib”Ç‹
);

82 
	`libh®_deviû_comm™_chªge£t
 (
h®_ùx
, 
cs
, &
”rÜ
);

83 
	`libh®_deviû_ä“_chªge£t
 (
cs
);

85 
»t
 = 0;

86 
out
:

87  
»t
;

88 
	}
}

	@tools/hal-system-power-pmu.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

31 
	~<¡ršg.h
>

32 
	~<¡d¬g.h
>

33 
	~<uni¡d.h
>

34 
	~<g‘İt.h
>

35 
	~<fú.h
>

37 
	~<sys/ioùl.h
>

38 #ifdeà
__lšux__


39 
	~<lšux/pmu.h
>

41 
	~<libh®/libh®.h
>

43 
	#PMUDEV
 "/dev/pmu"

	)

44 
	#__u32
 

	)

54 
	$pmac_¦“p
 ()

56 #ifdeà
__F»eBSD__


57  
FALSE
;

58 #–ià
sun


59  
FALSE
;

60 #–ià
__GNU__


61  
FALSE
;

63 
»t
;

64 
fd
;

66 
fd
 = 
	`İ’
 (
PMUDEV
, 
O_RDWR
);

67 ià(
fd
 < 0) {

68 
	`årštf
 (
¡d”r
, "pow”-pmu : FaedØİ’ " 
PMUDEV
 "\n");

69  
FALSE
;

72 
»t
 = 
	`ioùl
 (
fd
, 
PMU_IOC_SLEEP
, 0);

73 
	`şo£
 (
fd
);

74 ià(
»t
 < 0) {

75 
	`årštf
 (
¡d”r
, "power-pmu : PMU_IOC_SLEEP failed\n");

76  
FALSE
;

78  
TRUE
;

80 
	}
}

91 
	$pmac_g‘_lcd_brighŠess
 (*
v®
)

93 #ifdeà
__F»eBSD__


94  
FALSE
;

95 #–ià
sun


96  
FALSE
;

97 #–ià
__GNU__


98  
FALSE
;

100 
»t
;

101 
fd
;

103 
fd
 = 
	`İ’
 (
PMUDEV
, 
O_RDWR
);

104 ià(
fd
 < 0) {

105 
	`årštf
 (
¡d”r
, "pow”-pmu : FaedØİ’ " 
PMUDEV
 "\n");

106  
FALSE
;

108 
»t
 = 
	`ioùl
 (
fd
, 
PMU_IOC_GET_BACKLIGHT
, 
v®
);

109 
	`şo£
 (
fd
);

111 ià(
»t
 < 0) {

112 
	`årštf
 (
¡d”r
, "power-pmu : PMU_IOC_GET_BACKLIGHT failed\n");

113  
FALSE
;

115  
TRUE
;

117 
	}
}

128 
	$pmac_£t_lcd_brighŠess
 (
v®
)

130 #ifdeà
__F»eBSD__


131  
FALSE
;

132 #–ià
sun


133  
FALSE
;

134 #–ià
__GNU__


135  
FALSE
;

137 
»t
;

138 
fd
;

140 
fd
 = 
	`İ’
 (
PMUDEV
, 
O_RDWR
);

141 ià(
fd
 < 0) {

142 
	`årštf
 (
¡d”r
, "pow”-pmu : FaedØİ’ " 
PMUDEV
 "\n");

143  
FALSE
;

145 
»t
 = 
	`ioùl
 (
fd
, 
PMU_IOC_SET_BACKLIGHT
, &
v®
);

146 
	`şo£
 (
fd
);

148 ià(
»t
 < 0) {

149 
	`årštf
 (
¡d”r
, "power-pmu : PMU_IOC_SET_BACKLIGHT failed\n");

150  
FALSE
;

152  
TRUE
;

154 
	}
}

164 
	$u§ge
 (
¬gc
, *
¬gv
[])

166 
	`årštf
 (
¡d”r
, "\nusage : hal-system-power-pmu "

168 
	`årštf
 (
¡d”r
,

177 
	}
}

189 
	$maš
 (
¬gc
, *
¬gv
[])

191 
brighŠess
;

192 
»t
;

194 ià(
¬gc
 == 2) {

195 ià(
	`¡rcmp
 (
¬gv
[1], "sleep") == 0) {

196 
»t
 = 
	`pmac_¦“p
 ();

197 ià(
»t
 =ğ
FALSE
)

198  
EXIT_FAILURE
;

199  
EXIT_SUCCESS
;

201 ià(
	`¡rcmp
 (
¬gv
[1], "getlcd") == 0) {

202 
»t
 = 
	`pmac_g‘_lcd_brighŠess
 (&
brighŠess
);

203 ià(
»t
 =ğ
FALSE
)

204  
EXIT_FAILURE
;

206 
	`´štf
 ("%i", 
brighŠess
 - 1);

207  
EXIT_SUCCESS
;

209 ià(
	`¡rcmp
 (
¬gv
[1], "backlightoff") == 0) {

210 
»t
 = 
	`pmac_£t_lcd_brighŠess
 (0);

211 ià(
»t
 =ğ
FALSE
)

212  
EXIT_FAILURE
;

213  
EXIT_SUCCESS
;

215 } ià(
¬gc
 == 3) {

216 ià(
	`¡rcmp
 (
¬gv
[1], "setlcd") == 0) {

218 
brighŠess
 = 
	`©oi
 (
¬gv
[2]) + 1;

219 
»t
 = 
	`pmac_£t_lcd_brighŠess
 (
brighŠess
);

220 ià(
»t
 =ğ
FALSE
)

221  
EXIT_FAILURE
;

222  
EXIT_SUCCESS
;

225 
	`u§ge
 (
¬gc
, 
¬gv
);

226  
EXIT_SUCCESS
;

227 
	}
}

	@tools/hal-system-setserial.c

22 
	#_GNU_SOURCE


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~<cÚfig.h
>

28 
	~<¡dio.h
>

29 
	~<¡dlib.h
>

30 
	~<¡ršg.h
>

31 
	~<¡d¬g.h
>

32 
	~<uni¡d.h
>

33 
	~<sy¦og.h
>

35 
	#MAX_CMD_LENGTH
 256

	)

37 
	gdebug
 = 0;

40 
	$maš
 (
¬gc
, cÚ¡ *
¬gv
[])

42 
»t_v®
 = 
EXIT_FAILURE
;

43 *
udi
 = 
NULL
;

44 *
œq
 = 
NULL
;

45 *
pÜt
 = 
NULL
;

46 *
baud_ba£
 = 
NULL
;

47 *
šput_dev
 = 
NULL
;

48 
cmd
[
MAX_CMD_LENGTH
+1];

50 ià(
	`g‘’v
 ("HALD_VERBOSE"è!ğ
NULL
 )

51 
debug
 = 1;

52 ià(
debug
)

53 
	`sy¦og
 (
LOG_INFO
, "hal-system-setserial started in debug mode." );

55 
udi
 = 
	`g‘’v
("UDI");

56 
œq
 = 
	`g‘’v
("HAL_PROP_PNP_SERIAL_IRQ");

57 
pÜt
 = 
	`g‘’v
("HAL_PROP_PNP_SERIAL_PORT");

58 
baud_ba£
 = 
	`g‘’v
("HAL_PROP_PNP_SERIAL_BAUD_BASE");

59 
šput_dev
 = 
	`g‘’v
("HAL_PROP_INPUT_DEVICE_SET");

61 ià(
udi
 =ğ
NULL
 || 
œq
 =ğNULL || 
pÜt
 =ğNULL || 
šput_dev
 == NULL) {

62 
	`sy¦og
 (
LOG_INFO
, "Missingƒnv variable,ƒxit NOW." );

63  
»t_v®
;

66 ià(
baud_ba£
 !ğ
NULL
)

67 
	`¢´štf
Ğ
cmd
, 
MAX_CMD_LENGTH
, "/bš/£t£rŸÈ% pÜˆ% œq % baud_ba£ % autocÚfig", 
šput_dev
, 
pÜt
, 
œq
, 
baud_ba£
);

69 
	`¢´štf
Ğ
cmd
, 
MAX_CMD_LENGTH
, "/bš/£t£rŸÈ% pÜˆ% œq % autocÚfig", 
šput_dev
, 
pÜt
, 
œq
);

71 
	`sy¦og
 (
LOG_INFO
, "CŞËùed s‘£rŸÈİtiÚ ªd c®Ëd(%d): % ", 
	`sy¡em
(
cmd
), cmd);

73 
»t_v®
 = 
EXIT_SUCCESS
;

75  
»t_v®
;

76 
	}
}

	@tools/hal-system-sonypic.c

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡ršg.h
>

33 
	~<¡d¬g.h
>

34 
	~<uni¡d.h
>

35 
	~<g‘İt.h
>

36 
	~<fú.h
>

37 
	~<glib.h
>

39 
	~<sys/ioùl.h
>

41 #ifdeà
__lšux__


42 
	~<lšux/sÚypi.h
>

43 
	#SONYPI_DEV
 "/dev/sÚypi"

	)

44 
	#__u8
 
u_št8_t


	)

47 
	~<libh®/libh®.h
>

64 
	$sÚypi_g‘_lcd_brighŠess
 (
__u8
 *
v®
)

66 #ifdeà
__F»eBSD__


67  
FALSE
;

68 #–ià
sun


69  
FALSE
;

71 
fd
;

72 
»t
;

74 
fd
 = 
	`İ’
 (
SONYPI_DEV
, 
O_RDONLY
);

75 ià(
fd
 < 0) {

76 
	`årštf
 (
¡d”r
, "sÚy˜: FaedØİ’ " 
SONYPI_DEV
 "\n");

77  
FALSE
;

79 
»t
 = 
	`ioùl
 (
fd
, 
SONYPI_IOCGBRT
, 
v®
);

80 
	`şo£
 (
fd
);

82 ià(
»t
 < 0) {

83 
	`årštf
 (
¡d”r
, "sonypi : SONYPI_IOCGBRT failed\n");

84  
FALSE
;

86  
TRUE
;

88 
	}
}

96 
	$sÚypi_g‘_blu‘oÙh_pow”
 (*
found
, 
usb_v’dÜ_id
, 
usb_´oduù_id
)

98 
LibH®CÚ‹xt
 *
ùx
;

99 
DBusE¼Ü
 
”r
;

100 **
deviûs
;

101 
num_deviûs
, 
i
;

103 *
found
 = 
FALSE
;

105 
	`dbus_”rÜ_š™
 (&
”r
);

106 
ùx
 = 
	`libh®_ùx_š™_dœeù
 (&
”r
);

107 ià(
ùx
 =ğ
NULL
) {

108 
	`årštf
 (
¡d”r
, "CªnÙ cÚù HAL: %s\n", 
	`dbus_”rÜ_is_£t
 (&
”r
) ?

109 
”r
.
mes§ge
 : "No„eason");

110 ià(
	`dbus_”rÜ_is_£t
 (&
”r
))

111 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”r
);

112  
FALSE
;

114 
deviûs
 = 
	`libh®_g‘_®l_deviûs
 (
ùx
, &
num_deviûs
, &
”r
);

115 ià(
	`dbus_”rÜ_is_£t
 (&
”r
))

116 
”rÜ_£t
;

118 
i
 = 0; i < 
num_deviûs
; i++) {

119 
deviû_vid
, 
deviû_pid
;

120 ià(
	`libh®_deviû_´İ”ty_exi¡s
 (
ùx
, 
deviûs
[
i
], "usb.v’dÜ_id", &
”r
è=ğ
FALSE
) {

121 ià(
	`dbus_”rÜ_is_£t
 (&
”r
))

122 
”rÜ_£t
;

125 
deviû_vid
 = 
	`libh®_deviû_g‘_´İ”ty_št
 (
ùx
, 
deviûs
[
i
], "usb.v’dÜ_id", &
”r
);

126 ià(
	`dbus_”rÜ_is_£t
 (&
”r
))

127 
”rÜ_£t
;

128 ià(
deviû_vid
 !ğ
usb_v’dÜ_id
)

131 ià(
	`libh®_deviû_´İ”ty_exi¡s
 (
ùx
, 
deviûs
[
i
], "usb.´oduù_id", &
”r
è=ğ
FALSE
) {

132 ià(
	`dbus_”rÜ_is_£t
 (&
”r
))

133 
”rÜ_£t
;

136 
deviû_pid
 = 
	`libh®_deviû_g‘_´İ”ty_št
 (
ùx
, 
deviûs
[
i
], "usb.´oduù_id", &
”r
);

137 ià(
	`dbus_”rÜ_is_£t
 (&
”r
))

138 
”rÜ_£t
;

139 ià(
deviû_pid
 !ğ
usb_´oduù_id
)

143 *
found
 = 
TRUE
;

147 
	`libh®_ùx_shutdown
 (
ùx
, 
NULL
);

148  
TRUE
;

150 
”rÜ_£t
:

151 
	`årštf
 (
¡d”r
, "E¼Ü†ookšg fÜhBlu‘oÙh deviû: %s\n", 
”r
.
mes§ge
);

152 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”r
);

153 
	`libh®_ùx_shutdown
 (
ùx
, &
”r
);

155  
FALSE
;

156 
	}
}

164 
	$sÚypi_£t_lcd_brighŠess
 (
__u8
 
v®
)

166 #ifdeà
__F»eBSD__


167  
FALSE
;

168 #–ià
sun


169  
FALSE
;

171 
»t
;

172 
fd
;

174 
fd
 = 
	`İ’
 (
SONYPI_DEV
, 
O_RDWR
);

175 ià(
fd
 < 0) {

176 
	`årštf
 (
¡d”r
, "sÚyp˜: FaedØİ’ " 
SONYPI_DEV
 "\n");

177  
FALSE
;

179 
»t
 = 
	`ioùl
 (
fd
, 
SONYPI_IOCSBRT
, &
v®
);

180 
	`şo£
 (
fd
);

182 ià(
»t
 < 0) {

183 
	`årštf
 (
¡d”r
, "sonypi : SONYPI_IOCSBRT failed\n");

184  
FALSE
;

186  
TRUE
;

188 
	}
}

196 
	$sÚypi_£t_blu‘oÙh_pow”
 (
v®
)

198 #ifdeà
__F»eBSD__


199  
FALSE
;

200 #–ià
sun


201  
FALSE
;

203 
»t
;

204 
fd
;

206 
fd
 = 
	`İ’
 (
SONYPI_DEV
, 
O_RDWR
);

207 ià(
fd
 < 0) {

208 
	`årštf
 (
¡d”r
, "sÚyp˜: FaedØİ’ " 
SONYPI_DEV
 "\n");

209  
FALSE
;

211 
»t
 = 
	`ioùl
 (
fd
, 
SONYPI_IOCSBLUE
, &
v®
);

212 
	`şo£
 (
fd
);

214 ià(
»t
 < 0) {

215 
	`årštf
 (
¡d”r
, "sonypi : SONYPI_IOCSBLUE failed\n");

216  
FALSE
;

218  
TRUE
;

220 
	}
}

228 
	$u§ge
 (
¬gc
, *
¬gv
[])

230 
	`årštf
 (
¡d”r
, "\nusage : hal-system-sonypi "

232 
	`årštf
 (
¡d”r
,

241 
	}
}

250 
	$maš
 (
¬gc
, *
¬gv
[])

252 
__u8
 
brighŠess
;

253 
pow”
;

254 
»t
;

256 ià(
¬gc
 == 2) {

257 ià(
	`¡rcmp
 (
¬gv
[1], "getlcd") == 0) {

258 
»t
 = 
	`sÚypi_g‘_lcd_brighŠess
 (&
brighŠess
);

259 ià(
»t
 =ğ
FALSE
)

260  
EXIT_FAILURE
;

261 
	`´štf
 ("%i", 
brighŠess
);

262  
EXIT_SUCCESS
;

264 ià(
	`¡rcmp
 (
¬gv
[1], "getbluetooth") == 0) {

265 cÚ¡ *
usb_v’dÜ_id
, *
usb_´oduù_id
;

266 
vid
, 
pid
;

268 
pow”
 = 0;

269 ià((
usb_v’dÜ_id
 = 
	`g_g‘’v
 ("HAL_PROP_KILLSWITCH_EXPECTED_USB_VENDOR_ID")è=ğ
NULL


270 || (
usb_´oduù_id
 = 
	`g_g‘’v
 ("HAL_PROP_KILLSWITCH_EXPECTED_USB_PRODUCT_ID")è=ğ
NULL
) {

271 
	`årštf
 (
¡d”r
, "sonypi :‚oƒxpected USB IDs supplied\n");

272  
EXIT_FAILURE
;

275 
vid
 = (è
	`g_ascii_¡¹ouÎ
 (
usb_v’dÜ_id
, 
NULL
, 0);

276 
pid
 = (è
	`g_ascii_¡¹ouÎ
 (
usb_´oduù_id
, 
NULL
, 0);

277 
»t
 = 
	`sÚypi_g‘_blu‘oÙh_pow”
 (&
pow”
, 
vid
, 
pid
);

279 ià(
»t
 =ğ
FALSE
)

280  
EXIT_FAILURE
;

281 
	`´štf
 ("%i", 
pow”
);

282  
EXIT_SUCCESS
;

284 } ià(
¬gc
 == 3) {

285 ià(
	`¡rcmp
 (
¬gv
[1], "setlcd") == 0) {

288 
brighŠess
 = 
	`©oi
 (
¬gv
[2]);

289 
»t
 = 
	`sÚypi_£t_lcd_brighŠess
 (
brighŠess
);

290 ià(
»t
 =ğ
FALSE
)

291  
EXIT_FAILURE
;

292  
EXIT_SUCCESS
;

294 ià(
	`¡rcmp
 (
¬gv
[1], "setbluetooth") == 0) {

295 
pow”
 = 
	`©oi
 (
¬gv
[2]);

296 
»t
 = 
	`sÚypi_£t_blu‘oÙh_pow”
 (
pow”
);

297 ià(
»t
 =ğ
FALSE
)

298  
EXIT_FAILURE
;

299  
EXIT_SUCCESS
;

302 
	`u§ge
 (
¬gc
, 
¬gv
);

303  
EXIT_SUCCESS
;

304 
	}
}

	@tools/hal_find_by_capability.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dio.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<g‘İt.h
>

36 
	~<libh®.h
>

47 
	$u§ge
 (
¬gc
, *
¬gv
[])

49 
	`årštf
 (
¡d”r
,

53 
	`årštf
 (
¡d”r
,

65 
	}
}

77 
	$maš
 (
¬gc
, *
¬gv
[])

79 
i
;

80 
num_udis
;

81 **
udis
;

82 *
ÿ·b™y
 = 
NULL
;

83 
dbus_boŞ_t
 
is_v”bo£
 = 
FALSE
;

84 
dbus_boŞ_t
 
is_v”siÚ
 = 
FALSE
;

85 
DBusE¼Ü
 
”rÜ
;

86 
LibH®CÚ‹xt
 *
h®_ùx
;

88 ià(
¬gc
 <= 1) {

89 
	`u§ge
 (
¬gc
, 
¬gv
);

94 
c
;

95 
İtiÚ_šdex
 = 0;

96 cÚ¡ *
İt
;

97 
İtiÚ
 
lÚg_İtiÚs
[] = {

98 {"ÿ·b™y", 1, 
NULL
, 0},

99 {"v”bo£", 0, 
NULL
, 0},

100 {"v”siÚ", 0, 
NULL
, 0},

101 {"h–p", 0, 
NULL
, 0},

102 {
NULL
, 0, NULL, 0}

105 
c
 = 
	`g‘İt_lÚg
 (
¬gc
, 
¬gv
, "",

106 
lÚg_İtiÚs
, &
İtiÚ_šdex
);

107 ià(
c
 == -1)

110 
c
) {

112 
İt
 = 
lÚg_İtiÚs
[
İtiÚ_šdex
].
Çme
;

114 ià(
	`¡rcmp
 (
İt
, "help") == 0) {

115 
	`u§ge
 (
¬gc
, 
¬gv
);

117 } ià(
	`¡rcmp
 (
İt
, "verbose") == 0) {

118 
is_v”bo£
 = 
TRUE
;

119 } ià(
	`¡rcmp
 (
İt
, "version") == 0) {

120 
is_v”siÚ
 = 
TRUE
;

121 } ià(
	`¡rcmp
 (
İt
, "capability") == 0) {

122 
ÿ·b™y
 = 
	`¡rdup
 (
İrg
);

127 
	`u§ge
 (
¬gc
, 
¬gv
);

133 ià(
is_v”siÚ
) {

134 
	`´štf
 ("h®-fšd-by-ÿ·b™y " 
PACKAGE_VERSION
 "\n");

138 ià(
ÿ·b™y
 =ğ
NULL
) {

139 
	`u§ge
 (
¬gc
, 
¬gv
);

143 
	`dbus_”rÜ_š™
 (&
”rÜ
);

144 ià((
h®_ùx
 = 
	`libh®_ùx_Ãw
 ()è=ğ
NULL
) {

145 
	`årštf
 (
¡d”r
, "error:†ibhal_ctx_new\n");

146 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

149 ià(!
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
h®_ùx
, 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
))) {

150 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_£t_dbus_cÚÃùiÚ: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

151 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

154 ià(!
	`libh®_ùx_š™
 (
h®_ùx
, &
”rÜ
)) {

155 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

156 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_š™: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

157 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

159 
	`årštf
 (
¡d”r
, "Could‚ot initialise connectiono hald.\n"

165 
udis
 = 
	`libh®_fšd_deviû_by_ÿ·b™y
 (
h®_ùx
, 
ÿ·b™y
, &
num_udis
, &
”rÜ
);

167 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

168 
	`årštf
 (
¡d”r
, "”rÜ: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

169 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

173 ià(
is_v”bo£
)

174 
	`´štf
 ("Found %d deviû objeù oàÿ·b™y '%s'\n", 
num_udis
, 
ÿ·b™y
);

176 ià(
num_udis
 == 0) {

180 
i
 = 0; i < 
num_udis
; i++) {

181 
	`´štf
 ("%s\n", 
udis
[
i
]);

184 
	`libh®_ä“_¡ršg_¬¿y
 (
udis
);

187 
	}
}

	@tools/hal_find_by_property.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dio.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<g‘İt.h
>

36 
	~<libh®.h
>

47 
	$u§ge
 (
¬gc
, *
¬gv
[])

49 
	`årštf
 (
¡d”r
,

56 
	`årštf
 (
¡d”r
,

69 
	}
}

81 
	$maš
 (
¬gc
, *
¬gv
[])

83 
i
;

84 
num_udis
;

85 **
udis
;

86 *
key
 = 
NULL
;

87 *
v®ue
 = 
NULL
;

88 
dbus_boŞ_t
 
is_v”bo£
 = 
FALSE
;

89 
dbus_boŞ_t
 
is_v”siÚ
 = 
FALSE
;

90 
DBusE¼Ü
 
”rÜ
;

91 
LibH®CÚ‹xt
 *
h®_ùx
;

93 ià(
¬gc
 <= 1) {

94 
	`u§ge
 (
¬gc
, 
¬gv
);

99 
c
;

100 
İtiÚ_šdex
 = 0;

101 cÚ¡ *
İt
;

102 
İtiÚ
 
lÚg_İtiÚs
[] = {

103 {"key", 1, 
NULL
, 0},

104 {"¡ršg", 1, 
NULL
, 0},

105 {"v”bo£", 0, 
NULL
, 0},

106 {"v”siÚ", 0, 
NULL
, 0},

107 {"h–p", 0, 
NULL
, 0},

108 {
NULL
, 0, NULL, 0}

111 
c
 = 
	`g‘İt_lÚg
 (
¬gc
, 
¬gv
, "",

112 
lÚg_İtiÚs
, &
İtiÚ_šdex
);

113 ià(
c
 == -1)

116 
c
) {

118 
İt
 = 
lÚg_İtiÚs
[
İtiÚ_šdex
].
Çme
;

120 ià(
	`¡rcmp
 (
İt
, "help") == 0) {

121 
	`u§ge
 (
¬gc
, 
¬gv
);

123 } ià(
	`¡rcmp
 (
İt
, "verbose") == 0) {

124 
is_v”bo£
 = 
TRUE
;

125 } ià(
	`¡rcmp
 (
İt
, "version") == 0) {

126 
is_v”siÚ
 = 
TRUE
;

127 } ià(
	`¡rcmp
 (
İt
, "key") == 0) {

128 
key
 = 
	`¡rdup
 (
İrg
);

129 } ià(
	`¡rcmp
 (
İt
, "string") == 0) {

130 
v®ue
 = 
	`¡rdup
 (
İrg
);

135 
	`u§ge
 (
¬gc
, 
¬gv
);

141 ià(
is_v”siÚ
) {

142 
	`´štf
 ("h®-fšd-by-´İ”ty " 
PACKAGE_VERSION
 "\n");

146 ià(
key
 =ğ
NULL
 || 
v®ue
 == NULL) {

147 
	`u§ge
 (
¬gc
, 
¬gv
);

151 
	`dbus_”rÜ_š™
 (&
”rÜ
);

152 ià((
h®_ùx
 = 
	`libh®_ùx_Ãw
 ()è=ğ
NULL
) {

153 
	`årštf
 (
¡d”r
, "error:†ibhal_ctx_new\n");

156 ià(!
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
h®_ùx
, 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
))) {

157 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_£t_dbus_cÚÃùiÚ: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

158 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

161 ià(!
	`libh®_ùx_š™
 (
h®_ùx
, &
”rÜ
)) {

162 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

163 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_š™: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

164 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

166 
	`årštf
 (
¡d”r
, "Could‚ot initialise connectiono hald.\n"

172 
udis
 = 
	`libh®_mªag”_fšd_deviû_¡ršg_m©ch
 (
h®_ùx
, 
key
, 
v®ue
, &
num_udis
, &
”rÜ
);

174 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

175 
	`årštf
 (
¡d”r
, "”rÜ: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

176 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

180 ià(
is_v”bo£
)

181 
	`´štf
 ("Found %d deviû objeù w™h sŒšg…rİ”ty % ğ'%s'\n", 
num_udis
, 
key
, 
v®ue
);

183 ià(
num_udis
 == 0) {

187 
i
 = 0; i < 
num_udis
; i++) {

188 
	`´štf
 ("%s\n", 
udis
[
i
]);

191 
	`libh®_ä“_¡ršg_¬¿y
 (
udis
);

194 
	}
}

	@tools/hal_get_property.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dio.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<g‘İt.h
>

36 
	~<libh®.h
>

38 
LibH®CÚ‹xt
 *
	gh®_ùx
;

48 
	$u§ge
 (
¬gc
, *
¬gv
[])

50 
	`årštf
 (
¡d”r
,

54 
	`årštf
 (
¡d”r
,

67 
	}
}

79 
	$maš
 (
¬gc
, *
¬gv
[])

81 *
udi
 = 
NULL
;

82 *
key
 = 
NULL
;

83 
ty³
;

84 
dbus_boŞ_t
 
is_hex
 = 
FALSE
;

85 
dbus_boŞ_t
 
is_v”bo£
 = 
FALSE
;

86 
dbus_boŞ_t
 
is_v”siÚ
 = 
FALSE
;

87 
dbus_boŞ_t
 
udi_exi¡s
;

88 *
¡r
;

89 
DBusE¼Ü
 
”rÜ
;

91 ià(
¬gc
 <= 1) {

92 
	`u§ge
 (
¬gc
, 
¬gv
);

97 
c
;

98 
İtiÚ_šdex
 = 0;

99 cÚ¡ *
İt
;

100 
İtiÚ
 
lÚg_İtiÚs
[] = {

101 {"udi", 1, 
NULL
, 0},

102 {"key", 1, 
NULL
, 0},

103 {"hex", 0, 
NULL
, 0},

104 {"v”bo£", 0, 
NULL
, 0},

105 {"v”siÚ", 0, 
NULL
, 0},

106 {"h–p", 0, 
NULL
, 0},

107 {
NULL
, 0, NULL, 0}

110 
c
 = 
	`g‘İt_lÚg
 (
¬gc
, 
¬gv
, "",

111 
lÚg_İtiÚs
, &
İtiÚ_šdex
);

112 ià(
c
 == -1)

115 
c
) {

117 
İt
 = 
lÚg_İtiÚs
[
İtiÚ_šdex
].
Çme
;

119 ià(
	`¡rcmp
 (
İt
, "help") == 0) {

120 
	`u§ge
 (
¬gc
, 
¬gv
);

122 } ià(
	`¡rcmp
 (
İt
, "hex") == 0) {

123 
is_hex
 = 
TRUE
;

124 } ià(
	`¡rcmp
 (
İt
, "verbose") == 0) {

125 
is_v”bo£
 = 
TRUE
;

126 } ià(
	`¡rcmp
 (
İt
, "version") == 0) {

127 
is_v”siÚ
 = 
TRUE
;

128 } ià(
	`¡rcmp
 (
İt
, "key") == 0) {

129 
key
 = 
	`¡rdup
 (
İrg
);

130 } ià(
	`¡rcmp
 (
İt
, "udi") == 0) {

131 
udi
 = 
	`¡rdup
 (
İrg
);

136 
	`u§ge
 (
¬gc
, 
¬gv
);

142 ià(
is_v”siÚ
) {

143 
	`´štf
 ("h®-g‘-´İ”ty " 
PACKAGE_VERSION
 "\n");

147 ià(
udi
 =ğ
NULL
 || 
key
 == NULL) {

148 
	`u§ge
 (
¬gc
, 
¬gv
);

152 
	`dbus_”rÜ_š™
 (&
”rÜ
);

153 ià((
h®_ùx
 = 
	`libh®_ùx_Ãw
 ()è=ğ
NULL
) {

154 
	`årštf
 (
¡d”r
, "error:†ibhal_ctx_new\n");

157 ià(!
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
h®_ùx
, 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
))) {

158 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_£t_dbus_cÚÃùiÚ: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

159 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

162 ià(!
	`libh®_ùx_š™
 (
h®_ùx
, &
”rÜ
)) {

163 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

164 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_š™: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

165 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

167 
	`årštf
 (
¡d”r
, "Could‚ot initialise connectiono hald.\n"

173 
udi_exi¡s
 = 
	`libh®_deviû_exi¡s
 (
h®_ùx
, 
udi
, &
”rÜ
);

174 ià(!
udi_exi¡s
) {

175 
	`årštf
 (
¡d”r
, "”rÜ: UDI % dÛ nÙƒxi¡\n", 
udi
);

178 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

179 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_deviû_exi¡s: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

180 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

185 
ty³
 = 
	`libh®_deviû_g‘_´İ”ty_ty³
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
);

186 ià(
ty³
 =ğ
LIBHAL_PROPERTY_TYPE_INVALID
) {

187 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_deviû_g‘_´İ”ty_ty³: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

188 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

192 
ty³
) {

193 
LIBHAL_PROPERTY_TYPE_STRING
:

194 
¡r
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
);

195 ià(
is_v”bo£
)

196 
	`´štf
 ("Type is string\n");

197 
	`´štf
 ("%s\n", 
¡r
);

198 
	`libh®_ä“_¡ršg
 (
¡r
);

200 
LIBHAL_PROPERTY_TYPE_INT32
:

201 ià(
is_v”bo£
)

202 
	`´štf
 ("Type is integer (shown in %s)\n",

203 (
is_hex
 ? "hexadecimal" : "decimal"));

204 
	`´štf
 ((
is_hex
 ? "%x\n" : "%d\n"),

205 
	`libh®_deviû_g‘_´İ”ty_št
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
));

207 
LIBHAL_PROPERTY_TYPE_UINT64
:

208 ià(
is_v”bo£
)

209 
	`´štf
 ("Type is uint64 (shown in %s)\n",

210 (
is_hex
 ? "hexadecimal" : "decimal"));

211 
	`´štf
 ((
is_hex
 ? "%llx\n" : "%llu\n"),

212 (è
	`libh®_deviû_g‘_´İ”ty_ušt64
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
));

214 
LIBHAL_PROPERTY_TYPE_DOUBLE
:

215 ià(
is_v”bo£
)

216 
	`´štf
 ("Type is double\n");

217 
	`´štf
 ("%f\n",

218 
	`libh®_deviû_g‘_´İ”ty_doubË
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
));

220 
LIBHAL_PROPERTY_TYPE_BOOLEAN
:

221 ià(
is_v”bo£
)

222 
	`´štf
 ("Type is boolean\n");

223 
	`´štf
 ("%s\n",

224 
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
) ? "true" : "false");

227 
LIBHAL_PROPERTY_TYPE_STRLIST
:

229 
i
;

230 **
¡¾i¡
;

232 ià((
¡¾i¡
 = 
	`libh®_deviû_g‘_´İ”ty_¡¾i¡
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
)è!ğ
NULL
) {

234 
i
 = 0; 
¡¾i¡
[i] !ğ
NULL
; i++) {

235 
	`´štf
 ("%s", 
¡¾i¡
[
i
]);

236 ià(
¡¾i¡
[
i
+1] !ğ
NULL
)

237 
	`´štf
 (" ");

243 
	`´štf
 ("UnknowÀty³ %d='%c'\n", 
ty³
,ype);

248 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

249 
	`årštf
 (
¡d”r
, "”rÜ: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

250 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

256 
	}
}

	@tools/hal_set_property.c

27 #ifdeà
HAVE_CONFIG_H


28 
	~<cÚfig.h
>

31 
	~<¡dio.h
>

32 
	~<¡dlib.h
>

33 
	~<¡ršg.h
>

34 
	~<uni¡d.h
>

35 
	~<g‘İt.h
>

37 
	~<libh®.h
>

39 
LibH®CÚ‹xt
 *
	gh®_ùx
;

41 
	e´İ”ty_İ
 {

42 
	mPROP_INT
,

43 
	mPROP_UINT64
,

44 
	mPROP_STRING
,

45 
	mPROP_DOUBLE
,

46 
	mPROP_BOOL
,

47 
	mPROP_STRLIST_PRE
,

48 
	mPROP_STRLIST_POST
,

49 
	mPROP_STRLIST_REM
,

50 
	mPROP_INVALID


61 
	$u§ge
 (
¬gc
, *
¬gv
[])

63 
	`årštf
 (
¡d”r
,

70 
	`årštf
 (
¡d”r
,

91 
	}
}

103 
	$maš
 (
¬gc
, *
¬gv
[])

105 
dbus_boŞ_t
 
rc
 = 0;

106 *
udi
 = 
NULL
;

107 *
key
 = 
NULL
;

108 *
¡r_v®ue
 = 
NULL
;

109 
dbus_št32_t
 
št_v®ue
 = 0;

110 
dbus_ušt64_t
 
ušt64_v®ue
 = 0;

111 
doubË_v®ue
 = 0.0f;

112 
dbus_boŞ_t
 
boŞ_v®ue
 = 
TRUE
;

113 
dbus_boŞ_t
 
»move
 = 
FALSE
;

114 
dbus_boŞ_t
 
is_v”siÚ
 = 
FALSE
;

115 
ty³
 = 
PROP_INVALID
;

116 
DBusE¼Ü
 
”rÜ
;

118 ià(
¬gc
 <= 1) {

119 
	`u§ge
 (
¬gc
, 
¬gv
);

124 
c
;

125 
İtiÚ_šdex
 = 0;

126 cÚ¡ *
İt
;

127 
İtiÚ
 
lÚg_İtiÚs
[] = {

128 {"udi", 1, 
NULL
, 0},

129 {"key", 1, 
NULL
, 0},

130 {"št", 1, 
NULL
, 0},

131 {"ušt64", 1, 
NULL
, 0},

132 {"¡ršg", 1, 
NULL
, 0},

133 {"doubË", 1, 
NULL
, 0},

134 {"boŞ", 1, 
NULL
, 0},

135 {"¡¾i¡-´e", 1, 
NULL
, 0},

136 {"¡¾i¡-po¡", 1, 
NULL
, 0},

137 {"¡¾i¡-»m", 1, 
NULL
, 0},

138 {"»move", 0, 
NULL
, 0},

139 {"v”siÚ", 0, 
NULL
, 0},

140 {"h–p", 0, 
NULL
, 0},

141 {
NULL
, 0, NULL, 0}

144 
c
 = 
	`g‘İt_lÚg
 (
¬gc
, 
¬gv
, "",

145 
lÚg_İtiÚs
, &
İtiÚ_šdex
);

146 ià(
c
 == -1)

149 
c
) {

151 
İt
 = 
lÚg_İtiÚs
[
İtiÚ_šdex
].
Çme
;

153 ià(
	`¡rcmp
 (
İt
, "help") == 0) {

154 
	`u§ge
 (
¬gc
, 
¬gv
);

156 } ià(
	`¡rcmp
 (
İt
, "key") == 0) {

157 
key
 = 
	`¡rdup
 (
İrg
);

158 } ià(
	`¡rcmp
 (
İt
, "string") == 0) {

159 
¡r_v®ue
 = 
	`¡rdup
 (
İrg
);

160 
ty³
 = 
PROP_STRING
;

161 } ià(
	`¡rcmp
 (
İt
, "int") == 0) {

162 
št_v®ue
 = 
	`¡¹Ş
 (
İrg
, 
NULL
, 0);

163 
ty³
 = 
PROP_INT
;

164 } ià(
	`¡rcmp
 (
İt
, "uint64") == 0) {

165 
ušt64_v®ue
 = 
	`¡¹ouÎ
 (
İrg
, 
NULL
, 0);

166 
ty³
 = 
PROP_UINT64
;

167 } ià(
	`¡rcmp
 (
İt
, "double") == 0) {

168 
doubË_v®ue
 = (è
	`©of
 (
İrg
);

169 
ty³
 = 
PROP_DOUBLE
;

170 } ià(
	`¡rcmp
 (
İt
, "bool") == 0) {

171 ià(
	`¡rcmp
 (
İrg
, "true") == 0)

172 
boŞ_v®ue
 = 
TRUE
;

173 ià(
	`¡rcmp
 (
İrg
, "false") == 0)

174 
boŞ_v®ue
 = 
FALSE
;

176 
	`u§ge
 (
¬gc
, 
¬gv
);

179 
ty³
 = 
PROP_BOOL
;

180 } ià(
	`¡rcmp
 (
İt
, "strlist-pre") == 0) {

181 
¡r_v®ue
 = 
	`¡rdup
 (
İrg
);

182 
ty³
 = 
PROP_STRLIST_PRE
;

183 } ià(
	`¡rcmp
 (
İt
, "strlist-post") == 0) {

184 
¡r_v®ue
 = 
	`¡rdup
 (
İrg
);

185 
ty³
 = 
PROP_STRLIST_POST
;

186 } ià(
	`¡rcmp
 (
İt
, "strlist-rem") == 0) {

187 
¡r_v®ue
 = 
	`¡rdup
 (
İrg
);

188 
ty³
 = 
PROP_STRLIST_REM
;

189 } ià(
	`¡rcmp
 (
İt
, "remove") == 0) {

190 
»move
 = 
TRUE
;

191 } ià(
	`¡rcmp
 (
İt
, "udi") == 0) {

192 
udi
 = 
	`¡rdup
 (
İrg
);

193 } ià(
	`¡rcmp
 (
İt
, "version") == 0) {

194 
is_v”siÚ
 = 
TRUE
;

199 
	`u§ge
 (
¬gc
, 
¬gv
);

205 ià(
is_v”siÚ
) {

206 
	`´štf
 ("h®-£t-´İ”ty " 
PACKAGE_VERSION
 "\n");

211 ià((
»move
 && 
ty³
 !ğ
PROP_INVALID
) || ((!remove) &&ype == PROP_INVALID)) {

212 
	`u§ge
 (
¬gc
, 
¬gv
);

216 
	`årštf
 (
¡d”r
, "\n");

218 
	`dbus_”rÜ_š™
 (&
”rÜ
);

219 ià((
h®_ùx
 = 
	`libh®_ùx_Ãw
 ()è=ğ
NULL
) {

220 
	`årštf
 (
¡d”r
, "error:†ibhal_ctx_new\n");

223 ià(!
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
h®_ùx
, 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
))) {

224 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_£t_dbus_cÚÃùiÚ: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

225 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

228 ià(!
	`libh®_ùx_š™
 (
h®_ùx
, &
”rÜ
)) {

229 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

230 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_š™: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

231 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

233 
	`årštf
 (
¡d”r
, "Could‚ot initialise connectiono hald.\n"

238 ià(
»move
) {

239 
rc
 = 
	`libh®_deviû_»move_´İ”ty
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
);

240 ià(!
rc
) {

241 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_deviû_»move_´İ”ty: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

242 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

246 
ty³
) {

247 
PROP_STRING
:

248 
rc
 = 
	`libh®_deviû_£t_´İ”ty_¡ršg
 (
h®_ùx
, 
udi
, 
key
, 
¡r_v®ue
, &
”rÜ
);

250 
PROP_INT
:

251 
rc
 = 
	`libh®_deviû_£t_´İ”ty_št
 (
h®_ùx
, 
udi
, 
key
, 
št_v®ue
, &
”rÜ
);

253 
PROP_UINT64
:

254 
rc
 = 
	`libh®_deviû_£t_´İ”ty_ušt64
 (
h®_ùx
, 
udi
, 
key
, 
ušt64_v®ue
, &
”rÜ
);

256 
PROP_DOUBLE
:

257 
rc
 = 
	`libh®_deviû_£t_´İ”ty_doubË
 (
h®_ùx
, 
udi
, 
key
, 
doubË_v®ue
, &
”rÜ
);

259 
PROP_BOOL
:

260 
rc
 = 
	`libh®_deviû_£t_´İ”ty_boŞ
 (
h®_ùx
, 
udi
, 
key
, 
boŞ_v®ue
, &
”rÜ
);

262 
PROP_STRLIST_PRE
:

263 
rc
 = 
	`libh®_deviû_´İ”ty_¡¾i¡_´•’d
 (
h®_ùx
, 
udi
, 
key
, 
¡r_v®ue
, &
”rÜ
);

265 
PROP_STRLIST_POST
:

266 
rc
 = 
	`libh®_deviû_´İ”ty_¡¾i¡_­³nd
 (
h®_ùx
, 
udi
, 
key
, 
¡r_v®ue
, &
”rÜ
);

268 
PROP_STRLIST_REM
:

269 
rc
 = 
	`libh®_deviû_´İ”ty_¡¾i¡_»move
 (
h®_ùx
, 
udi
, 
key
, 
¡r_v®ue
, &
”rÜ
);

272 ià(!
rc
) {

273 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_deviû_£t_´İ”ty: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

274 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

279  
rc
 ? 0 : 1;

280 
	}
}

	@tools/lshal.c

28 #ifdeà
HAVE_CONFIG_H


29 
	~<cÚfig.h
>

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<¡ršg.h
>

35 
	~<uni¡d.h
>

36 
	~<g‘İt.h
>

37 
	~<time.h
>

38 
	~<sys/time.h
>

40 
	~<glib.h
>

41 
	~<dbus/dbus-glib-lowËv–.h
>

42 
	~<dbus/dbus-glib.h
>

43 
	~<libh®.h
>

45 #ifdeà
__SUNPRO_C


46 
	#__FUNCTION__
 
__func__


	)

50 
	#DIE
(
ex´
èdØ{
	`´štf
("*** [DIE] %s:%s():%d : ", 
__FILE__
, 
__FUNCTION__
, 
__LINE__
); 
´štf
ƒx´;…rštf("\n"); 
	`ex™
(1); } 0)

	)

52 
	#UDI_BASE
 "/Üg/ä“desktİ/H®/deviûs/"

	)

54 
LibH®CÚ‹xt
 *
	gh®_ùx
;

55 
dbus_boŞ_t
 
	glÚg_li¡
 = 
FALSE
;

56 
dbus_boŞ_t
 
	gŒ“_v›w
 = 
FALSE
;

57 
dbus_boŞ_t
 
	gshÜt_li¡
 = 
FALSE
;

58 *
	gshow_deviû
 = 
NULL
;

60 
	sDeviû
 {

61 *
	mÇme
;

62 *
	m·»Á
;

74 
	$shÜt_Çme
 (cÚ¡ *
udi
)

76  &
udi
[(
UDI_BASE
) - 1];

77 
	}
}

80 
	$g‘_time
 ()

82 
timev®
 
Šow
;

83 
tm
 *
oÿÉime
;

84 
timezÚe
 
tzÚe
;

85 
tbuf
[256];

86 
buf
[256];

87 
GTimeV®
 
t
;

89 
	`g‘timeofday
 (&
Šow
, &
tzÚe
);

90 
oÿÉime
 = 
	`loÿÉime
 ((
time_t
 *è&
Šow
.
tv_£c
);

91 
	`¡ráime
 (
tbuf
,  (tbuf), "%H:%M:%S", 
oÿÉime
);

93 
	`g_g‘_cu¼’t_time
 (&
t
);

94 
	`g_¢´štf
 (
buf
, (buf), "%s.%03d", 
tbuf
, (è(
t
.
tv_u£c
 / 1000));

95  
buf
;

96 
	}
}

105 
	$´št_´İs
 (cÚ¡ *
udi
)

107 
DBusE¼Ü
 
”rÜ
;

108 
LibH®Prİ”tyS‘
 *
´İs
;

109 
LibH®Prİ”tyS‘I‹¿tÜ
 
™
;

110 
ty³
;

112 
	`dbus_”rÜ_š™
 (&
”rÜ
);

114 
´İs
 = 
	`libh®_deviû_g‘_®l_´İ”t›s
 (
h®_ùx
, 
udi
, &
”rÜ
);

122 ià(
´İs
 =ğ
NULL
) {

123 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

127 
	`libh®_´İ”ty_£t_sÜt
 (
´İs
);

129 
	`libh®_psi_š™
 (&
™
, 
´İs
); 
	`libh®_psi_has_mÜe
 (&™); 
	`libh®_psi_Ãxt
 (&it)) {

130 
ty³
 = 
	`libh®_psi_g‘_ty³
 (&
™
);

131 
ty³
) {

132 
LIBHAL_PROPERTY_TYPE_STRING
:

133 
	`´štf
 (" %s = '%s' (string)\n",

134 
	`libh®_psi_g‘_key
 (&
™
),

135 
	`libh®_psi_g‘_¡ršg
 (&
™
));

138 
LIBHAL_PROPERTY_TYPE_INT32
:

139 
	`´štf
 (" %s = %d (0x%x) (int)\n",

140 
	`libh®_psi_g‘_key
 (&
™
),

141 
	`libh®_psi_g‘_št
 (&
™
),

142 
	`libh®_psi_g‘_št
 (&
™
));

145 
LIBHAL_PROPERTY_TYPE_UINT64
:

146 
	`´štf
 (" %s = %llu (0x%llx) (uint64)\n",

147 
	`libh®_psi_g‘_key
 (&
™
),

148 (è
	`libh®_psi_g‘_ušt64
 (&
™
),

149 (è
	`libh®_psi_g‘_ušt64
 (&
™
));

152 
LIBHAL_PROPERTY_TYPE_DOUBLE
:

153 
	`´štf
 (" %s = %.1f (%g) (double)\n",

154 
	`libh®_psi_g‘_key
 (&
™
),

155 
	`libh®_psi_g‘_doubË
 (&
™
),

156 
	`libh®_psi_g‘_doubË
 (&
™
));

159 
LIBHAL_PROPERTY_TYPE_BOOLEAN
:

160 
	`´štf
 (" %s = %s (bool)\n",

161 
	`libh®_psi_g‘_key
 (&
™
),

162 
	`libh®_psi_g‘_boŞ
 (&
™
) ? "true" :

166 
LIBHAL_PROPERTY_TYPE_STRLIST
:

168 
i
;

169 **
¡¾i¡
;

171 
	`´štf
 (" % ğ{", 
	`libh®_psi_g‘_key
 (&
™
));

173 
¡¾i¡
 = 
	`libh®_psi_g‘_¡¾i¡
 (&
™
);

174 
i
 = 0; 
¡¾i¡
[i] !ğ
NULL
; i++) {

175 
	`´štf
 ("'%s'", 
¡¾i¡
[
i
]);

176 ià(
¡¾i¡
[
i
+1] !ğ
NULL
)

177 
	`´štf
 (", ");

179 
	`´štf
 ("} (string†ist)\n");

184 
	`´štf
 ("UnknowÀty³ %d=0x%02x\n", 
ty³
,ype);

189 
	`libh®_ä“_´İ”ty_£t
 (
´İs
);

190 
	}
}

199 
	$dump_deviû
 (cÚ¡ *
udi
)

201 
DBusE¼Ü
 
”rÜ
;

203 
	`dbus_”rÜ_š™
 (&
”rÜ
);

205 ià(!
	`libh®_deviû_exi¡s
 (
h®_ùx
, 
udi
, &
”rÜ
)) {

206 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

210 ià(
lÚg_li¡
) {

211 
	`´štf
 ("ud˜ğ'%s'\n", 
udi
);

213 
	`´št_´İs
 (
udi
);

214 
	`´štf
 ("\n");

217 
	`´štf
 ("%s\n", 
	`shÜt_Çme
 (
udi
));

218 
	}
}

230 
	$dump_chd»n
 (*
udi
, 
num_deviûs
, 
Deviû
 *
deviûs
, 
d•th
)

232 
i
;

234 
i
 = 0; i < 
num_deviûs
; i++) {

235 ià(!
udi
) {

236 ià(
deviûs
[
i
].
·»Á
)

240 ià(!
deviûs
[
i
].
·»Á
)

242 ià(
	`¡rcmp
 (
deviûs
[
i
].
·»Á
, 
udi
))

246 ià(
lÚg_li¡
)

247 
	`´štf
 ("ud˜ğ'%s'\n", 
deviûs
[
i
].
Çme
);

249 
j
;

250 ià(
Œ“_v›w
) {

251 
j
 = 0;j < 
d•th
;j++)

252 
	`´štf
(" ");

254 
	`´štf
 ("%s\n", 
	`shÜt_Çme
 (
deviûs
[
i
].
Çme
));

257 ià(
lÚg_li¡
) {

258 
	`´št_´İs
 (
deviûs
[
i
].
Çme
);

259 
	`´štf
 ("\n");

262 
	`dump_chd»n
(
deviûs
[
i
].
Çme
, 
num_deviûs
, deviûs, 
d•th
 + 1);

264 
	}
}

272 
	$dump_deviûs
 ()

274 
i
;

275 
num_deviûs
;

276 **
deviû_Çmes
;

277 
Deviû
 *
deviûs
;

278 
DBusE¼Ü
 
”rÜ
;

280 
	`dbus_”rÜ_š™
 (&
”rÜ
);

282 
deviû_Çmes
 = 
	`libh®_g‘_®l_deviûs
 (
h®_ùx
, &
num_deviûs
, &
”rÜ
);

283 ià(
deviû_Çmes
 =ğ
NULL
) {

284 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

285 
	`DIE
 (("Couldn't obtain†ist of devices\n"));

288 
deviûs
 = 
	`m®loc
 ((
Deviû
è* 
num_deviûs
);

289 ià(!
deviûs
) {

290 
	`libh®_ä“_¡ršg_¬¿y
 (
deviû_Çmes
);

294 
i
 = 0;˜< 
num_deviûs
;i++) {

295 
deviûs
[
i
].
Çme
 = 
deviû_Çmes
[i];

296 
deviûs
[
i
].
·»Á
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
h®_ùx
,

297 
deviû_Çmes
[
i
], "šfo.·»Á", &
”rÜ
);

299 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
)) {

302 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

306 ià(
lÚg_li¡
) {

307 
	`´štf
 ("\n"

310 
num_deviûs
);

313 
	`dump_chd»n
(
NULL
, 
num_deviûs
, 
deviûs
, 0);

315 
i
 = 0;˜< 
num_deviûs
;i++) {

316 ià(
deviûs
[
i
].
·»Á
)

317 
	`libh®_ä“_¡ršg
 (
deviûs
[
i
].
·»Á
);

320 
	`ä“
 (
deviûs
);

321 
	`libh®_ä“_¡ršg_¬¿y
 (
deviû_Çmes
);

323 ià(
lÚg_li¡
) {

324 
	`´štf
 ("\n"

327 
num_deviûs
);

329 
	`´štf
 ("\n");

331 
	}
}

342 
	$deviû_added
 (
LibH®CÚ‹xt
 *
ùx
,

343 cÚ¡ *
udi
)

345 ià(
show_deviû
 && 
	`¡rcmp
(show_deviû, 
udi
))

348 ià(
lÚg_li¡
) {

349 
	`´štf
 ("*** %s:†sh®: deviû_added, udi='%s'\n", 
	`g‘_time
 (), 
udi
);

350 
	`´št_´İs
 (
udi
);

352 
	`´štf
 ("%s: % added\n", 
	`g‘_time
 (), 
	`shÜt_Çme
 (
udi
));

353 
	}
}

364 
	$deviû_»moved
 (
LibH®CÚ‹xt
 *
ùx
,

365 cÚ¡ *
udi
)

367 ià(
show_deviû
 && 
	`¡rcmp
(show_deviû, 
udi
))

370 ià(
lÚg_li¡
)

371 
	`´štf
 ("*** %s:†sh®: deviû_»moved, udi='%s'\n", 
	`g‘_time
 (), 
udi
);

373 
	`´štf
 ("%s: % »moved\n", 
	`g‘_time
 (), 
	`shÜt_Çme
 (
udi
));

374 
	}
}

386 
	$deviû_Ãw_ÿ·b™y
 (
LibH®CÚ‹xt
 *
ùx
,

387 cÚ¡ *
udi
,

388 cÚ¡ *
ÿ·b™y
)

390 ià(
show_deviû
 && 
	`¡rcmp
(show_deviû, 
udi
))

393 ià(
lÚg_li¡
) {

394 
	`´štf
 ("*** %s:†sh®:‚ew_ÿ·b™y, udi='%s'\n", 
	`g‘_time
 (), 
udi
);

395 
	`´štf
 ("*** c­ab™y: %s\n", 
ÿ·b™y
);

397 
	`´štf
 ("%s: % ÿ·b™y % added\n", 
	`g‘_time
 (), 
	`shÜt_Çme
 (
udi
),

398 
ÿ·b™y
);

399 
	}
}

411 
	$deviû_lo¡_ÿ·b™y
 (
LibH®CÚ‹xt
 *
ùx
,

412 cÚ¡ *
udi
,

413 cÚ¡ *
ÿ·b™y
)

415 ià(
show_deviû
 && 
	`¡rcmp
(show_deviû, 
udi
))

418 ià(
lÚg_li¡
) {

419 
	`´štf
 ("*** %s:†sh®:†o¡_ÿ·b™y, udi='%s'\n", 
	`g‘_time
 (), 
udi
);

420 
	`´štf
 ("*** c­ab™y: %s\n", 
ÿ·b™y
);

422 
	`´štf
 ("%s: % ÿ·b™y % lo¡\n", 
	`g‘_time
 (), 
	`shÜt_Çme
 (
udi
),

423 
ÿ·b™y
);

424 
	}
}

434 
	$´št_´İ”ty
 (cÚ¡ *
udi
, cÚ¡ *
key
)

436 
ty³
;

437 *
¡r
;

438 
DBusE¼Ü
 
”rÜ
;

440 
	`dbus_”rÜ_š™
 (&
”rÜ
);

442 
ty³
 = 
	`libh®_deviû_g‘_´İ”ty_ty³
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
);

444 
ty³
) {

445 
LIBHAL_PROPERTY_TYPE_STRING
:

446 
¡r
 = 
	`libh®_deviû_g‘_´İ”ty_¡ršg
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
);

447 
	`´štf
 (
lÚg_li¡
?"***‚ew v®ue: '%s' (¡ršg)\n":"'%s'", 
¡r
);

448 
	`libh®_ä“_¡ršg
 (
¡r
);

450 
LIBHAL_PROPERTY_TYPE_INT32
:

452 
dbus_št32_t
 
v®ue
 = 
	`libh®_deviû_g‘_´İ”ty_št
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
);

453 
	`´štf
 (
lÚg_li¡
?"***‚ew value: %d (0x%x) (int)\n":"%d (0x%x)",

454 
v®ue
, value);

457 
LIBHAL_PROPERTY_TYPE_UINT64
:

459 
dbus_ušt64_t
 
v®ue
 = 
	`libh®_deviû_g‘_´İ”ty_ušt64
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
);

460 
	`´štf
 (
lÚg_li¡
?"***‚ew value: %llu (0x%llx) (uint64)\n":"%llu (0x%llx)",

461 (è
v®ue
, () value);

464 
LIBHAL_PROPERTY_TYPE_DOUBLE
:

465 
	`´štf
 (
lÚg_li¡
?"***‚ew value: %g (double)\n":"%g",

466 
	`libh®_deviû_g‘_´İ”ty_doubË
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
));

468 
LIBHAL_PROPERTY_TYPE_BOOLEAN
:

469 
	`´štf
 (
lÚg_li¡
?"***‚ew value: %s (bool)\n":"%s",

470 
	`libh®_deviû_g‘_´İ”ty_boŞ
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
) ? "true" : "false");

472 
LIBHAL_PROPERTY_TYPE_STRLIST
:

474 
i
;

475 **
¡¾i¡
;

477 ià(
lÚg_li¡
)

478 
	`´štf
 ("***‚ew value: {");

480 
	`´štf
 ("{");

482 
¡¾i¡
 = 
	`libh®_deviû_g‘_´İ”ty_¡¾i¡
 (
h®_ùx
, 
udi
, 
key
, &
”rÜ
);

484 ià(
¡¾i¡
 !ğ
NULL
) {

485 
i
 = 0; 
¡¾i¡
[i] !ğ
NULL
; i++) {

486 
	`´štf
 ("'%s'", 
¡¾i¡
[
i
]);

487 ià(
¡¾i¡
[
i
+1] !ğ
NULL
)

488 
	`´štf
 (", ");

490 ià(
lÚg_li¡
)

491 
	`´štf
 ("} (string†ist)\n");

493 
	`´štf
 ("}");

494 
	`libh®_ä“_¡ršg_¬¿y
 (
¡¾i¡
);

500 
	`årštf
 (
¡d”r
, "UnknowÀty³ %d='%c'\n", 
ty³
,ype);

504 ià(
	`dbus_”rÜ_is_£t
 (&
”rÜ
))

505 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

506 
	}
}

520 
	$´İ”ty_modif›d
 (
LibH®CÚ‹xt
 *
ùx
,

521 cÚ¡ *
udi
,

522 cÚ¡ *
key
,

523 
dbus_boŞ_t
 
is_»moved
,

524 
dbus_boŞ_t
 
is_added
)

526 ià(
show_deviû
 && 
	`¡rcmp
(show_deviû, 
udi
))

529 ià(
lÚg_li¡
) {

530 
	`´štf
 ("*** %s:†shal:…roperty_modified, udi=%s, key=%s\n",

531 
	`g‘_time
 (), 
udi
, 
key
);

532 
	`´štf
 (" is_removed=%s, is_added=%s\n",

533 
is_»moved
 ? "true" : "false",

534 
is_added
 ? "true" : "false");

535 ià(!
is_»moved
)

536 
	`´št_´İ”ty
 (
udi
, 
key
);

537 
	`´štf
 ("\n");

539 
	`´štf
 ("%s: % ´İ”ty % ", 
	`g‘_time
 (), 
	`shÜt_Çme
 (
udi
), 
key
);

540 ià(
is_»moved
)

541 
	`´štf
 ("removed");

543 
	`´štf
 ("= ");

544 
	`´št_´İ”ty
 (
udi
, 
key
);

546 ià(
is_added
)

547 
	`´štf
 (" (new)");

549 
	`´štf
 ("\n");

551 
	}
}

565 
	$deviû_cÚd™iÚ
 (
LibH®CÚ‹xt
 *
ùx
,

566 cÚ¡ *
udi
,

567 cÚ¡ *
cÚd™iÚ_Çme
,

568 cÚ¡ *
cÚd™iÚ_d‘as
)

570 ià(
show_deviû
 && 
	`¡rcmp
(show_deviû, 
udi
))

573 ià(
lÚg_li¡
) {

574 
	`´štf
 ("*** %s:†sh®: deviû_cÚd™iÚ, udi=%s\n", 
	`g‘_time
 (), 
udi
);

575 
	`´štf
 (" cÚd™iÚ_Çme=%s\n", 
cÚd™iÚ_Çme
);

576 
	`´štf
 (" cÚd™iÚ_d‘as=%s\n", 
cÚd™iÚ_d‘as
);

577 
	`´štf
 ("\n");

579 
	`´štf
 ("%s: % cÚd™iÚ % ğ%s\n", 
	`g‘_time
 (), 
	`shÜt_Çme
 (
udi
),

580 
cÚd™iÚ_Çme
, 
cÚd™iÚ_d‘as
);

582 
	}
}

585 
	$do_š‹rçû_lock
 (
LibH®CÚ‹xt
 *
ùx
,

586 
dbus_boŞ_t
 
acquœed
,

587 
dbus_boŞ_t
 
glob®
,

588 cÚ¡ *
udi
,

589 cÚ¡ *
š‹rçû_Çme
,

590 cÚ¡ *
lock_owÃr
,

591 
num_locks
)

593 ià(
show_deviû
 && 
	`¡rcmp
(show_deviû, 
udi
))

596 ià(
lÚg_li¡
) {

597 ià(
glob®
)

598 
	`´štf
 ("*** %s:†sh®: glob®_š‹rçû_lock_%s\n", 
	`g‘_time
 (), 
acquœed
 ? "acquired" : "released");

600 
	`´štf
 ("*** %s:†sh®: iÁ”çû_lock_%s, udi=%s\n", 
	`g‘_time
 (), 
acquœed
 ? "acquœed" : "»Ëa£d", 
udi
);

601 
	`´štf
 (" iÁ”çû_Çme=%s\n", 
š‹rçû_Çme
);

602 
	`´štf
 ("†ock_owÃr=%s\n", 
lock_owÃr
);

603 
	`´štf
 ("‚um_locks=%d\n", 
num_locks
);

604 
	`´štf
 ("\n");

606 ià(
glob®
)

607 
	`´štf
 ("%s: glob®_š‹rçû_lock_% % by % (%d†ock”s)\n", 
	`g‘_time
 (),

608 
acquœed
 ? "acquired" : "released",

609 
š‹rçû_Çme
, 
lock_owÃr
, 
num_locks
);

611 
	`´štf
 ("%s: % š‹rçû_lock_% % by % (%d†ock”s)\n", 
	`g‘_time
 (), 
	`shÜt_Çme
 (
udi
),

612 
acquœed
 ? "acquired" : "released",

613 
š‹rçû_Çme
, 
lock_owÃr
, 
num_locks
);

615 
	}
}

618 
	$glob®_š‹rçû_lock_acquœed
 (
LibH®CÚ‹xt
 *
ùx
,

619 cÚ¡ *
š‹rçû_Çme
,

620 cÚ¡ *
lock_owÃr
,

621 
num_locks
)

623 
	`do_š‹rçû_lock
 (
ùx
, 
TRUE
, TRUE, 
NULL
, 
š‹rçû_Çme
, 
lock_owÃr
, 
num_locks
);

624 
	}
}

627 
	$glob®_š‹rçû_lock_»Ëa£d
 (
LibH®CÚ‹xt
 *
ùx
,

628 cÚ¡ *
š‹rçû_Çme
,

629 cÚ¡ *
lock_owÃr
,

630 
num_locks
)

632 
	`do_š‹rçû_lock
 (
ùx
, 
FALSE
, 
TRUE
, 
NULL
, 
š‹rçû_Çme
, 
lock_owÃr
, 
num_locks
);

633 
	}
}

636 
	$š‹rçû_lock_acquœed
 (
LibH®CÚ‹xt
 *
ùx
,

637 cÚ¡ *
udi
,

638 cÚ¡ *
š‹rçû_Çme
,

639 cÚ¡ *
lock_owÃr
,

640 
num_locks
)

642 
	`do_š‹rçû_lock
 (
ùx
, 
TRUE
, 
FALSE
, 
udi
, 
š‹rçû_Çme
, 
lock_owÃr
, 
num_locks
);

643 
	}
}

646 
	$š‹rçû_lock_»Ëa£d
 (
LibH®CÚ‹xt
 *
ùx
,

647 cÚ¡ *
udi
,

648 cÚ¡ *
š‹rçû_Çme
,

649 cÚ¡ *
lock_owÃr
,

650 
num_locks
)

652 
	`do_š‹rçû_lock
 (
ùx
, 
FALSE
, FALSE, 
udi
, 
š‹rçû_Çme
, 
lock_owÃr
, 
num_locks
);

653 
	}
}

664 
	$u§ge
 (
¬gc
, *
¬gv
[])

666 
	`årštf
 (
¡d”r
, "lsh® v”siÚ " 
PACKAGE_VERSION
 "\n");

668 
	`årštf
 (
¡d”r
, "\n" "u§g: % [İtiÚs]\n", 
¬gv
[0]);

669 
	`årštf
 (
¡d”r
,

686 
	}
}

698 
	$maš
 (
¬gc
, *
¬gv
[])

700 
DBusE¼Ü
 
”rÜ
;

701 
dbus_boŞ_t
 
do_mÚ™Ü
 = 
FALSE
;

702 
GMašLoİ
 *
loİ
;

703 
DBusCÚÃùiÚ
 *
cÚn
;

705 ià(
¬gc
 == 1) {

707 
lÚg_li¡
 = 
TRUE
;

710 cÚ¡ 
İtiÚ
 
lÚg_İtiÚs
[] = {

711 {"mÚ™Ü", 
no_¬gum’t
, 
NULL
, 'm'},

712 {"lÚg", 
no_¬gum’t
, 
NULL
, 'l'},

713 {"shÜt", 
no_¬gum’t
, 
NULL
, 's'},

714 {"Œ“", 
no_¬gum’t
, 
NULL
, 't'},

715 {"show", 
»quœed_¬gum’t
, 
NULL
, 'u'},

716 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

717 {"u§ge", 
no_¬gum’t
, 
NULL
, 'U'},

718 {"v”siÚ", 
no_¬gum’t
, 
NULL
, 'V'},

719 {
NULL
, 0, NULL, 0}

723 
c
;

725 
c
 = 
	`g‘İt_lÚg
 (
¬gc
, 
¬gv
, "ml¡u:hUV", 
lÚg_İtiÚs
, 
NULL
);

727 ià(
c
 == -1) {

729 ià(!
do_mÚ™Ü
 && !
lÚg_li¡
 && !
shÜt_li¡
 && !
Œ“_v›w
 && !
show_deviû
) {

730 
	`u§ge
 (
¬gc
, 
¬gv
);

737 
c
) {

739 
do_mÚ™Ü
 = 
TRUE
;

743 
lÚg_li¡
 = 
TRUE
;

747 
shÜt_li¡
 = 
TRUE
;

748 
lÚg_li¡
 = 
FALSE
;

752 
Œ“_v›w
 = 
TRUE
;

756 ià(
	`¡rchr
(
İrg
, '/'è!ğ
NULL
)

757 
show_deviû
 = 
	`¡rdup
(
İrg
);

759 
show_deviû
 = 
	`m®loc
(
	`¡¾’
(
UDI_BASE
è+ sŒËn(
İrg
) + 1);

760 
	`memıy
(
show_deviû
, 
UDI_BASE
, 
	`¡¾’
(UDI_BASE));

761 
	`memıy
(
show_deviû
 + 
	`¡¾’
(
UDI_BASE
), 
İrg
, strlen(optarg) + 1);

768 
	`u§ge
 (
¬gc
, 
¬gv
);

772 
	`´štf
 ("lsh® v”siÚ " 
PACKAGE_VERSION
 "\n");

776 
	`u§ge
 (
¬gc
, 
¬gv
);

782 ià(
do_mÚ™Ü
)

783 
loİ
 = 
	`g_maš_loİ_Ãw
 (
NULL
, 
FALSE
);

785 
loİ
 = 
NULL
;

787 
	`dbus_”rÜ_š™
 (&
”rÜ
);

788 
cÚn
 = 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
);

789 ià(
cÚn
 =ğ
NULL
) {

790 
	`årštf
 (
¡d”r
, "error: dbus_bus_get: %s: %s\n",

791 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

792 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

796 ià(
do_mÚ™Ü
)

797 
	`dbus_cÚÃùiÚ_£tup_w™h_g_maš
 (
cÚn
, 
NULL
);

799 ià((
h®_ùx
 = 
	`libh®_ùx_Ãw
 ()è=ğ
NULL
) {

800 
	`årštf
 (
¡d”r
, "error:†ibhal_ctx_new\n");

803 ià(!
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
h®_ùx
, 
cÚn
)) {

804 
	`årštf
 (
¡d”r
, "error:†ibhal_ctx_set_dbus_connection: %s: %s\n",

805 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

808 ià(!
	`libh®_ùx_š™
 (
h®_ùx
, &
”rÜ
)) {

809 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

810 
	`årštf
 (
¡d”r
, "”rÜ:†ibh®_ùx_š™: %s: %s\n", 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

811 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

813 
	`årštf
 (
¡d”r
, "Could‚ot initialise connectiono hald.\n"

818 
	`libh®_ùx_£t_deviû_added
 (
h®_ùx
, 
deviû_added
);

819 
	`libh®_ùx_£t_deviû_»moved
 (
h®_ùx
, 
deviû_»moved
);

820 
	`libh®_ùx_£t_deviû_Ãw_ÿ·b™y
 (
h®_ùx
, 
deviû_Ãw_ÿ·b™y
);

821 
	`libh®_ùx_£t_deviû_lo¡_ÿ·b™y
 (
h®_ùx
, 
deviû_lo¡_ÿ·b™y
);

822 
	`libh®_ùx_£t_deviû_´İ”ty_modif›d
 (
h®_ùx
, 
´İ”ty_modif›d
);

823 
	`libh®_ùx_£t_deviû_cÚd™iÚ
 (
h®_ùx
, 
deviû_cÚd™iÚ
);

824 
	`libh®_ùx_£t_glob®_š‹rçû_lock_acquœed
 (
h®_ùx
, 
glob®_š‹rçû_lock_acquœed
);

825 
	`libh®_ùx_£t_glob®_š‹rçû_lock_»Ëa£d
 (
h®_ùx
, 
glob®_š‹rçû_lock_»Ëa£d
);

826 
	`libh®_ùx_£t_š‹rçû_lock_acquœed
 (
h®_ùx
, 
š‹rçû_lock_acquœed
);

827 
	`libh®_ùx_£t_š‹rçû_lock_»Ëa£d
 (
h®_ùx
, 
š‹rçû_lock_»Ëa£d
);

829 ià(
show_deviû
) {

830 
lÚg_li¡
 = 
TRUE
;

831 
	`dump_deviû
 (
show_deviû
);

833 ià(!
do_mÚ™Ü
)

834 
	`dump_deviûs
 ();

837 ià(
do_mÚ™Ü
 && 
loİ
 !ğ
NULL
) {

838 ifĞ
lÚg_li¡
 || 
shÜt_li¡
 || 
Œ“_v›w
 )

839 
	`dump_deviûs
 ();

841 iàĞ
	`libh®_deviû_´İ”ty_w©ch_®l
 (
h®_ùx
, &
”rÜ
è=ğ
FALSE
) {

842 
	`årštf
 (
¡d”r
, "error: monitoring devicelist -†ibhal_device_property_watch_all: %s: %s\n",

843 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

844 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

847 
	`´štf
 ("\nStart monitoring devicelist:\n"

849 
	`g_maš_loİ_run
 (
loİ
);

852 iàĞ
	`libh®_ùx_shutdown
 (
h®_ùx
, &
”rÜ
è=ğ
FALSE
)

853 
	`LIBHAL_FREE_DBUS_ERROR
 (&
”rÜ
);

854 
	`libh®_ùx_ä“
 (
h®_ùx
);

856 
	`dbus_cÚÃùiÚ_uÄef
 (
cÚn
);

858 ià(
show_deviû
)

859 
	`ä“
(
show_deviû
);

862 
	}
}

	@tools/umount-hal.c

25 #ifdeà
HAVE_CONFIG_H


26 
	~<cÚfig.h
>

29 
	~<¡dio.h
>

30 
	~<¡dlib.h
>

31 
	~<¡ršg.h
>

32 
	~<libh®.h
>

33 
	~<libh®-¡Üage.h
>

36 
	$maš
 (
¬gc
, *
¬gv
[])

38 
»t
;

39 *
deviû_fe_Ü_mouÁ_pošt
;

40 
DBusE¼Ü
 
”rÜ
;

41 
DBusCÚÃùiÚ
 *
cÚ
;

42 
LibH®CÚ‹xt
 *
h®_ùx
;

43 
LibH®VŞume
 *
vŞ
;

44 
DBusMes§ge
 *
mes§ge
;

45 
DBusMes§ge
 *
»¶y
;

46 
h®_»tcode
;

47 **
İtiÚs
 = 
NULL
;

48 
num_İtiÚs
 = 0;

50 
»t
 = 1;

52 ià(
¬gc
 < 2 || 
	`¡¾’
 (
¬gv
[1]) == 0) {

53 
	`årštf
 (
¡d”r
, "%s:hi ´og¿m i Úly suµo£dØbšvoked by umouÁ(8).\n", 
¬gv
[0]);

54 
out
;

61 
deviû_fe_Ü_mouÁ_pošt
 = 
¬gv
[1];

63 
	`dbus_”rÜ_š™
 (&
”rÜ
);

64 
cÚ
 = 
	`dbus_bus_g‘
 (
DBUS_BUS_SYSTEM
, &
”rÜ
);

65 ià(
cÚ
 =ğ
NULL
) {

66 
	`årštf
 (
¡d”r
, "%s: dbus_bus_g‘(): %s: %s\n", 
¬gv
[0], 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

67 
out
;

70 
h®_ùx
 = 
	`libh®_ùx_Ãw
 ();

71 
	`libh®_ùx_£t_dbus_cÚÃùiÚ
 (
h®_ùx
, 
cÚ
);

72 ià(!
	`libh®_ùx_š™
 (
h®_ùx
, &
”rÜ
)) {

73 ià(
	`dbus_”rÜ_is_£t
(&
”rÜ
)) {

74 
	`årštf
 (
¡d”r
, "%s:†ibh®_ùx_š™: %s: %s\n", 
¬gv
[0], 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

75 
	`dbus_”rÜ_ä“
 (&
”rÜ
);

77 
	`årštf
 (
¡d”r
, "%s:†ibh®_ùx_š™ faed. I h®d„uÂšg?\n", 
¬gv
[0]);

79 
out
;

82 
vŞ
 = 
	`libh®_vŞume_äom_deviû_fe
 (
h®_ùx
, 
deviû_fe_Ü_mouÁ_pošt
);

83 ià(
vŞ
 =ğ
NULL
) {

86 ià(
deviû_fe_Ü_mouÁ_pošt
[
	`¡¾’
 (device_file_or_mount_point) - 1] == '/') {

87 
deviû_fe_Ü_mouÁ_pošt
[
	`¡¾’
 (device_file_or_mount_point) - 1] = '\0';

89 
vŞ
 = 
	`libh®_vŞume_äom_mouÁ_pošt
 (
h®_ùx
, 
deviû_fe_Ü_mouÁ_pošt
);

90 ià(
vŞ
 =ğ
NULL
) {

91 
	`årštf
 (
¡d”r
, "%s: % i nÙ„ecognized by h®\n", 
¬gv
[0], 
deviû_fe_Ü_mouÁ_pošt
);

92 
out
;

96 
mes§ge
 = 
	`dbus_mes§ge_Ãw_m‘hod_ÿÎ
 ("org.freedesktop.Hal",

97 
	`libh®_vŞume_g‘_udi
 (
vŞ
),

100 ià(
mes§ge
 =ğ
NULL
) {

101 
out
;

104 ià(!
	`dbus_mes§ge_­³nd_¬gs
 (
mes§ge
,

105 
DBUS_TYPE_ARRAY
, 
DBUS_TYPE_STRING
, &
İtiÚs
, 
num_İtiÚs
,

106 
DBUS_TYPE_INVALID
)) {

107 
out
;

111 ià(!(
»¶y
 = 
	`dbus_cÚÃùiÚ_£nd_w™h_»¶y_ªd_block
 (
cÚ
,

112 
mes§ge
,

114 &
”rÜ
)è|| 
	`dbus_”rÜ_is_£t
 (&error)) {

115 
	`årštf
 (
¡d”r
, "%s: Unmounting %s failed: %s: %s\n",

116 
¬gv
[0], 
deviû_fe_Ü_mouÁ_pošt
, 
”rÜ
.
Çme
,ƒ¼Ü.
mes§ge
);

117 
out
;

120 ià(!
	`dbus_mes§ge_g‘_¬gs
 (
»¶y
,

121 &
”rÜ
,

122 
DBUS_TYPE_INT32
, &
h®_»tcode
,

123 
DBUS_TYPE_INVALID
)) {

125 
out
;

128 ià(
h®_»tcode
 != 0) {

130 
out
;

133 
»t
 = 0;

135 
out
:

136  
»t
;

137 
	}
}

	@/usr/include/asm/byteorder.h

1 #iâdeà
_ASM_X86_BYTEORDER_H


2 
	#_ASM_X86_BYTEORDER_H


	)

4 
	~<asm/ty³s.h
>

7 #ifdeà
__GNUC__


9 #ifdeà
__i386__


11 
šlše
 
__u32
 
	$___¬ch__swab32
(
__u32
 
x
)

13 #ifdeà
CONFIG_X86_BSWAP


14 
	`asm
("bsw­ %0" : "ô" (
x
) : "0" (x));

16 
	`asm
("xchgb %b0,%h0\n\t"

19 : "=q" (
x
)

20 : "0" (
x
));

22  
x
;

23 
	}
}

25 
šlše
 
__u64
 
	$___¬ch__swab64
(
__u64
 
v®
)

29 
__u32
 
a
;

30 
__u32
 
b
;

31 } 
s
;

32 
__u64
 
u
;

33 } 
v
;

34 
v
.
u
 = 
v®
;

35 #ifdeà
CONFIG_X86_BSWAP


36 
	`asm
("bswapl %0 ; bswapl %1 ; xchgl %0,%1"

37 : "ô" (
v
.
s
.
a
), "ô" (v.s.
b
)

38 : "0" (
v
.
s
.
a
), "1" (v.s.
b
));

40 
v
.
s
.
a
 = 
	`___¬ch__swab32
(v.s.a);

41 
v
.
s
.
b
 = 
	`___¬ch__swab32
(v.s.b);

42 
	`asm
("xchgl %0,%1"

43 : "ô" (
v
.
s
.
a
), "ô" (v.s.
b
)

44 : "0" (
v
.
s
.
a
), "1" (v.s.
b
));

46  
v
.
u
;

47 
	}
}

51 
šlše
 
__u64
 
	$___¬ch__swab64
(
__u64
 
x
)

53 
	`asm
("bswapq %0"

54 : "ô" (
x
)

55 : "0" (
x
));

56  
x
;

57 
	}
}

59 
šlše
 
__u32
 
	$___¬ch__swab32
(
__u32
 
x
)

61 
	`asm
("bswapl %0"

62 : "ô" (
x
)

63 : "0" (
x
));

64  
x
;

65 
	}
}

72 
	#__¬ch__swab64
(
x
è
	`___¬ch__swab64
(x)

	)

73 
	#__¬ch__swab32
(
x
è
	`___¬ch__swab32
(x)

	)

75 
	#__BYTEORDER_HAS_U64__


	)

79 
	~<lšux/by‹Üd”/l™e_’dŸn.h
>

	@/usr/include/asm/types.h

1 #iâdeà
_ASM_X86_TYPES_H


2 
	#_ASM_X86_TYPES_H


	)

4 
	~<asm-g’”ic/št-Î64.h
>

6 #iâdeà
__ASSEMBLY__


8 
	tumode_t
;

	@/usr/include/assert.h

24 #ifdef 
_ASSERT_H


26 #undeà
_ASSERT_H


27 #undeà
as£¹


28 #undeà
__ASSERT_VOID_CAST


30 #ifdef 
__USE_GNU


31 #undeà
as£¹_³¼Ü


36 
	#_ASSERT_H
 1

	)

37 
	~<ã©u»s.h
>

39 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

40 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

42 
	#__ASSERT_VOID_CAST
 ()

	)

50 #ifdef 
NDEBUG


52 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

60 #ifdef 
__USE_GNU


61 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

66 #iâdeà
_ASSERT_H_DECLS


67 
	#_ASSERT_H_DECLS


	)

68 
__BEGIN_DECLS


71 
	$__as£¹_ç
 (
__cÚ¡
 *
__as£¹iÚ
, __cÚ¡ *
__fe
,

72 
__lše
, 
__cÚ¡
 *
__funùiÚ
)

73 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

76 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, 
__cÚ¡
 *
__fe
,

77 
__lše
,

78 
__cÚ¡
 *
__funùiÚ
)

79 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

84 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

85 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

88 
__END_DECLS


91 
	#as£¹
(
ex´
) \

92 ((
ex´
) \

93 ? 
	`__ASSERT_VOID_CAST
 (0) \

94 : 
	`__as£¹_ç
 (
	`__STRING
(
ex´
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

96 #ifdef 
__USE_GNU


97 
	#as£¹_³¼Ü
(
”ºum
) \

98 (!(
”ºum
) \

99 ? 
	`__ASSERT_VOID_CAST
 (0) \

100 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

108 #ià
defšed
 
__ılu¥lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

109 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

111 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

112 
	#__ASSERT_FUNCTION
 
__func__


	)

114 
	#__ASSERT_FUNCTION
 ((
__cÚ¡
 *è0)

	)

	@/usr/include/ctype.h

24 #iâdef 
_CTYPE_H


25 
	#_CTYPE_H
 1

	)

27 
	~<ã©u»s.h
>

28 
	~<b™s/ty³s.h
>

30 
	g__BEGIN_DECLS


32 #iâdeà
_ISb™


41 
	~<’dŸn.h
>

42 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


43 
	#_ISb™
(
b™
è(1 << (b™))

	)

45 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

50 
	m_ISuµ”
 = 
_ISb™
 (0),

51 
	m_ISlow”
 = 
_ISb™
 (1),

52 
	m_IS®pha
 = 
_ISb™
 (2),

53 
	m_ISdig™
 = 
_ISb™
 (3),

54 
	m_ISxdig™
 = 
_ISb™
 (4),

55 
	m_IS¥aû
 = 
_ISb™
 (5),

56 
	m_IS´št
 = 
_ISb™
 (6),

57 
	m_ISg¿ph
 = 
_ISb™
 (7),

58 
	m_ISbÏnk
 = 
_ISb™
 (8),

59 
	m_ISúŒl
 = 
_ISb™
 (9),

60 
	m_ISpunù
 = 
_ISb™
 (10),

61 
	m_IS®num
 = 
_ISb™
 (11)

81 
__cÚ¡
 **
	$__ùy³_b_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡
));

83 
__cÚ¡
 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡
));

85 
__cÚ¡
 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

86 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡
));

88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

91 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

92 
	#__tßscii
(
c
è((cè& 0x7fè

	)

94 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

96 
__BEGIN_NAMESPACE_STD


102 
	`__exùy³
 (
i§Êum
);

103 
	`__exùy³
 (
i§Íha
);

104 
	`__exùy³
 (
isúŒl
);

105 
	`__exùy³
 (
isdig™
);

106 
	`__exùy³
 (
i¦ow”
);

107 
	`__exùy³
 (
isg¿ph
);

108 
	`__exùy³
 (
i¥ršt
);

109 
	`__exùy³
 (
i¥unù
);

110 
	`__exùy³
 (
is¥aû
);

111 
	`__exùy³
 (
isuµ”
);

112 
	`__exùy³
 (
isxdig™
);

116 
	$tŞow”
 (
__c
è
__THROW
;

119 
	$touµ”
 (
__c
è
__THROW
;

121 
__END_NAMESPACE_STD


125 #ifdef 
__USE_ISOC99


126 
__BEGIN_NAMESPACE_C99


128 
	`__exùy³
 (
isbÏnk
);

130 
__END_NAMESPACE_C99


133 #ifdeà
__USE_GNU


135 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

138 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


142 
	$i§scii
 (
__c
è
__THROW
;

146 
	$tßscii
 (
__c
è
__THROW
;

150 
	`__exùy³
 (
_touµ”
);

151 
	`__exùy³
 (
_tŞow”
);

155 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

156 (
__ex‹nsiÚ__
 \

157 ({ 
__»s
; \

158 ià( (
c
) > 1) \

160 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

162 
__c
 = (
c
); \

163 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

166 
__»s
 = 
f
 
¬gs
; \

169 
__»s
 = (
a
)[(è(
c
)]; \

170 
__»s
; 
	}
}))

	)

172 #ià!
defšed
 
__NO_CTYPE
 && !defšed 
__ılu¥lus


173 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

174 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

175 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

176 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

177 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

178 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

179 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

180 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

181 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

182 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

183 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

185 #ifdeà
__USE_ISOC99


186 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

189 #ifdeà
__USE_EXTERN_INLINES


190 
__ex‹º_šlše
 

191 
__NTH
 (
	$tŞow”
 (
__c
))

193  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

194 
	}
}

196 
__ex‹º_šlše
 

197 
__NTH
 (
	$touµ”
 (
__c
))

199  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

200 
	}
}

203 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


204 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

205 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

208 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


209 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

210 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

212 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

213 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

219 #ifdeà
__USE_GNU


233 
	~<xloÿË.h
>

237 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

238 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

240 
	#__exùy³_l
(
Çme
) \

241 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

247 
__exùy³_l
 (
i§Êum_l
);

248 
__exùy³_l
 (
i§Íha_l
);

249 
__exùy³_l
 (
isúŒl_l
);

250 
__exùy³_l
 (
isdig™_l
);

251 
__exùy³_l
 (
i¦ow”_l
);

252 
__exùy³_l
 (
isg¿ph_l
);

253 
__exùy³_l
 (
i¥ršt_l
);

254 
__exùy³_l
 (
i¥unù_l
);

255 
__exùy³_l
 (
is¥aû_l
);

256 
__exùy³_l
 (
isuµ”_l
);

257 
__exùy³_l
 (
isxdig™_l
);

259 
__exùy³_l
 (
isbÏnk_l
);

263 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

264 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

267 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

268 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

270 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


271 
	#__tŞow”_l
(
c
, 
loÿË
) \

272 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

273 
	#__touµ”_l
(
c
, 
loÿË
) \

274 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

275 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

276 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

280 #iâdeà
__NO_CTYPE


281 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

282 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

283 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

284 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

285 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

286 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

287 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

288 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

289 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

290 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

291 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

293 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

295 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


296 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

297 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

300 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

301 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

302 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

303 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

304 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

305 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

306 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

307 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

308 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

309 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

310 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

312 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

314 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


315 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

316 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

323 
__END_DECLS


	@/usr/include/dirent.h

23 #iâdef 
_DIRENT_H


24 
	#_DIRENT_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


30 
	~<b™s/ty³s.h
>

32 #ifdeà
__USE_XOPEN


33 #iâdeà
__šo_t_defšed


34 #iâdeà
__USE_FILE_OFFSET64


35 
__šo_t
 
	tšo_t
;

37 
__šo64_t
 
	tšo_t
;

39 
	#__šo_t_defšed


	)

41 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


42 
__šo64_t
 
	tšo64_t
;

43 
	#__šo64_t_defšed


	)

62 
	~<b™s/dœ’t.h
>

64 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
è&& !defšed 
d_f’o


65 
	#d_šo
 
d_f’o


	)

82 #ifdeà
_DIRENT_HAVE_D_NAMLEN


83 
	#_D_EXACT_NAMLEN
(
d
è((d)->
d_ÇmËn
)

	)

84 
	#_D_ALLOC_NAMLEN
(
d
è(
	`_D_EXACT_NAMLEN
 (dè+ 1)

	)

86 
	#_D_EXACT_NAMLEN
(
d
è(
	`¡¾’
 ((d)->
d_Çme
))

	)

87 #ifdeà
_DIRENT_HAVE_D_RECLEN


88 
	#_D_ALLOC_NAMLEN
(
d
è(((*è(dè+ (d)->
d_»ş’
è- &(d)->
d_Çme
[0])

	)

90 
	#_D_ALLOC_NAMLEN
(
d
è( (d)->
d_Çme
 > 1 ?  (d)->d_name : \

91 
	`_D_EXACT_NAMLEN
 (
d
è+ 1)

	)

96 #ifdeà
__USE_BSD


100 
	mDT_UNKNOWN
 = 0,

101 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

102 
	mDT_FIFO
 = 1,

103 
	#DT_FIFO
 
DT_FIFO


	)

104 
	mDT_CHR
 = 2,

105 
	#DT_CHR
 
DT_CHR


	)

106 
	mDT_DIR
 = 4,

107 
	#DT_DIR
 
DT_DIR


	)

108 
	mDT_BLK
 = 6,

109 
	#DT_BLK
 
DT_BLK


	)

110 
	mDT_REG
 = 8,

111 
	#DT_REG
 
DT_REG


	)

112 
	mDT_LNK
 = 10,

113 
	#DT_LNK
 
DT_LNK


	)

114 
	mDT_SOCK
 = 12,

115 
	#DT_SOCK
 
DT_SOCK


	)

116 
	mDT_WHT
 = 14

117 
	#DT_WHT
 
DT_WHT


	)

121 
	#IFTODT
(
mode
è(((modeè& 0170000è>> 12)

	)

122 
	#DTTOIF
(
dœty³
è((dœty³è<< 12)

	)

128 
__dœ¡»am
 
	tDIR
;

135 
DIR
 *
	$İ’dœ
 (
__cÚ¡
 *
__Çme
è
	`__nÚnuÎ
 ((1));

137 #ifdeà
__USE_GNU


142 
DIR
 *
	`fdİ’dœ
 (
__fd
);

150 
	$şo£dœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

162 #iâdeà
__USE_FILE_OFFSET64


163 
dœ’t
 *
	$»addœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

165 #ifdeà
__REDIRECT


166 
dœ’t
 *
	`__REDIRECT
 (
»addœ
, (
DIR
 *
__dœp
), 
»addœ64
)

167 
	`__nÚnuÎ
 ((1));

169 
	#»addœ
 
»addœ64


	)

173 #ifdeà
__USE_LARGEFILE64


174 
dœ’t64
 *
	$»addœ64
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

177 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


183 #iâdeà
__USE_FILE_OFFSET64


184 
	$»addœ_r
 (
DIR
 *
__»¡riù
 
__dœp
,

185 
dœ’t
 *
__»¡riù
 
__’Œy
,

186 
dœ’t
 **
__»¡riù
 
__»suÉ
)

187 
	`__nÚnuÎ
 ((1, 2, 3));

189 #ifdeà
__REDIRECT


190 
	`__REDIRECT
 (
»addœ_r
,

191 (
DIR
 *
__»¡riù
 
__dœp
,

192 
dœ’t
 *
__»¡riù
 
__’Œy
,

193 
dœ’t
 **
__»¡riù
 
__»suÉ
),

194 
»addœ64_r
è
	`__nÚnuÎ
 ((1, 2, 3));

196 
	#»addœ_r
 
»addœ64_r


	)

200 #ifdeà
__USE_LARGEFILE64


201 
	$»addœ64_r
 (
DIR
 *
__»¡riù
 
__dœp
,

202 
dœ’t64
 *
__»¡riù
 
__’Œy
,

203 
dœ’t64
 **
__»¡riù
 
__»suÉ
)

204 
	`__nÚnuÎ
 ((1, 2, 3));

209 
	$»wšddœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

211 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


212 
	~<b™s/ty³s.h
>

215 
	$£ekdœ
 (
DIR
 *
__dœp
, 
__pos
è
__THROW
 
	`__nÚnuÎ
 ((1));

218 
	$‹Îdœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

221 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC


224 
	$dœfd
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

226 #ià
defšed
 
__OPTIMIZE__
 && defšed 
_DIR_dœfd


227 
	#dœfd
(
dœp
è
	`_DIR_dœfd
 (dœp)

	)

230 #iâdeà
MAXNAMLEN


232 
	~<b™s/posix1_lim.h
>

235 #ifdeà
NAME_MAX


236 
	#MAXNAMLEN
 
NAME_MAX


	)

238 
	#MAXNAMLEN
 255

	)

242 
	#__Ãed_size_t


	)

243 
	~<¡ddef.h
>

249 #iâdeà
__USE_FILE_OFFSET64


250 
	`sÿndœ
 (
__cÚ¡
 *
__»¡riù
 
__dœ
,

251 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

252 (*
__£ËùÜ
è(
__cÚ¡
 
dœ’t
 *),

253 (*
__cmp
è(
__cÚ¡
 *, __const *))

254 
	`__nÚnuÎ
 ((1, 2));

256 #ifdeà
__REDIRECT


257 
	`__REDIRECT
 (
sÿndœ
,

258 (
__cÚ¡
 *
__»¡riù
 
__dœ
,

259 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

260 (*
__£ËùÜ
è(
__cÚ¡
 
dœ’t
 *),

261 (*
__cmp
è(
__cÚ¡
 *, __const *)),

262 
sÿndœ64
è
	`__nÚnuÎ
 ((1, 2));

264 
	#sÿndœ
 
sÿndœ64


	)

268 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


271 
	`sÿndœ64
 (
__cÚ¡
 *
__»¡riù
 
__dœ
,

272 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

273 (*
__£ËùÜ
è(
__cÚ¡
 
dœ’t64
 *),

274 (*
__cmp
è(
__cÚ¡
 *, __const *))

275 
	`__nÚnuÎ
 ((1, 2));

279 #iâdeà
__USE_FILE_OFFSET64


280 
	$®phasÜt
 (
__cÚ¡
 *
__e1
, __cÚ¡ *
__e2
)

281 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

283 #ifdeà
__REDIRECT


284 
	`__REDIRECT_NTH
 (
®phasÜt
,

285 (
__cÚ¡
 *
__e1
, __cÚ¡ *
__e2
),

286 
®phasÜt64
è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

288 
	#®phasÜt
 
®phasÜt64


	)

292 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


293 
	$®phasÜt64
 (
__cÚ¡
 *
__e1
, __cÚ¡ *
__e2
)

294 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

297 #ifdeà
__USE_GNU


299 #iâdeà
__USE_FILE_OFFSET64


300 
	$v”siÚsÜt
 (
__cÚ¡
 *
__e1
, __cÚ¡ *
__e2
)

301 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

303 #ifdeà
__REDIRECT


304 
	`__REDIRECT_NTH
 (
v”siÚsÜt
,

305 (
__cÚ¡
 *
__e1
, __cÚ¡ *
__e2
),

306 
v”siÚsÜt64
)

307 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

309 
	#v”siÚsÜt
 
v”siÚsÜt64


	)

313 #ifdeà
__USE_LARGEFILE64


314 
	$v”siÚsÜt64
 (
__cÚ¡
 *
__e1
, __cÚ¡ *
__e2
)

315 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

323 #iâdeà
__USE_FILE_OFFSET64


324 
__ssize_t
 
	$g‘dœ’Œ›s
 (
__fd
, *
__»¡riù
 
__buf
,

325 
size_t
 
__nby‹s
,

326 
__off_t
 *
__»¡riù
 
__ba£p
)

327 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

329 #ifdeà
__REDIRECT


330 
__ssize_t
 
	`__REDIRECT_NTH
 (
g‘dœ’Œ›s
,

331 (
__fd
, *
__»¡riù
 
__buf
,

332 
size_t
 
__nby‹s
,

333 
__off64_t
 *
__»¡riù
 
__ba£p
),

334 
g‘dœ’Œ›s64
è
	`__nÚnuÎ
 ((2, 4));

336 
	#g‘dœ’Œ›s
 
g‘dœ’Œ›s64


	)

340 #ifdeà
__USE_LARGEFILE64


341 
__ssize_t
 
	$g‘dœ’Œ›s64
 (
__fd
, *
__»¡riù
 
__buf
,

342 
size_t
 
__nby‹s
,

343 
__off64_t
 *
__»¡riù
 
__ba£p
)

344 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

349 
__END_DECLS


	@/usr/include/errno.h

23 #iâdef 
_ERRNO_H


27 #iâdef 
__Ãed_Em©h


28 
	#_ERRNO_H
 1

	)

29 
	~<ã©u»s.h
>

32 
	g__BEGIN_DECLS


36 
	~<b™s/”ºo.h
>

37 #undeà
__Ãed_Em©h


39 #ifdef 
_ERRNO_H


46 #iâdef 
”ºo


47 
”ºo
;

50 #ifdeà
__USE_GNU


55 *
´og¿m_švoÿtiÚ_Çme
, *
´og¿m_švoÿtiÚ_shÜt_Çme
;

59 
	g__END_DECLS


67 #ià
defšed
 
__USE_GNU
 || defšed 
__Ãed_”rÜ_t


68 #iâdeà
__”rÜ_t_defšed


69 
	t”rÜ_t
;

70 
	#__”rÜ_t_defšed
 1

	)

72 #undeà
__Ãed_”rÜ_t


	@/usr/include/error.h

20 #iâdeà
_ERROR_H


21 
	#_ERROR_H
 1

	)

23 
	~<ã©u»s.h
>

26 
__BEGIN_DECLS


32 
	$”rÜ
 (
__¡©us
, 
__”ºum
, 
__cÚ¡
 *
__fÜm©
, ...)

33 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

35 
	$”rÜ_©_lše
 (
__¡©us
, 
__”ºum
, 
__cÚ¡
 *
__âame
,

36 
__lš’o
, 
__cÚ¡
 *
__fÜm©
, ...)

37 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 5, 6)));

42 (*
”rÜ_´št_´ogÇme
) ();

45 
”rÜ_mes§ge_couÁ
;

49 
”rÜ_Úe_³r_lše
;

52 #ià
defšed
 
__ex‹º_®ways_šlše
 && defšed 
__va_¬g_·ck


53 
	~<b™s/”rÜ.h
>

56 
__END_DECLS


	@/usr/include/expat.h

5 #iâdeà
Ex·t_INCLUDED


6 
	#Ex·t_INCLUDED
 1

	)

8 #ifdeà
__VMS


11 
	#XML_S‘ProûssšgIn¡ruùiÚHªdËr
 
XML_S‘ProûssšgIn¡rHªdËr


	)

12 
	#XML_S‘UÅ¬£dEÁ™yDeşHªdËr
 
XML_S‘UÅ¬£dEÁDeşHªdËr


	)

13 
	#XML_S‘S¹Name¥aûDeşHªdËr
 
XML_S‘S¹Name¥cDeşHªdËr


	)

14 
	#XML_S‘Ex‹º®EÁ™yRefHªdËrArg
 
XML_S‘Ex‹º®EÁRefHªdËrArg


	)

17 
	~<¡dlib.h
>

18 
	~"ex·t_ex‹º®.h
"

20 #ifdeà
__ılu¥lus


24 
XML_P¬£rSŒuù
;

25 
XML_P¬£rSŒuù
 *
	tXML_P¬£r
;

28 
	tXML_BoŞ
;

29 
	#XML_TRUE
 ((
XML_BoŞ
è1)

	)

30 
	#XML_FALSE
 ((
XML_BoŞ
è0)

	)

45 
	eXML_Stus
 {

46 
XML_STATUS_ERROR
 = 0,

47 
	#XML_STATUS_ERROR
 
XML_STATUS_ERROR


	)

48 
XML_STATUS_OK
 = 1,

49 
	#XML_STATUS_OK
 
XML_STATUS_OK


	)

50 
XML_STATUS_SUSPENDED
 = 2

51 
	#XML_STATUS_SUSPENDED
 
XML_STATUS_SUSPENDED


	)

54 
	eXML_E¼Ü
 {

55 
XML_ERROR_NONE
,

56 
XML_ERROR_NO_MEMORY
,

57 
XML_ERROR_SYNTAX
,

58 
XML_ERROR_NO_ELEMENTS
,

59 
XML_ERROR_INVALID_TOKEN
,

60 
XML_ERROR_UNCLOSED_TOKEN
,

61 
XML_ERROR_PARTIAL_CHAR
,

62 
XML_ERROR_TAG_MISMATCH
,

63 
XML_ERROR_DUPLICATE_ATTRIBUTE
,

64 
XML_ERROR_JUNK_AFTER_DOC_ELEMENT
,

65 
XML_ERROR_PARAM_ENTITY_REF
,

66 
XML_ERROR_UNDEFINED_ENTITY
,

67 
XML_ERROR_RECURSIVE_ENTITY_REF
,

68 
XML_ERROR_ASYNC_ENTITY
,

69 
XML_ERROR_BAD_CHAR_REF
,

70 
XML_ERROR_BINARY_ENTITY_REF
,

71 
XML_ERROR_ATTRIBUTE_EXTERNAL_ENTITY_REF
,

72 
XML_ERROR_MISPLACED_XML_PI
,

73 
XML_ERROR_UNKNOWN_ENCODING
,

74 
XML_ERROR_INCORRECT_ENCODING
,

75 
XML_ERROR_UNCLOSED_CDATA_SECTION
,

76 
XML_ERROR_EXTERNAL_ENTITY_HANDLING
,

77 
XML_ERROR_NOT_STANDALONE
,

78 
XML_ERROR_UNEXPECTED_STATE
,

79 
XML_ERROR_ENTITY_DECLARED_IN_PE
,

80 
XML_ERROR_FEATURE_REQUIRES_XML_DTD
,

81 
XML_ERROR_CANT_CHANGE_FEATURE_ONCE_PARSING
,

83 
XML_ERROR_UNBOUND_PREFIX
,

85 
XML_ERROR_UNDECLARING_PREFIX
,

86 
XML_ERROR_INCOMPLETE_PE
,

87 
XML_ERROR_XML_DECL
,

88 
XML_ERROR_TEXT_DECL
,

89 
XML_ERROR_PUBLICID
,

90 
XML_ERROR_SUSPENDED
,

91 
XML_ERROR_NOT_SUSPENDED
,

92 
XML_ERROR_ABORTED
,

93 
XML_ERROR_FINISHED
,

94 
XML_ERROR_SUSPEND_PE
,

96 
XML_ERROR_RESERVED_PREFIX_XML
,

97 
XML_ERROR_RESERVED_PREFIX_XMLNS
,

98 
XML_ERROR_RESERVED_NAMESPACE_URI


101 
	eXML_CÚ‹Á_Ty³
 {

102 
XML_CTYPE_EMPTY
 = 1,

103 
XML_CTYPE_ANY
,

104 
XML_CTYPE_MIXED
,

105 
XML_CTYPE_NAME
,

106 
XML_CTYPE_CHOICE
,

107 
XML_CTYPE_SEQ


110 
	eXML_CÚ‹Á_Quªt
 {

111 
XML_CQUANT_NONE
,

112 
XML_CQUANT_OPT
,

113 
XML_CQUANT_REP
,

114 
XML_CQUANT_PLUS


135 
XML_ı
 
	tXML_CÚ‹Á
;

137 
	sXML_ı
 {

138 
XML_CÚ‹Á_Ty³
 
ty³
;

139 
XML_CÚ‹Á_Quªt
 
quªt
;

140 
XML_Ch¬
 * 
Çme
;

141 
numchd»n
;

142 
XML_CÚ‹Á
 * 
chd»n
;

150 (
XMLCALL
 *
	tXML_EËm’tDeşHªdËr
è(*
	tu£rD©a
,

151 cÚ¡ 
	tXML_Ch¬
 *
	tÇme
,

152 
	tXML_CÚ‹Á
 *
	tmod–
);

154 
XMLPARSEAPI
()

155 
XML_S‘EËm’tDeşHªdËr
(
XML_P¬£r
 
·r£r
,

156 
XML_EËm’tDeşHªdËr
 
–deş
);

166 (
XMLCALL
 *
	tXML_A‰li¡DeşHªdËr
) (

167 *
	tu£rD©a
,

168 cÚ¡ 
	tXML_Ch¬
 *
	t–Çme
,

169 cÚ¡ 
	tXML_Ch¬
 *
	t©Šame
,

170 cÚ¡ 
	tXML_Ch¬
 *
	t©t_ty³
,

171 cÚ¡ 
	tXML_Ch¬
 *
	tdæt
,

172 
	ti¤equœed
);

174 
XMLPARSEAPI
()

175 
XML_S‘A‰li¡DeşHªdËr
(
XML_P¬£r
 
·r£r
,

176 
XML_A‰li¡DeşHªdËr
 
©tdeş
);

186 (
XMLCALL
 *
	tXML_XmlDeşHªdËr
è(*
	tu£rD©a
,

187 cÚ¡ 
	tXML_Ch¬
 *
	tv”siÚ
,

188 cÚ¡ 
	tXML_Ch¬
 *
	t’codšg
,

189 
	t¡ªd®Úe
);

191 
XMLPARSEAPI
()

192 
XML_S‘XmlDeşHªdËr
(
XML_P¬£r
 
·r£r
,

193 
XML_XmlDeşHªdËr
 
xmldeş
);

197 *(*
m®loc_fú
)(
size_t
 
size
);

198 *(*
»®loc_fú
)(*
±r
, 
size_t
 
size
);

199 (*
ä“_fú
)(*
±r
);

200 } 
	tXML_MemÜy_Hªdlšg_Su™e
;

205 
XMLPARSEAPI
(
XML_P¬£r
)

206 
XML_P¬£rC»©e
(cÚ¡ 
XML_Ch¬
 *
’codšg
);

219 
XMLPARSEAPI
(
XML_P¬£r
)

220 
XML_P¬£rC»©eNS
(cÚ¡ 
XML_Ch¬
 *
’codšg
, XML_Ch¬ 
Çme¥aûS•¬©Ü
);

232 
XMLPARSEAPI
(
XML_P¬£r
)

233 
XML_P¬£rC»©e_MM
(cÚ¡ 
XML_Ch¬
 *
’codšg
,

234 cÚ¡ 
XML_MemÜy_Hªdlšg_Su™e
 *
memsu™e
,

235 cÚ¡ 
XML_Ch¬
 *
Çme¥aûS•¬©Ü
);

246 
XMLPARSEAPI
(
XML_BoŞ
)

247 
XML_P¬£rRe£t
(
XML_P¬£r
 
·r£r
, cÚ¡ 
XML_Ch¬
 *
’codšg
);

252 (
XMLCALL
 *
	tXML_S¹EËm’tHªdËr
è(*
	tu£rD©a
,

253 cÚ¡ 
	tXML_Ch¬
 *
	tÇme
,

254 cÚ¡ 
	tXML_Ch¬
 **
	t©ts
);

256 (
XMLCALL
 *
	tXML_EndEËm’tHªdËr
è(*
	tu£rD©a
,

257 cÚ¡ 
	tXML_Ch¬
 *
	tÇme
);

261 (
XMLCALL
 *
	tXML_Ch¬aù”D©aHªdËr
è(*
	tu£rD©a
,

262 cÚ¡ 
	tXML_Ch¬
 *
	ts
,

263 
	tËn
);

266 (
XMLCALL
 *
	tXML_ProûssšgIn¡ruùiÚHªdËr
) (

267 *
	tu£rD©a
,

268 cÚ¡ 
	tXML_Ch¬
 *
	trg‘
,

269 cÚ¡ 
	tXML_Ch¬
 *
	td©a
);

272 (
XMLCALL
 *
	tXML_Comm’tHªdËr
è(*
	tu£rD©a
,

273 cÚ¡ 
	tXML_Ch¬
 *
	td©a
);

275 (
XMLCALL
 *
	tXML_S¹Cd©aSeùiÚHªdËr
è(*
	tu£rD©a
);

276 (
XMLCALL
 *
	tXML_EndCd©aSeùiÚHªdËr
è(*
	tu£rD©a
);

291 (
XMLCALL
 *
	tXML_DeçuÉHªdËr
è(*
	tu£rD©a
,

292 cÚ¡ 
	tXML_Ch¬
 *
	ts
,

293 
	tËn
);

298 (
XMLCALL
 *
	tXML_S¹Doùy³DeşHªdËr
) (

299 *
	tu£rD©a
,

300 cÚ¡ 
	tXML_Ch¬
 *
	tdoùy³Name
,

301 cÚ¡ 
	tXML_Ch¬
 *
	tsysid
,

302 cÚ¡ 
	tXML_Ch¬
 *
	tpubid
,

303 
	thas_š‹º®_sub£t
);

309 (
XMLCALL
 *
	tXML_EndDoùy³DeşHªdËr
)(*
	tu£rD©a
);

329 (
XMLCALL
 *
	tXML_EÁ™yDeşHªdËr
) (

330 *
	tu£rD©a
,

331 cÚ¡ 
	tXML_Ch¬
 *
	t’t™yName
,

332 
	tis_·¿m‘”_’t™y
,

333 cÚ¡ 
	tXML_Ch¬
 *
	tv®ue
,

334 
	tv®ue_Ëngth
,

335 cÚ¡ 
	tXML_Ch¬
 *
	tba£
,

336 cÚ¡ 
	tXML_Ch¬
 *
	tsy¡emId
,

337 cÚ¡ 
	tXML_Ch¬
 *
	tpublicId
,

338 cÚ¡ 
	tXML_Ch¬
 *
	tnÙ©iÚName
);

340 
XMLPARSEAPI
()

341 
XML_S‘EÁ™yDeşHªdËr
(
XML_P¬£r
 
·r£r
,

342 
XML_EÁ™yDeşHªdËr
 
hªdËr
);

353 (
XMLCALL
 *
	tXML_UÅ¬£dEÁ™yDeşHªdËr
) (

354 *
	tu£rD©a
,

355 cÚ¡ 
	tXML_Ch¬
 *
	t’t™yName
,

356 cÚ¡ 
	tXML_Ch¬
 *
	tba£
,

357 cÚ¡ 
	tXML_Ch¬
 *
	tsy¡emId
,

358 cÚ¡ 
	tXML_Ch¬
 *
	tpublicId
,

359 cÚ¡ 
	tXML_Ch¬
 *
	tnÙ©iÚName
);

365 (
XMLCALL
 *
	tXML_NÙ©iÚDeşHªdËr
) (

366 *
	tu£rD©a
,

367 cÚ¡ 
	tXML_Ch¬
 *
	tnÙ©iÚName
,

368 cÚ¡ 
	tXML_Ch¬
 *
	tba£
,

369 cÚ¡ 
	tXML_Ch¬
 *
	tsy¡emId
,

370 cÚ¡ 
	tXML_Ch¬
 *
	tpublicId
);

378 (
XMLCALL
 *
	tXML_S¹Name¥aûDeşHªdËr
) (

379 *
	tu£rD©a
,

380 cÚ¡ 
	tXML_Ch¬
 *
	t´efix
,

381 cÚ¡ 
	tXML_Ch¬
 *
	turi
);

383 (
XMLCALL
 *
	tXML_EndName¥aûDeşHªdËr
) (

384 *
	tu£rD©a
,

385 cÚ¡ 
	tXML_Ch¬
 *
	t´efix
);

396 (
XMLCALL
 *
	tXML_NÙSnd®ÚeHªdËr
è(*
	tu£rD©a
);

432 (
XMLCALL
 *
	tXML_Ex‹º®EÁ™yRefHªdËr
) (

433 
	tXML_P¬£r
 
	t·r£r
,

434 cÚ¡ 
	tXML_Ch¬
 *
	tcÚ‹xt
,

435 cÚ¡ 
	tXML_Ch¬
 *
	tba£
,

436 cÚ¡ 
	tXML_Ch¬
 *
	tsy¡emId
,

437 cÚ¡ 
	tXML_Ch¬
 *
	tpublicId
);

449 (
XMLCALL
 *
	tXML_Sk³dEÁ™yHªdËr
) (

450 *
	tu£rD©a
,

451 cÚ¡ 
	tXML_Ch¬
 *
	t’t™yName
,

452 
	tis_·¿m‘”_’t™y
);

507 
m­
[256];

508 *
d©a
;

509 (
XMLCALL
 *
cÚv”t
)(*
d©a
, cÚ¡ *
s
);

510 (
XMLCALL
 *
»Ëa£
)(*
d©a
);

511 } 
	tXML_Encodšg
;

528 (
XMLCALL
 *
	tXML_UnknownEncodšgHªdËr
) (

529 *
	t’codšgHªdËrD©a
,

530 cÚ¡ 
	tXML_Ch¬
 *
	tÇme
,

531 
	tXML_Encodšg
 *
	tšfo
);

533 
XMLPARSEAPI
()

534 
XML_S‘EËm’tHªdËr
(
XML_P¬£r
 
·r£r
,

535 
XML_S¹EËm’tHªdËr
 
¡¬t
,

536 
XML_EndEËm’tHªdËr
 
’d
);

538 
XMLPARSEAPI
()

539 
XML_S‘S¹EËm’tHªdËr
(
XML_P¬£r
 
·r£r
,

540 
XML_S¹EËm’tHªdËr
 
hªdËr
);

542 
XMLPARSEAPI
()

543 
XML_S‘EndEËm’tHªdËr
(
XML_P¬£r
 
·r£r
,

544 
XML_EndEËm’tHªdËr
 
hªdËr
);

546 
XMLPARSEAPI
()

547 
XML_S‘Ch¬aù”D©aHªdËr
(
XML_P¬£r
 
·r£r
,

548 
XML_Ch¬aù”D©aHªdËr
 
hªdËr
);

550 
XMLPARSEAPI
()

551 
XML_S‘ProûssšgIn¡ruùiÚHªdËr
(
XML_P¬£r
 
·r£r
,

552 
XML_ProûssšgIn¡ruùiÚHªdËr
 
hªdËr
);

553 
XMLPARSEAPI
()

554 
XML_S‘Comm’tHªdËr
(
XML_P¬£r
 
·r£r
,

555 
XML_Comm’tHªdËr
 
hªdËr
);

557 
XMLPARSEAPI
()

558 
XML_S‘Cd©aSeùiÚHªdËr
(
XML_P¬£r
 
·r£r
,

559 
XML_S¹Cd©aSeùiÚHªdËr
 
¡¬t
,

560 
XML_EndCd©aSeùiÚHªdËr
 
’d
);

562 
XMLPARSEAPI
()

563 
XML_S‘S¹Cd©aSeùiÚHªdËr
(
XML_P¬£r
 
·r£r
,

564 
XML_S¹Cd©aSeùiÚHªdËr
 
¡¬t
);

566 
XMLPARSEAPI
()

567 
XML_S‘EndCd©aSeùiÚHªdËr
(
XML_P¬£r
 
·r£r
,

568 
XML_EndCd©aSeùiÚHªdËr
 
’d
);

574 
XMLPARSEAPI
()

575 
XML_S‘DeçuÉHªdËr
(
XML_P¬£r
 
·r£r
,

576 
XML_DeçuÉHªdËr
 
hªdËr
);

582 
XMLPARSEAPI
()

583 
XML_S‘DeçuÉHªdËrEx·nd
(
XML_P¬£r
 
·r£r
,

584 
XML_DeçuÉHªdËr
 
hªdËr
);

586 
XMLPARSEAPI
()

587 
XML_S‘Doùy³DeşHªdËr
(
XML_P¬£r
 
·r£r
,

588 
XML_S¹Doùy³DeşHªdËr
 
¡¬t
,

589 
XML_EndDoùy³DeşHªdËr
 
’d
);

591 
XMLPARSEAPI
()

592 
XML_S‘S¹Doùy³DeşHªdËr
(
XML_P¬£r
 
·r£r
,

593 
XML_S¹Doùy³DeşHªdËr
 
¡¬t
);

595 
XMLPARSEAPI
()

596 
XML_S‘EndDoùy³DeşHªdËr
(
XML_P¬£r
 
·r£r
,

597 
XML_EndDoùy³DeşHªdËr
 
’d
);

599 
XMLPARSEAPI
()

600 
XML_S‘UÅ¬£dEÁ™yDeşHªdËr
(
XML_P¬£r
 
·r£r
,

601 
XML_UÅ¬£dEÁ™yDeşHªdËr
 
hªdËr
);

603 
XMLPARSEAPI
()

604 
XML_S‘NÙ©iÚDeşHªdËr
(
XML_P¬£r
 
·r£r
,

605 
XML_NÙ©iÚDeşHªdËr
 
hªdËr
);

607 
XMLPARSEAPI
()

608 
XML_S‘Name¥aûDeşHªdËr
(
XML_P¬£r
 
·r£r
,

609 
XML_S¹Name¥aûDeşHªdËr
 
¡¬t
,

610 
XML_EndName¥aûDeşHªdËr
 
’d
);

612 
XMLPARSEAPI
()

613 
XML_S‘S¹Name¥aûDeşHªdËr
(
XML_P¬£r
 
·r£r
,

614 
XML_S¹Name¥aûDeşHªdËr
 
¡¬t
);

616 
XMLPARSEAPI
()

617 
XML_S‘EndName¥aûDeşHªdËr
(
XML_P¬£r
 
·r£r
,

618 
XML_EndName¥aûDeşHªdËr
 
’d
);

620 
XMLPARSEAPI
()

621 
XML_S‘NÙSnd®ÚeHªdËr
(
XML_P¬£r
 
·r£r
,

622 
XML_NÙSnd®ÚeHªdËr
 
hªdËr
);

624 
XMLPARSEAPI
()

625 
XML_S‘Ex‹º®EÁ™yRefHªdËr
(
XML_P¬£r
 
·r£r
,

626 
XML_Ex‹º®EÁ™yRefHªdËr
 
hªdËr
);

632 
XMLPARSEAPI
()

633 
XML_S‘Ex‹º®EÁ™yRefHªdËrArg
(
XML_P¬£r
 
·r£r
,

634 *
¬g
);

636 
XMLPARSEAPI
()

637 
XML_S‘Sk³dEÁ™yHªdËr
(
XML_P¬£r
 
·r£r
,

638 
XML_Sk³dEÁ™yHªdËr
 
hªdËr
);

640 
XMLPARSEAPI
()

641 
XML_S‘UnknownEncodšgHªdËr
(
XML_P¬£r
 
·r£r
,

642 
XML_UnknownEncodšgHªdËr
 
hªdËr
,

643 *
’codšgHªdËrD©a
);

649 
XMLPARSEAPI
()

650 
XML_DeçuÉCu¼’t
(
XML_P¬£r
 
·r£r
);

666 
XMLPARSEAPI
()

667 
XML_S‘R‘uºNSTrËt
(
XML_P¬£r
 
·r£r
, 
do_n¡
);

670 
XMLPARSEAPI
()

671 
XML_S‘U£rD©a
(
XML_P¬£r
 
·r£r
, *
u£rD©a
);

674 
	#XML_G‘U£rD©a
(
·r£r
è(*(**)Õ¬£r))

	)

682 
XMLPARSEAPI
(
XML_Stus
)

683 
XML_S‘Encodšg
(
XML_P¬£r
 
·r£r
, cÚ¡ 
XML_Ch¬
 *
’codšg
);

689 
XMLPARSEAPI
()

690 
XML_U£P¬£rAsHªdËrArg
(
XML_P¬£r
 
·r£r
);

710 
XMLPARSEAPI
(
XML_E¼Ü
)

711 
XML_U£FÜeignDTD
(
XML_P¬£r
 
·r£r
, 
XML_BoŞ
 
u£DTD
);

722 
XMLPARSEAPI
(
XML_Stus
)

723 
XML_S‘Ba£
(
XML_P¬£r
 
·r£r
, cÚ¡ 
XML_Ch¬
 *
ba£
);

725 
XMLPARSEAPI
(cÚ¡ 
XML_Ch¬
 *)

726 
XML_G‘Ba£
(
XML_P¬£r
 
·r£r
);

734 
XMLPARSEAPI
()

735 
XML_G‘S³cif›dA‰ribu‹CouÁ
(
XML_P¬£r
 
·r£r
);

742 
XMLPARSEAPI
()

743 
XML_G‘IdA‰ribu‹Index
(
XML_P¬£r
 
·r£r
);

754 
XMLPARSEAPI
(
XML_Stus
)

755 
XML_P¬£
(
XML_P¬£r
 
·r£r
, cÚ¡ *
s
, 
Ën
, 
isFš®
);

757 
XMLPARSEAPI
(*)

758 
XML_G‘Bufãr
(
XML_P¬£r
 
·r£r
, 
Ën
);

760 
XMLPARSEAPI
(
XML_Stus
)

761 
XML_P¬£Bufãr
(
XML_P¬£r
 
·r£r
, 
Ën
, 
isFš®
);

794 
XMLPARSEAPI
(
XML_Stus
)

795 
XML_StİP¬£r
(
XML_P¬£r
 
·r£r
, 
XML_BoŞ
 
»sumabË
);

809 
XMLPARSEAPI
(
XML_Stus
)

810 
XML_ResumeP¬£r
(
XML_P¬£r
 
·r£r
);

812 
	eXML_P¬sšg
 {

813 
XML_INITIALIZED
,

814 
XML_PARSING
,

815 
XML_FINISHED
,

816 
XML_SUSPENDED


820 
XML_P¬sšg
 
·rsšg
;

821 
XML_BoŞ
 
fš®Bufãr
;

822 } 
	tXML_P¬sšgStus
;

829 
XMLPARSEAPI
()

830 
XML_G‘P¬sšgStus
(
XML_P¬£r
 
·r£r
, 
XML_P¬sšgStus
 *
¡©us
);

848 
XMLPARSEAPI
(
XML_P¬£r
)

849 
XML_Ex‹º®EÁ™yP¬£rC»©e
(
XML_P¬£r
 
·r£r
,

850 cÚ¡ 
XML_Ch¬
 *
cÚ‹xt
,

851 cÚ¡ 
XML_Ch¬
 *
’codšg
);

853 
	eXML_P¬amEÁ™yP¬sšg
 {

854 
XML_PARAM_ENTITY_PARSING_NEVER
,

855 
XML_PARAM_ENTITY_PARSING_UNLESS_STANDALONE
,

856 
XML_PARAM_ENTITY_PARSING_ALWAYS


882 
XMLPARSEAPI
()

883 
XML_S‘P¬amEÁ™yP¬sšg
(
XML_P¬£r
 
·r£r
,

884 
XML_P¬amEÁ™yP¬sšg
 
·rsšg
);

889 
XMLPARSEAPI
(
XML_E¼Ü
)

890 
XML_G‘E¼ÜCode
(
XML_P¬£r
 
·r£r
);

908 
XMLPARSEAPI
(
XML_Size
è
XML_G‘Cu¼’tLšeNumb”
(
XML_P¬£r
 
·r£r
);

909 
XMLPARSEAPI
(
XML_Size
è
XML_G‘Cu¼’tCŞumnNumb”
(
XML_P¬£r
 
·r£r
);

910 
XMLPARSEAPI
(
XML_Index
è
XML_G‘Cu¼’tBy‹Index
(
XML_P¬£r
 
·r£r
);

915 
XMLPARSEAPI
()

916 
XML_G‘Cu¼’tBy‹CouÁ
(
XML_P¬£r
 
·r£r
);

928 
XMLPARSEAPI
(const *)

929 
XML_G‘IÅutCÚ‹xt
(
XML_P¬£r
 
·r£r
,

930 *
off£t
,

931 *
size
);

934 
	#XML_G‘E¼ÜLšeNumb”
 
XML_G‘Cu¼’tLšeNumb”


	)

935 
	#XML_G‘E¼ÜCŞumnNumb”
 
XML_G‘Cu¼’tCŞumnNumb”


	)

936 
	#XML_G‘E¼ÜBy‹Index
 
XML_G‘Cu¼’tBy‹Index


	)

939 
XMLPARSEAPI
()

940 
XML_F»eCÚ‹ÁMod–
(
XML_P¬£r
 
·r£r
, 
XML_CÚ‹Á
 *
mod–
);

943 
XMLPARSEAPI
(*)

944 
XML_MemM®loc
(
XML_P¬£r
 
·r£r
, 
size_t
 
size
);

946 
XMLPARSEAPI
(*)

947 
XML_MemR—Îoc
(
XML_P¬£r
 
·r£r
, *
±r
, 
size_t
 
size
);

949 
XMLPARSEAPI
()

950 
XML_MemF»e
(
XML_P¬£r
 
·r£r
, *
±r
);

953 
XMLPARSEAPI
()

954 
XML_P¬£rF»e
(
XML_P¬£r
 
·r£r
);

957 
XMLPARSEAPI
(cÚ¡ 
XML_LCh¬
 *)

958 
XML_E¼ÜSŒšg
(
XML_E¼Ü
 
code
);

961 
XMLPARSEAPI
(cÚ¡ 
XML_LCh¬
 *)

962 
XML_Ex·tV”siÚ
();

965 
majÜ
;

966 
mšÜ
;

967 
miüo
;

968 } 
	tXML_Ex·t_V”siÚ
;

973 
XMLPARSEAPI
(
XML_Ex·t_V”siÚ
)

974 
XML_Ex·tV”siÚInfo
();

977 
	eXML_F—tu»Enum
 {

978 
XML_FEATURE_END
 = 0,

979 
XML_FEATURE_UNICODE
,

980 
XML_FEATURE_UNICODE_WCHAR_T
,

981 
XML_FEATURE_DTD
,

982 
XML_FEATURE_CONTEXT_BYTES
,

983 
XML_FEATURE_MIN_SIZE
,

984 
XML_FEATURE_SIZEOF_XML_CHAR
,

985 
XML_FEATURE_SIZEOF_XML_LCHAR
,

986 
XML_FEATURE_NS
,

987 
XML_FEATURE_LARGE_SIZE


992 
XML_F—tu»Enum
 
ã©u»
;

993 cÚ¡ 
XML_LCh¬
 *
Çme
;

994 
v®ue
;

995 } 
	tXML_F—tu»
;

997 
XMLPARSEAPI
(cÚ¡ 
XML_F—tu»
 *)

998 
XML_G‘F—tu»Li¡
();

1006 
	#XML_MAJOR_VERSION
 2

	)

1007 
	#XML_MINOR_VERSION
 0

	)

1008 
	#XML_MICRO_VERSION
 1

	)

1010 #ifdeà
__ılu¥lus


	@/usr/include/fcntl.h

24 #iâdef 
_FCNTL_H


25 
	#_FCNTL_H
 1

	)

27 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


34 
	~<b™s/fú.h
>

37 #ifdeà
__USE_XOPEN


38 
	~<sys/¡©.h
>

41 #ifdef 
__USE_MISC


42 #iâdeà
R_OK


45 
	#R_OK
 4

	)

46 
	#W_OK
 2

	)

47 
	#X_OK
 1

	)

48 
	#F_OK
 0

	)

53 #ifdeà
__USE_XOPEN


54 
	#SEEK_SET
 0

	)

55 
	#SEEK_CUR
 1

	)

56 
	#SEEK_END
 2

	)

59 #ifdeà
__USE_ATFILE


60 
	#AT_FDCWD
 -100

	)

63 
	#AT_SYMLINK_NOFOLLOW
 0x100

	)

64 
	#AT_REMOVEDIR
 0x200

	)

66 
	#AT_SYMLINK_FOLLOW
 0x400

	)

67 
	#AT_EACCESS
 0x200

	)

76 
fú
 (
__fd
, 
__cmd
, ...);

84 #iâdeà
__USE_FILE_OFFSET64


85 
	$İ’
 (
__cÚ¡
 *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

87 #ifdeà
__REDIRECT


88 
	`__REDIRECT
 (
İ’
, (
__cÚ¡
 *
__fe
, 
__oæag
, ...), 
İ’64
)

89 
	`__nÚnuÎ
 ((1));

91 
	#İ’
 
İ’64


	)

94 #ifdeà
__USE_LARGEFILE64


95 
	$İ’64
 (
__cÚ¡
 *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

98 #ifdeà
__USE_ATFILE


108 #iâdeà
__USE_FILE_OFFSET64


109 
	$İ’©
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__oæag
, ...)

110 
	`__nÚnuÎ
 ((2));

112 #ifdeà
__REDIRECT


113 
	`__REDIRECT
 (
İ’©
, (
__fd
, 
__cÚ¡
 *
__fe
, 
__oæag
,

114 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

116 
	#İ’©
 
İ’©64


	)

120 
	$İ’©64
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__oæag
, ...)

121 
	`__nÚnuÎ
 ((2));

129 #iâdeà
__USE_FILE_OFFSET64


130 
	$ü—t
 (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

132 #ifdeà
__REDIRECT


133 
	`__REDIRECT
 (
ü—t
, (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
),

134 
ü—t64
è
	`__nÚnuÎ
 ((1));

136 
	#ü—t
 
ü—t64


	)

139 #ifdeà
__USE_LARGEFILE64


140 
	$ü—t64
 (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

143 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

144 && !
defšed
 
__USE_POSIX
))

153 
	#F_ULOCK
 0

	)

154 
	#F_LOCK
 1

	)

155 
	#F_TLOCK
 2

	)

156 
	#F_TEST
 3

	)

158 #iâdeà
__USE_FILE_OFFSET64


159 
	`lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
);

161 #ifdeà
__REDIRECT


162 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

164 
	#lockf
 
lockf64


	)

167 #ifdeà
__USE_LARGEFILE64


168 
	`lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
);

172 #ifdeà
__USE_XOPEN2K


175 #iâdeà
__USE_FILE_OFFSET64


176 
	$posix_çdvi£
 (
__fd
, 
__off_t
 
__off£t
, __off_ˆ
__Ën
,

177 
__advi£
è
__THROW
;

179 #ifdeà
__REDIRECT_NTH


180 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

181 
__off64_t
 
__Ën
, 
__advi£
),

182 
posix_çdvi£64
);

184 
	#posix_çdvi£
 
posix_çdvi£64


	)

187 #ifdeà
__USE_LARGEFILE64


188 
	$posix_çdvi£64
 (
__fd
, 
__off64_t
 
__off£t
, __off64_ˆ
__Ën
,

189 
__advi£
è
__THROW
;

197 #iâdeà
__USE_FILE_OFFSET64


198 
	`posix_çÎoÿ‹
 (
__fd
, 
__off_t
 
__off£t
, __off_ˆ
__Ën
);

200 #ifdeà
__REDIRECT


201 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

202 
__off64_t
 
__Ën
),

203 
posix_çÎoÿ‹64
);

205 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

208 #ifdeà
__USE_LARGEFILE64


209 
	`posix_çÎoÿ‹64
 (
__fd
, 
__off64_t
 
__off£t
, __off64_ˆ
__Ën
);

215 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše
 \

216 && 
defšed
 
__va_¬g_·ck_Ën


217 
	~<b™s/fú2.h
>

220 
__END_DECLS


	@/usr/include/fstab.h

32 #iâdeà
_FSTAB_H


33 
	#_FSTAB_H
 1

	)

35 
	~<ã©u»s.h
>

48 
	#_PATH_FSTAB
 "/‘c/f¡ab"

	)

49 
	#FSTAB
 "/‘c/f¡ab"

	)

51 
	#FSTAB_RW
 "rw"

	)

52 
	#FSTAB_RQ
 "rq"

	)

53 
	#FSTAB_RO
 "ro"

	)

54 
	#FSTAB_SW
 "sw"

	)

55 
	#FSTAB_XX
 "xx"

	)

57 
	sf¡ab


59 *
	mfs_¥ec
;

60 *
	mfs_fe
;

61 *
	mfs_vf¡y³
;

62 *
	mfs_mÁİs
;

63 cÚ¡ *
	mfs_ty³
;

64 
	mfs_äeq
;

65 
	mfs_·s¢o
;

69 
__BEGIN_DECLS


71 
f¡ab
 *
	$g‘f£Á
 (è
__THROW
;

72 
f¡ab
 *
	$g‘fs¥ec
 (
__cÚ¡
 *
__Çme
è
__THROW
;

73 
f¡ab
 *
	$g‘fsfe
 (
__cÚ¡
 *
__Çme
è
__THROW
;

74 
	$£tf£Á
 (è
__THROW
;

75 
	$’df£Á
 (è
__THROW
;

77 
__END_DECLS


	@/usr/include/getopt.h

21 #iâdeà
_GETOPT_H


23 #iâdeà
__Ãed_g‘İt


24 
	#_GETOPT_H
 1

	)

34 #ià!
defšed
 
__GNU_LIBRARY__


35 
	~<ùy³.h
>

38 #iâdeà
__THROW


39 #iâdeà
__GNUC_PREREQ


40 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

42 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

43 
	#__THROW
 
	`throw
 ()

	)

45 
	#__THROW


	)

49 #ifdef 
__ılu¥lus


59 *
İrg
;

73 
İtšd
;

78 
İ‹¼
;

82 
İtİt
;

84 #iâdeà
__Ãed_g‘İt


106 
	sİtiÚ


108 cÚ¡ *
	gÇme
;

111 
	ghas_¬g
;

112 *
	gæag
;

113 
	gv®
;

118 
	#no_¬gum’t
 0

	)

119 
	#»quœed_¬gum’t
 1

	)

120 
	#İtiÚ®_¬gum’t
 2

	)

148 #ifdeà
__GNU_LIBRARY__


152 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

153 
__THROW
;

155 
g‘İt
 ();

158 #iâdeà
__Ãed_g‘İt


159 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

160 cÚ¡ *
__shÜtİts
,

161 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

162 
__THROW
;

163 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

164 cÚ¡ *
__shÜtİts
,

165 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

166 
__THROW
;

170 #ifdef 
__ılu¥lus


175 #undeà
__Ãed_g‘İt


	@/usr/include/grp.h

23 #iâdef 
_GRP_H


24 
	#_GRP_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


30 
	~<b™s/ty³s.h
>

32 
	#__Ãed_size_t


	)

33 
	~<¡ddef.h
>

37 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K
è&& !defšed 
__gid_t_defšed


38 
__gid_t
 
	tgid_t
;

39 
	#__gid_t_defšed


	)

43 
	sgroup


45 *
	mgr_Çme
;

46 *
	mgr_·sswd
;

47 
__gid_t
 
	mgr_gid
;

48 **
	mgr_mem
;

52 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_GNU


53 
	#__Ãed_FILE


	)

54 
	~<¡dio.h
>

58 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


63 
£tg»Á
 ();

69 
’dg»Á
 ();

75 
group
 *
g‘g»Á
 ();

78 #ifdef 
__USE_SVID


85 
group
 *
fg‘g»Á
 (
FILE
 *
__¡»am
);

88 #ifdeà
__USE_GNU


95 
putg»Á
 (
__cÚ¡
 
group
 *
__»¡riù
 
__p
,

96 
FILE
 *
__»¡riù
 
__f
);

103 
group
 *
g‘grgid
 (
__gid_t
 
__gid
);

109 
group
 *
g‘gºam
 (
__cÚ¡
 *
__Çme
);

111 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


113 #ifdeà
__USE_MISC


116 
	#NSS_BUFLEN_GROUP
 1024

	)

132 #ifdeà
__USE_GNU


133 
g‘g»Á_r
 (
group
 *
__»¡riù
 
__»suÉbuf
,

134 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

135 
group
 **
__»¡riù
 
__»suÉ
);

142 
g‘grgid_r
 (
__gid_t
 
__gid
, 
group
 *
__»¡riù
 
__»suÉbuf
,

143 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

144 
group
 **
__»¡riù
 
__»suÉ
);

150 
g‘gºam_r
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

151 
group
 *
__»¡riù
 
__»suÉbuf
,

152 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

153 
group
 **
__»¡riù
 
__»suÉ
);

155 #ifdef 
__USE_SVID


163 
fg‘g»Á_r
 (
FILE
 *
__»¡riù
 
__¡»am
,

164 
group
 *
__»¡riù
 
__»suÉbuf
,

165 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

166 
group
 **
__»¡riù
 
__»suÉ
);

172 #ifdef 
__USE_BSD


174 
	#__Ãed_size_t


	)

175 
	~<¡ddef.h
>

178 
	$£tgroups
 (
size_t
 
__n
, 
__cÚ¡
 
__gid_t
 *
__groups
è
__THROW
;

188 
	`g‘grou¶i¡
 (
__cÚ¡
 *
__u£r
, 
__gid_t
 
__group
,

189 
__gid_t
 *
__groups
, *
__ngroups
);

199 
	`š™groups
 (
__cÚ¡
 *
__u£r
, 
__gid_t
 
__group
);

203 
__END_DECLS


	@/usr/include/inttypes.h

23 #iâdeà
_INTTYPES_H


24 
	#_INTTYPES_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	~<¡dšt.h
>

31 #iâdeà
____gwch¬_t_defšed


32 #ifdeà
__ılu¥lus


33 
	#__gwch¬_t
 
wch¬_t


	)

34 #–ià
defšed
 
__WCHAR_TYPE__


35 
__WCHAR_TYPE__
 
	t__gwch¬_t
;

37 
	#__Ãed_wch¬_t


	)

38 
	~<¡ddef.h
>

39 
wch¬_t
 
	t__gwch¬_t
;

41 
	#____gwch¬_t_defšed
 1

	)

47 #ià!
defšed
 
__ılu¥lus
 || defšed 
__STDC_FORMAT_MACROS


49 #ià
__WORDSIZE
 == 64

50 
	#__PRI64_PREFIX
 "l"

	)

51 
	#__PRIPTR_PREFIX
 "l"

	)

53 
	#__PRI64_PREFIX
 "Î"

	)

54 
	#__PRIPTR_PREFIX


	)

60 
	#PRId8
 "d"

	)

61 
	#PRId16
 "d"

	)

62 
	#PRId32
 "d"

	)

63 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

65 
	#PRIdLEAST8
 "d"

	)

66 
	#PRIdLEAST16
 "d"

	)

67 
	#PRIdLEAST32
 "d"

	)

68 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIdFAST8
 "d"

	)

71 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

72 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

73 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

76 
	#PRIi8
 "i"

	)

77 
	#PRIi16
 "i"

	)

78 
	#PRIi32
 "i"

	)

79 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

81 
	#PRIiLEAST8
 "i"

	)

82 
	#PRIiLEAST16
 "i"

	)

83 
	#PRIiLEAST32
 "i"

	)

84 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIiFAST8
 "i"

	)

87 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

88 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

89 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

92 
	#PRIo8
 "o"

	)

93 
	#PRIo16
 "o"

	)

94 
	#PRIo32
 "o"

	)

95 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

97 
	#PRIoLEAST8
 "o"

	)

98 
	#PRIoLEAST16
 "o"

	)

99 
	#PRIoLEAST32
 "o"

	)

100 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIoFAST8
 "o"

	)

103 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

104 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

105 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

108 
	#PRIu8
 "u"

	)

109 
	#PRIu16
 "u"

	)

110 
	#PRIu32
 "u"

	)

111 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

113 
	#PRIuLEAST8
 "u"

	)

114 
	#PRIuLEAST16
 "u"

	)

115 
	#PRIuLEAST32
 "u"

	)

116 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIuFAST8
 "u"

	)

119 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

120 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

121 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

124 
	#PRIx8
 "x"

	)

125 
	#PRIx16
 "x"

	)

126 
	#PRIx32
 "x"

	)

127 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

129 
	#PRIxLEAST8
 "x"

	)

130 
	#PRIxLEAST16
 "x"

	)

131 
	#PRIxLEAST32
 "x"

	)

132 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIxFAST8
 "x"

	)

135 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

136 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

137 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

140 
	#PRIX8
 "X"

	)

141 
	#PRIX16
 "X"

	)

142 
	#PRIX32
 "X"

	)

143 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

145 
	#PRIXLEAST8
 "X"

	)

146 
	#PRIXLEAST16
 "X"

	)

147 
	#PRIXLEAST32
 "X"

	)

148 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

150 
	#PRIXFAST8
 "X"

	)

151 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

152 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

153 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

157 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

158 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

159 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

160 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

161 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

162 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

166 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

167 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

168 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

169 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

170 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

171 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

177 
	#SCNd8
 "hhd"

	)

178 
	#SCNd16
 "hd"

	)

179 
	#SCNd32
 "d"

	)

180 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

182 
	#SCNdLEAST8
 "hhd"

	)

183 
	#SCNdLEAST16
 "hd"

	)

184 
	#SCNdLEAST32
 "d"

	)

185 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNdFAST8
 "hhd"

	)

188 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

189 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

190 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

193 
	#SCNi8
 "hhi"

	)

194 
	#SCNi16
 "hi"

	)

195 
	#SCNi32
 "i"

	)

196 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

198 
	#SCNiLEAST8
 "hhi"

	)

199 
	#SCNiLEAST16
 "hi"

	)

200 
	#SCNiLEAST32
 "i"

	)

201 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNiFAST8
 "hhi"

	)

204 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

205 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

206 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

209 
	#SCNu8
 "hhu"

	)

210 
	#SCNu16
 "hu"

	)

211 
	#SCNu32
 "u"

	)

212 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

214 
	#SCNuLEAST8
 "hhu"

	)

215 
	#SCNuLEAST16
 "hu"

	)

216 
	#SCNuLEAST32
 "u"

	)

217 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNuFAST8
 "hhu"

	)

220 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

221 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

222 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

225 
	#SCNo8
 "hho"

	)

226 
	#SCNo16
 "ho"

	)

227 
	#SCNo32
 "o"

	)

228 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

230 
	#SCNoLEAST8
 "hho"

	)

231 
	#SCNoLEAST16
 "ho"

	)

232 
	#SCNoLEAST32
 "o"

	)

233 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNoFAST8
 "hho"

	)

236 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

237 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

238 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

241 
	#SCNx8
 "hhx"

	)

242 
	#SCNx16
 "hx"

	)

243 
	#SCNx32
 "x"

	)

244 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

246 
	#SCNxLEAST8
 "hhx"

	)

247 
	#SCNxLEAST16
 "hx"

	)

248 
	#SCNxLEAST32
 "x"

	)

249 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

251 
	#SCNxFAST8
 "hhx"

	)

252 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

253 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

254 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

258 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

259 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

260 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

261 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

262 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

265 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

266 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

267 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

268 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

269 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

274 
	g__BEGIN_DECLS


276 #ià
__WORDSIZE
 == 64

281 
	mquÙ
;

282 
	m»m
;

283 } 
	timaxdiv_t
;

290 
	mquÙ
;

291 
	m»m
;

292 } 
	timaxdiv_t
;

298 
štmax_t
 
	$imaxabs
 (
štmax_t
 
__n
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

301 
imaxdiv_t
 
	$imaxdiv
 (
štmax_t
 
__num”
, iÁmax_ˆ
__d’om
)

302 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

305 
štmax_t
 
	$¡¹oimax
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

306 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

309 
uštmax_t
 
	$¡¹oumax
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

310 ** 
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

313 
štmax_t
 
	$wc¡oimax
 (
__cÚ¡
 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

314 
__gwch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

315 
__THROW
;

318 
uštmax_t
 
	$wc¡oumax
 (
__cÚ¡
 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

319 
__gwch¬_t
 ** 
__»¡riù
 
__’d±r
, 
__ba£
)

320 
__THROW
;

322 #ifdeà
__USE_EXTERN_INLINES


324 #ià
__WORDSIZE
 == 64

326 
	$__¡¹Ş_š‹º®
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

327 **
__»¡riù
 
__’d±r
,

328 
__ba£
, 
__group
)

329 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

331 
__ex‹º_šlše
 
štmax_t


332 
	`__NTH
 (
	$¡¹oimax
 (
__cÚ¡
 *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

333 
ba£
))

335  
	`__¡¹Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

336 
	}
}

338 
	$__¡¹oul_š‹º®
 (
__cÚ¡
 *

339 
__»¡riù
 
__ÅŒ
,

340 ** 
__»¡riù
 
__’d±r
,

341 
__ba£
, 
__group
)

342 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

344 
__ex‹º_šlše
 
uštmax_t


345 
	`__NTH
 (
	$¡¹oumax
 (
__cÚ¡
 *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

346 
ba£
))

348  
	`__¡¹oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

349 
	}
}

351 
	$__wc¡Ş_š‹º®
 (
__cÚ¡
 
__gwch¬_t
 * 
__»¡riù
 
__ÅŒ
,

352 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

353 
__ba£
, 
__group
)

354 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

356 
__ex‹º_šlše
 
štmax_t


357 
	`__NTH
 (
	$wc¡oimax
 (
__cÚ¡
 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

358 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

360  
	`__wc¡Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

361 
	}
}

363 
	$__wc¡oul_š‹º®
 (
__cÚ¡
 
__gwch¬_t
 *

364 
__»¡riù
 
__ÅŒ
,

365 
__gwch¬_t
 **

366 
__»¡riù
 
__’d±r
,

367 
__ba£
, 
__group
)

368 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

370 
__ex‹º_šlše
 
uštmax_t


371 
	`__NTH
 (
	$wc¡oumax
 (
__cÚ¡
 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

372 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

374  
	`__wc¡oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

375 
	}
}

379 
__ex‹nsiÚ__


380 
	$__¡¹Şl_š‹º®
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

381 **
__»¡riù
 
__’d±r
,

382 
__ba£
, 
__group
)

383 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

385 
__ex‹º_šlše
 
štmax_t


386 
	`__NTH
 (
	$¡¹oimax
 (
__cÚ¡
 *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

387 
ba£
))

389  
	`__¡¹Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

390 
	}
}

392 
__ex‹nsiÚ__


393 
	$__¡¹ouÎ_š‹º®
 (
__cÚ¡
 *

394 
__»¡riù
 
__ÅŒ
,

396 
__»¡riù
 
__’d±r
,

397 
__ba£
,

398 
__group
)

399 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

401 
__ex‹º_šlše
 
uštmax_t


402 
	`__NTH
 (
	$¡¹oumax
 (
__cÚ¡
 *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

403 
ba£
))

405  
	`__¡¹ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

406 
	}
}

408 
__ex‹nsiÚ__


409 
	$__wc¡Şl_š‹º®
 (
__cÚ¡
 
__gwch¬_t
 *

410 
__»¡riù
 
__ÅŒ
,

411 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

412 
__ba£
, 
__group
)

413 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

415 
__ex‹º_šlše
 
štmax_t


416 
	`__NTH
 (
	$wc¡oimax
 (
__cÚ¡
 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

417 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

419  
	`__wc¡Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

420 
	}
}

423 
__ex‹nsiÚ__


424 
	$__wc¡ouÎ_š‹º®
 (
__cÚ¡
 
__gwch¬_t
 *

425 
__»¡riù
 
__ÅŒ
,

426 
__gwch¬_t
 **

427 
__»¡riù
 
__’d±r
,

428 
__ba£
,

429 
__group
)

430 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

432 
__ex‹º_šlše
 
uštmax_t


433 
	`__NTH
 (
	$wc¡oumax
 (
__cÚ¡
 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

434 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

436  
	`__wc¡ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

437 
	}
}

442 
	g__END_DECLS


	@/usr/include/libgen.h

19 #iâdeà
_LIBGEN_H


20 
	#_LIBGEN_H
 1

	)

22 
	~<ã©u»s.h
>

24 
__BEGIN_DECLS


27 *
	$dœÇme
 (*
__·th
è
__THROW
;

35 *
	$__xpg_ba£Çme
 (*
__·th
è
__THROW
;

36 
	#ba£Çme
 
__xpg_ba£Çme


	)

38 
__END_DECLS


	@/usr/include/libintl.h

21 #iâdeà
_LIBINTL_H


22 
	#_LIBINTL_H
 1

	)

24 
	~<ã©u»s.h
>

28 
	#__USE_GNU_GETTEXT
 1

	)

32 
	#__GNU_GETTEXT_SUPPORTED_REVISION
(
majÜ
) \

33 ((
majÜ
è=ğ0 ? 1 : -1)

	)

35 
__BEGIN_DECLS


40 *
	$g‘‹xt
 (
__cÚ¡
 *
__msgid
)

41 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (1);

45 *
	$dg‘‹xt
 (
__cÚ¡
 *
__domašÇme
, __cÚ¡ *
__msgid
)

46 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (2);

47 *
	$__dg‘‹xt
 (
__cÚ¡
 *
__domašÇme
, __cÚ¡ *
__msgid
)

48 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (2);

52 *
	$dcg‘‹xt
 (
__cÚ¡
 *
__domašÇme
,

53 
__cÚ¡
 *
__msgid
, 
__ÿ‹gÜy
)

54 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (2);

55 *
	$__dcg‘‹xt
 (
__cÚ¡
 *
__domašÇme
,

56 
__cÚ¡
 *
__msgid
, 
__ÿ‹gÜy
)

57 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (2);

62 *
	$ng‘‹xt
 (
__cÚ¡
 *
__msgid1
, __cÚ¡ *
__msgid2
,

63 
__n
)

64 
__THROW
 
	$__©Œibu‹_fÜm©_¬g__
 (1è
	`__©Œibu‹_fÜm©_¬g__
 (2);

68 *
	$dng‘‹xt
 (
__cÚ¡
 *
__domašÇme
, __cÚ¡ *
__msgid1
,

69 
__cÚ¡
 *
__msgid2
, 
__n
)

70 
__THROW
 
	$__©Œibu‹_fÜm©_¬g__
 (2è
	`__©Œibu‹_fÜm©_¬g__
 (3);

74 *
	$dúg‘‹xt
 (
__cÚ¡
 *
__domašÇme
, __cÚ¡ *
__msgid1
,

75 
__cÚ¡
 *
__msgid2
, 
__n
,

76 
__ÿ‹gÜy
)

77 
__THROW
 
	$__©Œibu‹_fÜm©_¬g__
 (2è
	`__©Œibu‹_fÜm©_¬g__
 (3);

83 *
	$‹xtdomaš
 (
__cÚ¡
 *
__domašÇme
è
__THROW
;

87 *
	$bšd‹xtdomaš
 (
__cÚ¡
 *
__domašÇme
,

88 
__cÚ¡
 *
__dœÇme
è
__THROW
;

92 *
	$bšd_‹xtdomaš_code£t
 (
__cÚ¡
 *
__domašÇme
,

93 
__cÚ¡
 *
__code£t
è
__THROW
;

97 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


100 
	#__Ãed_NULL


	)

101 
	~<¡ddef.h
>

104 
	~<loÿË.h
>

110 
	#g‘‹xt
(
msgid
è
	`dg‘‹xt
 (
NULL
, msgid)

	)

112 
	#dg‘‹xt
(
domašÇme
, 
msgid
) \

113 
	`dcg‘‹xt
 (
domašÇme
, 
msgid
, 
LC_MESSAGES
)

	)

115 
	#ng‘‹xt
(
msgid1
, 
msgid2
, 
n
è
	`dng‘‹xt
 (
NULL
, msgid1, msgid2,‚)

	)

117 
	#dng‘‹xt
(
domašÇme
, 
msgid1
, 
msgid2
, 
n
) \

118 
	`dúg‘‹xt
 (
domašÇme
, 
msgid1
, 
msgid2
, 
n
, 
LC_MESSAGES
)

	)

122 
__END_DECLS


	@/usr/include/limits.h

24 #iâdeà
_LIBC_LIMITS_H_


25 
	#_LIBC_LIMITS_H_
 1

	)

27 
	~<ã©u»s.h
>

33 
	#MB_LEN_MAX
 16

	)

38 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

43 #iâdeà
_LIMITS_H


44 
	#_LIMITS_H
 1

	)

46 
	~<b™s/wÜdsize.h
>

55 
	#CHAR_BIT
 8

	)

58 
	#SCHAR_MIN
 (-128)

	)

59 
	#SCHAR_MAX
 127

	)

62 
	#UCHAR_MAX
 255

	)

65 #ifdeà
__CHAR_UNSIGNED__


66 
	#CHAR_MIN
 0

	)

67 
	#CHAR_MAX
 
UCHAR_MAX


	)

69 
	#CHAR_MIN
 
SCHAR_MIN


	)

70 
	#CHAR_MAX
 
SCHAR_MAX


	)

74 
	#SHRT_MIN
 (-32768)

	)

75 
	#SHRT_MAX
 32767

	)

78 
	#USHRT_MAX
 65535

	)

81 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

82 
	#INT_MAX
 2147483647

	)

85 
	#UINT_MAX
 4294967295U

	)

88 #ià
__WORDSIZE
 == 64

89 
	#LONG_MAX
 9223372036854775807L

	)

91 
	#LONG_MAX
 2147483647L

	)

93 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

96 #ià
__WORDSIZE
 == 64

97 
	#ULONG_MAX
 18446744073709551615UL

	)

99 
	#ULONG_MAX
 4294967295UL

	)

102 #ifdeà
__USE_ISOC99


105 
	#LLONG_MAX
 9223372036854775807LL

	)

106 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

109 
	#ULLONG_MAX
 18446744073709551615ULL

	)

123 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


125 #šşude_Ãxˆ<
lim™s
.
h
>

131 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


132 #iâdeà
LLONG_MIN


133 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

135 #iâdeà
LLONG_MAX


136 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

138 #iâdeà
ULLONG_MAX


139 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

143 #ifdef 
__USE_POSIX


145 
	~<b™s/posix1_lim.h
>

148 #ifdef 
__USE_POSIX2


149 
	~<b™s/posix2_lim.h
>

152 #ifdef 
__USE_XOPEN


153 
	~<b™s/xİ’_lim.h
>

	@/usr/include/linux/adb.h

4 #iâdeà
__ADB_H


5 
	#__ADB_H


	)

8 
	#ADB_BUSRESET
 0

	)

9 
	#ADB_FLUSH
(
id
è(0x01 | ((idè<< 4))

	)

10 
	#ADB_WRITEREG
(
id
, 
»g
è(0x08 | (»gè| ((idè<< 4))

	)

11 
	#ADB_READREG
(
id
, 
»g
è(0x0C | (»gè| ((idè<< 4))

	)

14 
	#ADB_DONGLE
 1

	)

15 
	#ADB_KEYBOARD
 2

	)

16 
	#ADB_MOUSE
 3

	)

17 
	#ADB_TABLET
 4

	)

18 
	#ADB_MODEM
 5

	)

19 
	#ADB_MISC
 7

	)

21 
	#ADB_RET_OK
 0

	)

22 
	#ADB_RET_TIMEOUT
 3

	)

26 
	#ADB_PACKET
 0

	)

27 
	#CUDA_PACKET
 1

	)

28 
	#ERROR_PACKET
 2

	)

29 
	#TIMER_PACKET
 3

	)

30 
	#POWER_PACKET
 4

	)

31 
	#MACIIC_PACKET
 5

	)

32 
	#PMU_PACKET
 6

	)

33 
	#ADB_QUERY
 7

	)

41 
	#ADB_QUERY_GETDEVINFO
 1

	)

	@/usr/include/linux/cdrom.h

11 #iâdef 
_LINUX_CDROM_H


12 
	#_LINUX_CDROM_H


	)

14 
	~<asm/by‹Üd”.h
>

45 
	#EDRIVE_CANT_DO_THIS
 
EOPNOTSUPP


	)

52 
	#CDROMPAUSE
 0x5301

	)

53 
	#CDROMRESUME
 0x5302

	)

54 
	#CDROMPLAYMSF
 0x5303

	)

55 
	#CDROMPLAYTRKIND
 0x5304

	)

57 
	#CDROMREADTOCHDR
 0x5305

	)

59 
	#CDROMREADTOCENTRY
 0x5306

	)

61 
	#CDROMSTOP
 0x5307

	)

62 
	#CDROMSTART
 0x5308

	)

63 
	#CDROMEJECT
 0x5309

	)

64 
	#CDROMVOLCTRL
 0x530¨

	)

66 
	#CDROMSUBCHNL
 0x530b

	)

68 
	#CDROMREADMODE2
 0x530ø

	)

70 
	#CDROMREADMODE1
 0x530d

	)

72 
	#CDROMREADAUDIO
 0x530

	)

73 
	#CDROMEJECT_SW
 0x530à

	)

74 
	#CDROMMULTISESSION
 0x5310

	)

77 
	#CDROM_GET_MCN
 0x5311

	)

79 
	#CDROM_GET_UPC
 
CDROM_GET_MCN


	)

81 
	#CDROMRESET
 0x5312

	)

82 
	#CDROMVOLREAD
 0x5313

	)

84 
	#CDROMREADRAW
 0x5314

	)

89 
	#CDROMREADCOOKED
 0x5315

	)

90 
	#CDROMSEEK
 0x5316

	)

96 
	#CDROMPLAYBLK
 0x5317

	)

101 
	#CDROMREADALL
 0x5318

	)

110 
	#CDROMGETSPINDOWN
 0x531d

	)

111 
	#CDROMSETSPINDOWN
 0x531e

	)

118 
	#CDROMCLOSETRAY
 0x5319

	)

119 
	#CDROM_SET_OPTIONS
 0x5320

	)

120 
	#CDROM_CLEAR_OPTIONS
 0x5321

	)

121 
	#CDROM_SELECT_SPEED
 0x5322

	)

122 
	#CDROM_SELECT_DISC
 0x5323

	)

123 
	#CDROM_MEDIA_CHANGED
 0x5325

	)

124 
	#CDROM_DRIVE_STATUS
 0x5326

	)

125 
	#CDROM_DISC_STATUS
 0x5327

	)

126 
	#CDROM_CHANGER_NSLOTS
 0x5328

	)

127 
	#CDROM_LOCKDOOR
 0x5329

	)

128 
	#CDROM_DEBUG
 0x5330

	)

129 
	#CDROM_GET_CAPABILITY
 0x5331

	)

136 
	#CDROMAUDIOBUFSIZ
 0x5382

	)

140 
	#DVD_READ_STRUCT
 0x5390

	)

141 
	#DVD_WRITE_STRUCT
 0x5391

	)

142 
	#DVD_AUTH
 0x5392

	)

144 
	#CDROM_SEND_PACKET
 0x5393

	)

145 
	#CDROM_NEXT_WRITABLE
 0x5394

	)

146 
	#CDROM_LAST_WRITTEN
 0x5395

	)

153 
	scdrom_msf0


155 
__u8
 
	mmšu‹
;

156 
__u8
 
	m£cÚd
;

157 
__u8
 
	mäame
;

161 
	ucdrom_addr


163 
cdrom_msf0
 
	mmsf
;

164 
	mlba
;

168 
	scdrom_msf


170 
__u8
 
	mcdmsf_mš0
;

171 
__u8
 
	mcdmsf_£c0
;

172 
__u8
 
	mcdmsf_äame0
;

173 
__u8
 
	mcdmsf_mš1
;

174 
__u8
 
	mcdmsf_£c1
;

175 
__u8
 
	mcdmsf_äame1
;

179 
	scdrom_ti


181 
__u8
 
	mcdti_Œk0
;

182 
__u8
 
	mcdti_šd0
;

183 
__u8
 
	mcdti_Œk1
;

184 
__u8
 
	mcdti_šd1
;

188 
	scdrom_tochdr


190 
__u8
 
	mcdth_Œk0
;

191 
__u8
 
	mcdth_Œk1
;

195 
	scdrom_vŞù¾


197 
__u8
 
	mchªÃl0
;

198 
__u8
 
	mchªÃl1
;

199 
__u8
 
	mchªÃl2
;

200 
__u8
 
	mchªÃl3
;

204 
	scdrom_subchÆ


206 
__u8
 
	mcdsc_fÜm©
;

207 
__u8
 
	mcdsc_audio¡©us
;

208 
__u8
 
	mcdsc_adr
: 4;

209 
__u8
 
	mcdsc_ù¾
: 4;

210 
__u8
 
	mcdsc_Œk
;

211 
__u8
 
	mcdsc_šd
;

212 
cdrom_addr
 
	mcdsc_ab§ddr
;

213 
cdrom_addr
 
	mcdsc_»Ïddr
;

218 
	scdrom_toûÁry


220 
__u8
 
	mcd‹_Œack
;

221 
__u8
 
	mcd‹_adr
 :4;

222 
__u8
 
	mcd‹_ù¾
 :4;

223 
__u8
 
	mcd‹_fÜm©
;

224 
cdrom_addr
 
	mcd‹_addr
;

225 
__u8
 
	mcd‹_d©amode
;

229 
	scdrom_»ad


231 
	mcd»ad_lba
;

232 *
	mcd»ad_buçddr
;

233 
	mcd»ad_buæ’
;

237 
	scdrom_»ad_audio


239 
cdrom_addr
 
	maddr
;

240 
__u8
 
	maddr_fÜm©
;

241 
	mnäames
;

242 
__u8
 *
	mbuf
;

246 
	scdrom_muÉi£ssiÚ


248 
cdrom_addr
 
	maddr
;

251 
__u8
 
	mxa_æag
;

252 
__u8
 
	maddr_fÜm©
;

260 
	scdrom_mú


262 
__u8
 
	mmedium_ÿlog_numb”
[14];

266 
	scdrom_blk


268 
	mäom
;

269 
	mËn
;

272 
	#CDROM_PACKET_SIZE
 12

	)

274 
	#CGC_DATA_UNKNOWN
 0

	)

275 
	#CGC_DATA_WRITE
 1

	)

276 
	#CGC_DATA_READ
 2

	)

277 
	#CGC_DATA_NONE
 3

	)

280 
	scdrom_g’”ic_commªd


282 
	mcmd
[
CDROM_PACKET_SIZE
];

283 *
	mbufãr
;

284 
	mbuæ’
;

285 
	m¡©
;

286 
»que¡_£n£
 *
	m£n£
;

287 
	md©a_dœeùiÚ
;

288 
	mqu›t
;

289 
	mtimeout
;

290 *
	m»£rved
[1];

328 
	#CD_MINS
 74

	)

329 
	#CD_SECS
 60

	)

330 
	#CD_FRAMES
 75

	)

331 
	#CD_SYNC_SIZE
 12

	)

332 
	#CD_MSF_OFFSET
 150

	)

333 
	#CD_CHUNK_SIZE
 24

	)

334 
	#CD_NUM_OF_CHUNKS
 98

	)

335 
	#CD_FRAMESIZE_SUB
 96

	)

336 
	#CD_HEAD_SIZE
 4

	)

337 
	#CD_SUBHEAD_SIZE
 8

	)

338 
	#CD_EDC_SIZE
 4

	)

339 
	#CD_ZERO_SIZE
 8

	)

340 
	#CD_ECC_SIZE
 276

	)

341 
	#CD_FRAMESIZE
 2048

	)

342 
	#CD_FRAMESIZE_RAW
 2352

	)

343 
	#CD_FRAMESIZE_RAWER
 2646

	)

345 
	#CD_FRAMESIZE_RAW1
 (
CD_FRAMESIZE_RAW
-
CD_SYNC_SIZE
è

	)

346 
	#CD_FRAMESIZE_RAW0
 (
CD_FRAMESIZE_RAW
-
CD_SYNC_SIZE
-
CD_HEAD_SIZE
è

	)

348 
	#CD_XA_HEAD
 (
CD_HEAD_SIZE
+
CD_SUBHEAD_SIZE
è

	)

349 
	#CD_XA_TAIL
 (
CD_EDC_SIZE
+
CD_ECC_SIZE
è

	)

350 
	#CD_XA_SYNC_HEAD
 (
CD_SYNC_SIZE
+
CD_XA_HEAD
è

	)

353 
	#CDROM_LBA
 0x01

	)

354 
	#CDROM_MSF
 0x02

	)

357 
	#CDROM_DATA_TRACK
 0x04

	)

360 
	#CDROM_LEADOUT
 0xAA

	)

363 
	#CDROM_AUDIO_INVALID
 0x00

	)

364 
	#CDROM_AUDIO_PLAY
 0x11

	)

365 
	#CDROM_AUDIO_PAUSED
 0x12

	)

366 
	#CDROM_AUDIO_COMPLETED
 0x13

	)

367 
	#CDROM_AUDIO_ERROR
 0x14

	)

368 
	#CDROM_AUDIO_NO_STATUS
 0x15

	)

371 
	#CDC_CLOSE_TRAY
 0x1

	)

372 
	#CDC_OPEN_TRAY
 0x2

	)

373 
	#CDC_LOCK
 0x4

	)

374 
	#CDC_SELECT_SPEED
 0x8

	)

375 
	#CDC_SELECT_DISC
 0x10

	)

376 
	#CDC_MULTI_SESSION
 0x20

	)

377 
	#CDC_MCN
 0x40

	)

378 
	#CDC_MEDIA_CHANGED
 0x80

	)

379 
	#CDC_PLAY_AUDIO
 0x100

	)

380 
	#CDC_RESET
 0x200

	)

381 
	#CDC_DRIVE_STATUS
 0x800

	)

382 
	#CDC_GENERIC_PACKET
 0x1000

	)

383 
	#CDC_CD_R
 0x2000

	)

384 
	#CDC_CD_RW
 0x4000

	)

385 
	#CDC_DVD
 0x8000

	)

386 
	#CDC_DVD_R
 0x10000

	)

387 
	#CDC_DVD_RAM
 0x20000

	)

388 
	#CDC_MO_DRIVE
 0x40000

	)

389 
	#CDC_MRW
 0x80000

	)

390 
	#CDC_MRW_W
 0x100000

	)

391 
	#CDC_RAM
 0x200000

	)

394 
	#CDS_NO_INFO
 0

	)

395 
	#CDS_NO_DISC
 1

	)

396 
	#CDS_TRAY_OPEN
 2

	)

397 
	#CDS_DRIVE_NOT_READY
 3

	)

398 
	#CDS_DISC_OK
 4

	)

402 
	#CDS_AUDIO
 100

	)

403 
	#CDS_DATA_1
 101

	)

404 
	#CDS_DATA_2
 102

	)

405 
	#CDS_XA_2_1
 103

	)

406 
	#CDS_XA_2_2
 104

	)

407 
	#CDS_MIXED
 105

	)

410 
	#CDO_AUTO_CLOSE
 0x1

	)

411 
	#CDO_AUTO_EJECT
 0x2

	)

412 
	#CDO_USE_FFLAGS
 0x4

	)

413 
	#CDO_LOCK
 0x8

	)

414 
	#CDO_CHECK_TYPE
 0x10

	)

417 
	#CDSL_NONE
 (
INT_MAX
-1)

	)

418 
	#CDSL_CURRENT
 
INT_MAX


	)

425 
	#CD_PART_MAX
 64

	)

426 
	#CD_PART_MASK
 (
CD_PART_MAX
 - 1)

	)

434 
	#GPCMD_BLANK
 0xa1

	)

435 
	#GPCMD_CLOSE_TRACK
 0x5b

	)

436 
	#GPCMD_FLUSH_CACHE
 0x35

	)

437 
	#GPCMD_FORMAT_UNIT
 0x04

	)

438 
	#GPCMD_GET_CONFIGURATION
 0x46

	)

439 
	#GPCMD_GET_EVENT_STATUS_NOTIFICATION
 0x4a

	)

440 
	#GPCMD_GET_PERFORMANCE
 0xac

	)

441 
	#GPCMD_INQUIRY
 0x12

	)

442 
	#GPCMD_LOAD_UNLOAD
 0xa6

	)

443 
	#GPCMD_MECHANISM_STATUS
 0xbd

	)

444 
	#GPCMD_MODE_SELECT_10
 0x55

	)

445 
	#GPCMD_MODE_SENSE_10
 0x5a

	)

446 
	#GPCMD_PAUSE_RESUME
 0x4b

	)

447 
	#GPCMD_PLAY_AUDIO_10
 0x45

	)

448 
	#GPCMD_PLAY_AUDIO_MSF
 0x47

	)

449 
	#GPCMD_PLAY_AUDIO_TI
 0x48

	)

450 
	#GPCMD_PLAY_CD
 0xbc

	)

451 
	#GPCMD_PREVENT_ALLOW_MEDIUM_REMOVAL
 0x1e

	)

452 
	#GPCMD_READ_10
 0x28

	)

453 
	#GPCMD_READ_12
 0xa8

	)

454 
	#GPCMD_READ_BUFFER
 0x3c

	)

455 
	#GPCMD_READ_BUFFER_CAPACITY
 0x5c

	)

456 
	#GPCMD_READ_CDVD_CAPACITY
 0x25

	)

457 
	#GPCMD_READ_CD
 0xbe

	)

458 
	#GPCMD_READ_CD_MSF
 0xb9

	)

459 
	#GPCMD_READ_DISC_INFO
 0x51

	)

460 
	#GPCMD_READ_DVD_STRUCTURE
 0xad

	)

461 
	#GPCMD_READ_FORMAT_CAPACITIES
 0x23

	)

462 
	#GPCMD_READ_HEADER
 0x44

	)

463 
	#GPCMD_READ_TRACK_RZONE_INFO
 0x52

	)

464 
	#GPCMD_READ_SUBCHANNEL
 0x42

	)

465 
	#GPCMD_READ_TOC_PMA_ATIP
 0x43

	)

466 
	#GPCMD_REPAIR_RZONE_TRACK
 0x58

	)

467 
	#GPCMD_REPORT_KEY
 0xa4

	)

468 
	#GPCMD_REQUEST_SENSE
 0x03

	)

469 
	#GPCMD_RESERVE_RZONE_TRACK
 0x53

	)

470 
	#GPCMD_SEND_CUE_SHEET
 0x5d

	)

471 
	#GPCMD_SCAN
 0xba

	)

472 
	#GPCMD_SEEK
 0x2b

	)

473 
	#GPCMD_SEND_DVD_STRUCTURE
 0xbf

	)

474 
	#GPCMD_SEND_EVENT
 0xa2

	)

475 
	#GPCMD_SEND_KEY
 0xa3

	)

476 
	#GPCMD_SEND_OPC
 0x54

	)

477 
	#GPCMD_SET_READ_AHEAD
 0xa7

	)

478 
	#GPCMD_SET_STREAMING
 0xb6

	)

479 
	#GPCMD_START_STOP_UNIT
 0x1b

	)

480 
	#GPCMD_STOP_PLAY_SCAN
 0x4e

	)

481 
	#GPCMD_TEST_UNIT_READY
 0x00

	)

482 
	#GPCMD_VERIFY_10
 0x2f

	)

483 
	#GPCMD_WRITE_10
 0x2a

	)

484 
	#GPCMD_WRITE_12
 0x¯

	)

485 
	#GPCMD_WRITE_AND_VERIFY_10
 0x2e

	)

486 
	#GPCMD_WRITE_BUFFER
 0x3b

	)

491 
	#GPCMD_SET_SPEED
 0xbb

	)

494 
	#GPCMD_PLAYAUDIO_TI
 0x48

	)

499 
	#GPCMD_GET_MEDIA_STATUS
 0xda

	)

502 
	#GPMODE_VENDOR_PAGE
 0x00

	)

503 
	#GPMODE_R_W_ERROR_PAGE
 0x01

	)

504 
	#GPMODE_WRITE_PARMS_PAGE
 0x05

	)

505 
	#GPMODE_WCACHING_PAGE
 0x08

	)

506 
	#GPMODE_AUDIO_CTL_PAGE
 0x0e

	)

507 
	#GPMODE_POWER_PAGE
 0x1a

	)

508 
	#GPMODE_FAULT_FAIL_PAGE
 0x1c

	)

509 
	#GPMODE_TO_PROTECT_PAGE
 0x1d

	)

510 
	#GPMODE_CAPABILITIES_PAGE
 0x2a

	)

511 
	#GPMODE_ALL_PAGES
 0x3f

	)

514 
	#GPMODE_CDROM_PAGE
 0x0d

	)

519 
	#DVD_STRUCT_PHYSICAL
 0x00

	)

520 
	#DVD_STRUCT_COPYRIGHT
 0x01

	)

521 
	#DVD_STRUCT_DISCKEY
 0x02

	)

522 
	#DVD_STRUCT_BCA
 0x03

	)

523 
	#DVD_STRUCT_MANUFACT
 0x04

	)

525 
	sdvd_Ïy”
 {

526 
__u8
 
	mbook_v”siÚ
 : 4;

527 
__u8
 
	mbook_ty³
 : 4;

528 
__u8
 
	mmš_¿‹
 : 4;

529 
__u8
 
	mdisc_size
 : 4;

530 
__u8
 
	mÏy”_ty³
 : 4;

531 
__u8
 
	mŒack_·th
 : 1;

532 
__u8
 
	mÆay”s
 : 2;

533 
__u8
 
	mŒack_d’s™y
 : 4;

534 
__u8
 
	mlš—r_d’s™y
 : 4;

535 
__u8
 
	mbÿ
 : 1;

536 
__u32
 
	m¡¬t_£ùÜ
;

537 
__u32
 
	m’d_£ùÜ
;

538 
__u32
 
	m’d_£ùÜ_l0
;

541 
	#DVD_LAYERS
 4

	)

543 
	sdvd_physiÿl
 {

544 
__u8
 
	mty³
;

545 
__u8
 
	mÏy”_num
;

546 
dvd_Ïy”
 
	mÏy”
[
DVD_LAYERS
];

549 
	sdvd_cİyright
 {

550 
__u8
 
	mty³
;

552 
__u8
 
	mÏy”_num
;

553 
__u8
 
	mı¡
;

554 
__u8
 
	mrmi
;

557 
	sdvd_disckey
 {

558 
__u8
 
	mty³
;

560 
	magid
 : 2;

561 
__u8
 
	mv®ue
[2048];

564 
	sdvd_bÿ
 {

565 
__u8
 
	mty³
;

567 
	mËn
;

568 
__u8
 
	mv®ue
[188];

571 
	sdvd_mªuçù
 {

572 
__u8
 
	mty³
;

574 
__u8
 
	mÏy”_num
;

575 
	mËn
;

576 
__u8
 
	mv®ue
[2048];

580 
__u8
 
	mty³
;

582 
dvd_physiÿl
 
	mphysiÿl
;

583 
dvd_cİyright
 
	mcİyright
;

584 
dvd_disckey
 
	mdisckey
;

585 
dvd_bÿ
 
	mbÿ
;

586 
dvd_mªuçù
 
	mmªuçù
;

587 } 
	tdvd_¡ruù
;

594 
	#DVD_LU_SEND_AGID
 0

	)

595 
	#DVD_HOST_SEND_CHALLENGE
 1

	)

596 
	#DVD_LU_SEND_KEY1
 2

	)

597 
	#DVD_LU_SEND_CHALLENGE
 3

	)

598 
	#DVD_HOST_SEND_KEY2
 4

	)

601 
	#DVD_AUTH_ESTABLISHED
 5

	)

602 
	#DVD_AUTH_FAILURE
 6

	)

605 
	#DVD_LU_SEND_TITLE_KEY
 7

	)

606 
	#DVD_LU_SEND_ASF
 8

	)

607 
	#DVD_INVALIDATE_AGID
 9

	)

608 
	#DVD_LU_SEND_RPC_STATE
 10

	)

609 
	#DVD_HOST_SEND_RPC_STATE
 11

	)

612 
__u8
 
	tdvd_key
[5];

613 
__u8
 
	tdvd_ch®Ënge
[10];

615 
	sdvd_lu_£nd_agid
 {

616 
__u8
 
	mty³
;

617 
	magid
 : 2;

620 
	sdvd_ho¡_£nd_ch®Ënge
 {

621 
__u8
 
	mty³
;

622 
	magid
 : 2;

624 
dvd_ch®Ënge
 
	mch®
;

627 
	sdvd_£nd_key
 {

628 
__u8
 
	mty³
;

629 
	magid
 : 2;

631 
dvd_key
 
	mkey
;

634 
	sdvd_lu_£nd_ch®Ënge
 {

635 
__u8
 
	mty³
;

636 
	magid
 : 2;

638 
dvd_ch®Ënge
 
	mch®
;

641 
	#DVD_CPM_NO_COPYRIGHT
 0

	)

642 
	#DVD_CPM_COPYRIGHTED
 1

	)

644 
	#DVD_CP_SEC_NONE
 0

	)

645 
	#DVD_CP_SEC_EXIST
 1

	)

647 
	#DVD_CGMS_UNRESTRICTED
 0

	)

648 
	#DVD_CGMS_SINGLE
 2

	)

649 
	#DVD_CGMS_RESTRICTED
 3

	)

651 
	sdvd_lu_£nd_t™Ë_key
 {

652 
__u8
 
	mty³
;

653 
	magid
 : 2;

655 
dvd_key
 
	mt™Ë_key
;

656 
	mlba
;

657 
	mım
 : 1;

658 
	mı_£c
 : 1;

659 
	mcgms
 : 2;

662 
	sdvd_lu_£nd_asf
 {

663 
__u8
 
	mty³
;

664 
	magid
 : 2;

666 
	masf
 : 1;

669 
	sdvd_ho¡_£nd_½c¡©e
 {

670 
__u8
 
	mty³
;

671 
__u8
 
	mpdrc
;

674 
	sdvd_lu_£nd_½c¡©e
 {

675 
__u8
 
	mty³
 : 2;

676 
__u8
 
	mv¿
 : 3;

677 
__u8
 
	mucÿ
 : 3;

678 
__u8
 
	m»giÚ_mask
;

679 
__u8
 
	m½c_scheme
;

683 
__u8
 
	mty³
;

685 
dvd_lu_£nd_agid
 
	ml§
;

686 
dvd_ho¡_£nd_ch®Ënge
 
	mhsc
;

687 
dvd_£nd_key
 
	mlsk
;

688 
dvd_lu_£nd_ch®Ënge
 
	mlsc
;

689 
dvd_£nd_key
 
	mhsk
;

690 
dvd_lu_£nd_t™Ë_key
 
	ml¡k
;

691 
dvd_lu_£nd_asf
 
	ml§sf
;

692 
dvd_ho¡_£nd_½c¡©e
 
	mh½cs
;

693 
dvd_lu_£nd_½c¡©e
 
	mÌpcs
;

694 } 
	tdvd_authšfo
;

696 
	s»que¡_£n£
 {

697 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

698 
__u8
 
	mv®id
 : 1;

699 
__u8
 
	m”rÜ_code
 : 7;

700 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

701 
__u8
 
	m”rÜ_code
 : 7;

702 
__u8
 
	mv®id
 : 1;

704 
__u8
 
	m£gm’t_numb”
;

705 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

706 
__u8
 
	m»£rved1
 : 2;

707 
__u8
 
	mi
 : 1;

708 
__u8
 
	m»£rved2
 : 1;

709 
__u8
 
	m£n£_key
 : 4;

710 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

711 
__u8
 
	m£n£_key
 : 4;

712 
__u8
 
	m»£rved2
 : 1;

713 
__u8
 
	mi
 : 1;

714 
__u8
 
	m»£rved1
 : 2;

716 
__u8
 
	mšfÜm©iÚ
[4];

717 
__u8
 
	madd_£n£_Ën
;

718 
__u8
 
	mcommªd_šfo
[4];

719 
__u8
 
	masc
;

720 
__u8
 
	mascq
;

721 
__u8
 
	mäuc
;

722 
__u8
 
	msks
[3];

723 
__u8
 
	masb
[46];

729 
	#CDF_RWRT
 0x0020

	)

730 
	#CDF_HWDM
 0x0024

	)

731 
	#CDF_MRW
 0x0028

	)

736 
	#CDM_MRW_NOTMRW
 0

	)

737 
	#CDM_MRW_BGFORMAT_INACTIVE
 1

	)

738 
	#CDM_MRW_BGFORMAT_ACTIVE
 2

	)

739 
	#CDM_MRW_BGFORMAT_COMPLETE
 3

	)

744 
	#MRW_LBA_DMA
 0

	)

745 
	#MRW_LBA_GAA
 1

	)

751 
	#MRW_MODE_PC_PRE1
 0x2c

	)

752 
	#MRW_MODE_PC
 0x03

	)

754 
	smrw_ã©u»_desc
 {

755 
__be16
 
	mã©u»_code
;

756 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

757 
__u8
 
	m»£rved1
 : 2;

758 
__u8
 
	mã©u»_v”siÚ
 : 4;

759 
__u8
 
	m³rsi¡’t
 : 1;

760 
__u8
 
	mcu¼
 : 1;

761 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

762 
__u8
 
	mcu¼
 : 1;

763 
__u8
 
	m³rsi¡’t
 : 1;

764 
__u8
 
	mã©u»_v”siÚ
 : 4;

765 
__u8
 
	m»£rved1
 : 2;

767 
__u8
 
	madd_Ën
;

768 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

769 
__u8
 
	m»£rved2
 : 7;

770 
__u8
 
	mwr™e
 : 1;

771 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

772 
__u8
 
	mwr™e
 : 1;

773 
__u8
 
	m»£rved2
 : 7;

775 
__u8
 
	m»£rved3
;

776 
__u8
 
	m»£rved4
;

777 
__u8
 
	m»£rved5
;

781 
	srw¹_ã©u»_desc
 {

782 
__be16
 
	mã©u»_code
;

783 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

784 
__u8
 
	m»£rved1
 : 2;

785 
__u8
 
	mã©u»_v”siÚ
 : 4;

786 
__u8
 
	m³rsi¡’t
 : 1;

787 
__u8
 
	mcu¼
 : 1;

788 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

789 
__u8
 
	mcu¼
 : 1;

790 
__u8
 
	m³rsi¡’t
 : 1;

791 
__u8
 
	mã©u»_v”siÚ
 : 4;

792 
__u8
 
	m»£rved1
 : 2;

794 
__u8
 
	madd_Ën
;

795 
__u32
 
	mÏ¡_lba
;

796 
__u32
 
	mblock_size
;

797 
__u16
 
	mblockšg
;

798 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

799 
__u8
 
	m»£rved2
 : 7;

800 
__u8
 
	m·ge_´e£Á
 : 1;

801 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

802 
__u8
 
	m·ge_´e£Á
 : 1;

803 
__u8
 
	m»£rved2
 : 7;

805 
__u8
 
	m»£rved3
;

809 
__be16
 
	mdisc_šfÜm©iÚ_Ëngth
;

810 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

811 
__u8
 
	m»£rved1
 : 3;

812 
__u8
 
	m”a§bË
 : 1;

813 
__u8
 
	mbÜd”_¡©us
 : 2;

814 
__u8
 
	mdisc_¡©us
 : 2;

815 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

816 
__u8
 
	mdisc_¡©us
 : 2;

817 
__u8
 
	mbÜd”_¡©us
 : 2;

818 
__u8
 
	m”a§bË
 : 1;

819 
__u8
 
	m»£rved1
 : 3;

823 
__u8
 
	mn_fœ¡_Œack
;

824 
__u8
 
	mn_£ssiÚs_lsb
;

825 
__u8
 
	mfœ¡_Œack_lsb
;

826 
__u8
 
	mÏ¡_Œack_lsb
;

827 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

828 
__u8
 
	mdid_v
 : 1;

829 
__u8
 
	mdbc_v
 : 1;

830 
__u8
 
	muru
 : 1;

831 
__u8
 
	m»£rved2
 : 2;

832 
__u8
 
	mdb™
 : 1;

833 
__u8
 
	mmrw_¡©us
 : 2;

834 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

835 
__u8
 
	mmrw_¡©us
 : 2;

836 
__u8
 
	mdb™
 : 1;

837 
__u8
 
	m»£rved2
 : 2;

838 
__u8
 
	muru
 : 1;

839 
__u8
 
	mdbc_v
 : 1;

840 
__u8
 
	mdid_v
 : 1;

842 
__u8
 
	mdisc_ty³
;

843 
__u8
 
	mn_£ssiÚs_msb
;

844 
__u8
 
	mfœ¡_Œack_msb
;

845 
__u8
 
	mÏ¡_Œack_msb
;

846 
__u32
 
	mdisc_id
;

847 
__u32
 
	mËad_š
;

848 
__u32
 
	mËad_out
;

849 
__u8
 
	mdisc_b¬_code
[8];

850 
__u8
 
	m»£rved3
;

851 
__u8
 
	mn_İc
;

852 } 
	tdisc_šfÜm©iÚ
;

855 
__be16
 
	mŒack_šfÜm©iÚ_Ëngth
;

856 
__u8
 
	mŒack_lsb
;

857 
__u8
 
	m£ssiÚ_lsb
;

858 
__u8
 
	m»£rved1
;

859 #ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

860 
__u8
 
	m»£rved2
 : 2;

861 
__u8
 
	mdamage
 : 1;

862 
__u8
 
	mcİy
 : 1;

863 
__u8
 
	mŒack_mode
 : 4;

864 
__u8
 
	m¹
 : 1;

865 
__u8
 
	mbÏnk
 : 1;

866 
__u8
 
	m·ck‘
 : 1;

867 
__u8
 
	må
 : 1;

868 
__u8
 
	md©a_mode
 : 4;

869 
__u8
 
	m»£rved3
 : 6;

870 
__u8
 
	mÌa_v
 : 1;

871 
__u8
 
	mnwa_v
 : 1;

872 #–ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

873 
__u8
 
	mŒack_mode
 : 4;

874 
__u8
 
	mcİy
 : 1;

875 
__u8
 
	mdamage
 : 1;

876 
__u8
 
	m»£rved2
 : 2;

877 
__u8
 
	md©a_mode
 : 4;

878 
__u8
 
	må
 : 1;

879 
__u8
 
	m·ck‘
 : 1;

880 
__u8
 
	mbÏnk
 : 1;

881 
__u8
 
	m¹
 : 1;

882 
__u8
 
	mnwa_v
 : 1;

883 
__u8
 
	mÌa_v
 : 1;

884 
__u8
 
	m»£rved3
 : 6;

886 
__be32
 
	mŒack_¡¬t
;

887 
__be32
 
	mÃxt_wr™abË
;

888 
__be32
 
	mä“_blocks
;

889 
__be32
 
	mfixed_·ck‘_size
;

890 
__be32
 
	mŒack_size
;

891 
__be32
 
	mÏ¡_»c_add»ss
;

892 } 
	tŒack_šfÜm©iÚ
;

894 
	sã©u»_h—d”
 {

895 
__u32
 
	md©a_Ën
;

896 
__u8
 
	m»£rved1
;

897 
__u8
 
	m»£rved2
;

898 
__u16
 
	mcu¼_´ofe
;

901 
	smode_·ge_h—d”
 {

902 
__be16
 
	mmode_d©a_Ëngth
;

903 
__u8
 
	mmedium_ty³
;

904 
__u8
 
	m»£rved1
;

905 
__u8
 
	m»£rved2
;

906 
__u8
 
	m»£rved3
;

907 
__be16
 
	mdesc_Ëngth
;

	@/usr/include/linux/fd.h

1 #iâdeà
_LINUX_FD_H


2 
	#_LINUX_FD_H


	)

4 
	~<lšux/ioùl.h
>

13 
	sæİpy_¡ruù
 {

14 
	msize
,

15 
	m£ù
,

16 
	mh—d
,

17 
	mŒack
,

18 
	m¡»tch
;

22 
	#FD_STRETCH
 1

	)

23 
	#FD_SWAPSIDES
 2

	)

24 
	#FD_ZEROBASED
 4

	)

25 
	#FD_SECTBASEMASK
 0x3FC

	)

26 
	#FD_MKSECTBASE
(
s
è(((sè^ 1è<< 2)

	)

27 
	#FD_SECTBASE
(
æİpy
è((((æİpy)->
¡»tch
 & 
FD_SECTBASEMASK
è>> 2è^ 1)

	)

29 
	mg­
,

31 
	m¿‹
,

32 
	#FD_2M
 0x4

	)

33 
	#FD_SIZECODEMASK
 0x38

	)

34 
	#FD_SIZECODE
(
æİpy
è(((((æİpy)->
¿‹
&
FD_SIZECODEMASK
)>> 3)+ 2è%8)

	)

35 
	#FD_SECTSIZE
(
æİpy
èĞ(æİpy)->
¿‹
 & 
FD_2M
 ? \

36 512 : 128 << 
	`FD_SIZECODE
(
æİpy
è)

	)

37 
	#FD_PERP
 0x40

	)

39 
	m¥ec1
,

40 
	mfmt_g­
;

41 cÚ¡ * 
	mÇme
;

48 
	#FDCLRPRM
 
	`_IO
(2, 0x41)

	)

51 
	#FDSETPRM
 
	`_IOW
(2, 0x42, 
æİpy_¡ruù
)

	)

52 
	#FDSETMEDIAPRM
 
FDSETPRM


	)

55 
	#FDDEFPRM
 
	`_IOW
(2, 0x43, 
æİpy_¡ruù
)

	)

56 
	#FDGETPRM
 
	`_IOR
(2, 0x04, 
æİpy_¡ruù
)

	)

57 
	#FDDEFMEDIAPRM
 
FDDEFPRM


	)

58 
	#FDGETMEDIAPRM
 
FDGETPRM


	)

62 
	#FDMSGON
 
	`_IO
(2,0x45)

	)

63 
	#FDMSGOFF
 
	`_IO
(2,0x46)

	)

70 
	#FD_FILL_BYTE
 0xF6

	)

72 
	sfÜm©_desü
 {

73 
	mdeviû
,
	mh—d
,
	mŒack
;

76 
	#FDFMTBEG
 
	`_IO
(2,0x47)

	)

78 
	#FDFMTTRK
 
	`_IOW
(2,0x48, 
fÜm©_desü
)

	)

80 
	#FDFMTEND
 
	`_IO
(2,0x49)

	)

87 
	sæİpy_max_”rÜs
 {

89 
	mabÜt
,

90 
	m»ad_Œack
,

92 
	m»£t
,

93 
	m»ÿl
,

101 
	m»pÜtšg
;

105 
	#FDSETEMSGTRESH
 
	`_IO
(2,0x4a)

	)

108 
	#FDFLUSH
 
	`_IO
(2,0x4b)

	)

112 
	#FDSETMAXERRS
 
	`_IOW
(2, 0x4c, 
æİpy_max_”rÜs
)

	)

113 
	#FDGETMAXERRS
 
	`_IOR
(2, 0x0e, 
æİpy_max_”rÜs
)

	)

118 
	tæİpy_drive_Çme
[16];

119 
	#FDGETDRVTYP
 
	`_IOR
(2, 0x0f, 
æİpy_drive_Çme
)

	)

126 
	sæİpy_drive_·¿ms
 {

127 sigÃd 
	mcmos
;

132 
	mmax_dŒ
;

133 
	mhÉ
;

134 
	mhut
;

136 
	m¤t
;

138 
	m¥šup
;

140 
	m¥šdown
;

141 
	m¥šdown_off£t
;

143 
	m£Ëù_d–ay
;

144 
	m½s
;

145 
	mŒacks
;

146 
	mtimeout
;

148 
	mš‹¾—ve_£ù
;

151 
æİpy_max_”rÜs
 
	mmax_”rÜs
;

153 
	mæags
;

160 
	#FTD_MSG
 0x10

	)

161 
	#FD_BROKEN_DCL
 0x20

	)

162 
	#FD_DEBUG
 0x02

	)

163 
	#FD_SILENT_DCL_CLEAR
 0x4

	)

164 
	#FD_INVERTED_DCL
 0x80

	)

167 
	m»ad_Œack
;

174 
	mautod‘eù
[8];

176 
	mcheckäeq
;

178 
	mÇtive_fÜm©
;

182 
	mFD_NEED_TWADDLE_BIT
,

183 
	mFD_VERIFY_BIT
,

184 
	mFD_DISK_NEWCHANGE_BIT
,

186 
	mFD_UNUSED_BIT
,

187 
	mFD_DISK_CHANGED_BIT
,

188 
	mFD_DISK_WRITABLE_BIT


191 
	#FDSETDRVPRM
 
	`_IOW
(2, 0x90, 
æİpy_drive_·¿ms
)

	)

192 
	#FDGETDRVPRM
 
	`_IOR
(2, 0x11, 
æİpy_drive_·¿ms
)

	)

199 
	sæİpy_drive_¡ruù
 {

200 
	mæags
;

202 
	#FD_NEED_TWADDLE
 (1 << 
FD_NEED_TWADDLE_BIT
)

	)

203 
	#FD_VERIFY
 (1 << 
FD_VERIFY_BIT
)

	)

204 
	#FD_DISK_NEWCHANGE
 (1 << 
FD_DISK_NEWCHANGE_BIT
)

	)

205 
	#FD_DISK_CHANGED
 (1 << 
FD_DISK_CHANGED_BIT
)

	)

206 
	#FD_DISK_WRITABLE
 (1 << 
FD_DISK_WRITABLE_BIT
)

	)

208 
	m¥šup_d©e
;

209 
	m£Ëù_d©e
;

210 
	mfœ¡_»ad_d©e
;

211 
	m´obed_fÜm©
;

212 
	mŒack
;

213 
	mmaxblock
;

214 
	mmaxŒack
;

215 
	mg’”©iÚ
;

222 
	mk“p_d©a
;

225 
	mfd_»f
;

226 
	mfd_deviû
;

227 
	mÏ¡_checked
;

230 *
	mdmabuf
;

231 
	mbufblocks
;

234 
	#FDGETDRVSTAT
 
	`_IOR
(2, 0x12, 
æİpy_drive_¡ruù
)

	)

235 
	#FDPOLLDRVSTAT
 
	`_IOR
(2, 0x13, 
æİpy_drive_¡ruù
)

	)

242 
	e»£t_mode
 {

243 
	mFD_RESET_IF_NEEDED
,

244 
	mFD_RESET_IF_RAWCMD
,

245 
	mFD_RESET_ALWAYS


247 
	#FDRESET
 
	`_IO
(2, 0x54)

	)

253 
	sæİpy_fdc_¡©e
 {

254 
	m¥ec1
;

255 
	m¥ec2
;

256 
	mdŒ
;

257 
	mv”siÚ
;

258 
	mdÜ
;

259 
	madd»ss
;

260 
	m¿wcmd
:2;

261 
	m»£t
:1;

262 
	mÃed_cÚfigu»
:1;

263 
	m³½_mode
:2;

264 
	mhas_fifo
:1;

265 
	mdriv”_v”siÚ
;

266 
	#FD_DRIVER_VERSION
 0x100

	)

274 
	mŒack
[4];

285 
	#FDGETFDCSTAT
 
	`_IOR
(2, 0x15, 
æİpy_fdc_¡©e
)

	)

291 
	sæİpy_wr™e_”rÜs
 {

300 
	mwr™e_”rÜs
;

304 
	mfœ¡_”rÜ_£ùÜ
;

305 
	mfœ¡_”rÜ_g’”©iÚ
;

306 
	mÏ¡_”rÜ_£ùÜ
;

307 
	mÏ¡_”rÜ_g’”©iÚ
;

309 
	mbadÃss
;

313 
	#FDWERRORCLR
 
	`_IO
(2, 0x56)

	)

315 
	#FDWERRORGET
 
	`_IOR
(2, 0x17, 
æİpy_wr™e_”rÜs
)

	)

323 
	#FDHAVEBATCHEDRAWCMD


	)

325 
	sæİpy_¿w_cmd
 {

326 
	mæags
;

327 
	#FD_RAW_READ
 1

	)

328 
	#FD_RAW_WRITE
 2

	)

329 
	#FD_RAW_NO_MOTOR
 4

	)

330 
	#FD_RAW_DISK_CHANGE
 4

	)

331 
	#FD_RAW_INTR
 8

	)

332 
	#FD_RAW_SPIN
 0x10

	)

333 
	#FD_RAW_NO_MOTOR_AFTER
 0x20

	)

335 
	#FD_RAW_NEED_DISK
 0x40

	)

336 
	#FD_RAW_NEED_SEEK
 0x80

	)

339 
	#FD_RAW_MORE
 0x100

	)

340 
	#FD_RAW_STOP_IF_FAILURE
 0x200

	)

341 
	#FD_RAW_STOP_IF_SUCCESS
 0x400

	)

342 
	#FD_RAW_SOFTFAILURE
 0x800

	)

346 
	#FD_RAW_FAILURE
 0x10000

	)

347 
	#FD_RAW_HARDFAILURE
 0x20000

	)

349 *
	md©a
;

350 *
	mk”Ãl_d©a
;

351 
æİpy_¿w_cmd
 *
	mÃxt
;

353 
	mËngth
;

354 
	mphys_Ëngth
;

355 
	mbufãr_Ëngth
;

357 
	m¿‹
;

358 
	mcmd_couÁ
;

359 
	mcmd
[16];

360 
	m»¶y_couÁ
;

361 
	m»¶y
[16];

362 
	mŒack
;

363 
	m»suÉcode
;

365 
	m»£rved1
;

366 
	m»£rved2
;

369 
	#FDRAWCMD
 
	`_IO
(2, 0x58)

	)

373 
	#FDTWADDLE
 
	`_IO
(2, 0x59)

	)

377 
	#FDEJECT
 
	`_IO
(2, 0x5a)

	)

	@/usr/include/linux/fs.h

1 #iâdeà
_LINUX_FS_H


2 
	#_LINUX_FS_H


	)

9 
	~<lšux/lim™s.h
>

10 
	~<lšux/ioùl.h
>

23 #undeà
NR_OPEN


24 
sysùl_Ä_İ’
;

25 
	#INR_OPEN
 1024

	)

27 
	#BLOCK_SIZE_BITS
 10

	)

28 
	#BLOCK_SIZE
 (1<<
BLOCK_SIZE_BITS
)

	)

30 
	#SEEK_SET
 0

	)

31 
	#SEEK_CUR
 1

	)

32 
	#SEEK_END
 2

	)

33 
	#SEEK_MAX
 
SEEK_END


	)

36 
	sfes_¡©_¡ruù
 {

37 
	mÄ_fes
;

38 
	mÄ_ä“_fes
;

39 
	mmax_fes
;

41 
fes_¡©_¡ruù
 
fes_¡©
;

42 
g‘_max_fes
();

44 
	sšodes_¡©_t
 {

45 
	mÄ_šodes
;

46 
	mÄ_unu£d
;

47 
	mdummy
[5];

49 
šodes_¡©_t
 
šodes_¡©
;

51 
Ëa£s_’abË
, 
Ëa£_b»ak_time
;

53 #ifdeà
CONFIG_DNOTIFY


54 
dœ_nÙify_’abË
;

57 
	#NR_FILE
 8192

	)

59 
	#MAY_EXEC
 1

	)

60 
	#MAY_WRITE
 2

	)

61 
	#MAY_READ
 4

	)

62 
	#MAY_APPEND
 8

	)

63 
	#MAY_ACCESS
 16

	)

64 
	#MAY_OPEN
 32

	)

72 
	#FMODE_READ
 ((
fmode_t
)1)

	)

74 
	#FMODE_WRITE
 ((
fmode_t
)2)

	)

76 
	#FMODE_LSEEK
 ((
fmode_t
)4)

	)

78 
	#FMODE_PREAD
 ((
fmode_t
)8)

	)

80 
	#FMODE_PWRITE
 ((
fmode_t
)16)

	)

82 
	#FMODE_EXEC
 ((
fmode_t
)32)

	)

84 
	#FMODE_NDELAY
 ((
fmode_t
)64)

	)

86 
	#FMODE_EXCL
 ((
fmode_t
)128)

	)

89 
	#FMODE_WRITE_IOCTL
 ((
fmode_t
)256)

	)

91 
	#RW_MASK
 1

	)

92 
	#RWA_MASK
 2

	)

93 
	#READ
 0

	)

94 
	#WRITE
 1

	)

95 
	#READA
 2

	)

96 
	#SWRITE
 3

	)

97 
	#READ_SYNC
 (
READ
 | (1 << 
BIO_RW_SYNC
))

	)

98 
	#READ_META
 (
READ
 | (1 << 
BIO_RW_META
))

	)

99 
	#WRITE_SYNC
 (
WRITE
 | (1 << 
BIO_RW_SYNC
))

	)

100 
	#SWRITE_SYNC
 (
SWRITE
 | (1 << 
BIO_RW_SYNC
))

	)

101 
	#WRITE_BARRIER
 (
WRITE
 | (1 << 
BIO_RW_BARRIER
))

	)

102 
	#DISCARD_NOBARRIER
 (1 << 
BIO_RW_DISCARD
)

	)

103 
	#DISCARD_BARRIER
 ((1 << 
BIO_RW_DISCARD
è| (1 << 
BIO_RW_BARRIER
))

	)

105 
	#SEL_IN
 1

	)

106 
	#SEL_OUT
 2

	)

107 
	#SEL_EX
 4

	)

110 
	#FS_REQUIRES_DEV
 1

	)

111 
	#FS_BINARY_MOUNTDATA
 2

	)

112 
	#FS_HAS_SUBTYPE
 4

	)

113 
	#FS_REVAL_DOT
 16384

	)

114 
	#FS_RENAME_DOES_D_MOVE
 32768

	)

121 
	#MS_RDONLY
 1

	)

122 
	#MS_NOSUID
 2

	)

123 
	#MS_NODEV
 4

	)

124 
	#MS_NOEXEC
 8

	)

125 
	#MS_SYNCHRONOUS
 16

	)

126 
	#MS_REMOUNT
 32

	)

127 
	#MS_MANDLOCK
 64

	)

128 
	#MS_DIRSYNC
 128

	)

129 
	#MS_NOATIME
 1024

	)

130 
	#MS_NODIRATIME
 2048

	)

131 
	#MS_BIND
 4096

	)

132 
	#MS_MOVE
 8192

	)

133 
	#MS_REC
 16384

	)

134 
	#MS_VERBOSE
 32768

	)

136 
	#MS_SILENT
 32768

	)

137 
	#MS_POSIXACL
 (1<<16è

	)

138 
	#MS_UNBINDABLE
 (1<<17è

	)

139 
	#MS_PRIVATE
 (1<<18è

	)

140 
	#MS_SLAVE
 (1<<19è

	)

141 
	#MS_SHARED
 (1<<20è

	)

142 
	#MS_RELATIME
 (1<<21è

	)

143 
	#MS_KERNMOUNT
 (1<<22è

	)

144 
	#MS_I_VERSION
 (1<<23è

	)

145 
	#MS_ACTIVE
 (1<<30)

	)

146 
	#MS_NOUSER
 (1<<31)

	)

151 
	#MS_RMT_MASK
 (
MS_RDONLY
|
MS_SYNCHRONOUS
|
MS_MANDLOCK
|
MS_I_VERSION
)

	)

156 
	#MS_MGC_VAL
 0xC0ED0000

	)

157 
	#MS_MGC_MSK
 0xffff0000

	)

161 
	#S_SYNC
 1

	)

162 
	#S_NOATIME
 2

	)

163 
	#S_APPEND
 4

	)

164 
	#S_IMMUTABLE
 8

	)

165 
	#S_DEAD
 16

	)

166 
	#S_NOQUOTA
 32

	)

167 
	#S_DIRSYNC
 64

	)

168 
	#S_NOCMTIME
 128

	)

169 
	#S_SWAPFILE
 256

	)

170 
	#S_PRIVATE
 512

	)

185 
	#__IS_FLG
(
šode
,
æg
è((šode)->
i_sb
->
s_æags
 & (æg))

	)

187 
	#IS_RDONLY
(
šode
è((šode)->
i_sb
->
s_æags
 & 
MS_RDONLY
)

	)

188 
	#IS_SYNC
(
šode
è(
	`__IS_FLG
(šode, 
MS_SYNCHRONOUS
) || \

189 ((
šode
)->
i_æags
 & 
S_SYNC
))

	)

190 
	#IS_DIRSYNC
(
šode
è(
	`__IS_FLG
(šode, 
MS_SYNCHRONOUS
|
MS_DIRSYNC
) || \

191 ((
šode
)->
i_æags
 & (
S_SYNC
|
S_DIRSYNC
)))

	)

192 
	#IS_MANDLOCK
(
šode
è
	`__IS_FLG
(šode, 
MS_MANDLOCK
)

	)

193 
	#IS_NOATIME
(
šode
è
	`__IS_FLG
(šode, 
MS_RDONLY
|
MS_NOATIME
)

	)

194 
	#IS_I_VERSION
(
šode
è
	`__IS_FLG
(šode, 
MS_I_VERSION
)

	)

196 
	#IS_NOQUOTA
(
šode
è((šode)->
i_æags
 & 
S_NOQUOTA
)

	)

197 
	#IS_APPEND
(
šode
è((šode)->
i_æags
 & 
S_APPEND
)

	)

198 
	#IS_IMMUTABLE
(
šode
è((šode)->
i_æags
 & 
S_IMMUTABLE
)

	)

199 
	#IS_POSIXACL
(
šode
è
	`__IS_FLG
(šode, 
MS_POSIXACL
)

	)

201 
	#IS_DEADDIR
(
šode
è((šode)->
i_æags
 & 
S_DEAD
)

	)

202 
	#IS_NOCMTIME
(
šode
è((šode)->
i_æags
 & 
S_NOCMTIME
)

	)

203 
	#IS_SWAPFILE
(
šode
è((šode)->
i_æags
 & 
S_SWAPFILE
)

	)

204 
	#IS_PRIVATE
(
šode
è((šode)->
i_æags
 & 
S_PRIVATE
)

	)

209 
	#BLKROSET
 
	`_IO
(0x12,93è

	)

210 
	#BLKROGET
 
	`_IO
(0x12,94è

	)

211 
	#BLKRRPART
 
	`_IO
(0x12,95è

	)

212 
	#BLKGETSIZE
 
	`_IO
(0x12,96è

	)

213 
	#BLKFLSBUF
 
	`_IO
(0x12,97è

	)

214 
	#BLKRASET
 
	`_IO
(0x12,98è

	)

215 
	#BLKRAGET
 
	`_IO
(0x12,99è

	)

216 
	#BLKFRASET
 
	`_IO
(0x12,100)

	)

217 
	#BLKFRAGET
 
	`_IO
(0x12,101)

	)

218 
	#BLKSECTSET
 
	`_IO
(0x12,102)

	)

219 
	#BLKSECTGET
 
	`_IO
(0x12,103)

	)

220 
	#BLKSSZGET
 
	`_IO
(0x12,104)

	)

222 
	#BLKPG
 
	`_IO
(0x12,105)

	)

226 
	#BLKELVGET
 
	`_IOR
(0x12,106,
size_t
)

	)

227 
	#BLKELVSET
 
	`_IOW
(0x12,107,
size_t
)

	)

232 
	#BLKBSZGET
 
	`_IOR
(0x12,112,
size_t
)

	)

233 
	#BLKBSZSET
 
	`_IOW
(0x12,113,
size_t
)

	)

234 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
è

	)

235 
	#BLKTRACESETUP
 
	`_IOWR
(0x12,115,
blk_u£r_Œaû_£tup
)

	)

236 
	#BLKTRACESTART
 
	`_IO
(0x12,116)

	)

237 
	#BLKTRACESTOP
 
	`_IO
(0x12,117)

	)

238 
	#BLKTRACETEARDOWN
 
	`_IO
(0x12,118)

	)

239 
	#BLKDISCARD
 
	`_IO
(0x12,119)

	)

241 
	#BMAP_IOCTL
 1

	)

242 
	#FIBMAP
 
	`_IO
(0x00,1è

	)

243 
	#FIGETBSZ
 
	`_IO
(0x00,2è

	)

245 
	#FS_IOC_GETFLAGS
 
	`_IOR
('f', 1, )

	)

246 
	#FS_IOC_SETFLAGS
 
	`_IOW
('f', 2, )

	)

247 
	#FS_IOC_GETVERSION
 
	`_IOR
('v', 1, )

	)

248 
	#FS_IOC_SETVERSION
 
	`_IOW
('v', 2, )

	)

249 
	#FS_IOC_FIEMAP
 
	`_IOWR
('f', 11, 
f›m­
)

	)

250 
	#FS_IOC32_GETFLAGS
 
	`_IOR
('f', 1, )

	)

251 
	#FS_IOC32_SETFLAGS
 
	`_IOW
('f', 2, )

	)

252 
	#FS_IOC32_GETVERSION
 
	`_IOR
('v', 1, )

	)

253 
	#FS_IOC32_SETVERSION
 
	`_IOW
('v', 2, )

	)

258 
	#FS_SECRM_FL
 0x00000001

	)

259 
	#FS_UNRM_FL
 0x00000002

	)

260 
	#FS_COMPR_FL
 0x00000004

	)

261 
	#FS_SYNC_FL
 0x00000008

	)

262 
	#FS_IMMUTABLE_FL
 0x00000010

	)

263 
	#FS_APPEND_FL
 0x00000020

	)

264 
	#FS_NODUMP_FL
 0x00000040

	)

265 
	#FS_NOATIME_FL
 0x00000080

	)

267 
	#FS_DIRTY_FL
 0x00000100

	)

268 
	#FS_COMPRBLK_FL
 0x00000200

	)

269 
	#FS_NOCOMP_FL
 0x00000400

	)

270 
	#FS_ECOMPR_FL
 0x00000800

	)

272 
	#FS_BTREE_FL
 0x00001000

	)

273 
	#FS_INDEX_FL
 0x00001000

	)

274 
	#FS_IMAGIC_FL
 0x00002000

	)

275 
	#FS_JOURNAL_DATA_FL
 0x00004000

	)

276 
	#FS_NOTAIL_FL
 0x00008000

	)

277 
	#FS_DIRSYNC_FL
 0x00010000

	)

278 
	#FS_TOPDIR_FL
 0x00020000

	)

279 
	#FS_EXTENT_FL
 0x00080000

	)

280 
	#FS_DIRECTIO_FL
 0x00100000

	)

281 
	#FS_RESERVED_FL
 0x80000000

	)

283 
	#FS_FL_USER_VISIBLE
 0x0003DFFF

	)

284 
	#FS_FL_USER_MODIFIABLE
 0x000380FF

	)

287 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

288 
	#SYNC_FILE_RANGE_WRITE
 2

	)

289 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

	@/usr/include/linux/hdreg.h

1 #iâdeà
_LINUX_HDREG_H


2 
	#_LINUX_HDREG_H


	)

5 
	~<lšux/ty³s.h
>

11 
	#HDIO_DRIVE_CMD_HDR_SIZE
 (4 * (
__u8
))

	)

12 
	#HDIO_DRIVE_HOB_HDR_SIZE
 (8 * (
__u8
))

	)

13 
	#HDIO_DRIVE_TASK_HDR_SIZE
 (8 * (
__u8
))

	)

15 
	#IDE_DRIVE_TASK_NO_DATA
 0

	)

16 
	#IDE_DRIVE_TASK_INVALID
 -1

	)

17 
	#IDE_DRIVE_TASK_SET_XFER
 1

	)

18 
	#IDE_DRIVE_TASK_IN
 2

	)

19 
	#IDE_DRIVE_TASK_OUT
 3

	)

20 
	#IDE_DRIVE_TASK_RAW_WRITE
 4

	)

25 
	#IDE_TASKFILE_STD_IN_FLAGS
 0xFE

	)

26 
	#IDE_HOB_STD_IN_FLAGS
 0x3C

	)

27 
	#IDE_TASKFILE_STD_OUT_FLAGS
 0xFE

	)

28 
	#IDE_HOB_STD_OUT_FLAGS
 0x3C

	)

30 
	tsk_iÜeg_t
;

31 
	t§_iÜeg_t
;

33 
	uide_»g_v®id_s
 {

34 
	m®l
 : 16;

36 
	md©a
 : 1;

37 
	m”rÜ_ã©u»
 : 1;

38 
	m£ùÜ
 : 1;

39 
	mn£ùÜ
 : 1;

40 
	mlcyl
 : 1;

41 
	mhcyl
 : 1;

42 
	m£Ëù
 : 1;

43 
	m¡©us_commªd
 : 1;

45 
	md©a_hob
 : 1;

46 
	m”rÜ_ã©u»_hob
 : 1;

47 
	m£ùÜ_hob
 : 1;

48 
	mn£ùÜ_hob
 : 1;

49 
	mlcyl_hob
 : 1;

50 
	mhcyl_hob
 : 1;

51 
	m£Ëù_hob
 : 1;

52 
	mcÚŒŞ_hob
 : 1;

53 } 
	mb
;

54 } 
	tide_»g_v®id_t
;

56 
	side_sk_»que¡_s
 {

57 
__u8
 
	mio_pÜts
[8];

58 
__u8
 
	mhob_pÜts
[8];

59 
ide_»g_v®id_t
 
	mout_æags
;

60 
ide_»g_v®id_t
 
	mš_æags
;

61 
	md©a_pha£
;

62 
	m»q_cmd
;

63 
	mout_size
;

64 
	mš_size
;

65 } 
	tide_sk_»que¡_t
;

67 
	side_ioùl_»que¡_s
 {

68 
ide_sk_»que¡_t
 *
	msk_»que¡
;

69 *
	mout_bufãr
;

70 *
	mš_bufãr
;

71 } 
	tide_ioùl_»que¡_t
;

73 
	shd_drive_cmd_hdr
 {

74 
__u8
 
	mcommªd
;

75 
__u8
 
	m£ùÜ_numb”
;

76 
__u8
 
	mã©u»
;

77 
__u8
 
	m£ùÜ_couÁ
;

80 
	shd_drive_sk_hdr
 {

81 
__u8
 
	md©a
;

82 
__u8
 
	mã©u»
;

83 
__u8
 
	m£ùÜ_couÁ
;

84 
__u8
 
	m£ùÜ_numb”
;

85 
__u8
 
	mlow_cylšd”
;

86 
__u8
 
	mhigh_cylšd”
;

87 
__u8
 
	mdeviû_h—d
;

88 
__u8
 
	mcommªd
;

89 } 
	tsk_¡ruù_t
;

91 
	shd_drive_hob_hdr
 {

92 
__u8
 
	md©a
;

93 
__u8
 
	mã©u»
;

94 
__u8
 
	m£ùÜ_couÁ
;

95 
__u8
 
	m£ùÜ_numb”
;

96 
__u8
 
	mlow_cylšd”
;

97 
__u8
 
	mhigh_cylšd”
;

98 
__u8
 
	mdeviû_h—d
;

99 
__u8
 
	mcÚŒŞ
;

100 } 
	thob_¡ruù_t
;

102 
	#TASKFILE_NO_DATA
 0x0000

	)

104 
	#TASKFILE_IN
 0x0001

	)

105 
	#TASKFILE_MULTI_IN
 0x0002

	)

107 
	#TASKFILE_OUT
 0x0004

	)

108 
	#TASKFILE_MULTI_OUT
 0x0008

	)

109 
	#TASKFILE_IN_OUT
 0x0010

	)

111 
	#TASKFILE_IN_DMA
 0x0020

	)

112 
	#TASKFILE_OUT_DMA
 0x0040

	)

113 
	#TASKFILE_IN_DMAQ
 0x0080

	)

114 
	#TASKFILE_OUT_DMAQ
 0x0100

	)

116 
	#TASKFILE_P_IN
 0x0200

	)

117 
	#TASKFILE_P_OUT
 0x0400

	)

118 
	#TASKFILE_P_IN_DMA
 0x0800

	)

119 
	#TASKFILE_P_OUT_DMA
 0x1000

	)

120 
	#TASKFILE_P_IN_DMAQ
 0x2000

	)

121 
	#TASKFILE_P_OUT_DMAQ
 0x4000

	)

122 
	#TASKFILE_48
 0x8000

	)

123 
	#TASKFILE_INVALID
 0x7fff

	)

126 
	#WIN_NOP
 0x00

	)

130 
	#CFA_REQ_EXT_ERROR_CODE
 0x03

	)

134 
	#WIN_SRST
 0x08

	)

135 
	#WIN_DEVICE_RESET
 0x08

	)

139 
	#WIN_RECAL
 0x10

	)

140 
	#WIN_RESTORE
 
WIN_RECAL


	)

144 
	#WIN_READ
 0x20

	)

145 
	#WIN_READ_ONCE
 0x21

	)

146 
	#WIN_READ_LONG
 0x22

	)

147 
	#WIN_READ_LONG_ONCE
 0x23

	)

148 
	#WIN_READ_EXT
 0x24

	)

149 
	#WIN_READDMA_EXT
 0x25

	)

150 
	#WIN_READDMA_QUEUED_EXT
 0x26

	)

151 
	#WIN_READ_NATIVE_MAX_EXT
 0x27

	)

155 
	#WIN_MULTREAD_EXT
 0x29

	)

159 
	#WIN_WRITE
 0x30

	)

160 
	#WIN_WRITE_ONCE
 0x31

	)

161 
	#WIN_WRITE_LONG
 0x32

	)

162 
	#WIN_WRITE_LONG_ONCE
 0x33

	)

163 
	#WIN_WRITE_EXT
 0x34

	)

164 
	#WIN_WRITEDMA_EXT
 0x35

	)

165 
	#WIN_WRITEDMA_QUEUED_EXT
 0x36

	)

166 
	#WIN_SET_MAX_EXT
 0x37

	)

167 
	#CFA_WRITE_SECT_WO_ERASE
 0x38

	)

168 
	#WIN_MULTWRITE_EXT
 0x39

	)

172 
	#WIN_WRITE_VERIFY
 0x3C

	)

176 
	#WIN_VERIFY
 0x40

	)

177 
	#WIN_VERIFY_ONCE
 0x41

	)

178 
	#WIN_VERIFY_EXT
 0x42

	)

182 
	#WIN_FORMAT
 0x50

	)

186 
	#WIN_INIT
 0x60

	)

190 
	#WIN_SEEK
 0x70

	)

192 
	#CFA_TRANSLATE_SECTOR
 0x87

	)

193 
	#WIN_DIAGNOSE
 0x90

	)

194 
	#WIN_SPECIFY
 0x91

	)

195 
	#WIN_DOWNLOAD_MICROCODE
 0x92

	)

196 
	#WIN_STANDBYNOW2
 0x94

	)

197 
	#WIN_STANDBY2
 0x96

	)

198 
	#WIN_SETIDLE2
 0x97

	)

199 
	#WIN_CHECKPOWERMODE2
 0x98

	)

200 
	#WIN_SLEEPNOW2
 0x99

	)

204 
	#WIN_PACKETCMD
 0xA0

	)

205 
	#WIN_PIDENTIFY
 0xA1

	)

206 
	#WIN_QUEUED_SERVICE
 0xA2

	)

207 
	#WIN_SMART
 0xB0

	)

208 
	#CFA_ERASE_SECTORS
 0xC0

	)

209 
	#WIN_MULTREAD
 0xC4

	)

210 
	#WIN_MULTWRITE
 0xC5

	)

211 
	#WIN_SETMULT
 0xC6

	)

212 
	#WIN_READDMA_QUEUED
 0xC7

	)

213 
	#WIN_READDMA
 0xC8

	)

214 
	#WIN_READDMA_ONCE
 0xC9

	)

215 
	#WIN_WRITEDMA
 0xCA

	)

216 
	#WIN_WRITEDMA_ONCE
 0xCB

	)

217 
	#WIN_WRITEDMA_QUEUED
 0xCC

	)

218 
	#CFA_WRITE_MULTI_WO_ERASE
 0xCD

	)

219 
	#WIN_GETMEDIASTATUS
 0xDA

	)

220 
	#WIN_ACKMEDIACHANGE
 0xDB

	)

221 
	#WIN_POSTBOOT
 0xDC

	)

222 
	#WIN_PREBOOT
 0xDD

	)

223 
	#WIN_DOORLOCK
 0xDE

	)

224 
	#WIN_DOORUNLOCK
 0xDF

	)

225 
	#WIN_STANDBYNOW1
 0xE0

	)

226 
	#WIN_IDLEIMMEDIATE
 0xE1

	)

227 
	#WIN_STANDBY
 0xE2

	)

228 
	#WIN_SETIDLE1
 0xE3

	)

229 
	#WIN_READ_BUFFER
 0xE4

	)

230 
	#WIN_CHECKPOWERMODE1
 0xE5

	)

231 
	#WIN_SLEEPNOW1
 0xE6

	)

232 
	#WIN_FLUSH_CACHE
 0xE7

	)

233 
	#WIN_WRITE_BUFFER
 0xE8

	)

234 
	#WIN_WRITE_SAME
 0xE9

	)

236 
	#WIN_FLUSH_CACHE_EXT
 0xEA

	)

237 
	#WIN_IDENTIFY
 0xEC

	)

238 
	#WIN_MEDIAEJECT
 0xED

	)

239 
	#WIN_IDENTIFY_DMA
 0xEE

	)

240 
	#WIN_SETFEATURES
 0xEF

	)

241 
	#EXABYTE_ENABLE_NEST
 0xF0

	)

242 
	#WIN_SECURITY_SET_PASS
 0xF1

	)

243 
	#WIN_SECURITY_UNLOCK
 0xF2

	)

244 
	#WIN_SECURITY_ERASE_PREPARE
 0xF3

	)

245 
	#WIN_SECURITY_ERASE_UNIT
 0xF4

	)

246 
	#WIN_SECURITY_FREEZE_LOCK
 0xF5

	)

247 
	#WIN_SECURITY_DISABLE
 0xF6

	)

248 
	#WIN_READ_NATIVE_MAX
 0xF8

	)

249 
	#WIN_SET_MAX
 0xF9

	)

250 
	#DISABLE_SEAGATE
 0xFB

	)

254 
	#SMART_READ_VALUES
 0xD0

	)

255 
	#SMART_READ_THRESHOLDS
 0xD1

	)

256 
	#SMART_AUTOSAVE
 0xD2

	)

257 
	#SMART_SAVE
 0xD3

	)

258 
	#SMART_IMMEDIATE_OFFLINE
 0xD4

	)

259 
	#SMART_READ_LOG_SECTOR
 0xD5

	)

260 
	#SMART_WRITE_LOG_SECTOR
 0xD6

	)

261 
	#SMART_WRITE_THRESHOLDS
 0xD7

	)

262 
	#SMART_ENABLE
 0xD8

	)

263 
	#SMART_DISABLE
 0xD9

	)

264 
	#SMART_STATUS
 0xDA

	)

265 
	#SMART_AUTO_OFFLINE
 0xDB

	)

269 
	#SMART_LCYL_PASS
 0x4F

	)

270 
	#SMART_HCYL_PASS
 0xC2

	)

273 
	#SETFEATURES_EN_8BIT
 0x01

	)

274 
	#SETFEATURES_EN_WCACHE
 0x02

	)

275 
	#SETFEATURES_DIS_DEFECT
 0x04

	)

276 
	#SETFEATURES_EN_APM
 0x05

	)

277 
	#SETFEATURES_EN_SAME_R
 0x22

	)

278 
	#SETFEATURES_DIS_MSN
 0x31

	)

279 
	#SETFEATURES_DIS_RETRY
 0x33

	)

280 
	#SETFEATURES_EN_AAM
 0x42

	)

281 
	#SETFEATURES_RW_LONG
 0x44

	)

282 
	#SETFEATURES_SET_CACHE
 0x54

	)

283 
	#SETFEATURES_DIS_RLA
 0x55

	)

284 
	#SETFEATURES_EN_RI
 0x5D

	)

285 
	#SETFEATURES_EN_SI
 0x5E

	)

286 
	#SETFEATURES_DIS_RPOD
 0x66

	)

287 
	#SETFEATURES_DIS_ECC
 0x77

	)

288 
	#SETFEATURES_DIS_8BIT
 0x81

	)

289 
	#SETFEATURES_DIS_WCACHE
 0x82

	)

290 
	#SETFEATURES_EN_DEFECT
 0x84

	)

291 
	#SETFEATURES_DIS_APM
 0x85

	)

292 
	#SETFEATURES_EN_ECC
 0x88

	)

293 
	#SETFEATURES_EN_MSN
 0x95

	)

294 
	#SETFEATURES_EN_RETRY
 0x99

	)

295 
	#SETFEATURES_EN_RLA
 0xAA

	)

296 
	#SETFEATURES_PREFETCH
 0xAB

	)

297 
	#SETFEATURES_EN_REST
 0xAC

	)

298 
	#SETFEATURES_4B_RW_LONG
 0xBB

	)

299 
	#SETFEATURES_DIS_AAM
 0xC2

	)

300 
	#SETFEATURES_EN_RPOD
 0xCC

	)

301 
	#SETFEATURES_DIS_RI
 0xDD

	)

302 
	#SETFEATURES_EN_SAME_M
 0xDD

	)

303 
	#SETFEATURES_DIS_SI
 0xDE

	)

307 
	#SECURITY_SET_PASSWORD
 0xBA

	)

308 
	#SECURITY_UNLOCK
 0xBB

	)

309 
	#SECURITY_ERASE_PREPARE
 0xBC

	)

310 
	#SECURITY_ERASE_UNIT
 0xBD

	)

311 
	#SECURITY_FREEZE_LOCK
 0xBE

	)

312 
	#SECURITY_DISABLE_PASSWORD
 0xBF

	)

314 
	shd_geom‘ry
 {

315 
	mh—ds
;

316 
	m£ùÜs
;

317 
	mcylšd”s
;

318 
	m¡¬t
;

322 
	#HDIO_GETGEO
 0x0301

	)

323 
	#HDIO_GET_UNMASKINTR
 0x0302

	)

324 
	#HDIO_GET_MULTCOUNT
 0x0304

	)

325 
	#HDIO_GET_QDMA
 0x0305

	)

327 
	#HDIO_SET_XFER
 0x0306

	)

329 
	#HDIO_OBSOLETE_IDENTITY
 0x0307

	)

330 
	#HDIO_GET_KEEPSETTINGS
 0x0308

	)

331 
	#HDIO_GET_32BIT
 0x0309

	)

332 
	#HDIO_GET_NOWERR
 0x030¨

	)

333 
	#HDIO_GET_DMA
 0x030b

	)

334 
	#HDIO_GET_NICE
 0x030ø

	)

335 
	#HDIO_GET_IDENTITY
 0x030d

	)

336 
	#HDIO_GET_WCACHE
 0x030

	)

337 
	#HDIO_GET_ACOUSTIC
 0x030à

	)

338 
	#HDIO_GET_ADDRESS
 0x0310

	)

340 
	#HDIO_GET_BUSSTATE
 0x031¨

	)

341 
	#HDIO_TRISTATE_HWIF
 0x031b

	)

342 
	#HDIO_DRIVE_RESET
 0x031ø

	)

343 
	#HDIO_DRIVE_TASKFILE
 0x031d

	)

344 
	#HDIO_DRIVE_TASK
 0x031

	)

345 
	#HDIO_DRIVE_CMD
 0x031à

	)

346 
	#HDIO_DRIVE_CMD_AEB
 
HDIO_DRIVE_TASK


	)

349 
	#HDIO_SET_MULTCOUNT
 0x0321

	)

350 
	#HDIO_SET_UNMASKINTR
 0x0322

	)

351 
	#HDIO_SET_KEEPSETTINGS
 0x0323

	)

352 
	#HDIO_SET_32BIT
 0x0324

	)

353 
	#HDIO_SET_NOWERR
 0x0325

	)

354 
	#HDIO_SET_DMA
 0x0326

	)

355 
	#HDIO_SET_PIO_MODE
 0x0327

	)

356 
	#HDIO_SCAN_HWIF
 0x0328

	)

357 
	#HDIO_UNREGISTER_HWIF
 0x032¨

	)

358 
	#HDIO_SET_NICE
 0x0329

	)

359 
	#HDIO_SET_WCACHE
 0x032b

	)

360 
	#HDIO_SET_ACOUSTIC
 0x032ø

	)

361 
	#HDIO_SET_BUSSTATE
 0x032d

	)

362 
	#HDIO_SET_QDMA
 0x032

	)

363 
	#HDIO_SET_ADDRESS
 0x032à

	)

367 
	mBUSSTATE_OFF
 = 0,

368 
	mBUSSTATE_ON
,

369 
	mBUSSTATE_TRISTATE


378 
	#__NEW_HD_DRIVE_ID


	)

386 
	shd_driveid
 {

387 
	mcÚfig
;

388 
	mcyls
;

389 
	m»£rved2
;

390 
	mh—ds
;

391 
	mŒack_by‹s
;

392 
	m£ùÜ_by‹s
;

393 
	m£ùÜs
;

394 
	mv’dÜ0
;

395 
	mv’dÜ1
;

396 
	mv’dÜ2
;

397 
	m£rŸl_no
[20];

398 
	mbuf_ty³
;

399 
	mbuf_size
;

402 
	mecc_by‹s
;

403 
	mfw_»v
[8];

404 
	mmod–
[40];

405 
	mmax_muÉ£ù
;

406 
	mv’dÜ3
;

407 
	mdwÜd_io
;

408 
	mv’dÜ4
;

409 
	mÿ·b™y
;

415 
	m»£rved50
;

416 
	mv’dÜ5
;

417 
	mtPIO
;

418 
	mv’dÜ6
;

419 
	mtDMA
;

420 
	mf›ld_v®id
;

425 
	mcur_cyls
;

426 
	mcur_h—ds
;

427 
	mcur_£ùÜs
;

428 
	mcur_ÿ·c™y0
;

429 
	mcur_ÿ·c™y1
;

430 
	mmuÉ£ù
;

431 
	mmuÉ£ù_v®id
;

432 
	mlba_ÿ·c™y
;

433 
	mdma_1wÜd
;

434 
	mdma_mwÜd
;

435 
	meide_pio_modes
;

436 
	meide_dma_mš
;

437 
	meide_dma_time
;

438 
	meide_pio
;

439 
	meide_pio_iÜdy
;

440 
	mwÜds69_70
[2];

444 
	mwÜds71_74
[4];

447 
	mqueue_d•th
;

451 
	mwÜds76_79
[4];

452 
	mmajÜ_»v_num
;

453 
	mmšÜ_»v_num
;

454 
	mcommªd_£t_1
;

472 
	mcommªd_£t_2
;

490 
	mcfs£
;

502 
	mcfs_’abË_1
;

521 
	mcfs_’abË_2
;

540 
	mcsf_deçuÉ
;

552 
	mdma_uÉ¿
;

553 
	mŒ£uc
;

554 
	mŒsEuc
;

555 
	mCurAPMv®ues
;

556 
	mm´c
;

557 
	mhw_cÚfig
;

575 
	macou¡ic
;

579 
	mm¤qs
;

580 
	msxã¹
;

581 
	m§l
;

582 
	m¥g
;

583 
	mlba_ÿ·c™y_2
;

584 
	mwÜds104_125
[22];

585 
	mÏ¡_lun
;

586 
	mwÜd127
;

594 
	mdlf
;

606 
	mcsfo
;

614 
	mwÜds130_155
[26];

615 
	mwÜd156
;

616 
	mwÜds157_159
[3];

617 
	mcç_pow”
;

624 
	mwÜds161_175
[15];

625 
	mwÜds176_205
[30];

626 
	mwÜds206_254
[49];

627 
	mš‹gr™y_wÜd
;

638 
	#IDE_NICE_DSC_OVERLAP
 (0è

	)

639 
	#IDE_NICE_ATAPI_OVERLAP
 (1è

	)

640 
	#IDE_NICE_1
 (3è

	)

641 
	#IDE_NICE_0
 (2è

	)

642 
	#IDE_NICE_2
 (4è

	)

	@/usr/include/linux/hiddev.h

1 #iâdeà
_HIDDEV_H


2 
	#_HIDDEV_H


	)

34 
	shiddev_ev’t
 {

35 
	mhid
;

36 sigÃd 
	mv®ue
;

39 
	shiddev_devšfo
 {

40 
__u32
 
	mbu¡y³
;

41 
__u32
 
	mbu¢um
;

42 
__u32
 
	mdevnum
;

43 
__u32
 
	miâum
;

44 
__s16
 
	mv’dÜ
;

45 
__s16
 
	m´oduù
;

46 
__s16
 
	mv”siÚ
;

47 
__u32
 
	mnum_­¶iÿtiÚs
;

50 
	shiddev_cŞËùiÚ_šfo
 {

51 
__u32
 
	mšdex
;

52 
__u32
 
	mty³
;

53 
__u32
 
	mu§ge
;

54 
__u32
 
	mËv–
;

57 
	#HID_STRING_SIZE
 256

	)

58 
	shiddev_¡ršg_desütÜ
 {

59 
__s32
 
	mšdex
;

60 
	mv®ue
[
HID_STRING_SIZE
];

63 
	shiddev_»pÜt_šfo
 {

64 
__u32
 
	m»pÜt_ty³
;

65 
__u32
 
	m»pÜt_id
;

66 
__u32
 
	mnum_f›lds
;

76 
	#HID_REPORT_ID_UNKNOWN
 0xffffffff

	)

77 
	#HID_REPORT_ID_FIRST
 0x00000100

	)

78 
	#HID_REPORT_ID_NEXT
 0x00000200

	)

79 
	#HID_REPORT_ID_MASK
 0x000000ff

	)

80 
	#HID_REPORT_ID_MAX
 0x000000ff

	)

82 
	#HID_REPORT_TYPE_INPUT
 1

	)

83 
	#HID_REPORT_TYPE_OUTPUT
 2

	)

84 
	#HID_REPORT_TYPE_FEATURE
 3

	)

85 
	#HID_REPORT_TYPE_MIN
 1

	)

86 
	#HID_REPORT_TYPE_MAX
 3

	)

88 
	shiddev_f›ld_šfo
 {

89 
__u32
 
	m»pÜt_ty³
;

90 
__u32
 
	m»pÜt_id
;

91 
__u32
 
	mf›ld_šdex
;

92 
__u32
 
	mmaxu§ge
;

93 
__u32
 
	mæags
;

94 
__u32
 
	mphysiÿl
;

95 
__u32
 
	mlogiÿl
;

96 
__u32
 
	m­¶iÿtiÚ
;

97 
__s32
 
	mlogiÿl_mšimum
;

98 
__s32
 
	mlogiÿl_maximum
;

99 
__s32
 
	mphysiÿl_mšimum
;

100 
__s32
 
	mphysiÿl_maximum
;

101 
__u32
 
	mun™_expÚ’t
;

102 
__u32
 
	mun™
;

108 
	#HID_FIELD_CONSTANT
 0x001

	)

109 
	#HID_FIELD_VARIABLE
 0x002

	)

110 
	#HID_FIELD_RELATIVE
 0x004

	)

111 
	#HID_FIELD_WRAP
 0x008

	)

112 
	#HID_FIELD_NONLINEAR
 0x010

	)

113 
	#HID_FIELD_NO_PREFERRED
 0x020

	)

114 
	#HID_FIELD_NULL_STATE
 0x040

	)

115 
	#HID_FIELD_VOLATILE
 0x080

	)

116 
	#HID_FIELD_BUFFERED_BYTE
 0x100

	)

118 
	shiddev_u§ge_»f
 {

119 
__u32
 
	m»pÜt_ty³
;

120 
__u32
 
	m»pÜt_id
;

121 
__u32
 
	mf›ld_šdex
;

122 
__u32
 
	mu§ge_šdex
;

123 
__u32
 
	mu§ge_code
;

124 
__s32
 
	mv®ue
;

129 
	#HID_MAX_MULTI_USAGES
 1024

	)

130 
	shiddev_u§ge_»f_muÉi
 {

131 
hiddev_u§ge_»f
 
	mu»f
;

132 
__u32
 
	mnum_v®ues
;

133 
__s32
 
	mv®ues
[
HID_MAX_MULTI_USAGES
];

140 
	#HID_FIELD_INDEX_NONE
 0xffffffff

	)

146 
	#HID_VERSION
 0x010004

	)

152 
	#HIDIOCGVERSION
 
	`_IOR
('H', 0x01, )

	)

153 
	#HIDIOCAPPLICATION
 
	`_IO
('H', 0x02)

	)

154 
	#HIDIOCGDEVINFO
 
	`_IOR
('H', 0x03, 
hiddev_devšfo
)

	)

155 
	#HIDIOCGSTRING
 
	`_IOR
('H', 0x04, 
hiddev_¡ršg_desütÜ
)

	)

156 
	#HIDIOCINITREPORT
 
	`_IO
('H', 0x05)

	)

157 
	#HIDIOCGNAME
(
Ën
è
	`_IOC
(
_IOC_READ
, 'H', 0x06,†’)

	)

158 
	#HIDIOCGREPORT
 
	`_IOW
('H', 0x07, 
hiddev_»pÜt_šfo
)

	)

159 
	#HIDIOCSREPORT
 
	`_IOW
('H', 0x08, 
hiddev_»pÜt_šfo
)

	)

160 
	#HIDIOCGREPORTINFO
 
	`_IOWR
('H', 0x09, 
hiddev_»pÜt_šfo
)

	)

161 
	#HIDIOCGFIELDINFO
 
	`_IOWR
('H', 0x0A, 
hiddev_f›ld_šfo
)

	)

162 
	#HIDIOCGUSAGE
 
	`_IOWR
('H', 0x0B, 
hiddev_u§ge_»f
)

	)

163 
	#HIDIOCSUSAGE
 
	`_IOW
('H', 0x0C, 
hiddev_u§ge_»f
)

	)

164 
	#HIDIOCGUCODE
 
	`_IOWR
('H', 0x0D, 
hiddev_u§ge_»f
)

	)

165 
	#HIDIOCGFLAG
 
	`_IOR
('H', 0x0E, )

	)

166 
	#HIDIOCSFLAG
 
	`_IOW
('H', 0x0F, )

	)

167 
	#HIDIOCGCOLLECTIONINDEX
 
	`_IOW
('H', 0x10, 
hiddev_u§ge_»f
)

	)

168 
	#HIDIOCGCOLLECTIONINFO
 
	`_IOWR
('H', 0x11, 
hiddev_cŞËùiÚ_šfo
)

	)

169 
	#HIDIOCGPHYS
(
Ën
è
	`_IOC
(
_IOC_READ
, 'H', 0x12,†’)

	)

172 
	#HIDIOCGUSAGES
 
	`_IOWR
('H', 0x13, 
hiddev_u§ge_»f_muÉi
)

	)

173 
	#HIDIOCSUSAGES
 
	`_IOW
('H', 0x14, 
hiddev_u§ge_»f_muÉi
)

	)

178 
	#HIDDEV_FLAG_UREF
 0x1

	)

179 
	#HIDDEV_FLAG_REPORT
 0x2

	)

180 
	#HIDDEV_FLAGS
 0x3

	)

	@/usr/include/linux/if.h

19 #iâdeà
_LINUX_IF_H


20 
	#_LINUX_IF_H


	)

22 
	~<lšux/ty³s.h
>

23 
	~<lšux/sock‘.h
>

26 
	#IFNAMSIZ
 16

	)

27 
	#IFALIASZ
 256

	)

28 
	~<lšux/hdlc/ioùl.h
>

31 
	#IFF_UP
 0x1

	)

32 
	#IFF_BROADCAST
 0x2

	)

33 
	#IFF_DEBUG
 0x4

	)

34 
	#IFF_LOOPBACK
 0x8

	)

35 
	#IFF_POINTOPOINT
 0x10

	)

36 
	#IFF_NOTRAILERS
 0x20

	)

37 
	#IFF_RUNNING
 0x40

	)

38 
	#IFF_NOARP
 0x80

	)

39 
	#IFF_PROMISC
 0x100

	)

40 
	#IFF_ALLMULTI
 0x200

	)

42 
	#IFF_MASTER
 0x400

	)

43 
	#IFF_SLAVE
 0x800

	)

45 
	#IFF_MULTICAST
 0x1000

	)

47 
	#IFF_PORTSEL
 0x2000

	)

48 
	#IFF_AUTOMEDIA
 0x4000

	)

49 
	#IFF_DYNAMIC
 0x8000

	)

51 
	#IFF_LOWER_UP
 0x10000

	)

52 
	#IFF_DORMANT
 0x20000

	)

54 
	#IFF_ECHO
 0x40000

	)

56 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

57 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

60 
	#IFF_802_1Q_VLAN
 0x1

	)

61 
	#IFF_EBRIDGE
 0x2

	)

62 
	#IFF_SLAVE_INACTIVE
 0x4

	)

63 
	#IFF_MASTER_8023AD
 0x8

	)

64 
	#IFF_MASTER_ALB
 0x10

	)

65 
	#IFF_BONDING
 0x20

	)

66 
	#IFF_SLAVE_NEEDARP
 0x40

	)

67 
	#IFF_ISATAP
 0x80

	)

69 
	#IF_GET_IFACE
 0x0001

	)

70 
	#IF_GET_PROTO
 0x0002

	)

73 
	#IF_IFACE_V35
 0x1000

	)

74 
	#IF_IFACE_V24
 0x1001

	)

75 
	#IF_IFACE_X21
 0x1002

	)

76 
	#IF_IFACE_T1
 0x1003

	)

77 
	#IF_IFACE_E1
 0x1004

	)

78 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

79 
	#IF_IFACE_X21D
 0x1006

	)

82 
	#IF_PROTO_HDLC
 0x2000

	)

83 
	#IF_PROTO_PPP
 0x2001

	)

84 
	#IF_PROTO_CISCO
 0x2002

	)

85 
	#IF_PROTO_FR
 0x2003

	)

86 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

87 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

88 
	#IF_PROTO_X25
 0x2006

	)

89 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

90 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

91 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

92 
	#IF_PROTO_FR_PVC
 0x200A

	)

93 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

94 
	#IF_PROTO_RAW
 0x200C

	)

98 
	mIF_OPER_UNKNOWN
,

99 
	mIF_OPER_NOTPRESENT
,

100 
	mIF_OPER_DOWN
,

101 
	mIF_OPER_LOWERLAYERDOWN
,

102 
	mIF_OPER_TESTING
,

103 
	mIF_OPER_DORMANT
,

104 
	mIF_OPER_UP
,

109 
	mIF_LINK_MODE_DEFAULT
,

110 
	mIF_LINK_MODE_DORMANT
,

123 
	sifm­


125 
	mmem_¡¬t
;

126 
	mmem_’d
;

127 
	mba£_addr
;

128 
	mœq
;

129 
	mdma
;

130 
	mpÜt
;

134 
	sif_£‰šgs


136 
	mty³
;

137 
	msize
;

140 
¿w_hdlc_´Ùo
 *
	m¿w_hdlc
;

141 
cisco_´Ùo
 *
	mcisco
;

142 
ä_´Ùo
 *
	mä
;

143 
ä_´Ùo_pvc
 *
	mä_pvc
;

144 
ä_´Ùo_pvc_šfo
 *
	mä_pvc_šfo
;

147 
sync_£rŸl_£‰šgs
 *
	msync
;

148 
‹1_£‰šgs
 *
	m‹1
;

149 } 
	mifs_ifsu
;

159 
	siäeq


161 
	#IFHWADDRLEN
 6

	)

164 
	miän_Çme
[
IFNAMSIZ
];

165 } 
	miä_iän
;

168 
sockaddr
 
	miäu_addr
;

169 
sockaddr
 
	miäu_d¡addr
;

170 
sockaddr
 
	miäu_brßdaddr
;

171 
sockaddr
 
	miäu_Ãtmask
;

172 
sockaddr
 
	miäu_hwaddr
;

173 
	miäu_æags
;

174 
	miäu_iv®ue
;

175 
	miäu_mtu
;

176 
ifm­
 
	miäu_m­
;

177 
	miäu_¦ave
[
IFNAMSIZ
];

178 
	miäu_ÃwÇme
[
IFNAMSIZ
];

179 * 
	miäu_d©a
;

180 
if_£‰šgs
 
	miäu_£‰šgs
;

181 } 
	miä_iäu
;

184 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

185 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

186 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

187 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

188 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

189 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

190 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

191 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

192 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

193 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

194 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

195 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

196 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

197 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

198 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

199 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

200 
	#iä_£‰šgs
 
iä_iäu
.
iäu_£‰šgs


	)

209 
	sifcÚf


211 
	mifc_Ën
;

214 *
	mifcu_buf
;

215 
iäeq
 *
	mifcu_»q
;

216 } 
	mifc_ifcu
;

218 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

219 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

	@/usr/include/linux/if_arp.h

23 #iâdeà
_LINUX_IF_ARP_H


24 
	#_LINUX_IF_ARP_H


	)

26 
	~<lšux/Ãtdeviû.h
>

29 
	#ARPHRD_NETROM
 0

	)

30 
	#ARPHRD_ETHER
 1

	)

31 
	#ARPHRD_EETHER
 2

	)

32 
	#ARPHRD_AX25
 3

	)

33 
	#ARPHRD_PRONET
 4

	)

34 
	#ARPHRD_CHAOS
 5

	)

35 
	#ARPHRD_IEEE802
 6

	)

36 
	#ARPHRD_ARCNET
 7

	)

37 
	#ARPHRD_APPLETLK
 8

	)

38 
	#ARPHRD_DLCI
 15

	)

39 
	#ARPHRD_ATM
 19

	)

40 
	#ARPHRD_METRICOM
 23

	)

41 
	#ARPHRD_IEEE1394
 24

	)

42 
	#ARPHRD_EUI64
 27

	)

43 
	#ARPHRD_INFINIBAND
 32

	)

46 
	#ARPHRD_SLIP
 256

	)

47 
	#ARPHRD_CSLIP
 257

	)

48 
	#ARPHRD_SLIP6
 258

	)

49 
	#ARPHRD_CSLIP6
 259

	)

50 
	#ARPHRD_RSRVD
 260

	)

51 
	#ARPHRD_ADAPT
 264

	)

52 
	#ARPHRD_ROSE
 270

	)

53 
	#ARPHRD_X25
 271

	)

54 
	#ARPHRD_HWX25
 272

	)

55 
	#ARPHRD_CAN
 280

	)

56 
	#ARPHRD_PPP
 512

	)

57 
	#ARPHRD_CISCO
 513

	)

58 
	#ARPHRD_HDLC
 
ARPHRD_CISCO


	)

59 
	#ARPHRD_LAPB
 516

	)

60 
	#ARPHRD_DDCMP
 517

	)

61 
	#ARPHRD_RAWHDLC
 518

	)

63 
	#ARPHRD_TUNNEL
 768

	)

64 
	#ARPHRD_TUNNEL6
 769

	)

65 
	#ARPHRD_FRAD
 770

	)

66 
	#ARPHRD_SKIP
 771

	)

67 
	#ARPHRD_LOOPBACK
 772

	)

68 
	#ARPHRD_LOCALTLK
 773

	)

69 
	#ARPHRD_FDDI
 774

	)

70 
	#ARPHRD_BIF
 775

	)

71 
	#ARPHRD_SIT
 776

	)

72 
	#ARPHRD_IPDDP
 777

	)

73 
	#ARPHRD_IPGRE
 778

	)

74 
	#ARPHRD_PIMREG
 779

	)

75 
	#ARPHRD_HIPPI
 780

	)

76 
	#ARPHRD_ASH
 781

	)

77 
	#ARPHRD_ECONET
 782

	)

78 
	#ARPHRD_IRDA
 783

	)

80 
	#ARPHRD_FCPP
 784

	)

81 
	#ARPHRD_FCAL
 785

	)

82 
	#ARPHRD_FCPL
 786

	)

83 
	#ARPHRD_FCFABRIC
 787

	)

85 
	#ARPHRD_IEEE802_TR
 800

	)

86 
	#ARPHRD_IEEE80211
 801

	)

87 
	#ARPHRD_IEEE80211_PRISM
 802

	)

88 
	#ARPHRD_IEEE80211_RADIOTAP
 803

	)

90 
	#ARPHRD_VOID
 0xFFFF

	)

91 
	#ARPHRD_NONE
 0xFFFE

	)

94 
	#ARPOP_REQUEST
 1

	)

95 
	#ARPOP_REPLY
 2

	)

96 
	#ARPOP_RREQUEST
 3

	)

97 
	#ARPOP_RREPLY
 4

	)

98 
	#ARPOP_InREQUEST
 8

	)

99 
	#ARPOP_InREPLY
 9

	)

100 
	#ARPOP_NAK
 10

	)

104 
	s¬´eq
 {

105 
sockaddr
 
	m¬p_·
;

106 
sockaddr
 
	m¬p_ha
;

107 
	m¬p_æags
;

108 
sockaddr
 
	m¬p_Ãtmask
;

109 
	m¬p_dev
[16];

112 
	s¬´eq_Şd
 {

113 
sockaddr
 
	m¬p_·
;

114 
sockaddr
 
	m¬p_ha
;

115 
	m¬p_æags
;

116 
sockaddr
 
	m¬p_Ãtmask
;

120 
	#ATF_COM
 0x02

	)

121 
	#ATF_PERM
 0x04

	)

122 
	#ATF_PUBL
 0x08

	)

123 
	#ATF_USETRAILERS
 0x10

	)

124 
	#ATF_NETMASK
 0x20

	)

126 
	#ATF_DONTPUB
 0x40

	)

132 
	s¬phdr


134 
__be16
 
	m¬_hrd
;

135 
__be16
 
	m¬_´o
;

136 
	m¬_hÊ
;

137 
	m¬_¶n
;

138 
__be16
 
	m¬_İ
;

144 
	m¬_sha
[
ETH_ALEN
];

145 
	m¬_s
[4];

146 
	m¬_tha
[
ETH_ALEN
];

147 
	m¬_t
[4];

	@/usr/include/linux/kdev_t.h

1 #iâdeà
_LINUX_KDEV_T_H


2 
	#_LINUX_KDEV_T_H


	)

8 
	#MAJOR
(
dev
è((dev)>>8)

	)

9 
	#MINOR
(
dev
è((devè& 0xff)

	)

10 
	#MKDEV
(
ma
,
mi
è((ma)<<8 | (mi))

	)

	@/usr/include/linux/pmu.h

10 
	#PMU_DRIVER_VERSION
 2

	)

15 
	#PMU_POWER_CTRL0
 0x10

	)

16 
	#PMU_POWER_CTRL
 0x11

	)

17 
	#PMU_ADB_CMD
 0x20

	)

18 
	#PMU_ADB_POLL_OFF
 0x21

	)

19 
	#PMU_WRITE_NVRAM
 0x33

	)

20 
	#PMU_READ_NVRAM
 0x3b

	)

21 
	#PMU_SET_RTC
 0x30

	)

22 
	#PMU_READ_RTC
 0x38

	)

23 
	#PMU_SET_VOLBUTTON
 0x40

	)

24 
	#PMU_BACKLIGHT_BRIGHT
 0x41

	)

25 
	#PMU_GET_VOLBUTTON
 0x48

	)

26 
	#PMU_PCEJECT
 0x4ø

	)

27 
	#PMU_BATTERY_STATE
 0x6b

	)

28 
	#PMU_SMART_BATTERY_STATE
 0x6à

	)

29 
	#PMU_SET_INTR_MASK
 0x70

	)

30 
	#PMU_INT_ACK
 0x78

	)

31 
	#PMU_SHUTDOWN
 0x7

	)

32 
	#PMU_CPU_SPEED
 0x7d

	)

33 
	#PMU_SLEEP
 0x7à

	)

34 
	#PMU_POWER_EVENTS
 0x8à

	)

35 
	#PMU_I2C_CMD
 0x9¨

	)

36 
	#PMU_RESET
 0xd0

	)

37 
	#PMU_GET_BRIGHTBUTTON
 0xd9

	)

38 
	#PMU_GET_COVER
 0xdø

	)

39 
	#PMU_SYSTEM_READY
 0xdà

	)

40 
	#PMU_GET_VERSION
 0x—

	)

43 
	#PMU_POW0_ON
 0x80

	)

44 
	#PMU_POW0_OFF
 0x00

	)

45 
	#PMU_POW0_HARD_DRIVE
 0x04

	)

48 
	#PMU_POW_ON
 0x80

	)

49 
	#PMU_POW_OFF
 0x00

	)

50 
	#PMU_POW_BACKLIGHT
 0x01

	)

51 
	#PMU_POW_CHARGER
 0x02

	)

52 
	#PMU_POW_IRLED
 0x04

	)

53 
	#PMU_POW_MEDIABAY
 0x08

	)

56 
	#PMU_INT_PCEJECT
 0x04

	)

57 
	#PMU_INT_SNDBRT
 0x08

	)

58 
	#PMU_INT_ADB
 0x10

	)

59 
	#PMU_INT_BATTERY
 0x20

	)

60 
	#PMU_INT_ENVIRONMENT
 0x40

	)

61 
	#PMU_INT_TICK
 0x80

	)

64 
	#PMU_INT_ADB_AUTO
 0x04

	)

65 
	#PMU_INT_WAITING_CHARGER
 0x01

	)

66 
	#PMU_INT_AUTO_SRQ_POLL
 0x02

	)

70 
	#PMU_ENV_LID_CLOSED
 0x01

	)

73 
	#PMU_I2C_MODE_SIMPLE
 0

	)

74 
	#PMU_I2C_MODE_STDSUB
 1

	)

75 
	#PMU_I2C_MODE_COMBINED
 2

	)

77 
	#PMU_I2C_BUS_STATUS
 0

	)

78 
	#PMU_I2C_BUS_SYSCLK
 1

	)

79 
	#PMU_I2C_BUS_POWER
 2

	)

81 
	#PMU_I2C_STATUS_OK
 0

	)

82 
	#PMU_I2C_STATUS_DATAREAD
 1

	)

83 
	#PMU_I2C_STATUS_BUSY
 0xã

	)

88 
	mPMU_UNKNOWN
,

89 
	mPMU_OHARE_BASED
,

90 
	mPMU_HEATHROW_BASED
,

91 
	mPMU_PADDINGTON_BASED
,

92 
	mPMU_KEYLARGO_BASED
,

93 
	mPMU_68K_V1
,

94 
	mPMU_68K_V2
,

99 
	mPMU_PWR_GET_POWERUP_EVENTS
 = 0x00,

100 
	mPMU_PWR_SET_POWERUP_EVENTS
 = 0x01,

101 
	mPMU_PWR_CLR_POWERUP_EVENTS
 = 0x02,

102 
	mPMU_PWR_GET_WAKEUP_EVENTS
 = 0x03,

103 
	mPMU_PWR_SET_WAKEUP_EVENTS
 = 0x04,

104 
	mPMU_PWR_CLR_WAKEUP_EVENTS
 = 0x05,

109 
	mPMU_PWR_WAKEUP_KEY
 = 0x01,

110 
	mPMU_PWR_WAKEUP_AC_INSERT
 = 0x02,

111 
	mPMU_PWR_WAKEUP_AC_CHANGE
 = 0x04,

112 
	mPMU_PWR_WAKEUP_LID_OPEN
 = 0x08,

113 
	mPMU_PWR_WAKEUP_RING
 = 0x10,

119 
	~<lšux/ioùl.h
>

122 
	#PMU_IOC_SLEEP
 
	`_IO
('B', 0)

	)

124 
	#PMU_IOC_GET_BACKLIGHT
 
	`_IOR
('B', 1, 
size_t
)

	)

126 
	#PMU_IOC_SET_BACKLIGHT
 
	`_IOW
('B', 2, 
size_t
)

	)

128 
	#PMU_IOC_GET_MODEL
 
	`_IOR
('B', 3, 
size_t
)

	)

130 
	#PMU_IOC_HAS_ADB
 
	`_IOR
('B', 4, 
size_t
)

	)

132 
	#PMU_IOC_CAN_SLEEP
 
	`_IOR
('B', 5, 
size_t
)

	)

134 
	#PMU_IOC_GRAB_BACKLIGHT
 
	`_IOR
('B', 6, 
size_t
)

	)

	@/usr/include/linux/serial.h

10 #iâdeà
_LINUX_SERIAL_H


11 
	#_LINUX_SERIAL_H


	)

13 
	~<lšux/ty³s.h
>

16 
	s£rŸl_¡ruù
 {

17 
	mty³
;

18 
	mlše
;

19 
	mpÜt
;

20 
	mœq
;

21 
	mæags
;

22 
	mxm™_fifo_size
;

23 
	mcu¡om_divisÜ
;

24 
	mbaud_ba£
;

25 
	mşo£_d–ay
;

26 
	mio_ty³
;

27 
	m»£rved_ch¬
[1];

28 
	mhub6
;

29 
	mşosšg_wa™
;

30 
	mşosšg_wa™2
;

31 *
	miomem_ba£
;

32 
	miomem_»g_shiá
;

33 
	mpÜt_high
;

34 
	miom­_ba£
;

41 
	#ASYNC_CLOSING_WAIT_INF
 0

	)

42 
	#ASYNC_CLOSING_WAIT_NONE
 65535

	)

47 
	#PORT_UNKNOWN
 0

	)

48 
	#PORT_8250
 1

	)

49 
	#PORT_16450
 2

	)

50 
	#PORT_16550
 3

	)

51 
	#PORT_16550A
 4

	)

52 
	#PORT_CIRRUS
 5

	)

53 
	#PORT_16650
 6

	)

54 
	#PORT_16650V2
 7

	)

55 
	#PORT_16750
 8

	)

56 
	#PORT_STARTECH
 9

	)

57 
	#PORT_16C950
 10

	)

58 
	#PORT_16654
 11

	)

59 
	#PORT_16850
 12

	)

60 
	#PORT_RSA
 13

	)

61 
	#PORT_MAX
 13

	)

63 
	#SERIAL_IO_PORT
 0

	)

64 
	#SERIAL_IO_HUB6
 1

	)

65 
	#SERIAL_IO_MEM
 2

	)

67 
	s£rŸl_u¬t_cÚfig
 {

68 *
	mÇme
;

69 
	mdæ_xm™_fifo_size
;

70 
	mæags
;

73 
	#UART_CLEAR_FIFO
 0x01

	)

74 
	#UART_USE_FIFO
 0x02

	)

75 
	#UART_STARTECH
 0x04

	)

76 
	#UART_NATSEMI
 0x08

	)

81 
	#ASYNC_HUP_NOTIFY
 0x0001

	)

83 
	#ASYNC_FOURPORT
 0x0002

	)

84 
	#ASYNC_SAK
 0x0004

	)

85 
	#ASYNC_SPLIT_TERMIOS
 0x0008

	)

87 
	#ASYNC_SPD_MASK
 0x1030

	)

88 
	#ASYNC_SPD_HI
 0x0010

	)

90 
	#ASYNC_SPD_VHI
 0x0020

	)

91 
	#ASYNC_SPD_CUST
 0x0030

	)

93 
	#ASYNC_SKIP_TEST
 0x0040

	)

94 
	#ASYNC_AUTO_IRQ
 0x0080

	)

95 
	#ASYNC_SESSION_LOCKOUT
 0x0100

	)

96 
	#ASYNC_PGRP_LOCKOUT
 0x0200

	)

97 
	#ASYNC_CALLOUT_NOHUP
 0x0400

	)

99 
	#ASYNC_HARDPPS_CD
 0x0800

	)

101 
	#ASYNC_SPD_SHI
 0x1000

	)

102 
	#ASYNC_SPD_WARP
 0x1010

	)

104 
	#ASYNC_LOW_LATENCY
 0x2000

	)

106 
	#ASYNC_BUGGY_UART
 0x4000

	)

109 
	#ASYNC_AUTOPROBE
 0x8000

	)

111 
	#ASYNC_FLAGS
 0x7FFF

	)

112 
	#ASYNC_USR_MASK
 0x3430

	)

116 
	#ASYNC_INITIALIZED
 0x80000000

	)

117 
	#ASYNC_NORMAL_ACTIVE
 0x20000000

	)

118 
	#ASYNC_BOOT_AUTOCONF
 0x10000000

	)

119 
	#ASYNC_CLOSING
 0x08000000

	)

120 
	#ASYNC_CTS_FLOW
 0x04000000

	)

121 
	#ASYNC_CHECK_CD
 0x02000000

	)

122 
	#ASYNC_SHARE_IRQ
 0x01000000

	)

124 
	#ASYNC_CONS_FLOW
 0x00800000

	)

126 
	#ASYNC_BOOT_ONLYMCA
 0x00400000

	)

127 
	#ASYNC_INTERNAL_FLAGS
 0xFFC00000

	)

132 
	s£rŸl_muÉÜt_¡ruù
 {

133 
	mœq
;

134 
	mpÜt1
;

135 
	mmask1
, 
	mm©ch1
;

136 
	mpÜt2
;

137 
	mmask2
, 
	mm©ch2
;

138 
	mpÜt3
;

139 
	mmask3
, 
	mm©ch3
;

140 
	mpÜt4
;

141 
	mmask4
, 
	mm©ch4
;

142 
	mpÜt_mÚ™Ü
;

143 
	m»£rved
[32];

150 
	s£rŸl_icouÁ”_¡ruù
 {

151 
	mùs
, 
	md¤
, 
	mºg
, 
	mdcd
;

152 
	mrx
, 
	mtx
;

153 
	mäame
, 
	mov”run
, 
	m·r™y
, 
	mbrk
;

154 
	mbuf_ov”run
;

155 
	m»£rved
[9];

165 
	s£rŸl_rs485
 {

166 
__u32
 
	mæags
;

167 
	#SER_RS485_ENABLED
 (1 << 0)

	)

168 
	#SER_RS485_RTS_ON_SEND
 (1 << 1)

	)

169 
	#SER_RS485_RTS_AFTER_SEND
 (1 << 2)

	)

170 
__u32
 
	md–ay_¹s_befÜe_£nd
;

171 
__u32
 
	m·ddšg
[6];

	@/usr/include/linux/sonypi.h

36 #iâdeà
_SONYPI_H_


37 
	#_SONYPI_H_


	)

39 
	~<lšux/ty³s.h
>

43 
	#SONYPI_EVENT_JOGDIAL_DOWN
 1

	)

44 
	#SONYPI_EVENT_JOGDIAL_UP
 2

	)

45 
	#SONYPI_EVENT_JOGDIAL_DOWN_PRESSED
 3

	)

46 
	#SONYPI_EVENT_JOGDIAL_UP_PRESSED
 4

	)

47 
	#SONYPI_EVENT_JOGDIAL_PRESSED
 5

	)

48 
	#SONYPI_EVENT_JOGDIAL_RELEASED
 6

	)

49 
	#SONYPI_EVENT_CAPTURE_PRESSED
 7

	)

50 
	#SONYPI_EVENT_CAPTURE_RELEASED
 8

	)

51 
	#SONYPI_EVENT_CAPTURE_PARTIALPRESSED
 9

	)

52 
	#SONYPI_EVENT_CAPTURE_PARTIALRELEASED
 10

	)

53 
	#SONYPI_EVENT_FNKEY_ESC
 11

	)

54 
	#SONYPI_EVENT_FNKEY_F1
 12

	)

55 
	#SONYPI_EVENT_FNKEY_F2
 13

	)

56 
	#SONYPI_EVENT_FNKEY_F3
 14

	)

57 
	#SONYPI_EVENT_FNKEY_F4
 15

	)

58 
	#SONYPI_EVENT_FNKEY_F5
 16

	)

59 
	#SONYPI_EVENT_FNKEY_F6
 17

	)

60 
	#SONYPI_EVENT_FNKEY_F7
 18

	)

61 
	#SONYPI_EVENT_FNKEY_F8
 19

	)

62 
	#SONYPI_EVENT_FNKEY_F9
 20

	)

63 
	#SONYPI_EVENT_FNKEY_F10
 21

	)

64 
	#SONYPI_EVENT_FNKEY_F11
 22

	)

65 
	#SONYPI_EVENT_FNKEY_F12
 23

	)

66 
	#SONYPI_EVENT_FNKEY_1
 24

	)

67 
	#SONYPI_EVENT_FNKEY_2
 25

	)

68 
	#SONYPI_EVENT_FNKEY_D
 26

	)

69 
	#SONYPI_EVENT_FNKEY_E
 27

	)

70 
	#SONYPI_EVENT_FNKEY_F
 28

	)

71 
	#SONYPI_EVENT_FNKEY_S
 29

	)

72 
	#SONYPI_EVENT_FNKEY_B
 30

	)

73 
	#SONYPI_EVENT_BLUETOOTH_PRESSED
 31

	)

74 
	#SONYPI_EVENT_PKEY_P1
 32

	)

75 
	#SONYPI_EVENT_PKEY_P2
 33

	)

76 
	#SONYPI_EVENT_PKEY_P3
 34

	)

77 
	#SONYPI_EVENT_BACK_PRESSED
 35

	)

78 
	#SONYPI_EVENT_LID_CLOSED
 36

	)

79 
	#SONYPI_EVENT_LID_OPENED
 37

	)

80 
	#SONYPI_EVENT_BLUETOOTH_ON
 38

	)

81 
	#SONYPI_EVENT_BLUETOOTH_OFF
 39

	)

82 
	#SONYPI_EVENT_HELP_PRESSED
 40

	)

83 
	#SONYPI_EVENT_FNKEY_ONLY
 41

	)

84 
	#SONYPI_EVENT_JOGDIAL_FAST_DOWN
 42

	)

85 
	#SONYPI_EVENT_JOGDIAL_FAST_UP
 43

	)

86 
	#SONYPI_EVENT_JOGDIAL_FAST_DOWN_PRESSED
 44

	)

87 
	#SONYPI_EVENT_JOGDIAL_FAST_UP_PRESSED
 45

	)

88 
	#SONYPI_EVENT_JOGDIAL_VFAST_DOWN
 46

	)

89 
	#SONYPI_EVENT_JOGDIAL_VFAST_UP
 47

	)

90 
	#SONYPI_EVENT_JOGDIAL_VFAST_DOWN_PRESSED
 48

	)

91 
	#SONYPI_EVENT_JOGDIAL_VFAST_UP_PRESSED
 49

	)

92 
	#SONYPI_EVENT_ZOOM_PRESSED
 50

	)

93 
	#SONYPI_EVENT_THUMBPHRASE_PRESSED
 51

	)

94 
	#SONYPI_EVENT_MEYE_FACE
 52

	)

95 
	#SONYPI_EVENT_MEYE_OPPOSITE
 53

	)

96 
	#SONYPI_EVENT_MEMORYSTICK_INSERT
 54

	)

97 
	#SONYPI_EVENT_MEMORYSTICK_EJECT
 55

	)

98 
	#SONYPI_EVENT_ANYBUTTON_RELEASED
 56

	)

99 
	#SONYPI_EVENT_BATTERY_INSERT
 57

	)

100 
	#SONYPI_EVENT_BATTERY_REMOVE
 58

	)

101 
	#SONYPI_EVENT_FNKEY_RELEASED
 59

	)

102 
	#SONYPI_EVENT_WIRELESS_ON
 60

	)

103 
	#SONYPI_EVENT_WIRELESS_OFF
 61

	)

104 
	#SONYPI_EVENT_ZOOM_IN_PRESSED
 62

	)

105 
	#SONYPI_EVENT_ZOOM_OUT_PRESSED
 63

	)

108 
	#SONYPI_IOCGBRT
 
	`_IOR
('v', 0, 
__u8
)

	)

109 
	#SONYPI_IOCSBRT
 
	`_IOW
('v', 0, 
__u8
)

	)

112 
	#SONYPI_IOCGBAT1CAP
 
	`_IOR
('v', 2, 
__u16
)

	)

113 
	#SONYPI_IOCGBAT1REM
 
	`_IOR
('v', 3, 
__u16
)

	)

114 
	#SONYPI_IOCGBAT2CAP
 
	`_IOR
('v', 4, 
__u16
)

	)

115 
	#SONYPI_IOCGBAT2REM
 
	`_IOR
('v', 5, 
__u16
)

	)

118 
	#SONYPI_BFLAGS_B1
 0x01

	)

119 
	#SONYPI_BFLAGS_B2
 0x02

	)

120 
	#SONYPI_BFLAGS_AC
 0x04

	)

121 
	#SONYPI_IOCGBATFLAGS
 
	`_IOR
('v', 7, 
__u8
)

	)

124 
	#SONYPI_IOCGBLUE
 
	`_IOR
('v', 8, 
__u8
)

	)

125 
	#SONYPI_IOCSBLUE
 
	`_IOW
('v', 9, 
__u8
)

	)

128 
	#SONYPI_IOCGFAN
 
	`_IOR
('v', 10, 
__u8
)

	)

129 
	#SONYPI_IOCSFAN
 
	`_IOW
('v', 11, 
__u8
)

	)

132 
	#SONYPI_IOCGTEMP
 
	`_IOR
('v', 12, 
__u8
)

	)

	@/usr/include/linux/time.h

1 #iâdeà
_LINUX_TIME_H


2 
	#_LINUX_TIME_H


	)

4 
	~<lšux/ty³s.h
>

7 #iâdeà
_STRUCT_TIMESPEC


8 
	#_STRUCT_TIMESPEC


	)

9 
	stime¥ec
 {

10 
time_t
 
	mtv_£c
;

11 
	mtv_n£c
;

15 
	stimev®
 {

16 
time_t
 
	mtv_£c
;

17 
su£cÚds_t
 
	mtv_u£c
;

20 
	stimezÚe
 {

21 
	mtz_mšu‹swe¡
;

22 
	mtz_d¡time
;

26 
	#NFDBITS
 
__NFDBITS


	)

28 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

29 
	#FD_SET
(
fd
,
fd£
è
	`__FD_SET
(fd,fd£)

	)

30 
	#FD_CLR
(
fd
,
fd£
è
	`__FD_CLR
(fd,fd£)

	)

31 
	#FD_ISSET
(
fd
,
fd£
è
	`__FD_ISSET
(fd,fd£)

	)

32 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
(fd£)

	)

38 
	#ITIMER_REAL
 0

	)

39 
	#ITIMER_VIRTUAL
 1

	)

40 
	#ITIMER_PROF
 2

	)

42 
	s™im”¥ec
 {

43 
time¥ec
 
	m™_š‹rv®
;

44 
time¥ec
 
	m™_v®ue
;

47 
	s™im”v®
 {

48 
timev®
 
	m™_š‹rv®
;

49 
timev®
 
	m™_v®ue
;

55 
	#CLOCK_REALTIME
 0

	)

56 
	#CLOCK_MONOTONIC
 1

	)

57 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

58 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

59 
	#CLOCK_MONOTONIC_RAW
 4

	)

64 
	#CLOCK_SGI_CYCLE
 10

	)

65 
	#MAX_CLOCKS
 16

	)

66 
	#CLOCKS_MASK
 (
CLOCK_REALTIME
 | 
CLOCK_MONOTONIC
)

	)

67 
	#CLOCKS_MONO
 
CLOCK_MONOTONIC


	)

72 
	#TIMER_ABSTIME
 0x01

	)

	@/usr/include/linux/types.h

1 #iâdeà
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

5 
	~<lšux/posix_ty³s.h
>

6 
	~<asm/ty³s.h
>

8 #iâdeà
__KERNEL_STRICT_NAMES


10 
__u32
 
	t__k”Ãl_dev_t
;

12 
__k”Ãl_fd_£t
 
	tfd_£t
;

13 
__k”Ãl_dev_t
 
	tdev_t
;

14 
__k”Ãl_šo_t
 
	tšo_t
;

15 
__k”Ãl_mode_t
 
	tmode_t
;

16 
__k”Ãl_Æšk_t
 
	tÆšk_t
;

17 
__k”Ãl_off_t
 
	toff_t
;

18 
__k”Ãl_pid_t
 
	tpid_t
;

19 
__k”Ãl_daddr_t
 
	tdaddr_t
;

20 
__k”Ãl_key_t
 
	tkey_t
;

21 
__k”Ãl_su£cÚds_t
 
	tsu£cÚds_t
;

22 
__k”Ãl_tim”_t
 
	ttim”_t
;

23 
__k”Ãl_şockid_t
 
	tşockid_t
;

24 
__k”Ãl_mqd_t
 
	tmqd_t
;

26 
__k”Ãl_uid_t
 
	tuid_t
;

27 
__k”Ãl_gid_t
 
	tgid_t
;

29 #ià
defšed
(
__GNUC__
)

30 
__k”Ãl_loff_t
 
	tloff_t
;

37 #iâdeà
_SIZE_T


38 
	#_SIZE_T


	)

39 
__k”Ãl_size_t
 
	tsize_t
;

42 #iâdeà
_SSIZE_T


43 
	#_SSIZE_T


	)

44 
__k”Ãl_ssize_t
 
	tssize_t
;

47 #iâdeà
_PTRDIFF_T


48 
	#_PTRDIFF_T


	)

49 
__k”Ãl_±rdiff_t
 
	t±rdiff_t
;

52 #iâdeà
_TIME_T


53 
	#_TIME_T


	)

54 
__k”Ãl_time_t
 
	ttime_t
;

57 #iâdeà
_CLOCK_T


58 
	#_CLOCK_T


	)

59 
__k”Ãl_şock_t
 
	tşock_t
;

62 #iâdeà
_CADDR_T


63 
	#_CADDR_T


	)

64 
__k”Ãl_ÿddr_t
 
	tÿddr_t
;

68 
	tu_ch¬
;

69 
	tu_shÜt
;

70 
	tu_št
;

71 
	tu_lÚg
;

74 
	tunch¬
;

75 
	tushÜt
;

76 
	tušt
;

77 
	tulÚg
;

79 #iâdeà
__BIT_TYPES_DEFINED__


80 
	#__BIT_TYPES_DEFINED__


	)

82 
__u8
 
	tu_št8_t
;

83 
__s8
 
	tšt8_t
;

84 
__u16
 
	tu_št16_t
;

85 
__s16
 
	tšt16_t
;

86 
__u32
 
	tu_št32_t
;

87 
__s32
 
	tšt32_t
;

91 
__u8
 
	tušt8_t
;

92 
__u16
 
	tušt16_t
;

93 
__u32
 
	tušt32_t
;

95 #ià
defšed
(
__GNUC__
)

96 
__u64
 
	tušt64_t
;

97 
__u64
 
	tu_št64_t
;

98 
__s64
 
	tšt64_t
;

102 
	#®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

103 
	#®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

104 
	#®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

112 #ifdeà
CONFIG_LBD


113 
u64
 
	t£ùÜ_t
;

115 
	t£ùÜ_t
;

121 #ifdeà
CONFIG_LSF


122 
u64
 
	tblkút_t
;

124 
	tblkút_t
;

131 #iâdeà
pgoff_t


132 
	#pgoff_t
 

	)

142 #ifdeà
__CHECKER__


143 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

145 
	#__b™wi£__


	)

147 #ifdeà
__CHECK_ENDIAN__


148 
	#__b™wi£
 
__b™wi£__


	)

150 
	#__b™wi£


	)

153 
__u16
 
	t__b™wi£
 
	t__Ë16
;

154 
__u16
 
	t__b™wi£
 
	t__be16
;

155 
__u32
 
	t__b™wi£
 
	t__Ë32
;

156 
__u32
 
	t__b™wi£
 
	t__be32
;

157 #ià
defšed
(
__GNUC__
)

158 
__u64
 
	t__b™wi£
 
	t__Ë64
;

159 
__u64
 
	t__b™wi£
 
	t__be64
;

161 
__u16
 
	t__b™wi£
 
	t__sum16
;

162 
__u32
 
	t__b™wi£
 
	t__wsum
;

	@/usr/include/linux/videodev.h

12 #iâdeà
__LINUX_VIDEODEV_H


13 
	#__LINUX_VIDEODEV_H


	)

15 
	~<lšux/ioùl.h
>

16 
	~<lšux/videodev2.h
>

18 #ià
defšed
(
CONFIG_VIDEO_V4L1_COMPAT
è|| !defšed (
__KERNEL__
)

20 
	#VID_TYPE_CAPTURE
 1

	)

21 
	#VID_TYPE_TUNER
 2

	)

22 
	#VID_TYPE_TELETEXT
 4

	)

23 
	#VID_TYPE_OVERLAY
 8

	)

24 
	#VID_TYPE_CHROMAKEY
 16

	)

25 
	#VID_TYPE_CLIPPING
 32

	)

26 
	#VID_TYPE_FRAMERAM
 64

	)

27 
	#VID_TYPE_SCALES
 128

	)

28 
	#VID_TYPE_MONOCHROME
 256

	)

29 
	#VID_TYPE_SUBCAPTURE
 512

	)

30 
	#VID_TYPE_MPEG_DECODER
 1024

	)

31 
	#VID_TYPE_MPEG_ENCODER
 2048

	)

32 
	#VID_TYPE_MJPEG_DECODER
 4096

	)

33 
	#VID_TYPE_MJPEG_ENCODER
 8192

	)

35 
	svideo_ÿ·b™y


37 
	mÇme
[32];

38 
	mty³
;

39 
	mchªÃls
;

40 
	maudios
;

41 
	mmaxwidth
;

42 
	mmaxheight
;

43 
	mmšwidth
;

44 
	mmšheight
;

48 
	svideo_chªÃl


50 
	mchªÃl
;

51 
	mÇme
[32];

52 
	mtuÃrs
;

53 
__u32
 
	mæags
;

54 
	#VIDEO_VC_TUNER
 1

	)

55 
	#VIDEO_VC_AUDIO
 2

	)

56 
__u16
 
	mty³
;

57 
	#VIDEO_TYPE_TV
 1

	)

58 
	#VIDEO_TYPE_CAMERA
 2

	)

59 
__u16
 
	mnÜm
;

62 
	svideo_tuÃr


64 
	mtuÃr
;

65 
	mÇme
[32];

66 
	m¿ng–ow
, 
	m¿ngehigh
;

67 
__u32
 
	mæags
;

68 
	#VIDEO_TUNER_PAL
 1

	)

69 
	#VIDEO_TUNER_NTSC
 2

	)

70 
	#VIDEO_TUNER_SECAM
 4

	)

71 
	#VIDEO_TUNER_LOW
 8

	)

72 
	#VIDEO_TUNER_NORM
 16

	)

73 
	#VIDEO_TUNER_STEREO_ON
 128

	)

74 
	#VIDEO_TUNER_RDS_ON
 256

	)

75 
	#VIDEO_TUNER_MBS_ON
 512

	)

76 
__u16
 
	mmode
;

77 
	#VIDEO_MODE_PAL
 0

	)

78 
	#VIDEO_MODE_NTSC
 1

	)

79 
	#VIDEO_MODE_SECAM
 2

	)

80 
	#VIDEO_MODE_AUTO
 3

	)

81 
__u16
 
	msigÇl
;

84 
	svideo_piùu»


86 
__u16
 
	mbrighŠess
;

87 
__u16
 
	mhue
;

88 
__u16
 
	mcŞour
;

89 
__u16
 
	mcÚŒa¡
;

90 
__u16
 
	mwh™’ess
;

91 
__u16
 
	md•th
;

92 
__u16
 
	m·Ë‰e
;

93 
	#VIDEO_PALETTE_GREY
 1

	)

94 
	#VIDEO_PALETTE_HI240
 2

	)

95 
	#VIDEO_PALETTE_RGB565
 3

	)

96 
	#VIDEO_PALETTE_RGB24
 4

	)

97 
	#VIDEO_PALETTE_RGB32
 5

	)

98 
	#VIDEO_PALETTE_RGB555
 6

	)

99 
	#VIDEO_PALETTE_YUV422
 7

	)

100 
	#VIDEO_PALETTE_YUYV
 8

	)

101 
	#VIDEO_PALETTE_UYVY
 9

	)

102 
	#VIDEO_PALETTE_YUV420
 10

	)

103 
	#VIDEO_PALETTE_YUV411
 11

	)

104 
	#VIDEO_PALETTE_RAW
 12

	)

105 
	#VIDEO_PALETTE_YUV422P
 13

	)

106 
	#VIDEO_PALETTE_YUV411P
 14

	)

107 
	#VIDEO_PALETTE_YUV420P
 15

	)

108 
	#VIDEO_PALETTE_YUV410P
 16

	)

109 
	#VIDEO_PALETTE_PLANAR
 13

	)

110 
	#VIDEO_PALETTE_COMPONENT
 7

	)

113 
	svideo_audio


115 
	maudio
;

116 
__u16
 
	mvŞume
;

117 
__u16
 
	mbass
, 
	mŒebË
;

118 
__u32
 
	mæags
;

119 
	#VIDEO_AUDIO_MUTE
 1

	)

120 
	#VIDEO_AUDIO_MUTABLE
 2

	)

121 
	#VIDEO_AUDIO_VOLUME
 4

	)

122 
	#VIDEO_AUDIO_BASS
 8

	)

123 
	#VIDEO_AUDIO_TREBLE
 16

	)

124 
	#VIDEO_AUDIO_BALANCE
 32

	)

125 
	mÇme
[16];

126 
	#VIDEO_SOUND_MONO
 1

	)

127 
	#VIDEO_SOUND_STEREO
 2

	)

128 
	#VIDEO_SOUND_LANG1
 4

	)

129 
	#VIDEO_SOUND_LANG2
 8

	)

130 
__u16
 
	mmode
;

131 
__u16
 
	mb®ªû
;

132 
__u16
 
	m¡•
;

135 
	svideo_ş


137 
__s32
 
	mx
,
	my
;

138 
__s32
 
	mwidth
, 
	mheight
;

139 
video_ş
 *
	mÃxt
;

142 
	svideo_wšdow


144 
__u32
 
	mx
,
	my
;

145 
__u32
 
	mwidth
,
	mheight
;

146 
__u32
 
	mchromakey
;

147 
__u32
 
	mæags
;

148 
video_ş
 *
	mşs
;

149 
	mşcouÁ
;

150 
	#VIDEO_WINDOW_INTERLACE
 1

	)

151 
	#VIDEO_WINDOW_CHROMAKEY
 16

	)

152 
	#VIDEO_CLIP_BITMAP
 -1

	)

154 
	#VIDEO_CLIPMAP_SIZE
 (128 * 625)

	)

157 
	svideo_ÿ±u»


159 
__u32
 
	mx
,
	my
;

160 
__u32
 
	mwidth
, 
	mheight
;

161 
__u16
 
	mdecim©iÚ
;

162 
__u16
 
	mæags
;

163 
	#VIDEO_CAPTURE_ODD
 0

	)

164 
	#VIDEO_CAPTURE_EVEN
 1

	)

167 
	svideo_bufãr


169 *
	mba£
;

170 
	mheight
,
	mwidth
;

171 
	md•th
;

172 
	mby‹¥”lše
;

175 
	svideo_mm­


177 
	mäame
;

178 
	mheight
,
	mwidth
;

179 
	mfÜm©
;

182 
	svideo_key


184 
__u8
 
	mkey
[8];

185 
__u32
 
	mæags
;

188 
	svideo_mbuf


190 
	msize
;

191 
	mäames
;

192 
	moff£ts
[
VIDEO_MAX_FRAME
];

195 
	#VIDEO_NO_UNIT
 (-1)

	)

197 
	svideo_un™


199 
	mvideo
;

200 
	mvbi
;

201 
	m¿dio
;

202 
	maudio
;

203 
	m‹Ë‹xt
;

206 
	svbi_fÜm©
 {

207 
__u32
 
	m§m¶šg_¿‹
;

208 
__u32
 
	m§m¶es_³r_lše
;

209 
__u32
 
	m§m¶e_fÜm©
;

210 
__s32
 
	m¡¬t
[2];

211 
__u32
 
	mcouÁ
[2];

212 
__u32
 
	mæags
;

213 
	#VBI_UNSYNC
 1

	)

214 
	#VBI_INTERLACED
 2

	)

219 
	svideo_šfo


221 
__u32
 
	mäame_couÁ
;

222 
__u32
 
	mh_size
;

223 
__u32
 
	mv_size
;

224 
__u32
 
	msm±e_timecode
;

225 
__u32
 
	mpiùu»_ty³
;

226 
__u32
 
	m‹mpÜ®_»ã»nû
;

227 
__u8
 
	mu£r_d©a
[256];

232 
	svideo_¶ay_mode


234 
	mmode
;

235 
	mp1
;

236 
	mp2
;

240 
	svideo_code


242 
	mlßdwh©
[16];

243 
	md©asize
;

244 
__u8
 *
	md©a
;

247 
	#VIDIOCGCAP
 
	`_IOR
('v',1,
video_ÿ·b™y
è

	)

248 
	#VIDIOCGCHAN
 
	`_IOWR
('v',2,
video_chªÃl
è

	)

249 
	#VIDIOCSCHAN
 
	`_IOW
('v',3,
video_chªÃl
è

	)

250 
	#VIDIOCGTUNER
 
	`_IOWR
('v',4,
video_tuÃr
è

	)

251 
	#VIDIOCSTUNER
 
	`_IOW
('v',5,
video_tuÃr
è

	)

252 
	#VIDIOCGPICT
 
	`_IOR
('v',6,
video_piùu»
è

	)

253 
	#VIDIOCSPICT
 
	`_IOW
('v',7,
video_piùu»
è

	)

254 
	#VIDIOCCAPTURE
 
	`_IOW
('v',8,è

	)

255 
	#VIDIOCGWIN
 
	`_IOR
('v',9, 
video_wšdow
è

	)

256 
	#VIDIOCSWIN
 
	`_IOW
('v',10, 
video_wšdow
è

	)

257 
	#VIDIOCGFBUF
 
	`_IOR
('v',11, 
video_bufãr
è

	)

258 
	#VIDIOCSFBUF
 
	`_IOW
('v',12, 
video_bufãr
è

	)

259 
	#VIDIOCKEY
 
	`_IOR
('v',13, 
video_key
è

	)

260 
	#VIDIOCGFREQ
 
	`_IOR
('v',14, è

	)

261 
	#VIDIOCSFREQ
 
	`_IOW
('v',15, è

	)

262 
	#VIDIOCGAUDIO
 
	`_IOR
('v',16, 
video_audio
è

	)

263 
	#VIDIOCSAUDIO
 
	`_IOW
('v',17, 
video_audio
è

	)

264 
	#VIDIOCSYNC
 
	`_IOW
('v',18, è

	)

265 
	#VIDIOCMCAPTURE
 
	`_IOW
('v',19, 
video_mm­
è

	)

266 
	#VIDIOCGMBUF
 
	`_IOR
('v',20, 
video_mbuf
è

	)

267 
	#VIDIOCGUNIT
 
	`_IOR
('v',21, 
video_un™
è

	)

268 
	#VIDIOCGCAPTURE
 
	`_IOR
('v',22, 
video_ÿ±u»
è

	)

269 
	#VIDIOCSCAPTURE
 
	`_IOW
('v',23, 
video_ÿ±u»
è

	)

270 
	#VIDIOCSPLAYMODE
 
	`_IOW
('v',24, 
video_¶ay_mode
è

	)

271 
	#VIDIOCSWRITEMODE
 
	`_IOW
('v',25, è

	)

272 
	#VIDIOCGPLAYINFO
 
	`_IOR
('v',26, 
video_šfo
è

	)

273 
	#VIDIOCSMICROCODE
 
	`_IOW
('v',27, 
video_code
è

	)

274 
	#VIDIOCGVBIFMT
 
	`_IOR
('v',28, 
vbi_fÜm©
è

	)

275 
	#VIDIOCSVBIFMT
 
	`_IOW
('v',29, 
vbi_fÜm©
è

	)

278 
	#BASE_VIDIOCPRIVATE
 192

	)

281 
	#VID_WRITE_MPEG_AUD
 0

	)

282 
	#VID_WRITE_MPEG_VID
 1

	)

283 
	#VID_WRITE_OSD
 2

	)

284 
	#VID_WRITE_TTX
 3

	)

285 
	#VID_WRITE_CC
 4

	)

286 
	#VID_WRITE_MJPEG
 5

	)

289 
	#VID_PLAY_VID_OUT_MODE
 0

	)

291 
	#VID_PLAY_GENLOCK
 1

	)

294 
	#VID_PLAY_NORMAL
 2

	)

295 
	#VID_PLAY_PAUSE
 3

	)

296 
	#VID_PLAY_SINGLE_FRAME
 4

	)

297 
	#VID_PLAY_FAST_FORWARD
 5

	)

298 
	#VID_PLAY_SLOW_MOTION
 6

	)

299 
	#VID_PLAY_IMMEDIATE_NORMAL
 7

	)

300 
	#VID_PLAY_SWITCH_CHANNELS
 8

	)

301 
	#VID_PLAY_FREEZE_FRAME
 9

	)

302 
	#VID_PLAY_STILL_MODE
 10

	)

303 
	#VID_PLAY_MASTER_MODE
 11

	)

305 
	#VID_PLAY_MASTER_NONE
 1

	)

306 
	#VID_PLAY_MASTER_VIDEO
 2

	)

307 
	#VID_PLAY_MASTER_AUDIO
 3

	)

308 
	#VID_PLAY_ACTIVE_SCANLINES
 12

	)

310 
	#VID_PLAY_RESET
 13

	)

311 
	#VID_PLAY_END_MARK
 14

	)

	@/usr/include/linux/videodev2.h

56 #iâdeà
__LINUX_VIDEODEV2_H


57 
	#__LINUX_VIDEODEV2_H


	)

59 
	~<sys/time.h
>

61 
	~<lšux/ioùl.h
>

62 
	~<lšux/ty³s.h
>

68 
	#VIDEO_MAX_FRAME
 32

	)

74 
	#VID_TYPE_CAPTURE
 1

	)

75 
	#VID_TYPE_TUNER
 2

	)

76 
	#VID_TYPE_TELETEXT
 4

	)

77 
	#VID_TYPE_OVERLAY
 8

	)

78 
	#VID_TYPE_CHROMAKEY
 16

	)

79 
	#VID_TYPE_CLIPPING
 32

	)

80 
	#VID_TYPE_FRAMERAM
 64

	)

81 
	#VID_TYPE_SCALES
 128

	)

82 
	#VID_TYPE_MONOCHROME
 256

	)

83 
	#VID_TYPE_SUBCAPTURE
 512

	)

84 
	#VID_TYPE_MPEG_DECODER
 1024

	)

85 
	#VID_TYPE_MPEG_ENCODER
 2048

	)

86 
	#VID_TYPE_MJPEG_DECODER
 4096

	)

87 
	#VID_TYPE_MJPEG_ENCODER
 8192

	)

94 
	#v4l2_fourcc
(
a
, 
b
, 
c
, 
d
)\

95 ((
__u32
)(
a
è| ((__u32)(
b
è<< 8è| ((__u32)(
c
è<< 16è| ((__u32)(
d
è<< 24))

	)

100 
	ev4l2_f›ld
 {

101 
	mV4L2_FIELD_ANY
 = 0,

105 
	mV4L2_FIELD_NONE
 = 1,

106 
	mV4L2_FIELD_TOP
 = 2,

107 
	mV4L2_FIELD_BOTTOM
 = 3,

108 
	mV4L2_FIELD_INTERLACED
 = 4,

109 
	mV4L2_FIELD_SEQ_TB
 = 5,

111 
	mV4L2_FIELD_SEQ_BT
 = 6,

112 
	mV4L2_FIELD_ALTERNATE
 = 7,

114 
	mV4L2_FIELD_INTERLACED_TB
 = 8,

117 
	mV4L2_FIELD_INTERLACED_BT
 = 9,

121 
	#V4L2_FIELD_HAS_TOP
(
f›ld
) \

122 ((
f›ld
è=ğ
V4L2_FIELD_TOP
 ||\

123 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED
 ||\

124 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED_TB
 ||\

125 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED_BT
 ||\

126 (
f›ld
è=ğ
V4L2_FIELD_SEQ_TB
 ||\

127 (
f›ld
è=ğ
V4L2_FIELD_SEQ_BT
)

	)

128 
	#V4L2_FIELD_HAS_BOTTOM
(
f›ld
) \

129 ((
f›ld
è=ğ
V4L2_FIELD_BOTTOM
 ||\

130 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED
 ||\

131 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED_TB
 ||\

132 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED_BT
 ||\

133 (
f›ld
è=ğ
V4L2_FIELD_SEQ_TB
 ||\

134 (
f›ld
è=ğ
V4L2_FIELD_SEQ_BT
)

	)

135 
	#V4L2_FIELD_HAS_BOTH
(
f›ld
) \

136 ((
f›ld
è=ğ
V4L2_FIELD_INTERLACED
 ||\

137 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED_TB
 ||\

138 (
f›ld
è=ğ
V4L2_FIELD_INTERLACED_BT
 ||\

139 (
f›ld
è=ğ
V4L2_FIELD_SEQ_TB
 ||\

140 (
f›ld
è=ğ
V4L2_FIELD_SEQ_BT
)

	)

142 
	ev4l2_buf_ty³
 {

143 
	mV4L2_BUF_TYPE_VIDEO_CAPTURE
 = 1,

144 
	mV4L2_BUF_TYPE_VIDEO_OUTPUT
 = 2,

145 
	mV4L2_BUF_TYPE_VIDEO_OVERLAY
 = 3,

146 
	mV4L2_BUF_TYPE_VBI_CAPTURE
 = 4,

147 
	mV4L2_BUF_TYPE_VBI_OUTPUT
 = 5,

148 
	mV4L2_BUF_TYPE_SLICED_VBI_CAPTURE
 = 6,

149 
	mV4L2_BUF_TYPE_SLICED_VBI_OUTPUT
 = 7,

152 
	mV4L2_BUF_TYPE_VIDEO_OUTPUT_OVERLAY
 = 8,

154 
	mV4L2_BUF_TYPE_PRIVATE
 = 0x80,

157 
	ev4l2_ù¾_ty³
 {

158 
	mV4L2_CTRL_TYPE_INTEGER
 = 1,

159 
	mV4L2_CTRL_TYPE_BOOLEAN
 = 2,

160 
	mV4L2_CTRL_TYPE_MENU
 = 3,

161 
	mV4L2_CTRL_TYPE_BUTTON
 = 4,

162 
	mV4L2_CTRL_TYPE_INTEGER64
 = 5,

163 
	mV4L2_CTRL_TYPE_CTRL_CLASS
 = 6,

166 
	ev4l2_tuÃr_ty³
 {

167 
	mV4L2_TUNER_RADIO
 = 1,

168 
	mV4L2_TUNER_ANALOG_TV
 = 2,

169 
	mV4L2_TUNER_DIGITAL_TV
 = 3,

172 
	ev4l2_memÜy
 {

173 
	mV4L2_MEMORY_MMAP
 = 1,

174 
	mV4L2_MEMORY_USERPTR
 = 2,

175 
	mV4L2_MEMORY_OVERLAY
 = 3,

179 
	ev4l2_cŞÜ¥aû
 {

181 
	mV4L2_COLORSPACE_SMPTE170M
 = 1,

184 
	mV4L2_COLORSPACE_SMPTE240M
 = 2,

187 
	mV4L2_COLORSPACE_REC709
 = 3,

190 
	mV4L2_COLORSPACE_BT878
 = 4,

193 
	mV4L2_COLORSPACE_470_SYSTEM_M
 = 5,

194 
	mV4L2_COLORSPACE_470_SYSTEM_BG
 = 6,

200 
	mV4L2_COLORSPACE_JPEG
 = 7,

203 
	mV4L2_COLORSPACE_SRGB
 = 8,

206 
	ev4l2_´iÜ™y
 {

207 
	mV4L2_PRIORITY_UNSET
 = 0,

208 
	mV4L2_PRIORITY_BACKGROUND
 = 1,

209 
	mV4L2_PRIORITY_INTERACTIVE
 = 2,

210 
	mV4L2_PRIORITY_RECORD
 = 3,

211 
	mV4L2_PRIORITY_DEFAULT
 = 
V4L2_PRIORITY_INTERACTIVE
,

214 
	sv4l2_»ù
 {

215 
__s32
 
	mËá
;

216 
__s32
 
	mtİ
;

217 
__s32
 
	mwidth
;

218 
__s32
 
	mheight
;

221 
	sv4l2_äaù
 {

222 
__u32
 
	mnum”©Ü
;

223 
__u32
 
	md’omš©Ü
;

229 
	sv4l2_ÿ·b™y
 {

230 
__u8
 
	mdriv”
[16];

231 
__u8
 
	mÿrd
[32];

232 
__u8
 
	mbus_šfo
[32];

233 
__u32
 
	mv”siÚ
;

234 
__u32
 
	mÿ·b™›s
;

235 
__u32
 
	m»£rved
[4];

239 
	#V4L2_CAP_VIDEO_CAPTURE
 0x00000001

	)

240 
	#V4L2_CAP_VIDEO_OUTPUT
 0x00000002

	)

241 
	#V4L2_CAP_VIDEO_OVERLAY
 0x00000004

	)

242 
	#V4L2_CAP_VBI_CAPTURE
 0x00000010

	)

243 
	#V4L2_CAP_VBI_OUTPUT
 0x00000020

	)

244 
	#V4L2_CAP_SLICED_VBI_CAPTURE
 0x00000040

	)

245 
	#V4L2_CAP_SLICED_VBI_OUTPUT
 0x00000080

	)

246 
	#V4L2_CAP_RDS_CAPTURE
 0x00000100

	)

247 
	#V4L2_CAP_VIDEO_OUTPUT_OVERLAY
 0x00000200

	)

248 
	#V4L2_CAP_HW_FREQ_SEEK
 0x00000400

	)

250 
	#V4L2_CAP_TUNER
 0x00010000

	)

251 
	#V4L2_CAP_AUDIO
 0x00020000

	)

252 
	#V4L2_CAP_RADIO
 0x00040000

	)

254 
	#V4L2_CAP_READWRITE
 0x01000000

	)

255 
	#V4L2_CAP_ASYNCIO
 0x02000000

	)

256 
	#V4L2_CAP_STREAMING
 0x04000000

	)

261 
	sv4l2_pix_fÜm©
 {

262 
__u32
 
	mwidth
;

263 
__u32
 
	mheight
;

264 
__u32
 
	mpix–fÜm©
;

265 
v4l2_f›ld
 
	mf›ld
;

266 
__u32
 
	mby‹¥”lše
;

267 
__u32
 
	msizeimage
;

268 
v4l2_cŞÜ¥aû
 
	mcŞÜ¥aû
;

269 
__u32
 
	m´iv
;

273 
	#V4L2_PIX_FMT_RGB332
 
	`v4l2_fourcc
('R', 'G', 'B', '1'è

	)

274 
	#V4L2_PIX_FMT_RGB444
 
	`v4l2_fourcc
('R', '4', '4', '4'è

	)

275 
	#V4L2_PIX_FMT_RGB555
 
	`v4l2_fourcc
('R', 'G', 'B', 'O'è

	)

276 
	#V4L2_PIX_FMT_RGB565
 
	`v4l2_fourcc
('R', 'G', 'B', 'P'è

	)

277 
	#V4L2_PIX_FMT_RGB555X
 
	`v4l2_fourcc
('R', 'G', 'B', 'Q'è

	)

278 
	#V4L2_PIX_FMT_RGB565X
 
	`v4l2_fourcc
('R', 'G', 'B', 'R'è

	)

279 
	#V4L2_PIX_FMT_BGR24
 
	`v4l2_fourcc
('B', 'G', 'R', '3'è

	)

280 
	#V4L2_PIX_FMT_RGB24
 
	`v4l2_fourcc
('R', 'G', 'B', '3'è

	)

281 
	#V4L2_PIX_FMT_BGR32
 
	`v4l2_fourcc
('B', 'G', 'R', '4'è

	)

282 
	#V4L2_PIX_FMT_RGB32
 
	`v4l2_fourcc
('R', 'G', 'B', '4'è

	)

283 
	#V4L2_PIX_FMT_GREY
 
	`v4l2_fourcc
('G', 'R', 'E', 'Y'è

	)

284 
	#V4L2_PIX_FMT_Y16
 
	`v4l2_fourcc
('Y', '1', '6', ' 'è

	)

285 
	#V4L2_PIX_FMT_PAL8
 
	`v4l2_fourcc
('P', 'A', 'L', '8'è

	)

286 
	#V4L2_PIX_FMT_YVU410
 
	`v4l2_fourcc
('Y', 'V', 'U', '9'è

	)

287 
	#V4L2_PIX_FMT_YVU420
 
	`v4l2_fourcc
('Y', 'V', '1', '2'è

	)

288 
	#V4L2_PIX_FMT_YUYV
 
	`v4l2_fourcc
('Y', 'U', 'Y', 'V'è

	)

289 
	#V4L2_PIX_FMT_UYVY
 
	`v4l2_fourcc
('U', 'Y', 'V', 'Y'è

	)

290 
	#V4L2_PIX_FMT_YUV422P
 
	`v4l2_fourcc
('4', '2', '2', 'P'è

	)

291 
	#V4L2_PIX_FMT_YUV411P
 
	`v4l2_fourcc
('4', '1', '1', 'P'è

	)

292 
	#V4L2_PIX_FMT_Y41P
 
	`v4l2_fourcc
('Y', '4', '1', 'P'è

	)

293 
	#V4L2_PIX_FMT_YUV444
 
	`v4l2_fourcc
('Y', '4', '4', '4'è

	)

294 
	#V4L2_PIX_FMT_YUV555
 
	`v4l2_fourcc
('Y', 'U', 'V', 'O'è

	)

295 
	#V4L2_PIX_FMT_YUV565
 
	`v4l2_fourcc
('Y', 'U', 'V', 'P'è

	)

296 
	#V4L2_PIX_FMT_YUV32
 
	`v4l2_fourcc
('Y', 'U', 'V', '4'è

	)

299 
	#V4L2_PIX_FMT_NV12
 
	`v4l2_fourcc
('N', 'V', '1', '2'è

	)

300 
	#V4L2_PIX_FMT_NV21
 
	`v4l2_fourcc
('N', 'V', '2', '1'è

	)

303 
	#V4L2_PIX_FMT_YUV410
 
	`v4l2_fourcc
('Y', 'U', 'V', '9'è

	)

304 
	#V4L2_PIX_FMT_YUV420
 
	`v4l2_fourcc
('Y', 'U', '1', '2'è

	)

305 
	#V4L2_PIX_FMT_YYUV
 
	`v4l2_fourcc
('Y', 'Y', 'U', 'V'è

	)

306 
	#V4L2_PIX_FMT_HI240
 
	`v4l2_fourcc
('H', 'I', '2', '4'è

	)

307 
	#V4L2_PIX_FMT_HM12
 
	`v4l2_fourcc
('H', 'M', '1', '2'è

	)

310 
	#V4L2_PIX_FMT_SBGGR8
 
	`v4l2_fourcc
('B', 'A', '8', '1'è

	)

311 
	#V4L2_PIX_FMT_SGBRG8
 
	`v4l2_fourcc
('G', 'B', 'R', 'G'è

	)

316 
	#V4L2_PIX_FMT_SGRBG10
 
	`v4l2_fourcc
('B', 'A', '1', '0')

	)

318 
	#V4L2_PIX_FMT_SGRBG10DPCM8
 
	`v4l2_fourcc
('B', 'D', '1', '0')

	)

319 
	#V4L2_PIX_FMT_SBGGR16
 
	`v4l2_fourcc
('B', 'Y', 'R', '2'è

	)

322 
	#V4L2_PIX_FMT_MJPEG
 
	`v4l2_fourcc
('M', 'J', 'P', 'G'è

	)

323 
	#V4L2_PIX_FMT_JPEG
 
	`v4l2_fourcc
('J', 'P', 'E', 'G'è

	)

324 
	#V4L2_PIX_FMT_DV
 
	`v4l2_fourcc
('d', 'v', 's', 'd'è

	)

325 
	#V4L2_PIX_FMT_MPEG
 
	`v4l2_fourcc
('M', 'P', 'E', 'G'è

	)

328 
	#V4L2_PIX_FMT_WNVA
 
	`v4l2_fourcc
('W', 'N', 'V', 'A'è

	)

329 
	#V4L2_PIX_FMT_SN9C10X
 
	`v4l2_fourcc
('S', '9', '1', '0'è

	)

330 
	#V4L2_PIX_FMT_PWC1
 
	`v4l2_fourcc
('P', 'W', 'C', '1'è

	)

331 
	#V4L2_PIX_FMT_PWC2
 
	`v4l2_fourcc
('P', 'W', 'C', '2'è

	)

332 
	#V4L2_PIX_FMT_ET61X251
 
	`v4l2_fourcc
('E', '6', '2', '5'è

	)

333 
	#V4L2_PIX_FMT_SPCA501
 
	`v4l2_fourcc
('S', '5', '0', '1'è

	)

334 
	#V4L2_PIX_FMT_SPCA505
 
	`v4l2_fourcc
('S', '5', '0', '5'è

	)

335 
	#V4L2_PIX_FMT_SPCA508
 
	`v4l2_fourcc
('S', '5', '0', '8'è

	)

336 
	#V4L2_PIX_FMT_SPCA561
 
	`v4l2_fourcc
('S', '5', '6', '1'è

	)

337 
	#V4L2_PIX_FMT_PAC207
 
	`v4l2_fourcc
('P', '2', '0', '7'è

	)

338 
	#V4L2_PIX_FMT_PJPG
 
	`v4l2_fourcc
('P', 'J', 'P', 'G'è

	)

339 
	#V4L2_PIX_FMT_YVYU
 
	`v4l2_fourcc
('Y', 'V', 'Y', 'U'è

	)

344 
	sv4l2_fmtdesc
 {

345 
__u32
 
	mšdex
;

346 
v4l2_buf_ty³
 
	mty³
;

347 
__u32
 
	mæags
;

348 
__u8
 
	mdesütiÚ
[32];

349 
__u32
 
	mpix–fÜm©
;

350 
__u32
 
	m»£rved
[4];

353 
	#V4L2_FMT_FLAG_COMPRESSED
 0x0001

	)

360 
	ev4l2_ämsiz‘y³s
 {

361 
	mV4L2_FRMSIZE_TYPE_DISCRETE
 = 1,

362 
	mV4L2_FRMSIZE_TYPE_CONTINUOUS
 = 2,

363 
	mV4L2_FRMSIZE_TYPE_STEPWISE
 = 3,

366 
	sv4l2_ämsize_disü‘e
 {

367 
__u32
 
	mwidth
;

368 
__u32
 
	mheight
;

371 
	sv4l2_ämsize_¡•wi£
 {

372 
__u32
 
	mmš_width
;

373 
__u32
 
	mmax_width
;

374 
__u32
 
	m¡•_width
;

375 
__u32
 
	mmš_height
;

376 
__u32
 
	mmax_height
;

377 
__u32
 
	m¡•_height
;

380 
	sv4l2_ämsiz“num
 {

381 
__u32
 
	mšdex
;

382 
__u32
 
	mpix–_fÜm©
;

383 
__u32
 
	mty³
;

386 
v4l2_ämsize_disü‘e
 
	mdisü‘e
;

387 
v4l2_ämsize_¡•wi£
 
	m¡•wi£
;

390 
__u32
 
	m»£rved
[2];

396 
	ev4l2_ämiv®ty³s
 {

397 
	mV4L2_FRMIVAL_TYPE_DISCRETE
 = 1,

398 
	mV4L2_FRMIVAL_TYPE_CONTINUOUS
 = 2,

399 
	mV4L2_FRMIVAL_TYPE_STEPWISE
 = 3,

402 
	sv4l2_ämiv®_¡•wi£
 {

403 
v4l2_äaù
 
	mmš
;

404 
v4l2_äaù
 
	mmax
;

405 
v4l2_äaù
 
	m¡•
;

408 
	sv4l2_ämiv®’um
 {

409 
__u32
 
	mšdex
;

410 
__u32
 
	mpix–_fÜm©
;

411 
__u32
 
	mwidth
;

412 
__u32
 
	mheight
;

413 
__u32
 
	mty³
;

416 
v4l2_äaù
 
	mdisü‘e
;

417 
v4l2_ämiv®_¡•wi£
 
	m¡•wi£
;

420 
__u32
 
	m»£rved
[2];

427 
	sv4l2_timecode
 {

428 
__u32
 
	mty³
;

429 
__u32
 
	mæags
;

430 
__u8
 
	mäames
;

431 
__u8
 
	m£cÚds
;

432 
__u8
 
	mmšu‹s
;

433 
__u8
 
	mhours
;

434 
__u8
 
	mu£rb™s
[4];

438 
	#V4L2_TC_TYPE_24FPS
 1

	)

439 
	#V4L2_TC_TYPE_25FPS
 2

	)

440 
	#V4L2_TC_TYPE_30FPS
 3

	)

441 
	#V4L2_TC_TYPE_50FPS
 4

	)

442 
	#V4L2_TC_TYPE_60FPS
 5

	)

445 
	#V4L2_TC_FLAG_DROPFRAME
 0x0001

	)

446 
	#V4L2_TC_FLAG_COLORFRAME
 0x0002

	)

447 
	#V4L2_TC_USERBITS_f›ld
 0x000C

	)

448 
	#V4L2_TC_USERBITS_USERDEFINED
 0x0000

	)

449 
	#V4L2_TC_USERBITS_8BITCHARS
 0x0008

	)

452 
	sv4l2_j³gcom´essiÚ
 {

453 
	mqu®™y
;

455 
	mAPPn
;

457 
	mAPP_Ën
;

458 
	mAPP_d©a
[60];

460 
	mCOM_Ën
;

461 
	mCOM_d©a
[60];

463 
__u32
 
	mj³g_m¬k”s
;

473 
	#V4L2_JPEG_MARKER_DHT
 (1<<3è

	)

474 
	#V4L2_JPEG_MARKER_DQT
 (1<<4è

	)

475 
	#V4L2_JPEG_MARKER_DRI
 (1<<5è

	)

476 
	#V4L2_JPEG_MARKER_COM
 (1<<6è

	)

477 
	#V4L2_JPEG_MARKER_APP
 (1<<7è

	)

484 
	sv4l2_»que¡bufãrs
 {

485 
__u32
 
	mcouÁ
;

486 
v4l2_buf_ty³
 
	mty³
;

487 
v4l2_memÜy
 
	mmemÜy
;

488 
__u32
 
	m»£rved
[2];

491 
	sv4l2_bufãr
 {

492 
__u32
 
	mšdex
;

493 
v4l2_buf_ty³
 
	mty³
;

494 
__u32
 
	mby‹su£d
;

495 
__u32
 
	mæags
;

496 
v4l2_f›ld
 
	mf›ld
;

497 
timev®
 
	mtime¡amp
;

498 
v4l2_timecode
 
	mtimecode
;

499 
__u32
 
	m£qu’û
;

502 
v4l2_memÜy
 
	mmemÜy
;

504 
__u32
 
	moff£t
;

505 
	mu£½Œ
;

506 } 
	mm
;

507 
__u32
 
	mËngth
;

508 
__u32
 
	mšput
;

509 
__u32
 
	m»£rved
;

513 
	#V4L2_BUF_FLAG_MAPPED
 0x0001

	)

514 
	#V4L2_BUF_FLAG_QUEUED
 0x0002

	)

515 
	#V4L2_BUF_FLAG_DONE
 0x0004

	)

516 
	#V4L2_BUF_FLAG_KEYFRAME
 0x0008

	)

517 
	#V4L2_BUF_FLAG_PFRAME
 0x0010

	)

518 
	#V4L2_BUF_FLAG_BFRAME
 0x0020

	)

519 
	#V4L2_BUF_FLAG_TIMECODE
 0x0100

	)

520 
	#V4L2_BUF_FLAG_INPUT
 0x0200

	)

525 
	sv4l2_äamebufãr
 {

526 
__u32
 
	mÿ·b™y
;

527 
__u32
 
	mæags
;

530 *
	mba£
;

531 
v4l2_pix_fÜm©
 
	mfmt
;

534 
	#V4L2_FBUF_CAP_EXTERNOVERLAY
 0x0001

	)

535 
	#V4L2_FBUF_CAP_CHROMAKEY
 0x0002

	)

536 
	#V4L2_FBUF_CAP_LIST_CLIPPING
 0x0004

	)

537 
	#V4L2_FBUF_CAP_BITMAP_CLIPPING
 0x0008

	)

538 
	#V4L2_FBUF_CAP_LOCAL_ALPHA
 0x0010

	)

539 
	#V4L2_FBUF_CAP_GLOBAL_ALPHA
 0x0020

	)

540 
	#V4L2_FBUF_CAP_LOCAL_INV_ALPHA
 0x0040

	)

542 
	#V4L2_FBUF_FLAG_PRIMARY
 0x0001

	)

543 
	#V4L2_FBUF_FLAG_OVERLAY
 0x0002

	)

544 
	#V4L2_FBUF_FLAG_CHROMAKEY
 0x0004

	)

545 
	#V4L2_FBUF_FLAG_LOCAL_ALPHA
 0x0008

	)

546 
	#V4L2_FBUF_FLAG_GLOBAL_ALPHA
 0x0010

	)

547 
	#V4L2_FBUF_FLAG_LOCAL_INV_ALPHA
 0x0020

	)

549 
	sv4l2_ş
 {

550 
v4l2_»ù
 
	mc
;

551 
v4l2_ş
 *
	mÃxt
;

554 
	sv4l2_wšdow
 {

555 
v4l2_»ù
 
	mw
;

556 
v4l2_f›ld
 
	mf›ld
;

557 
__u32
 
	mchromakey
;

558 
v4l2_ş
 *
	mşs
;

559 
__u32
 
	mşcouÁ
;

560 *
	mb™m­
;

561 
__u8
 
	mglob®_®pha
;

567 
	sv4l2_ÿ±u»·rm
 {

568 
__u32
 
	mÿ·b™y
;

569 
__u32
 
	mÿ±u»mode
;

570 
v4l2_äaù
 
	mtim•”äame
;

571 
__u32
 
	mex‹ndedmode
;

572 
__u32
 
	m»adbufãrs
;

573 
__u32
 
	m»£rved
[4];

577 
	#V4L2_MODE_HIGHQUALITY
 0x0001

	)

578 
	#V4L2_CAP_TIMEPERFRAME
 0x1000

	)

580 
	sv4l2_ouu¬m
 {

581 
__u32
 
	mÿ·b™y
;

582 
__u32
 
	mouutmode
;

583 
v4l2_äaù
 
	mtim•”äame
;

584 
__u32
 
	mex‹ndedmode
;

585 
__u32
 
	mwr™ebufãrs
;

586 
__u32
 
	m»£rved
[4];

592 
	sv4l2_üİÿp
 {

593 
v4l2_buf_ty³
 
	mty³
;

594 
v4l2_»ù
 
	mbounds
;

595 
v4l2_»ù
 
	mdeäeù
;

596 
v4l2_äaù
 
	mpix–a¥eù
;

599 
	sv4l2_üİ
 {

600 
v4l2_buf_ty³
 
	mty³
;

601 
v4l2_»ù
 
	mc
;

608 
__u64
 
	tv4l2_¡d_id
;

611 
	#V4L2_STD_PAL_B
 ((
v4l2_¡d_id
)0x00000001)

	)

612 
	#V4L2_STD_PAL_B1
 ((
v4l2_¡d_id
)0x00000002)

	)

613 
	#V4L2_STD_PAL_G
 ((
v4l2_¡d_id
)0x00000004)

	)

614 
	#V4L2_STD_PAL_H
 ((
v4l2_¡d_id
)0x00000008)

	)

615 
	#V4L2_STD_PAL_I
 ((
v4l2_¡d_id
)0x00000010)

	)

616 
	#V4L2_STD_PAL_D
 ((
v4l2_¡d_id
)0x00000020)

	)

617 
	#V4L2_STD_PAL_D1
 ((
v4l2_¡d_id
)0x00000040)

	)

618 
	#V4L2_STD_PAL_K
 ((
v4l2_¡d_id
)0x00000080)

	)

620 
	#V4L2_STD_PAL_M
 ((
v4l2_¡d_id
)0x00000100)

	)

621 
	#V4L2_STD_PAL_N
 ((
v4l2_¡d_id
)0x00000200)

	)

622 
	#V4L2_STD_PAL_Nc
 ((
v4l2_¡d_id
)0x00000400)

	)

623 
	#V4L2_STD_PAL_60
 ((
v4l2_¡d_id
)0x00000800)

	)

625 
	#V4L2_STD_NTSC_M
 ((
v4l2_¡d_id
)0x00001000)

	)

626 
	#V4L2_STD_NTSC_M_JP
 ((
v4l2_¡d_id
)0x00002000)

	)

627 
	#V4L2_STD_NTSC_443
 ((
v4l2_¡d_id
)0x00004000)

	)

628 
	#V4L2_STD_NTSC_M_KR
 ((
v4l2_¡d_id
)0x00008000)

	)

630 
	#V4L2_STD_SECAM_B
 ((
v4l2_¡d_id
)0x00010000)

	)

631 
	#V4L2_STD_SECAM_D
 ((
v4l2_¡d_id
)0x00020000)

	)

632 
	#V4L2_STD_SECAM_G
 ((
v4l2_¡d_id
)0x00040000)

	)

633 
	#V4L2_STD_SECAM_H
 ((
v4l2_¡d_id
)0x00080000)

	)

634 
	#V4L2_STD_SECAM_K
 ((
v4l2_¡d_id
)0x00100000)

	)

635 
	#V4L2_STD_SECAM_K1
 ((
v4l2_¡d_id
)0x00200000)

	)

636 
	#V4L2_STD_SECAM_L
 ((
v4l2_¡d_id
)0x00400000)

	)

637 
	#V4L2_STD_SECAM_LC
 ((
v4l2_¡d_id
)0x00800000)

	)

640 
	#V4L2_STD_ATSC_8_VSB
 ((
v4l2_¡d_id
)0x01000000)

	)

641 
	#V4L2_STD_ATSC_16_VSB
 ((
v4l2_¡d_id
)0x02000000)

	)

653 
	#V4L2_STD_MN
 (
V4L2_STD_PAL_M
|
V4L2_STD_PAL_N
|
V4L2_STD_PAL_Nc
|
V4L2_STD_NTSC
)

	)

654 
	#V4L2_STD_B
 (
V4L2_STD_PAL_B
|
V4L2_STD_PAL_B1
|
V4L2_STD_SECAM_B
)

	)

655 
	#V4L2_STD_GH
 (
V4L2_STD_PAL_G
|
V4L2_STD_PAL_H
|
V4L2_STD_SECAM_G
|
V4L2_STD_SECAM_H
)

	)

656 
	#V4L2_STD_DK
 (
V4L2_STD_PAL_DK
|
V4L2_STD_SECAM_DK
)

	)

659 
	#V4L2_STD_PAL_BG
 (
V4L2_STD_PAL_B
 |\

660 
V4L2_STD_PAL_B1
 |\

661 
V4L2_STD_PAL_G
)

	)

662 
	#V4L2_STD_PAL_DK
 (
V4L2_STD_PAL_D
 |\

663 
V4L2_STD_PAL_D1
 |\

664 
V4L2_STD_PAL_K
)

	)

665 
	#V4L2_STD_PAL
 (
V4L2_STD_PAL_BG
 |\

666 
V4L2_STD_PAL_DK
 |\

667 
V4L2_STD_PAL_H
 |\

668 
V4L2_STD_PAL_I
)

	)

669 
	#V4L2_STD_NTSC
 (
V4L2_STD_NTSC_M
 |\

670 
V4L2_STD_NTSC_M_JP
 |\

671 
V4L2_STD_NTSC_M_KR
)

	)

672 
	#V4L2_STD_SECAM_DK
 (
V4L2_STD_SECAM_D
 |\

673 
V4L2_STD_SECAM_K
 |\

674 
V4L2_STD_SECAM_K1
)

	)

675 
	#V4L2_STD_SECAM
 (
V4L2_STD_SECAM_B
 |\

676 
V4L2_STD_SECAM_G
 |\

677 
V4L2_STD_SECAM_H
 |\

678 
V4L2_STD_SECAM_DK
 |\

679 
V4L2_STD_SECAM_L
 |\

680 
V4L2_STD_SECAM_LC
)

	)

682 
	#V4L2_STD_525_60
 (
V4L2_STD_PAL_M
 |\

683 
V4L2_STD_PAL_60
 |\

684 
V4L2_STD_NTSC
 |\

685 
V4L2_STD_NTSC_443
)

	)

686 
	#V4L2_STD_625_50
 (
V4L2_STD_PAL
 |\

687 
V4L2_STD_PAL_N
 |\

688 
V4L2_STD_PAL_Nc
 |\

689 
V4L2_STD_SECAM
)

	)

690 
	#V4L2_STD_ATSC
 (
V4L2_STD_ATSC_8_VSB
 |\

691 
V4L2_STD_ATSC_16_VSB
)

	)

693 
	#V4L2_STD_UNKNOWN
 0

	)

694 
	#V4L2_STD_ALL
 (
V4L2_STD_525_60
 |\

695 
V4L2_STD_625_50
)

	)

697 
	sv4l2_¡ªd¬d
 {

698 
__u32
 
	mšdex
;

699 
v4l2_¡d_id
 
	mid
;

700 
__u8
 
	mÇme
[24];

701 
v4l2_äaù
 
	mäam•”iod
;

702 
__u32
 
	mäam–šes
;

703 
__u32
 
	m»£rved
[4];

709 
	sv4l2_šput
 {

710 
__u32
 
	mšdex
;

711 
__u8
 
	mÇme
[32];

712 
__u32
 
	mty³
;

713 
__u32
 
	maudio£t
;

714 
__u32
 
	mtuÃr
;

715 
v4l2_¡d_id
 
	m¡d
;

716 
__u32
 
	m¡©us
;

717 
__u32
 
	m»£rved
[4];

721 
	#V4L2_INPUT_TYPE_TUNER
 1

	)

722 
	#V4L2_INPUT_TYPE_CAMERA
 2

	)

725 
	#V4L2_IN_ST_NO_POWER
 0x00000001

	)

726 
	#V4L2_IN_ST_NO_SIGNAL
 0x00000002

	)

727 
	#V4L2_IN_ST_NO_COLOR
 0x00000004

	)

730 
	#V4L2_IN_ST_NO_H_LOCK
 0x00000100

	)

731 
	#V4L2_IN_ST_COLOR_KILL
 0x00000200

	)

734 
	#V4L2_IN_ST_NO_SYNC
 0x00010000

	)

735 
	#V4L2_IN_ST_NO_EQU
 0x00020000

	)

736 
	#V4L2_IN_ST_NO_CARRIER
 0x00040000

	)

739 
	#V4L2_IN_ST_MACROVISION
 0x01000000

	)

740 
	#V4L2_IN_ST_NO_ACCESS
 0x02000000

	)

741 
	#V4L2_IN_ST_VTR
 0x04000000

	)

746 
	sv4l2_ouut
 {

747 
__u32
 
	mšdex
;

748 
__u8
 
	mÇme
[32];

749 
__u32
 
	mty³
;

750 
__u32
 
	maudio£t
;

751 
__u32
 
	mmoduÏtÜ
;

752 
v4l2_¡d_id
 
	m¡d
;

753 
__u32
 
	m»£rved
[4];

756 
	#V4L2_OUTPUT_TYPE_MODULATOR
 1

	)

757 
	#V4L2_OUTPUT_TYPE_ANALOG
 2

	)

758 
	#V4L2_OUTPUT_TYPE_ANALOGVGAOVERLAY
 3

	)

763 
	sv4l2_cÚŒŞ
 {

764 
__u32
 
	mid
;

765 
__s32
 
	mv®ue
;

768 
	sv4l2_ext_cÚŒŞ
 {

769 
__u32
 
	mid
;

770 
__u32
 
	m»£rved2
[2];

772 
__s32
 
	mv®ue
;

773 
__s64
 
	mv®ue64
;

774 *
	m»£rved
;

776 } 
__©Œibu‹__
 ((
·cked
));

778 
	sv4l2_ext_cÚŒŞs
 {

779 
__u32
 
	mù¾_şass
;

780 
__u32
 
	mcouÁ
;

781 
__u32
 
	m”rÜ_idx
;

782 
__u32
 
	m»£rved
[2];

783 
v4l2_ext_cÚŒŞ
 *
	mcÚŒŞs
;

787 
	#V4L2_CTRL_CLASS_USER
 0x00980000

	)

788 
	#V4L2_CTRL_CLASS_MPEG
 0x00990000

	)

789 
	#V4L2_CTRL_CLASS_CAMERA
 0x009a0000

	)

791 
	#V4L2_CTRL_ID_MASK
 (0x0fffffff)

	)

792 
	#V4L2_CTRL_ID2CLASS
(
id
è((idè& 0x0fff0000UL)

	)

793 
	#V4L2_CTRL_DRIVER_PRIV
(
id
è(((idè& 0xffffè>ğ0x1000)

	)

796 
	sv4l2_qu”yù¾
 {

797 
__u32
 
	mid
;

798 
v4l2_ù¾_ty³
 
	mty³
;

799 
__u8
 
	mÇme
[32];

800 
__s32
 
	mmšimum
;

801 
__s32
 
	mmaximum
;

802 
__s32
 
	m¡•
;

803 
__s32
 
	mdeçuÉ_v®ue
;

804 
__u32
 
	mæags
;

805 
__u32
 
	m»£rved
[2];

809 
	sv4l2_qu”ym’u
 {

810 
__u32
 
	mid
;

811 
__u32
 
	mšdex
;

812 
__u8
 
	mÇme
[32];

813 
__u32
 
	m»£rved
;

817 
	#V4L2_CTRL_FLAG_DISABLED
 0x0001

	)

818 
	#V4L2_CTRL_FLAG_GRABBED
 0x0002

	)

819 
	#V4L2_CTRL_FLAG_READ_ONLY
 0x0004

	)

820 
	#V4L2_CTRL_FLAG_UPDATE
 0x0008

	)

821 
	#V4L2_CTRL_FLAG_INACTIVE
 0x0010

	)

822 
	#V4L2_CTRL_FLAG_SLIDER
 0x0020

	)

825 
	#V4L2_CTRL_FLAG_NEXT_CTRL
 0x80000000

	)

828 
	#V4L2_CID_BASE
 (
V4L2_CTRL_CLASS_USER
 | 0x900)

	)

829 
	#V4L2_CID_USER_BASE
 
V4L2_CID_BASE


	)

831 
	#V4L2_CID_PRIVATE_BASE
 0x08000000

	)

833 
	#V4L2_CID_USER_CLASS
 (
V4L2_CTRL_CLASS_USER
 | 1)

	)

834 
	#V4L2_CID_BRIGHTNESS
 (
V4L2_CID_BASE
+0)

	)

835 
	#V4L2_CID_CONTRAST
 (
V4L2_CID_BASE
+1)

	)

836 
	#V4L2_CID_SATURATION
 (
V4L2_CID_BASE
+2)

	)

837 
	#V4L2_CID_HUE
 (
V4L2_CID_BASE
+3)

	)

838 
	#V4L2_CID_AUDIO_VOLUME
 (
V4L2_CID_BASE
+5)

	)

839 
	#V4L2_CID_AUDIO_BALANCE
 (
V4L2_CID_BASE
+6)

	)

840 
	#V4L2_CID_AUDIO_BASS
 (
V4L2_CID_BASE
+7)

	)

841 
	#V4L2_CID_AUDIO_TREBLE
 (
V4L2_CID_BASE
+8)

	)

842 
	#V4L2_CID_AUDIO_MUTE
 (
V4L2_CID_BASE
+9)

	)

843 
	#V4L2_CID_AUDIO_LOUDNESS
 (
V4L2_CID_BASE
+10)

	)

844 
	#V4L2_CID_BLACK_LEVEL
 (
V4L2_CID_BASE
+11è

	)

845 
	#V4L2_CID_AUTO_WHITE_BALANCE
 (
V4L2_CID_BASE
+12)

	)

846 
	#V4L2_CID_DO_WHITE_BALANCE
 (
V4L2_CID_BASE
+13)

	)

847 
	#V4L2_CID_RED_BALANCE
 (
V4L2_CID_BASE
+14)

	)

848 
	#V4L2_CID_BLUE_BALANCE
 (
V4L2_CID_BASE
+15)

	)

849 
	#V4L2_CID_GAMMA
 (
V4L2_CID_BASE
+16)

	)

850 
	#V4L2_CID_WHITENESS
 (
V4L2_CID_GAMMA
è

	)

851 
	#V4L2_CID_EXPOSURE
 (
V4L2_CID_BASE
+17)

	)

852 
	#V4L2_CID_AUTOGAIN
 (
V4L2_CID_BASE
+18)

	)

853 
	#V4L2_CID_GAIN
 (
V4L2_CID_BASE
+19)

	)

854 
	#V4L2_CID_HFLIP
 (
V4L2_CID_BASE
+20)

	)

855 
	#V4L2_CID_VFLIP
 (
V4L2_CID_BASE
+21)

	)

858 
	#V4L2_CID_HCENTER
 (
V4L2_CID_BASE
+22)

	)

859 
	#V4L2_CID_VCENTER
 (
V4L2_CID_BASE
+23)

	)

861 
	#V4L2_CID_POWER_LINE_FREQUENCY
 (
V4L2_CID_BASE
+24)

	)

862 
	ev4l2_pow”_lše_äequ’cy
 {

863 
	mV4L2_CID_POWER_LINE_FREQUENCY_DISABLED
 = 0,

864 
	mV4L2_CID_POWER_LINE_FREQUENCY_50HZ
 = 1,

865 
	mV4L2_CID_POWER_LINE_FREQUENCY_60HZ
 = 2,

867 
	#V4L2_CID_HUE_AUTO
 (
V4L2_CID_BASE
+25)

	)

868 
	#V4L2_CID_WHITE_BALANCE_TEMPERATURE
 (
V4L2_CID_BASE
+26)

	)

869 
	#V4L2_CID_SHARPNESS
 (
V4L2_CID_BASE
+27)

	)

870 
	#V4L2_CID_BACKLIGHT_COMPENSATION
 (
V4L2_CID_BASE
+28)

	)

871 
	#V4L2_CID_CHROMA_AGC
 (
V4L2_CID_BASE
+29)

	)

872 
	#V4L2_CID_COLOR_KILLER
 (
V4L2_CID_BASE
+30)

	)

874 
	#V4L2_CID_LASTP1
 (
V4L2_CID_BASE
+31)

	)

877 
	#V4L2_CID_MPEG_BASE
 (
V4L2_CTRL_CLASS_MPEG
 | 0x900)

	)

878 
	#V4L2_CID_MPEG_CLASS
 (
V4L2_CTRL_CLASS_MPEG
 | 1)

	)

881 
	#V4L2_CID_MPEG_STREAM_TYPE
 (
V4L2_CID_MPEG_BASE
+0)

	)

882 
	ev4l2_m³g_¡»am_ty³
 {

883 
	mV4L2_MPEG_STREAM_TYPE_MPEG2_PS
 = 0,

884 
	mV4L2_MPEG_STREAM_TYPE_MPEG2_TS
 = 1,

885 
	mV4L2_MPEG_STREAM_TYPE_MPEG1_SS
 = 2,

886 
	mV4L2_MPEG_STREAM_TYPE_MPEG2_DVD
 = 3,

887 
	mV4L2_MPEG_STREAM_TYPE_MPEG1_VCD
 = 4,

888 
	mV4L2_MPEG_STREAM_TYPE_MPEG2_SVCD
 = 5,

890 
	#V4L2_CID_MPEG_STREAM_PID_PMT
 (
V4L2_CID_MPEG_BASE
+1)

	)

891 
	#V4L2_CID_MPEG_STREAM_PID_AUDIO
 (
V4L2_CID_MPEG_BASE
+2)

	)

892 
	#V4L2_CID_MPEG_STREAM_PID_VIDEO
 (
V4L2_CID_MPEG_BASE
+3)

	)

893 
	#V4L2_CID_MPEG_STREAM_PID_PCR
 (
V4L2_CID_MPEG_BASE
+4)

	)

894 
	#V4L2_CID_MPEG_STREAM_PES_ID_AUDIO
 (
V4L2_CID_MPEG_BASE
+5)

	)

895 
	#V4L2_CID_MPEG_STREAM_PES_ID_VIDEO
 (
V4L2_CID_MPEG_BASE
+6)

	)

896 
	#V4L2_CID_MPEG_STREAM_VBI_FMT
 (
V4L2_CID_MPEG_BASE
+7)

	)

897 
	ev4l2_m³g_¡»am_vbi_fmt
 {

898 
	mV4L2_MPEG_STREAM_VBI_FMT_NONE
 = 0,

899 
	mV4L2_MPEG_STREAM_VBI_FMT_IVTV
 = 1,

903 
	#V4L2_CID_MPEG_AUDIO_SAMPLING_FREQ
 (
V4L2_CID_MPEG_BASE
+100)

	)

904 
	ev4l2_m³g_audio_§m¶šg_äeq
 {

905 
	mV4L2_MPEG_AUDIO_SAMPLING_FREQ_44100
 = 0,

906 
	mV4L2_MPEG_AUDIO_SAMPLING_FREQ_48000
 = 1,

907 
	mV4L2_MPEG_AUDIO_SAMPLING_FREQ_32000
 = 2,

909 
	#V4L2_CID_MPEG_AUDIO_ENCODING
 (
V4L2_CID_MPEG_BASE
+101)

	)

910 
	ev4l2_m³g_audio_’codšg
 {

911 
	mV4L2_MPEG_AUDIO_ENCODING_LAYER_1
 = 0,

912 
	mV4L2_MPEG_AUDIO_ENCODING_LAYER_2
 = 1,

913 
	mV4L2_MPEG_AUDIO_ENCODING_LAYER_3
 = 2,

914 
	mV4L2_MPEG_AUDIO_ENCODING_AAC
 = 3,

915 
	mV4L2_MPEG_AUDIO_ENCODING_AC3
 = 4,

917 
	#V4L2_CID_MPEG_AUDIO_L1_BITRATE
 (
V4L2_CID_MPEG_BASE
+102)

	)

918 
	ev4l2_m³g_audio_l1_b™¿‹
 {

919 
	mV4L2_MPEG_AUDIO_L1_BITRATE_32K
 = 0,

920 
	mV4L2_MPEG_AUDIO_L1_BITRATE_64K
 = 1,

921 
	mV4L2_MPEG_AUDIO_L1_BITRATE_96K
 = 2,

922 
	mV4L2_MPEG_AUDIO_L1_BITRATE_128K
 = 3,

923 
	mV4L2_MPEG_AUDIO_L1_BITRATE_160K
 = 4,

924 
	mV4L2_MPEG_AUDIO_L1_BITRATE_192K
 = 5,

925 
	mV4L2_MPEG_AUDIO_L1_BITRATE_224K
 = 6,

926 
	mV4L2_MPEG_AUDIO_L1_BITRATE_256K
 = 7,

927 
	mV4L2_MPEG_AUDIO_L1_BITRATE_288K
 = 8,

928 
	mV4L2_MPEG_AUDIO_L1_BITRATE_320K
 = 9,

929 
	mV4L2_MPEG_AUDIO_L1_BITRATE_352K
 = 10,

930 
	mV4L2_MPEG_AUDIO_L1_BITRATE_384K
 = 11,

931 
	mV4L2_MPEG_AUDIO_L1_BITRATE_416K
 = 12,

932 
	mV4L2_MPEG_AUDIO_L1_BITRATE_448K
 = 13,

934 
	#V4L2_CID_MPEG_AUDIO_L2_BITRATE
 (
V4L2_CID_MPEG_BASE
+103)

	)

935 
	ev4l2_m³g_audio_l2_b™¿‹
 {

936 
	mV4L2_MPEG_AUDIO_L2_BITRATE_32K
 = 0,

937 
	mV4L2_MPEG_AUDIO_L2_BITRATE_48K
 = 1,

938 
	mV4L2_MPEG_AUDIO_L2_BITRATE_56K
 = 2,

939 
	mV4L2_MPEG_AUDIO_L2_BITRATE_64K
 = 3,

940 
	mV4L2_MPEG_AUDIO_L2_BITRATE_80K
 = 4,

941 
	mV4L2_MPEG_AUDIO_L2_BITRATE_96K
 = 5,

942 
	mV4L2_MPEG_AUDIO_L2_BITRATE_112K
 = 6,

943 
	mV4L2_MPEG_AUDIO_L2_BITRATE_128K
 = 7,

944 
	mV4L2_MPEG_AUDIO_L2_BITRATE_160K
 = 8,

945 
	mV4L2_MPEG_AUDIO_L2_BITRATE_192K
 = 9,

946 
	mV4L2_MPEG_AUDIO_L2_BITRATE_224K
 = 10,

947 
	mV4L2_MPEG_AUDIO_L2_BITRATE_256K
 = 11,

948 
	mV4L2_MPEG_AUDIO_L2_BITRATE_320K
 = 12,

949 
	mV4L2_MPEG_AUDIO_L2_BITRATE_384K
 = 13,

951 
	#V4L2_CID_MPEG_AUDIO_L3_BITRATE
 (
V4L2_CID_MPEG_BASE
+104)

	)

952 
	ev4l2_m³g_audio_l3_b™¿‹
 {

953 
	mV4L2_MPEG_AUDIO_L3_BITRATE_32K
 = 0,

954 
	mV4L2_MPEG_AUDIO_L3_BITRATE_40K
 = 1,

955 
	mV4L2_MPEG_AUDIO_L3_BITRATE_48K
 = 2,

956 
	mV4L2_MPEG_AUDIO_L3_BITRATE_56K
 = 3,

957 
	mV4L2_MPEG_AUDIO_L3_BITRATE_64K
 = 4,

958 
	mV4L2_MPEG_AUDIO_L3_BITRATE_80K
 = 5,

959 
	mV4L2_MPEG_AUDIO_L3_BITRATE_96K
 = 6,

960 
	mV4L2_MPEG_AUDIO_L3_BITRATE_112K
 = 7,

961 
	mV4L2_MPEG_AUDIO_L3_BITRATE_128K
 = 8,

962 
	mV4L2_MPEG_AUDIO_L3_BITRATE_160K
 = 9,

963 
	mV4L2_MPEG_AUDIO_L3_BITRATE_192K
 = 10,

964 
	mV4L2_MPEG_AUDIO_L3_BITRATE_224K
 = 11,

965 
	mV4L2_MPEG_AUDIO_L3_BITRATE_256K
 = 12,

966 
	mV4L2_MPEG_AUDIO_L3_BITRATE_320K
 = 13,

968 
	#V4L2_CID_MPEG_AUDIO_MODE
 (
V4L2_CID_MPEG_BASE
+105)

	)

969 
	ev4l2_m³g_audio_mode
 {

970 
	mV4L2_MPEG_AUDIO_MODE_STEREO
 = 0,

971 
	mV4L2_MPEG_AUDIO_MODE_JOINT_STEREO
 = 1,

972 
	mV4L2_MPEG_AUDIO_MODE_DUAL
 = 2,

973 
	mV4L2_MPEG_AUDIO_MODE_MONO
 = 3,

975 
	#V4L2_CID_MPEG_AUDIO_MODE_EXTENSION
 (
V4L2_CID_MPEG_BASE
+106)

	)

976 
	ev4l2_m³g_audio_mode_ex‹nsiÚ
 {

977 
	mV4L2_MPEG_AUDIO_MODE_EXTENSION_BOUND_4
 = 0,

978 
	mV4L2_MPEG_AUDIO_MODE_EXTENSION_BOUND_8
 = 1,

979 
	mV4L2_MPEG_AUDIO_MODE_EXTENSION_BOUND_12
 = 2,

980 
	mV4L2_MPEG_AUDIO_MODE_EXTENSION_BOUND_16
 = 3,

982 
	#V4L2_CID_MPEG_AUDIO_EMPHASIS
 (
V4L2_CID_MPEG_BASE
+107)

	)

983 
	ev4l2_m³g_audio_emphasis
 {

984 
	mV4L2_MPEG_AUDIO_EMPHASIS_NONE
 = 0,

985 
	mV4L2_MPEG_AUDIO_EMPHASIS_50_DIV_15_uS
 = 1,

986 
	mV4L2_MPEG_AUDIO_EMPHASIS_CCITT_J17
 = 2,

988 
	#V4L2_CID_MPEG_AUDIO_CRC
 (
V4L2_CID_MPEG_BASE
+108)

	)

989 
	ev4l2_m³g_audio_üc
 {

990 
	mV4L2_MPEG_AUDIO_CRC_NONE
 = 0,

991 
	mV4L2_MPEG_AUDIO_CRC_CRC16
 = 1,

993 
	#V4L2_CID_MPEG_AUDIO_MUTE
 (
V4L2_CID_MPEG_BASE
+109)

	)

994 
	#V4L2_CID_MPEG_AUDIO_AAC_BITRATE
 (
V4L2_CID_MPEG_BASE
+110)

	)

995 
	#V4L2_CID_MPEG_AUDIO_AC3_BITRATE
 (
V4L2_CID_MPEG_BASE
+111)

	)

996 
	ev4l2_m³g_audio_ac3_b™¿‹
 {

997 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_32K
 = 0,

998 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_40K
 = 1,

999 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_48K
 = 2,

1000 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_56K
 = 3,

1001 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_64K
 = 4,

1002 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_80K
 = 5,

1003 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_96K
 = 6,

1004 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_112K
 = 7,

1005 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_128K
 = 8,

1006 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_160K
 = 9,

1007 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_192K
 = 10,

1008 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_224K
 = 11,

1009 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_256K
 = 12,

1010 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_320K
 = 13,

1011 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_384K
 = 14,

1012 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_448K
 = 15,

1013 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_512K
 = 16,

1014 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_576K
 = 17,

1015 
	mV4L2_MPEG_AUDIO_AC3_BITRATE_640K
 = 18,

1019 
	#V4L2_CID_MPEG_VIDEO_ENCODING
 (
V4L2_CID_MPEG_BASE
+200)

	)

1020 
	ev4l2_m³g_video_’codšg
 {

1021 
	mV4L2_MPEG_VIDEO_ENCODING_MPEG_1
 = 0,

1022 
	mV4L2_MPEG_VIDEO_ENCODING_MPEG_2
 = 1,

1023 
	mV4L2_MPEG_VIDEO_ENCODING_MPEG_4_AVC
 = 2,

1025 
	#V4L2_CID_MPEG_VIDEO_ASPECT
 (
V4L2_CID_MPEG_BASE
+201)

	)

1026 
	ev4l2_m³g_video_a¥eù
 {

1027 
	mV4L2_MPEG_VIDEO_ASPECT_1x1
 = 0,

1028 
	mV4L2_MPEG_VIDEO_ASPECT_4x3
 = 1,

1029 
	mV4L2_MPEG_VIDEO_ASPECT_16x9
 = 2,

1030 
	mV4L2_MPEG_VIDEO_ASPECT_221x100
 = 3,

1032 
	#V4L2_CID_MPEG_VIDEO_B_FRAMES
 (
V4L2_CID_MPEG_BASE
+202)

	)

1033 
	#V4L2_CID_MPEG_VIDEO_GOP_SIZE
 (
V4L2_CID_MPEG_BASE
+203)

	)

1034 
	#V4L2_CID_MPEG_VIDEO_GOP_CLOSURE
 (
V4L2_CID_MPEG_BASE
+204)

	)

1035 
	#V4L2_CID_MPEG_VIDEO_PULLDOWN
 (
V4L2_CID_MPEG_BASE
+205)

	)

1036 
	#V4L2_CID_MPEG_VIDEO_BITRATE_MODE
 (
V4L2_CID_MPEG_BASE
+206)

	)

1037 
	ev4l2_m³g_video_b™¿‹_mode
 {

1038 
	mV4L2_MPEG_VIDEO_BITRATE_MODE_VBR
 = 0,

1039 
	mV4L2_MPEG_VIDEO_BITRATE_MODE_CBR
 = 1,

1041 
	#V4L2_CID_MPEG_VIDEO_BITRATE
 (
V4L2_CID_MPEG_BASE
+207)

	)

1042 
	#V4L2_CID_MPEG_VIDEO_BITRATE_PEAK
 (
V4L2_CID_MPEG_BASE
+208)

	)

1043 
	#V4L2_CID_MPEG_VIDEO_TEMPORAL_DECIMATION
 (
V4L2_CID_MPEG_BASE
+209)

	)

1044 
	#V4L2_CID_MPEG_VIDEO_MUTE
 (
V4L2_CID_MPEG_BASE
+210)

	)

1045 
	#V4L2_CID_MPEG_VIDEO_MUTE_YUV
 (
V4L2_CID_MPEG_BASE
+211)

	)

1048 
	#V4L2_CID_MPEG_CX2341X_BASE
 (
V4L2_CTRL_CLASS_MPEG
 | 0x1000)

	)

1049 
	#V4L2_CID_MPEG_CX2341X_VIDEO_SPATIAL_FILTER_MODE
 (
V4L2_CID_MPEG_CX2341X_BASE
+0)

	)

1050 
	ev4l2_m³g_cx2341x_video_¥©Ÿl_f‹r_mode
 {

1051 
	mV4L2_MPEG_CX2341X_VIDEO_SPATIAL_FILTER_MODE_MANUAL
 = 0,

1052 
	mV4L2_MPEG_CX2341X_VIDEO_SPATIAL_FILTER_MODE_AUTO
 = 1,

1054 
	#V4L2_CID_MPEG_CX2341X_VIDEO_SPATIAL_FILTER
 (
V4L2_CID_MPEG_CX2341X_BASE
+1)

	)

1055 
	#V4L2_CID_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE
 (
V4L2_CID_MPEG_CX2341X_BASE
+2)

	)

1056 
	ev4l2_m³g_cx2341x_video_luma_¥©Ÿl_f‹r_ty³
 {

1057 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_OFF
 = 0,

1058 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_1D_HOR
 = 1,

1059 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_1D_VERT
 = 2,

1060 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_2D_HV_SEPARABLE
 = 3,

1061 
	mV4L2_MPEG_CX2341X_VIDEO_LUMA_SPATIAL_FILTER_TYPE_2D_SYM_NON_SEPARABLE
 = 4,

1063 
	#V4L2_CID_MPEG_CX2341X_VIDEO_CHROMA_SPATIAL_FILTER_TYPE
 (
V4L2_CID_MPEG_CX2341X_BASE
+3)

	)

1064 
	ev4l2_m³g_cx2341x_video_chroma_¥©Ÿl_f‹r_ty³
 {

1065 
	mV4L2_MPEG_CX2341X_VIDEO_CHROMA_SPATIAL_FILTER_TYPE_OFF
 = 0,

1066 
	mV4L2_MPEG_CX2341X_VIDEO_CHROMA_SPATIAL_FILTER_TYPE_1D_HOR
 = 1,

1068 
	#V4L2_CID_MPEG_CX2341X_VIDEO_TEMPORAL_FILTER_MODE
 (
V4L2_CID_MPEG_CX2341X_BASE
+4)

	)

1069 
	ev4l2_m³g_cx2341x_video_‹mpÜ®_f‹r_mode
 {

1070 
	mV4L2_MPEG_CX2341X_VIDEO_TEMPORAL_FILTER_MODE_MANUAL
 = 0,

1071 
	mV4L2_MPEG_CX2341X_VIDEO_TEMPORAL_FILTER_MODE_AUTO
 = 1,

1073 
	#V4L2_CID_MPEG_CX2341X_VIDEO_TEMPORAL_FILTER
 (
V4L2_CID_MPEG_CX2341X_BASE
+5)

	)

1074 
	#V4L2_CID_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE
 (
V4L2_CID_MPEG_CX2341X_BASE
+6)

	)

1075 
	ev4l2_m³g_cx2341x_video_medŸn_f‹r_ty³
 {

1076 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_OFF
 = 0,

1077 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_HOR
 = 1,

1078 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_VERT
 = 2,

1079 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_HOR_VERT
 = 3,

1080 
	mV4L2_MPEG_CX2341X_VIDEO_MEDIAN_FILTER_TYPE_DIAG
 = 4,

1082 
	#V4L2_CID_MPEG_CX2341X_VIDEO_LUMA_MEDIAN_FILTER_BOTTOM
 (
V4L2_CID_MPEG_CX2341X_BASE
+7)

	)

1083 
	#V4L2_CID_MPEG_CX2341X_VIDEO_LUMA_MEDIAN_FILTER_TOP
 (
V4L2_CID_MPEG_CX2341X_BASE
+8)

	)

1084 
	#V4L2_CID_MPEG_CX2341X_VIDEO_CHROMA_MEDIAN_FILTER_BOTTOM
 (
V4L2_CID_MPEG_CX2341X_BASE
+9)

	)

1085 
	#V4L2_CID_MPEG_CX2341X_VIDEO_CHROMA_MEDIAN_FILTER_TOP
 (
V4L2_CID_MPEG_CX2341X_BASE
+10)

	)

1086 
	#V4L2_CID_MPEG_CX2341X_STREAM_INSERT_NAV_PACKETS
 (
V4L2_CID_MPEG_CX2341X_BASE
+11)

	)

1089 
	#V4L2_CID_CAMERA_CLASS_BASE
 (
V4L2_CTRL_CLASS_CAMERA
 | 0x900)

	)

1090 
	#V4L2_CID_CAMERA_CLASS
 (
V4L2_CTRL_CLASS_CAMERA
 | 1)

	)

1092 
	#V4L2_CID_EXPOSURE_AUTO
 (
V4L2_CID_CAMERA_CLASS_BASE
+1)

	)

1093 
	ev4l2_exposu»_auto_ty³
 {

1094 
	mV4L2_EXPOSURE_AUTO
 = 0,

1095 
	mV4L2_EXPOSURE_MANUAL
 = 1,

1096 
	mV4L2_EXPOSURE_SHUTTER_PRIORITY
 = 2,

1097 
	mV4L2_EXPOSURE_APERTURE_PRIORITY
 = 3

1099 
	#V4L2_CID_EXPOSURE_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+2)

	)

1100 
	#V4L2_CID_EXPOSURE_AUTO_PRIORITY
 (
V4L2_CID_CAMERA_CLASS_BASE
+3)

	)

1102 
	#V4L2_CID_PAN_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+4)

	)

1103 
	#V4L2_CID_TILT_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+5)

	)

1104 
	#V4L2_CID_PAN_RESET
 (
V4L2_CID_CAMERA_CLASS_BASE
+6)

	)

1105 
	#V4L2_CID_TILT_RESET
 (
V4L2_CID_CAMERA_CLASS_BASE
+7)

	)

1107 
	#V4L2_CID_PAN_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+8)

	)

1108 
	#V4L2_CID_TILT_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+9)

	)

1110 
	#V4L2_CID_FOCUS_ABSOLUTE
 (
V4L2_CID_CAMERA_CLASS_BASE
+10)

	)

1111 
	#V4L2_CID_FOCUS_RELATIVE
 (
V4L2_CID_CAMERA_CLASS_BASE
+11)

	)

1112 
	#V4L2_CID_FOCUS_AUTO
 (
V4L2_CID_CAMERA_CLASS_BASE
+12)

	)

1117 
	sv4l2_tuÃr
 {

1118 
__u32
 
	mšdex
;

1119 
__u8
 
	mÇme
[32];

1120 
v4l2_tuÃr_ty³
 
	mty³
;

1121 
__u32
 
	mÿ·b™y
;

1122 
__u32
 
	m¿ng–ow
;

1123 
__u32
 
	m¿ngehigh
;

1124 
__u32
 
	mrxsubchªs
;

1125 
__u32
 
	maudmode
;

1126 
__s32
 
	msigÇl
;

1127 
__s32
 
	mafc
;

1128 
__u32
 
	m»£rved
[4];

1131 
	sv4l2_moduÏtÜ
 {

1132 
__u32
 
	mšdex
;

1133 
__u8
 
	mÇme
[32];

1134 
__u32
 
	mÿ·b™y
;

1135 
__u32
 
	m¿ng–ow
;

1136 
__u32
 
	m¿ngehigh
;

1137 
__u32
 
	mtxsubchªs
;

1138 
__u32
 
	m»£rved
[4];

1142 
	#V4L2_TUNER_CAP_LOW
 0x0001

	)

1143 
	#V4L2_TUNER_CAP_NORM
 0x0002

	)

1144 
	#V4L2_TUNER_CAP_STEREO
 0x0010

	)

1145 
	#V4L2_TUNER_CAP_LANG2
 0x0020

	)

1146 
	#V4L2_TUNER_CAP_SAP
 0x0020

	)

1147 
	#V4L2_TUNER_CAP_LANG1
 0x0040

	)

1150 
	#V4L2_TUNER_SUB_MONO
 0x0001

	)

1151 
	#V4L2_TUNER_SUB_STEREO
 0x0002

	)

1152 
	#V4L2_TUNER_SUB_LANG2
 0x0004

	)

1153 
	#V4L2_TUNER_SUB_SAP
 0x0004

	)

1154 
	#V4L2_TUNER_SUB_LANG1
 0x0008

	)

1157 
	#V4L2_TUNER_MODE_MONO
 0x0000

	)

1158 
	#V4L2_TUNER_MODE_STEREO
 0x0001

	)

1159 
	#V4L2_TUNER_MODE_LANG2
 0x0002

	)

1160 
	#V4L2_TUNER_MODE_SAP
 0x0002

	)

1161 
	#V4L2_TUNER_MODE_LANG1
 0x0003

	)

1162 
	#V4L2_TUNER_MODE_LANG1_LANG2
 0x0004

	)

1164 
	sv4l2_äequ’cy
 {

1165 
__u32
 
	mtuÃr
;

1166 
v4l2_tuÃr_ty³
 
	mty³
;

1167 
__u32
 
	mäequ’cy
;

1168 
__u32
 
	m»£rved
[8];

1171 
	sv4l2_hw_äeq_£ek
 {

1172 
__u32
 
	mtuÃr
;

1173 
v4l2_tuÃr_ty³
 
	mty³
;

1174 
__u32
 
	m£ek_upw¬d
;

1175 
__u32
 
	mw¿p_¬ound
;

1176 
__u32
 
	m»£rved
[8];

1182 
	sv4l2_audio
 {

1183 
__u32
 
	mšdex
;

1184 
__u8
 
	mÇme
[32];

1185 
__u32
 
	mÿ·b™y
;

1186 
__u32
 
	mmode
;

1187 
__u32
 
	m»£rved
[2];

1191 
	#V4L2_AUDCAP_STEREO
 0x00001

	)

1192 
	#V4L2_AUDCAP_AVL
 0x00002

	)

1195 
	#V4L2_AUDMODE_AVL
 0x00001

	)

1197 
	sv4l2_audioout
 {

1198 
__u32
 
	mšdex
;

1199 
__u8
 
	mÇme
[32];

1200 
__u32
 
	mÿ·b™y
;

1201 
__u32
 
	mmode
;

1202 
__u32
 
	m»£rved
[2];

1211 
	#V4L2_ENC_IDX_FRAME_I
 (0)

	)

1212 
	#V4L2_ENC_IDX_FRAME_P
 (1)

	)

1213 
	#V4L2_ENC_IDX_FRAME_B
 (2)

	)

1214 
	#V4L2_ENC_IDX_FRAME_MASK
 (0xf)

	)

1216 
	sv4l2_’c_idx_’Œy
 {

1217 
__u64
 
	moff£t
;

1218 
__u64
 
	m±s
;

1219 
__u32
 
	mËngth
;

1220 
__u32
 
	mæags
;

1221 
__u32
 
	m»£rved
[2];

1224 
	#V4L2_ENC_IDX_ENTRIES
 (64)

	)

1225 
	sv4l2_’c_idx
 {

1226 
__u32
 
	m’Œ›s
;

1227 
__u32
 
	m’Œ›s_ÿp
;

1228 
__u32
 
	m»£rved
[4];

1229 
v4l2_’c_idx_’Œy
 
	m’Œy
[
V4L2_ENC_IDX_ENTRIES
];

1233 
	#V4L2_ENC_CMD_START
 (0)

	)

1234 
	#V4L2_ENC_CMD_STOP
 (1)

	)

1235 
	#V4L2_ENC_CMD_PAUSE
 (2)

	)

1236 
	#V4L2_ENC_CMD_RESUME
 (3)

	)

1239 
	#V4L2_ENC_CMD_STOP_AT_GOP_END
 (1 << 0)

	)

1241 
	sv4l2_’cod”_cmd
 {

1242 
__u32
 
	mcmd
;

1243 
__u32
 
	mæags
;

1246 
__u32
 
	md©a
[8];

1247 } 
	m¿w
;

1261 
	sv4l2_vbi_fÜm©
 {

1262 
__u32
 
	m§m¶šg_¿‹
;

1263 
__u32
 
	moff£t
;

1264 
__u32
 
	m§m¶es_³r_lše
;

1265 
__u32
 
	m§m¶e_fÜm©
;

1266 
__s32
 
	m¡¬t
[2];

1267 
__u32
 
	mcouÁ
[2];

1268 
__u32
 
	mæags
;

1269 
__u32
 
	m»£rved
[2];

1273 
	#V4L2_VBI_UNSYNC
 (1 << 0)

	)

1274 
	#V4L2_VBI_INTERLACED
 (1 << 1)

	)

1283 
	sv4l2_¦iûd_vbi_fÜm©
 {

1284 
__u16
 
	m£rviû_£t
;

1289 
__u16
 
	m£rviû_lšes
[2][24];

1290 
__u32
 
	mio_size
;

1291 
__u32
 
	m»£rved
[2];

1296 
	#V4L2_SLICED_TELETEXT_B
 (0x0001)

	)

1298 
	#V4L2_SLICED_VPS
 (0x0400)

	)

1300 
	#V4L2_SLICED_CAPTION_525
 (0x1000)

	)

1302 
	#V4L2_SLICED_WSS_625
 (0x4000)

	)

1304 
	#V4L2_SLICED_VBI_525
 (
V4L2_SLICED_CAPTION_525
)

	)

1305 
	#V4L2_SLICED_VBI_625
 (
V4L2_SLICED_TELETEXT_B
 | 
V4L2_SLICED_VPS
 | 
V4L2_SLICED_WSS_625
)

	)

1307 
	sv4l2_¦iûd_vbi_ÿp
 {

1308 
__u16
 
	m£rviû_£t
;

1313 
__u16
 
	m£rviû_lšes
[2][24];

1314 
v4l2_buf_ty³
 
	mty³
;

1315 
__u32
 
	m»£rved
[3];

1318 
	sv4l2_¦iûd_vbi_d©a
 {

1319 
__u32
 
	mid
;

1320 
__u32
 
	mf›ld
;

1321 
__u32
 
	mlše
;

1322 
__u32
 
	m»£rved
;

1323 
__u8
 
	md©a
[48];

1332 
	sv4l2_fÜm©
 {

1333 
v4l2_buf_ty³
 
	mty³
;

1335 
v4l2_pix_fÜm©
 
	mpix
;

1336 
v4l2_wšdow
 
	mwš
;

1337 
v4l2_vbi_fÜm©
 
	mvbi
;

1338 
v4l2_¦iûd_vbi_fÜm©
 
	m¦iûd
;

1339 
__u8
 
	m¿w_d©a
[200];

1340 } 
	mfmt
;

1346 
	sv4l2_¡»am·rm
 {

1347 
v4l2_buf_ty³
 
	mty³
;

1349 
v4l2_ÿ±u»·rm
 
	mÿ±u»
;

1350 
v4l2_ouu¬m
 
	mouut
;

1351 
__u8
 
	m¿w_d©a
[200];

1352 } 
	m·rm
;

1363 
	#V4L2_CHIP_MATCH_HOST
 0

	)

1364 
	#V4L2_CHIP_MATCH_I2C_DRIVER
 1

	)

1365 
	#V4L2_CHIP_MATCH_I2C_ADDR
 2

	)

1367 
	sv4l2_»gi¡”
 {

1368 
__u32
 
	mm©ch_ty³
;

1369 
__u32
 
	mm©ch_ch
;

1370 
__u64
 
	m»g
;

1371 
__u64
 
	mv®
;

1375 
	sv4l2_ch_id’t
 {

1376 
__u32
 
	mm©ch_ty³
;

1377 
__u32
 
	mm©ch_ch
;

1378 
__u32
 
	mid’t
;

1379 
__u32
 
	m»visiÚ
;

1386 
	#VIDIOC_QUERYCAP
 
	`_IOR
('V', 0, 
v4l2_ÿ·b™y
)

	)

1387 
	#VIDIOC_RESERVED
 
	`_IO
('V', 1)

	)

1388 
	#VIDIOC_ENUM_FMT
 
	`_IOWR
('V', 2, 
v4l2_fmtdesc
)

	)

1389 
	#VIDIOC_G_FMT
 
	`_IOWR
('V', 4, 
v4l2_fÜm©
)

	)

1390 
	#VIDIOC_S_FMT
 
	`_IOWR
('V', 5, 
v4l2_fÜm©
)

	)

1391 
	#VIDIOC_REQBUFS
 
	`_IOWR
('V', 8, 
v4l2_»que¡bufãrs
)

	)

1392 
	#VIDIOC_QUERYBUF
 
	`_IOWR
('V', 9, 
v4l2_bufãr
)

	)

1393 
	#VIDIOC_G_FBUF
 
	`_IOR
('V', 10, 
v4l2_äamebufãr
)

	)

1394 
	#VIDIOC_S_FBUF
 
	`_IOW
('V', 11, 
v4l2_äamebufãr
)

	)

1395 
	#VIDIOC_OVERLAY
 
	`_IOW
('V', 14, )

	)

1396 
	#VIDIOC_QBUF
 
	`_IOWR
('V', 15, 
v4l2_bufãr
)

	)

1397 
	#VIDIOC_DQBUF
 
	`_IOWR
('V', 17, 
v4l2_bufãr
)

	)

1398 
	#VIDIOC_STREAMON
 
	`_IOW
('V', 18, )

	)

1399 
	#VIDIOC_STREAMOFF
 
	`_IOW
('V', 19, )

	)

1400 
	#VIDIOC_G_PARM
 
	`_IOWR
('V', 21, 
v4l2_¡»am·rm
)

	)

1401 
	#VIDIOC_S_PARM
 
	`_IOWR
('V', 22, 
v4l2_¡»am·rm
)

	)

1402 
	#VIDIOC_G_STD
 
	`_IOR
('V', 23, 
v4l2_¡d_id
)

	)

1403 
	#VIDIOC_S_STD
 
	`_IOW
('V', 24, 
v4l2_¡d_id
)

	)

1404 
	#VIDIOC_ENUMSTD
 
	`_IOWR
('V', 25, 
v4l2_¡ªd¬d
)

	)

1405 
	#VIDIOC_ENUMINPUT
 
	`_IOWR
('V', 26, 
v4l2_šput
)

	)

1406 
	#VIDIOC_G_CTRL
 
	`_IOWR
('V', 27, 
v4l2_cÚŒŞ
)

	)

1407 
	#VIDIOC_S_CTRL
 
	`_IOWR
('V', 28, 
v4l2_cÚŒŞ
)

	)

1408 
	#VIDIOC_G_TUNER
 
	`_IOWR
('V', 29, 
v4l2_tuÃr
)

	)

1409 
	#VIDIOC_S_TUNER
 
	`_IOW
('V', 30, 
v4l2_tuÃr
)

	)

1410 
	#VIDIOC_G_AUDIO
 
	`_IOR
('V', 33, 
v4l2_audio
)

	)

1411 
	#VIDIOC_S_AUDIO
 
	`_IOW
('V', 34, 
v4l2_audio
)

	)

1412 
	#VIDIOC_QUERYCTRL
 
	`_IOWR
('V', 36, 
v4l2_qu”yù¾
)

	)

1413 
	#VIDIOC_QUERYMENU
 
	`_IOWR
('V', 37, 
v4l2_qu”ym’u
)

	)

1414 
	#VIDIOC_G_INPUT
 
	`_IOR
('V', 38, )

	)

1415 
	#VIDIOC_S_INPUT
 
	`_IOWR
('V', 39, )

	)

1416 
	#VIDIOC_G_OUTPUT
 
	`_IOR
('V', 46, )

	)

1417 
	#VIDIOC_S_OUTPUT
 
	`_IOWR
('V', 47, )

	)

1418 
	#VIDIOC_ENUMOUTPUT
 
	`_IOWR
('V', 48, 
v4l2_ouut
)

	)

1419 
	#VIDIOC_G_AUDOUT
 
	`_IOR
('V', 49, 
v4l2_audioout
)

	)

1420 
	#VIDIOC_S_AUDOUT
 
	`_IOW
('V', 50, 
v4l2_audioout
)

	)

1421 
	#VIDIOC_G_MODULATOR
 
	`_IOWR
('V', 54, 
v4l2_moduÏtÜ
)

	)

1422 
	#VIDIOC_S_MODULATOR
 
	`_IOW
('V', 55, 
v4l2_moduÏtÜ
)

	)

1423 
	#VIDIOC_G_FREQUENCY
 
	`_IOWR
('V', 56, 
v4l2_äequ’cy
)

	)

1424 
	#VIDIOC_S_FREQUENCY
 
	`_IOW
('V', 57, 
v4l2_äequ’cy
)

	)

1425 
	#VIDIOC_CROPCAP
 
	`_IOWR
('V', 58, 
v4l2_üİÿp
)

	)

1426 
	#VIDIOC_G_CROP
 
	`_IOWR
('V', 59, 
v4l2_üİ
)

	)

1427 
	#VIDIOC_S_CROP
 
	`_IOW
('V', 60, 
v4l2_üİ
)

	)

1428 
	#VIDIOC_G_JPEGCOMP
 
	`_IOR
('V', 61, 
v4l2_j³gcom´essiÚ
)

	)

1429 
	#VIDIOC_S_JPEGCOMP
 
	`_IOW
('V', 62, 
v4l2_j³gcom´essiÚ
)

	)

1430 
	#VIDIOC_QUERYSTD
 
	`_IOR
('V', 63, 
v4l2_¡d_id
)

	)

1431 
	#VIDIOC_TRY_FMT
 
	`_IOWR
('V', 64, 
v4l2_fÜm©
)

	)

1432 
	#VIDIOC_ENUMAUDIO
 
	`_IOWR
('V', 65, 
v4l2_audio
)

	)

1433 
	#VIDIOC_ENUMAUDOUT
 
	`_IOWR
('V', 66, 
v4l2_audioout
)

	)

1434 
	#VIDIOC_G_PRIORITY
 
	`_IOR
('V', 67, 
v4l2_´iÜ™y
)

	)

1435 
	#VIDIOC_S_PRIORITY
 
	`_IOW
('V', 68, 
v4l2_´iÜ™y
)

	)

1436 
	#VIDIOC_G_SLICED_VBI_CAP
 
	`_IOWR
('V', 69, 
v4l2_¦iûd_vbi_ÿp
)

	)

1437 
	#VIDIOC_LOG_STATUS
 
	`_IO
('V', 70)

	)

1438 
	#VIDIOC_G_EXT_CTRLS
 
	`_IOWR
('V', 71, 
v4l2_ext_cÚŒŞs
)

	)

1439 
	#VIDIOC_S_EXT_CTRLS
 
	`_IOWR
('V', 72, 
v4l2_ext_cÚŒŞs
)

	)

1440 
	#VIDIOC_TRY_EXT_CTRLS
 
	`_IOWR
('V', 73, 
v4l2_ext_cÚŒŞs
)

	)

1442 
	#VIDIOC_ENUM_FRAMESIZES
 
	`_IOWR
('V', 74, 
v4l2_ämsiz“num
)

	)

1443 
	#VIDIOC_ENUM_FRAMEINTERVALS
 
	`_IOWR
('V', 75, 
v4l2_ämiv®’um
)

	)

1444 
	#VIDIOC_G_ENC_INDEX
 
	`_IOR
('V', 76, 
v4l2_’c_idx
)

	)

1445 
	#VIDIOC_ENCODER_CMD
 
	`_IOWR
('V', 77, 
v4l2_’cod”_cmd
)

	)

1446 
	#VIDIOC_TRY_ENCODER_CMD
 
	`_IOWR
('V', 78, 
v4l2_’cod”_cmd
)

	)

1449 
	#VIDIOC_DBG_S_REGISTER
 
	`_IOW
('V', 79, 
v4l2_»gi¡”
)

	)

1450 
	#VIDIOC_DBG_G_REGISTER
 
	`_IOWR
('V', 80, 
v4l2_»gi¡”
)

	)

1452 
	#VIDIOC_G_CHIP_IDENT
 
	`_IOWR
('V', 81, 
v4l2_ch_id’t
)

	)

1454 
	#VIDIOC_S_HW_FREQ_SEEK
 
	`_IOW
('V', 82, 
v4l2_hw_äeq_£ek
)

	)

1456 #ifdeà
__OLD_VIDIOC_


1458 
	#VIDIOC_OVERLAY_OLD
 
	`_IOWR
('V', 14, )

	)

1459 
	#VIDIOC_S_PARM_OLD
 
	`_IOW
('V', 22, 
v4l2_¡»am·rm
)

	)

1460 
	#VIDIOC_S_CTRL_OLD
 
	`_IOW
('V', 28, 
v4l2_cÚŒŞ
)

	)

1461 
	#VIDIOC_G_AUDIO_OLD
 
	`_IOWR
('V', 33, 
v4l2_audio
)

	)

1462 
	#VIDIOC_G_AUDOUT_OLD
 
	`_IOWR
('V', 49, 
v4l2_audioout
)

	)

1463 
	#VIDIOC_CROPCAP_OLD
 
	`_IOR
('V', 58, 
v4l2_üİÿp
)

	)

1466 
	#BASE_VIDIOC_PRIVATE
 192

	)

	@/usr/include/linux/wireless.h

10 #iâdeà
_LINUX_WIRELESS_H


11 
	#_LINUX_WIRELESS_H


	)

72 
	~<lšux/ty³s.h
>

73 
	~<lšux/sock‘.h
>

74 
	~<lšux/if.h
>

83 
	#WIRELESS_EXT
 22

	)

230 
	#SIOCSIWCOMMIT
 0x8B00

	)

231 
	#SIOCGIWNAME
 0x8B01

	)

237 
	#SIOCSIWNWID
 0x8B02

	)

238 
	#SIOCGIWNWID
 0x8B03

	)

239 
	#SIOCSIWFREQ
 0x8B04

	)

240 
	#SIOCGIWFREQ
 0x8B05

	)

241 
	#SIOCSIWMODE
 0x8B06

	)

242 
	#SIOCGIWMODE
 0x8B07

	)

243 
	#SIOCSIWSENS
 0x8B08

	)

244 
	#SIOCGIWSENS
 0x8B09

	)

247 
	#SIOCSIWRANGE
 0x8B0A

	)

248 
	#SIOCGIWRANGE
 0x8B0B

	)

249 
	#SIOCSIWPRIV
 0x8B0C

	)

250 
	#SIOCGIWPRIV
 0x8B0D

	)

251 
	#SIOCSIWSTATS
 0x8B0E

	)

252 
	#SIOCGIWSTATS
 0x8B0F

	)

257 
	#SIOCSIWSPY
 0x8B10

	)

258 
	#SIOCGIWSPY
 0x8B11

	)

259 
	#SIOCSIWTHRSPY
 0x8B12

	)

260 
	#SIOCGIWTHRSPY
 0x8B13

	)

263 
	#SIOCSIWAP
 0x8B14

	)

264 
	#SIOCGIWAP
 0x8B15

	)

265 
	#SIOCGIWAPLIST
 0x8B17

	)

266 
	#SIOCSIWSCAN
 0x8B18

	)

267 
	#SIOCGIWSCAN
 0x8B19

	)

270 
	#SIOCSIWESSID
 0x8B1A

	)

271 
	#SIOCGIWESSID
 0x8B1B

	)

272 
	#SIOCSIWNICKN
 0x8B1C

	)

273 
	#SIOCGIWNICKN
 0x8B1D

	)

279 
	#SIOCSIWRATE
 0x8B20

	)

280 
	#SIOCGIWRATE
 0x8B21

	)

281 
	#SIOCSIWRTS
 0x8B22

	)

282 
	#SIOCGIWRTS
 0x8B23

	)

283 
	#SIOCSIWFRAG
 0x8B24

	)

284 
	#SIOCGIWFRAG
 0x8B25

	)

285 
	#SIOCSIWTXPOW
 0x8B26

	)

286 
	#SIOCGIWTXPOW
 0x8B27

	)

287 
	#SIOCSIWRETRY
 0x8B28

	)

288 
	#SIOCGIWRETRY
 0x8B29

	)

291 
	#SIOCSIWENCODE
 0x8B2A

	)

292 
	#SIOCGIWENCODE
 0x8B2B

	)

294 
	#SIOCSIWPOWER
 0x8B2C

	)

295 
	#SIOCGIWPOWER
 0x8B2D

	)

304 
	#SIOCSIWGENIE
 0x8B30

	)

305 
	#SIOCGIWGENIE
 0x8B31

	)

308 
	#SIOCSIWMLME
 0x8B16

	)

311 
	#SIOCSIWAUTH
 0x8B32

	)

312 
	#SIOCGIWAUTH
 0x8B33

	)

315 
	#SIOCSIWENCODEEXT
 0x8B34

	)

316 
	#SIOCGIWENCODEEXT
 0x8B35

	)

319 
	#SIOCSIWPMKSA
 0x8B36

	)

330 
	#SIOCIWFIRSTPRIV
 0x8BE0

	)

331 
	#SIOCIWLASTPRIV
 0x8BFF

	)

346 
	#SIOCIWFIRST
 0x8B00

	)

347 
	#SIOCIWLAST
 
SIOCIWLASTPRIV


	)

348 
	#IW_IOCTL_IDX
(
cmd
è((cmdè- 
SIOCIWFIRST
)

	)

351 
	#IW_IS_SET
(
cmd
è(!((cmdè& 0x1))

	)

352 
	#IW_IS_GET
(
cmd
è((cmdè& 0x1)

	)

358 
	#IWEVTXDROP
 0x8C00

	)

359 
	#IWEVQUAL
 0x8C01

	)

360 
	#IWEVCUSTOM
 0x8C02

	)

361 
	#IWEVREGISTERED
 0x8C03

	)

362 
	#IWEVEXPIRED
 0x8C04

	)

363 
	#IWEVGENIE
 0x8C05

	)

369 
	#IWEVMICHAELMICFAILURE
 0x8C06

	)

372 
	#IWEVASSOCREQIE
 0x8C07

	)

381 
	#IWEVASSOCRESPIE
 0x8C08

	)

388 
	#IWEVPMKIDCAND
 0x8C09

	)

392 
	#IWEVFIRST
 0x8C00

	)

393 
	#IW_EVENT_IDX
(
cmd
è((cmdè- 
IWEVFIRST
)

	)

402 
	#IW_PRIV_TYPE_MASK
 0x7000

	)

403 
	#IW_PRIV_TYPE_NONE
 0x0000

	)

404 
	#IW_PRIV_TYPE_BYTE
 0x1000

	)

405 
	#IW_PRIV_TYPE_CHAR
 0x2000

	)

406 
	#IW_PRIV_TYPE_INT
 0x4000

	)

407 
	#IW_PRIV_TYPE_FLOAT
 0x5000

	)

408 
	#IW_PRIV_TYPE_ADDR
 0x6000

	)

410 
	#IW_PRIV_SIZE_FIXED
 0x0800

	)

412 
	#IW_PRIV_SIZE_MASK
 0x07FF

	)

422 
	#IW_MAX_FREQUENCIES
 32

	)

428 
	#IW_MAX_BITRATES
 32

	)

431 
	#IW_MAX_TXPOWER
 8

	)

436 
	#IW_MAX_SPY
 8

	)

440 
	#IW_MAX_AP
 64

	)

443 
	#IW_ESSID_MAX_SIZE
 32

	)

446 
	#IW_MODE_AUTO
 0

	)

447 
	#IW_MODE_ADHOC
 1

	)

448 
	#IW_MODE_INFRA
 2

	)

449 
	#IW_MODE_MASTER
 3

	)

450 
	#IW_MODE_REPEAT
 4

	)

451 
	#IW_MODE_SECOND
 5

	)

452 
	#IW_MODE_MONITOR
 6

	)

453 
	#IW_MODE_MESH
 7

	)

456 
	#IW_QUAL_QUAL_UPDATED
 0x01

	)

457 
	#IW_QUAL_LEVEL_UPDATED
 0x02

	)

458 
	#IW_QUAL_NOISE_UPDATED
 0x04

	)

459 
	#IW_QUAL_ALL_UPDATED
 0x07

	)

460 
	#IW_QUAL_DBM
 0x08

	)

461 
	#IW_QUAL_QUAL_INVALID
 0x10

	)

462 
	#IW_QUAL_LEVEL_INVALID
 0x20

	)

463 
	#IW_QUAL_NOISE_INVALID
 0x40

	)

464 
	#IW_QUAL_RCPI
 0x80

	)

465 
	#IW_QUAL_ALL_INVALID
 0x70

	)

468 
	#IW_FREQ_AUTO
 0x00

	)

469 
	#IW_FREQ_FIXED
 0x01

	)

473 
	#IW_MAX_ENCODING_SIZES
 8

	)

476 
	#IW_ENCODING_TOKEN_MAX
 64

	)

479 
	#IW_ENCODE_INDEX
 0x00FF

	)

480 
	#IW_ENCODE_FLAGS
 0xFF00

	)

481 
	#IW_ENCODE_MODE
 0xF000

	)

482 
	#IW_ENCODE_DISABLED
 0x8000

	)

483 
	#IW_ENCODE_ENABLED
 0x0000

	)

484 
	#IW_ENCODE_RESTRICTED
 0x4000

	)

485 
	#IW_ENCODE_OPEN
 0x2000

	)

486 
	#IW_ENCODE_NOKEY
 0x0800

	)

487 
	#IW_ENCODE_TEMP
 0x0400

	)

490 
	#IW_POWER_ON
 0x0000

	)

491 
	#IW_POWER_TYPE
 0xF000

	)

492 
	#IW_POWER_PERIOD
 0x1000

	)

493 
	#IW_POWER_TIMEOUT
 0x2000

	)

494 
	#IW_POWER_MODE
 0x0F00

	)

495 
	#IW_POWER_UNICAST_R
 0x0100

	)

496 
	#IW_POWER_MULTICAST_R
 0x0200

	)

497 
	#IW_POWER_ALL_R
 0x0300

	)

498 
	#IW_POWER_FORCE_S
 0x0400

	)

499 
	#IW_POWER_REPEATER
 0x0800

	)

500 
	#IW_POWER_MODIFIER
 0x000F

	)

501 
	#IW_POWER_MIN
 0x0001

	)

502 
	#IW_POWER_MAX
 0x0002

	)

503 
	#IW_POWER_RELATIVE
 0x0004

	)

506 
	#IW_TXPOW_TYPE
 0x00FF

	)

507 
	#IW_TXPOW_DBM
 0x0000

	)

508 
	#IW_TXPOW_MWATT
 0x0001

	)

509 
	#IW_TXPOW_RELATIVE
 0x0002

	)

510 
	#IW_TXPOW_RANGE
 0x1000

	)

513 
	#IW_RETRY_ON
 0x0000

	)

514 
	#IW_RETRY_TYPE
 0xF000

	)

515 
	#IW_RETRY_LIMIT
 0x1000

	)

516 
	#IW_RETRY_LIFETIME
 0x2000

	)

517 
	#IW_RETRY_MODIFIER
 0x00FF

	)

518 
	#IW_RETRY_MIN
 0x0001

	)

519 
	#IW_RETRY_MAX
 0x0002

	)

520 
	#IW_RETRY_RELATIVE
 0x0004

	)

521 
	#IW_RETRY_SHORT
 0x0010

	)

522 
	#IW_RETRY_LONG
 0x0020

	)

525 
	#IW_SCAN_DEFAULT
 0x0000

	)

526 
	#IW_SCAN_ALL_ESSID
 0x0001

	)

527 
	#IW_SCAN_THIS_ESSID
 0x0002

	)

528 
	#IW_SCAN_ALL_FREQ
 0x0004

	)

529 
	#IW_SCAN_THIS_FREQ
 0x0008

	)

530 
	#IW_SCAN_ALL_MODE
 0x0010

	)

531 
	#IW_SCAN_THIS_MODE
 0x0020

	)

532 
	#IW_SCAN_ALL_RATE
 0x0040

	)

533 
	#IW_SCAN_THIS_RATE
 0x0080

	)

535 
	#IW_SCAN_TYPE_ACTIVE
 0

	)

536 
	#IW_SCAN_TYPE_PASSIVE
 1

	)

538 
	#IW_SCAN_MAX_DATA
 4096

	)

541 
	#IW_SCAN_CAPA_NONE
 0x00

	)

542 
	#IW_SCAN_CAPA_ESSID
 0x01

	)

543 
	#IW_SCAN_CAPA_BSSID
 0x02

	)

544 
	#IW_SCAN_CAPA_CHANNEL
 0x04

	)

545 
	#IW_SCAN_CAPA_MODE
 0x08

	)

546 
	#IW_SCAN_CAPA_RATE
 0x10

	)

547 
	#IW_SCAN_CAPA_TYPE
 0x20

	)

548 
	#IW_SCAN_CAPA_TIME
 0x40

	)

551 
	#IW_CUSTOM_MAX
 256

	)

554 
	#IW_GENERIC_IE_MAX
 1024

	)

557 
	#IW_MLME_DEAUTH
 0

	)

558 
	#IW_MLME_DISASSOC
 1

	)

559 
	#IW_MLME_AUTH
 2

	)

560 
	#IW_MLME_ASSOC
 3

	)

563 
	#IW_AUTH_INDEX
 0x0FFF

	)

564 
	#IW_AUTH_FLAGS
 0xF000

	)

569 
	#IW_AUTH_WPA_VERSION
 0

	)

570 
	#IW_AUTH_CIPHER_PAIRWISE
 1

	)

571 
	#IW_AUTH_CIPHER_GROUP
 2

	)

572 
	#IW_AUTH_KEY_MGMT
 3

	)

573 
	#IW_AUTH_TKIP_COUNTERMEASURES
 4

	)

574 
	#IW_AUTH_DROP_UNENCRYPTED
 5

	)

575 
	#IW_AUTH_80211_AUTH_ALG
 6

	)

576 
	#IW_AUTH_WPA_ENABLED
 7

	)

577 
	#IW_AUTH_RX_UNENCRYPTED_EAPOL
 8

	)

578 
	#IW_AUTH_ROAMING_CONTROL
 9

	)

579 
	#IW_AUTH_PRIVACY_INVOKED
 10

	)

582 
	#IW_AUTH_WPA_VERSION_DISABLED
 0x00000001

	)

583 
	#IW_AUTH_WPA_VERSION_WPA
 0x00000002

	)

584 
	#IW_AUTH_WPA_VERSION_WPA2
 0x00000004

	)

587 
	#IW_AUTH_CIPHER_NONE
 0x00000001

	)

588 
	#IW_AUTH_CIPHER_WEP40
 0x00000002

	)

589 
	#IW_AUTH_CIPHER_TKIP
 0x00000004

	)

590 
	#IW_AUTH_CIPHER_CCMP
 0x00000008

	)

591 
	#IW_AUTH_CIPHER_WEP104
 0x00000010

	)

594 
	#IW_AUTH_KEY_MGMT_802_1X
 1

	)

595 
	#IW_AUTH_KEY_MGMT_PSK
 2

	)

598 
	#IW_AUTH_ALG_OPEN_SYSTEM
 0x00000001

	)

599 
	#IW_AUTH_ALG_SHARED_KEY
 0x00000002

	)

600 
	#IW_AUTH_ALG_LEAP
 0x00000004

	)

603 
	#IW_AUTH_ROAMING_ENABLE
 0

	)

604 
	#IW_AUTH_ROAMING_DISABLE
 1

	)

608 
	#IW_ENCODE_SEQ_MAX_SIZE
 8

	)

610 
	#IW_ENCODE_ALG_NONE
 0

	)

611 
	#IW_ENCODE_ALG_WEP
 1

	)

612 
	#IW_ENCODE_ALG_TKIP
 2

	)

613 
	#IW_ENCODE_ALG_CCMP
 3

	)

614 
	#IW_ENCODE_ALG_PMK
 4

	)

616 
	#IW_ENCODE_EXT_TX_SEQ_VALID
 0x00000001

	)

617 
	#IW_ENCODE_EXT_RX_SEQ_VALID
 0x00000002

	)

618 
	#IW_ENCODE_EXT_GROUP_KEY
 0x00000004

	)

619 
	#IW_ENCODE_EXT_SET_TX_KEY
 0x00000008

	)

622 
	#IW_MICFAILURE_KEY_ID
 0x00000003

	)

623 
	#IW_MICFAILURE_GROUP
 0x00000004

	)

624 
	#IW_MICFAILURE_PAIRWISE
 0x00000008

	)

625 
	#IW_MICFAILURE_STAKEY
 0x00000010

	)

626 
	#IW_MICFAILURE_COUNT
 0x00000060

	)

630 
	#IW_ENC_CAPA_WPA
 0x00000001

	)

631 
	#IW_ENC_CAPA_WPA2
 0x00000002

	)

632 
	#IW_ENC_CAPA_CIPHER_TKIP
 0x00000004

	)

633 
	#IW_ENC_CAPA_CIPHER_CCMP
 0x00000008

	)

634 
	#IW_ENC_CAPA_4WAY_HANDSHAKE
 0x00000010

	)

639 
	#IW_EVENT_CAPA_BASE
(
cmd
è((cmd >ğ
SIOCIWFIRSTPRIV
) ? \

640 (
cmd
 - 
SIOCIWFIRSTPRIV
 + 0x60) : \

641 (
cmd
 - 
SIOCSIWCOMMIT
))

	)

642 
	#IW_EVENT_CAPA_INDEX
(
cmd
è(
	`IW_EVENT_CAPA_BASE
(cmdè>> 5)

	)

643 
	#IW_EVENT_CAPA_MASK
(
cmd
è(1 << (
	`IW_EVENT_CAPA_BASE
(cmdè& 0x1F))

	)

646 
	#IW_EVENT_CAPA_K_0
 (
	`IW_EVENT_CAPA_MASK
(0x8B04) | \

647 
	`IW_EVENT_CAPA_MASK
(0x8B06) | \

648 
	`IW_EVENT_CAPA_MASK
(0x8B1A))

	)

649 
	#IW_EVENT_CAPA_K_1
 (
	`IW_EVENT_CAPA_MASK
(0x8B2A))

	)

651 
	#IW_EVENT_CAPA_SET
(
ev’t_ÿ·
, 
cmd
èÓv’t_ÿ·[
	`IW_EVENT_CAPA_INDEX
(cmd)] |ğ
	`IW_EVENT_CAPA_MASK
(cmd))

	)

652 
	#IW_EVENT_CAPA_SET_KERNEL
(
ev’t_ÿ·
è{ev’t_ÿ·[0] |ğ
IW_EVENT_CAPA_K_0
;ƒv’t_ÿ·[1] |ğ
IW_EVENT_CAPA_K_1
; }

	)

661 
	siw_·¿m


663 
__s32
 
	mv®ue
;

664 
__u8
 
	mfixed
;

665 
__u8
 
	mdi§bËd
;

666 
__u16
 
	mæags
;

673 
	siw_pošt


675 *
	mpoš‹r
;

676 
__u16
 
	mËngth
;

677 
__u16
 
	mæags
;

689 
	siw_äeq


691 
__s32
 
	mm
;

692 
__s16
 
	me
;

693 
__u8
 
	mi
;

694 
__u8
 
	mæags
;

700 
	siw_qu®™y


702 
__u8
 
	mqu®
;

704 
__u8
 
	mËv–
;

705 
__u8
 
	mnoi£
;

706 
__u8
 
	mupd©ed
;

716 
	siw_disÿrded


718 
__u32
 
	mnwid
;

719 
__u32
 
	mcode
;

720 
__u32
 
	mäagm’t
;

721 
__u32
 
	m»Œ›s
;

722 
__u32
 
	mmisc
;

729 
	siw_mis£d


731 
__u32
 
	mb—cÚ
;

737 
	siw_thr¥y


739 
sockaddr
 
	maddr
;

740 
iw_qu®™y
 
	mqu®
;

741 
iw_qu®™y
 
	mlow
;

742 
iw_qu®™y
 
	mhigh
;

756 
	siw_sÿn_»q


758 
__u8
 
	msÿn_ty³
;

759 
__u8
 
	messid_Ën
;

760 
__u8
 
	mnum_chªÃls
;

762 
__u8
 
	mæags
;

765 
sockaddr
 
	mbssid
;

774 
__u8
 
	messid
[
IW_ESSID_MAX_SIZE
];

786 
__u32
 
	mmš_chªÃl_time
;

787 
__u32
 
	mmax_chªÃl_time
;

789 
iw_äeq
 
	mchªÃl_li¡
[
IW_MAX_FREQUENCIES
];

818 
	siw_’code_ext


820 
__u32
 
	mext_æags
;

821 
__u8
 
	mtx_£q
[
IW_ENCODE_SEQ_MAX_SIZE
];

822 
__u8
 
	mrx_£q
[
IW_ENCODE_SEQ_MAX_SIZE
];

823 
sockaddr
 
	maddr
;

826 
__u16
 
	m®g
;

827 
__u16
 
	mkey_Ën
;

828 
__u8
 
	mkey
[0];

832 
	siw_mlme


834 
__u16
 
	mcmd
;

835 
__u16
 
	m»asÚ_code
;

836 
sockaddr
 
	maddr
;

840 
	#IW_PMKSA_ADD
 1

	)

841 
	#IW_PMKSA_REMOVE
 2

	)

842 
	#IW_PMKSA_FLUSH
 3

	)

844 
	#IW_PMKID_LEN
 16

	)

846 
	siw_pmk§


848 
__u32
 
	mcmd
;

849 
sockaddr
 
	mbssid
;

850 
__u8
 
	mpmkid
[
IW_PMKID_LEN
];

854 
	siw_mich«lmicçu»


856 
__u32
 
	mæags
;

857 
sockaddr
 
	m¤c_addr
;

858 
__u8
 
	mtsc
[
IW_ENCODE_SEQ_MAX_SIZE
];

862 
	#IW_PMKID_CAND_PREAUTH
 0x00000001

	)

863 
	siw_pmkid_ÿnd


865 
__u32
 
	mæags
;

866 
__u32
 
	mšdex
;

868 
sockaddr
 
	mbssid
;

875 
	siw_¡©i¡ics


877 
__u16
 
	m¡©us
;

880 
iw_qu®™y
 
	mqu®
;

882 
iw_disÿrded
 
	mdisÿrd
;

883 
iw_mis£d
 
	mmiss
;

897 
	uiw»q_d©a


900 
	mÇme
[
IFNAMSIZ
];

904 
iw_pošt
 
	messid
;

905 
iw_·¿m
 
	mnwid
;

906 
iw_äeq
 
	mäeq
;

910 
iw_·¿m
 
	m£ns
;

911 
iw_·¿m
 
	mb™¿‹
;

912 
iw_·¿m
 
	mtxpow”
;

913 
iw_·¿m
 
	m¹s
;

914 
iw_·¿m
 
	mäag
;

915 
__u32
 
	mmode
;

916 
iw_·¿m
 
	m»Œy
;

918 
iw_pošt
 
	m’codšg
;

919 
iw_·¿m
 
	mpow”
;

920 
iw_qu®™y
 
	mqu®
;

922 
sockaddr
 
	m­_addr
;

923 
sockaddr
 
	maddr
;

925 
iw_·¿m
 
	m·¿m
;

926 
iw_pošt
 
	md©a
;

935 
	siw»q


939 
	miän_Çme
[
IFNAMSIZ
];

940 } 
	miä_iän
;

943 
iw»q_d©a
 
	mu
;

956 
	siw_¿nge


959 
__u32
 
	mthroughput
;

968 
__u32
 
	mmš_nwid
;

969 
__u32
 
	mmax_nwid
;

972 
__u16
 
	mŞd_num_chªÃls
;

973 
__u8
 
	mŞd_num_äequ’cy
;

976 
__u8
 
	msÿn_ÿ·
;

979 
__u32
 
	mev’t_ÿ·
[6];

982 
__s32
 
	m£ns™iv™y
;

989 
iw_qu®™y
 
	mmax_qu®
;

999 
iw_qu®™y
 
	mavg_qu®
;

1002 
__u8
 
	mnum_b™¿‹s
;

1003 
__s32
 
	mb™¿‹
[
IW_MAX_BITRATES
];

1006 
__s32
 
	mmš_¹s
;

1007 
__s32
 
	mmax_¹s
;

1010 
__s32
 
	mmš_äag
;

1011 
__s32
 
	mmax_äag
;

1014 
__s32
 
	mmš_pmp
;

1015 
__s32
 
	mmax_pmp
;

1016 
__s32
 
	mmš_pmt
;

1017 
__s32
 
	mmax_pmt
;

1018 
__u16
 
	mpmp_æags
;

1019 
__u16
 
	mpmt_æags
;

1020 
__u16
 
	mpm_ÿ·
;

1023 
__u16
 
	m’codšg_size
[
IW_MAX_ENCODING_SIZES
];

1024 
__u8
 
	mnum_’codšg_sizes
;

1025 
__u8
 
	mmax_’codšg_tok’s
;

1027 
__u8
 
	m’codšg_logš_šdex
;

1030 
__u16
 
	mtxpow”_ÿ·
;

1031 
__u8
 
	mnum_txpow”
;

1032 
__s32
 
	mtxpow”
[
IW_MAX_TXPOWER
];

1035 
__u8
 
	mwe_v”siÚ_comped
;

1036 
__u8
 
	mwe_v”siÚ_sourû
;

1039 
__u16
 
	m»Œy_ÿ·
;

1040 
__u16
 
	m»Œy_æags
;

1041 
__u16
 
	mr_time_æags
;

1042 
__s32
 
	mmš_»Œy
;

1043 
__s32
 
	mmax_»Œy
;

1044 
__s32
 
	mmš_r_time
;

1045 
__s32
 
	mmax_r_time
;

1048 
__u16
 
	mnum_chªÃls
;

1049 
__u8
 
	mnum_äequ’cy
;

1050 
iw_äeq
 
	mäeq
[
IW_MAX_FREQUENCIES
];

1054 
__u32
 
	m’c_ÿ·
;

1061 
	siw_´iv_¬gs


1063 
__u32
 
	mcmd
;

1064 
__u16
 
	m£t_¬gs
;

1065 
__u16
 
	mg‘_¬gs
;

1066 
	mÇme
[
IFNAMSIZ
];

1079 
	siw_ev’t


1081 
__u16
 
	mËn
;

1082 
__u16
 
	mcmd
;

1083 
iw»q_d©a
 
	mu
;

1087 
	#IW_EV_LCP_LEN
 ((
iw_ev’t
è- (
iw»q_d©a
))

	)

1089 
	#IW_EV_CHAR_LEN
 (
IW_EV_LCP_LEN
 + 
IFNAMSIZ
)

	)

1090 
	#IW_EV_UINT_LEN
 (
IW_EV_LCP_LEN
 + (
__u32
))

	)

1091 
	#IW_EV_FREQ_LEN
 (
IW_EV_LCP_LEN
 + (
iw_äeq
))

	)

1092 
	#IW_EV_PARAM_LEN
 (
IW_EV_LCP_LEN
 + (
iw_·¿m
))

	)

1093 
	#IW_EV_ADDR_LEN
 (
IW_EV_LCP_LEN
 + (
sockaddr
))

	)

1094 
	#IW_EV_QUAL_LEN
 (
IW_EV_LCP_LEN
 + (
iw_qu®™y
))

	)

1099 
	#IW_EV_POINT_OFF
 (((*è&(((
iw_pošt
 *è
NULL
)->
Ëngth
)) - \

1100 (*è
NULL
)

	)

1101 
	#IW_EV_POINT_LEN
 (
IW_EV_LCP_LEN
 + (
iw_pošt
) - \

1102 
IW_EV_POINT_OFF
)

	)

1106 
	#IW_EV_LCP_PK_LEN
 (4)

	)

1108 
	#IW_EV_CHAR_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + 
IFNAMSIZ
)

	)

1109 
	#IW_EV_UINT_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
__u32
))

	)

1110 
	#IW_EV_FREQ_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_äeq
))

	)

1111 
	#IW_EV_PARAM_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_·¿m
))

	)

1112 
	#IW_EV_ADDR_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
sockaddr
))

	)

1113 
	#IW_EV_QUAL_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_qu®™y
))

	)

1114 
	#IW_EV_POINT_PK_LEN
 (
IW_EV_LCP_LEN
 + 4)

	)

	@/usr/include/malloc.h

21 #iâdeà
_MALLOC_H


22 
	#_MALLOC_H
 1

	)

24 
	~<ã©u»s.h
>

25 
	~<¡ddef.h
>

26 
	#__m®loc_±r_t
 *

	)

29 
	#__m®loc_size_t
 
size_t


	)

30 
	#__m®loc_±rdiff_t
 
±rdiff_t


	)

32 #ifdeà
__GNUC__


34 
	#__MALLOC_P
(
¬gs
è¬g 
__THROW


	)

37 
	#__MALLOC_PMT
(
¬gs
è
	)
args

41 
	#__MALLOC_P
(
¬gs
è
	)
args

42 
	#__MALLOC_PMT
(
¬gs
è
	)
args

47 
__BEGIN_DECLS


50 *
m®loc
 
__MALLOC_P
 ((
size_t
 
__size
)è
__©Œibu‹_m®loc__
 
__wur
;

53 *
ÿÎoc
 
__MALLOC_P
 ((
size_t
 
__nmemb
, size_ˆ
__size
))

54 
__©Œibu‹_m®loc__
 
__wur
;

61 *
»®loc
 
__MALLOC_P
 ((*
__±r
, 
size_t
 
__size
))

62 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

65 
ä“
 
__MALLOC_P
 ((*
__±r
));

68 
cä“
 
__MALLOC_P
 ((*
__±r
));

71 *
mem®ign
 
__MALLOC_P
 ((
size_t
 
__®ignm’t
, size_ˆ
__size
))

72 
__©Œibu‹_m®loc__
 
__wur
;

75 *
v®loc
 
__MALLOC_P
 ((
size_t
 
__size
))

76 
__©Œibu‹_m®loc__
 
__wur
;

80 * 
pv®loc
 
__MALLOC_P
 ((
size_t
 
__size
))

81 
__©Œibu‹_m®loc__
 
__wur
;

85 *(*
__mÜecÜe
è
__MALLOC_PMT
 ((
±rdiff_t
 
__size
));

88 *
__deçuÉ_mÜecÜe
 
__MALLOC_P
 ((
±rdiff_t
 
__size
))

89 
__©Œibu‹_m®loc__
;

93 
	sm®lšfo
 {

94 
	m¬’a
;

95 
	mÜdblks
;

96 
	msmblks
;

97 
	mhblks
;

98 
	mhblkhd
;

99 
	musmblks
;

100 
	mfsmblks
;

101 
	muÜdblks
;

102 
	mfÜdblks
;

103 
	mk“pco¡
;

107 
m®lšfo
 m®lšfØ
__MALLOC_P
 (());

110 #iâdeà
M_MXFAST


111 
	#M_MXFAST
 1

	)

113 #iâdeà
M_NLBLKS


114 
	#M_NLBLKS
 2

	)

116 #iâdeà
M_GRAIN


117 
	#M_GRAIN
 3

	)

119 #iâdeà
M_KEEP


120 
	#M_KEEP
 4

	)

124 
	#M_TRIM_THRESHOLD
 -1

	)

125 
	#M_TOP_PAD
 -2

	)

126 
	#M_MMAP_THRESHOLD
 -3

	)

127 
	#M_MMAP_MAX
 -4

	)

128 
	#M_CHECK_ACTION
 -5

	)

129 
	#M_PERTURB
 -6

	)

132 
m®lİt
 
__MALLOC_P
 ((
__·¿m
, 
__v®
));

136 
m®loc_Œim
 
__MALLOC_P
 ((
size_t
 
__·d
));

140 
size_t
 
m®loc_u§bË_size
 
__MALLOC_P
 ((*
__±r
));

143 
m®loc_¡©s
 
__MALLOC_P
 (());

146 *
m®loc_g‘_¡©e
 
__MALLOC_P
 (());

150 
m®loc_£t_¡©e
 
__MALLOC_P
 ((*
__±r
));

155 (*
__m®loc_š™Ÿlize_hook
è
	`__MALLOC_PMT
 (());

157 (*
__ä“_hook
è
	`__MALLOC_PMT
 ((*
__±r
,

158 
__cÚ¡
 
__m®loc_±r_t
));

159 *(*
__m®loc_hook
è
	`__MALLOC_PMT
 ((
size_t
 
__size
,

160 
__cÚ¡
 
__m®loc_±r_t
));

161 *(*
__»®loc_hook
è
	`__MALLOC_PMT
 ((*
__±r
, 
size_t
 
__size
,

162 
__cÚ¡
 
__m®loc_±r_t
));

163 *(*
__mem®ign_hook
è
	`__MALLOC_PMT
 ((
size_t
 
__®ignm’t
,

164 
size_t
 
__size
,

165 
__cÚ¡
 
__m®loc_±r_t
));

166 (*
__aá”_mÜecÜe_hook
è
	`__MALLOC_PMT
 (());

169 
__m®loc_check_š™
 
	`__MALLOC_P
 (());

172 
__END_DECLS


	@/usr/include/math.h

25 #iâdef 
_MATH_H


26 
	#_MATH_H
 1

	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


34 
	~<b™s/huge_v®.h
>

35 #ifdeà
__USE_ISOC99


36 
	~<b™s/huge_v®f.h
>

37 
	~<b™s/huge_v®l.h
>

40 
	~<b™s/šf.h
>

43 
	~<b™s/Çn.h
>

47 
	~<b™s/m©hdef.h
>

54 
	#__MATHCALL
(
funùiÚ
,
suffix
, 
¬gs
) \

55 
	`__MATHDECL
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
)

	)

56 
	#__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

57 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
); \

58 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
)

	)

59 
	#__MATHCALLX
(
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

60 
	`__MATHDECLX
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
)

	)

61 
	#__MATHDECLX
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

62 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
); \

63 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
)

	)

64 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

65 
ty³
 
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
è
¬gs
 
__THROW


	)

67 
	#_MdoubË_
 

	)

68 
	#__MATH_PRECNAME
(
Çme
,
r
è
	`__CONCAT
Òame,r)

	)

69 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

70 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

71 
	~<b™s/m©hÿÎs.h
>

72 #undeà
_MdoubË_


73 #undeà
_MdoubË_BEGIN_NAMESPACE


74 #undeà
_MdoubË_END_NAMESPACE


75 #undeà
__MATH_PRECNAME


77 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


83 #iâdeà
_Mæßt_


84 
	#_Mæßt_
 

	)

86 
	#_MdoubË_
 
_Mæßt_


	)

87 #ifdeà
__STDC__


88 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f
##
	)
r

90 
	#__MATH_PRECNAME
(
Çme
,
r
èÇm
f
 
	)
r

92 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

93 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

94 
	~<b™s/m©hÿÎs.h
>

95 #undeà
_MdoubË_


96 #undeà
_MdoubË_BEGIN_NAMESPACE


97 #undeà
_MdoubË_END_NAMESPACE


98 #undeà
__MATH_PRECNAME


100 #ià(
__STDC__
 - 0 || 
__GNUC__
 - 0) \

101 && (!
defšed
 
__NO_LONG_DOUBLE_MATH
 || defšed 
__LDBL_COMPAT
)

102 #ifdeà
__LDBL_COMPAT


104 #ifdeà
__USE_ISOC99


105 
	$__Ædbl_Ãx‰ow¬df
 (
__x
, 
__y
)

106 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

107 #ifdeà
__REDIRECT_NTH


108 
	`__REDIRECT_NTH
 (
Ãx‰ow¬df
, (
__x
, 
__y
),

109 
__Ædbl_Ãx‰ow¬df
)

110 
	`__©Œibu‹__
 ((
__cÚ¡__
));

111 
	`__REDIRECT_NTH
 (
Ãx‰ow¬d
, (
__x
, 
__y
),

112 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

113 
	`__REDIRECT_NTH
 (
Ãx‰ow¬dl
,

114 (
__x
, 
__y
),

115 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

122 #undeà
__MATHDECL_1


123 
	#__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
®Ÿs
) \

124 
ty³
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
), \

125 
¬gs
, 
®Ÿs
)

	)

126 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

127 
	`__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
	`__CONCAT
(funùiÚ,suffix))

	)

130 #iâdeà
_MlÚg_doubË_


131 
	#_MlÚg_doubË_
 

	)

133 
	#_MdoubË_
 
_MlÚg_doubË_


	)

134 #ifdeà
__STDC__


135 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
l
##
	)
r

137 
	#__MATH_PRECNAME
(
Çme
,
r
èÇm
l
 
	)
r

139 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

140 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

141 
	~<b™s/m©hÿÎs.h
>

142 #undeà
_MdoubË_


143 #undeà
_MdoubË_BEGIN_NAMESPACE


144 #undeà
_MdoubË_END_NAMESPACE


145 #undeà
__MATH_PRECNAME


150 #undeà
__MATHDECL_1


151 #undeà
__MATHDECL


152 #undeà
__MATHCALL


155 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


157 
signgam
;

162 #ifdeà
__USE_ISOC99


200 
FP_NAN
,

201 
	#FP_NAN
 
FP_NAN


	)

202 
FP_INFINITE
,

203 
	#FP_INFINITE
 
FP_INFINITE


	)

204 
FP_ZERO
,

205 
	#FP_ZERO
 
FP_ZERO


	)

206 
FP_SUBNORMAL
,

207 
	#FP_SUBNORMAL
 
FP_SUBNORMAL


	)

208 
FP_NORMAL


209 
	#FP_NORMAL
 
FP_NORMAL


	)

213 #ifdeà
__NO_LONG_DOUBLE_MATH


214 
	#åşassify
(
x
) \

215 ( (
x
è=ğ (è? 
	`__åşassifyf
 (xè: 
	`__åşassify
 (x))

	)

217 
	#åşassify
(
x
) \

218 ( (
x
) ==  () \

219 ? 
	`__åşassifyf
 (
x
) \

220 :  (
x
) ==  () \

221 ? 
	`__åşassify
 (
x
è: 
	`__åşassifyl
 (x))

	)

225 #ifdeà
__NO_LONG_DOUBLE_MATH


226 
	#signb™
(
x
) \

227 ( (
x
è=ğ (è? 
	`__signb™f
 (xè: 
	`__signb™
 (x))

	)

229 
	#signb™
(
x
) \

230 ( (
x
) ==  () \

231 ? 
	`__signb™f
 (
x
) \

232 :  (
x
) ==  () \

233 ? 
	`__signb™
 (
x
è: 
	`__signb™l
 (x))

	)

237 #ifdeà
__NO_LONG_DOUBLE_MATH


238 
	#isfš™e
(
x
) \

239 ( (
x
è=ğ (è? 
	`__fš™ef
 (xè: 
	`__fš™e
 (x))

	)

241 
	#isfš™e
(
x
) \

242 ( (
x
) ==  () \

243 ? 
	`__fš™ef
 (
x
) \

244 :  (
x
) ==  () \

245 ? 
	`__fš™e
 (
x
è: 
	`__fš™–
 (x))

	)

249 
	#i¢Üm®
(
x
è(
	`åşassify
 (xè=ğ
FP_NORMAL
)

	)

253 #ifdeà
__NO_LONG_DOUBLE_MATH


254 
	#i¢ª
(
x
) \

255 ( (
x
è=ğ (è? 
	`__i¢ªf
 (xè: 
	`__i¢ª
 (x))

	)

257 
	#i¢ª
(
x
) \

258 ( (
x
) ==  () \

259 ? 
	`__i¢ªf
 (
x
) \

260 :  (
x
) ==  () \

261 ? 
	`__i¢ª
 (
x
è: 
	`__i¢ªl
 (x))

	)

265 #ifdeà
__NO_LONG_DOUBLE_MATH


266 
	#isšf
(
x
) \

267 ( (
x
è=ğ (è? 
	`__isšff
 (xè: 
	`__isšf
 (x))

	)

269 
	#isšf
(
x
) \

270 ( (
x
) ==  () \

271 ? 
	`__isšff
 (
x
) \

272 :  (
x
) ==  () \

273 ? 
	`__isšf
 (
x
è: 
	`__isšæ
 (x))

	)

277 
	#MATH_ERRNO
 1

	)

278 
	#MATH_ERREXCEPT
 2

	)

282 #ifdef 
__USE_MISC


286 
_IEEE_
 = -1,

287 
_SVID_
,

288 
_XOPEN_
,

289 
_POSIX_
,

290 
_ISOC_


291 } 
	t_LIB_VERSION_TYPE
;

296 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

300 #ifdeà
__USE_SVID


306 #ifdeà
__ılu¥lus


307 
__exû±iÚ


309 
exû±iÚ


312 
ty³
;

313 *
Çme
;

314 
¬g1
;

315 
¬g2
;

316 
»tv®
;

317 
	}
};

319 #ifdeà
__ılu¥lus


320 
	$m©h”r
 (
__exû±iÚ
 *
__exc
è
	`throw
 ();

322 
	`m©h”r
 (
exû±iÚ
 *
__exc
);

325 
	#X_TLOSS
 1.41484755040568800000e+16

	)

328 
	#DOMAIN
 1

	)

329 
	#SING
 2

	)

330 
	#OVERFLOW
 3

	)

331 
	#UNDERFLOW
 4

	)

332 
	#TLOSS
 5

	)

333 
	#PLOSS
 6

	)

336 
	#HUGE
 3.40282347e+38F

	)

340 #ifdeà
__USE_XOPEN


342 
	#MAXFLOAT
 3.40282347e+38F

	)

349 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


350 
	#M_E
 2.7182818284590452354

	)

351 
	#M_LOG2E
 1.4426950408889634074

	)

352 
	#M_LOG10E
 0.43429448190325182765

	)

353 
	#M_LN2
 0.69314718055994530942

	)

354 
	#M_LN10
 2.30258509299404568402

	)

355 
	#M_PI
 3.14159265358979323846

	)

356 
	#M_PI_2
 1.57079632679489661923

	)

357 
	#M_PI_4
 0.78539816339744830962

	)

358 
	#M_1_PI
 0.31830988618379067154

	)

359 
	#M_2_PI
 0.63661977236758134308

	)

360 
	#M_2_SQRTPI
 1.12837916709551257390

	)

361 
	#M_SQRT2
 1.41421356237309504880

	)

362 
	#M_SQRT1_2
 0.70710678118654752440

	)

368 #ifdeà
__USE_GNU


369 
	#M_El
 2.7182818284590452353602874713526625L

	)

370 
	#M_LOG2El
 1.4426950408889634073599246810018921L

	)

371 
	#M_LOG10El
 0.4342944819032518276511289189166051L

	)

372 
	#M_LN2l
 0.6931471805599453094172321214581766L

	)

373 
	#M_LN10l
 2.3025850929940456840179914546843642L

	)

374 
	#M_PIl
 3.1415926535897932384626433832795029L

	)

375 
	#M_PI_2l
 1.5707963267948966192313216916397514L

	)

376 
	#M_PI_4l
 0.7853981633974483096156608458198757L

	)

377 
	#M_1_PIl
 0.3183098861837906715377675267450287L

	)

378 
	#M_2_PIl
 0.6366197723675813430755350534900574L

	)

379 
	#M_2_SQRTPIl
 1.1283791670955125738961589031215452L

	)

380 
	#M_SQRT2l
 1.4142135623730950488016887242096981L

	)

381 
	#M_SQRT1_2l
 0.7071067811865475244008443621048490L

	)

388 #ià
defšed
 
__STRICT_ANSI__
 && !defšed 
__NO_MATH_INLINES


389 
	#__NO_MATH_INLINES
 1

	)

392 #ià
defšed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

399 
	#isg»©”
(
x
, 
y
è
	`__butš_isg»©”
(x, y)

	)

400 
	#isg»©”equ®
(
x
, 
y
è
	`__butš_isg»©”equ®
(x, y)

	)

401 
	#i¦ess
(
x
, 
y
è
	`__butš_i¦ess
(x, y)

	)

402 
	#i¦es£qu®
(
x
, 
y
è
	`__butš_i¦es£qu®
(x, y)

	)

403 
	#i¦essg»©”
(
x
, 
y
è
	`__butš_i¦essg»©”
(x, y)

	)

404 
	#isunÜd”ed
(
u
, 
v
è
	`__butš_isunÜd”ed
(u, v)

	)

408 #ifdeà
__USE_EXTERN_INLINES


409 
	~<b™s/m©hšlše.h
>

412 #ifdeà
__USE_ISOC99


416 #iâdeà
isg»©”


417 
	#isg»©”
(
x
, 
y
) \

418 (
__ex‹nsiÚ__
 \

419 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

420 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x > __y; 
	}
}))

	)

424 #iâdeà
isg»©”equ®


425 
	#isg»©”equ®
(
x
, 
y
) \

426 (
__ex‹nsiÚ__
 \

427 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

428 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x >ğ__y; }))

	)

432 #iâdeà
i¦ess


433 
	#i¦ess
(
x
, 
y
) \

434 (
__ex‹nsiÚ__
 \

435 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

436 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x < __y; }))

	)

440 #iâdeà
i¦es£qu®


441 
	#i¦es£qu®
(
x
, 
y
) \

442 (
__ex‹nsiÚ__
 \

443 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

444 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x <ğ__y; }))

	)

448 #iâdeà
i¦essg»©”


449 
	#i¦essg»©”
(
x
, 
y
) \

450 (
__ex‹nsiÚ__
 \

451 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

452 !
	`isunÜd”ed
 (
__x
, 
__y
è&& (__x < __y || __y < __x); }))

	)

456 #iâdeà
isunÜd”ed


457 
	#isunÜd”ed
(
u
, 
v
) \

458 (
__ex‹nsiÚ__
 \

459 ({ 
	`__ty³of__
(
u
è
__u
 = (u); __ty³of__(
v
è
__v
 = (v); \

460 
	`åşassify
 (
__u
è=ğ
FP_NAN
 || fpşassify (
__v
è=ğFP_NAN; }))

	)

465 
	g__END_DECLS


	@/usr/include/mntent.h

20 #iâdef 
_MNTENT_H


21 
	#_MNTENT_H
 1

	)

23 
	~<ã©u»s.h
>

24 
	#__Ãed_FILE


	)

25 
	~<¡dio.h
>

26 
	~<·ths.h
>

30 
	#MNTTAB
 
_PATH_MNTTAB


	)

33 
	#MOUNTED
 
_PATH_MOUNTED


	)

37 
	#MNTTYPE_IGNORE
 "ignÜe"

	)

38 
	#MNTTYPE_NFS
 "nfs"

	)

39 
	#MNTTYPE_SWAP
 "sw­"

	)

43 
	#MNTOPT_DEFAULTS
 "deçuÉs"

	)

44 
	#MNTOPT_RO
 "ro"

	)

45 
	#MNTOPT_RW
 "rw"

	)

46 
	#MNTOPT_SUID
 "suid"

	)

47 
	#MNTOPT_NOSUID
 "nosuid"

	)

48 
	#MNTOPT_NOAUTO
 "nßuto"

	)

51 
__BEGIN_DECLS


54 
	smÁ’t


56 *
	mmÁ_f¢ame
;

57 *
	mmÁ_dœ
;

58 *
	mmÁ_ty³
;

59 *
	mmÁ_İts
;

60 
	mmÁ_äeq
;

61 
	mmÁ_·s¢o
;

67 
FILE
 *
	$£tmÁ’t
 (
__cÚ¡
 *
__fe
, __cÚ¡ *
__mode
è
__THROW
;

72 
mÁ’t
 *
	$g‘mÁ’t
 (
FILE
 *
__¡»am
è
__THROW
;

74 #ifdeà
__USE_MISC


76 
mÁ’t
 *
	$g‘mÁ’t_r
 (
FILE
 *
__»¡riù
 
__¡»am
,

77 
mÁ’t
 *
__»¡riù
 
__»suÉ
,

78 *
__»¡riù
 
__bufãr
,

79 
__bufsize
è
__THROW
;

84 
	$addmÁ’t
 (
FILE
 *
__»¡riù
 
__¡»am
,

85 
__cÚ¡
 
mÁ’t
 *
__»¡riù
 
__mÁ
è
__THROW
;

88 
	$’dmÁ’t
 (
FILE
 *
__¡»am
è
__THROW
;

92 *
	$hasmÁİt
 (
__cÚ¡
 
mÁ’t
 *
__mÁ
,

93 
__cÚ¡
 *
__İt
è
__THROW
;

96 
__END_DECLS


	@/usr/include/net/if.h

20 #iâdeà
_NET_IF_H


21 
	#_NET_IF_H
 1

	)

23 
	~<ã©u»s.h
>

25 #ifdeà
__USE_MISC


26 
	~<sys/ty³s.h
>

27 
	~<sys/sock‘.h
>

32 
	#IF_NAMESIZE
 16

	)

34 
	sif_Çmešdex


36 
	mif_šdex
;

37 *
	mif_Çme
;

41 #ifdeà
__USE_MISC


45 
	mIFF_UP
 = 0x1,

46 
	#IFF_UP
 
IFF_UP


	)

47 
	mIFF_BROADCAST
 = 0x2,

48 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

49 
	mIFF_DEBUG
 = 0x4,

50 
	#IFF_DEBUG
 
IFF_DEBUG


	)

51 
	mIFF_LOOPBACK
 = 0x8,

52 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

53 
	mIFF_POINTOPOINT
 = 0x10,

54 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

55 
	mIFF_NOTRAILERS
 = 0x20,

56 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

57 
	mIFF_RUNNING
 = 0x40,

58 
	#IFF_RUNNING
 
IFF_RUNNING


	)

59 
	mIFF_NOARP
 = 0x80,

60 
	#IFF_NOARP
 
IFF_NOARP


	)

61 
	mIFF_PROMISC
 = 0x100,

62 
	#IFF_PROMISC
 
IFF_PROMISC


	)

65 
	mIFF_ALLMULTI
 = 0x200,

66 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

68 
	mIFF_MASTER
 = 0x400,

69 
	#IFF_MASTER
 
IFF_MASTER


	)

70 
	mIFF_SLAVE
 = 0x800,

71 
	#IFF_SLAVE
 
IFF_SLAVE


	)

73 
	mIFF_MULTICAST
 = 0x1000,

74 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

76 
	mIFF_PORTSEL
 = 0x2000,

77 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

78 
	mIFF_AUTOMEDIA
 = 0x4000,

79 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

80 
	mIFF_DYNAMIC
 = 0x8000

81 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

89 
	siçddr


91 
sockaddr
 
	miç_addr
;

94 
sockaddr
 
	mifu_brßdaddr
;

95 
sockaddr
 
	mifu_d¡addr
;

96 } 
	miç_ifu
;

97 
içû
 *
	miç_iå
;

98 
içddr
 *
	miç_Ãxt
;

101 
	#iç_brßdaddr
 
iç_ifu
.
ifu_brßdaddr


	)

102 
	#iç_d¡addr
 
iç_ifu
.
ifu_d¡addr


	)

112 
	sifm­


114 
	mmem_¡¬t
;

115 
	mmem_’d
;

116 
	mba£_addr
;

117 
	mœq
;

118 
	mdma
;

119 
	mpÜt
;

127 
	siäeq


129 
	#IFHWADDRLEN
 6

	)

130 
	#IFNAMSIZ
 
IF_NAMESIZE


	)

133 
	miän_Çme
[
IFNAMSIZ
];

134 } 
	miä_iän
;

138 
sockaddr
 
	miäu_addr
;

139 
sockaddr
 
	miäu_d¡addr
;

140 
sockaddr
 
	miäu_brßdaddr
;

141 
sockaddr
 
	miäu_Ãtmask
;

142 
sockaddr
 
	miäu_hwaddr
;

143 
	miäu_æags
;

144 
	miäu_iv®ue
;

145 
	miäu_mtu
;

146 
ifm­
 
	miäu_m­
;

147 
	miäu_¦ave
[
IFNAMSIZ
];

148 
	miäu_ÃwÇme
[
IFNAMSIZ
];

149 
__ÿddr_t
 
	miäu_d©a
;

150 } 
	miä_iäu
;

152 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

153 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

154 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

155 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

156 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

157 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

158 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

159 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

160 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

161 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

162 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

163 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

164 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

165 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

166 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

167 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

168 
	#_IOT_iäeq
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),16,0,0)

	)

169 
	#_IOT_iäeq_shÜt
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

170 
	#_IOT_iäeq_št
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

177 
	sifcÚf


179 
	mifc_Ën
;

182 
__ÿddr_t
 
	mifcu_buf
;

183 
iäeq
 *
	mifcu_»q
;

184 } 
	mifc_ifcu
;

186 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

187 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

188 
	#_IOT_ifcÚf
 
	`_IOT
(
	`_IOTS
(
ifcÚf
),1,0,0,0,0è

	)

191 
__BEGIN_DECLS


194 
	$if_Çm‘ošdex
 (
__cÚ¡
 *
__iâame
è
__THROW
;

195 *
	$if_šdextÚame
 (
__ifšdex
, *
__iâame
è
__THROW
;

198 
if_Çmešdex
 *
	$if_Çmešdex
 (è
__THROW
;

201 
	$if_ä“Çmešdex
 (
if_Çmešdex
 *
__±r
è
__THROW
;

203 
__END_DECLS


	@/usr/include/net/if_arp.h

23 #iâdeà
_NET_IF_ARP_H


25 
	#_NET_IF_ARP_H
 1

	)

26 
	~<sys/cdefs.h
>

28 
	~<sys/ty³s.h
>

29 
	~<sys/sock‘.h
>

31 
	g__BEGIN_DECLS


34 
	#MAX_ADDR_LEN
 7

	)

40 
	#ARPOP_REQUEST
 1

	)

41 
	#ARPOP_REPLY
 2

	)

42 
	#ARPOP_RREQUEST
 3

	)

43 
	#ARPOP_RREPLY
 4

	)

44 
	#ARPOP_InREQUEST
 8

	)

45 
	#ARPOP_InREPLY
 9

	)

46 
	#ARPOP_NAK
 10

	)

55 
	s¬phdr


57 
	m¬_hrd
;

58 
	m¬_´o
;

59 
	m¬_hÊ
;

60 
	m¬_¶n
;

61 
	m¬_İ
;

65 
	m__¬_sha
[
ETH_ALEN
];

66 
	m__¬_s
[4];

67 
	m__¬_tha
[
ETH_ALEN
];

68 
	m__¬_t
[4];

74 
	#ARPHRD_NETROM
 0

	)

75 
	#ARPHRD_ETHER
 1

	)

76 
	#ARPHRD_EETHER
 2

	)

77 
	#ARPHRD_AX25
 3

	)

78 
	#ARPHRD_PRONET
 4

	)

79 
	#ARPHRD_CHAOS
 5

	)

80 
	#ARPHRD_IEEE802
 6

	)

81 
	#ARPHRD_ARCNET
 7

	)

82 
	#ARPHRD_APPLETLK
 8

	)

83 
	#ARPHRD_DLCI
 15

	)

84 
	#ARPHRD_ATM
 19

	)

85 
	#ARPHRD_METRICOM
 23

	)

86 
	#ARPHRD_IEEE1394
 24

	)

87 
	#ARPHRD_EUI64
 27

	)

88 
	#ARPHRD_INFINIBAND
 32

	)

91 
	#ARPHRD_SLIP
 256

	)

92 
	#ARPHRD_CSLIP
 257

	)

93 
	#ARPHRD_SLIP6
 258

	)

94 
	#ARPHRD_CSLIP6
 259

	)

95 
	#ARPHRD_RSRVD
 260

	)

96 
	#ARPHRD_ADAPT
 264

	)

97 
	#ARPHRD_ROSE
 270

	)

98 
	#ARPHRD_X25
 271

	)

99 
	#ARPHRD_HWX25
 272

	)

100 
	#ARPHRD_PPP
 512

	)

101 
	#ARPHRD_CISCO
 513

	)

102 
	#ARPHRD_HDLC
 
ARPHRD_CISCO


	)

103 
	#ARPHRD_LAPB
 516

	)

104 
	#ARPHRD_DDCMP
 517

	)

105 
	#ARPHRD_RAWHDLC
 518

	)

107 
	#ARPHRD_TUNNEL
 768

	)

108 
	#ARPHRD_TUNNEL6
 769

	)

109 
	#ARPHRD_FRAD
 770

	)

110 
	#ARPHRD_SKIP
 771

	)

111 
	#ARPHRD_LOOPBACK
 772

	)

112 
	#ARPHRD_LOCALTLK
 773

	)

113 
	#ARPHRD_FDDI
 774

	)

114 
	#ARPHRD_BIF
 775

	)

115 
	#ARPHRD_SIT
 776

	)

116 
	#ARPHRD_IPDDP
 777

	)

117 
	#ARPHRD_IPGRE
 778

	)

118 
	#ARPHRD_PIMREG
 779

	)

119 
	#ARPHRD_HIPPI
 780

	)

120 
	#ARPHRD_ASH
 781

	)

121 
	#ARPHRD_ECONET
 782

	)

122 
	#ARPHRD_IRDA
 783

	)

123 
	#ARPHRD_FCPP
 784

	)

124 
	#ARPHRD_FCAL
 785

	)

125 
	#ARPHRD_FCPL
 786

	)

126 
	#ARPHRD_FCFABRIC
 787

	)

127 
	#ARPHRD_IEEE802_TR
 800

	)

128 
	#ARPHRD_IEEE80211
 801

	)

129 
	#ARPHRD_IEEE80211_PRISM
 802

	)

130 
	#ARPHRD_IEEE80211_RADIOTAP
 803

	)

132 
	#ARPHRD_VOID
 0xFFFF

	)

133 
	#ARPHRD_NONE
 0xFFFE

	)

137 
	s¬´eq


139 
sockaddr
 
	m¬p_·
;

140 
sockaddr
 
	m¬p_ha
;

141 
	m¬p_æags
;

142 
sockaddr
 
	m¬p_Ãtmask
;

143 
	m¬p_dev
[16];

146 
	s¬´eq_Şd


148 
sockaddr
 
	m¬p_·
;

149 
sockaddr
 
	m¬p_ha
;

150 
	m¬p_æags
;

151 
sockaddr
 
	m¬p_Ãtmask
;

155 
	#ATF_COM
 0x02

	)

156 
	#ATF_PERM
 0x04

	)

157 
	#ATF_PUBL
 0x08

	)

158 
	#ATF_USETRAILERS
 0x10

	)

159 
	#ATF_NETMASK
 0x20

	)

161 
	#ATF_DONTPUB
 0x40

	)

162 
	#ATF_MAGIC
 0x80

	)

166 
	#ARPD_UPDATE
 0x01

	)

167 
	#ARPD_LOOKUP
 0x02

	)

168 
	#ARPD_FLUSH
 0x03

	)

170 
	s¬pd_»que¡


172 
	m»q
;

173 
u_št32_t
 
	m
;

174 
	mdev
;

175 
	m¡amp
;

176 
	mupd©ed
;

177 
	mha
[
MAX_ADDR_LEN
];

180 
	g__END_DECLS


	@/usr/include/netinet/in.h

20 #iâdef 
_NETINET_IN_H


21 
	#_NETINET_IN_H
 1

	)

23 
	~<ã©u»s.h
>

24 
	~<¡dšt.h
>

25 
	~<sys/sock‘.h
>

26 
	~<b™s/ty³s.h
>

29 
__BEGIN_DECLS


34 
	mIPPROTO_IP
 = 0,

35 
	#IPPROTO_IP
 
IPPROTO_IP


	)

36 
	mIPPROTO_HOPOPTS
 = 0,

37 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

38 
	mIPPROTO_ICMP
 = 1,

39 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

40 
	mIPPROTO_IGMP
 = 2,

41 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

42 
	mIPPROTO_IPIP
 = 4,

43 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

44 
	mIPPROTO_TCP
 = 6,

45 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

46 
	mIPPROTO_EGP
 = 8,

47 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

48 
	mIPPROTO_PUP
 = 12,

49 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

50 
	mIPPROTO_UDP
 = 17,

51 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

52 
	mIPPROTO_IDP
 = 22,

53 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

54 
	mIPPROTO_TP
 = 29,

55 
	#IPPROTO_TP
 
IPPROTO_TP


	)

56 
	mIPPROTO_DCCP
 = 33,

57 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

58 
	mIPPROTO_IPV6
 = 41,

59 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

60 
	mIPPROTO_ROUTING
 = 43,

61 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

62 
	mIPPROTO_FRAGMENT
 = 44,

63 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

64 
	mIPPROTO_RSVP
 = 46,

65 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

66 
	mIPPROTO_GRE
 = 47,

67 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

68 
	mIPPROTO_ESP
 = 50,

69 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

70 
	mIPPROTO_AH
 = 51,

71 
	#IPPROTO_AH
 
IPPROTO_AH


	)

72 
	mIPPROTO_ICMPV6
 = 58,

73 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

74 
	mIPPROTO_NONE
 = 59,

75 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

76 
	mIPPROTO_DSTOPTS
 = 60,

77 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

78 
	mIPPROTO_MTP
 = 92,

79 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

80 
	mIPPROTO_ENCAP
 = 98,

81 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

82 
	mIPPROTO_PIM
 = 103,

83 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

84 
	mIPPROTO_COMP
 = 108,

85 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

86 
	mIPPROTO_SCTP
 = 132,

87 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

88 
	mIPPROTO_UDPLITE
 = 136,

89 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

90 
	mIPPROTO_RAW
 = 255,

91 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

92 
	mIPPROTO_MAX


97 
ušt16_t
 
	tš_pÜt_t
;

102 
	mIPPORT_ECHO
 = 7,

103 
	mIPPORT_DISCARD
 = 9,

104 
	mIPPORT_SYSTAT
 = 11,

105 
	mIPPORT_DAYTIME
 = 13,

106 
	mIPPORT_NETSTAT
 = 15,

107 
	mIPPORT_FTP
 = 21,

108 
	mIPPORT_TELNET
 = 23,

109 
	mIPPORT_SMTP
 = 25,

110 
	mIPPORT_TIMESERVER
 = 37,

111 
	mIPPORT_NAMESERVER
 = 42,

112 
	mIPPORT_WHOIS
 = 43,

113 
	mIPPORT_MTP
 = 57,

115 
	mIPPORT_TFTP
 = 69,

116 
	mIPPORT_RJE
 = 77,

117 
	mIPPORT_FINGER
 = 79,

118 
	mIPPORT_TTYLINK
 = 87,

119 
	mIPPORT_SUPDUP
 = 95,

122 
	mIPPORT_EXECSERVER
 = 512,

123 
	mIPPORT_LOGINSERVER
 = 513,

124 
	mIPPORT_CMDSERVER
 = 514,

125 
	mIPPORT_EFSSERVER
 = 520,

128 
	mIPPORT_BIFFUDP
 = 512,

129 
	mIPPORT_WHOSERVER
 = 513,

130 
	mIPPORT_ROUTESERVER
 = 520,

133 
	mIPPORT_RESERVED
 = 1024,

136 
	mIPPORT_USERRESERVED
 = 5000

141 
ušt32_t
 
	tš_addr_t
;

142 
	sš_addr


144 
š_addr_t
 
	ms_addr
;

153 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

154 
	#IN_CLASSA_NET
 0xff000000

	)

155 
	#IN_CLASSA_NSHIFT
 24

	)

156 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

157 
	#IN_CLASSA_MAX
 128

	)

159 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

160 
	#IN_CLASSB_NET
 0xffff0000

	)

161 
	#IN_CLASSB_NSHIFT
 16

	)

162 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

163 
	#IN_CLASSB_MAX
 65536

	)

165 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

166 
	#IN_CLASSC_NET
 0xffffff00

	)

167 
	#IN_CLASSC_NSHIFT
 8

	)

168 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

170 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

171 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

173 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

174 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

177 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

179 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

181 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

184 
	#IN_LOOPBACKNET
 127

	)

186 #iâdeà
INADDR_LOOPBACK


187 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

191 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

192 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

193 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

194 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

198 
	sš6_addr


202 
ušt8_t
 
	m__u6_addr8
[16];

203 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


204 
ušt16_t
 
	m__u6_addr16
[8];

205 
ušt32_t
 
	m__u6_addr32
[4];

207 } 
	m__š6_u
;

208 
	#s6_addr
 
__š6_u
.
__u6_addr8


	)

209 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


210 
	#s6_addr16
 
__š6_u
.
__u6_addr16


	)

211 
	#s6_addr32
 
__š6_u
.
__u6_addr32


	)

215 cÚ¡ 
š6_addr
 
š6addr_ªy
;

216 cÚ¡ 
š6_addr
 
š6addr_loİback
;

217 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

218 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

220 
	#INET_ADDRSTRLEN
 16

	)

221 
	#INET6_ADDRSTRLEN
 46

	)

225 
	ssockaddr_š


227 
__SOCKADDR_COMMON
 (
sš_
);

228 
š_pÜt_t
 
	msš_pÜt
;

229 
š_addr
 
	msš_addr
;

232 
	msš_z”o
[ (
sockaddr
) -

233 
__SOCKADDR_COMMON_SIZE
 -

234  (
š_pÜt_t
) -

235  (
š_addr
)];

239 
	ssockaddr_š6


241 
__SOCKADDR_COMMON
 (
sš6_
);

242 
š_pÜt_t
 
	msš6_pÜt
;

243 
ušt32_t
 
	msš6_æowšfo
;

244 
š6_addr
 
	msš6_addr
;

245 
ušt32_t
 
	msš6_scİe_id
;

249 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


251 
	s_m»q


254 
š_addr
 
	mimr_muÉŸddr
;

257 
š_addr
 
	mimr_š‹rçû
;

260 
	s_m»q_sourû


263 
š_addr
 
	mimr_muÉŸddr
;

266 
š_addr
 
	mimr_š‹rçû
;

269 
š_addr
 
	mimr_sourûaddr
;

275 
	sv6_m»q


278 
š6_addr
 
	mv6mr_muÉŸddr
;

281 
	mv6mr_š‹rçû
;

285 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


287 
	sgroup_»q


290 
ušt32_t
 
	mgr_š‹rçû
;

293 
sockaddr_¡Üage
 
	mgr_group
;

296 
	sgroup_sourû_»q


299 
ušt32_t
 
	mg¤_š‹rçû
;

302 
sockaddr_¡Üage
 
	mg¤_group
;

305 
sockaddr_¡Üage
 
	mg¤_sourû
;

310 
	s_msf‹r


313 
š_addr
 
	mimsf_muÉŸddr
;

316 
š_addr
 
	mimsf_š‹rçû
;

319 
ušt32_t
 
	mimsf_fmode
;

322 
ušt32_t
 
	mimsf_num¤c
;

324 
š_addr
 
	mimsf_¦i¡
[1];

327 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

328 -  (
š_addr
) \

329 + (
num¤c
è*  (
š_addr
))

	)

331 
	sgroup_f‹r


334 
ušt32_t
 
	mgf_š‹rçû
;

337 
sockaddr_¡Üage
 
	mgf_group
;

340 
ušt32_t
 
	mgf_fmode
;

343 
ušt32_t
 
	mgf_num¤c
;

345 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

348 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

349 -  (
sockaddr_¡Üage
) \

350 + ((
num¤c
) \

351 *  (
sockaddr_¡Üage
)))

	)

356 
	~<b™s/š.h
>

365 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

366 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

367 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

368 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

369 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

370 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

371 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

373 
	~<’dŸn.h
>

376 
	~<b™s/by‹sw­.h
>

378 #ifdeà
__OPTIMIZE__


382 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


385 
	#Áohl
(
x
è(x)

	)

386 
	#Áohs
(
x
è(x)

	)

387 
	#htÚl
(
x
è(x)

	)

388 
	#htÚs
(
x
è(x)

	)

390 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


391 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

392 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

393 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

394 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

399 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

400 (((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] == 0 \

401 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] == 0 \

402 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] == 0 \

403 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

405 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

406 (((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] == 0 \

407 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] == 0 \

408 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] == 0 \

409 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

411 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((
__cÚ¡
 
ušt8_t
 *è×))[0] =ğ0xff)

	)

413 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

414 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

415 =ğ
	`htÚl
 (0xã800000))

	)

417 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

418 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

419 =ğ
	`htÚl
 (0xãc00000))

	)

421 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

422 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] == 0) \

423 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] == 0) \

424 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

426 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

427 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] == 0) \

428 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] == 0) \

429 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] == 0) \

430 && (
	`Áohl
 (((
__cÚ¡
 
ušt32_t
 *è(
a
))[3]è> 1))

	)

432 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

433 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] =ğ((__cÚ¡ ušt32_ˆ*è(
b
))[0]) \

434 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] =ğ((__cÚ¡ ušt32_ˆ*è(
b
))[1]) \

435 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] =ğ((__cÚ¡ ušt32_ˆ*è(
b
))[2]) \

436 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[3] =ğ((__cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

438 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


440 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

443 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

444 
__THROW
;

448 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

449 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

450 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

452 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

453 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

454 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

456 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

457 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

458 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

460 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

461 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

462 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

464 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

465 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

466 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

469 #ifdeà
__USE_GNU


471 
	sš6_pktšfo


473 
š6_addr
 
i6_addr
;

474 
i6_ifšdex
;

478 
	s6_mtušfo


480 
sockaddr_š6
 
6m_addr
;

481 
ušt32_t
 
6m_mtu
;

486 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

487 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

488 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

489 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

490 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

491 
__cÚ¡
 
ušt8_t
 *
__ty³p
, 
__muÉx
,

492 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

493 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

494 
__muÉx
, 
__¶usy
)

495 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

496 
	$š‘6_İtiÚ_Ãxt
 (
__cÚ¡
 
cmsghdr
 *
__cmsg
,

497 
ušt8_t
 **
__Œp
)

498 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

499 
	$š‘6_İtiÚ_fšd
 (
__cÚ¡
 
cmsghdr
 *
__cmsg
,

500 
ušt8_t
 **
__Œp
, 
__ty³
)

501 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

505 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

506 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

507 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

508 **
__d©abuå
è
__THROW
;

509 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

510 
__THROW
;

511 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

512 
sockËn_t
 
__v®Ën
è
__THROW
;

513 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

514 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

515 **
__d©abuå
è
__THROW
;

516 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

517 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

518 **
__d©abuå
è
__THROW
;

519 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

520 
sockËn_t
 
__v®Ën
è
__THROW
;

524 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

525 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

526 
__£gm’ts
è
__THROW
;

527 
	$š‘6_¹h_add
 (*
__bp
, 
__cÚ¡
 
š6_addr
 *
__addr
è
__THROW
;

528 
	$š‘6_¹h_»v”£
 (
__cÚ¡
 *
__š
, *
__out
è
__THROW
;

529 
	$š‘6_¹h_£gm’ts
 (
__cÚ¡
 *
__bp
è
__THROW
;

530 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (
__cÚ¡
 *
__bp
, 
__šdex
)

531 
__THROW
;

537 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

538 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

539 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

540 
__THROW
;

543 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

544 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

545 
ušt32_t
 
__num¤c
,

546 
__cÚ¡
 
š_addr
 *
__¦i¡
)

547 
__THROW
;

551 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

552 
__cÚ¡
 
sockaddr
 *
__group
,

553 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

554 
ušt32_t
 *
__num¤c
,

555 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

558 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

559 
__cÚ¡
 
sockaddr
 *
__group
,

560 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

561 
ušt32_t
 
__num¤c
,

562 
__cÚ¡
 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

565 
__END_DECLS


	@/usr/include/poll.h

1 
	~<sys/pŞl.h
>

	@/usr/include/pwd.h

23 #iâdef 
_PWD_H


24 
	#_PWD_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


30 
	~<b™s/ty³s.h
>

32 
	#__Ãed_size_t


	)

33 
	~<¡ddef.h
>

35 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


38 #iâdeà
__gid_t_defšed


39 
__gid_t
 
	tgid_t
;

40 
	#__gid_t_defšed


	)

43 #iâdeà
__uid_t_defšed


44 
__uid_t
 
	tuid_t
;

45 
	#__uid_t_defšed


	)

50 
	s·sswd


52 *
	mpw_Çme
;

53 *
	mpw_·sswd
;

54 
__uid_t
 
	mpw_uid
;

55 
__gid_t
 
	mpw_gid
;

56 *
	mpw_gecos
;

57 *
	mpw_dœ
;

58 *
	mpw_sh–l
;

62 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_GNU


63 
	#__Ãed_FILE


	)

64 
	~<¡dio.h
>

68 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


73 
£w’t
 ();

79 
’dpw’t
 ();

85 
·sswd
 *
g‘pw’t
 ();

88 #ifdef 
__USE_SVID


95 
·sswd
 *
fg‘pw’t
 (
FILE
 *
__¡»am
);

103 
puw’t
 (
__cÚ¡
 
·sswd
 *
__»¡riù
 
__p
,

104 
FILE
 *
__»¡riù
 
__f
);

111 
·sswd
 *
g‘pwuid
 (
__uid_t
 
__uid
);

117 
·sswd
 *
g‘pwÇm
 (
__cÚ¡
 *
__Çme
);

119 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


121 #ifdeà
__USE_MISC


124 
	#NSS_BUFLEN_PASSWD
 1024

	)

135 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


140 
g‘pw’t_r
 (
·sswd
 *
__»¡riù
 
__»suÉbuf
,

141 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

142 
·sswd
 **
__»¡riù
 
__»suÉ
);

145 
g‘pwuid_r
 (
__uid_t
 
__uid
,

146 
·sswd
 *
__»¡riù
 
__»suÉbuf
,

147 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

148 
·sswd
 **
__»¡riù
 
__»suÉ
);

150 
g‘pwÇm_r
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

151 
·sswd
 *
__»¡riù
 
__»suÉbuf
,

152 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

153 
·sswd
 **
__»¡riù
 
__»suÉ
);

156 #ifdef 
__USE_SVID


164 
fg‘pw’t_r
 (
FILE
 *
__»¡riù
 
__¡»am
,

165 
·sswd
 *
__»¡riù
 
__»suÉbuf
,

166 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

167 
·sswd
 **
__»¡riù
 
__»suÉ
);

172 #ifdeà
__USE_GNU


181 
g‘pw
 (
__uid_t
 
__uid
, *
__bufãr
);

184 
	g__END_DECLS


	@/usr/include/scsi/scsi.h

24 #iâdeà
_SCSI_SCSI_H


25 
	#_SCSI_SCSI_H
 1

	)

27 
	~<ã©u»s.h
>

33 
	#TEST_UNIT_READY
 0x00

	)

34 
	#REZERO_UNIT
 0x01

	)

35 
	#REQUEST_SENSE
 0x03

	)

36 
	#FORMAT_UNIT
 0x04

	)

37 
	#READ_BLOCK_LIMITS
 0x05

	)

38 
	#REASSIGN_BLOCKS
 0x07

	)

39 
	#READ_6
 0x08

	)

40 
	#WRITE_6
 0x0a

	)

41 
	#SEEK_6
 0x0b

	)

42 
	#READ_REVERSE
 0x0f

	)

43 
	#WRITE_FILEMARKS
 0x10

	)

44 
	#SPACE
 0x11

	)

45 
	#INQUIRY
 0x12

	)

46 
	#RECOVER_BUFFERED_DATA
 0x14

	)

47 
	#MODE_SELECT
 0x15

	)

48 
	#RESERVE
 0x16

	)

49 
	#RELEASE
 0x17

	)

50 
	#COPY
 0x18

	)

51 
	#ERASE
 0x19

	)

52 
	#MODE_SENSE
 0x1a

	)

53 
	#START_STOP
 0x1b

	)

54 
	#RECEIVE_DIAGNOSTIC
 0x1c

	)

55 
	#SEND_DIAGNOSTIC
 0x1d

	)

56 
	#ALLOW_MEDIUM_REMOVAL
 0x1e

	)

58 
	#SET_WINDOW
 0x24

	)

59 
	#READ_CAPACITY
 0x25

	)

60 
	#READ_10
 0x28

	)

61 
	#WRITE_10
 0x2a

	)

62 
	#SEEK_10
 0x2b

	)

63 
	#WRITE_VERIFY
 0x2e

	)

64 
	#VERIFY
 0x2f

	)

65 
	#SEARCH_HIGH
 0x30

	)

66 
	#SEARCH_EQUAL
 0x31

	)

67 
	#SEARCH_LOW
 0x32

	)

68 
	#SET_LIMITS
 0x33

	)

69 
	#PRE_FETCH
 0x34

	)

70 
	#READ_POSITION
 0x34

	)

71 
	#SYNCHRONIZE_CACHE
 0x35

	)

72 
	#LOCK_UNLOCK_CACHE
 0x36

	)

73 
	#READ_DEFECT_DATA
 0x37

	)

74 
	#MEDIUM_SCAN
 0x38

	)

75 
	#COMPARE
 0x39

	)

76 
	#COPY_VERIFY
 0x3a

	)

77 
	#WRITE_BUFFER
 0x3b

	)

78 
	#READ_BUFFER
 0x3c

	)

79 
	#UPDATE_BLOCK
 0x3d

	)

80 
	#READ_LONG
 0x3e

	)

81 
	#WRITE_LONG
 0x3f

	)

82 
	#CHANGE_DEFINITION
 0x40

	)

83 
	#WRITE_SAME
 0x41

	)

84 
	#READ_TOC
 0x43

	)

85 
	#LOG_SELECT
 0x4c

	)

86 
	#LOG_SENSE
 0x4d

	)

87 
	#MODE_SELECT_10
 0x55

	)

88 
	#RESERVE_10
 0x56

	)

89 
	#RELEASE_10
 0x57

	)

90 
	#MODE_SENSE_10
 0x5a

	)

91 
	#PERSISTENT_RESERVE_IN
 0x5e

	)

92 
	#PERSISTENT_RESERVE_OUT
 0x5f

	)

93 
	#MOVE_MEDIUM
 0xa5

	)

94 
	#READ_12
 0xa8

	)

95 
	#WRITE_12
 0x¯

	)

96 
	#WRITE_VERIFY_12
 0x«

	)

97 
	#SEARCH_HIGH_12
 0xb0

	)

98 
	#SEARCH_EQUAL_12
 0xb1

	)

99 
	#SEARCH_LOW_12
 0xb2

	)

100 
	#READ_ELEMENT_STATUS
 0xb8

	)

101 
	#SEND_VOLUME_TAG
 0xb6

	)

102 
	#WRITE_LONG_2
 0x—

	)

108 
	#GOOD
 0x00

	)

109 
	#CHECK_CONDITION
 0x01

	)

110 
	#CONDITION_GOOD
 0x02

	)

111 
	#BUSY
 0x04

	)

112 
	#INTERMEDIATE_GOOD
 0x08

	)

113 
	#INTERMEDIATE_C_GOOD
 0x0a

	)

114 
	#RESERVATION_CONFLICT
 0x0c

	)

115 
	#COMMAND_TERMINATED
 0x11

	)

116 
	#QUEUE_FULL
 0x14

	)

118 
	#STATUS_MASK
 0x3e

	)

124 
	#NO_SENSE
 0x00

	)

125 
	#RECOVERED_ERROR
 0x01

	)

126 
	#NOT_READY
 0x02

	)

127 
	#MEDIUM_ERROR
 0x03

	)

128 
	#HARDWARE_ERROR
 0x04

	)

129 
	#ILLEGAL_REQUEST
 0x05

	)

130 
	#UNIT_ATTENTION
 0x06

	)

131 
	#DATA_PROTECT
 0x07

	)

132 
	#BLANK_CHECK
 0x08

	)

133 
	#COPY_ABORTED
 0x0a

	)

134 
	#ABORTED_COMMAND
 0x0b

	)

135 
	#VOLUME_OVERFLOW
 0x0d

	)

136 
	#MISCOMPARE
 0x0e

	)

143 
	#TYPE_DISK
 0x00

	)

144 
	#TYPE_TAPE
 0x01

	)

145 
	#TYPE_PROCESSOR
 0x03

	)

146 
	#TYPE_WORM
 0x04

	)

147 
	#TYPE_ROM
 0x05

	)

148 
	#TYPE_SCANNER
 0x06

	)

149 
	#TYPE_MOD
 0x07

	)

151 
	#TYPE_MEDIUM_CHANGER
 0x08

	)

152 
	#TYPE_ENCLOSURE
 0x0d

	)

153 
	#TYPE_NO_LUN
 0x7f

	)

161 
	sccs_mode£l_h—d


163 
	m_r1
;

164 
	mmedium
;

165 
	m_r2
;

166 
	mblock_desc_Ëngth
;

167 
	md’s™y
;

168 
	mnumb”_blocks_hi
;

170 
	mnumb”_blocks_med
;

171 
	mnumb”_blocks_lo
;

172 
	m_r3
;

173 
	mblock_Ëngth_hi
;

175 
	mblock_Ëngth_med
;

176 
	mblock_Ëngth_lo
;

183 
	#COMMAND_COMPLETE
 0x00

	)

184 
	#EXTENDED_MESSAGE
 0x01

	)

185 
	#EXTENDED_MODIFY_DATA_POINTER
 0x00

	)

186 
	#EXTENDED_SDTR
 0x01

	)

187 
	#EXTENDED_EXTENDED_IDENTIFY
 0x02

	)

188 
	#EXTENDED_WDTR
 0x03

	)

189 
	#SAVE_POINTERS
 0x02

	)

190 
	#RESTORE_POINTERS
 0x03

	)

191 
	#DISCONNECT
 0x04

	)

192 
	#INITIATOR_ERROR
 0x05

	)

193 
	#ABORT
 0x06

	)

194 
	#MESSAGE_REJECT
 0x07

	)

195 
	#NOP
 0x08

	)

196 
	#MSG_PARITY_ERROR
 0x09

	)

197 
	#LINKED_CMD_COMPLETE
 0x0a

	)

198 
	#LINKED_FLG_CMD_COMPLETE
 0x0b

	)

199 
	#BUS_DEVICE_RESET
 0x0c

	)

201 
	#INITIATE_RECOVERY
 0x0à

	)

202 
	#RELEASE_RECOVERY
 0x10

	)

204 
	#SIMPLE_QUEUE_TAG
 0x20

	)

205 
	#HEAD_OF_QUEUE_TAG
 0x21

	)

206 
	#ORDERED_QUEUE_TAG
 0x22

	)

213 
	#SCSI_IOCTL_GET_IDLUN
 0x5382

	)

217 
	#SCSI_IOCTL_TAGGED_ENABLE
 0x5383

	)

218 
	#SCSI_IOCTL_TAGGED_DISABLE
 0x5384

	)

221 
	#SCSI_IOCTL_PROBE_HOST
 0x5385

	)

224 
	#SCSI_IOCTL_GET_BUS_NUMBER
 0x5386

	)

	@/usr/include/scsi/sg.h

26 #iâdeà
_SCSI_SG_H


27 
	#_SCSI_SG_H
 1

	)

29 
	~<ã©u»s.h
>

36 
	ssg_iovec


38 * 
	miov_ba£
;

39 
size_t
 
	miov_Ën
;

40 } 
	tsg_iovec_t
;

43 
	ssg_io_hdr


45 
	mš‹rçû_id
;

46 
	mdxãr_dœeùiÚ
;

47 
	mcmd_Ën
;

48 
	mmx_sb_Ën
;

49 
	miovec_couÁ
;

50 
	mdxãr_Ën
;

51 * 
	mdxã½
;

53 * 
	mcmdp
;

54 * 
	msbp
;

55 
	mtimeout
;

56 
	mæags
;

57 
	m·ck_id
;

58 * 
	mu¤_±r
;

59 
	m¡©us
;

60 
	mmasked_¡©us
;

61 
	mmsg_¡©us
;

62 
	msb_Ën_wr
;

63 
	mho¡_¡©us
;

64 
	mdriv”_¡©us
;

65 
	m»sid
;

66 
	mdu¿tiÚ
;

67 
	mšfo
;

68 } 
	tsg_io_hdr_t
;

72 
	#SG_DXFER_NONE
 -1

	)

73 
	#SG_DXFER_TO_DEV
 -2

	)

74 
	#SG_DXFER_FROM_DEV
 -3

	)

75 
	#SG_DXFER_TO_FROM_DEV
 -4

	)

82 
	#SG_FLAG_DIRECT_IO
 1

	)

83 
	#SG_FLAG_LUN_INHIBIT
 2

	)

85 
	#SG_FLAG_NO_DXFER
 0x10000

	)

89 
	#SG_INFO_OK_MASK
 0x1

	)

90 
	#SG_INFO_OK
 0x0

	)

91 
	#SG_INFO_CHECK
 0x1

	)

93 
	#SG_INFO_DIRECT_IO_MASK
 0x6

	)

94 
	#SG_INFO_INDIRECT_IO
 0x0

	)

95 
	#SG_INFO_DIRECT_IO
 0x2

	)

96 
	#SG_INFO_MIXED_IO
 0x4

	)

101 
	ssg_scsi_id
 {

103 
	mho¡_no
;

104 
	mchªÃl
;

106 
	mscsi_id
;

107 
	mlun
;

109 
	mscsi_ty³
;

111 
	mh_cmd_³r_lun
;

113 
	md_queue_d•th
;

115 
	munu£d
[2];

119 
	ssg_»q_šfo
 {

120 
	m»q_¡©e
;

121 
	mÜphª
;

122 
	msg_io_owÃd
;

123 
	m´obËm
;

124 
	m·ck_id
;

125 * 
	mu¤_±r
;

126 
	mdu¿tiÚ
;

128 
	munu£d
;

129 } 
	tsg_»q_šfo_t
;

136 
	#SG_EMULATED_HOST
 0x2203

	)

140 
	#SG_SET_TRANSFORM
 0x2204

	)

142 
	#SG_GET_TRANSFORM
 0x2205

	)

144 
	#SG_SET_RESERVED_SIZE
 0x2275

	)

145 
	#SG_GET_RESERVED_SIZE
 0x2272

	)

148 
	#SG_GET_SCSI_ID
 0x2276

	)

152 
	#SG_SET_FORCE_LOW_DMA
 0x2279

	)

153 
	#SG_GET_LOW_DMA
 0x227¨

	)

159 
	#SG_SET_FORCE_PACK_ID
 0x227b

	)

160 
	#SG_GET_PACK_ID
 0x227ø

	)

162 
	#SG_GET_NUM_WAITING
 0x227d

	)

165 
	#SG_GET_SG_TABLESIZE
 0x227F

	)

167 
	#SG_GET_VERSION_NUM
 0x2282

	)

170 
	#SG_SCSI_RESET
 0x2284

	)

172 
	#SG_SCSI_RESET_NOTHING
 0

	)

173 
	#SG_SCSI_RESET_DEVICE
 1

	)

174 
	#SG_SCSI_RESET_BUS
 2

	)

175 
	#SG_SCSI_RESET_HOST
 3

	)

178 
	#SG_IO
 0x2285

	)

180 
	#SG_GET_REQUEST_TABLE
 0x2286

	)

183 
	#SG_SET_KEEP_ORPHAN
 0x2287

	)

184 
	#SG_GET_KEEP_ORPHAN
 0x2288

	)

187 
	#SG_SCATTER_SZ
 (8 * 4096è

	)

195 
	#SG_DEFAULT_RETRIES
 1

	)

198 
	#SG_DEF_FORCE_LOW_DMA
 0

	)

199 
	#SG_DEF_FORCE_PACK_ID
 0

	)

200 
	#SG_DEF_KEEP_ORPHAN
 0

	)

201 
	#SG_DEF_RESERVED_SIZE
 
SG_SCATTER_SZ


	)

204 
	#SG_MAX_QUEUE
 16

	)

206 
	#SG_BIG_BUFF
 
SG_DEF_RESERVED_SIZE


	)

209 
sg_io_hdr
 
	tSg_io_hdr
;

210 
sg_io_vec
 
	tSg_io_vec
;

211 
sg_scsi_id
 
	tSg_scsi_id
;

212 
sg_»q_šfo
 
	tSg_»q_šfo
;

219 
	#SG_MAX_SENSE
 16

	)

221 
	ssg_h—d”


224 
	m·ck_Ën
;

226 
	m»¶y_Ën
;

228 
	m·ck_id
;

230 
	m»suÉ
;

232 
	mtw–ve_by‹
:1;

234 
	mrg‘_¡©us
:5;

236 
	mho¡_¡©us
:8;

238 
	mdriv”_¡©us
:8;

240 
	mÙh”_æags
:10;

245 
	m£n£_bufãr
[
SG_MAX_SENSE
];

253 
	#SG_SET_TIMEOUT
 0x2201

	)

254 
	#SG_GET_TIMEOUT
 0x2202

	)

257 
	#SG_GET_COMMAND_Q
 0x2270

	)

258 
	#SG_SET_COMMAND_Q
 0x2271

	)

262 
	#SG_SET_DEBUG
 0x227

	)

264 
	#SG_NEXT_CMD_LEN
 0x2283

	)

269 
	#SG_DEFAULT_TIMEOUT
 (60*
HZ
è

	)

270 
	#SG_DEF_COMMAND_Q
 0

	)

272 
	#SG_DEF_UNDERRUN_FLAG
 0

	)

	@/usr/include/signal.h

23 #iâdef 
_SIGNAL_H


25 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


26 
	#_SIGNAL_H


	)

29 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


33 
	~<b™s/sig£t.h
>

37 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


38 #iâdeà
__sig_©omic_t_defšed


39 
	#__sig_©omic_t_defšed


	)

40 
__BEGIN_NAMESPACE_STD


41 
__sig_©omic_t
 
	tsig_©omic_t
;

42 
	g__END_NAMESPACE_STD


44 #undeà
__Ãed_sig_©omic_t


47 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

48 #iâdeà
__sig£t_t_defšed


49 
	#__sig£t_t_defšed


	)

50 
__sig£t_t
 
	tsig£t_t
;

52 #undeà
__Ãed_sig£t_t


55 #ifdeà
_SIGNAL_H


57 
	~<b™s/ty³s.h
>

58 
	~<b™s/signum.h
>

60 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


61 #iâdeà
__pid_t_defšed


62 
__pid_t
 
	tpid_t
;

63 
	#__pid_t_defšed


	)

65 #ifdeà
__USE_XOPEN


67 #iâdeà
__uid_t_defšed


68 
__uid_t
 
	tuid_t
;

69 
	#__uid_t_defšed


	)

75 (*
	t__sighªdËr_t
) ();

80 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

81 
__THROW
;

82 #ifdeà
__USE_GNU


83 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

84 
__THROW
;

90 
__BEGIN_NAMESPACE_STD


91 #ifdeà
__USE_BSD


92 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

93 
__THROW
;

96 #ifdeà
__REDIRECT_NTH


97 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

98 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

99 
__sysv_sigÇl
);

101 
	#sigÇl
 
__sysv_sigÇl


	)

104 
__END_NAMESPACE_STD


106 #ifdeà
__USE_XOPEN


109 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

110 
__THROW
;

116 #ifdeà
__USE_POSIX


117 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

120 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


124 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

127 
__BEGIN_NAMESPACE_STD


129 
	$¿i£
 (
__sig
è
__THROW
;

130 
__END_NAMESPACE_STD


132 #ifdeà
__USE_SVID


134 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

135 
__THROW
;

136 
	$gsigÇl
 (
__sig
è
__THROW
;

139 #ifdeà
__USE_MISC


141 
	`psigÇl
 (
__sig
, 
__cÚ¡
 *
__s
);

153 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

155 #ifdeà
__FAVOR_BSD


158 
	$sig·u£
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

160 #ifdeà
__USE_XOPEN


161 #ifdeà
__GNUC__


162 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

165 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

171 #ifdeà
__USE_BSD


178 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

181 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

184 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

187 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

191 #ifdeà
__USE_MISC


192 
	#NSIG
 
_NSIG


	)

195 #ifdeà
__USE_GNU


196 
__sighªdËr_t
 
	tsighªdËr_t
;

200 #ifdeà
__USE_BSD


201 
__sighªdËr_t
 
	tsig_t
;

204 #ifdeà
__USE_POSIX


206 #ifdeà
__USE_POSIX199309


208 
	#__Ãed_time¥ec


	)

209 
	~<time.h
>

212 
	~<b™s/sigšfo.h
>

216 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

219 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

222 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

228 
	$sigismemb”
 (
__cÚ¡
 
sig£t_t
 *
__£t
, 
__signo
)

229 
__THROW
 
	`__nÚnuÎ
 ((1));

231 #ifdeà
__USE_GNU


233 
	$sigi£m±y£t
 (
__cÚ¡
 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

236 
	$sigªd£t
 (
sig£t_t
 *
__£t
, 
__cÚ¡
 sig£t_ˆ*
__Ëá
,

237 
__cÚ¡
 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

240 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, 
__cÚ¡
 sig£t_ˆ*
__Ëá
,

241 
__cÚ¡
 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

246 
	~<b™s/sigaùiÚ.h
>

249 
	$sig´ocmask
 (
__how
, 
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

250 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

257 
	$sigsu¥’d
 (
__cÚ¡
 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

260 
	$sigaùiÚ
 (
__sig
, 
__cÚ¡
 
sigaùiÚ
 *
__»¡riù
 
__aù
,

261 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

264 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

271 
	$sigwa™
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

272 
	`__nÚnuÎ
 ((1, 2));

274 #ifdeà
__USE_POSIX199309


279 
	$sigwa™šfo
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

280 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

287 
	$sigtimedwa™
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

288 
sigšfo_t
 *
__»¡riù
 
__šfo
,

289 
__cÚ¡
 
time¥ec
 *
__»¡riù
 
__timeout
)

290 
	`__nÚnuÎ
 ((1));

294 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, 
__cÚ¡
 
sigv®
 
__v®
)

295 
__THROW
;

300 #ifdeà
__USE_BSD


304 
__cÚ¡
 *__cÚ¡ 
_sys_sigli¡
[
_NSIG
];

305 
__cÚ¡
 *__cÚ¡ 
sys_sigli¡
[
_NSIG
];

308 
	ssigvec


310 
__sighªdËr_t
 
sv_hªdËr
;

311 
sv_mask
;

313 
sv_æags
;

314 
	#sv_Ú¡ack
 
sv_æags


	)

318 
	#SV_ONSTACK
 (1 << 0)

	)

319 
	#SV_INTERRUPT
 (1 << 1)

	)

320 
	#SV_RESETHAND
 (1 << 2)

	)

328 
	$sigvec
 (
__sig
, 
__cÚ¡
 
sigvec
 *
__vec
,

329 
sigvec
 *
__ovec
è
__THROW
;

333 
	~<b™s/sigcÚ‹xt.h
>

336 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

341 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


342 
	#__Ãed_size_t


	)

343 
	~<¡ddef.h
>

348 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

350 
	~<b™s/sig¡ack.h
>

351 #ifdeà
__USE_XOPEN


353 
	~<sys/ucÚ‹xt.h
>

359 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

360 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

364 
	$sig®t¡ack
 (
__cÚ¡
 
sig®t¡ack
 *
__»¡riù
 
__ss
,

365 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

369 #ifdeà
__USE_XOPEN_EXTENDED


373 
	$sighŞd
 (
__sig
è
__THROW
;

376 
	$sig»l£
 (
__sig
è
__THROW
;

379 
	$sigignÜe
 (
__sig
è
__THROW
;

382 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

385 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


388 
	~<b™s/±h»adty³s.h
>

389 
	~<b™s/sigth»ad.h
>

396 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

398 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

402 
__END_DECLS


	@/usr/include/stdint.h

23 #iâdeà
_STDINT_H


24 
	#_STDINT_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/wch¬.h
>

28 
	~<b™s/wÜdsize.h
>

35 #iâdeà
__št8_t_defšed


36 
	#__št8_t_defšed


	)

37 sigÃd 
	tšt8_t
;

38 
	tšt16_t
;

39 
	tšt32_t
;

40 #ià
__WORDSIZE
 == 64

41 
	tšt64_t
;

43 
__ex‹nsiÚ__


44 
	tšt64_t
;

49 
	tušt8_t
;

50 
	tušt16_t
;

51 #iâdeà
__ušt32_t_defšed


52 
	tušt32_t
;

53 
	#__ušt32_t_defšed


	)

55 #ià
__WORDSIZE
 == 64

56 
	tušt64_t
;

58 
__ex‹nsiÚ__


59 
	tušt64_t
;

66 sigÃd 
	tšt_Ëa¡8_t
;

67 
	tšt_Ëa¡16_t
;

68 
	tšt_Ëa¡32_t
;

69 #ià
__WORDSIZE
 == 64

70 
	tšt_Ëa¡64_t
;

72 
__ex‹nsiÚ__


73 
	tšt_Ëa¡64_t
;

77 
	tušt_Ëa¡8_t
;

78 
	tušt_Ëa¡16_t
;

79 
	tušt_Ëa¡32_t
;

80 #ià
__WORDSIZE
 == 64

81 
	tušt_Ëa¡64_t
;

83 
__ex‹nsiÚ__


84 
	tušt_Ëa¡64_t
;

91 sigÃd 
	tšt_ç¡8_t
;

92 #ià
__WORDSIZE
 == 64

93 
	tšt_ç¡16_t
;

94 
	tšt_ç¡32_t
;

95 
	tšt_ç¡64_t
;

97 
	tšt_ç¡16_t
;

98 
	tšt_ç¡32_t
;

99 
__ex‹nsiÚ__


100 
	tšt_ç¡64_t
;

104 
	tušt_ç¡8_t
;

105 #ià
__WORDSIZE
 == 64

106 
	tušt_ç¡16_t
;

107 
	tušt_ç¡32_t
;

108 
	tušt_ç¡64_t
;

110 
	tušt_ç¡16_t
;

111 
	tušt_ç¡32_t
;

112 
__ex‹nsiÚ__


113 
	tušt_ç¡64_t
;

118 #ià
__WORDSIZE
 == 64

119 #iâdeà
__šŒ_t_defšed


120 
	tšŒ_t
;

121 
	#__šŒ_t_defšed


	)

123 
	tušŒ_t
;

125 #iâdeà
__šŒ_t_defšed


126 
	tšŒ_t
;

127 
	#__šŒ_t_defšed


	)

129 
	tušŒ_t
;

134 #ià
__WORDSIZE
 == 64

135 
	tštmax_t
;

136 
	tuštmax_t
;

138 
__ex‹nsiÚ__


139 
	tštmax_t
;

140 
__ex‹nsiÚ__


141 
	tuštmax_t
;

147 #ià!
defšed
 
__ılu¥lus
 || defšed 
__STDC_LIMIT_MACROS


149 #ià
__WORDSIZE
 == 64

150 
	#__INT64_C
(
c
èø## 
L


	)

151 
	#__UINT64_C
(
c
èø## 
UL


	)

153 
	#__INT64_C
(
c
èø## 
LL


	)

154 
	#__UINT64_C
(
c
èø## 
ULL


	)

160 
	#INT8_MIN
 (-128)

	)

161 
	#INT16_MIN
 (-32767-1)

	)

162 
	#INT32_MIN
 (-2147483647-1)

	)

163 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

165 
	#INT8_MAX
 (127)

	)

166 
	#INT16_MAX
 (32767)

	)

167 
	#INT32_MAX
 (2147483647)

	)

168 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

171 
	#UINT8_MAX
 (255)

	)

172 
	#UINT16_MAX
 (65535)

	)

173 
	#UINT32_MAX
 (4294967295U)

	)

174 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

178 
	#INT_LEAST8_MIN
 (-128)

	)

179 
	#INT_LEAST16_MIN
 (-32767-1)

	)

180 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

181 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

183 
	#INT_LEAST8_MAX
 (127)

	)

184 
	#INT_LEAST16_MAX
 (32767)

	)

185 
	#INT_LEAST32_MAX
 (2147483647)

	)

186 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

189 
	#UINT_LEAST8_MAX
 (255)

	)

190 
	#UINT_LEAST16_MAX
 (65535)

	)

191 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

192 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

196 
	#INT_FAST8_MIN
 (-128)

	)

197 #ià
__WORDSIZE
 == 64

198 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

199 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

201 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

202 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

204 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

206 
	#INT_FAST8_MAX
 (127)

	)

207 #ià
__WORDSIZE
 == 64

208 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

209 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

211 
	#INT_FAST16_MAX
 (2147483647)

	)

212 
	#INT_FAST32_MAX
 (2147483647)

	)

214 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

217 
	#UINT_FAST8_MAX
 (255)

	)

218 #ià
__WORDSIZE
 == 64

219 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

220 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

222 
	#UINT_FAST16_MAX
 (4294967295U)

	)

223 
	#UINT_FAST32_MAX
 (4294967295U)

	)

225 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

229 #ià
__WORDSIZE
 == 64

230 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

231 
	#INTPTR_MAX
 (9223372036854775807L)

	)

232 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

234 
	#INTPTR_MIN
 (-2147483647-1)

	)

235 
	#INTPTR_MAX
 (2147483647)

	)

236 
	#UINTPTR_MAX
 (4294967295U)

	)

241 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

243 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

246 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

252 #ià
__WORDSIZE
 == 64

253 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

254 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

256 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

257 
	#PTRDIFF_MAX
 (2147483647)

	)

261 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

262 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

265 #ià
__WORDSIZE
 == 64

266 
	#SIZE_MAX
 (18446744073709551615UL)

	)

268 
	#SIZE_MAX
 (4294967295U)

	)

272 #iâdeà
WCHAR_MIN


274 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

275 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

279 
	#WINT_MIN
 (0u)

	)

280 
	#WINT_MAX
 (4294967295u)

	)

287 #ià!
defšed
 
__ılu¥lus
 || defšed 
__STDC_CONSTANT_MACROS


290 
	#INT8_C
(
c
è
	)
c

291 
	#INT16_C
(
c
è
	)
c

292 
	#INT32_C
(
c
è
	)
c

293 #ià
__WORDSIZE
 == 64

294 
	#INT64_C
(
c
èø## 
L


	)

296 
	#INT64_C
(
c
èø## 
LL


	)

300 
	#UINT8_C
(
c
è
	)
c

301 
	#UINT16_C
(
c
è
	)
c

302 
	#UINT32_C
(
c
èø## 
U


	)

303 #ià
__WORDSIZE
 == 64

304 
	#UINT64_C
(
c
èø## 
UL


	)

306 
	#UINT64_C
(
c
èø## 
ULL


	)

310 #ià
__WORDSIZE
 == 64

311 
	#INTMAX_C
(
c
èø## 
L


	)

312 
	#UINTMAX_C
(
c
èø## 
UL


	)

314 
	#INTMAX_C
(
c
èø## 
LL


	)

315 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/stdio.h

24 #iâdeà
_STDIO_H


26 #ià!
defšed
 
__Ãed_FILE
 && !defšed 
__Ãed___FILE


27 
	#_STDIO_H
 1

	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


32 
	#__Ãed_size_t


	)

33 
	#__Ãed_NULL


	)

34 
	~<¡ddef.h
>

36 
	~<b™s/ty³s.h
>

37 
	#__Ãed_FILE


	)

38 
	#__Ãed___FILE


	)

42 #ià!
defšed
 
__FILE_defšed
 && defšed 
__Ãed_FILE


45 
	g_IO_FILE
;

47 
__BEGIN_NAMESPACE_STD


49 
_IO_FILE
 
	tFILE
;

50 
	g__END_NAMESPACE_STD


51 #ià
defšed
 
__USE_LARGEFILE64
 || defšed 
__USE_SVID
 || defšed 
__USE_POSIX
 \

52 || 
defšed
 
	g__USE_BSD
 || defšed 
	g__USE_ISOC99
 || defšed 
	g__USE_XOPEN
 \

53 || 
defšed
 
__USE_POSIX2


54 
	$__USING_NAMESPACE_STD
(
FILE
)

57 
	#__FILE_defšed
 1

	)

59 #undeà
__Ãed_FILE


62 #ià!
defšed
 
____FILE_defšed
 && defšed 
__Ãed___FILE


65 
_IO_FILE
 
	t__FILE
;

67 
	#____FILE_defšed
 1

	)

69 #undeà
__Ãed___FILE


72 #ifdef 
_STDIO_H


73 
	#_STDIO_USES_IOSTREAM


	)

75 
	~<libio.h
>

77 #ifdeà
__USE_XOPEN


78 #ifdeà
__GNUC__


79 #iâdeà
_VA_LIST_DEFINED


80 
_G_va_li¡
 
	tva_li¡
;

81 
	#_VA_LIST_DEFINED


	)

84 
	~<¡d¬g.h
>

89 
__BEGIN_NAMESPACE_STD


90 #iâdeà
__USE_FILE_OFFSET64


91 
_G_åos_t
 
	tåos_t
;

93 
_G_åos64_t
 
	tåos_t
;

95 
__END_NAMESPACE_STD


96 #ifdeà
__USE_LARGEFILE64


97 
_G_åos64_t
 
	tåos64_t
;

101 
	#_IOFBF
 0

	)

102 
	#_IOLBF
 1

	)

103 
	#_IONBF
 2

	)

107 #iâdeà
BUFSIZ


108 
	#BUFSIZ
 
_IO_BUFSIZ


	)

114 #iâdeà
EOF


115 
	#EOF
 (-1)

	)

121 
	#SEEK_SET
 0

	)

122 
	#SEEK_CUR
 1

	)

123 
	#SEEK_END
 2

	)

126 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


128 
	#P_tmpdœ
 "/tmp"

	)

141 
	~<b™s/¡dio_lim.h
>

145 
_IO_FILE
 *
¡dš
;

146 
_IO_FILE
 *
¡dout
;

147 
_IO_FILE
 *
¡d”r
;

149 
	#¡dš
 
¡dš


	)

150 
	#¡dout
 
¡dout


	)

151 
	#¡d”r
 
¡d”r


	)

153 
__BEGIN_NAMESPACE_STD


155 
	$»move
 (
__cÚ¡
 *
__f’ame
è
__THROW
;

157 
	$»Çme
 (
__cÚ¡
 *
__Şd
, __cÚ¡ *
__Ãw
è
__THROW
;

158 
__END_NAMESPACE_STD


160 #ifdeà
__USE_ATFILE


162 
	$»Çm—t
 (
__Şdfd
, 
__cÚ¡
 *
__Şd
, 
__Ãwfd
,

163 
__cÚ¡
 *
__Ãw
è
__THROW
;

166 
__BEGIN_NAMESPACE_STD


171 #iâdeà
__USE_FILE_OFFSET64


172 
FILE
 *
	$tmpfe
 (è
__wur
;

174 #ifdeà
__REDIRECT


175 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

177 
	#tmpfe
 
tmpfe64


	)

181 #ifdeà
__USE_LARGEFILE64


182 
FILE
 *
	$tmpfe64
 (è
__wur
;

186 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

187 
__END_NAMESPACE_STD


189 #ifdeà
__USE_MISC


192 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

196 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


204 *
	$‹m²am
 (
__cÚ¡
 *
__dœ
, __cÚ¡ *
__pfx
)

205 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

209 
__BEGIN_NAMESPACE_STD


214 
	`fşo£
 (
FILE
 *
__¡»am
);

219 
	`fæush
 (
FILE
 *
__¡»am
);

220 
__END_NAMESPACE_STD


222 #ifdeà
__USE_MISC


229 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

232 #ifdeà
__USE_GNU


239 
	`fşo£®l
 ();

243 
__BEGIN_NAMESPACE_STD


244 #iâdeà
__USE_FILE_OFFSET64


249 
FILE
 *
	$fİ’
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

250 
__cÚ¡
 *
__»¡riù
 
__modes
è
__wur
;

255 
FILE
 *
	$äeİ’
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

256 
__cÚ¡
 *
__»¡riù
 
__modes
,

257 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

259 #ifdeà
__REDIRECT


260 
FILE
 *
	`__REDIRECT
 (
fİ’
, (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

261 
__cÚ¡
 *
__»¡riù
 
__modes
), 
fİ’64
)

262 
__wur
;

263 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

264 
__cÚ¡
 *
__»¡riù
 
__modes
,

265 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

266 
__wur
;

268 
	#fİ’
 
fİ’64


	)

269 
	#äeİ’
 
äeİ’64


	)

272 
__END_NAMESPACE_STD


273 #ifdeà
__USE_LARGEFILE64


274 
FILE
 *
	$fİ’64
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

275 
__cÚ¡
 *
__»¡riù
 
__modes
è
__wur
;

276 
FILE
 *
	$äeİ’64
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

277 
__cÚ¡
 *
__»¡riù
 
__modes
,

278 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

281 #ifdef 
__USE_POSIX


283 
FILE
 *
	$fdİ’
 (
__fd
, 
__cÚ¡
 *
__modes
è
__THROW
 
__wur
;

286 #ifdef 
__USE_GNU


289 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

290 
__cÚ¡
 *
__»¡riù
 
__modes
,

291 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

294 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, 
__cÚ¡
 *
__modes
)

295 
__THROW
 
__wur
;

300 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

304 
__BEGIN_NAMESPACE_STD


307 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

311 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

312 
__modes
, 
size_t
 
__n
è
__THROW
;

313 
__END_NAMESPACE_STD


315 #ifdef 
__USE_BSD


318 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

319 
size_t
 
__size
è
__THROW
;

322 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

326 
__BEGIN_NAMESPACE_STD


331 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

332 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

337 
	`´štf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

339 
	$¥rštf
 (*
__»¡riù
 
__s
,

340 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

346 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fÜm©
,

347 
_G_va_li¡
 
__¬g
);

352 
	`v´štf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

354 
	$v¥rštf
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fÜm©
,

355 
_G_va_li¡
 
__¬g
è
__THROW
;

356 
__END_NAMESPACE_STD


358 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


359 
__BEGIN_NAMESPACE_C99


361 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

362 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...)

363 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

365 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

366 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

367 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

368 
__END_NAMESPACE_C99


371 #ifdeà
__USE_GNU


374 
	$va¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__f
,

375 
_G_va_li¡
 
__¬g
)

376 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

377 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

378 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

379 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

380 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

381 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

382 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

390 
	$vd´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
,

391 
_G_va_li¡
 
__¬g
)

392 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

393 
	$d´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

394 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

398 
__BEGIN_NAMESPACE_STD


403 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

404 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

409 
	$sÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

411 
	$ssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

412 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

414 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

415 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

416 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

417 #ifdeà
__REDIRECT


421 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

422 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...),

423 
__isoc99_fsÿnf
è
__wur
;

424 
	`__REDIRECT
 (
sÿnf
, (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...),

425 
__isoc99_sÿnf
è
__wur
;

426 
	`__REDIRECT
 (
ssÿnf
, (
__cÚ¡
 *
__»¡riù
 
__s
,

427 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...),

428 
__isoc99_ssÿnf
è
__THROW
;

430 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

431 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

432 
	$__isoc99_sÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

433 
	$__isoc99_ssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

434 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

435 
	#fsÿnf
 
__isoc99_fsÿnf


	)

436 
	#sÿnf
 
__isoc99_sÿnf


	)

437 
	#ssÿnf
 
__isoc99_ssÿnf


	)

441 
__END_NAMESPACE_STD


443 #ifdef 
__USE_ISOC99


444 
__BEGIN_NAMESPACE_C99


449 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fÜm©
,

450 
_G_va_li¡
 
__¬g
)

451 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

457 
	$vsÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

458 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

461 
	$vssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

462 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

463 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

465 #ià!
defšed
 
__USE_GNU
 \

466 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

467 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

468 #ifdeà
__REDIRECT


472 
	`__REDIRECT
 (
vfsÿnf
,

473 (
FILE
 *
__»¡riù
 
__s
,

474 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

475 
__isoc99_vfsÿnf
)

476 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

477 
	`__REDIRECT
 (
vsÿnf
, (
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

478 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

479 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

480 
	`__REDIRECT
 (
vssÿnf
,

481 (
__cÚ¡
 *
__»¡riù
 
__s
,

482 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

483 
__isoc99_vssÿnf
)

484 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

486 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

487 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

488 
_G_va_li¡
 
__¬g
è
__wur
;

489 
	$__isoc99_vsÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

490 
_G_va_li¡
 
__¬g
è
__wur
;

491 
	$__isoc99_vssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

492 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

493 
_G_va_li¡
 
__¬g
è
__THROW
;

494 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

495 
	#vsÿnf
 
__isoc99_vsÿnf


	)

496 
	#vssÿnf
 
__isoc99_vssÿnf


	)

500 
__END_NAMESPACE_C99


504 
__BEGIN_NAMESPACE_STD


509 
	`fg‘c
 (
FILE
 *
__¡»am
);

510 
	`g‘c
 (
FILE
 *
__¡»am
);

516 
	`g‘ch¬
 ();

517 
__END_NAMESPACE_STD


521 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

523 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


528 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

529 
	`g‘ch¬_uÆocked
 ();

532 #ifdeà
__USE_MISC


539 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

543 
__BEGIN_NAMESPACE_STD


551 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

552 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

558 
	`putch¬
 (
__c
);

559 
__END_NAMESPACE_STD


563 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

565 #ifdeà
__USE_MISC


572 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

575 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


580 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

581 
	`putch¬_uÆocked
 (
__c
);

585 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 \

586 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

588 
	`g‘w
 (
FILE
 *
__¡»am
);

591 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

595 
__BEGIN_NAMESPACE_STD


600 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

601 
__wur
;

608 *
	$g‘s
 (*
__s
è
__wur
;

609 
__END_NAMESPACE_STD


611 #ifdeà
__USE_GNU


618 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

619 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

623 #ifdef 
__USE_GNU


634 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

635 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

636 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

637 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

638 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

639 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

647 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

648 
size_t
 *
__»¡riù
 
__n
,

649 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

653 
__BEGIN_NAMESPACE_STD


658 
	`åuts
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

664 
	`puts
 (
__cÚ¡
 *
__s
);

671 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

678 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

679 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

684 
size_t
 
	`fwr™e
 (
__cÚ¡
 *
__»¡riù
 
__±r
, size_ˆ
__size
,

685 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

686 
__END_NAMESPACE_STD


688 #ifdeà
__USE_GNU


695 
	`åuts_uÆocked
 (
__cÚ¡
 *
__»¡riù
 
__s
,

696 
FILE
 *
__»¡riù
 
__¡»am
);

699 #ifdeà
__USE_MISC


706 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

707 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

708 
size_t
 
	`fwr™e_uÆocked
 (
__cÚ¡
 *
__»¡riù
 
__±r
, size_ˆ
__size
,

709 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

713 
__BEGIN_NAMESPACE_STD


718 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

723 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

728 
	`»wšd
 (
FILE
 *
__¡»am
);

729 
__END_NAMESPACE_STD


736 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


737 #iâdeà
__USE_FILE_OFFSET64


742 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

747 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

749 #ifdeà
__REDIRECT


750 
	`__REDIRECT
 (
f£eko
,

751 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

752 
f£eko64
);

753 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

755 
	#f£eko
 
f£eko64


	)

756 
	#á–lo
 
á–lo64


	)

761 
__BEGIN_NAMESPACE_STD


762 #iâdeà
__USE_FILE_OFFSET64


767 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

772 
	`f£os
 (
FILE
 *
__¡»am
, 
__cÚ¡
 
åos_t
 *
__pos
);

774 #ifdeà
__REDIRECT


775 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

776 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

777 
	`__REDIRECT
 (
f£os
,

778 (
FILE
 *
__¡»am
, 
__cÚ¡
 
åos_t
 *
__pos
), 
f£os64
);

780 
	#fg‘pos
 
fg‘pos64


	)

781 
	#f£os
 
f£os64


	)

784 
__END_NAMESPACE_STD


786 #ifdeà
__USE_LARGEFILE64


787 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

788 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

789 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

790 
	`f£os64
 (
FILE
 *
__¡»am
, 
__cÚ¡
 
åos64_t
 *
__pos
);

793 
__BEGIN_NAMESPACE_STD


795 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

797 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

799 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

800 
__END_NAMESPACE_STD


802 #ifdeà
__USE_MISC


804 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

805 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

806 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

810 
__BEGIN_NAMESPACE_STD


815 
	`³¼Ü
 (
__cÚ¡
 *
__s
);

816 
__END_NAMESPACE_STD


822 
	~<b™s/sys_”¾i¡.h
>

825 #ifdef 
__USE_POSIX


827 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

830 #ifdeà
__USE_MISC


832 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

836 #ià(
defšed
 
__USE_POSIX2
 || defšed 
__USE_SVID
 || defšed 
__USE_BSD
 || \

837 
defšed
 
__USE_MISC
)

842 
FILE
 *
	$pİ’
 (
__cÚ¡
 *
__commªd
, __cÚ¡ *
__modes
è
__wur
;

848 
	`pşo£
 (
FILE
 *
__¡»am
);

852 #ifdef 
__USE_POSIX


854 *
	$ù”mid
 (*
__s
è
__THROW
;

858 #ifdeà
__USE_XOPEN


860 *
	`cu£rid
 (*
__s
);

864 #ifdef 
__USE_GNU


865 
ob¡ack
;

868 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

869 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...)

870 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

871 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

872 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

873 
_G_va_li¡
 
__¬gs
)

874 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

878 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


882 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

886 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

889 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

892 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


896 
	#__Ãed_g‘İt


	)

897 
	~<g‘İt.h
>

902 #ifdeà
__USE_EXTERN_INLINES


903 
	~<b™s/¡dio.h
>

905 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


906 
	~<b™s/¡dio2.h
>

908 #ifdeà
__LDBL_COMPAT


909 
	~<b™s/¡dio-ldbl.h
>

912 
__END_DECLS


	@/usr/include/stdlib.h

23 #iâdef 
_STDLIB_H


25 
	~<ã©u»s.h
>

28 
	#__Ãed_size_t


	)

29 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


30 
	#__Ãed_wch¬_t


	)

31 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	g__BEGIN_DECLS


37 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


38 
	#_STDLIB_H
 1

	)

40 #ià
defšed
 
__USE_XOPEN
 && !defšed 
_SYS_WAIT_H


42 
	~<b™s/wa™æags.h
>

43 
	~<b™s/wa™¡©us.h
>

45 #ifdeà
__USE_BSD


50 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


51 
	#__WAIT_INT
(
¡©us
) \

52 (
	`__ex‹nsiÚ__
 ({ uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; } 
__u
; \

53 
__u
.
__š
 = (
¡©us
); __u.
__i
; }))

	)

55 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

63 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


64 
	#__WAIT_STATUS
 *

	)

65 
	#__WAIT_STATUS_DEFN
 *

	)

70 
wa™
 *
	m__u±r
;

71 *
	m__Œ
;

72 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

73 
	#__WAIT_STATUS_DEFN
 *

	)

78 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

79 
	#__WAIT_STATUS
 *

	)

80 
	#__WAIT_STATUS_DEFN
 *

	)

85 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
(
	`__WAIT_INT
(¡©us))

	)

86 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
(
	`__WAIT_INT
(¡©us))

	)

87 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
(
	`__WAIT_INT
(¡©us))

	)

88 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
(
	`__WAIT_INT
(¡©us))

	)

89 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
(
	`__WAIT_INT
(¡©us))

	)

90 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
(
	`__WAIT_INT
(¡©us))

	)

91 #ifdeà
__WIFCONTINUED


92 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
(
	`__WAIT_INT
(¡©us))

	)

96 
__BEGIN_NAMESPACE_STD


100 
	mquÙ
;

101 
	m»m
;

102 } 
	tdiv_t
;

105 #iâdeà
__ldiv_t_defšed


108 
	mquÙ
;

109 
	m»m
;

110 } 
	tldiv_t
;

111 
	#__ldiv_t_defšed
 1

	)

113 
	g__END_NAMESPACE_STD


115 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


116 
__BEGIN_NAMESPACE_C99


118 
__ex‹nsiÚ__
 struct

120 
	mquÙ
;

121 
	m»m
;

122 } 
	tÎdiv_t
;

123 
	#__Îdiv_t_defšed
 1

	)

124 
	g__END_NAMESPACE_C99


129 
	#RAND_MAX
 2147483647

	)

134 
	#EXIT_FAILURE
 1

	)

135 
	#EXIT_SUCCESS
 0

	)

139 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

140 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

143 
__BEGIN_NAMESPACE_STD


145 
	$©of
 (
__cÚ¡
 *
__ÅŒ
)

146 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

148 
	$©oi
 (
__cÚ¡
 *
__ÅŒ
)

149 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

151 
	$©Ş
 (
__cÚ¡
 *
__ÅŒ
)

152 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

153 
__END_NAMESPACE_STD


155 #ià
defšed
 
__USE_ISOC99
 || (defšed 
__GLIBC_HAVE_LONG_LONG
 && defšed 
__USE_MISC
)

156 
__BEGIN_NAMESPACE_C99


158 
__ex‹nsiÚ__
 
	$©Şl
 (
__cÚ¡
 *
__ÅŒ
)

159 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

160 
__END_NAMESPACE_C99


163 
__BEGIN_NAMESPACE_STD


165 
	$¡¹od
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

166 **
__»¡riù
 
__’d±r
)

167 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

168 
__END_NAMESPACE_STD


170 #ifdef 
__USE_ISOC99


171 
__BEGIN_NAMESPACE_C99


173 
	$¡¹of
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

174 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

176 
	$¡¹Şd
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

177 **
__»¡riù
 
__’d±r
)

178 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

179 
__END_NAMESPACE_C99


182 
__BEGIN_NAMESPACE_STD


184 
	$¡¹Ş
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

185 **
__»¡riù
 
__’d±r
, 
__ba£
)

186 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

188 
	$¡¹oul
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

189 **
__»¡riù
 
__’d±r
, 
__ba£
)

190 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

191 
__END_NAMESPACE_STD


193 #ià
defšed
 
__GLIBC_HAVE_LONG_LONG
 && defšed 
__USE_BSD


195 
__ex‹nsiÚ__


196 
	$¡¹oq
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

197 **
__»¡riù
 
__’d±r
, 
__ba£
)

198 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

200 
__ex‹nsiÚ__


201 
	$¡¹ouq
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

202 **
__»¡riù
 
__’d±r
, 
__ba£
)

203 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

206 #ià
defšed
 
__USE_ISOC99
 || (defšed 
__GLIBC_HAVE_LONG_LONG
 && defšed 
__USE_MISC
)

207 
__BEGIN_NAMESPACE_C99


209 
__ex‹nsiÚ__


210 
	$¡¹Şl
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

211 **
__»¡riù
 
__’d±r
, 
__ba£
)

212 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

214 
__ex‹nsiÚ__


215 
	$¡¹ouÎ
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

216 **
__»¡riù
 
__’d±r
, 
__ba£
)

217 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

218 
__END_NAMESPACE_C99


222 #ifdeà
__USE_GNU


236 
	~<xloÿË.h
>

240 
	$¡¹Ş_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

241 **
__»¡riù
 
__’d±r
, 
__ba£
,

242 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

244 
	$¡¹oul_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

245 **
__»¡riù
 
__’d±r
,

246 
__ba£
, 
__loÿË_t
 
__loc
)

247 
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

249 
__ex‹nsiÚ__


250 
	$¡¹Şl_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

251 **
__»¡riù
 
__’d±r
, 
__ba£
,

252 
__loÿË_t
 
__loc
)

253 
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

255 
__ex‹nsiÚ__


256 
	$¡¹ouÎ_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

257 **
__»¡riù
 
__’d±r
,

258 
__ba£
, 
__loÿË_t
 
__loc
)

259 
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

261 
	$¡¹od_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

262 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

263 
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

265 
	$¡¹of_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

266 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

267 
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

269 
	$¡¹Şd_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

270 **
__»¡riù
 
__’d±r
,

271 
__loÿË_t
 
__loc
)

272 
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

276 #ifdeà
__USE_EXTERN_INLINES


277 
__BEGIN_NAMESPACE_STD


278 
__ex‹º_šlše
 

279 
	`__NTH
 (
	$©of
 (
__cÚ¡
 *
__ÅŒ
))

281  
	`¡¹od
 (
__ÅŒ
, (**è
NULL
);

282 
	}
}

283 
__ex‹º_šlše
 

284 
__NTH
 (
	$©oi
 (
__cÚ¡
 *
__ÅŒ
))

286  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

287 
	}
}

288 
__ex‹º_šlše
 

289 
__NTH
 (
	$©Ş
 (
__cÚ¡
 *
__ÅŒ
))

291  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

292 
	}
}

293 
	g__END_NAMESPACE_STD


295 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


296 
__BEGIN_NAMESPACE_C99


297 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

298 
__NTH
 (
	$©Şl
 (
__cÚ¡
 *
__ÅŒ
))

300  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

301 
	}
}

302 
	g__END_NAMESPACE_C99


307 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


311 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

314 
	$a64l
 (
__cÚ¡
 *
__s
)

315 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

319 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_BSD


320 
	~<sys/ty³s.h
>

327 
	$¿ndom
 (è
__THROW
;

330 
	$¤ªdom
 (
__£ed
è
__THROW
;

336 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

337 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

341 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

344 #ifdeà
__USE_MISC


349 
	s¿ndom_d©a


351 
št32_t
 *
åŒ
;

352 
št32_t
 *
½Œ
;

353 
št32_t
 *
¡©e
;

354 
¿nd_ty³
;

355 
¿nd_deg
;

356 
¿nd_£p
;

357 
št32_t
 *
’d_±r
;

360 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

361 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

363 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

364 
__THROW
 
	`__nÚnuÎ
 ((2));

366 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

367 
size_t
 
__¡©–’
,

368 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

369 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

371 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

372 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

373 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

378 
__BEGIN_NAMESPACE_STD


380 
	$¿nd
 (è
__THROW
;

382 
	$¤ªd
 (
__£ed
è
__THROW
;

383 
__END_NAMESPACE_STD


385 #ifdeà
__USE_POSIX


387 
	$¿nd_r
 (*
__£ed
è
__THROW
;

391 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


395 
	$d¿nd48
 (è
__THROW
;

396 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

399 
	$Ìªd48
 (è
__THROW
;

400 
	$Äªd48
 (
__xsubi
[3])

401 
__THROW
 
	`__nÚnuÎ
 ((1));

404 
	$m¿nd48
 (è
__THROW
;

405 
	$j¿nd48
 (
__xsubi
[3])

406 
__THROW
 
	`__nÚnuÎ
 ((1));

409 
	$¤ªd48
 (
__£edv®
è
__THROW
;

410 *
	$£ed48
 (
__£ed16v
[3])

411 
__THROW
 
	`__nÚnuÎ
 ((1));

412 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

414 #ifdeà
__USE_MISC


418 
	sd¿nd48_d©a


420 
__x
[3];

421 
__Şd_x
[3];

422 
__c
;

423 
__š™
;

424 
__a
;

428 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

429 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$”ªd48_r
 (
__xsubi
[3],

431 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

432 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

435 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

436 *
__»¡riù
 
__»suÉ
)

437 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

438 
	$Äªd48_r
 (
__xsubi
[3],

439 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

444 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

445 *
__»¡riù
 
__»suÉ
)

446 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

447 
	$j¿nd48_r
 (
__xsubi
[3],

448 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

449 *
__»¡riù
 
__»suÉ
)

450 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

453 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

454 
__THROW
 
	`__nÚnuÎ
 ((2));

456 
	$£ed48_r
 (
__£ed16v
[3],

457 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 
	$lcÚg48_r
 (
__·¿m
[7],

460 
d¿nd48_d©a
 *
__bufãr
)

461 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

467 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


468 
	#__m®loc_ªd_ÿÎoc_defšed


	)

469 
__BEGIN_NAMESPACE_STD


471 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

473 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

474 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

475 
__END_NAMESPACE_STD


478 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


479 
__BEGIN_NAMESPACE_STD


485 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

486 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

488 
	$ä“
 (*
__±r
è
__THROW
;

489 
__END_NAMESPACE_STD


491 #ifdef 
__USE_MISC


493 
	$cä“
 (*
__±r
è
__THROW
;

496 #ià
defšed
 
__USE_GNU
 || defšed 
__USE_BSD
 || defšed 
__USE_MISC


497 
	~<®loÿ.h
>

500 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


502 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

505 #ifdeà
__USE_XOPEN2K


507 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

508 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

511 
__BEGIN_NAMESPACE_STD


513 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

517 
	`©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

518 
__END_NAMESPACE_STD


520 #ifdef 
__USE_MISC


523 
	`Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

524 
__THROW
 
	`__nÚnuÎ
 ((1));

527 
__BEGIN_NAMESPACE_STD


531 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

532 
__END_NAMESPACE_STD


534 #ifdeà
__USE_ISOC99


535 
__BEGIN_NAMESPACE_C99


538 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

539 
__END_NAMESPACE_C99


543 
__BEGIN_NAMESPACE_STD


545 *
	$g‘’v
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

546 
__END_NAMESPACE_STD


550 *
	$__£cu»_g‘’v
 (
__cÚ¡
 *
__Çme
)

551 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

553 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


557 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

560 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


563 
	$£‹nv
 (
__cÚ¡
 *
__Çme
, __cÚ¡ *
__v®ue
, 
__»¶aû
)

564 
__THROW
 
	`__nÚnuÎ
 ((2));

567 
	$un£‹nv
 (
__cÚ¡
 *
__Çme
è
__THROW
;

570 #ifdef 
__USE_MISC


574 
	$ş—»nv
 (è
__THROW
;

578 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


583 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

593 #iâdeà
__USE_FILE_OFFSET64


594 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

596 #ifdeà
__REDIRECT


597 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

598 
	`__nÚnuÎ
 ((1)è
__wur
;

600 
	#mk¡emp
 
mk¡emp64


	)

603 #ifdeà
__USE_LARGEFILE64


604 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

608 #ifdeà
__USE_BSD


614 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

617 #ifdeà
__USE_GNU


624 #iâdeà
__USE_FILE_OFFSET64


625 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

627 #ifdeà
__REDIRECT


628 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

629 
	`__nÚnuÎ
 ((1)è
__wur
;

631 
	#mko¡emp
 
mko¡emp64


	)

634 #ifdeà
__USE_LARGEFILE64


635 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

640 
__BEGIN_NAMESPACE_STD


645 
	$sy¡em
 (
__cÚ¡
 *
__commªd
è
__wur
;

646 
__END_NAMESPACE_STD


649 #ifdef 
__USE_GNU


652 *
	$ÿnÚiÿlize_fe_Çme
 (
__cÚ¡
 *
__Çme
)

653 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

656 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


662 *
	$»®·th
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

663 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

668 #iâdeà
__COMPAR_FN_T


669 
	#__COMPAR_FN_T


	)

670 (*
	t__com·r_â_t
è(
	t__cÚ¡
 *, __const *);

672 #ifdef 
__USE_GNU


673 
__com·r_â_t
 
	tcom·risÚ_â_t
;

676 #ifdeà
__USE_GNU


677 (*
	t__com·r_d_â_t
è(
	t__cÚ¡
 *, __const *, *);

680 
__BEGIN_NAMESPACE_STD


683 *
	$b£¬ch
 (
__cÚ¡
 *
__key
, __cÚ¡ *
__ba£
,

684 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

685 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

689 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

690 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

691 #ifdeà
__USE_GNU


692 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

693 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

694 
	`__nÚnuÎ
 ((1, 4));

699 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

700 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

701 
__END_NAMESPACE_STD


703 #ifdeà
__USE_ISOC99


704 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

705 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

709 
__BEGIN_NAMESPACE_STD


713 
div_t
 
	$div
 (
__num”
, 
__d’om
)

714 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

715 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

716 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

717 
__END_NAMESPACE_STD


719 #ifdeà
__USE_ISOC99


720 
__BEGIN_NAMESPACE_C99


721 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

722 
__d’om
)

723 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

724 
__END_NAMESPACE_C99


728 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


735 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

736 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

741 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

742 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

747 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

748 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

751 #ifdeà
__USE_MISC


753 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

754 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

755 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

756 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

757 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

758 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

759 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

760 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

765 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

766 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

767 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

768 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

769 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

770 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

772 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

773 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

774 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

775 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

776 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

777 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

778 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

779 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

784 
__BEGIN_NAMESPACE_STD


787 
	$mbËn
 (
__cÚ¡
 *
__s
, 
size_t
 
__n
è
__THROW
 
__wur
;

790 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

791 
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
 
__wur
;

794 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
 
__wur
;

798 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

799 
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

801 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

802 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

803 
__THROW
;

804 
__END_NAMESPACE_STD


807 #ifdeà
__USE_SVID


812 
	$½m©ch
 (
__cÚ¡
 *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

816 #ifdeà
__USE_XOPEN_EXTENDED


823 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

824 *
__cÚ¡
 *
__»¡riù
 
__tok’s
,

825 **
__»¡riù
 
__v®u•
)

826 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

830 #ifdeà
__USE_XOPEN


832 
	$£tkey
 (
__cÚ¡
 *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

838 #ifdeà
__USE_XOPEN2K


840 
	$posix_İ’±
 (
__oæag
è
__wur
;

843 #ifdeà
__USE_XOPEN


848 
	$g¿Á±
 (
__fd
è
__THROW
;

852 
	$uÆock±
 (
__fd
è
__THROW
;

857 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

860 #ifdeà
__USE_GNU


864 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

865 
__THROW
 
	`__nÚnuÎ
 ((2));

868 
	`g‘±
 ();

871 #ifdeà
__USE_BSD


875 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

876 
__THROW
 
	`__nÚnuÎ
 ((1));

881 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


882 
	~<b™s/¡dlib.h
>

884 #ifdeà
__LDBL_COMPAT


885 
	~<b™s/¡dlib-ldbl.h
>

889 #undeà
__Ãed_m®loc_ªd_ÿÎoc


891 
__END_DECLS


	@/usr/include/string.h

23 #iâdef 
_STRING_H


24 
	#_STRING_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

36 
__BEGIN_NAMESPACE_STD


38 *
	$memıy
 (*
__»¡riù
 
__de¡
,

39 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

40 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

43 *
	$memmove
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
)

44 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

45 
__END_NAMESPACE_STD


50 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN


51 *
	$memcıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

52 
__c
, 
size_t
 
__n
)

53 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

57 
__BEGIN_NAMESPACE_STD


59 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

62 
	$memcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

63 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

66 *
	$memchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

67 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

68 
__END_NAMESPACE_STD


70 #ifdeà
__USE_GNU


73 *
	$¿wmemchr
 (
__cÚ¡
 *
__s
, 
__c
)

74 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

77 *
	$memrchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

78 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

82 
__BEGIN_NAMESPACE_STD


84 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

85 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

87 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

88 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

89 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

92 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

93 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

95 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

96 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

99 
	$¡rcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

100 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

102 
	$¡ºcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

103 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

106 
	$¡rcŞl
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

107 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

109 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

110 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

111 
__THROW
 
	`__nÚnuÎ
 ((2));

112 
__END_NAMESPACE_STD


114 #ifdeà
__USE_GNU


118 
	~<xloÿË.h
>

121 
	$¡rcŞl_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

122 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

124 
size_t
 
	$¡rxäm_l
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
,

125 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

128 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


130 *
	$¡rdup
 (
__cÚ¡
 *
__s
)

131 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

137 #ià
defšed
 
__USE_GNU


138 *
	$¡ºdup
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__n
)

139 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

142 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


144 
	#¡rdu·
(
s
) \

145 (
__ex‹nsiÚ__
 \

147 
__cÚ¡
 *
__Şd
 = (
s
); \

148 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

149 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

150 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

151 
	}
}))

	)

154 
	#¡ºdu·
(
s
, 
n
) \

155 (
__ex‹nsiÚ__
 \

157 
__cÚ¡
 *
__Şd
 = (
s
); \

158 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

159 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

160 
__Ãw
[
__Ën
] = '\0'; \

161 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

162 }))

	)

165 
__BEGIN_NAMESPACE_STD


167 *
	$¡rchr
 (
__cÚ¡
 *
__s
, 
__c
)

168 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

170 *
	$¡¼chr
 (
__cÚ¡
 *
__s
, 
__c
)

171 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

172 
__END_NAMESPACE_STD


174 #ifdeà
__USE_GNU


177 *
	$¡rchºul
 (
__cÚ¡
 *
__s
, 
__c
)

178 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

181 
__BEGIN_NAMESPACE_STD


184 
size_t
 
	$¡rc¥n
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__»jeù
)

185 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

188 
size_t
 
	$¡r¥n
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
)

189 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

191 *
	$¡½brk
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
)

192 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

194 *
	$¡r¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
)

195 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

199 *
	$¡¹ok
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__d–im
)

200 
__THROW
 
	`__nÚnuÎ
 ((2));

201 
__END_NAMESPACE_STD


205 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

206 
__cÚ¡
 *
__»¡riù
 
__d–im
,

207 **
__»¡riù
 
__§ve_±r
)

208 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

209 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


210 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__d–im
,

211 **
__»¡riù
 
__§ve_±r
)

212 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

215 #ifdeà
__USE_GNU


217 *
	$¡rÿ£¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
)

218 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

221 #ifdeà
__USE_GNU


225 *
	$memmem
 (
__cÚ¡
 *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

226 
__cÚ¡
 *
__ÃedË
, 
size_t
 
__ÃedËËn
)

227 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

231 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

232 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

233 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

234 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

235 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

236 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

240 
__BEGIN_NAMESPACE_STD


242 
size_t
 
	$¡¾’
 (
__cÚ¡
 *
__s
)

243 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

244 
__END_NAMESPACE_STD


246 #ifdef 
__USE_GNU


249 
size_t
 
	$¡ºËn
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__maxËn
)

250 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

254 
__BEGIN_NAMESPACE_STD


256 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

257 
__END_NAMESPACE_STD


258 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_MISC


266 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


269 #ifdeà
__REDIRECT_NTH


270 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

271 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

272 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

274 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

275 
__THROW
 
	`__nÚnuÎ
 ((2));

276 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

281 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

282 
__THROW
 
	`__nÚnuÎ
 ((2));

286 #ifdeà
__USE_GNU


288 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

294 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

296 #ifdeà
__USE_BSD


298 
	$bcİy
 (
__cÚ¡
 *
__¤c
, *
__de¡
, 
size_t
 
__n
)

299 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

302 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

305 
	$bcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

306 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

309 *
	$šdex
 (
__cÚ¡
 *
__s
, 
__c
)

310 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

313 *
	$ršdex
 (
__cÚ¡
 *
__s
, 
__c
)

314 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

318 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

322 #ifdef 
__USE_GNU


323 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

324 #ifdeà
__GNUC__


325 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

326 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

331 
	$¡rÿ£cmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

332 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

335 
	$¡ºÿ£cmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

336 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

339 #ifdef 
__USE_GNU


342 
	$¡rÿ£cmp_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
,

343 
__loÿË_t
 
__loc
)

344 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

346 
	$¡ºÿ£cmp_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
,

347 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

348 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

351 #ifdef 
__USE_BSD


354 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

355 
__cÚ¡
 *
__»¡riù
 
__d–im
)

356 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

359 #ifdef 
__USE_GNU


361 
	$¡rv”scmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

362 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

365 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

368 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

369 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

370 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

371 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

375 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

376 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

377 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

378 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

379 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

380 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

383 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

386 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

388 #iâdeà
ba£Çme


393 *
	$ba£Çme
 (
__cÚ¡
 *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

398 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

399 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

400 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


420 
	~<b™s/¡ršg.h
>

423 
	~<b™s/¡ršg2.h
>

426 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


428 
	~<b™s/¡ršg3.h
>

432 
__END_DECLS


	@/usr/include/strings.h

19 #iâdef 
_STRINGS_H


20 
	#_STRINGS_H
 1

	)

25 #ià!
defšed
 
_STRING_H
 || !defšed 
__USE_BSD


27 
	~<ã©u»s.h
>

28 
	#__Ãed_size_t


	)

29 
	~<¡ddef.h
>

31 
__BEGIN_DECLS


34 
	$bcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

35 
__THROW
 
__©Œibu‹_pu»__
;

38 
	$bcİy
 (
__cÚ¡
 *
__¤c
, *
__de¡
, 
size_t
 
__n
è
__THROW
;

41 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
;

45 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((const));

48 *
	$šdex
 (
__cÚ¡
 *
__s
, 
__c
è
__THROW
 
__©Œibu‹_pu»__
;

51 *
	$ršdex
 (
__cÚ¡
 *
__s
, 
__c
è
__THROW
 
__©Œibu‹_pu»__
;

54 
	$¡rÿ£cmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

55 
__THROW
 
__©Œibu‹_pu»__
;

58 
	$¡ºÿ£cmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

59 
__THROW
 
__©Œibu‹_pu»__
;

61 
__END_DECLS


	@/usr/include/sys/file.h

19 #iâdef 
_SYS_FILE_H


20 
	#_SYS_FILE_H
 1

	)

22 
	~<ã©u»s.h
>

24 #iâdef 
_FCNTL_H


25 
	~<fú.h
>

28 
	g__BEGIN_DECLS


33 #iâdeà
L_SET


34 
	#L_SET
 0

	)

35 
	#L_INCR
 1

	)

36 
	#L_XTND
 2

	)

41 
	#LOCK_SH
 1

	)

42 
	#LOCK_EX
 2

	)

43 
	#LOCK_UN
 8

	)

46 
	#LOCK_NB
 4

	)

51 
	$æock
 (
__fd
, 
__İ”©iÚ
è
__THROW
;

54 
__END_DECLS


	@/usr/include/sys/inotify.h

19 #iâdef 
_SYS_INOTIFY_H


20 
	#_SYS_INOTIFY_H
 1

	)

22 
	~<¡dšt.h
>

28 
	mIN_CLOEXEC
 = 02000000,

29 
	#IN_CLOEXEC
 
IN_CLOEXEC


	)

30 
	mIN_NONBLOCK
 = 04000

31 
	#IN_NONBLOCK
 
IN_NONBLOCK


	)

36 
	sšÙify_ev’t


38 
	mwd
;

39 
ušt32_t
 
	mmask
;

40 
ušt32_t
 
	mcook›
;

41 
ušt32_t
 
	mËn
;

42 
Çme
 
	m__æex¬r
;

47 
	#IN_ACCESS
 0x00000001

	)

48 
	#IN_MODIFY
 0x00000002

	)

49 
	#IN_ATTRIB
 0x00000004

	)

50 
	#IN_CLOSE_WRITE
 0x00000008

	)

51 
	#IN_CLOSE_NOWRITE
 0x00000010

	)

52 
	#IN_CLOSE
 (
IN_CLOSE_WRITE
 | 
IN_CLOSE_NOWRITE
è

	)

53 
	#IN_OPEN
 0x00000020

	)

54 
	#IN_MOVED_FROM
 0x00000040

	)

55 
	#IN_MOVED_TO
 0x00000080

	)

56 
	#IN_MOVE
 (
IN_MOVED_FROM
 | 
IN_MOVED_TO
è

	)

57 
	#IN_CREATE
 0x00000100

	)

58 
	#IN_DELETE
 0x00000200

	)

59 
	#IN_DELETE_SELF
 0x00000400

	)

60 
	#IN_MOVE_SELF
 0x00000800

	)

63 
	#IN_UNMOUNT
 0x00002000

	)

64 
	#IN_Q_OVERFLOW
 0x00004000

	)

65 
	#IN_IGNORED
 0x00008000

	)

68 
	#IN_CLOSE
 (
IN_CLOSE_WRITE
 | 
IN_CLOSE_NOWRITE
è

	)

69 
	#IN_MOVE
 (
IN_MOVED_FROM
 | 
IN_MOVED_TO
è

	)

72 
	#IN_ONLYDIR
 0x01000000

	)

74 
	#IN_DONT_FOLLOW
 0x02000000

	)

75 
	#IN_MASK_ADD
 0x20000000

	)

77 
	#IN_ISDIR
 0x40000000

	)

78 
	#IN_ONESHOT
 0x80000000

	)

81 
	#IN_ALL_EVENTS
 (
IN_ACCESS
 | 
IN_MODIFY
 | 
IN_ATTRIB
 | 
IN_CLOSE_WRITE
 \

82 | 
IN_CLOSE_NOWRITE
 | 
IN_OPEN
 | 
IN_MOVED_FROM
 \

83 | 
IN_MOVED_TO
 | 
IN_CREATE
 | 
IN_DELETE
 \

84 | 
IN_DELETE_SELF
 | 
IN_MOVE_SELF
)

	)

87 
__BEGIN_DECLS


90 
	$šÙify_š™
 (è
__THROW
;

93 
	$šÙify_š™1
 (
__æags
è
__THROW
;

97 
	$šÙify_add_w©ch
 (
__fd
, cÚ¡ *
__Çme
, 
ušt32_t
 
__mask
)

98 
__THROW
;

101 
	$šÙify_rm_w©ch
 (
__fd
, 
ušt32_t
 
__wd
è
__THROW
;

103 
__END_DECLS


	@/usr/include/sys/io.h

19 #iâdef 
_SYS_IO_H


20 
	#_SYS_IO_H
 1

	)

22 
	~<ã©u»s.h
>

24 
__BEGIN_DECLS


33 
	$iİ”m
 (
__äom
, 
__num
,

34 
__tuº_Ú
è
__THROW
;

39 
	$iİl
 (
__Ëv–
è
__THROW
;

41 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

43 
__šlše
 

44 
	$šb
 (
pÜt
)

46 
_v
;

48 
__asm__
 
	`__vŞ©e__
 ("šb %w1,%0":"÷" (
_v
):"Nd" (
pÜt
));

49  
_v
;

50 
	}
}

52 
__šlše
 

53 
	$šb_p
 (
pÜt
)

55 
_v
;

57 
__asm__
 
	`__vŞ©e__
 ("šb %w1,%0\noutb %%®,$0x80":"÷" (
_v
):"Nd" (
pÜt
));

58  
_v
;

59 
	}
}

61 
__šlše
 

62 
	$šw
 (
pÜt
)

64 
_v
;

66 
__asm__
 
	`__vŞ©e__
 ("šw %w1,%0":"÷" (
_v
):"Nd" (
pÜt
));

67  
_v
;

68 
	}
}

70 
__šlše
 

71 
	$šw_p
 (
pÜt
)

73 
_v
;

75 
__asm__
 
	`__vŞ©e__
 ("šw %w1,%0\noutb %%®,$0x80":"÷" (
_v
):"Nd" (
pÜt
));

76  
_v
;

77 
	}
}

79 
__šlše
 

80 
	$šl
 (
pÜt
)

82 
_v
;

84 
__asm__
 
	`__vŞ©e__
 ("šÈ%w1,%0":"÷" (
_v
):"Nd" (
pÜt
));

85  
_v
;

86 
	}
}

88 
__šlše
 

89 
	$šl_p
 (
pÜt
)

91 
_v
;

92 
__asm__
 
	`__vŞ©e__
 ("šÈ%w1,%0\noutb %%®,$0x80":"÷" (
_v
):"Nd" (
pÜt
));

93  
_v
;

94 
	}
}

96 
__šlše
 

97 
	$outb
 (
v®ue
, 
pÜt
)

99 
__asm__
 
	`__vŞ©e__
 ("outb %b0,%w1": :"a" (
v®ue
), "Nd" (
pÜt
));

100 
	}
}

102 
__šlše
 

103 
	$outb_p
 (
v®ue
, 
pÜt
)

105 
__asm__
 
	`__vŞ©e__
 ("outb %b0,%w1\noutb %%®,$0x80": :"a" (
v®ue
),

106 "Nd" (
pÜt
));

107 
	}
}

109 
__šlše
 

110 
	$outw
 (
v®ue
, 
pÜt
)

112 
__asm__
 
	`__vŞ©e__
 ("outw %w0,%w1": :"a" (
v®ue
), "Nd" (
pÜt
));

114 
	}
}

116 
__šlše
 

117 
	$outw_p
 (
v®ue
, 
pÜt
)

119 
__asm__
 
	`__vŞ©e__
 ("outw %w0,%w1\noutb %%®,$0x80": :"a" (
v®ue
),

120 "Nd" (
pÜt
));

121 
	}
}

123 
__šlše
 

124 
	$ou
 (
v®ue
, 
pÜt
)

126 
__asm__
 
	`__vŞ©e__
 ("ou %0,%w1": :"a" (
v®ue
), "Nd" (
pÜt
));

127 
	}
}

129 
__šlše
 

130 
	$ou_p
 (
v®ue
, 
pÜt
)

132 
__asm__
 
	`__vŞ©e__
 ("ou %0,%w1\noutb %%®,$0x80": :"a" (
v®ue
),

133 "Nd" (
pÜt
));

134 
	}
}

136 
__šlše
 

137 
	$šsb
 (
pÜt
, *
addr
, 
couÁ
)

139 
__asm__
 
	`__vŞ©e__
 ("şd ;„• ; insb":"=D" (
addr
),

140 "=c" (
couÁ
):"d" (
pÜt
), "0" (
addr
), "1" (count));

141 
	}
}

143 
__šlše
 

144 
	$šsw
 (
pÜt
, *
addr
, 
couÁ
)

146 
__asm__
 
	`__vŞ©e__
 ("şd ;„• ; insw":"=D" (
addr
),

147 "=c" (
couÁ
):"d" (
pÜt
), "0" (
addr
), "1" (count));

148 
	}
}

150 
__šlše
 

151 
	$š¦
 (
pÜt
, *
addr
, 
couÁ
)

153 
__asm__
 
	`__vŞ©e__
 ("şd ;„• ; in¦":"=D" (
addr
),

154 "=c" (
couÁ
):"d" (
pÜt
), "0" (
addr
), "1" (count));

155 
	}
}

157 
__šlše
 

158 
	$outsb
 (
pÜt
, cÚ¡ *
addr
, 
couÁ
)

160 
__asm__
 
	`__vŞ©e__
 ("şd ;„• ; outsb":"=S" (
addr
),

161 "=c" (
couÁ
):"d" (
pÜt
), "0" (
addr
), "1" (count));

162 
	}
}

164 
__šlše
 

165 
	$outsw
 (
pÜt
, cÚ¡ *
addr
, 
couÁ
)

167 
__asm__
 
	`__vŞ©e__
 ("şd ;„• ; outsw":"=S" (
addr
),

168 "=c" (
couÁ
):"d" (
pÜt
), "0" (
addr
), "1" (count));

169 
	}
}

171 
__šlše
 

172 
	$out¦
 (
pÜt
, cÚ¡ *
addr
, 
couÁ
)

174 
__asm__
 
	`__vŞ©e__
 ("şd ;„• ; out¦":"=S" (
addr
),

175 "=c" (
couÁ
):"d" (
pÜt
), "0" (
addr
), "1" (count));

176 
	}
}

180 
	g__END_DECLS


	@/usr/include/sys/ioctl.h

19 #iâdef 
_SYS_IOCTL_H


20 
	#_SYS_IOCTL_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	g__BEGIN_DECLS


27 
	~<b™s/ioùls.h
>

30 
	~<b™s/ioùl-ty³s.h
>

37 
	~<sys/‰ydeçuÉs.h
>

42 
	$ioùl
 (
__fd
, 
__»que¡
, ...è
__THROW
;

44 
__END_DECLS


	@/usr/include/sys/mman.h

20 #iâdef 
_SYS_MMAN_H


21 
	#_SYS_MMAN_H
 1

	)

23 
	~<ã©u»s.h
>

24 
	~<b™s/ty³s.h
>

25 
	#__Ãed_size_t


	)

26 
	~<¡ddef.h
>

28 #iâdeà
__off_t_defšed


29 #iâdeà
__USE_FILE_OFFSET64


30 
__off_t
 
	toff_t
;

32 
__off64_t
 
	toff_t
;

34 
	#__off_t_defšed


	)

37 #iâdeà
__mode_t_defšed


38 
__mode_t
 
	tmode_t
;

39 
	#__mode_t_defšed


	)

42 
	~<b™s/mmª.h
>

45 
	#MAP_FAILED
 ((*è-1)

	)

47 
	g__BEGIN_DECLS


57 #iâdeà
__USE_FILE_OFFSET64


58 *
	$mm­
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

59 
__æags
, 
__fd
, 
__off_t
 
__off£t
è
__THROW
;

61 #ifdeà
__REDIRECT_NTH


62 * 
	`__REDIRECT_NTH
 (
mm­
,

63 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

64 
__æags
, 
__fd
, 
__off64_t
 
__off£t
),

65 
mm­64
);

67 
	#mm­
 
mm­64


	)

70 #ifdeà
__USE_LARGEFILE64


71 *
	$mm­64
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

72 
__æags
, 
__fd
, 
__off64_t
 
__off£t
è
__THROW
;

77 
	$munm­
 (*
__addr
, 
size_t
 
__Ën
è
__THROW
;

82 
	$m´Ùeù
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
è
__THROW
;

90 
	`msync
 (*
__addr
, 
size_t
 
__Ën
, 
__æags
);

92 #ifdeà
__USE_BSD


95 
	$madvi£
 (*
__addr
, 
size_t
 
__Ën
, 
__adviû
è
__THROW
;

97 #ifdeà
__USE_XOPEN2K


99 
	$posix_madvi£
 (*
__addr
, 
size_t
 
__Ën
, 
__adviû
è
__THROW
;

104 
	$mlock
 (
__cÚ¡
 *
__addr
, 
size_t
 
__Ën
è
__THROW
;

107 
	$muÆock
 (
__cÚ¡
 *
__addr
, 
size_t
 
__Ën
è
__THROW
;

112 
	$mlock®l
 (
__æags
è
__THROW
;

116 
	$muÆock®l
 (è
__THROW
;

118 #ifdeà
__USE_MISC


124 
	$mšcÜe
 (*
__¡¬t
, 
size_t
 
__Ën
, *
__vec
)

125 
__THROW
;

128 #ifdeà
__USE_GNU


134 *
	$m»m­
 (*
__addr
, 
size_t
 
__Şd_Ën
, size_ˆ
__Ãw_Ën
,

135 
__æags
, ...è
__THROW
;

139 
	$»m­_fe_·ges
 (*
__¡¬t
, 
size_t
 
__size
, 
__´Ù
,

140 
size_t
 
__pgoff
, 
__æags
è
__THROW
;

145 
	`shm_İ’
 (
__cÚ¡
 *
__Çme
, 
__oæag
, 
mode_t
 
__mode
);

148 
	`shm_uÆšk
 (
__cÚ¡
 *
__Çme
);

150 
__END_DECLS


	@/usr/include/sys/mount.h

22 #iâdeà
_SYS_MOUNT_H


23 
	#_SYS_MOUNT_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<sys/ioùl.h
>

28 
	#BLOCK_SIZE
 1024

	)

29 
	#BLOCK_SIZE_BITS
 10

	)

36 
	mMS_RDONLY
 = 1,

37 
	#MS_RDONLY
 
MS_RDONLY


	)

38 
	mMS_NOSUID
 = 2,

39 
	#MS_NOSUID
 
MS_NOSUID


	)

40 
	mMS_NODEV
 = 4,

41 
	#MS_NODEV
 
MS_NODEV


	)

42 
	mMS_NOEXEC
 = 8,

43 
	#MS_NOEXEC
 
MS_NOEXEC


	)

44 
	mMS_SYNCHRONOUS
 = 16,

45 
	#MS_SYNCHRONOUS
 
MS_SYNCHRONOUS


	)

46 
	mMS_REMOUNT
 = 32,

47 
	#MS_REMOUNT
 
MS_REMOUNT


	)

48 
	mMS_MANDLOCK
 = 64,

49 
	#MS_MANDLOCK
 
MS_MANDLOCK


	)

50 
	mS_WRITE
 = 128,

51 
	#S_WRITE
 
S_WRITE


	)

52 
	mS_APPEND
 = 256,

53 
	#S_APPEND
 
S_APPEND


	)

54 
	mS_IMMUTABLE
 = 512,

55 
	#S_IMMUTABLE
 
S_IMMUTABLE


	)

56 
	mMS_NOATIME
 = 1024,

57 
	#MS_NOATIME
 
MS_NOATIME


	)

58 
	mMS_NODIRATIME
 = 2048,

59 
	#MS_NODIRATIME
 
MS_NODIRATIME


	)

60 
	mMS_BIND
 = 4096,

61 
	#MS_BIND
 
MS_BIND


	)

65 
	#MS_RMT_MASK
 (
MS_RDONLY
|
MS_SYNCHRONOUS
|
MS_MANDLOCK
|
MS_NOATIME
 \

66 |
MS_NODIRATIME
)

	)

71 
	#MS_MGC_VAL
 0xc0ed0000

	)

72 
	#MS_MGC_MSK
 0xffff0000

	)

79 
	#BLKROSET
 
	`_IO
(0x12, 93è

	)

80 
	#BLKROGET
 
	`_IO
(0x12, 94è

	)

81 
	#BLKRRPART
 
	`_IO
(0x12, 95è

	)

82 
	#BLKGETSIZE
 
	`_IO
(0x12, 96è

	)

83 
	#BLKFLSBUF
 
	`_IO
(0x12, 97è

	)

84 
	#BLKRASET
 
	`_IO
(0x12, 98è

	)

85 
	#BLKRAGET
 
	`_IO
(0x12, 99è

	)

86 
	#BLKFRASET
 
	`_IO
(0x12,100è

	)

87 
	#BLKFRAGET
 
	`_IO
(0x12,101è

	)

88 
	#BLKSECTSET
 
	`_IO
(0x12,102è

	)

89 
	#BLKSECTGET
 
	`_IO
(0x12,103è

	)

90 
	#BLKSSZGET
 
	`_IO
(0x12,104è

	)

91 
	#BLKBSZGET
 
	`_IOR
(0x12,112,
size_t
)

	)

92 
	#BLKBSZSET
 
	`_IOW
(0x12,113,
size_t
)

	)

93 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
è

	)

99 
	mMNT_FORCE
 = 1

100 
	#MNT_FORCE
 
MNT_FORCE


	)

104 
__BEGIN_DECLS


107 
	$mouÁ
 (
__cÚ¡
 *
__¥ecŸl_fe
, __cÚ¡ *
__dœ
,

108 
__cÚ¡
 *
__f¡y³
, 
__rwæag
,

109 
__cÚ¡
 *
__d©a
è
__THROW
;

112 
	$umouÁ
 (
__cÚ¡
 *
__¥ecŸl_fe
è
__THROW
;

115 
	$umouÁ2
 (
__cÚ¡
 *
__¥ecŸl_fe
, 
__æags
è
__THROW
;

117 
__END_DECLS


	@/usr/include/sys/param.h

19 #iâdeà
_SYS_PARAM_H


20 
	#_SYS_PARAM_H
 1

	)

22 #iâdeà
ARG_MAX


23 
	#__undef_ARG_MAX


	)

26 
	~<lim™s.h
>

27 
	~<lšux/lim™s.h
>

28 
	~<lšux/·¿m.h
>

31 #iâdeà
__undef_ARG_MAX


32 #undeà
ARG_MAX


33 #undeà
__undef_ARG_MAX


38 
	#NBBY
 
CHAR_BIT


	)

39 #iâdef 
NGROUPS


40 
	#NGROUPS
 
NGROUPS_MAX


	)

42 
	#MAXSYMLINKS
 20

	)

43 
	#CANBSIZ
 
MAX_CANON


	)

44 
	#MAXPATHLEN
 
PATH_MAX


	)

48 
	#NOFILE
 256

	)

49 
	#NCARGS
 131072

	)

52 
	~<sys/ty³s.h
>

55 
	#£tb™
(
a
,
i
è(×)[(i)/
NBBY
] |ğ1<<((i)%NBBY))

	)

56 
	#şrb™
(
a
,
i
è(×)[(i)/
NBBY
] &ğ~(1<<((i)%NBBY)))

	)

57 
	#is£t
(
a
,
i
è(×)[(i)/
NBBY
] & (1<<((i)%NBBY)))

	)

58 
	#isşr
(
a
,
i
è((×)[(i)/
NBBY
] & (1<<((i)%NBBY))è=ğ0)

	)

61 #iâdeà
howmªy


62 
	#howmªy
(
x
, 
y
è(((xè+ ((yè- 1)è/ (y))

	)

64 #ifdeà
__GNUC__


65 
	#roundup
(
x
, 
y
è(
	`__butš_cÚ¡ªt_p
 (yè&& 
	`pow”of2
 (y) \

66 ? (((
x
è+ (
y
) - 1) & ~((y) - 1)) \

67 : ((((
x
è+ ((
y
è- 1)è/ (y)è* (y)))

	)

69 
	#roundup
(
x
, 
y
è((((xè+ ((yè- 1)è/ (y)è* (y))

	)

71 
	#pow”of2
(
x
è((((xè- 1è& (x)è=ğ0)

	)

74 
	#MIN
(
a
,
b
è((×)<(b))?×):(b))

	)

75 
	#MAX
(
a
,
b
è((×)>(b))?×):(b))

	)

79 
	#DEV_BSIZE
 512

	)

	@/usr/include/sys/poll.h

20 #iâdef 
_SYS_POLL_H


21 
	#_SYS_POLL_H
 1

	)

23 
	~<ã©u»s.h
>

26 
	~<b™s/pŞl.h
>

27 #ifdeà
__USE_GNU


29 
	~<b™s/sig£t.h
>

31 
	#__Ãed_time¥ec


	)

32 
	~<time.h
>

37 
	tnfds_t
;

40 
	spŞlfd


42 
	mfd
;

43 
	mev’ts
;

44 
	m»v’ts
;

48 
__BEGIN_DECLS


58 
pŞl
 (
pŞlfd
 *
__fds
, 
nfds_t
 
__nfds
, 
__timeout
);

60 #ifdeà
__USE_GNU


67 
µŞl
 (
pŞlfd
 *
__fds
, 
nfds_t
 
__nfds
,

68 
__cÚ¡
 
time¥ec
 *
__timeout
,

69 
__cÚ¡
 
__sig£t_t
 *
__ss
);

72 
	g__END_DECLS


	@/usr/include/sys/prctl.h

19 #iâdeà
_SYS_PRCTL_H


20 
	#_SYS_PRCTL_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<lšux/´ùl.h
>

25 
__BEGIN_DECLS


28 
	$´ùl
 (
__İtiÚ
, ...è
__THROW
;

30 
__END_DECLS


	@/usr/include/sys/resource.h

19 #iâdef 
_SYS_RESOURCE_H


20 
	#_SYS_RESOURCE_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/»sourû.h
>

27 #iâdeà
__id_t_defšed


28 
__id_t
 
	tid_t
;

29 
	#__id_t_defšed


	)

32 
	g__BEGIN_DECLS


38 #ià
defšed
 
__USE_GNU
 && !defšed 
__ılu¥lus


39 
__¾im™_»sourû
 
	t__¾im™_»sourû_t
;

40 
__ru§ge_who
 
	t__ru§ge_who_t
;

41 
__´iÜ™y_which
 
	t__´iÜ™y_which_t
;

43 
	t__¾im™_»sourû_t
;

44 
	t__ru§ge_who_t
;

45 
	t__´iÜ™y_which_t
;

50 #iâdeà
__USE_FILE_OFFSET64


51 
	$g‘¾im™
 (
__¾im™_»sourû_t
 
__»sourû
,

52 
¾im™
 *
__¾im™s
è
__THROW
;

54 #ifdeà
__REDIRECT_NTH


55 
	`__REDIRECT_NTH
 (
g‘¾im™
, (
__¾im™_»sourû_t
 
__»sourû
,

56 
¾im™
 *
__¾im™s
), 
g‘¾im™64
);

58 
	#g‘¾im™
 
g‘¾im™64


	)

61 #ifdeà
__USE_LARGEFILE64


62 
	$g‘¾im™64
 (
__¾im™_»sourû_t
 
__»sourû
,

63 
¾im™64
 *
__¾im™s
è
__THROW
;

69 #iâdeà
__USE_FILE_OFFSET64


70 
	$£Œlim™
 (
__¾im™_»sourû_t
 
__»sourû
,

71 
__cÚ¡
 
¾im™
 *
__¾im™s
è
__THROW
;

73 #ifdeà
__REDIRECT_NTH


74 
	`__REDIRECT_NTH
 (
£Œlim™
, (
__¾im™_»sourû_t
 
__»sourû
,

75 
__cÚ¡
 
¾im™
 *
__¾im™s
),

76 
£Œlim™64
);

78 
	#£Œlim™
 
£Œlim™64


	)

81 #ifdeà
__USE_LARGEFILE64


82 
	$£Œlim™64
 (
__¾im™_»sourû_t
 
__»sourû
,

83 
__cÚ¡
 
¾im™64
 *
__¾im™s
è
__THROW
;

88 
	$g‘ru§ge
 (
__ru§ge_who_t
 
__who
, 
ru§ge
 *
__u§ge
è
__THROW
;

94 
	$g‘´iÜ™y
 (
__´iÜ™y_which_t
 
__which
, 
id_t
 
__who
è
__THROW
;

98 
	$£riÜ™y
 (
__´iÜ™y_which_t
 
__which
, 
id_t
 
__who
, 
__´io
)

99 
__THROW
;

101 
__END_DECLS


	@/usr/include/sys/socket.h

21 #iâdef 
_SYS_SOCKET_H


22 
	#_SYS_SOCKET_H
 1

	)

24 
	~<ã©u»s.h
>

26 
	g__BEGIN_DECLS


28 
	~<sys/uio.h
>

29 
	#__Ãed_size_t


	)

30 
	~<¡ddef.h
>

31 #ifdeà
__USE_GNU


33 
	~<b™s/sig£t.h
>

40 
	~<b™s/sock‘.h
>

42 #ifdeà
__USE_BSD


45 
	sosockaddr


47 
	m§_çmy
;

48 
	m§_d©a
[14];

56 
	mSHUT_RD
 = 0,

57 
	#SHUT_RD
 
SHUT_RD


	)

58 
	mSHUT_WR
,

59 
	#SHUT_WR
 
SHUT_WR


	)

60 
	mSHUT_RDWR


61 
	#SHUT_RDWR
 
SHUT_RDWR


	)

70 #ià
defšed
 
__ılu¥lus
 || !
__GNUC_PREREQ
 (2, 7è|| !defšed 
__USE_GNU


71 
	#__SOCKADDR_ARG
 
sockaddr
 *
__»¡riù


	)

72 
	#__CONST_SOCKADDR_ARG
 
__cÚ¡
 
sockaddr
 *

	)

76 
	#__SOCKADDR_ALLTYPES
 \

77 
	`__SOCKADDR_ONETYPE
 (
sockaddr
) \

78 
	`__SOCKADDR_ONETYPE
 (
sockaddr_©
) \

79 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ax25
) \

80 
	`__SOCKADDR_ONETYPE
 (
sockaddr_dl
) \

81 
	`__SOCKADDR_ONETYPE
 (
sockaddr_eÚ
) \

82 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š
) \

83 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š6
) \

84 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š¬p
) \

85 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x
) \

86 
	`__SOCKADDR_ONETYPE
 (
sockaddr_iso
) \

87 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ns
) \

88 
	`__SOCKADDR_ONETYPE
 (
sockaddr_un
) \

89 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x25
)

	)

91 
	#__SOCKADDR_ONETYPE
(
ty³
èty³ *
__»¡riù
 
__
##ty³##__;

	)

92 uniÚ { 
	m__SOCKADDR_ALLTYPES


93 } 
	t__SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

94 #undeà
__SOCKADDR_ONETYPE


95 
	#__SOCKADDR_ONETYPE
(
ty³
è
__cÚ¡
 ty³ *
__»¡riù
 
__
##ty³##__;

	)

96 uniÚ { 
	m__SOCKADDR_ALLTYPES


97 } 
	t__CONST_SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

98 #undeà
__SOCKADDR_ONETYPE


105 
	$sock‘
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
è
__THROW
;

111 
	$sock‘·œ
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
,

112 
__fds
[2]è
__THROW
;

115 
	$bšd
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
)

116 
__THROW
;

119 
	$g‘sockÇme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

120 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

129 
	`cÚÃù
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
);

133 
	$g‘³”Çme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

134 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

141 
ssize_t
 
	`£nd
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
, 
__æags
);

148 
ssize_t
 
	`»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
);

155 
ssize_t
 
	`£ndto
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
,

156 
__æags
, 
__CONST_SOCKADDR_ARG
 
__addr
,

157 
sockËn_t
 
__addr_Ën
);

166 
ssize_t
 
	`»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

167 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

168 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

176 
ssize_t
 
	`£ndmsg
 (
__fd
, 
__cÚ¡
 
msghdr
 *
__mes§ge
,

177 
__æags
);

184 
ssize_t
 
	`»cvmsg
 (
__fd
, 
msghdr
 *
__mes§ge
, 
__æags
);

190 
	$g‘sockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

191 *
__»¡riù
 
__İtv®
,

192 
sockËn_t
 *
__»¡riù
 
__İ’
è
__THROW
;

197 
	$£tsockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

198 
__cÚ¡
 *
__İtv®
, 
sockËn_t
 
__İ’
è
__THROW
;

204 
	$li¡’
 (
__fd
, 
__n
è
__THROW
;

214 
	`acû±
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

215 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

223 
	$shutdown
 (
__fd
, 
__how
è
__THROW
;

226 #ifdeà
__USE_XOPEN2K


228 
	$sock©m¬k
 (
__fd
è
__THROW
;

232 #ifdeà
__USE_MISC


236 
	$isfdty³
 (
__fd
, 
__fdty³
è
__THROW
;

241 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


242 
	~<b™s/sock‘2.h
>

245 
__END_DECLS


	@/usr/include/sys/stat.h

24 #iâdef 
_SYS_STAT_H


25 
	#_SYS_STAT_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	~<b™s/ty³s.h
>

31 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K
 || defšed 
__USE_MISC
 \

32 || 
defšed
 
	g__USE_ATFILE


33 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


34 
	#__Ãed_time_t


	)

36 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ATFILE


37 
	#__Ãed_time¥ec


	)

39 
	~<time.h
>

42 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


45 #iâdeà
__dev_t_defšed


46 
__dev_t
 
	tdev_t
;

47 
	#__dev_t_defšed


	)

50 #iâdeà
__gid_t_defšed


51 
__gid_t
 
	tgid_t
;

52 
	#__gid_t_defšed


	)

55 #iâdeà
__šo_t_defšed


56 #iâdeà
__USE_FILE_OFFSET64


57 
__šo_t
 
	tšo_t
;

59 
__šo64_t
 
	tšo_t
;

61 
	#__šo_t_defšed


	)

64 #iâdeà
__mode_t_defšed


65 
__mode_t
 
	tmode_t
;

66 
	#__mode_t_defšed


	)

69 #iâdeà
__Æšk_t_defšed


70 
__Æšk_t
 
	tÆšk_t
;

71 
	#__Æšk_t_defšed


	)

74 #iâdeà
__off_t_defšed


75 #iâdeà
__USE_FILE_OFFSET64


76 
__off_t
 
	toff_t
;

78 
__off64_t
 
	toff_t
;

80 
	#__off_t_defšed


	)

83 #iâdeà
__uid_t_defšed


84 
__uid_t
 
	tuid_t
;

85 
	#__uid_t_defšed


	)

89 #ifdeà
__USE_UNIX98


90 #iâdeà
__blkút_t_defšed


91 #iâdeà
__USE_FILE_OFFSET64


92 
__blkút_t
 
	tblkút_t
;

94 
__blkút64_t
 
	tblkút_t
;

96 
	#__blkút_t_defšed


	)

99 #iâdeà
__blksize_t_defšed


100 
__blksize_t
 
	tblksize_t
;

101 
	#__blksize_t_defšed


	)

105 
	g__BEGIN_DECLS


107 
	~<b™s/¡©.h
>

109 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


110 
	#S_IFMT
 
__S_IFMT


	)

111 
	#S_IFDIR
 
__S_IFDIR


	)

112 
	#S_IFCHR
 
__S_IFCHR


	)

113 
	#S_IFBLK
 
__S_IFBLK


	)

114 
	#S_IFREG
 
__S_IFREG


	)

115 #ifdeà
__S_IFIFO


116 
	#S_IFIFO
 
__S_IFIFO


	)

118 #ifdeà
__S_IFLNK


119 
	#S_IFLNK
 
__S_IFLNK


	)

121 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_UNIX98
) \

122 && 
defšed
 
	g__S_IFSOCK


123 
	#S_IFSOCK
 
__S_IFSOCK


	)

129 
	#__S_ISTYPE
(
mode
, 
mask
è(((modeè& 
__S_IFMT
è=ğ(mask))

	)

131 
	#S_ISDIR
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFDIR
)

	)

132 
	#S_ISCHR
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFCHR
)

	)

133 
	#S_ISBLK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFBLK
)

	)

134 
	#S_ISREG
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFREG
)

	)

135 #ifdeà
__S_IFIFO


136 
	#S_ISFIFO
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFIFO
)

	)

138 #ifdeà
__S_IFLNK


139 
	#S_ISLNK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFLNK
)

	)

142 #ià
defšed
 
__USE_BSD
 && !defšed 
__S_IFLNK


143 
	#S_ISLNK
(
mode
è0

	)

146 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98
) \

147 && 
defšed
 
	g__S_IFSOCK


148 
	#S_ISSOCK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFSOCK
)

	)

155 #ifdef 
__USE_POSIX199309


156 
	#S_TYPEISMQ
(
buf
è
	`__S_TYPEISMQ
(buf)

	)

157 
	#S_TYPEISSEM
(
buf
è
	`__S_TYPEISSEM
(buf)

	)

158 
	#S_TYPEISSHM
(
buf
è
	`__S_TYPEISSHM
(buf)

	)

164 
	#S_ISUID
 
__S_ISUID


	)

165 
	#S_ISGID
 
__S_ISGID


	)

167 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


169 
	#S_ISVTX
 
__S_ISVTX


	)

172 
	#S_IRUSR
 
__S_IREAD


	)

173 
	#S_IWUSR
 
__S_IWRITE


	)

174 
	#S_IXUSR
 
__S_IEXEC


	)

176 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

178 #ià
defšed
 
__USE_MISC
 && defšed 
__USE_BSD


179 
	#S_IREAD
 
S_IRUSR


	)

180 
	#S_IWRITE
 
S_IWUSR


	)

181 
	#S_IEXEC
 
S_IXUSR


	)

184 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

185 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

186 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

188 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

190 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

191 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

192 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

194 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

197 #ifdef 
__USE_BSD


199 
	#ACCESSPERMS
 (
S_IRWXU
|
S_IRWXG
|
S_IRWXO
è

	)

200 
	#ALLPERMS
 (
S_ISUID
|
S_ISGID
|
S_ISVTX
|
S_IRWXU
|
S_IRWXG
|
S_IRWXO
)

	)

201 
	#DEFFILEMODE
 (
S_IRUSR
|
S_IWUSR
|
S_IRGRP
|
S_IWGRP
|
S_IROTH
|
S_IWOTH
)

	)

203 
	#S_BLKSIZE
 512

	)

207 #iâdeà
__USE_FILE_OFFSET64


209 
	$¡©
 (
__cÚ¡
 *
__»¡riù
 
__fe
,

210 
¡©
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

214 
	$f¡©
 (
__fd
, 
¡©
 *
__buf
è
__THROW
 
	`__nÚnuÎ
 ((2));

216 #ifdeà
__REDIRECT_NTH


217 
	`__REDIRECT_NTH
 (
¡©
, (
__cÚ¡
 *
__»¡riù
 
__fe
,

218 
¡©
 *
__»¡riù
 
__buf
), 
¡©64
)

219 
	`__nÚnuÎ
 ((1, 2));

220 
	`__REDIRECT_NTH
 (
f¡©
, (
__fd
, 
¡©
 *
__buf
), 
f¡©64
)

221 
	`__nÚnuÎ
 ((2));

223 
	#¡©
 
¡©64


	)

224 
	#f¡©
 
f¡©64


	)

227 #ifdeà
__USE_LARGEFILE64


228 
	$¡©64
 (
__cÚ¡
 *
__»¡riù
 
__fe
,

229 
¡©64
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

230 
	$f¡©64
 (
__fd
, 
¡©64
 *
__buf
è
__THROW
 
	`__nÚnuÎ
 ((2));

233 #ifdeà
__USE_ATFILE


237 #iâdeà
__USE_FILE_OFFSET64


238 
	$f¡©©
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fe
,

239 
¡©
 *
__»¡riù
 
__buf
, 
__æag
)

240 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

242 #ifdeà
__REDIRECT_NTH


243 
	`__REDIRECT_NTH
 (
f¡©©
, (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fe
,

244 
¡©
 *
__»¡riù
 
__buf
,

245 
__æag
),

246 
f¡©©64
è
	`__nÚnuÎ
 ((2, 3));

248 
	#f¡©©
 
f¡©©64


	)

252 
	$f¡©©64
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fe
,

253 
¡©64
 *
__»¡riù
 
__buf
, 
__æag
)

254 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

257 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


258 #iâdeà
__USE_FILE_OFFSET64


261 
	$l¡©
 (
__cÚ¡
 *
__»¡riù
 
__fe
,

262 
¡©
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

264 #ifdeà
__REDIRECT_NTH


265 
	`__REDIRECT_NTH
 (
l¡©
,

266 (
__cÚ¡
 *
__»¡riù
 
__fe
,

267 
¡©
 *
__»¡riù
 
__buf
), 
l¡©64
)

268 
	`__nÚnuÎ
 ((1, 2));

270 
	#l¡©
 
l¡©64


	)

273 #ifdeà
__USE_LARGEFILE64


274 
	$l¡©64
 (
__cÚ¡
 *
__»¡riù
 
__fe
,

275 
¡©64
 *
__»¡riù
 
__buf
)

276 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

282 
	$chmod
 (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
)

283 
__THROW
 
	`__nÚnuÎ
 ((1));

285 #ifdeà
__USE_BSD


289 
	$lchmod
 (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
)

290 
__THROW
 
	`__nÚnuÎ
 ((1));

294 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


295 
	$fchmod
 (
__fd
, 
__mode_t
 
__mode
è
__THROW
;

298 #ifdeà
__USE_ATFILE


301 
	$fchmod©
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__mode_t
 
mode
, 
__æag
)

302 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

309 
__mode_t
 
	$umask
 (
__mode_t
 
__mask
è
__THROW
;

311 #ifdef 
__USE_GNU


314 
__mode_t
 
	$g‘umask
 (è
__THROW
;

318 
	$mkdœ
 (
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
)

319 
__THROW
 
	`__nÚnuÎ
 ((1));

321 #ifdeà
__USE_ATFILE


325 
	$mkdœ©
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
)

326 
__THROW
 
	`__nÚnuÎ
 ((2));

332 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


333 
	$mknod
 (
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
)

334 
__THROW
 
	`__nÚnuÎ
 ((1));

337 #ifdeà
__USE_ATFILE


341 
	$mknod©
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
,

342 
__dev_t
 
__dev
è
__THROW
 
	`__nÚnuÎ
 ((2));

347 
	$mkfifo
 (
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
)

348 
__THROW
 
	`__nÚnuÎ
 ((1));

350 #ifdeà
__USE_ATFILE


354 
	$mkfifßt
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
)

355 
__THROW
 
	`__nÚnuÎ
 ((2));

358 #ifdeà
__USE_ATFILE


361 
	$utim’§t
 (
__fd
, 
__cÚ¡
 *
__·th
,

362 
__cÚ¡
 
time¥ec
 
__times
[2],

363 
__æags
)

364 
__THROW
 
	`__nÚnuÎ
 ((2));

367 #ifdeà
__USE_GNU


370 
	$futim’s
 (
__fd
, 
__cÚ¡
 
time¥ec
 
__times
[2]è
__THROW
;

388 #iâdeà
_STAT_VER


389 
	#_STAT_VER
 0

	)

391 #iâdeà
_MKNOD_VER


392 
	#_MKNOD_VER
 0

	)

396 #iâdeà
__USE_FILE_OFFSET64


397 
	$__fx¡©
 (
__v”
, 
__fdes
, 
¡©
 *
__¡©_buf
)

398 
__THROW
 
	`__nÚnuÎ
 ((3));

399 
	$__x¡©
 (
__v”
, 
__cÚ¡
 *
__f’ame
,

400 
¡©
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

401 
	$__lx¡©
 (
__v”
, 
__cÚ¡
 *
__f’ame
,

402 
¡©
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

403 
	$__fx¡©©
 (
__v”
, 
__fdes
, 
__cÚ¡
 *
__f’ame
,

404 
¡©
 *
__¡©_buf
, 
__æag
)

405 
__THROW
 
	`__nÚnuÎ
 ((3, 4));

407 #ifdeà
__REDIRECT_NTH


408 
	`__REDIRECT_NTH
 (
__fx¡©
, (
__v”
, 
__fdes
,

409 
¡©
 *
__¡©_buf
), 
__fx¡©64
)

410 
	`__nÚnuÎ
 ((3));

411 
	`__REDIRECT_NTH
 (
__x¡©
, (
__v”
, 
__cÚ¡
 *
__f’ame
,

412 
¡©
 *
__¡©_buf
), 
__x¡©64
)

413 
	`__nÚnuÎ
 ((2, 3));

414 
	`__REDIRECT_NTH
 (
__lx¡©
, (
__v”
, 
__cÚ¡
 *
__f’ame
,

415 
¡©
 *
__¡©_buf
), 
__lx¡©64
)

416 
	`__nÚnuÎ
 ((2, 3));

417 
	`__REDIRECT_NTH
 (
__fx¡©©
, (
__v”
, 
__fdes
,

418 
__cÚ¡
 *
__f’ame
,

419 
¡©
 *
__¡©_buf
, 
__æag
),

420 
__fx¡©©64
è
	`__nÚnuÎ
 ((3, 4));

423 
	#__fx¡©
 
__fx¡©64


	)

424 
	#__x¡©
 
__x¡©64


	)

425 
	#__lx¡©
 
__lx¡©64


	)

429 #ifdeà
__USE_LARGEFILE64


430 
	$__fx¡©64
 (
__v”
, 
__fdes
, 
¡©64
 *
__¡©_buf
)

431 
__THROW
 
	`__nÚnuÎ
 ((3));

432 
	$__x¡©64
 (
__v”
, 
__cÚ¡
 *
__f’ame
,

433 
¡©64
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

434 
	$__lx¡©64
 (
__v”
, 
__cÚ¡
 *
__f’ame
,

435 
¡©64
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

436 
	$__fx¡©©64
 (
__v”
, 
__fdes
, 
__cÚ¡
 *
__f’ame
,

437 
¡©64
 *
__¡©_buf
, 
__æag
)

438 
__THROW
 
	`__nÚnuÎ
 ((3, 4));

440 
	$__xmknod
 (
__v”
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
,

441 
__dev_t
 *
__dev
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

443 
	$__xmknod©
 (
__v”
, 
__fd
, 
__cÚ¡
 *
__·th
,

444 
__mode_t
 
__mode
, 
__dev_t
 *
__dev
)

445 
__THROW
 
	`__nÚnuÎ
 ((3, 5));

447 #ià
defšed
 
__GNUC__
 && __GNUC__ >ğ2 && defšed 
__USE_EXTERN_INLINES


450 
__ex‹º_šlše
 

451 
	`__NTH
 (
	$¡©
 (
__cÚ¡
 *
__·th
, 
¡©
 *
__¡©buf
))

453  
	`__x¡©
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

454 
	}
}

456 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


457 
__ex‹º_šlše
 

458 
__NTH
 (
	$l¡©
 (
__cÚ¡
 *
__·th
, 
¡©
 *
__¡©buf
))

460  
	`__lx¡©
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

461 
	}
}

464 
__ex‹º_šlše
 

465 
__NTH
 (
	$f¡©
 (
__fd
, 
¡©
 *
__¡©buf
))

467  
	`__fx¡©
 (
_STAT_VER
, 
__fd
, 
__¡©buf
);

468 
	}
}

470 #ifdeà
__USE_ATFILE


471 
__ex‹º_šlše
 

472 
__NTH
 (
	$f¡©©
 (
__fd
, 
__cÚ¡
 *
__f’ame
, 
¡©
 *
__¡©buf
,

473 
__æag
))

475  
	`__fx¡©©
 (
_STAT_VER
, 
__fd
, 
__f’ame
, 
__¡©buf
, 
__æag
);

476 
	}
}

479 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_BSD


480 
__ex‹º_šlše
 

481 
__NTH
 (
	$mknod
 (
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
))

483  
	`__xmknod
 (
_MKNOD_VER
, 
__·th
, 
__mode
, &
__dev
);

484 
	}
}

487 #ifdeà
__USE_ATFILE


488 
__ex‹º_šlše
 

489 
__NTH
 (
	$mknod©
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
,

490 
__dev_t
 
__dev
))

492  
	`__xmknod©
 (
_MKNOD_VER
, 
__fd
, 
__·th
, 
__mode
, &
__dev
);

493 
	}
}

496 #ià
defšed
 
__USE_LARGEFILE64
 \

497 && (! 
defšed
 
	g__USE_FILE_OFFSET64
 \

498 || (
defšed
 
	g__REDIRECT_NTH
 && defšed 
	g__OPTIMIZE__
))

499 
__ex‹º_šlše
 

500 
__NTH
 (
	$¡©64
 (
__cÚ¡
 *
__·th
, 
¡©64
 *
__¡©buf
))

502  
	`__x¡©64
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

503 
	}
}

505 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


506 
__ex‹º_šlše
 

507 
__NTH
 (
	$l¡©64
 (
__cÚ¡
 *
__·th
, 
¡©64
 *
__¡©buf
))

509  
	`__lx¡©64
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

510 
	}
}

513 
__ex‹º_šlše
 

514 
__NTH
 (
	$f¡©64
 (
__fd
, 
¡©64
 *
__¡©buf
))

516  
	`__fx¡©64
 (
_STAT_VER
, 
__fd
, 
__¡©buf
);

517 
	}
}

519 #ifdeà
__USE_GNU


520 
__ex‹º_šlše
 

521 
__NTH
 (
	$f¡©©64
 (
__fd
, 
__cÚ¡
 *
__f’ame
, 
¡©64
 *
__¡©buf
,

522 
__æag
))

524  
	`__fx¡©©64
 (
_STAT_VER
, 
__fd
, 
__f’ame
, 
__¡©buf
, 
__æag
);

525 
	}
}

532 
	g__END_DECLS


	@/usr/include/sys/syscall.h

19 #iâdeà
_SYSCALL_H


20 
	#_SYSCALL_H
 1

	)

25 
	~<asm/uni¡d.h
>

27 #iâdeà
_LIBC


32 
	~<b™s/sysÿÎ.h
>

	@/usr/include/sys/sysctl.h

19 #iâdef 
_SYS_SYSCTL_H


20 
	#_SYS_SYSCTL_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 #iâdeà
_LINUX_KERNEL_H


27 
	#_LINUX_KERNEL_H
 1

	)

28 
	#__undef_LINUX_KERNEL_H


	)

30 #iâdeà
_LINUX_TYPES_H


31 
	#_LINUX_TYPES_H
 1

	)

32 
	#__undef_LINUX_TYPES_H


	)

34 #iâdeà
_LINUX_LIST_H


35 
	#_LINUX_LIST_H
 1

	)

36 
	#__undef_LINUX_LIST_H


	)

38 #iâdeà
__LINUX_COMPILER_H


39 
	#__LINUX_COMPILER_H
 1

	)

40 
	#__u£r


	)

41 
	#__undef__LINUX_COMPILER_H


	)

44 
	~<lšux/sysùl.h
>

46 #ifdeà
__undef_LINUX_KERNEL_H


47 #undeà
_LINUX_KERNEL_H


48 #undeà
__undef_LINUX_KERNEL_H


50 #ifdeà
__undef_LINUX_TYPES_H


51 #undeà
_LINUX_TYPES_H


52 #undeà
__undef_LINUX_TYPES_H


54 #ifdeà
__undef_LINUX_LIST_H


55 #undeà
_LINUX_LIST_H


56 #undeà
__undef_LINUX_LIST_H


58 #ifdeà
__undef__LINUX_COMPILER_H


59 #undeà
__LINUX_COMPILER_H


60 #undeà
__u£r


61 #undeà
__undef__LINUX_COMPILER_H


64 
__BEGIN_DECLS


67 
	$sysùl
 (*
__Çme
, 
__Æ’
, *
__Şdv®
,

68 
size_t
 *
__ŞdËÅ
, *
__Ãwv®
, size_ˆ
__ÃwËn
è
__THROW
;

70 
__END_DECLS


	@/usr/include/sys/time.h

20 #iâdeà
_SYS_TIME_H


21 
	#_SYS_TIME_H
 1

	)

23 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

26 
	#__Ãed_time_t


	)

27 
	~<time.h
>

28 
	#__Ãed_timev®


	)

29 
	~<b™s/time.h
>

31 
	~<sys/£Ëù.h
>

33 #iâdeà
__su£cÚds_t_defšed


34 
__su£cÚds_t
 
	tsu£cÚds_t
;

35 
	#__su£cÚds_t_defšed


	)

39 
	g__BEGIN_DECLS


41 #ifdeà
__USE_GNU


43 
	#TIMEVAL_TO_TIMESPEC
(
tv
, 
ts
) { \

44 (
ts
)->
tv_£c
 = (
tv
)->tv_sec; \

45 (
ts
)->
tv_n£c
 = (
tv
)->
tv_u£c
 * 1000; \

46 }

	)

47 
	#TIMESPEC_TO_TIMEVAL
(
tv
, 
ts
) { \

48 (
tv
)->
tv_£c
 = (
ts
)->tv_sec; \

49 (
tv
)->
tv_u£c
 = (
ts
)->
tv_n£c
 / 1000; \

50 }

	)

54 #ifdeà
__USE_BSD


57 
	stimezÚe


59 
	mtz_mšu‹swe¡
;

60 
	mtz_d¡time
;

63 
timezÚe
 *
	t__»¡riù
 
	t__timezÚe_±r_t
;

65 *
	t__»¡riù
 
	t__timezÚe_±r_t
;

73 
	$g‘timeofday
 (
timev®
 *
__»¡riù
 
__tv
,

74 
__timezÚe_±r_t
 
__tz
è
__THROW
 
	`__nÚnuÎ
 ((1));

76 #ifdeà
__USE_BSD


79 
	$£‰imeofday
 (
__cÚ¡
 
timev®
 *
__tv
,

80 
__cÚ¡
 
timezÚe
 *
__tz
)

81 
__THROW
 
	`__nÚnuÎ
 ((1));

87 
	$adjtime
 (
__cÚ¡
 
timev®
 *
__d–
,

88 
timev®
 *
__Şdd–
è
__THROW
;

93 
	e__™im”_which


96 
ITIMER_REAL
 = 0,

97 
	#ITIMER_REAL
 
ITIMER_REAL


	)

99 
ITIMER_VIRTUAL
 = 1,

100 
	#ITIMER_VIRTUAL
 
ITIMER_VIRTUAL


	)

103 
ITIMER_PROF
 = 2

104 
	#ITIMER_PROF
 
ITIMER_PROF


	)

109 
	s™im”v®


112 
timev®
 
™_š‹rv®
;

114 
timev®
 
™_v®ue
;

117 #ià
defšed
 
__USE_GNU
 && !defšed 
__ılu¥lus


120 
__™im”_which
 
	t__™im”_which_t
;

122 
	t__™im”_which_t
;

127 
	$g‘™im”
 (
__™im”_which_t
 
__which
,

128 
™im”v®
 *
__v®ue
è
__THROW
;

133 
	$£t™im”
 (
__™im”_which_t
 
__which
,

134 
__cÚ¡
 
™im”v®
 *
__»¡riù
 
__Ãw
,

135 
™im”v®
 *
__»¡riù
 
__Şd
è
__THROW
;

140 
	$utimes
 (
__cÚ¡
 *
__fe
, __cÚ¡ 
timev®
 
__tvp
[2])

141 
__THROW
 
	`__nÚnuÎ
 ((1));

143 #ifdeà
__USE_BSD


145 
	$lutimes
 (
__cÚ¡
 *
__fe
, __cÚ¡ 
timev®
 
__tvp
[2])

146 
__THROW
 
	`__nÚnuÎ
 ((1));

149 
	$futimes
 (
__fd
, 
__cÚ¡
 
timev®
 
__tvp
[2]è
__THROW
;

152 #ifdeà
__USE_ATFILE


156 
	$futime§t
 (
__fd
, 
__cÚ¡
 *
__fe
,

157 
__cÚ¡
 
timev®
 
__tvp
[2]è
__THROW
;

161 #ifdeà
__USE_BSD


164 
	#tim”is£t
(
tvp
è(Ñvp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

165 
	#tim”ş—r
(
tvp
è(Ñvp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0)

	)

166 
	#tim”cmp
(
a
, 
b
, 
CMP
) \

167 (((
a
)->
tv_£c
 =ğ(
b
)->tv_sec) ? \

168 ((
a
)->
tv_u£c
 
	`CMP
 (
b
)->tv_usec) : \

169 ((
a
)->
tv_£c
 
	`CMP
 (
b
)->tv_£c))

	)

170 
	#tim”add
(
a
, 
b
, 
»suÉ
) \

172 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø+ (
b
)->tv_sec; \

173 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø+ (
b
)->tv_usec; \

174 ià((
»suÉ
)->
tv_u£c
 >= 1000000) \

176 ++(
»suÉ
)->
tv_£c
; \

177 (
»suÉ
)->
tv_u£c
 -= 1000000; \

179 
	}
} 0)

	)

180 
	#tim”sub
(
a
, 
b
, 
»suÉ
) \

182 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø- (
b
)->tv_sec; \

183 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø- (
b
)->tv_usec; \

184 ià((
»suÉ
)->
tv_u£c
 < 0) { \

185 --(
»suÉ
)->
tv_£c
; \

186 (
»suÉ
)->
tv_u£c
 += 1000000; \

188 } 0)

	)

191 
	g__END_DECLS


	@/usr/include/sys/types.h

24 #iâdef 
_SYS_TYPES_H


25 
	#_SYS_TYPES_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

33 #ifdef 
__USE_BSD


34 #iâdeà
__u_ch¬_defšed


35 
__u_ch¬
 
	tu_ch¬
;

36 
__u_shÜt
 
	tu_shÜt
;

37 
__u_št
 
	tu_št
;

38 
__u_lÚg
 
	tu_lÚg
;

39 
__quad_t
 
	tquad_t
;

40 
__u_quad_t
 
	tu_quad_t
;

41 
__fsid_t
 
	tfsid_t
;

42 
	#__u_ch¬_defšed


	)

46 
__loff_t
 
	tloff_t
;

48 #iâdeà
__šo_t_defšed


49 #iâdeà
__USE_FILE_OFFSET64


50 
__šo_t
 
	tšo_t
;

52 
__šo64_t
 
	tšo_t
;

54 
	#__šo_t_defšed


	)

56 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


57 
__šo64_t
 
	tšo64_t
;

58 
	#__šo64_t_defšed


	)

61 #iâdeà
__dev_t_defšed


62 
__dev_t
 
	tdev_t
;

63 
	#__dev_t_defšed


	)

66 #iâdeà
__gid_t_defšed


67 
__gid_t
 
	tgid_t
;

68 
	#__gid_t_defšed


	)

71 #iâdeà
__mode_t_defšed


72 
__mode_t
 
	tmode_t
;

73 
	#__mode_t_defšed


	)

76 #iâdeà
__Æšk_t_defšed


77 
__Æšk_t
 
	tÆšk_t
;

78 
	#__Æšk_t_defšed


	)

81 #iâdeà
__uid_t_defšed


82 
__uid_t
 
	tuid_t
;

83 
	#__uid_t_defšed


	)

86 #iâdeà
__off_t_defšed


87 #iâdeà
__USE_FILE_OFFSET64


88 
__off_t
 
	toff_t
;

90 
__off64_t
 
	toff_t
;

92 
	#__off_t_defšed


	)

94 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


95 
__off64_t
 
	toff64_t
;

96 
	#__off64_t_defšed


	)

99 #iâdeà
__pid_t_defšed


100 
__pid_t
 
	tpid_t
;

101 
	#__pid_t_defšed


	)

104 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
è&& !defšed 
__id_t_defšed


105 
__id_t
 
	tid_t
;

106 
	#__id_t_defšed


	)

109 #iâdeà
__ssize_t_defšed


110 
__ssize_t
 
	tssize_t
;

111 
	#__ssize_t_defšed


	)

114 #ifdef 
__USE_BSD


115 #iâdeà
__daddr_t_defšed


116 
__daddr_t
 
	tdaddr_t
;

117 
__ÿddr_t
 
	tÿddr_t
;

118 
	#__daddr_t_defšed


	)

122 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
è&& !defšed 
__key_t_defšed


123 
__key_t
 
	tkey_t
;

124 
	#__key_t_defšed


	)

127 #ifdeà
__USE_XOPEN


128 
	#__Ãed_şock_t


	)

130 
	#__Ãed_time_t


	)

131 
	#__Ãed_tim”_t


	)

132 
	#__Ãed_şockid_t


	)

133 
	~<time.h
>

135 #ifdeà
__USE_XOPEN


136 #iâdeà
__u£cÚds_t_defšed


137 
__u£cÚds_t
 
	tu£cÚds_t
;

138 
	#__u£cÚds_t_defšed


	)

140 #iâdeà
__su£cÚds_t_defšed


141 
__su£cÚds_t
 
	tsu£cÚds_t
;

142 
	#__su£cÚds_t_defšed


	)

146 
	#__Ãed_size_t


	)

147 
	~<¡ddef.h
>

149 #ifdeà
__USE_MISC


151 
	tulÚg
;

152 
	tushÜt
;

153 
	tušt
;

158 #ià!
__GNUC_PREREQ
 (2, 7)

161 #iâdeà
__št8_t_defšed


162 
	#__št8_t_defšed


	)

163 
	tšt8_t
;

164 
	tšt16_t
;

165 
	tšt32_t
;

166 #ià
__WORDSIZE
 == 64

167 
	tšt64_t
;

168 #–ià
__GLIBC_HAVE_LONG_LONG


169 
__ex‹nsiÚ__
 
	tšt64_t
;

174 
	tu_št8_t
;

175 
	tu_št16_t
;

176 
	tu_št32_t
;

177 #ià
__WORDSIZE
 == 64

178 
	tu_št64_t
;

179 #–ià
__GLIBC_HAVE_LONG_LONG


180 
__ex‹nsiÚ__
 
	tu_št64_t
;

183 
	t»gi¡”_t
;

188 
	#__štN_t
(
N
, 
MODE
) \

189 ##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

190 
	t__u_štN_t
(
	tN
, 
	tMODE
) \

191 
	tu_št
##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

193 #iâdeà
	t__št8_t_defšed


194 
	t__št8_t_defšed


	)

195 
	t__štN_t
 (8, 
	t__QI__
);

196 
__štN_t
 (16, 
__HI__
);

197 
__štN_t
 (32, 
__SI__
);

198 
__štN_t
 (64, 
__DI__
);

201 
__u_štN_t
 (8, 
__QI__
);

202 
__u_štN_t
 (16, 
__HI__
);

203 
__u_štN_t
 (32, 
__SI__
);

204 
__u_štN_t
 (64, 
__DI__
);

206 
	t»gi¡”_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__wÜd__
)));

212 
	#__BIT_TYPES_DEFINED__
 1

	)

215 #ifdef 
__USE_BSD


217 
	~<’dŸn.h
>

220 
	~<sys/£Ëù.h
>

223 
	~<sys/sysmaüos.h
>

227 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__blksize_t_defšed


228 
__blksize_t
 
	tblksize_t
;

229 
	#__blksize_t_defšed


	)

233 #iâdeà
__USE_FILE_OFFSET64


234 #iâdeà
__blkút_t_defšed


235 
__blkút_t
 
	tblkút_t
;

236 
	#__blkút_t_defšed


	)

238 #iâdeà
__fsblkút_t_defšed


239 
__fsblkút_t
 
	tfsblkút_t
;

240 
	#__fsblkút_t_defšed


	)

242 #iâdeà
__fsfút_t_defšed


243 
__fsfút_t
 
	tfsfút_t
;

244 
	#__fsfút_t_defšed


	)

247 #iâdeà
__blkút_t_defšed


248 
__blkút64_t
 
	tblkút_t
;

249 
	#__blkút_t_defšed


	)

251 #iâdeà
__fsblkút_t_defšed


252 
__fsblkút64_t
 
	tfsblkút_t
;

253 
	#__fsblkút_t_defšed


	)

255 #iâdeà
__fsfút_t_defšed


256 
__fsfút64_t
 
	tfsfút_t
;

257 
	#__fsfút_t_defšed


	)

261 #ifdeà
__USE_LARGEFILE64


262 
__blkút64_t
 
	tblkút64_t
;

263 
__fsblkút64_t
 
	tfsblkút64_t
;

264 
__fsfút64_t
 
	tfsfút64_t
;

269 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


270 
	~<b™s/±h»adty³s.h
>

273 
	g__END_DECLS


	@/usr/include/sys/un.h

19 #iâdef 
_SYS_UN_H


20 
	#_SYS_UN_H
 1

	)

22 
	~<sys/cdefs.h
>

25 
	~<b™s/sockaddr.h
>

27 
__BEGIN_DECLS


30 
	ssockaddr_un


32 
__SOCKADDR_COMMON
 (
sun_
);

33 
	msun_·th
[108];

37 #ifdeà
__USE_MISC


38 
	~<¡ršg.h
>

41 
	#SUN_LEN
(
±r
è((
size_t
è(((
sockaddr_un
 *è0)->
sun_·th
) \

42 + 
	`¡¾’
 ((
±r
)->
sun_·th
))

	)

45 
	g__END_DECLS


	@/usr/include/sys/utsname.h

23 #iâdef 
_SYS_UTSNAME_H


24 
	#_SYS_UTSNAME_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


30 
	~<b™s/ut¢ame.h
>

32 #iâdeà
_UTSNAME_SYSNAME_LENGTH


33 
	#_UTSNAME_SYSNAME_LENGTH
 
_UTSNAME_LENGTH


	)

35 #iâdeà
_UTSNAME_NODENAME_LENGTH


36 
	#_UTSNAME_NODENAME_LENGTH
 
_UTSNAME_LENGTH


	)

38 #iâdeà
_UTSNAME_RELEASE_LENGTH


39 
	#_UTSNAME_RELEASE_LENGTH
 
_UTSNAME_LENGTH


	)

41 #iâdeà
_UTSNAME_VERSION_LENGTH


42 
	#_UTSNAME_VERSION_LENGTH
 
_UTSNAME_LENGTH


	)

44 #iâdeà
_UTSNAME_MACHINE_LENGTH


45 
	#_UTSNAME_MACHINE_LENGTH
 
_UTSNAME_LENGTH


	)

49 
	sut¢ame


52 
	msy¢ame
[
_UTSNAME_SYSNAME_LENGTH
];

55 
	mnod’ame
[
_UTSNAME_NODENAME_LENGTH
];

58 
	m»Ëa£
[
_UTSNAME_RELEASE_LENGTH
];

60 
	mv”siÚ
[
_UTSNAME_VERSION_LENGTH
];

63 
	mmachše
[
_UTSNAME_MACHINE_LENGTH
];

65 #ià
_UTSNAME_DOMAIN_LENGTH
 - 0

67 #ifdeà
__USE_GNU


68 
	mdomašÇme
[
_UTSNAME_DOMAIN_LENGTH
];

70 
	m__domašÇme
[
_UTSNAME_DOMAIN_LENGTH
];

75 #ifdeà
__USE_SVID


77 
	#SYS_NMLN
 
_UTSNAME_LENGTH


	)

82 
	$uÇme
 (
ut¢ame
 *
__Çme
è
__THROW
;

85 
__END_DECLS


	@/usr/include/sys/wait.h

24 #iâdef 
_SYS_WAIT_H


25 
	#_SYS_WAIT_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	~<sigÇl.h
>

32 
	~<sys/»sourû.h
>

35 #ià!
defšed
 
_STDLIB_H
 || !defšed 
__USE_XOPEN


38 
	~<b™s/wa™æags.h
>

40 #ifdef 
__USE_BSD


45 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


46 
	#__WAIT_INT
(
¡©us
) \

47 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

48 { .
__š
 = (
¡©us
è}).
__i
))

	)

50 
	#__WAIT_INT
(
¡©us
è(*(
__cÚ¡
 *è&(¡©us))

	)

58 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


59 
	#__WAIT_STATUS
 *

	)

60 
	#__WAIT_STATUS_DEFN
 *

	)

65 
wa™
 *
	m__u±r
;

66 *
	m__Œ
;

67 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

68 
	#__WAIT_STATUS_DEFN
 *

	)

73 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

74 
	#__WAIT_STATUS
 *

	)

75 
	#__WAIT_STATUS_DEFN
 *

	)

80 
	~<b™s/wa™¡©us.h
>

82 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
(
	`__WAIT_INT
(¡©us))

	)

83 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
(
	`__WAIT_INT
(¡©us))

	)

84 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
(
	`__WAIT_INT
(¡©us))

	)

85 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
(
	`__WAIT_INT
(¡©us))

	)

86 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
(
	`__WAIT_INT
(¡©us))

	)

87 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
(
	`__WAIT_INT
(¡©us))

	)

88 #ifdeà
__WIFCONTINUED


89 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
(
	`__WAIT_INT
(¡©us))

	)

93 #ifdef 
__USE_BSD


94 
	#WCOREFLAG
 
__WCOREFLAG


	)

95 
	#WCOREDUMP
(
¡©us
è
	`__WCOREDUMP
(
	`__WAIT_INT
(¡©us))

	)

96 
	#W_EXITCODE
(
»t
, 
sig
è
	`__W_EXITCODE
Ô‘, sig)

	)

97 
	#W_STOPCODE
(
sig
è
	`__W_STOPCODE
(sig)

	)

101 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


104 
	mP_ALL
,

105 
	mP_PID
,

106 
	mP_PGID


107 } 
	tidty³_t
;

116 
__pid_t
 
wa™
 (
__WAIT_STATUS
 
__¡©_loc
);

118 #ifdef 
__USE_BSD


120 
	#WAIT_ANY
 (-1è

	)

121 
	#WAIT_MYPGRP
 0

	)

139 
__pid_t
 
wa™pid
 (__pid_ˆ
__pid
, *
__¡©_loc
, 
__İtiÚs
);

141 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


142 
	#__Ãed_sigšfo_t


	)

143 
	~<b™s/sigšfo.h
>

155 
wa™id
 (
idty³_t
 
__idty³
, 
__id_t
 
__id
, 
sigšfo_t
 *
__šfİ
,

156 
__İtiÚs
);

159 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


162 
	gru§ge
;

169 
__pid_t
 
	$wa™3
 (
__WAIT_STATUS
 
__¡©_loc
, 
__İtiÚs
,

170 
ru§ge
 * 
__u§ge
è
__THROW
;

173 #ifdeà
__USE_BSD


175 
__pid_t
 
	$wa™4
 (
__pid_t
 
__pid
, 
__WAIT_STATUS
 
__¡©_loc
, 
__İtiÚs
,

176 
ru§ge
 *
__u§ge
è
__THROW
;

180 
__END_DECLS


	@/usr/include/syslog.h

1 
	~<sys/sy¦og.h
>

	@/usr/include/time.h

24 #iâdef 
_TIME_H


26 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

27 ! 
defšed
 
	g__Ãed_time¥ec
)

28 
	#_TIME_H
 1

	)

29 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


35 #ifdef 
_TIME_H


37 
	#__Ãed_size_t


	)

38 
	#__Ãed_NULL


	)

39 
	~<¡ddef.h
>

43 
	~<b™s/time.h
>

46 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


47 #iâdeà
CLK_TCK


48 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

54 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

55 
	#__şock_t_defšed
 1

	)

57 
	~<b™s/ty³s.h
>

59 
__BEGIN_NAMESPACE_STD


61 
__şock_t
 
	tşock_t
;

62 
	g__END_NAMESPACE_STD


63 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


64 
	$__USING_NAMESPACE_STD
(
şock_t
)

68 #undeà
__Ãed_şock_t


70 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

71 
	#__time_t_defšed
 1

	)

73 
	~<b™s/ty³s.h
>

75 
__BEGIN_NAMESPACE_STD


77 
__time_t
 
	ttime_t
;

78 
__END_NAMESPACE_STD


79 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


80 
	$__USING_NAMESPACE_STD
(
time_t
)

84 #undeà
__Ãed_time_t


86 #ià!
defšed
 
__şockid_t_defšed
 && \

87 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

88 
	#__şockid_t_defšed
 1

	)

90 
	~<b™s/ty³s.h
>

93 
__şockid_t
 
	tşockid_t
;

96 #undeà
__şockid_time_t


98 #ià!
defšed
 
__tim”_t_defšed
 && \

99 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

100 
	#__tim”_t_defšed
 1

	)

102 
	~<b™s/ty³s.h
>

105 
__tim”_t
 
	ttim”_t
;

108 #undeà
__Ãed_tim”_t


111 #ià!
defšed
 
__time¥ec_defšed
 && \

112 ((
defšed
 
_TIME_H
 && \

113 (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
)) || \

114 
defšed
 
__Ãed_time¥ec
)

115 
	#__time¥ec_defšed
 1

	)

117 
	~<b™s/ty³s.h
>

121 
	stime¥ec


123 
__time_t
 
tv_£c
;

124 
tv_n£c
;

128 #undeà
__Ãed_time¥ec


131 #ifdef 
_TIME_H


132 
__BEGIN_NAMESPACE_STD


134 
	stm


136 
tm_£c
;

137 
tm_mš
;

138 
tm_hour
;

139 
tm_mday
;

140 
tm_mÚ
;

141 
tm_y—r
;

142 
tm_wday
;

143 
tm_yday
;

144 
tm_isd¡
;

146 #ifdef 
__USE_BSD


147 
tm_gmtoff
;

148 
__cÚ¡
 *
tm_zÚe
;

150 
__tm_gmtoff
;

151 
__cÚ¡
 *
__tm_zÚe
;

154 
__END_NAMESPACE_STD


155 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


156 
	$__USING_NAMESPACE_STD
(
tm
)

160 #ifdeà
__USE_POSIX199309


162 
	s™im”¥ec


164 
time¥ec
 
™_š‹rv®
;

165 
time¥ec
 
™_v®ue
;

169 
sigev’t
;

173 #ifdeà
__USE_XOPEN2K


174 #iâdeà
__pid_t_defšed


175 
__pid_t
 
	tpid_t
;

176 
	#__pid_t_defšed


	)

181 
__BEGIN_NAMESPACE_STD


184 
şock_t
 
	$şock
 (è
__THROW
;

187 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

190 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

191 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

194 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

200 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

201 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

202 
__cÚ¡
 
tm
 *
__»¡riù
 
__
è
__THROW
;

203 
__END_NAMESPACE_STD


205 #ifdeà
__USE_XOPEN


208 *
	$¡½time
 (
__cÚ¡
 *
__»¡riù
 
__s
,

209 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
)

210 
__THROW
;

213 #ifdeà
__USE_GNU


216 
	~<xloÿË.h
>

218 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

219 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

220 
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

221 
__loÿË_t
 
__loc
è
__THROW
;

223 *
	$¡½time_l
 (
__cÚ¡
 *
__»¡riù
 
__s
,

224 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
,

225 
__loÿË_t
 
__loc
è
__THROW
;

229 
__BEGIN_NAMESPACE_STD


232 
tm
 *
	$gmtime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

236 
tm
 *
	$loÿÉime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

237 
__END_NAMESPACE_STD


239 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


242 
tm
 *
	$gmtime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

243 
tm
 *
__»¡riù
 
__
è
__THROW
;

247 
tm
 *
	$loÿÉime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

248 
tm
 *
__»¡riù
 
__
è
__THROW
;

251 
__BEGIN_NAMESPACE_STD


254 *
	$asùime
 (
__cÚ¡
 
tm
 *
__
è
__THROW
;

257 *
	$ùime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

258 
__END_NAMESPACE_STD


260 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


265 *
	$asùime_r
 (
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

266 *
__»¡riù
 
__buf
è
__THROW
;

269 *
	$ùime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

270 *
__»¡riù
 
__buf
è
__THROW
;

275 *
__tzÇme
[2];

276 
__daylight
;

277 
__timezÚe
;

280 #ifdef 
__USE_POSIX


282 *
tzÇme
[2];

286 
	$tz£t
 (è
__THROW
;

289 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


290 
daylight
;

291 
timezÚe
;

294 #ifdeà
__USE_SVID


297 
	$¡ime
 (
__cÚ¡
 
time_t
 *
__wh’
è
__THROW
;

303 
	#__i¦—p
(
y—r
) \

304 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

307 #ifdeà
__USE_MISC


312 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

315 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

318 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

322 #ifdeà
__USE_POSIX199309


327 
	`Çno¦“p
 (
__cÚ¡
 
time¥ec
 *
__»que¡ed_time
,

328 
time¥ec
 *
__»maššg
);

332 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

335 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

338 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, 
__cÚ¡
 
time¥ec
 *
__
)

339 
__THROW
;

341 #ifdeà
__USE_XOPEN2K


346 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

347 
__cÚ¡
 
time¥ec
 *
__»q
,

348 
time¥ec
 *
__»m
);

351 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

356 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

357 
sigev’t
 *
__»¡riù
 
__evp
,

358 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

361 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

364 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

365 
__cÚ¡
 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

366 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

369 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

370 
__THROW
;

373 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

377 #ifdeà
__USE_XOPEN_EXTENDED


389 
g‘d©e_”r
;

398 
tm
 *
	`g‘d©e
 (
__cÚ¡
 *
__¡ršg
);

401 #ifdeà
__USE_GNU


412 
	`g‘d©e_r
 (
__cÚ¡
 *
__»¡riù
 
__¡ršg
,

413 
tm
 *
__»¡riù
 
__»sbuå
);

416 
__END_DECLS


	@/usr/include/unistd.h

23 #iâdef 
_UNISTD_H


24 
	#_UNISTD_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


34 
	#_POSIX_VERSION
 200112L

	)

40 
	#_POSIX2_VERSION
 200112L

	)

44 
	#_POSIX2_C_BIND
 200112L

	)

48 
	#_POSIX2_C_DEV
 200112L

	)

52 
	#_POSIX2_SW_DEV
 200112L

	)

56 
	#_POSIX2_LOCALEDEF
 200112L

	)

59 #ifdeà
__USE_XOPEN2K


60 
	#_XOPEN_VERSION
 600

	)

61 #–ià
defšed
 
__USE_UNIX98


62 
	#_XOPEN_VERSION
 500

	)

64 
	#_XOPEN_VERSION
 4

	)

68 
	#_XOPEN_XCU_VERSION
 4

	)

71 
	#_XOPEN_XPG2
 1

	)

72 
	#_XOPEN_XPG3
 1

	)

73 
	#_XOPEN_XPG4
 1

	)

76 
	#_XOPEN_UNIX
 1

	)

79 
	#_XOPEN_CRYPT
 1

	)

83 
	#_XOPEN_ENH_I18N
 1

	)

86 
	#_XOPEN_LEGACY
 1

	)

173 
	~<b™s/posix_İt.h
>

176 #ifdeà
__USE_UNIX98


177 
	~<b™s/’vœÚm’ts.h
>

181 
	#STDIN_FILENO
 0

	)

182 
	#STDOUT_FILENO
 1

	)

183 
	#STDERR_FILENO
 2

	)

188 
	~<b™s/ty³s.h
>

190 #iâdef 
__ssize_t_defšed


191 
__ssize_t
 
	tssize_t
;

192 
	#__ssize_t_defšed


	)

195 
	#__Ãed_size_t


	)

196 
	#__Ãed_NULL


	)

197 
	~<¡ddef.h
>

199 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


202 #iâdeà
__gid_t_defšed


203 
__gid_t
 
	tgid_t
;

204 
	#__gid_t_defšed


	)

207 #iâdeà
__uid_t_defšed


208 
__uid_t
 
	tuid_t
;

209 
	#__uid_t_defšed


	)

212 #iâdeà
__off_t_defšed


213 #iâdeà
__USE_FILE_OFFSET64


214 
__off_t
 
	toff_t
;

216 
__off64_t
 
	toff_t
;

218 
	#__off_t_defšed


	)

220 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


221 
__off64_t
 
	toff64_t
;

222 
	#__off64_t_defšed


	)

225 #iâdeà
__u£cÚds_t_defšed


226 
__u£cÚds_t
 
	tu£cÚds_t
;

227 
	#__u£cÚds_t_defšed


	)

230 #iâdeà
__pid_t_defšed


231 
__pid_t
 
	tpid_t
;

232 
	#__pid_t_defšed


	)

236 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


237 #iâdeà
__šŒ_t_defšed


238 
__šŒ_t
 
	tšŒ_t
;

239 
	#__šŒ_t_defšed


	)

243 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


244 #iâdeà
__sockËn_t_defšed


245 
__sockËn_t
 
	tsockËn_t
;

246 
	#__sockËn_t_defšed


	)

252 
	#R_OK
 4

	)

253 
	#W_OK
 2

	)

254 
	#X_OK
 1

	)

255 
	#F_OK
 0

	)

258 
	$acûss
 (
__cÚ¡
 *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

260 #ifdeà
__USE_GNU


263 
	$euidacûss
 (
__cÚ¡
 *
__Çme
, 
__ty³
)

264 
__THROW
 
	`__nÚnuÎ
 ((1));

267 
	$—cûss
 (
__cÚ¡
 *
__Çme
, 
__ty³
)

268 
__THROW
 
	`__nÚnuÎ
 ((1));

271 #ifdeà
__USE_ATFILE


275 
	$çcûs§t
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__ty³
, 
__æag
)

276 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

281 #iâdef 
_STDIO_H


282 
	#SEEK_SET
 0

	)

283 
	#SEEK_CUR
 1

	)

284 
	#SEEK_END
 2

	)

287 #ià
defšed
 
__USE_BSD
 && !defšed 
L_SET


289 
	#L_SET
 
SEEK_SET


	)

290 
	#L_INCR
 
SEEK_CUR


	)

291 
	#L_XTND
 
SEEK_END


	)

300 #iâdeà
__USE_FILE_OFFSET64


301 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

303 #ifdeà
__REDIRECT_NTH


304 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

305 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

306 
l£ek64
);

308 
	#l£ek
 
l£ek64


	)

311 #ifdeà
__USE_LARGEFILE64


312 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

313 
__THROW
;

320 
	`şo£
 (
__fd
);

327 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

333 
ssize_t
 
	$wr™e
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
è
__wur
;

335 #ifdeà
__USE_UNIX98


336 #iâdeà
__USE_FILE_OFFSET64


343 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

344 
__off_t
 
__off£t
è
__wur
;

351 
ssize_t
 
	$pwr™e
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
,

352 
__off_t
 
__off£t
è
__wur
;

354 #ifdeà
__REDIRECT


355 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

356 
__off64_t
 
__off£t
),

357 
´—d64
è
__wur
;

358 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, 
__cÚ¡
 *
__buf
,

359 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

360 
pwr™e64
è
__wur
;

362 
	#´—d
 
´—d64


	)

363 
	#pwr™e
 
pwr™e64


	)

367 #ifdeà
__USE_LARGEFILE64


371 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

372 
__off64_t
 
__off£t
è
__wur
;

375 
ssize_t
 
	$pwr™e64
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
,

376 
__off64_t
 
__off£t
è
__wur
;

384 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

386 #ifdeà
__USE_GNU


389 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

399 
	$®¬m
 (
__£cÚds
è
__THROW
;

411 
	`¦“p
 (
__£cÚds
);

413 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


418 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

419 
__THROW
;

426 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

435 
	`·u£
 ();

439 
	$chown
 (
__cÚ¡
 *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

440 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

442 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


444 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

449 
	$lchown
 (
__cÚ¡
 *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

450 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

454 #ifdeà
__USE_ATFILE


457 
	$fchowÇt
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__uid_t
 
__owÃr
,

458 
__gid_t
 
__group
, 
__æag
)

459 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

463 
	$chdœ
 (
__cÚ¡
 *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

465 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


467 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

477 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

479 #ifdef 
__USE_GNU


483 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

486 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


490 *
	$g‘wd
 (*
__buf
)

491 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

496 
	$dup
 (
__fd
è
__THROW
 
__wur
;

499 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

501 #ifdeà
__USE_GNU


504 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

508 **
__’vœÚ
;

509 #ifdeà
__USE_GNU


510 **
’vœÚ
;

516 
	$execve
 (
__cÚ¡
 *
__·th
, *__cÚ¡ 
__¬gv
[],

517 *
__cÚ¡
 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1));

519 #ifdeà
__USE_GNU


522 
	$ãxecve
 (
__fd
, *
__cÚ¡
 
__¬gv
[], *__cÚ¡ 
__’vp
[])

523 
__THROW
;

528 
	$execv
 (
__cÚ¡
 *
__·th
, *__cÚ¡ 
__¬gv
[])

529 
__THROW
 
	`__nÚnuÎ
 ((1));

533 
	$exeşe
 (
__cÚ¡
 *
__·th
, __cÚ¡ *
__¬g
, ...)

534 
__THROW
 
	`__nÚnuÎ
 ((1));

538 
	$exeş
 (
__cÚ¡
 *
__·th
, __cÚ¡ *
__¬g
, ...)

539 
__THROW
 
	`__nÚnuÎ
 ((1));

543 
	$execvp
 (
__cÚ¡
 *
__fe
, *__cÚ¡ 
__¬gv
[])

544 
__THROW
 
	`__nÚnuÎ
 ((1));

549 
	$exeşp
 (
__cÚ¡
 *
__fe
, __cÚ¡ *
__¬g
, ...)

550 
__THROW
 
	`__nÚnuÎ
 ((1));

553 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


555 
	$niû
 (
__šc
è
__THROW
 
__wur
;

560 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

566 
	~<b™s/cÚâame.h
>

569 
	$·thcÚf
 (
__cÚ¡
 *
__·th
, 
__Çme
)

570 
__THROW
 
	`__nÚnuÎ
 ((1));

573 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

576 
	$syscÚf
 (
__Çme
è
__THROW
;

578 #ifdef 
__USE_POSIX2


580 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

585 
__pid_t
 
	$g‘pid
 (è
__THROW
;

588 
__pid_t
 
	$g‘µid
 (è
__THROW
;

592 #iâdeà
__FAVOR_BSD


593 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

595 #ifdeà
__REDIRECT_NTH


596 
__pid_t
 
	`__REDIRECT_NTH
 (
g‘pg½
, (__pid_ˆ
__pid
), 
__g‘pgid
);

598 
	#g‘pg½
 
__g‘pgid


	)

603 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

604 #ifdeà
__USE_XOPEN_EXTENDED


605 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

612 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

614 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


625 #iâdeà
__FAVOR_BSD


629 
	$£g½
 (è
__THROW
;

634 #ifdeà
__REDIRECT_NTH


635 
	`__REDIRECT_NTH
 (
£g½
, (
__pid_t
 
__pid
, __pid_ˆ
__pg½
), 
£gid
);

637 
	#£g½
 
£gid


	)

646 
__pid_t
 
	$£tsid
 (è
__THROW
;

648 #ifdeà
__USE_XOPEN_EXTENDED


650 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

654 
__uid_t
 
	$g‘uid
 (è
__THROW
;

657 
__uid_t
 
	$g‘euid
 (è
__THROW
;

660 
__gid_t
 
	$g‘gid
 (è
__THROW
;

663 
__gid_t
 
	$g‘egid
 (è
__THROW
;

668 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

670 #ifdef 
__USE_GNU


672 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

679 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
;

681 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


684 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
;

687 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


689 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
;

696 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
;

698 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


701 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
;

704 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


706 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
;

709 #ifdeà
__USE_GNU


712 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

713 
__THROW
;

717 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

718 
__THROW
;

722 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

723 
__THROW
;

727 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

728 
__THROW
;

735 
__pid_t
 
	$fÜk
 (è
__THROW
;

737 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


742 
__pid_t
 
	$vfÜk
 (è
__THROW
;

748 *
	$‰yÇme
 (
__fd
è
__THROW
;

752 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

753 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

757 
	$i§‰y
 (
__fd
è
__THROW
;

759 #ià
defšed
 
__USE_BSD
 \

760 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_UNIX98
)

763 
	$‰y¦Ù
 (è
__THROW
;

768 
	$lšk
 (
__cÚ¡
 *
__äom
, __cÚ¡ *
__to
)

769 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

771 #ifdeà
__USE_ATFILE


774 
	$lšk©
 (
__äomfd
, 
__cÚ¡
 *
__äom
, 
__tofd
,

775 
__cÚ¡
 *
__to
, 
__æags
)

776 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

779 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


781 
	$symlšk
 (
__cÚ¡
 *
__äom
, __cÚ¡ *
__to
)

782 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

787 
ssize_t
 
	$»adlšk
 (
__cÚ¡
 *
__»¡riù
 
__·th
,

788 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

789 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

792 #ifdeà
__USE_ATFILE


794 
	$symlšk©
 (
__cÚ¡
 *
__äom
, 
__tofd
,

795 
__cÚ¡
 *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

798 
ssize_t
 
	$»adlšk©
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

799 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

800 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

804 
	$uÆšk
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

806 #ifdeà
__USE_ATFILE


808 
	$uÆšk©
 (
__fd
, 
__cÚ¡
 *
__Çme
, 
__æag
)

809 
__THROW
 
	`__nÚnuÎ
 ((2));

813 
	$rmdœ
 (
__cÚ¡
 *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

817 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

820 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

827 *
	`g‘logš
 ();

828 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


835 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

838 #ifdef 
__USE_BSD


840 
	$£ogš
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

844 #ifdef 
__USE_POSIX2


848 
	#__Ãed_g‘İt


	)

849 
	~<g‘İt.h
>

853 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98


857 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

861 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

864 
	$£tho¡Çme
 (
__cÚ¡
 *
__Çme
, 
size_t
 
__Ën
)

865 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

869 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

875 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

876 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

877 
	$£tdomašÇme
 (
__cÚ¡
 *
__Çme
, 
size_t
 
__Ën
)

878 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

884 
	$vhªgup
 (è
__THROW
;

887 
	$»voke
 (
__cÚ¡
 *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

895 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

896 
size_t
 
__off£t
, 
__sÿË
)

897 
__THROW
 
	`__nÚnuÎ
 ((1));

903 
	$acù
 (
__cÚ¡
 *
__Çme
è
__THROW
;

907 *
	$g‘u£rsh–l
 (è
__THROW
;

908 
	$’du£rsh–l
 (è
__THROW
;

909 
	$£tu£rsh–l
 (è
__THROW
;

915 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

919 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

922 
	$chroÙ
 (
__cÚ¡
 *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

926 *
	$g‘·ss
 (
__cÚ¡
 *
__´om±
è
	`__nÚnuÎ
 ((1));

930 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


935 
	`fsync
 (
__fd
);

939 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


942 
	`g‘ho¡id
 ();

945 
	$sync
 (è
__THROW
;

950 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

955 
	$g‘dbËsize
 (è
__THROW
;

959 #iâdeà
__USE_FILE_OFFSET64


960 
	$Œunÿ‹
 (
__cÚ¡
 *
__fe
, 
__off_t
 
__Ëngth
)

961 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

963 #ifdeà
__REDIRECT_NTH


964 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

965 (
__cÚ¡
 *
__fe
, 
__off64_t
 
__Ëngth
),

966 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

968 
	#Œunÿ‹
 
Œunÿ‹64


	)

971 #ifdeà
__USE_LARGEFILE64


972 
	$Œunÿ‹64
 (
__cÚ¡
 *
__fe
, 
__off64_t
 
__Ëngth
)

973 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

978 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


981 #iâdeà
__USE_FILE_OFFSET64


982 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

984 #ifdeà
__REDIRECT_NTH


985 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

986 
árunÿ‹64
è
__wur
;

988 
	#árunÿ‹
 
árunÿ‹64


	)

991 #ifdeà
__USE_LARGEFILE64


992 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

998 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


1002 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1008 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1012 #ifdeà
__USE_MISC


1023 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1028 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1040 
	#F_ULOCK
 0

	)

1041 
	#F_LOCK
 1

	)

1042 
	#F_TLOCK
 2

	)

1043 
	#F_TEST
 3

	)

1045 #iâdeà
__USE_FILE_OFFSET64


1046 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1048 #ifdeà
__REDIRECT


1049 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1050 
lockf64
è
__wur
;

1052 
	#lockf
 
lockf64


	)

1055 #ifdeà
__USE_LARGEFILE64


1056 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1061 #ifdeà
__USE_GNU


1066 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1067 (
__ex‹nsiÚ__
 \

1068 ({ 
__»suÉ
; \

1069 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1070 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1071 
__»suÉ
; 
	}
}))

	)

1074 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1077 
fd©async
 (
__fdes
);

1083 #ifdef 
__USE_XOPEN


1085 *
	$üy±
 (
__cÚ¡
 *
__key
, __cÚ¡ *
__§É
)

1086 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1090 
	$’üy±
 (*
__block
, 
__edæag
è
__THROW
 
	`__nÚnuÎ
 ((1));

1097 
	$swab
 (
__cÚ¡
 *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1098 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1104 #ifdeà
__USE_XOPEN


1106 *
	$ù”mid
 (*
__s
è
__THROW
;

1111 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


1112 
	~<b™s/uni¡d.h
>

1115 
__END_DECLS


	@/usr/include/alloca.h

19 #iâdef 
_ALLOCA_H


20 
	#_ALLOCA_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	#__Ãed_size_t


	)

25 
	~<¡ddef.h
>

27 
	g__BEGIN_DECLS


30 #undeà
®loÿ


33 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

35 #ifdef 
__GNUC__


36 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

39 
__END_DECLS


	@/usr/include/asm-generic/int-ll64.h

8 #iâdeà
_ASM_GENERIC_INT_LL64_H


9 
	#_ASM_GENERIC_INT_LL64_H


	)

11 #iâdeà
__ASSEMBLY__


17 
__sigÃd__
 
	t__s8
;

18 
	t__u8
;

20 
__sigÃd__
 
	t__s16
;

21 
	t__u16
;

23 
__sigÃd__
 
	t__s32
;

24 
	t__u32
;

26 #ifdeà
__GNUC__


27 
__ex‹nsiÚ__
 
__sigÃd__
 
	t__s64
;

28 
__ex‹nsiÚ__
 
	t__u64
;

30 
__sigÃd__
 
	t__s64
;

31 
	t__u64
;

	@/usr/include/asm/unistd.h

1 #ifdeà
__i386__


2 
	~"uni¡d_32.h
"

4 
	~"uni¡d_64.h
"

	@/usr/include/bits/byteswap.h

21 #ià!
defšed
 
_BYTESWAP_H
 && !defšed 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


25 #iâdeà
_BITS_BYTESWAP_H


26 
	#_BITS_BYTESWAP_H
 1

	)

28 
	~<b™s/wÜdsize.h
>

31 
	#__bsw­_cÚ¡ªt_16
(
x
) \

32 ((((
x
è>> 8è& 0xffè| (((xè& 0xffè<< 8))

	)

34 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

35 
	#__bsw­_16
(
x
) \

36 (
__ex‹nsiÚ__
 \

37 ({ 
__v
, 
__x
 = (
x
); \

38 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

39 
__v
 = 
	`__bsw­_cÚ¡ªt_16
 (
__x
); \

41 
	`__asm__
 ("rorw $8, %w0" \

42 : "ô" (
__v
) \

43 : "0" (
__x
) \

45 
__v
; }))

	)

48 
	#__bsw­_16
(
x
) \

49 (
__ex‹nsiÚ__
 \

50 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_16
 (__x); }))

	)

55 
	#__bsw­_cÚ¡ªt_32
(
x
) \

56 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

57 (((
x
è& 0x0000ff00è<< 8è| (((xè& 0x000000ffè<< 24))

	)

59 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

60 #ià
__WORDSIZE
 =ğ64 || (
defšed
 
__i486__
 || defšed 
__³Áium__
 \

61 || 
defšed
 
	g__³Áium´o__
 || defšed 
	g__³Áium4__
 \

62 || 
defšed
 
	g__k8__
 || defšed 
	g__©hlÚ__
 \

63 || 
defšed
 
	g__k6__
 || defšed 
	g__nocÚa__
 \

64 || 
defšed
 
	g__cÜe2__
 || defšed 
	g__geode__
 \

65 || 
defšed
 
	g__amdçm10__
)

68 
	#__bsw­_32
(
x
) \

69 (
__ex‹nsiÚ__
 \

70 ({ 
__v
, 
__x
 = (
x
); \

71 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

72 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

74 
	`__asm__
 ("bsw­ %0" : "ô" (
__v
è: "0" (
__x
)); \

75 
__v
; }))

	)

77 
	#__bsw­_32
(
x
) \

78 (
__ex‹nsiÚ__
 \

79 ({ 
__v
, 
__x
 = (
x
); \

80 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

81 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

83 
	`__asm__
 ("rorw $8, %w0;" \

86 : "ô" (
__v
) \

87 : "0" (
__x
) \

89 
__v
; }))

	)

92 
	#__bsw­_32
(
x
) \

93 (
__ex‹nsiÚ__
 \

94 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_32
 (__x); }))

	)

98 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

100 
	#__bsw­_cÚ¡ªt_64
(
x
) \

101 ((((
x
) & 0xff00000000000000ull) >> 56) \

102 | (((
x
) & 0x00ff000000000000ull) >> 40) \

103 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

104 | (((
x
) & 0x000000ff00000000ull) >> 8) \

105 | (((
x
) & 0x00000000ff000000ull) << 8) \

106 | (((
x
) & 0x0000000000ff0000ull) << 24) \

107 | (((
x
) & 0x000000000000ff00ull) << 40) \

108 | (((
x
è& 0x00000000000000ffuÎè<< 56))

	)

110 #ià
__WORDSIZE
 == 64

111 
	#__bsw­_64
(
x
) \

112 (
__ex‹nsiÚ__
 \

113 ({ 
__v
, 
__x
 = (
x
); \

114 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

115 
__v
 = 
	`__bsw­_cÚ¡ªt_64
 (
__x
); \

117 
	`__asm__
 ("bsw­ %q0" : "ô" (
__v
è: "0" (
__x
)); \

118 
__v
; }))

	)

120 
	#__bsw­_64
(
x
) \

121 (
__ex‹nsiÚ__
 \

122 ({ uniÚ { 
__ex‹nsiÚ__
 
__Î
; \

123 
__l
[2]; } 
__w
, 
__r
; \

124 ià(
	`__butš_cÚ¡ªt_p
 (
x
)) \

125 
__r
.
__Î
 = 
	`__bsw­_cÚ¡ªt_64
 (
x
); \

128 
__w
.
__Î
 = (
x
); \

129 
__r
.
__l
[0] = 
	`__bsw­_32
 (
__w
.__l[1]); \

130 
__r
.
__l
[1] = 
	`__bsw­_32
 (
__w
.__l[0]); \

132 
__r
.
__Î
; }))

	)

	@/usr/include/bits/confname.h

21 #iâdeà
_UNISTD_H


28 
	m_PC_LINK_MAX
,

29 
	#_PC_LINK_MAX
 
_PC_LINK_MAX


	)

30 
	m_PC_MAX_CANON
,

31 
	#_PC_MAX_CANON
 
_PC_MAX_CANON


	)

32 
	m_PC_MAX_INPUT
,

33 
	#_PC_MAX_INPUT
 
_PC_MAX_INPUT


	)

34 
	m_PC_NAME_MAX
,

35 
	#_PC_NAME_MAX
 
_PC_NAME_MAX


	)

36 
	m_PC_PATH_MAX
,

37 
	#_PC_PATH_MAX
 
_PC_PATH_MAX


	)

38 
	m_PC_PIPE_BUF
,

39 
	#_PC_PIPE_BUF
 
_PC_PIPE_BUF


	)

40 
	m_PC_CHOWN_RESTRICTED
,

41 
	#_PC_CHOWN_RESTRICTED
 
_PC_CHOWN_RESTRICTED


	)

42 
	m_PC_NO_TRUNC
,

43 
	#_PC_NO_TRUNC
 
_PC_NO_TRUNC


	)

44 
	m_PC_VDISABLE
,

45 
	#_PC_VDISABLE
 
_PC_VDISABLE


	)

46 
	m_PC_SYNC_IO
,

47 
	#_PC_SYNC_IO
 
_PC_SYNC_IO


	)

48 
	m_PC_ASYNC_IO
,

49 
	#_PC_ASYNC_IO
 
_PC_ASYNC_IO


	)

50 
	m_PC_PRIO_IO
,

51 
	#_PC_PRIO_IO
 
_PC_PRIO_IO


	)

52 
	m_PC_SOCK_MAXBUF
,

53 
	#_PC_SOCK_MAXBUF
 
_PC_SOCK_MAXBUF


	)

54 
	m_PC_FILESIZEBITS
,

55 
	#_PC_FILESIZEBITS
 
_PC_FILESIZEBITS


	)

56 
	m_PC_REC_INCR_XFER_SIZE
,

57 
	#_PC_REC_INCR_XFER_SIZE
 
_PC_REC_INCR_XFER_SIZE


	)

58 
	m_PC_REC_MAX_XFER_SIZE
,

59 
	#_PC_REC_MAX_XFER_SIZE
 
_PC_REC_MAX_XFER_SIZE


	)

60 
	m_PC_REC_MIN_XFER_SIZE
,

61 
	#_PC_REC_MIN_XFER_SIZE
 
_PC_REC_MIN_XFER_SIZE


	)

62 
	m_PC_REC_XFER_ALIGN
,

63 
	#_PC_REC_XFER_ALIGN
 
_PC_REC_XFER_ALIGN


	)

64 
	m_PC_ALLOC_SIZE_MIN
,

65 
	#_PC_ALLOC_SIZE_MIN
 
_PC_ALLOC_SIZE_MIN


	)

66 
	m_PC_SYMLINK_MAX
,

67 
	#_PC_SYMLINK_MAX
 
_PC_SYMLINK_MAX


	)

68 
	m_PC_2_SYMLINKS


69 
	#_PC_2_SYMLINKS
 
_PC_2_SYMLINKS


	)

75 
	m_SC_ARG_MAX
,

76 
	#_SC_ARG_MAX
 
_SC_ARG_MAX


	)

77 
	m_SC_CHILD_MAX
,

78 
	#_SC_CHILD_MAX
 
_SC_CHILD_MAX


	)

79 
	m_SC_CLK_TCK
,

80 
	#_SC_CLK_TCK
 
_SC_CLK_TCK


	)

81 
	m_SC_NGROUPS_MAX
,

82 
	#_SC_NGROUPS_MAX
 
_SC_NGROUPS_MAX


	)

83 
	m_SC_OPEN_MAX
,

84 
	#_SC_OPEN_MAX
 
_SC_OPEN_MAX


	)

85 
	m_SC_STREAM_MAX
,

86 
	#_SC_STREAM_MAX
 
_SC_STREAM_MAX


	)

87 
	m_SC_TZNAME_MAX
,

88 
	#_SC_TZNAME_MAX
 
_SC_TZNAME_MAX


	)

89 
	m_SC_JOB_CONTROL
,

90 
	#_SC_JOB_CONTROL
 
_SC_JOB_CONTROL


	)

91 
	m_SC_SAVED_IDS
,

92 
	#_SC_SAVED_IDS
 
_SC_SAVED_IDS


	)

93 
	m_SC_REALTIME_SIGNALS
,

94 
	#_SC_REALTIME_SIGNALS
 
_SC_REALTIME_SIGNALS


	)

95 
	m_SC_PRIORITY_SCHEDULING
,

96 
	#_SC_PRIORITY_SCHEDULING
 
_SC_PRIORITY_SCHEDULING


	)

97 
	m_SC_TIMERS
,

98 
	#_SC_TIMERS
 
_SC_TIMERS


	)

99 
	m_SC_ASYNCHRONOUS_IO
,

100 
	#_SC_ASYNCHRONOUS_IO
 
_SC_ASYNCHRONOUS_IO


	)

101 
	m_SC_PRIORITIZED_IO
,

102 
	#_SC_PRIORITIZED_IO
 
_SC_PRIORITIZED_IO


	)

103 
	m_SC_SYNCHRONIZED_IO
,

104 
	#_SC_SYNCHRONIZED_IO
 
_SC_SYNCHRONIZED_IO


	)

105 
	m_SC_FSYNC
,

106 
	#_SC_FSYNC
 
_SC_FSYNC


	)

107 
	m_SC_MAPPED_FILES
,

108 
	#_SC_MAPPED_FILES
 
_SC_MAPPED_FILES


	)

109 
	m_SC_MEMLOCK
,

110 
	#_SC_MEMLOCK
 
_SC_MEMLOCK


	)

111 
	m_SC_MEMLOCK_RANGE
,

112 
	#_SC_MEMLOCK_RANGE
 
_SC_MEMLOCK_RANGE


	)

113 
	m_SC_MEMORY_PROTECTION
,

114 
	#_SC_MEMORY_PROTECTION
 
_SC_MEMORY_PROTECTION


	)

115 
	m_SC_MESSAGE_PASSING
,

116 
	#_SC_MESSAGE_PASSING
 
_SC_MESSAGE_PASSING


	)

117 
	m_SC_SEMAPHORES
,

118 
	#_SC_SEMAPHORES
 
_SC_SEMAPHORES


	)

119 
	m_SC_SHARED_MEMORY_OBJECTS
,

120 
	#_SC_SHARED_MEMORY_OBJECTS
 
_SC_SHARED_MEMORY_OBJECTS


	)

121 
	m_SC_AIO_LISTIO_MAX
,

122 
	#_SC_AIO_LISTIO_MAX
 
_SC_AIO_LISTIO_MAX


	)

123 
	m_SC_AIO_MAX
,

124 
	#_SC_AIO_MAX
 
_SC_AIO_MAX


	)

125 
	m_SC_AIO_PRIO_DELTA_MAX
,

126 
	#_SC_AIO_PRIO_DELTA_MAX
 
_SC_AIO_PRIO_DELTA_MAX


	)

127 
	m_SC_DELAYTIMER_MAX
,

128 
	#_SC_DELAYTIMER_MAX
 
_SC_DELAYTIMER_MAX


	)

129 
	m_SC_MQ_OPEN_MAX
,

130 
	#_SC_MQ_OPEN_MAX
 
_SC_MQ_OPEN_MAX


	)

131 
	m_SC_MQ_PRIO_MAX
,

132 
	#_SC_MQ_PRIO_MAX
 
_SC_MQ_PRIO_MAX


	)

133 
	m_SC_VERSION
,

134 
	#_SC_VERSION
 
_SC_VERSION


	)

135 
	m_SC_PAGESIZE
,

136 
	#_SC_PAGESIZE
 
_SC_PAGESIZE


	)

137 
	#_SC_PAGE_SIZE
 
_SC_PAGESIZE


	)

138 
	m_SC_RTSIG_MAX
,

139 
	#_SC_RTSIG_MAX
 
_SC_RTSIG_MAX


	)

140 
	m_SC_SEM_NSEMS_MAX
,

141 
	#_SC_SEM_NSEMS_MAX
 
_SC_SEM_NSEMS_MAX


	)

142 
	m_SC_SEM_VALUE_MAX
,

143 
	#_SC_SEM_VALUE_MAX
 
_SC_SEM_VALUE_MAX


	)

144 
	m_SC_SIGQUEUE_MAX
,

145 
	#_SC_SIGQUEUE_MAX
 
_SC_SIGQUEUE_MAX


	)

146 
	m_SC_TIMER_MAX
,

147 
	#_SC_TIMER_MAX
 
_SC_TIMER_MAX


	)

151 
	m_SC_BC_BASE_MAX
,

152 
	#_SC_BC_BASE_MAX
 
_SC_BC_BASE_MAX


	)

153 
	m_SC_BC_DIM_MAX
,

154 
	#_SC_BC_DIM_MAX
 
_SC_BC_DIM_MAX


	)

155 
	m_SC_BC_SCALE_MAX
,

156 
	#_SC_BC_SCALE_MAX
 
_SC_BC_SCALE_MAX


	)

157 
	m_SC_BC_STRING_MAX
,

158 
	#_SC_BC_STRING_MAX
 
_SC_BC_STRING_MAX


	)

159 
	m_SC_COLL_WEIGHTS_MAX
,

160 
	#_SC_COLL_WEIGHTS_MAX
 
_SC_COLL_WEIGHTS_MAX


	)

161 
	m_SC_EQUIV_CLASS_MAX
,

162 
	#_SC_EQUIV_CLASS_MAX
 
_SC_EQUIV_CLASS_MAX


	)

163 
	m_SC_EXPR_NEST_MAX
,

164 
	#_SC_EXPR_NEST_MAX
 
_SC_EXPR_NEST_MAX


	)

165 
	m_SC_LINE_MAX
,

166 
	#_SC_LINE_MAX
 
_SC_LINE_MAX


	)

167 
	m_SC_RE_DUP_MAX
,

168 
	#_SC_RE_DUP_MAX
 
_SC_RE_DUP_MAX


	)

169 
	m_SC_CHARCLASS_NAME_MAX
,

170 
	#_SC_CHARCLASS_NAME_MAX
 
_SC_CHARCLASS_NAME_MAX


	)

172 
	m_SC_2_VERSION
,

173 
	#_SC_2_VERSION
 
_SC_2_VERSION


	)

174 
	m_SC_2_C_BIND
,

175 
	#_SC_2_C_BIND
 
_SC_2_C_BIND


	)

176 
	m_SC_2_C_DEV
,

177 
	#_SC_2_C_DEV
 
_SC_2_C_DEV


	)

178 
	m_SC_2_FORT_DEV
,

179 
	#_SC_2_FORT_DEV
 
_SC_2_FORT_DEV


	)

180 
	m_SC_2_FORT_RUN
,

181 
	#_SC_2_FORT_RUN
 
_SC_2_FORT_RUN


	)

182 
	m_SC_2_SW_DEV
,

183 
	#_SC_2_SW_DEV
 
_SC_2_SW_DEV


	)

184 
	m_SC_2_LOCALEDEF
,

185 
	#_SC_2_LOCALEDEF
 
_SC_2_LOCALEDEF


	)

187 
	m_SC_PII
,

188 
	#_SC_PII
 
_SC_PII


	)

189 
	m_SC_PII_XTI
,

190 
	#_SC_PII_XTI
 
_SC_PII_XTI


	)

191 
	m_SC_PII_SOCKET
,

192 
	#_SC_PII_SOCKET
 
_SC_PII_SOCKET


	)

193 
	m_SC_PII_INTERNET
,

194 
	#_SC_PII_INTERNET
 
_SC_PII_INTERNET


	)

195 
	m_SC_PII_OSI
,

196 
	#_SC_PII_OSI
 
_SC_PII_OSI


	)

197 
	m_SC_POLL
,

198 
	#_SC_POLL
 
_SC_POLL


	)

199 
	m_SC_SELECT
,

200 
	#_SC_SELECT
 
_SC_SELECT


	)

201 
	m_SC_UIO_MAXIOV
,

202 
	#_SC_UIO_MAXIOV
 
_SC_UIO_MAXIOV


	)

203 
	m_SC_IOV_MAX
 = 
_SC_UIO_MAXIOV
,

204 
	#_SC_IOV_MAX
 
_SC_IOV_MAX


	)

205 
	m_SC_PII_INTERNET_STREAM
,

206 
	#_SC_PII_INTERNET_STREAM
 
_SC_PII_INTERNET_STREAM


	)

207 
	m_SC_PII_INTERNET_DGRAM
,

208 
	#_SC_PII_INTERNET_DGRAM
 
_SC_PII_INTERNET_DGRAM


	)

209 
	m_SC_PII_OSI_COTS
,

210 
	#_SC_PII_OSI_COTS
 
_SC_PII_OSI_COTS


	)

211 
	m_SC_PII_OSI_CLTS
,

212 
	#_SC_PII_OSI_CLTS
 
_SC_PII_OSI_CLTS


	)

213 
	m_SC_PII_OSI_M
,

214 
	#_SC_PII_OSI_M
 
_SC_PII_OSI_M


	)

215 
	m_SC_T_IOV_MAX
,

216 
	#_SC_T_IOV_MAX
 
_SC_T_IOV_MAX


	)

219 
	m_SC_THREADS
,

220 
	#_SC_THREADS
 
_SC_THREADS


	)

221 
	m_SC_THREAD_SAFE_FUNCTIONS
,

222 
	#_SC_THREAD_SAFE_FUNCTIONS
 
_SC_THREAD_SAFE_FUNCTIONS


	)

223 
	m_SC_GETGR_R_SIZE_MAX
,

224 
	#_SC_GETGR_R_SIZE_MAX
 
_SC_GETGR_R_SIZE_MAX


	)

225 
	m_SC_GETPW_R_SIZE_MAX
,

226 
	#_SC_GETPW_R_SIZE_MAX
 
_SC_GETPW_R_SIZE_MAX


	)

227 
	m_SC_LOGIN_NAME_MAX
,

228 
	#_SC_LOGIN_NAME_MAX
 
_SC_LOGIN_NAME_MAX


	)

229 
	m_SC_TTY_NAME_MAX
,

230 
	#_SC_TTY_NAME_MAX
 
_SC_TTY_NAME_MAX


	)

231 
	m_SC_THREAD_DESTRUCTOR_ITERATIONS
,

232 
	#_SC_THREAD_DESTRUCTOR_ITERATIONS
 
_SC_THREAD_DESTRUCTOR_ITERATIONS


	)

233 
	m_SC_THREAD_KEYS_MAX
,

234 
	#_SC_THREAD_KEYS_MAX
 
_SC_THREAD_KEYS_MAX


	)

235 
	m_SC_THREAD_STACK_MIN
,

236 
	#_SC_THREAD_STACK_MIN
 
_SC_THREAD_STACK_MIN


	)

237 
	m_SC_THREAD_THREADS_MAX
,

238 
	#_SC_THREAD_THREADS_MAX
 
_SC_THREAD_THREADS_MAX


	)

239 
	m_SC_THREAD_ATTR_STACKADDR
,

240 
	#_SC_THREAD_ATTR_STACKADDR
 
_SC_THREAD_ATTR_STACKADDR


	)

241 
	m_SC_THREAD_ATTR_STACKSIZE
,

242 
	#_SC_THREAD_ATTR_STACKSIZE
 
_SC_THREAD_ATTR_STACKSIZE


	)

243 
	m_SC_THREAD_PRIORITY_SCHEDULING
,

244 
	#_SC_THREAD_PRIORITY_SCHEDULING
 
_SC_THREAD_PRIORITY_SCHEDULING


	)

245 
	m_SC_THREAD_PRIO_INHERIT
,

246 
	#_SC_THREAD_PRIO_INHERIT
 
_SC_THREAD_PRIO_INHERIT


	)

247 
	m_SC_THREAD_PRIO_PROTECT
,

248 
	#_SC_THREAD_PRIO_PROTECT
 
_SC_THREAD_PRIO_PROTECT


	)

249 
	m_SC_THREAD_PROCESS_SHARED
,

250 
	#_SC_THREAD_PROCESS_SHARED
 
_SC_THREAD_PROCESS_SHARED


	)

252 
	m_SC_NPROCESSORS_CONF
,

253 
	#_SC_NPROCESSORS_CONF
 
_SC_NPROCESSORS_CONF


	)

254 
	m_SC_NPROCESSORS_ONLN
,

255 
	#_SC_NPROCESSORS_ONLN
 
_SC_NPROCESSORS_ONLN


	)

256 
	m_SC_PHYS_PAGES
,

257 
	#_SC_PHYS_PAGES
 
_SC_PHYS_PAGES


	)

258 
	m_SC_AVPHYS_PAGES
,

259 
	#_SC_AVPHYS_PAGES
 
_SC_AVPHYS_PAGES


	)

260 
	m_SC_ATEXIT_MAX
,

261 
	#_SC_ATEXIT_MAX
 
_SC_ATEXIT_MAX


	)

262 
	m_SC_PASS_MAX
,

263 
	#_SC_PASS_MAX
 
_SC_PASS_MAX


	)

265 
	m_SC_XOPEN_VERSION
,

266 
	#_SC_XOPEN_VERSION
 
_SC_XOPEN_VERSION


	)

267 
	m_SC_XOPEN_XCU_VERSION
,

268 
	#_SC_XOPEN_XCU_VERSION
 
_SC_XOPEN_XCU_VERSION


	)

269 
	m_SC_XOPEN_UNIX
,

270 
	#_SC_XOPEN_UNIX
 
_SC_XOPEN_UNIX


	)

271 
	m_SC_XOPEN_CRYPT
,

272 
	#_SC_XOPEN_CRYPT
 
_SC_XOPEN_CRYPT


	)

273 
	m_SC_XOPEN_ENH_I18N
,

274 
	#_SC_XOPEN_ENH_I18N
 
_SC_XOPEN_ENH_I18N


	)

275 
	m_SC_XOPEN_SHM
,

276 
	#_SC_XOPEN_SHM
 
_SC_XOPEN_SHM


	)

278 
	m_SC_2_CHAR_TERM
,

279 
	#_SC_2_CHAR_TERM
 
_SC_2_CHAR_TERM


	)

280 
	m_SC_2_C_VERSION
,

281 
	#_SC_2_C_VERSION
 
_SC_2_C_VERSION


	)

282 
	m_SC_2_UPE
,

283 
	#_SC_2_UPE
 
_SC_2_UPE


	)

285 
	m_SC_XOPEN_XPG2
,

286 
	#_SC_XOPEN_XPG2
 
_SC_XOPEN_XPG2


	)

287 
	m_SC_XOPEN_XPG3
,

288 
	#_SC_XOPEN_XPG3
 
_SC_XOPEN_XPG3


	)

289 
	m_SC_XOPEN_XPG4
,

290 
	#_SC_XOPEN_XPG4
 
_SC_XOPEN_XPG4


	)

292 
	m_SC_CHAR_BIT
,

293 
	#_SC_CHAR_BIT
 
_SC_CHAR_BIT


	)

294 
	m_SC_CHAR_MAX
,

295 
	#_SC_CHAR_MAX
 
_SC_CHAR_MAX


	)

296 
	m_SC_CHAR_MIN
,

297 
	#_SC_CHAR_MIN
 
_SC_CHAR_MIN


	)

298 
	m_SC_INT_MAX
,

299 
	#_SC_INT_MAX
 
_SC_INT_MAX


	)

300 
	m_SC_INT_MIN
,

301 
	#_SC_INT_MIN
 
_SC_INT_MIN


	)

302 
	m_SC_LONG_BIT
,

303 
	#_SC_LONG_BIT
 
_SC_LONG_BIT


	)

304 
	m_SC_WORD_BIT
,

305 
	#_SC_WORD_BIT
 
_SC_WORD_BIT


	)

306 
	m_SC_MB_LEN_MAX
,

307 
	#_SC_MB_LEN_MAX
 
_SC_MB_LEN_MAX


	)

308 
	m_SC_NZERO
,

309 
	#_SC_NZERO
 
_SC_NZERO


	)

310 
	m_SC_SSIZE_MAX
,

311 
	#_SC_SSIZE_MAX
 
_SC_SSIZE_MAX


	)

312 
	m_SC_SCHAR_MAX
,

313 
	#_SC_SCHAR_MAX
 
_SC_SCHAR_MAX


	)

314 
	m_SC_SCHAR_MIN
,

315 
	#_SC_SCHAR_MIN
 
_SC_SCHAR_MIN


	)

316 
	m_SC_SHRT_MAX
,

317 
	#_SC_SHRT_MAX
 
_SC_SHRT_MAX


	)

318 
	m_SC_SHRT_MIN
,

319 
	#_SC_SHRT_MIN
 
_SC_SHRT_MIN


	)

320 
	m_SC_UCHAR_MAX
,

321 
	#_SC_UCHAR_MAX
 
_SC_UCHAR_MAX


	)

322 
	m_SC_UINT_MAX
,

323 
	#_SC_UINT_MAX
 
_SC_UINT_MAX


	)

324 
	m_SC_ULONG_MAX
,

325 
	#_SC_ULONG_MAX
 
_SC_ULONG_MAX


	)

326 
	m_SC_USHRT_MAX
,

327 
	#_SC_USHRT_MAX
 
_SC_USHRT_MAX


	)

329 
	m_SC_NL_ARGMAX
,

330 
	#_SC_NL_ARGMAX
 
_SC_NL_ARGMAX


	)

331 
	m_SC_NL_LANGMAX
,

332 
	#_SC_NL_LANGMAX
 
_SC_NL_LANGMAX


	)

333 
	m_SC_NL_MSGMAX
,

334 
	#_SC_NL_MSGMAX
 
_SC_NL_MSGMAX


	)

335 
	m_SC_NL_NMAX
,

336 
	#_SC_NL_NMAX
 
_SC_NL_NMAX


	)

337 
	m_SC_NL_SETMAX
,

338 
	#_SC_NL_SETMAX
 
_SC_NL_SETMAX


	)

339 
	m_SC_NL_TEXTMAX
,

340 
	#_SC_NL_TEXTMAX
 
_SC_NL_TEXTMAX


	)

342 
	m_SC_XBS5_ILP32_OFF32
,

343 
	#_SC_XBS5_ILP32_OFF32
 
_SC_XBS5_ILP32_OFF32


	)

344 
	m_SC_XBS5_ILP32_OFFBIG
,

345 
	#_SC_XBS5_ILP32_OFFBIG
 
_SC_XBS5_ILP32_OFFBIG


	)

346 
	m_SC_XBS5_LP64_OFF64
,

347 
	#_SC_XBS5_LP64_OFF64
 
_SC_XBS5_LP64_OFF64


	)

348 
	m_SC_XBS5_LPBIG_OFFBIG
,

349 
	#_SC_XBS5_LPBIG_OFFBIG
 
_SC_XBS5_LPBIG_OFFBIG


	)

351 
	m_SC_XOPEN_LEGACY
,

352 
	#_SC_XOPEN_LEGACY
 
_SC_XOPEN_LEGACY


	)

353 
	m_SC_XOPEN_REALTIME
,

354 
	#_SC_XOPEN_REALTIME
 
_SC_XOPEN_REALTIME


	)

355 
	m_SC_XOPEN_REALTIME_THREADS
,

356 
	#_SC_XOPEN_REALTIME_THREADS
 
_SC_XOPEN_REALTIME_THREADS


	)

358 
	m_SC_ADVISORY_INFO
,

359 
	#_SC_ADVISORY_INFO
 
_SC_ADVISORY_INFO


	)

360 
	m_SC_BARRIERS
,

361 
	#_SC_BARRIERS
 
_SC_BARRIERS


	)

362 
	m_SC_BASE
,

363 
	#_SC_BASE
 
_SC_BASE


	)

364 
	m_SC_C_LANG_SUPPORT
,

365 
	#_SC_C_LANG_SUPPORT
 
_SC_C_LANG_SUPPORT


	)

366 
	m_SC_C_LANG_SUPPORT_R
,

367 
	#_SC_C_LANG_SUPPORT_R
 
_SC_C_LANG_SUPPORT_R


	)

368 
	m_SC_CLOCK_SELECTION
,

369 
	#_SC_CLOCK_SELECTION
 
_SC_CLOCK_SELECTION


	)

370 
	m_SC_CPUTIME
,

371 
	#_SC_CPUTIME
 
_SC_CPUTIME


	)

372 
	m_SC_THREAD_CPUTIME
,

373 
	#_SC_THREAD_CPUTIME
 
_SC_THREAD_CPUTIME


	)

374 
	m_SC_DEVICE_IO
,

375 
	#_SC_DEVICE_IO
 
_SC_DEVICE_IO


	)

376 
	m_SC_DEVICE_SPECIFIC
,

377 
	#_SC_DEVICE_SPECIFIC
 
_SC_DEVICE_SPECIFIC


	)

378 
	m_SC_DEVICE_SPECIFIC_R
,

379 
	#_SC_DEVICE_SPECIFIC_R
 
_SC_DEVICE_SPECIFIC_R


	)

380 
	m_SC_FD_MGMT
,

381 
	#_SC_FD_MGMT
 
_SC_FD_MGMT


	)

382 
	m_SC_FIFO
,

383 
	#_SC_FIFO
 
_SC_FIFO


	)

384 
	m_SC_PIPE
,

385 
	#_SC_PIPE
 
_SC_PIPE


	)

386 
	m_SC_FILE_ATTRIBUTES
,

387 
	#_SC_FILE_ATTRIBUTES
 
_SC_FILE_ATTRIBUTES


	)

388 
	m_SC_FILE_LOCKING
,

389 
	#_SC_FILE_LOCKING
 
_SC_FILE_LOCKING


	)

390 
	m_SC_FILE_SYSTEM
,

391 
	#_SC_FILE_SYSTEM
 
_SC_FILE_SYSTEM


	)

392 
	m_SC_MONOTONIC_CLOCK
,

393 
	#_SC_MONOTONIC_CLOCK
 
_SC_MONOTONIC_CLOCK


	)

394 
	m_SC_MULTI_PROCESS
,

395 
	#_SC_MULTI_PROCESS
 
_SC_MULTI_PROCESS


	)

396 
	m_SC_SINGLE_PROCESS
,

397 
	#_SC_SINGLE_PROCESS
 
_SC_SINGLE_PROCESS


	)

398 
	m_SC_NETWORKING
,

399 
	#_SC_NETWORKING
 
_SC_NETWORKING


	)

400 
	m_SC_READER_WRITER_LOCKS
,

401 
	#_SC_READER_WRITER_LOCKS
 
_SC_READER_WRITER_LOCKS


	)

402 
	m_SC_SPIN_LOCKS
,

403 
	#_SC_SPIN_LOCKS
 
_SC_SPIN_LOCKS


	)

404 
	m_SC_REGEXP
,

405 
	#_SC_REGEXP
 
_SC_REGEXP


	)

406 
	m_SC_REGEX_VERSION
,

407 
	#_SC_REGEX_VERSION
 
_SC_REGEX_VERSION


	)

408 
	m_SC_SHELL
,

409 
	#_SC_SHELL
 
_SC_SHELL


	)

410 
	m_SC_SIGNALS
,

411 
	#_SC_SIGNALS
 
_SC_SIGNALS


	)

412 
	m_SC_SPAWN
,

413 
	#_SC_SPAWN
 
_SC_SPAWN


	)

414 
	m_SC_SPORADIC_SERVER
,

415 
	#_SC_SPORADIC_SERVER
 
_SC_SPORADIC_SERVER


	)

416 
	m_SC_THREAD_SPORADIC_SERVER
,

417 
	#_SC_THREAD_SPORADIC_SERVER
 
_SC_THREAD_SPORADIC_SERVER


	)

418 
	m_SC_SYSTEM_DATABASE
,

419 
	#_SC_SYSTEM_DATABASE
 
_SC_SYSTEM_DATABASE


	)

420 
	m_SC_SYSTEM_DATABASE_R
,

421 
	#_SC_SYSTEM_DATABASE_R
 
_SC_SYSTEM_DATABASE_R


	)

422 
	m_SC_TIMEOUTS
,

423 
	#_SC_TIMEOUTS
 
_SC_TIMEOUTS


	)

424 
	m_SC_TYPED_MEMORY_OBJECTS
,

425 
	#_SC_TYPED_MEMORY_OBJECTS
 
_SC_TYPED_MEMORY_OBJECTS


	)

426 
	m_SC_USER_GROUPS
,

427 
	#_SC_USER_GROUPS
 
_SC_USER_GROUPS


	)

428 
	m_SC_USER_GROUPS_R
,

429 
	#_SC_USER_GROUPS_R
 
_SC_USER_GROUPS_R


	)

430 
	m_SC_2_PBS
,

431 
	#_SC_2_PBS
 
_SC_2_PBS


	)

432 
	m_SC_2_PBS_ACCOUNTING
,

433 
	#_SC_2_PBS_ACCOUNTING
 
_SC_2_PBS_ACCOUNTING


	)

434 
	m_SC_2_PBS_LOCATE
,

435 
	#_SC_2_PBS_LOCATE
 
_SC_2_PBS_LOCATE


	)

436 
	m_SC_2_PBS_MESSAGE
,

437 
	#_SC_2_PBS_MESSAGE
 
_SC_2_PBS_MESSAGE


	)

438 
	m_SC_2_PBS_TRACK
,

439 
	#_SC_2_PBS_TRACK
 
_SC_2_PBS_TRACK


	)

440 
	m_SC_SYMLOOP_MAX
,

441 
	#_SC_SYMLOOP_MAX
 
_SC_SYMLOOP_MAX


	)

442 
	m_SC_STREAMS
,

443 
	#_SC_STREAMS
 
_SC_STREAMS


	)

444 
	m_SC_2_PBS_CHECKPOINT
,

445 
	#_SC_2_PBS_CHECKPOINT
 
_SC_2_PBS_CHECKPOINT


	)

447 
	m_SC_V6_ILP32_OFF32
,

448 
	#_SC_V6_ILP32_OFF32
 
_SC_V6_ILP32_OFF32


	)

449 
	m_SC_V6_ILP32_OFFBIG
,

450 
	#_SC_V6_ILP32_OFFBIG
 
_SC_V6_ILP32_OFFBIG


	)

451 
	m_SC_V6_LP64_OFF64
,

452 
	#_SC_V6_LP64_OFF64
 
_SC_V6_LP64_OFF64


	)

453 
	m_SC_V6_LPBIG_OFFBIG
,

454 
	#_SC_V6_LPBIG_OFFBIG
 
_SC_V6_LPBIG_OFFBIG


	)

456 
	m_SC_HOST_NAME_MAX
,

457 
	#_SC_HOST_NAME_MAX
 
_SC_HOST_NAME_MAX


	)

458 
	m_SC_TRACE
,

459 
	#_SC_TRACE
 
_SC_TRACE


	)

460 
	m_SC_TRACE_EVENT_FILTER
,

461 
	#_SC_TRACE_EVENT_FILTER
 
_SC_TRACE_EVENT_FILTER


	)

462 
	m_SC_TRACE_INHERIT
,

463 
	#_SC_TRACE_INHERIT
 
_SC_TRACE_INHERIT


	)

464 
	m_SC_TRACE_LOG
,

465 
	#_SC_TRACE_LOG
 
_SC_TRACE_LOG


	)

467 
	m_SC_LEVEL1_ICACHE_SIZE
,

468 
	#_SC_LEVEL1_ICACHE_SIZE
 
_SC_LEVEL1_ICACHE_SIZE


	)

469 
	m_SC_LEVEL1_ICACHE_ASSOC
,

470 
	#_SC_LEVEL1_ICACHE_ASSOC
 
_SC_LEVEL1_ICACHE_ASSOC


	)

471 
	m_SC_LEVEL1_ICACHE_LINESIZE
,

472 
	#_SC_LEVEL1_ICACHE_LINESIZE
 
_SC_LEVEL1_ICACHE_LINESIZE


	)

473 
	m_SC_LEVEL1_DCACHE_SIZE
,

474 
	#_SC_LEVEL1_DCACHE_SIZE
 
_SC_LEVEL1_DCACHE_SIZE


	)

475 
	m_SC_LEVEL1_DCACHE_ASSOC
,

476 
	#_SC_LEVEL1_DCACHE_ASSOC
 
_SC_LEVEL1_DCACHE_ASSOC


	)

477 
	m_SC_LEVEL1_DCACHE_LINESIZE
,

478 
	#_SC_LEVEL1_DCACHE_LINESIZE
 
_SC_LEVEL1_DCACHE_LINESIZE


	)

479 
	m_SC_LEVEL2_CACHE_SIZE
,

480 
	#_SC_LEVEL2_CACHE_SIZE
 
_SC_LEVEL2_CACHE_SIZE


	)

481 
	m_SC_LEVEL2_CACHE_ASSOC
,

482 
	#_SC_LEVEL2_CACHE_ASSOC
 
_SC_LEVEL2_CACHE_ASSOC


	)

483 
	m_SC_LEVEL2_CACHE_LINESIZE
,

484 
	#_SC_LEVEL2_CACHE_LINESIZE
 
_SC_LEVEL2_CACHE_LINESIZE


	)

485 
	m_SC_LEVEL3_CACHE_SIZE
,

486 
	#_SC_LEVEL3_CACHE_SIZE
 
_SC_LEVEL3_CACHE_SIZE


	)

487 
	m_SC_LEVEL3_CACHE_ASSOC
,

488 
	#_SC_LEVEL3_CACHE_ASSOC
 
_SC_LEVEL3_CACHE_ASSOC


	)

489 
	m_SC_LEVEL3_CACHE_LINESIZE
,

490 
	#_SC_LEVEL3_CACHE_LINESIZE
 
_SC_LEVEL3_CACHE_LINESIZE


	)

491 
	m_SC_LEVEL4_CACHE_SIZE
,

492 
	#_SC_LEVEL4_CACHE_SIZE
 
_SC_LEVEL4_CACHE_SIZE


	)

493 
	m_SC_LEVEL4_CACHE_ASSOC
,

494 
	#_SC_LEVEL4_CACHE_ASSOC
 
_SC_LEVEL4_CACHE_ASSOC


	)

495 
	m_SC_LEVEL4_CACHE_LINESIZE
,

496 
	#_SC_LEVEL4_CACHE_LINESIZE
 
_SC_LEVEL4_CACHE_LINESIZE


	)

499 
	m_SC_IPV6
 = 
_SC_LEVEL1_ICACHE_SIZE
 + 50,

500 
	#_SC_IPV6
 
_SC_IPV6


	)

501 
	m_SC_RAW_SOCKETS


502 
	#_SC_RAW_SOCKETS
 
_SC_RAW_SOCKETS


	)

508 
	m_CS_PATH
,

509 
	#_CS_PATH
 
_CS_PATH


	)

511 
	m_CS_V6_WIDTH_RESTRICTED_ENVS
,

512 
	#_CS_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

513 
	#_CS_POSIX_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

515 
	m_CS_GNU_LIBC_VERSION
,

516 
	#_CS_GNU_LIBC_VERSION
 
_CS_GNU_LIBC_VERSION


	)

517 
	m_CS_GNU_LIBPTHREAD_VERSION
,

518 
	#_CS_GNU_LIBPTHREAD_VERSION
 
_CS_GNU_LIBPTHREAD_VERSION


	)

520 
	m_CS_LFS_CFLAGS
 = 1000,

521 
	#_CS_LFS_CFLAGS
 
_CS_LFS_CFLAGS


	)

522 
	m_CS_LFS_LDFLAGS
,

523 
	#_CS_LFS_LDFLAGS
 
_CS_LFS_LDFLAGS


	)

524 
	m_CS_LFS_LIBS
,

525 
	#_CS_LFS_LIBS
 
_CS_LFS_LIBS


	)

526 
	m_CS_LFS_LINTFLAGS
,

527 
	#_CS_LFS_LINTFLAGS
 
_CS_LFS_LINTFLAGS


	)

528 
	m_CS_LFS64_CFLAGS
,

529 
	#_CS_LFS64_CFLAGS
 
_CS_LFS64_CFLAGS


	)

530 
	m_CS_LFS64_LDFLAGS
,

531 
	#_CS_LFS64_LDFLAGS
 
_CS_LFS64_LDFLAGS


	)

532 
	m_CS_LFS64_LIBS
,

533 
	#_CS_LFS64_LIBS
 
_CS_LFS64_LIBS


	)

534 
	m_CS_LFS64_LINTFLAGS
,

535 
	#_CS_LFS64_LINTFLAGS
 
_CS_LFS64_LINTFLAGS


	)

537 
	m_CS_XBS5_ILP32_OFF32_CFLAGS
 = 1100,

538 
	#_CS_XBS5_ILP32_OFF32_CFLAGS
 
_CS_XBS5_ILP32_OFF32_CFLAGS


	)

539 
	m_CS_XBS5_ILP32_OFF32_LDFLAGS
,

540 
	#_CS_XBS5_ILP32_OFF32_LDFLAGS
 
_CS_XBS5_ILP32_OFF32_LDFLAGS


	)

541 
	m_CS_XBS5_ILP32_OFF32_LIBS
,

542 
	#_CS_XBS5_ILP32_OFF32_LIBS
 
_CS_XBS5_ILP32_OFF32_LIBS


	)

543 
	m_CS_XBS5_ILP32_OFF32_LINTFLAGS
,

544 
	#_CS_XBS5_ILP32_OFF32_LINTFLAGS
 
_CS_XBS5_ILP32_OFF32_LINTFLAGS


	)

545 
	m_CS_XBS5_ILP32_OFFBIG_CFLAGS
,

546 
	#_CS_XBS5_ILP32_OFFBIG_CFLAGS
 
_CS_XBS5_ILP32_OFFBIG_CFLAGS


	)

547 
	m_CS_XBS5_ILP32_OFFBIG_LDFLAGS
,

548 
	#_CS_XBS5_ILP32_OFFBIG_LDFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LDFLAGS


	)

549 
	m_CS_XBS5_ILP32_OFFBIG_LIBS
,

550 
	#_CS_XBS5_ILP32_OFFBIG_LIBS
 
_CS_XBS5_ILP32_OFFBIG_LIBS


	)

551 
	m_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
,

552 
	#_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LINTFLAGS


	)

553 
	m_CS_XBS5_LP64_OFF64_CFLAGS
,

554 
	#_CS_XBS5_LP64_OFF64_CFLAGS
 
_CS_XBS5_LP64_OFF64_CFLAGS


	)

555 
	m_CS_XBS5_LP64_OFF64_LDFLAGS
,

556 
	#_CS_XBS5_LP64_OFF64_LDFLAGS
 
_CS_XBS5_LP64_OFF64_LDFLAGS


	)

557 
	m_CS_XBS5_LP64_OFF64_LIBS
,

558 
	#_CS_XBS5_LP64_OFF64_LIBS
 
_CS_XBS5_LP64_OFF64_LIBS


	)

559 
	m_CS_XBS5_LP64_OFF64_LINTFLAGS
,

560 
	#_CS_XBS5_LP64_OFF64_LINTFLAGS
 
_CS_XBS5_LP64_OFF64_LINTFLAGS


	)

561 
	m_CS_XBS5_LPBIG_OFFBIG_CFLAGS
,

562 
	#_CS_XBS5_LPBIG_OFFBIG_CFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_CFLAGS


	)

563 
	m_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
,

564 
	#_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LDFLAGS


	)

565 
	m_CS_XBS5_LPBIG_OFFBIG_LIBS
,

566 
	#_CS_XBS5_LPBIG_OFFBIG_LIBS
 
_CS_XBS5_LPBIG_OFFBIG_LIBS


	)

567 
	m_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
,

568 
	#_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS


	)

570 
	m_CS_POSIX_V6_ILP32_OFF32_CFLAGS
,

571 
	#_CS_POSIX_V6_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_CFLAGS


	)

572 
	m_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
,

573 
	#_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LDFLAGS


	)

574 
	m_CS_POSIX_V6_ILP32_OFF32_LIBS
,

575 
	#_CS_POSIX_V6_ILP32_OFF32_LIBS
 
_CS_POSIX_V6_ILP32_OFF32_LIBS


	)

576 
	m_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
,

577 
	#_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS


	)

578 
	m_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
,

579 
	#_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS


	)

580 
	m_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
,

581 
	#_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS


	)

582 
	m_CS_POSIX_V6_ILP32_OFFBIG_LIBS
,

583 
	#_CS_POSIX_V6_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V6_ILP32_OFFBIG_LIBS


	)

584 
	m_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
,

585 
	#_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS


	)

586 
	m_CS_POSIX_V6_LP64_OFF64_CFLAGS
,

587 
	#_CS_POSIX_V6_LP64_OFF64_CFLAGS
 
_CS_POSIX_V6_LP64_OFF64_CFLAGS


	)

588 
	m_CS_POSIX_V6_LP64_OFF64_LDFLAGS
,

589 
	#_CS_POSIX_V6_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LDFLAGS


	)

590 
	m_CS_POSIX_V6_LP64_OFF64_LIBS
,

591 
	#_CS_POSIX_V6_LP64_OFF64_LIBS
 
_CS_POSIX_V6_LP64_OFF64_LIBS


	)

592 
	m_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
,

593 
	#_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LINTFLAGS


	)

594 
	m_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
,

595 
	#_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS


	)

596 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
,

597 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS


	)

598 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
,

599 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LIBS


	)

600 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


601 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


	)

	@/usr/include/bits/dirent.h

19 #iâdeà
_DIRENT_H


23 
	sdœ’t


25 #iâdeà
__USE_FILE_OFFSET64


26 
__šo_t
 
	md_šo
;

27 
__off_t
 
	md_off
;

29 
__šo64_t
 
	md_šo
;

30 
__off64_t
 
	md_off
;

32 
	md_»ş’
;

33 
	md_ty³
;

34 
	md_Çme
[256];

37 #ifdeà
__USE_LARGEFILE64


38 
	sdœ’t64


40 
__šo64_t
 
	md_šo
;

41 
__off64_t
 
	md_off
;

42 
	md_»ş’
;

43 
	md_ty³
;

44 
	md_Çme
[256];

48 
	#d_f’o
 
d_šo


	)

50 #undeà
_DIRENT_HAVE_D_NAMLEN


51 
	#_DIRENT_HAVE_D_RECLEN


	)

52 
	#_DIRENT_HAVE_D_OFF


	)

53 
	#_DIRENT_HAVE_D_TYPE


	)

	@/usr/include/bits/environments.h

19 #iâdeà
_UNISTD_H


23 
	~<b™s/wÜdsize.h
>

41 #ià
__WORDSIZE
 == 64

53 
	#_POSIX_V6_LPBIG_OFFBIG
 -1

	)

54 
	#_XBS5_LPBIG_OFFBIG
 -1

	)

57 
	#_POSIX_V6_LP64_OFF64
 1

	)

58 
	#_XBS5_LP64_OFF64
 1

	)

64 
	#_POSIX_V6_ILP32_OFF32
 1

	)

65 
	#_POSIX_V6_ILP32_OFFBIG
 1

	)

66 
	#_XBS5_ILP32_OFF32
 1

	)

67 
	#_XBS5_ILP32_OFFBIG
 1

	)

82 
	#__ILP32_OFF32_CFLAGS
 "-m32"

	)

83 
	#__ILP32_OFFBIG_CFLAGS
 "-m32 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"

	)

84 
	#__ILP32_OFF32_LDFLAGS
 "-m32"

	)

85 
	#__ILP32_OFFBIG_LDFLAGS
 "-m32"

	)

86 
	#__LP64_OFF64_CFLAGS
 "-m64"

	)

87 
	#__LP64_OFF64_LDFLAGS
 "-m64"

	)

	@/usr/include/bits/errno.h

20 #ifdeà
_ERRNO_H


22 #undeà
EDOM


23 #undeà
EILSEQ


24 #undeà
ERANGE


25 
	~<lšux/”ºo.h
>

28 
	#ENOTSUP
 
EOPNOTSUPP


	)

31 #iâdeà
ECANCELED


32 
	#ECANCELED
 125

	)

36 #iâdeà
EOWNERDEAD


37 
	#EOWNERDEAD
 130

	)

38 
	#ENOTRECOVERABLE
 131

	)

41 #iâdeà
__ASSEMBLER__


43 *
	$__”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

45 #ià!
defšed
 
_LIBC
 || defšed 
_LIBC_REENTRANT


47 
	#”ºo
 (*
	`__”ºo_loÿtiÚ
 ())

	)

52 #ià!
defšed
 
_ERRNO_H
 && defšed 
__Ãed_Em©h


56 
	#EDOM
 33

	)

57 
	#EILSEQ
 84

	)

58 
	#ERANGE
 34

	)

	@/usr/include/bits/error.h

20 #iâdef 
_ERROR_H


25 
__REDIRECT
 (
__”rÜ_®Ÿs
, (
__¡©us
, 
__”ºum
,

26 
__cÚ¡
 *
__fÜm©
, ...),

27 
”rÜ
)

28 
__©Œibu‹__
 ((
__fÜm©__
 (
__´štf__
, 3, 4)));

29 
__REDIRECT
 (
__”rÜ_nÜ‘uº
, (
__¡©us
, 
__”ºum
,

30 
__cÚ¡
 *
__fÜm©
, ...),

31 
”rÜ
)

32 
__©Œibu‹__
 ((
__nÜ‘uº__
, 
__fÜm©__
 (
__´štf__
, 3, 4)));

37 
__ex‹º_®ways_šlše
 

38 
	$”rÜ
 (
__¡©us
, 
__”ºum
, 
__cÚ¡
 *
__fÜm©
, ...)

40 ià(
	`__butš_cÚ¡ªt_p
 (
__¡©us
) && __status != 0)

41 
	`__”rÜ_nÜ‘uº
 (
__¡©us
, 
__”ºum
, 
__fÜm©
, 
	`__va_¬g_·ck
 ());

43 
	`__”rÜ_®Ÿs
 (
__¡©us
, 
__”ºum
, 
__fÜm©
, 
	`__va_¬g_·ck
 ());

44 
	}
}

47 
__REDIRECT
 (
__”rÜ_©_lše_®Ÿs
, (
__¡©us
, 
__”ºum
,

48 
__cÚ¡
 *
__âame
,

49 
__lše
,

50 
__cÚ¡
 *
__fÜm©
, ...),

51 
”rÜ_©_lše
)

52 
__©Œibu‹__
 ((
__fÜm©__
 (
__´štf__
, 5, 6)));

53 
__REDIRECT
 (
__”rÜ_©_lše_nÜ‘uº
, (
__¡©us
, 
__”ºum
,

54 
__cÚ¡
 *
__âame
,

55 
__lše
,

56 
__cÚ¡
 *
__fÜm©
,

58 
”rÜ_©_lše
)

59 
__©Œibu‹__
 ((
__nÜ‘uº__
, 
__fÜm©__
 (
__´štf__
, 5, 6)));

64 
__ex‹º_®ways_šlše
 

65 
	$”rÜ_©_lše
 (
__¡©us
, 
__”ºum
, 
__cÚ¡
 *
__âame
,

66 
__lše
,
__cÚ¡
 *
__fÜm©
, ...)

68 ià(
	`__butš_cÚ¡ªt_p
 (
__¡©us
) && __status != 0)

69 
	`__”rÜ_©_lše_nÜ‘uº
 (
__¡©us
, 
__”ºum
, 
__âame
, 
__lše
, 
__fÜm©
,

70 
	`__va_¬g_·ck
 ());

72 
	`__”rÜ_©_lše_®Ÿs
 (
__¡©us
, 
__”ºum
, 
__âame
, 
__lše
,

73 
__fÜm©
, 
	`__va_¬g_·ck
 ());

74 
	}
}

	@/usr/include/bits/fcntl.h

20 #iâdef 
_FCNTL_H


24 
	~<sys/ty³s.h
>

25 
	~<b™s/wÜdsize.h
>

26 #ifdeà
__USE_GNU


27 
	~<b™s/uio.h
>

33 
	#O_ACCMODE
 0003

	)

34 
	#O_RDONLY
 00

	)

35 
	#O_WRONLY
 01

	)

36 
	#O_RDWR
 02

	)

37 
	#O_CREAT
 0100

	)

38 
	#O_EXCL
 0200

	)

39 
	#O_NOCTTY
 0400

	)

40 
	#O_TRUNC
 01000

	)

41 
	#O_APPEND
 02000

	)

42 
	#O_NONBLOCK
 04000

	)

43 
	#O_NDELAY
 
O_NONBLOCK


	)

44 
	#O_SYNC
 010000

	)

45 
	#O_FSYNC
 
O_SYNC


	)

46 
	#O_ASYNC
 020000

	)

48 #ifdeà
__USE_GNU


49 
	#O_DIRECT
 040000

	)

50 
	#O_DIRECTORY
 0200000

	)

51 
	#O_NOFOLLOW
 0400000

	)

52 
	#O_NOATIME
 01000000

	)

53 
	#O_CLOEXEC
 02000000

	)

59 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


60 
	#O_DSYNC
 
O_SYNC


	)

61 
	#O_RSYNC
 
O_SYNC


	)

64 #ifdeà
__USE_LARGEFILE64


65 #ià
__WORDSIZE
 == 64

66 
	#O_LARGEFILE
 0

	)

68 
	#O_LARGEFILE
 0100000

	)

73 
	#F_DUPFD
 0

	)

74 
	#F_GETFD
 1

	)

75 
	#F_SETFD
 2

	)

76 
	#F_GETFL
 3

	)

77 
	#F_SETFL
 4

	)

78 #ià
__WORDSIZE
 == 64

79 
	#F_GETLK
 5

	)

80 
	#F_SETLK
 6

	)

81 
	#F_SETLKW
 7

	)

83 
	#F_GETLK64
 5

	)

84 
	#F_SETLK64
 6

	)

85 
	#F_SETLKW64
 7

	)

87 #iâdeà
__USE_FILE_OFFSET64


88 
	#F_GETLK
 5

	)

89 
	#F_SETLK
 6

	)

90 
	#F_SETLKW
 7

	)

92 
	#F_GETLK
 
F_GETLK64


	)

93 
	#F_SETLK
 
F_SETLK64


	)

94 
	#F_SETLKW
 
F_SETLKW64


	)

96 
	#F_GETLK64
 12

	)

97 
	#F_SETLK64
 13

	)

98 
	#F_SETLKW64
 14

	)

101 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98


102 
	#F_SETOWN
 8

	)

103 
	#F_GETOWN
 9

	)

106 #ifdeà
__USE_GNU


107 
	#F_SETSIG
 10

	)

108 
	#F_GETSIG
 11

	)

111 #ifdeà
__USE_GNU


112 
	#F_SETLEASE
 1024

	)

113 
	#F_GETLEASE
 1025

	)

114 
	#F_NOTIFY
 1026

	)

115 
	#F_DUPFD_CLOEXEC
 1030

	)

120 
	#FD_CLOEXEC
 1

	)

123 
	#F_RDLCK
 0

	)

124 
	#F_WRLCK
 1

	)

125 
	#F_UNLCK
 2

	)

128 
	#F_EXLCK
 4

	)

129 
	#F_SHLCK
 8

	)

131 #ifdeà
__USE_BSD


133 
	#LOCK_SH
 1

	)

134 
	#LOCK_EX
 2

	)

135 
	#LOCK_NB
 4

	)

137 
	#LOCK_UN
 8

	)

140 #ifdeà
__USE_GNU


141 
	#LOCK_MAND
 32

	)

142 
	#LOCK_READ
 64

	)

143 
	#LOCK_WRITE
 128

	)

144 
	#LOCK_RW
 192

	)

147 #ifdeà
__USE_GNU


149 
	#DN_ACCESS
 0x00000001

	)

150 
	#DN_MODIFY
 0x00000002

	)

151 
	#DN_CREATE
 0x00000004

	)

152 
	#DN_DELETE
 0x00000008

	)

153 
	#DN_RENAME
 0x00000010

	)

154 
	#DN_ATTRIB
 0x00000020

	)

155 
	#DN_MULTISHOT
 0x80000000

	)

158 
	sæock


160 
	ml_ty³
;

161 
	ml_wh’û
;

162 #iâdeà
__USE_FILE_OFFSET64


163 
__off_t
 
	ml_¡¬t
;

164 
__off_t
 
	ml_Ën
;

166 
__off64_t
 
	ml_¡¬t
;

167 
__off64_t
 
	ml_Ën
;

169 
__pid_t
 
	ml_pid
;

172 #ifdeà
__USE_LARGEFILE64


173 
	sæock64


175 
	ml_ty³
;

176 
	ml_wh’û
;

177 
__off64_t
 
	ml_¡¬t
;

178 
__off64_t
 
	ml_Ën
;

179 
__pid_t
 
	ml_pid
;

185 #ifdef 
__USE_BSD


186 
	#FAPPEND
 
O_APPEND


	)

187 
	#FFSYNC
 
O_FSYNC


	)

188 
	#FASYNC
 
O_ASYNC


	)

189 
	#FNONBLOCK
 
O_NONBLOCK


	)

190 
	#FNDELAY
 
O_NDELAY


	)

194 #ifdeà
__USE_XOPEN2K


195 
	#POSIX_FADV_NORMAL
 0

	)

196 
	#POSIX_FADV_RANDOM
 1

	)

197 
	#POSIX_FADV_SEQUENTIAL
 2

	)

198 
	#POSIX_FADV_WILLNEED
 3

	)

199 
	#POSIX_FADV_DONTNEED
 4

	)

200 
	#POSIX_FADV_NOREUSE
 5

	)

204 #ifdeà
__USE_GNU


206 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

209 
	#SYNC_FILE_RANGE_WRITE
 2

	)

212 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

217 
	#SPLICE_F_MOVE
 1

	)

218 
	#SPLICE_F_NONBLOCK
 2

	)

221 
	#SPLICE_F_MORE
 4

	)

222 
	#SPLICE_F_GIFT
 8

	)

225 
	g__BEGIN_DECLS


227 #ifdeà
__USE_GNU


230 
ssize_t
 
	$»adah—d
 (
__fd
, 
__off64_t
 
__off£t
, 
size_t
 
__couÁ
)

231 
__THROW
;

235 
	`sync_fe_¿nge
 (
__fd
, 
__off64_t
 
__äom
, __off64_ˆ
__to
,

236 
__æags
);

240 
ssize_t
 
	`vm¥liû
 (
__fdout
, cÚ¡ 
iovec
 *
__iov
,

241 
size_t
 
__couÁ
, 
__æags
);

244 
ssize_t
 
	`¥liû
 (
__fdš
, 
__off64_t
 *
__offš
, 
__fdout
,

245 
__off64_t
 *
__offout
, 
size_t
 
__Ën
,

246 
__æags
);

249 
ssize_t
 
	`‹e
 (
__fdš
, 
__fdout
, 
size_t
 
__Ën
,

250 
__æags
);

254 
__END_DECLS


	@/usr/include/bits/fcntl2.h

20 #iâdef 
_FCNTL_H


26 #iâdeà
__USE_FILE_OFFSET64


27 
	$__İ’_2
 (
__cÚ¡
 *
__·th
, 
__oæag
è
	`__nÚnuÎ
 ((1));

28 
	`__REDIRECT
 (
__İ’_®Ÿs
, (
__cÚ¡
 *
__·th
, 
__oæag
, ...),

29 
İ’
è
	`__nÚnuÎ
 ((1));

31 
	`__REDIRECT
 (
__İ’_2
, (
__cÚ¡
 *
__·th
, 
__oæag
),

32 
__İ’64_2
è
	`__nÚnuÎ
 ((1));

33 
	`__REDIRECT
 (
__İ’_®Ÿs
, (
__cÚ¡
 *
__·th
, 
__oæag
, ...),

34 
İ’64
è
	`__nÚnuÎ
 ((1));

36 
	`__”rÜdeş
 (
__İ’_too_mªy_¬gs
,

38 
	`__”rÜdeş
 (
__İ’_missšg_mode
,

41 
__ex‹º_®ways_šlše
 

42 
	$İ’
 (
__cÚ¡
 *
__·th
, 
__oæag
, ...)

44 ià(
	`__va_¬g_·ck_Ën
 () > 1)

45 
	`__İ’_too_mªy_¬gs
 ();

47 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

49 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

51 
	`__İ’_missšg_mode
 ();

52  
	`__İ’_2
 (
__·th
, 
__oæag
);

54  
	`__İ’_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

57 ià(
	`__va_¬g_·ck_Ën
 () < 1)

58  
	`__İ’_2
 (
__·th
, 
__oæag
);

60  
	`__İ’_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

61 
	}
}

64 #ifdeà
__USE_LARGEFILE64


65 
	$__İ’64_2
 (
__cÚ¡
 *
__·th
, 
__oæag
è
	`__nÚnuÎ
 ((1));

66 
	`__REDIRECT
 (
__İ’64_®Ÿs
, (
__cÚ¡
 *
__·th
, 
__oæag
,

67 ...), 
İ’64
è
	`__nÚnuÎ
 ((1));

68 
	`__”rÜdeş
 (
__İ’64_too_mªy_¬gs
,

70 
	`__”rÜdeş
 (
__İ’64_missšg_mode
,

73 
__ex‹º_®ways_šlše
 

74 
	$İ’64
 (
__cÚ¡
 *
__·th
, 
__oæag
, ...)

76 ià(
	`__va_¬g_·ck_Ën
 () > 1)

77 
	`__İ’64_too_mªy_¬gs
 ();

79 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

81 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

83 
	`__İ’64_missšg_mode
 ();

84  
	`__İ’64_2
 (
__·th
, 
__oæag
);

86  
	`__İ’64_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

89 ià(
	`__va_¬g_·ck_Ën
 () < 1)

90  
	`__İ’64_2
 (
__·th
, 
__oæag
);

92  
	`__İ’64_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

93 
	}
}

97 #ifdeà
__USE_ATFILE


98 #iâdeà
__USE_FILE_OFFSET64


99 
	$__İ’©_2
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__oæag
)

100 
	`__nÚnuÎ
 ((2));

101 
	`__REDIRECT
 (
__İ’©_®Ÿs
, (
__fd
, 
__cÚ¡
 *
__·th
,

102 
__oæag
, ...), 
İ’©
)

103 
	`__nÚnuÎ
 ((2));

105 
	`__REDIRECT
 (
__İ’©_2
, (
__fd
, 
__cÚ¡
 *
__·th
,

106 
__oæag
), 
__İ’©64_2
)

107 
	`__nÚnuÎ
 ((2));

108 
	`__REDIRECT
 (
__İ’©_®Ÿs
, (
__fd
, 
__cÚ¡
 *
__·th
,

109 
__oæag
, ...), 
İ’©64
)

110 
	`__nÚnuÎ
 ((2));

112 
	`__”rÜdeş
 (
__İ’©_too_mªy_¬gs
,

114 
	`__”rÜdeş
 (
__İ’©_missšg_mode
,

117 
__ex‹º_®ways_šlše
 

118 
	$İ’©
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__oæag
, ...)

120 ià(
	`__va_¬g_·ck_Ën
 () > 1)

121 
	`__İ’©_too_mªy_¬gs
 ();

123 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

125 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

127 
	`__İ’©_missšg_mode
 ();

128  
	`__İ’©_2
 (
__fd
, 
__·th
, 
__oæag
);

130  
	`__İ’©_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

133 ià(
	`__va_¬g_·ck_Ën
 () < 1)

134  
	`__İ’©_2
 (
__fd
, 
__·th
, 
__oæag
);

136  
	`__İ’©_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

137 
	}
}

140 #ifdeà
__USE_LARGEFILE64


141 
	$__İ’©64_2
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__oæag
)

142 
	`__nÚnuÎ
 ((2));

143 
	`__REDIRECT
 (
__İ’©64_®Ÿs
, (
__fd
, 
__cÚ¡
 *
__·th
,

144 
__oæag
, ...), 
İ’©64
)

145 
	`__nÚnuÎ
 ((2));

146 
	`__”rÜdeş
 (
__İ’©64_too_mªy_¬gs
,

148 
	`__”rÜdeş
 (
__İ’©64_missšg_mode
,

151 
__ex‹º_®ways_šlše
 

152 
	$İ’©64
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__oæag
, ...)

154 ià(
	`__va_¬g_·ck_Ën
 () > 1)

155 
	`__İ’©64_too_mªy_¬gs
 ();

157 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

159 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

161 
	`__İ’©64_missšg_mode
 ();

162  
	`__İ’©64_2
 (
__fd
, 
__·th
, 
__oæag
);

164  
	`__İ’©64_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

167 ià(
	`__va_¬g_·ck_Ën
 () < 1)

168  
	`__İ’©64_2
 (
__fd
, 
__·th
, 
__oæag
);

170  
	`__İ’©64_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

171 
	}
}

	@/usr/include/bits/huge_val.h

22 #iâdeà
_MATH_H


28 #ià
__GNUC_PREREQ
(3,3)

29 
	#HUGE_VAL
 (
	`__butš_huge_v®
())

	)

30 #–ià
__GNUC_PREREQ
(2,96)

31 
	#HUGE_VAL
 (
__ex‹nsiÚ__
 0x1.0
p2047
)

	)

32 #–ià
defšed
 
__GNUC__


34 
	#HUGE_VAL
 \

35 (
__ex‹nsiÚ__
 \

36 ((uniÚ { 
__l
 
	`__©Œibu‹__
((
	`__mode__
(
__DI__
))); 
__d
; }) \

37 { 
__l
: 0x7ff0000000000000ULL }).
__d
)

	)

41 
	~<’dŸn.h
>

43 uniÚ { 
	m__c
[8]; 
	m__d
; } 
	t__huge_v®_t
;

45 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


46 
	#__HUGE_VAL_by‹s
 { 0x7f, 0xf0, 0, 0, 0, 0, 0, 0 }

	)

48 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


49 
	#__HUGE_VAL_by‹s
 { 0, 0, 0, 0, 0, 0, 0xf0, 0x7à}

	)

52 
__huge_v®_t
 
	g__huge_v®
 = { 
__HUGE_VAL_by‹s
 };

53 
	#HUGE_VAL
 (
__huge_v®
.
__d
)

	)

	@/usr/include/bits/huge_valf.h

22 #iâdeà
_MATH_H


28 #ià
__GNUC_PREREQ
(3,3)

29 
	#HUGE_VALF
 (
	`__butš_huge_v®f
())

	)

30 #–ià
__GNUC_PREREQ
(2,96)

31 
	#HUGE_VALF
 (
__ex‹nsiÚ__
 0x1.0
p255f
)

	)

32 #–ià
defšed
 
__GNUC__


34 
	#HUGE_VALF
 \

35 (
__ex‹nsiÚ__
 \

36 ((uniÚ { 
__l
 
	`__©Œibu‹__
((
	`__mode__
(
__SI__
))); 
__d
; }) \

37 { 
__l
: 0x7f800000UL }).
__d
)

	)

41 uniÚ { 
	m__c
[4]; 
	m__f
; } 
	t__huge_v®f_t
;

43 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


44 
	#__HUGE_VALF_by‹s
 { 0x7f, 0x80, 0, 0 }

	)

46 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


47 
	#__HUGE_VALF_by‹s
 { 0, 0, 0x80, 0x7à}

	)

50 
__huge_v®f_t
 
	g__huge_v®f
 = { 
__HUGE_VALF_by‹s
 };

51 
	#HUGE_VALF
 (
__huge_v®f
.
__f
)

	)

	@/usr/include/bits/huge_vall.h

21 #iâdeà
_MATH_H


25 #ià
__GNUC_PREREQ
(3,3)

26 
	#HUGE_VALL
 (
	`__butš_huge_v®l
())

	)

28 
	#HUGE_VALL
 ((è
HUGE_VAL
)

	)

	@/usr/include/bits/in.h

21 #iâdeà
_NETINET_IN_H


28 
	#IP_OPTIONS
 4

	)

29 
	#IP_HDRINCL
 3

	)

30 
	#IP_TOS
 1

	)

31 
	#IP_TTL
 2

	)

32 
	#IP_RECVOPTS
 6

	)

34 
	#IP_RECVRETOPTS
 
IP_RETOPTS


	)

35 
	#IP_RETOPTS
 7

	)

36 
	#IP_MULTICAST_IF
 32

	)

37 
	#IP_MULTICAST_TTL
 33

	)

38 
	#IP_MULTICAST_LOOP
 34

	)

39 
	#IP_ADD_MEMBERSHIP
 35

	)

40 
	#IP_DROP_MEMBERSHIP
 36

	)

41 
	#IP_UNBLOCK_SOURCE
 37

	)

42 
	#IP_BLOCK_SOURCE
 38

	)

43 
	#IP_ADD_SOURCE_MEMBERSHIP
 39

	)

44 
	#IP_DROP_SOURCE_MEMBERSHIP
 40

	)

45 
	#IP_MSFILTER
 41

	)

46 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


47 
	#MCAST_JOIN_GROUP
 42

	)

48 
	#MCAST_BLOCK_SOURCE
 43

	)

49 
	#MCAST_UNBLOCK_SOURCE
 44

	)

50 
	#MCAST_LEAVE_GROUP
 45

	)

51 
	#MCAST_JOIN_SOURCE_GROUP
 46

	)

52 
	#MCAST_LEAVE_SOURCE_GROUP
 47

	)

53 
	#MCAST_MSFILTER
 48

	)

55 
	#MCAST_EXCLUDE
 0

	)

56 
	#MCAST_INCLUDE
 1

	)

59 
	#IP_ROUTER_ALERT
 5

	)

60 
	#IP_PKTINFO
 8

	)

61 
	#IP_PKTOPTIONS
 9

	)

62 
	#IP_PMTUDISC
 10

	)

63 
	#IP_MTU_DISCOVER
 10

	)

64 
	#IP_RECVERR
 11

	)

65 
	#IP_RECVTTL
 12

	)

66 
	#IP_RECVTOS
 13

	)

70 
	#IP_PMTUDISC_DONT
 0

	)

71 
	#IP_PMTUDISC_WANT
 1

	)

72 
	#IP_PMTUDISC_DO
 2

	)

73 
	#IP_PMTUDISC_PROBE
 3

	)

76 
	#SOL_IP
 0

	)

78 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

79 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

80 
	#IP_MAX_MEMBERSHIPS
 20

	)

82 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


86 
	s_İts


88 
š_addr
 
	m_d¡
;

89 
	m_İts
[40];

93 
	s_m»qn


95 
š_addr
 
	mimr_muÉŸddr
;

96 
š_addr
 
	mimr_add»ss
;

97 
	mimr_ifšdex
;

101 
	sš_pktšfo


103 
	mi_ifšdex
;

104 
š_addr
 
	mi_¥ec_d¡
;

105 
š_addr
 
	mi_addr
;

112 
	#IPV6_ADDRFORM
 1

	)

113 
	#IPV6_2292PKTINFO
 2

	)

114 
	#IPV6_2292HOPOPTS
 3

	)

115 
	#IPV6_2292DSTOPTS
 4

	)

116 
	#IPV6_2292RTHDR
 5

	)

117 
	#IPV6_2292PKTOPTIONS
 6

	)

118 
	#IPV6_CHECKSUM
 7

	)

119 
	#IPV6_2292HOPLIMIT
 8

	)

121 
	#SCM_SRCRT
 
IPV6_RXSRCRT


	)

123 
	#IPV6_NEXTHOP
 9

	)

124 
	#IPV6_AUTHHDR
 10

	)

125 
	#IPV6_UNICAST_HOPS
 16

	)

126 
	#IPV6_MULTICAST_IF
 17

	)

127 
	#IPV6_MULTICAST_HOPS
 18

	)

128 
	#IPV6_MULTICAST_LOOP
 19

	)

129 
	#IPV6_JOIN_GROUP
 20

	)

130 
	#IPV6_LEAVE_GROUP
 21

	)

131 
	#IPV6_ROUTER_ALERT
 22

	)

132 
	#IPV6_MTU_DISCOVER
 23

	)

133 
	#IPV6_MTU
 24

	)

134 
	#IPV6_RECVERR
 25

	)

135 
	#IPV6_V6ONLY
 26

	)

136 
	#IPV6_JOIN_ANYCAST
 27

	)

137 
	#IPV6_LEAVE_ANYCAST
 28

	)

138 
	#IPV6_IPSEC_POLICY
 34

	)

139 
	#IPV6_XFRM_POLICY
 35

	)

141 
	#IPV6_RECVPKTINFO
 49

	)

142 
	#IPV6_PKTINFO
 50

	)

143 
	#IPV6_RECVHOPLIMIT
 51

	)

144 
	#IPV6_HOPLIMIT
 52

	)

145 
	#IPV6_RECVHOPOPTS
 53

	)

146 
	#IPV6_HOPOPTS
 54

	)

147 
	#IPV6_RTHDRDSTOPTS
 55

	)

148 
	#IPV6_RECVRTHDR
 56

	)

149 
	#IPV6_RTHDR
 57

	)

150 
	#IPV6_RECVDSTOPTS
 58

	)

151 
	#IPV6_DSTOPTS
 59

	)

153 
	#IPV6_RECVTCLASS
 66

	)

154 
	#IPV6_TCLASS
 67

	)

157 
	#IPV6_ADD_MEMBERSHIP
 
IPV6_JOIN_GROUP


	)

158 
	#IPV6_DROP_MEMBERSHIP
 
IPV6_LEAVE_GROUP


	)

159 
	#IPV6_RXHOPOPTS
 
IPV6_HOPOPTS


	)

160 
	#IPV6_RXDSTOPTS
 
IPV6_DSTOPTS


	)

163 
	#IPV6_PMTUDISC_DONT
 0

	)

164 
	#IPV6_PMTUDISC_WANT
 1

	)

165 
	#IPV6_PMTUDISC_DO
 2

	)

166 
	#IPV6_PMTUDISC_PROBE
 3

	)

169 
	#SOL_IPV6
 41

	)

170 
	#SOL_ICMPV6
 58

	)

173 
	#IPV6_RTHDR_LOOSE
 0

	)

174 
	#IPV6_RTHDR_STRICT
 1

	)

176 
	#IPV6_RTHDR_TYPE_0
 0

	)

	@/usr/include/bits/inf.h

20 #iâdeà
_MATH_H


26 #ià
__GNUC_PREREQ
(3,3)

27 
	#INFINITY
 (
	`__butš_šff
())

	)

29 
	#INFINITY
 
HUGE_VALF


	)

	@/usr/include/bits/ioctl-types.h

20 #iâdeà
_SYS_IOCTL_H


25 
	~<asm/ioùls.h
>

28 
	swšsize


30 
	mws_row
;

31 
	mws_cŞ
;

32 
	mws_xpix–
;

33 
	mws_ypix–
;

36 
	#NCC
 8

	)

37 
	s‹rmio


39 
	mc_iæag
;

40 
	mc_oæag
;

41 
	mc_cæag
;

42 
	mc_læag
;

43 
	mc_lše
;

44 
	mc_cc
[
NCC
];

48 
	#TIOCM_LE
 0x001

	)

49 
	#TIOCM_DTR
 0x002

	)

50 
	#TIOCM_RTS
 0x004

	)

51 
	#TIOCM_ST
 0x008

	)

52 
	#TIOCM_SR
 0x010

	)

53 
	#TIOCM_CTS
 0x020

	)

54 
	#TIOCM_CAR
 0x040

	)

55 
	#TIOCM_RNG
 0x080

	)

56 
	#TIOCM_DSR
 0x100

	)

57 
	#TIOCM_CD
 
TIOCM_CAR


	)

58 
	#TIOCM_RI
 
TIOCM_RNG


	)

63 
	#N_TTY
 0

	)

64 
	#N_SLIP
 1

	)

65 
	#N_MOUSE
 2

	)

66 
	#N_PPP
 3

	)

67 
	#N_STRIP
 4

	)

68 
	#N_AX25
 5

	)

69 
	#N_X25
 6

	)

70 
	#N_6PACK
 7

	)

71 
	#N_MASC
 8

	)

72 
	#N_R3964
 9

	)

73 
	#N_PROFIBUS_FDL
 10

	)

74 
	#N_IRDA
 11

	)

75 
	#N_SMSBLOCK
 12

	)

76 
	#N_HDLC
 13

	)

77 
	#N_SYNC_PPP
 14

	)

78 
	#N_HCI
 15

	)

	@/usr/include/bits/ioctls.h

19 #iâdeà
_SYS_IOCTL_H


24 
	~<asm/ioùls.h
>

27 
	#SIOCADDRT
 0x890B

	)

28 
	#SIOCDELRT
 0x890C

	)

29 
	#SIOCRTMSG
 0x890D

	)

32 
	#SIOCGIFNAME
 0x8910

	)

33 
	#SIOCSIFLINK
 0x8911

	)

34 
	#SIOCGIFCONF
 0x8912

	)

35 
	#SIOCGIFFLAGS
 0x8913

	)

36 
	#SIOCSIFFLAGS
 0x8914

	)

37 
	#SIOCGIFADDR
 0x8915

	)

38 
	#SIOCSIFADDR
 0x8916

	)

39 
	#SIOCGIFDSTADDR
 0x8917

	)

40 
	#SIOCSIFDSTADDR
 0x8918

	)

41 
	#SIOCGIFBRDADDR
 0x8919

	)

42 
	#SIOCSIFBRDADDR
 0x891¨

	)

43 
	#SIOCGIFNETMASK
 0x891b

	)

44 
	#SIOCSIFNETMASK
 0x891ø

	)

45 
	#SIOCGIFMETRIC
 0x891d

	)

46 
	#SIOCSIFMETRIC
 0x891

	)

47 
	#SIOCGIFMEM
 0x891à

	)

48 
	#SIOCSIFMEM
 0x8920

	)

49 
	#SIOCGIFMTU
 0x8921

	)

50 
	#SIOCSIFMTU
 0x8922

	)

51 
	#SIOCSIFNAME
 0x8923

	)

52 
	#SIOCSIFHWADDR
 0x8924

	)

53 
	#SIOCGIFENCAP
 0x8925

	)

54 
	#SIOCSIFENCAP
 0x8926

	)

55 
	#SIOCGIFHWADDR
 0x8927

	)

56 
	#SIOCGIFSLAVE
 0x8929

	)

57 
	#SIOCSIFSLAVE
 0x8930

	)

58 
	#SIOCADDMULTI
 0x8931

	)

59 
	#SIOCDELMULTI
 0x8932

	)

60 
	#SIOCGIFINDEX
 0x8933

	)

61 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

62 
	#SIOCSIFPFLAGS
 0x8934

	)

63 
	#SIOCGIFPFLAGS
 0x8935

	)

64 
	#SIOCDIFADDR
 0x8936

	)

65 
	#SIOCSIFHWBROADCAST
 0x8937

	)

66 
	#SIOCGIFCOUNT
 0x8938

	)

68 
	#SIOCGIFBR
 0x8940

	)

69 
	#SIOCSIFBR
 0x8941

	)

71 
	#SIOCGIFTXQLEN
 0x8942

	)

72 
	#SIOCSIFTXQLEN
 0x8943

	)

77 
	#SIOCDARP
 0x8953

	)

78 
	#SIOCGARP
 0x8954

	)

79 
	#SIOCSARP
 0x8955

	)

82 
	#SIOCDRARP
 0x8960

	)

83 
	#SIOCGRARP
 0x8961

	)

84 
	#SIOCSRARP
 0x8962

	)

88 
	#SIOCGIFMAP
 0x8970

	)

89 
	#SIOCSIFMAP
 0x8971

	)

93 
	#SIOCADDDLCI
 0x8980

	)

94 
	#SIOCDELDLCI
 0x8981

	)

103 
	#SIOCDEVPRIVATE
 0x89F0

	)

109 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/bits/mathcalls.h

46 #iâdeà
_MATH_H


53 
_MdoubË_BEGIN_NAMESPACE


55 
__MATHCALL
 (
acos
,, (
_MdoubË_
 
__x
));

57 
__MATHCALL
 (
asš
,, (
_MdoubË_
 
__x
));

59 
__MATHCALL
 (
©ª
,, (
_MdoubË_
 
__x
));

61 
__MATHCALL
 (
©ª2
,, (
_MdoubË_
 
__y
, _MdoubË_ 
__x
));

64 
__MATHCALL
 (
cos
,, (
_MdoubË_
 
__x
));

66 
__MATHCALL
 (
sš
,, (
_MdoubË_
 
__x
));

68 
__MATHCALL
 (
n
,, (
_MdoubË_
 
__x
));

73 
__MATHCALL
 (
cosh
,, (
_MdoubË_
 
__x
));

75 
__MATHCALL
 (
sšh
,, (
_MdoubË_
 
__x
));

77 
__MATHCALL
 (
nh
,, (
_MdoubË_
 
__x
));

78 
	g_MdoubË_END_NAMESPACE


80 #ifdeà
__USE_GNU


82 
__MATHDECL
 (,
sšcos
,,

83 (
_MdoubË_
 
__x
, _MdoubË_ *
__sšx
, _MdoubË_ *
__cosx
));

86 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


87 
__BEGIN_NAMESPACE_C99


89 
__MATHCALL
 (
acosh
,, (
_MdoubË_
 
__x
));

91 
__MATHCALL
 (
asšh
,, (
_MdoubË_
 
__x
));

93 
__MATHCALL
 (
©ªh
,, (
_MdoubË_
 
__x
));

94 
	g__END_NAMESPACE_C99


99 
_MdoubË_BEGIN_NAMESPACE


101 
__MATHCALL
 (
exp
,, (
_MdoubË_
 
__x
));

104 
__MATHCALL
 (
äexp
,, (
_MdoubË_
 
__x
, *
__expÚ’t
));

107 
__MATHCALL
 (
ldexp
,, (
_MdoubË_
 
__x
, 
__expÚ’t
));

110 
__MATHCALL
 (
log
,, (
_MdoubË_
 
__x
));

113 
__MATHCALL
 (
log10
,, (
_MdoubË_
 
__x
));

116 
__MATHCALL
 (
modf
,, (
_MdoubË_
 
__x
, _MdoubË_ *
__Œ
));

117 
	g_MdoubË_END_NAMESPACE


119 #ifdeà
__USE_GNU


121 
__MATHCALL
 (
exp10
,, (
_MdoubË_
 
__x
));

123 
__MATHCALL
 (
pow10
,, (
_MdoubË_
 
__x
));

126 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


127 
__BEGIN_NAMESPACE_C99


129 
__MATHCALL
 (
expm1
,, (
_MdoubË_
 
__x
));

132 
__MATHCALL
 (
log1p
,, (
_MdoubË_
 
__x
));

135 
__MATHCALL
 (
logb
,, (
_MdoubË_
 
__x
));

136 
	g__END_NAMESPACE_C99


139 #ifdeà
__USE_ISOC99


140 
__BEGIN_NAMESPACE_C99


142 
__MATHCALL
 (
exp2
,, (
_MdoubË_
 
__x
));

145 
__MATHCALL
 (
log2
,, (
_MdoubË_
 
__x
));

146 
	g__END_NAMESPACE_C99


152 
_MdoubË_BEGIN_NAMESPACE


154 
__MATHCALL
 (
pow
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

157 
__MATHCALL
 (
sq¹
,, (
_MdoubË_
 
__x
));

158 
	g_MdoubË_END_NAMESPACE


160 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
 || defšed 
__USE_ISOC99


161 
__BEGIN_NAMESPACE_C99


163 
__MATHCALL
 (
hypÙ
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

164 
	g__END_NAMESPACE_C99


167 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


168 
__BEGIN_NAMESPACE_C99


170 
__MATHCALL
 (
cb¹
,, (
_MdoubË_
 
__x
));

171 
	g__END_NAMESPACE_C99


177 
_MdoubË_BEGIN_NAMESPACE


179 
__MATHCALLX
 (
û
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

182 
__MATHCALLX
 (
çbs
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

185 
__MATHCALLX
 (
æoÜ
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

188 
__MATHCALL
 (
fmod
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

193 
__MATHDECL_1
 (,
__isšf
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

196 
__MATHDECL_1
 (,
__fš™e
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

197 
	g_MdoubË_END_NAMESPACE


199 #ifdeà
__USE_MISC


202 
__MATHDECL_1
 (,
isšf
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

205 
__MATHDECL_1
 (,
fš™e
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

208 
__MATHCALL
 (
d»m
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

212 
__MATHCALL
 (
signifiÿnd
,, (
_MdoubË_
 
__x
));

215 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


216 
__BEGIN_NAMESPACE_C99


218 
__MATHCALLX
 (
cİysign
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

219 
	g__END_NAMESPACE_C99


222 #ifdeà
__USE_ISOC99


223 
__BEGIN_NAMESPACE_C99


225 
__MATHCALLX
 (
Çn
,, (
__cÚ¡
 *
__gb
), (
__cÚ¡__
));

226 
	g__END_NAMESPACE_C99


231 
__MATHDECL_1
 (,
__i¢ª
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

233 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


235 
__MATHDECL_1
 (,
i¢ª
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

238 
__MATHCALL
 (
j0
,, (
_MdoubË_
));

239 
__MATHCALL
 (
j1
,, (
_MdoubË_
));

240 
__MATHCALL
 (
jn
,, (, 
_MdoubË_
));

241 
__MATHCALL
 (
y0
,, (
_MdoubË_
));

242 
__MATHCALL
 (
y1
,, (
_MdoubË_
));

243 
__MATHCALL
 (
yn
,, (, 
_MdoubË_
));

247 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
 || defšed 
__USE_ISOC99


248 
__BEGIN_NAMESPACE_C99


250 
__MATHCALL
 (
”f
,, (
_MdoubË_
));

251 
__MATHCALL
 (
”fc
,, (
_MdoubË_
));

252 
__MATHCALL
 (
lgamma
,, (
_MdoubË_
));

253 
	g__END_NAMESPACE_C99


256 #ifdeà
__USE_ISOC99


257 
__BEGIN_NAMESPACE_C99


259 
__MATHCALL
 (
tgamma
,, (
_MdoubË_
));

260 
	g__END_NAMESPACE_C99


263 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


265 
__MATHCALL
 (
gamma
,, (
_MdoubË_
));

268 #ifdeà
__USE_MISC


272 
__MATHCALL
 (
lgamma
,
_r
, (
_MdoubË_
, *
__signgamp
));

276 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


277 
__BEGIN_NAMESPACE_C99


280 
__MATHCALL
 (
ršt
,, (
_MdoubË_
 
__x
));

283 
__MATHCALLX
 (
Ãxá”
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

284 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__LDBL_COMPAT


285 
__MATHCALLX
 (
Ãx‰ow¬d
,, (
_MdoubË_
 
__x
, 
__y
), (
__cÚ¡__
));

289 
__MATHCALL
 (
»mašd”
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

291 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


293 
__MATHCALL
 (
sÿlbn
,, (
_MdoubË_
 
__x
, 
__n
));

297 
__MATHDECL
 (,
ogb
,, (
_MdoubË_
 
__x
));

300 #ifdeà
__USE_ISOC99


302 
__MATHCALL
 (
sÿlbÊ
,, (
_MdoubË_
 
__x
, 
__n
));

306 
__MATHCALL
 (
Ã¬byšt
,, (
_MdoubË_
 
__x
));

310 
__MATHCALLX
 (
round
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

314 
__MATHCALLX
 (
Œunc
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

319 
__MATHCALL
 (
»mquo
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
, *
__quo
));

326 
__MATHDECL
 (,
Ìšt
,, (
_MdoubË_
 
__x
));

327 
__MATHDECL
 (,
Îršt
,, (
_MdoubË_
 
__x
));

331 
__MATHDECL
 (,
Ìound
,, (
_MdoubË_
 
__x
));

332 
__MATHDECL
 (,
Îround
,, (
_MdoubË_
 
__x
));

336 
__MATHCALL
 (
fdim
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

339 
__MATHCALL
 (
fmax
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

342 
__MATHCALL
 (
fmš
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

346 
__MATHDECL_1
 (, 
__åşassify
,, (
_MdoubË_
 
__v®ue
))

347 
__©Œibu‹__
 ((
__cÚ¡__
));

350 
__MATHDECL_1
 (, 
__signb™
,, (
_MdoubË_
 
__v®ue
))

351 
__©Œibu‹__
 ((
__cÚ¡__
));

355 
__MATHCALL
 (
fma
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
, _MdoubË_ 
__z
));

358 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


359 
	g__END_NAMESPACE_C99


362 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


364 
__MATHCALL
 (
sÿlb
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__n
));

	@/usr/include/bits/mathdef.h

19 #ià!
defšed
 
_MATH_H
 && !defšed 
_COMPLEX_H


23 #ià
defšed
 
__USE_ISOC99
 && defšed 
_MATH_H
 && !defšed 
_MATH_H_MATHDEF


24 
	#_MATH_H_MATHDEF
 1

	)

26 
	~<b™s/wÜdsize.h
>

28 #ià
__WORDSIZE
 =ğ64 || (
defšed
 
__FLT_EVAL_METHOD__
 && __FLT_EVAL_METHOD__ == 0)

31 
	tæßt_t
;

32 
	tdoubË_t
;

38 
	tæßt_t
;

40 
	tdoubË_t
;

45 
	#FP_ILOGB0
 (-2147483647 - 1)

	)

46 
	#FP_ILOGBNAN
 (-2147483647 - 1)

	)

	@/usr/include/bits/mathinline.h

21 #iâdeà
_MATH_H


25 #iâdeà
__ex‹º_šlše


26 
	#__MATH_INLINE
 
__šlše


	)

28 
	#__MATH_INLINE
 
__ex‹º_šlše


	)

32 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__
 && __GNUC__ >= 2

35 
__MATH_INLINE
 

36 
__NTH
 (
	$__signb™f
 (
__x
))

38 
__ex‹nsiÚ__
 uniÚ { 
__f
; 
__i
; } 
__u
 = { __f: 
__x
 };

39  
__u
.
__i
 < 0;

40 
	}
}

41 
__MATH_INLINE
 

42 
__NTH
 (
	$__signb™
 (
__x
))

44 
__ex‹nsiÚ__
 uniÚ { 
__d
; 
__i
[2]; } 
__u
 = { __d: 
__x
 };

45  
__u
.
__i
[1] < 0;

46 
	}
}

47 
__MATH_INLINE
 

48 
__NTH
 (
	$__signb™l
 (
__x
))

50 
__ex‹nsiÚ__
 uniÚ { 
__l
; 
__i
[3]; } 
__u
 = { __l: 
__x
 };

51  (
__u
.
__i
[2] & 0x8000) != 0;

52 
	}
}

	@/usr/include/bits/mman.h

20 #iâdeà
_SYS_MMAN_H


33 
	#PROT_READ
 0x1

	)

34 
	#PROT_WRITE
 0x2

	)

35 
	#PROT_EXEC
 0x4

	)

36 
	#PROT_NONE
 0x0

	)

37 
	#PROT_GROWSDOWN
 0x01000000

	)

39 
	#PROT_GROWSUP
 0x02000000

	)

43 
	#MAP_SHARED
 0x01

	)

44 
	#MAP_PRIVATE
 0x02

	)

45 #ifdeà
__USE_MISC


46 
	#MAP_TYPE
 0x0à

	)

50 
	#MAP_FIXED
 0x10

	)

51 #ifdeà
__USE_MISC


52 
	#MAP_FILE
 0

	)

53 
	#MAP_ANONYMOUS
 0x20

	)

54 
	#MAP_ANON
 
MAP_ANONYMOUS


	)

55 
	#MAP_32BIT
 0x40

	)

59 #ifdeà
__USE_MISC


60 
	#MAP_GROWSDOWN
 0x00100

	)

61 
	#MAP_DENYWRITE
 0x00800

	)

62 
	#MAP_EXECUTABLE
 0x01000

	)

63 
	#MAP_LOCKED
 0x02000

	)

64 
	#MAP_NORESERVE
 0x04000

	)

65 
	#MAP_POPULATE
 0x08000

	)

66 
	#MAP_NONBLOCK
 0x10000

	)

67 
	#MAP_STACK
 0x20000

	)

71 
	#MS_ASYNC
 1

	)

72 
	#MS_SYNC
 4

	)

73 
	#MS_INVALIDATE
 2

	)

76 
	#MCL_CURRENT
 1

	)

77 
	#MCL_FUTURE
 2

	)

81 #ifdeà
__USE_GNU


82 
	#MREMAP_MAYMOVE
 1

	)

83 
	#MREMAP_FIXED
 2

	)

87 #ifdeà
__USE_BSD


88 
	#MADV_NORMAL
 0

	)

89 
	#MADV_RANDOM
 1

	)

90 
	#MADV_SEQUENTIAL
 2

	)

91 
	#MADV_WILLNEED
 3

	)

92 
	#MADV_DONTNEED
 4

	)

93 
	#MADV_REMOVE
 9

	)

94 
	#MADV_DONTFORK
 10

	)

95 
	#MADV_DOFORK
 11

	)

99 #ifdeà
__USE_XOPEN2K


100 
	#POSIX_MADV_NORMAL
 0

	)

101 
	#POSIX_MADV_RANDOM
 1

	)

102 
	#POSIX_MADV_SEQUENTIAL
 2

	)

103 
	#POSIX_MADV_WILLNEED
 3

	)

104 
	#POSIX_MADV_DONTNEED
 4

	)

	@/usr/include/bits/nan.h

20 #iâdeà
_MATH_H


27 #ià
__GNUC_PREREQ
(3,3)

29 
	#NAN
 (
	`__butš_Çnf
 (""))

	)

31 #–ià
defšed
 
__GNUC__


33 
	#NAN
 \

34 (
__ex‹nsiÚ__
 \

35 ((uniÚ { 
__l
 
	`__©Œibu‹__
 ((
	`__mode__
 (
__SI__
))); 
__d
; }) \

36 { 
__l
: 0x7fc00000UL }).
__d
)

	)

40 
	~<’dŸn.h
>

42 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


43 
	#__Çn_by‹s
 { 0x7f, 0xc0, 0, 0 }

	)

45 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


46 
	#__Çn_by‹s
 { 0, 0, 0xc0, 0x7à}

	)

49 uniÚ { 
	m__c
[4]; 
	m__d
; } 
__Çn_uniÚ


50 
	g__©Œibu‹_u£d__
 = { 
__Çn_by‹s
 };

51 
	#NAN
 (
__Çn_uniÚ
.
__d
)

	)

	@/usr/include/bits/poll.h

19 #iâdeà
_SYS_POLL_H


26 
	#POLLIN
 0x001

	)

27 
	#POLLPRI
 0x002

	)

28 
	#POLLOUT
 0x004

	)

30 #ifdeà
__USE_XOPEN


32 
	#POLLRDNORM
 0x040

	)

33 
	#POLLRDBAND
 0x080

	)

34 
	#POLLWRNORM
 0x100

	)

35 
	#POLLWRBAND
 0x200

	)

38 #ifdeà
__USE_GNU


40 
	#POLLMSG
 0x400

	)

41 
	#POLLREMOVE
 0x1000

	)

42 
	#POLLRDHUP
 0x2000

	)

48 
	#POLLERR
 0x008

	)

49 
	#POLLHUP
 0x010

	)

50 
	#POLLNVAL
 0x020

	)

	@/usr/include/bits/posix1_lim.h

25 #iâdef 
_BITS_POSIX1_LIM_H


26 
	#_BITS_POSIX1_LIM_H
 1

	)

32 
	#_POSIX_AIO_LISTIO_MAX
 2

	)

35 
	#_POSIX_AIO_MAX
 1

	)

38 
	#_POSIX_ARG_MAX
 4096

	)

41 #ifdeà
__USE_XOPEN2K


42 
	#_POSIX_CHILD_MAX
 25

	)

44 
	#_POSIX_CHILD_MAX
 6

	)

48 
	#_POSIX_DELAYTIMER_MAX
 32

	)

52 
	#_POSIX_HOST_NAME_MAX
 255

	)

55 
	#_POSIX_LINK_MAX
 8

	)

58 
	#_POSIX_LOGIN_NAME_MAX
 9

	)

61 
	#_POSIX_MAX_CANON
 255

	)

65 
	#_POSIX_MAX_INPUT
 255

	)

68 
	#_POSIX_MQ_OPEN_MAX
 8

	)

71 
	#_POSIX_MQ_PRIO_MAX
 32

	)

74 
	#_POSIX_NAME_MAX
 14

	)

77 #ifdeà
__USE_XOPEN2K


78 
	#_POSIX_NGROUPS_MAX
 8

	)

80 
	#_POSIX_NGROUPS_MAX
 0

	)

84 #ifdeà
__USE_XOPEN2K


85 
	#_POSIX_OPEN_MAX
 20

	)

87 
	#_POSIX_OPEN_MAX
 16

	)

92 
	#_POSIX_FD_SETSIZE
 
_POSIX_OPEN_MAX


	)

95 
	#_POSIX_PATH_MAX
 256

	)

98 
	#_POSIX_PIPE_BUF
 512

	)

102 
	#_POSIX_RE_DUP_MAX
 255

	)

105 
	#_POSIX_RTSIG_MAX
 8

	)

108 
	#_POSIX_SEM_NSEMS_MAX
 256

	)

111 
	#_POSIX_SEM_VALUE_MAX
 32767

	)

114 
	#_POSIX_SIGQUEUE_MAX
 32

	)

117 
	#_POSIX_SSIZE_MAX
 32767

	)

120 
	#_POSIX_STREAM_MAX
 8

	)

123 
	#_POSIX_SYMLINK_MAX
 255

	)

127 
	#_POSIX_SYMLOOP_MAX
 8

	)

130 
	#_POSIX_TIMER_MAX
 32

	)

133 
	#_POSIX_TTY_NAME_MAX
 9

	)

136 
	#_POSIX_TZNAME_MAX
 6

	)

139 
	#_POSIX_QLIMIT
 1

	)

143 
	#_POSIX_HIWAT
 
_POSIX_PIPE_BUF


	)

146 
	#_POSIX_UIO_MAXIOV
 16

	)

149 
	#_POSIX_CLOCKRES_MIN
 20000000

	)

153 
	~<b™s/loÿl_lim.h
>

156 #iâdef 
SSIZE_MAX


157 
	#SSIZE_MAX
 
LONG_MAX


	)

164 #iâdef 
NGROUPS_MAX


165 
	#NGROUPS_MAX
 8

	)

	@/usr/include/bits/posix2_lim.h

23 #iâdef 
_BITS_POSIX2_LIM_H


24 
	#_BITS_POSIX2_LIM_H
 1

	)

28 
	#_POSIX2_BC_BASE_MAX
 99

	)

31 
	#_POSIX2_BC_DIM_MAX
 2048

	)

34 
	#_POSIX2_BC_SCALE_MAX
 99

	)

37 
	#_POSIX2_BC_STRING_MAX
 1000

	)

41 
	#_POSIX2_COLL_WEIGHTS_MAX
 2

	)

45 
	#_POSIX2_EXPR_NEST_MAX
 32

	)

48 
	#_POSIX2_LINE_MAX
 2048

	)

52 
	#_POSIX2_RE_DUP_MAX
 255

	)

56 
	#_POSIX2_CHARCLASS_NAME_MAX
 14

	)

63 #iâdef 
BC_BASE_MAX


64 
	#BC_BASE_MAX
 
_POSIX2_BC_BASE_MAX


	)

66 #iâdef 
BC_DIM_MAX


67 
	#BC_DIM_MAX
 
_POSIX2_BC_DIM_MAX


	)

69 #iâdef 
BC_SCALE_MAX


70 
	#BC_SCALE_MAX
 
_POSIX2_BC_SCALE_MAX


	)

72 #iâdef 
BC_STRING_MAX


73 
	#BC_STRING_MAX
 
_POSIX2_BC_STRING_MAX


	)

75 #iâdef 
COLL_WEIGHTS_MAX


76 
	#COLL_WEIGHTS_MAX
 255

	)

78 #iâdef 
EXPR_NEST_MAX


79 
	#EXPR_NEST_MAX
 
_POSIX2_EXPR_NEST_MAX


	)

81 #iâdef 
LINE_MAX


82 
	#LINE_MAX
 
_POSIX2_LINE_MAX


	)

84 #iâdef 
CHARCLASS_NAME_MAX


85 
	#CHARCLASS_NAME_MAX
 2048

	)

89 
	#RE_DUP_MAX
 (0x7fff)

	)

	@/usr/include/bits/posix_opt.h

20 #iâdef 
_POSIX_OPT_H


21 
	#_POSIX_OPT_H
 1

	)

24 
	#_POSIX_JOB_CONTROL
 1

	)

27 
	#_POSIX_SAVED_IDS
 1

	)

30 
	#_POSIX_PRIORITY_SCHEDULING
 200112L

	)

33 
	#_POSIX_SYNCHRONIZED_IO
 200112L

	)

36 
	#_POSIX_FSYNC
 200112L

	)

39 
	#_POSIX_MAPPED_FILES
 200112L

	)

42 
	#_POSIX_MEMLOCK
 200112L

	)

45 
	#_POSIX_MEMLOCK_RANGE
 200112L

	)

48 
	#_POSIX_MEMORY_PROTECTION
 200112L

	)

51 
	#_POSIX_CHOWN_RESTRICTED
 0

	)

55 
	#_POSIX_VDISABLE
 '\0'

	)

58 
	#_POSIX_NO_TRUNC
 1

	)

61 
	#_XOPEN_REALTIME
 1

	)

64 
	#_XOPEN_REALTIME_THREADS
 1

	)

67 
	#_XOPEN_SHM
 1

	)

70 
	#_POSIX_THREADS
 200112L

	)

73 
	#_POSIX_REENTRANT_FUNCTIONS
 1

	)

74 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 200112L

	)

77 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 200112L

	)

80 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200112L

	)

83 
	#_POSIX_THREAD_ATTR_STACKADDR
 200112L

	)

86 
	#_POSIX_THREAD_PRIO_INHERIT
 200112L

	)

90 
	#_POSIX_THREAD_PRIO_PROTECT
 200112L

	)

93 
	#_POSIX_SEMAPHORES
 200112L

	)

96 
	#_POSIX_REALTIME_SIGNALS
 200112L

	)

99 
	#_POSIX_ASYNCHRONOUS_IO
 200112L

	)

100 
	#_POSIX_ASYNC_IO
 1

	)

102 
	#_LFS_ASYNCHRONOUS_IO
 1

	)

104 
	#_POSIX_PRIORITIZED_IO
 200112L

	)

107 
	#_LFS64_ASYNCHRONOUS_IO
 1

	)

110 
	#_LFS_LARGEFILE
 1

	)

111 
	#_LFS64_LARGEFILE
 1

	)

112 
	#_LFS64_STDIO
 1

	)

115 
	#_POSIX_SHARED_MEMORY_OBJECTS
 200112L

	)

118 
	#_POSIX_CPUTIME
 0

	)

121 
	#_POSIX_THREAD_CPUTIME
 0

	)

124 
	#_POSIX_REGEXP
 1

	)

127 
	#_POSIX_READER_WRITER_LOCKS
 200112L

	)

130 
	#_POSIX_SHELL
 1

	)

133 
	#_POSIX_TIMEOUTS
 200112L

	)

136 
	#_POSIX_SPIN_LOCKS
 200112L

	)

139 
	#_POSIX_SPAWN
 200112L

	)

142 
	#_POSIX_TIMERS
 200112L

	)

145 
	#_POSIX_BARRIERS
 200112L

	)

148 
	#_POSIX_MESSAGE_PASSING
 200112L

	)

151 
	#_POSIX_THREAD_PROCESS_SHARED
 200112L

	)

154 
	#_POSIX_MONOTONIC_CLOCK
 0

	)

157 
	#_POSIX_CLOCK_SELECTION
 200112L

	)

160 
	#_POSIX_ADVISORY_INFO
 200112L

	)

163 
	#_POSIX_IPV6
 200112L

	)

166 
	#_POSIX_RAW_SOCKETS
 200112L

	)

169 
	#_POSIX2_CHAR_TERM
 200112L

	)

172 
	#_POSIX_SPORADIC_SERVER
 -1

	)

173 
	#_POSIX_THREAD_SPORADIC_SERVER
 -1

	)

176 
	#_POSIX_TRACE
 -1

	)

177 
	#_POSIX_TRACE_EVENT_FILTER
 -1

	)

178 
	#_POSIX_TRACE_INHERIT
 -1

	)

179 
	#_POSIX_TRACE_LOG
 -1

	)

182 
	#_POSIX_TYPED_MEMORY_OBJECTS
 -1

	)

	@/usr/include/bits/pthreadtypes.h

20 #iâdeà
_BITS_PTHREADTYPES_H


21 
	#_BITS_PTHREADTYPES_H
 1

	)

23 
	~<b™s/wÜdsize.h
>

25 #ià
__WORDSIZE
 == 64

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

28 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

29 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

30 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

31 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

32 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

33 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

34 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

36 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

37 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

38 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

39 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

40 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

41 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

42 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

43 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

44 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

50 
	t±h»ad_t
;

55 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

56 
	m__®ign
;

57 } 
	t±h»ad_©Œ_t
;

60 #ià
__WORDSIZE
 == 64

61 
	s__±h»ad_š‹º®_li¡


63 
__±h»ad_š‹º®_li¡
 *
	m__´ev
;

64 
__±h»ad_š‹º®_li¡
 *
	m__Ãxt
;

65 } 
	t__±h»ad_li¡_t
;

67 
	s__±h»ad_š‹º®_¦i¡


69 
__±h»ad_š‹º®_¦i¡
 *
	m__Ãxt
;

70 } 
	t__±h»ad_¦i¡_t
;

78 
	s__±h»ad_mu‹x_s


80 
	m__lock
;

81 
	m__couÁ
;

82 
	m__owÃr
;

83 #ià
__WORDSIZE
 == 64

84 
	m__nu£rs
;

88 
	m__kšd
;

89 #ià
__WORDSIZE
 == 64

90 
	m__¥šs
;

91 
__±h»ad_li¡_t
 
	m__li¡
;

92 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

94 
	m__nu£rs
;

95 
__ex‹nsiÚ__
 union

97 
	m__¥šs
;

98 
__±h»ad_¦i¡_t
 
	m__li¡
;

101 } 
	m__d©a
;

102 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

103 
	m__®ign
;

104 } 
	t±h»ad_mu‹x_t
;

108 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

109 
	m__®ign
;

110 } 
	t±h»ad_mu‹x©Œ_t
;

119 
	m__lock
;

120 
	m__fu‹x
;

121 
__ex‹nsiÚ__
 
	m__tÙ®_£q
;

122 
__ex‹nsiÚ__
 
	m__wakeup_£q
;

123 
__ex‹nsiÚ__
 
	m__wok’_£q
;

124 *
	m__mu‹x
;

125 
	m__nwa™”s
;

126 
	m__brßdÿ¡_£q
;

127 } 
	m__d©a
;

128 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

129 
__ex‹nsiÚ__
 
	m__®ign
;

130 } 
	t±h»ad_cÚd_t
;

134 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

135 
	m__®ign
;

136 } 
	t±h»ad_cÚd©Œ_t
;

140 
	t±h»ad_key_t
;

144 
	t±h»ad_Úû_t
;

147 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


152 #ià
__WORDSIZE
 == 64

155 
	m__lock
;

156 
	m__Ä_»ad”s
;

157 
	m__»ad”s_wakeup
;

158 
	m__wr™”_wakeup
;

159 
	m__Ä_»ad”s_queued
;

160 
	m__Ä_wr™”s_queued
;

161 
	m__wr™”
;

162 
	m__sh¬ed
;

163 
	m__·d1
;

164 
	m__·d2
;

167 
	m__æags
;

168 } 
	m__d©a
;

172 
	m__lock
;

173 
	m__Ä_»ad”s
;

174 
	m__»ad”s_wakeup
;

175 
	m__wr™”_wakeup
;

176 
	m__Ä_»ad”s_queued
;

177 
	m__Ä_wr™”s_queued
;

180 
	m__æags
;

181 
	m__sh¬ed
;

182 
	m__·d1
;

183 
	m__·d2
;

184 
	m__wr™”
;

185 } 
	m__d©a
;

187 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

188 
	m__®ign
;

189 } 
	t±h»ad_rwlock_t
;

193 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

194 
	m__®ign
;

195 } 
	t±h»ad_rwlock©Œ_t
;

199 #ifdeà
__USE_XOPEN2K


201 vŞ©
	t±h»ad_¥šlock_t
;

208 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

209 
	m__®ign
;

210 } 
	t±h»ad_b¬r›r_t
;

214 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

215 
	m__®ign
;

216 } 
	t±h»ad_b¬r›¿‰r_t
;

220 #ià
__WORDSIZE
 == 32

222 
	#__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
	`__»g·rm__
 (1)))

	)

	@/usr/include/bits/resource.h

21 #iâdeà
_SYS_RESOURCE_H


25 
	~<b™s/ty³s.h
>

33 
	e__¾im™_»sourû


36 
	mRLIMIT_CPU
 = 0,

37 
	#RLIMIT_CPU
 
RLIMIT_CPU


	)

40 
	mRLIMIT_FSIZE
 = 1,

41 
	#RLIMIT_FSIZE
 
RLIMIT_FSIZE


	)

44 
	mRLIMIT_DATA
 = 2,

45 
	#RLIMIT_DATA
 
RLIMIT_DATA


	)

48 
	mRLIMIT_STACK
 = 3,

49 
	#RLIMIT_STACK
 
RLIMIT_STACK


	)

52 
	mRLIMIT_CORE
 = 4,

53 
	#RLIMIT_CORE
 
RLIMIT_CORE


	)

59 
	m__RLIMIT_RSS
 = 5,

60 
	#RLIMIT_RSS
 
__RLIMIT_RSS


	)

63 
	mRLIMIT_NOFILE
 = 7,

64 
	m__RLIMIT_OFILE
 = 
RLIMIT_NOFILE
,

65 
	#RLIMIT_NOFILE
 
RLIMIT_NOFILE


	)

66 
	#RLIMIT_OFILE
 
__RLIMIT_OFILE


	)

69 
	mRLIMIT_AS
 = 9,

70 
	#RLIMIT_AS
 
RLIMIT_AS


	)

73 
	m__RLIMIT_NPROC
 = 6,

74 
	#RLIMIT_NPROC
 
__RLIMIT_NPROC


	)

77 
	m__RLIMIT_MEMLOCK
 = 8,

78 
	#RLIMIT_MEMLOCK
 
__RLIMIT_MEMLOCK


	)

81 
	m__RLIMIT_LOCKS
 = 10,

82 
	#RLIMIT_LOCKS
 
__RLIMIT_LOCKS


	)

85 
	m__RLIMIT_SIGPENDING
 = 11,

86 
	#RLIMIT_SIGPENDING
 
__RLIMIT_SIGPENDING


	)

89 
	m__RLIMIT_MSGQUEUE
 = 12,

90 
	#RLIMIT_MSGQUEUE
 
__RLIMIT_MSGQUEUE


	)

95 
	m__RLIMIT_NICE
 = 13,

96 
	#RLIMIT_NICE
 
__RLIMIT_NICE


	)

100 
	m__RLIMIT_RTPRIO
 = 14,

101 
	#RLIMIT_RTPRIO
 
__RLIMIT_RTPRIO


	)

103 
	m__RLIMIT_NLIMITS
 = 15,

104 
	m__RLIM_NLIMITS
 = 
__RLIMIT_NLIMITS


105 
	#RLIMIT_NLIMITS
 
__RLIMIT_NLIMITS


	)

106 
	#RLIM_NLIMITS
 
__RLIM_NLIMITS


	)

110 #iâdeà
__USE_FILE_OFFSET64


111 
	#RLIM_INFINITY
 (()(~0UL))

	)

113 
	#RLIM_INFINITY
 0xffffffffffffffffuLL

	)

116 #ifdeà
__USE_LARGEFILE64


117 
	#RLIM64_INFINITY
 0xffffffffffffffffuLL

	)

121 
	#RLIM_SAVED_MAX
 
RLIM_INFINITY


	)

122 
	#RLIM_SAVED_CUR
 
RLIM_INFINITY


	)

126 #iâdeà
__USE_FILE_OFFSET64


127 
__¾im_t
 
	t¾im_t
;

129 
__¾im64_t
 
	t¾im_t
;

131 #ifdeà
__USE_LARGEFILE64


132 
__¾im64_t
 
	t¾im64_t
;

135 
	s¾im™


138 
¾im_t
 
	m¾im_cur
;

140 
¾im_t
 
	m¾im_max
;

143 #ifdeà
__USE_LARGEFILE64


144 
	s¾im™64


147 
¾im64_t
 
	m¾im_cur
;

149 
¾im64_t
 
	m¾im_max
;

154 
	e__ru§ge_who


157 
	mRUSAGE_SELF
 = 0,

158 
	#RUSAGE_SELF
 
RUSAGE_SELF


	)

161 
	mRUSAGE_CHILDREN
 = -1

162 
	#RUSAGE_CHILDREN
 
RUSAGE_CHILDREN


	)

164 #ifdeà
__USE_GNU


167 
	mRUSAGE_THREAD
 = 1

168 
	#RUSAGE_THREAD
 
RUSAGE_THREAD


	)

170 
	#RUSAGE_LWP
 
RUSAGE_THREAD


	)

174 
	#__Ãed_timev®


	)

175 
	~<b™s/time.h
>

178 
	sru§ge


181 
timev®
 
	mru_utime
;

183 
timev®
 
	mru_¡ime
;

185 
	mru_maxrss
;

188 
	mru_ixrss
;

190 
	mru_idrss
;

192 
	mru_i¤ss
;

195 
	mru_mšæt
;

197 
	mru_majæt
;

199 
	mru_nsw­
;

202 
	mru_šblock
;

204 
	mru_oublock
;

206 
	mru_msg¢d
;

208 
	mru_msgrcv
;

210 
	mru_nsigÇls
;

214 
	mru_nvcsw
;

217 
	mru_nivcsw
;

221 
	#PRIO_MIN
 -20

	)

222 
	#PRIO_MAX
 20

	)

226 
	e__´iÜ™y_which


228 
	mPRIO_PROCESS
 = 0,

229 
	#PRIO_PROCESS
 
PRIO_PROCESS


	)

230 
	mPRIO_PGRP
 = 1,

231 
	#PRIO_PGRP
 
PRIO_PGRP


	)

232 
	mPRIO_USER
 = 2

233 
	#PRIO_USER
 
PRIO_USER


	)

	@/usr/include/bits/sigaction.h

20 #iâdeà
_SIGNAL_H


25 
	ssigaùiÚ


28 #ifdeà
__USE_POSIX199309


32 
__sighªdËr_t
 
	m§_hªdËr
;

34 (*
	m§_sigaùiÚ
è(, 
	msigšfo_t
 *, *);

36 
	m__sigaùiÚ_hªdËr
;

37 
	#§_hªdËr
 
__sigaùiÚ_hªdËr
.
§_hªdËr


	)

38 
	#§_sigaùiÚ
 
__sigaùiÚ_hªdËr
.
§_sigaùiÚ


	)

40 
__sighªdËr_t
 
	m§_hªdËr
;

44 
__sig£t_t
 
	m§_mask
;

47 
	m§_æags
;

50 (*
	m§_»¡Ü”
) ();

54 
	#SA_NOCLDSTOP
 1

	)

55 
	#SA_NOCLDWAIT
 2

	)

56 
	#SA_SIGINFO
 4

	)

58 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_MISC


59 
	#SA_ONSTACK
 0x08000000

	)

60 
	#SA_RESTART
 0x10000000

	)

61 
	#SA_NODEFER
 0x40000000

	)

63 
	#SA_RESETHAND
 0x80000000

	)

65 #ifdeà
__USE_MISC


66 
	#SA_INTERRUPT
 0x20000000

	)

69 
	#SA_NOMASK
 
SA_NODEFER


	)

70 
	#SA_ONESHOT
 
SA_RESETHAND


	)

71 
	#SA_STACK
 
SA_ONSTACK


	)

75 
	#SIG_BLOCK
 0

	)

76 
	#SIG_UNBLOCK
 1

	)

77 
	#SIG_SETMASK
 2

	)

	@/usr/include/bits/sigcontext.h

19 #iâdeà
_BITS_SIGCONTEXT_H


20 
	#_BITS_SIGCONTEXT_H
 1

	)

22 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_SYS_UCONTEXT_H


26 
	~<b™s/wÜdsize.h
>

28 
	s_å»g


30 
	msignifiÿnd
[4];

31 
	mexpÚ’t
;

34 
	s_åx»g


36 
	msignifiÿnd
[4];

37 
	mexpÚ’t
;

38 
	m·ddšg
[3];

41 
	s_xmm»g


43 
__ušt32_t
 
	m–em’t
[4];

48 #ià
__WORDSIZE
 == 32

50 
	s_å¡©e


53 
__ušt32_t
 
	mcw
;

54 
__ušt32_t
 
	msw
;

55 
__ušt32_t
 
	mg
;

56 
__ušt32_t
 
	moff
;

57 
__ušt32_t
 
	mcs£l
;

58 
__ušt32_t
 
	md©aoff
;

59 
__ušt32_t
 
	md©a£l
;

60 
_å»g
 
	m_¡
[8];

61 
	m¡©us
;

62 
	mmagic
;

65 
__ušt32_t
 
	m_fx¤_’v
[6];

66 
__ušt32_t
 
	mmxc¤
;

67 
__ušt32_t
 
	m»£rved
;

68 
_åx»g
 
	m_fx¤_¡
[8];

69 
_xmm»g
 
	m_xmm
[8];

70 
__ušt32_t
 
	m·ddšg
[56];

73 #iâdeà
sigcÚ‹xt_¡ruù


78 
	#sigcÚ‹xt_¡ruù
 
sigcÚ‹xt


	)

81 
	ssigcÚ‹xt


83 
	mgs
, 
	m__gsh
;

84 
	mfs
, 
	m__fsh
;

85 
	mes
, 
	m__esh
;

86 
	mds
, 
	m__dsh
;

87 
	medi
;

88 
	mesi
;

89 
	mebp
;

90 
	me¥
;

91 
	mebx
;

92 
	medx
;

93 
	mecx
;

94 
	m—x
;

95 
	mŒ­no
;

96 
	m”r
;

97 
	me
;

98 
	mcs
, 
	m__csh
;

99 
	meæags
;

100 
	me¥_©_sigÇl
;

101 
	mss
, 
	m__ssh
;

102 
_å¡©e
 * 
	må¡©e
;

103 
	mŞdmask
;

104 
	mü2
;

109 
	s_å¡©e


112 
__ušt16_t
 
	mcwd
;

113 
__ušt16_t
 
	mswd
;

114 
__ušt16_t
 
	máw
;

115 
__ušt16_t
 
	mfİ
;

116 
__ušt64_t
 
	mr
;

117 
__ušt64_t
 
	mrdp
;

118 
__ušt32_t
 
	mmxc¤
;

119 
__ušt32_t
 
	mmxü_mask
;

120 
_åx»g
 
	m_¡
[8];

121 
_xmm»g
 
	m_xmm
[16];

122 
__ušt32_t
 
	m·ddšg
[24];

125 
	ssigcÚ‹xt


127 
	mr8
;

128 
	mr9
;

129 
	mr10
;

130 
	mr11
;

131 
	mr12
;

132 
	mr13
;

133 
	mr14
;

134 
	mr15
;

135 
	mrdi
;

136 
	mrsi
;

137 
	mrbp
;

138 
	mrbx
;

139 
	mrdx
;

140 
	m¿x
;

141 
	mrcx
;

142 
	mr¥
;

143 
	mr
;

144 
	meæags
;

145 
	mcs
;

146 
	mgs
;

147 
	mfs
;

148 
	m__·d0
;

149 
	m”r
;

150 
	mŒ­no
;

151 
	mŞdmask
;

152 
	mü2
;

153 
_å¡©e
 * 
	må¡©e
;

154 
	m__»£rved1
 [8];

	@/usr/include/bits/siginfo.h

20 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
__Ãed_sigšfo_t
 \

21 && !
defšed
 
	g__Ãed_sigev’t_t


25 
	~<b™s/wÜdsize.h
>

27 #ià(!
defšed
 
__have_sigv®_t
 \

28 && (
defšed
 
	g_SIGNAL_H
 || defšed 
	g__Ãed_sigšfo_t
 \

29 || 
defšed
 
	g__Ãed_sigev’t_t
))

30 
	#__have_sigv®_t
 1

	)

33 
	usigv®


35 
	msiv®_št
;

36 *
	msiv®_±r
;

37 } 
	tsigv®_t
;

40 #ià(!
defšed
 
__have_sigšfo_t
 \

41 && (
defšed
 
	g_SIGNAL_H
 || defšed 
	g__Ãed_sigšfo_t
))

42 
	#__have_sigšfo_t
 1

	)

44 
	#__SI_MAX_SIZE
 128

	)

45 #ià
__WORDSIZE
 == 64

46 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 4)

	)

48 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 3)

	)

51 
	ssigšfo


53 
	msi_signo
;

54 
	msi_”ºo
;

56 
	msi_code
;

60 
	m_·d
[
__SI_PAD_SIZE
];

65 
__pid_t
 
	msi_pid
;

66 
__uid_t
 
	msi_uid
;

67 } 
	m_kl
;

72 
	msi_tid
;

73 
	msi_ov”run
;

74 
sigv®_t
 
	msi_sigv®
;

75 } 
	m_tim”
;

80 
__pid_t
 
	msi_pid
;

81 
__uid_t
 
	msi_uid
;

82 
sigv®_t
 
	msi_sigv®
;

83 } 
	m_¹
;

88 
__pid_t
 
	msi_pid
;

89 
__uid_t
 
	msi_uid
;

90 
	msi_¡©us
;

91 
__şock_t
 
	msi_utime
;

92 
__şock_t
 
	msi_¡ime
;

93 } 
	m_sigchld
;

98 *
	msi_addr
;

99 } 
	m_sigçuÉ
;

104 
	msi_bªd
;

105 
	msi_fd
;

106 } 
	m_sigpŞl
;

107 } 
	m_sif›lds
;

108 } 
	tsigšfo_t
;

112 
	#si_pid
 
_sif›lds
.
_kl
.
si_pid


	)

113 
	#si_uid
 
_sif›lds
.
_kl
.
si_uid


	)

114 
	#si_tim”id
 
_sif›lds
.
_tim”
.
si_tid


	)

115 
	#si_ov”run
 
_sif›lds
.
_tim”
.
si_ov”run


	)

116 
	#si_¡©us
 
_sif›lds
.
_sigchld
.
si_¡©us


	)

117 
	#si_utime
 
_sif›lds
.
_sigchld
.
si_utime


	)

118 
	#si_¡ime
 
_sif›lds
.
_sigchld
.
si_¡ime


	)

119 
	#si_v®ue
 
_sif›lds
.
_¹
.
si_sigv®


	)

120 
	#si_št
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_št


	)

121 
	#si_±r
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_±r


	)

122 
	#si_addr
 
_sif›lds
.
_sigçuÉ
.
si_addr


	)

123 
	#si_bªd
 
_sif›lds
.
_sigpŞl
.
si_bªd


	)

124 
	#si_fd
 
_sif›lds
.
_sigpŞl
.
si_fd


	)

131 
	mSI_ASYNCNL
 = -60,

132 
	#SI_ASYNCNL
 
SI_ASYNCNL


	)

133 
	mSI_TKILL
 = -6,

134 
	#SI_TKILL
 
SI_TKILL


	)

135 
	mSI_SIGIO
,

136 
	#SI_SIGIO
 
SI_SIGIO


	)

137 
	mSI_ASYNCIO
,

138 
	#SI_ASYNCIO
 
SI_ASYNCIO


	)

139 
	mSI_MESGQ
,

140 
	#SI_MESGQ
 
SI_MESGQ


	)

141 
	mSI_TIMER
,

142 
	#SI_TIMER
 
SI_TIMER


	)

143 
	mSI_QUEUE
,

144 
	#SI_QUEUE
 
SI_QUEUE


	)

145 
	mSI_USER
,

146 
	#SI_USER
 
SI_USER


	)

147 
	mSI_KERNEL
 = 0x80

148 
	#SI_KERNEL
 
SI_KERNEL


	)

155 
	mILL_ILLOPC
 = 1,

156 
	#ILL_ILLOPC
 
ILL_ILLOPC


	)

157 
	mILL_ILLOPN
,

158 
	#ILL_ILLOPN
 
ILL_ILLOPN


	)

159 
	mILL_ILLADR
,

160 
	#ILL_ILLADR
 
ILL_ILLADR


	)

161 
	mILL_ILLTRP
,

162 
	#ILL_ILLTRP
 
ILL_ILLTRP


	)

163 
	mILL_PRVOPC
,

164 
	#ILL_PRVOPC
 
ILL_PRVOPC


	)

165 
	mILL_PRVREG
,

166 
	#ILL_PRVREG
 
ILL_PRVREG


	)

167 
	mILL_COPROC
,

168 
	#ILL_COPROC
 
ILL_COPROC


	)

169 
	mILL_BADSTK


170 
	#ILL_BADSTK
 
ILL_BADSTK


	)

176 
	mFPE_INTDIV
 = 1,

177 
	#FPE_INTDIV
 
FPE_INTDIV


	)

178 
	mFPE_INTOVF
,

179 
	#FPE_INTOVF
 
FPE_INTOVF


	)

180 
	mFPE_FLTDIV
,

181 
	#FPE_FLTDIV
 
FPE_FLTDIV


	)

182 
	mFPE_FLTOVF
,

183 
	#FPE_FLTOVF
 
FPE_FLTOVF


	)

184 
	mFPE_FLTUND
,

185 
	#FPE_FLTUND
 
FPE_FLTUND


	)

186 
	mFPE_FLTRES
,

187 
	#FPE_FLTRES
 
FPE_FLTRES


	)

188 
	mFPE_FLTINV
,

189 
	#FPE_FLTINV
 
FPE_FLTINV


	)

190 
	mFPE_FLTSUB


191 
	#FPE_FLTSUB
 
FPE_FLTSUB


	)

197 
	mSEGV_MAPERR
 = 1,

198 
	#SEGV_MAPERR
 
SEGV_MAPERR


	)

199 
	mSEGV_ACCERR


200 
	#SEGV_ACCERR
 
SEGV_ACCERR


	)

206 
	mBUS_ADRALN
 = 1,

207 
	#BUS_ADRALN
 
BUS_ADRALN


	)

208 
	mBUS_ADRERR
,

209 
	#BUS_ADRERR
 
BUS_ADRERR


	)

210 
	mBUS_OBJERR


211 
	#BUS_OBJERR
 
BUS_OBJERR


	)

217 
	mTRAP_BRKPT
 = 1,

218 
	#TRAP_BRKPT
 
TRAP_BRKPT


	)

219 
	mTRAP_TRACE


220 
	#TRAP_TRACE
 
TRAP_TRACE


	)

226 
	mCLD_EXITED
 = 1,

227 
	#CLD_EXITED
 
CLD_EXITED


	)

228 
	mCLD_KILLED
,

229 
	#CLD_KILLED
 
CLD_KILLED


	)

230 
	mCLD_DUMPED
,

231 
	#CLD_DUMPED
 
CLD_DUMPED


	)

232 
	mCLD_TRAPPED
,

233 
	#CLD_TRAPPED
 
CLD_TRAPPED


	)

234 
	mCLD_STOPPED
,

235 
	#CLD_STOPPED
 
CLD_STOPPED


	)

236 
	mCLD_CONTINUED


237 
	#CLD_CONTINUED
 
CLD_CONTINUED


	)

243 
	mPOLL_IN
 = 1,

244 
	#POLL_IN
 
POLL_IN


	)

245 
	mPOLL_OUT
,

246 
	#POLL_OUT
 
POLL_OUT


	)

247 
	mPOLL_MSG
,

248 
	#POLL_MSG
 
POLL_MSG


	)

249 
	mPOLL_ERR
,

250 
	#POLL_ERR
 
POLL_ERR


	)

251 
	mPOLL_PRI
,

252 
	#POLL_PRI
 
POLL_PRI


	)

253 
	mPOLL_HUP


254 
	#POLL_HUP
 
POLL_HUP


	)

257 #undeà
__Ãed_sigšfo_t


261 #ià(
defšed
 
_SIGNAL_H
 || defšed 
__Ãed_sigev’t_t
) \

262 && !
defšed
 
	g__have_sigev’t_t


263 
	#__have_sigev’t_t
 1

	)

266 
	#__SIGEV_MAX_SIZE
 64

	)

267 #ià
__WORDSIZE
 == 64

268 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 4)

	)

270 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 3)

	)

273 
	ssigev’t


275 
sigv®_t
 
	msigev_v®ue
;

276 
	msigev_signo
;

277 
	msigev_nÙify
;

281 
	m_·d
[
__SIGEV_PAD_SIZE
];

285 
__pid_t
 
	m_tid
;

289 (*
	m_funùiÚ
è(
	msigv®_t
);

290 *
	m_©Œibu‹
;

291 } 
	m_sigev_th»ad
;

292 } 
	m_sigev_un
;

293 } 
	tsigev’t_t
;

296 
	#sigev_nÙify_funùiÚ
 
_sigev_un
.
_sigev_th»ad
.
_funùiÚ


	)

297 
	#sigev_nÙify_©Œibu‹s
 
_sigev_un
.
_sigev_th»ad
.
_©Œibu‹


	)

302 
	mSIGEV_SIGNAL
 = 0,

303 
	#SIGEV_SIGNAL
 
SIGEV_SIGNAL


	)

304 
	mSIGEV_NONE
,

305 
	#SIGEV_NONE
 
SIGEV_NONE


	)

306 
	mSIGEV_THREAD
,

307 
	#SIGEV_THREAD
 
SIGEV_THREAD


	)

309 
	mSIGEV_THREAD_ID
 = 4

310 
	#SIGEV_THREAD_ID
 
SIGEV_THREAD_ID


	)

	@/usr/include/bits/signum.h

20 #ifdef 
_SIGNAL_H


23 
	#SIG_ERR
 ((
__sighªdËr_t
è-1è

	)

24 
	#SIG_DFL
 ((
__sighªdËr_t
è0è

	)

25 
	#SIG_IGN
 ((
__sighªdËr_t
è1è

	)

27 #ifdeà
__USE_UNIX98


28 
	#SIG_HOLD
 ((
__sighªdËr_t
è2è

	)

33 
	#SIGHUP
 1

	)

34 
	#SIGINT
 2

	)

35 
	#SIGQUIT
 3

	)

36 
	#SIGILL
 4

	)

37 
	#SIGTRAP
 5

	)

38 
	#SIGABRT
 6

	)

39 
	#SIGIOT
 6

	)

40 
	#SIGBUS
 7

	)

41 
	#SIGFPE
 8

	)

42 
	#SIGKILL
 9

	)

43 
	#SIGUSR1
 10

	)

44 
	#SIGSEGV
 11

	)

45 
	#SIGUSR2
 12

	)

46 
	#SIGPIPE
 13

	)

47 
	#SIGALRM
 14

	)

48 
	#SIGTERM
 15

	)

49 
	#SIGSTKFLT
 16

	)

50 
	#SIGCLD
 
SIGCHLD


	)

51 
	#SIGCHLD
 17

	)

52 
	#SIGCONT
 18

	)

53 
	#SIGSTOP
 19

	)

54 
	#SIGTSTP
 20

	)

55 
	#SIGTTIN
 21

	)

56 
	#SIGTTOU
 22

	)

57 
	#SIGURG
 23

	)

58 
	#SIGXCPU
 24

	)

59 
	#SIGXFSZ
 25

	)

60 
	#SIGVTALRM
 26

	)

61 
	#SIGPROF
 27

	)

62 
	#SIGWINCH
 28

	)

63 
	#SIGPOLL
 
SIGIO


	)

64 
	#SIGIO
 29

	)

65 
	#SIGPWR
 30

	)

66 
	#SIGSYS
 31

	)

67 
	#SIGUNUSED
 31

	)

69 
	#_NSIG
 65

	)

72 
	#SIGRTMIN
 (
	`__libc_cu¼’t_sig¹mš
 ())

	)

73 
	#SIGRTMAX
 (
	`__libc_cu¼’t_sig¹max
 ())

	)

77 
	#__SIGRTMIN
 32

	)

78 
	#__SIGRTMAX
 (
_NSIG
 - 1)

	)

	@/usr/include/bits/sigset.h

21 #iâdef 
_SIGSET_H_ty³s


22 
	#_SIGSET_H_ty³s
 1

	)

24 
	t__sig_©omic_t
;

28 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

31 
	m__v®
[
_SIGSET_NWORDS
];

32 } 
	t__sig£t_t
;

43 #ià!
defšed
 
_SIGSET_H_âs
 && defšed 
_SIGNAL_H


44 
	#_SIGSET_H_âs
 1

	)

46 #iâdeà
_EXTERN_INLINE


47 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

51 
	#__sigmask
(
sig
) \

52 (((è1è<< (((
sig
è- 1è% (8 *  ())))

	)

55 
	#__sigwÜd
(
sig
è(((sigè- 1è/ (8 *  ()))

	)

57 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

58 
	#__sigem±y£t
(
£t
) \

59 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

60 
sig£t_t
 *
__£t
 = (
£t
); \

61 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = 0; \

62 0; }))

	)

63 
	#__sigfl£t
(
£t
) \

64 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

65 
sig£t_t
 *
__£t
 = (
£t
); \

66 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = ~0UL; \

67 0; }))

	)

69 #ifdeà
__USE_GNU


73 
	#__sigi£m±y£t
(
£t
) \

74 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

75 cÚ¡ 
sig£t_t
 *
__£t
 = (
£t
); \

76 
__»t
 = 
__£t
->
__v®
[--
__út
]; \

77 !
__»t
 && --
__út
 >= 0) \

78 
__»t
 = 
__£t
->
__v®
[
__út
]; \

79 
__»t
 =ğ0; }))

	)

80 
	#__sigªd£t
(
de¡
, 
Ëá
, 
right
) \

81 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

82 
sig£t_t
 *
__de¡
 = (
de¡
); \

83 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

84 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

85 --
__út
 >= 0) \

86 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

87 & 
__right
->
__v®
[
__út
]); \

88 0; }))

	)

89 
	#__sigÜ£t
(
de¡
, 
Ëá
, 
right
) \

90 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

91 
sig£t_t
 *
__de¡
 = (
de¡
); \

92 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

93 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

94 --
__út
 >= 0) \

95 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

96 | 
__right
->
__v®
[
__út
]); \

97 0; }))

	)

104 
__sigismemb”
 (
__cÚ¡
 
__sig£t_t
 *, );

105 
__sigadd£t
 (
__sig£t_t
 *, );

106 
__sigd–£t
 (
__sig£t_t
 *, );

108 #ifdeà
__USE_EXTERN_INLINES


109 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

110 
_EXTERN_INLINE
 \

111 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

113 
__mask
 = 
	`__sigmask
 (
__sig
); \

114 
__wÜd
 = 
	`__sigwÜd
 (
__sig
); \

115  
BODY
; \

116 }

	)

118 
__SIGSETFN
 (
__sigismemb”
, (
__£t
->
__v®
[
__wÜd
] & 
__mask
è? 1 : 0, 
__cÚ¡
)

119 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__v®
[
__wÜd
] |ğ
__mask
), 0), )

120 
__SIGSETFN
 (
__sigd–£t
, ((
__£t
->
__v®
[
__wÜd
] &ğ~
__mask
), 0), )

122 #undeà
__SIGSETFN


	@/usr/include/bits/sigstack.h

20 #iâdeà
_SIGNAL_H


26 
	ssig¡ack


28 *
	mss_¥
;

29 
	mss_Ú¡ack
;

36 
	mSS_ONSTACK
 = 1,

37 
	#SS_ONSTACK
 
SS_ONSTACK


	)

38 
	mSS_DISABLE


39 
	#SS_DISABLE
 
SS_DISABLE


	)

43 
	#MINSIGSTKSZ
 2048

	)

46 
	#SIGSTKSZ
 8192

	)

50 
	ssig®t¡ack


52 *
	mss_¥
;

53 
	mss_æags
;

54 
size_t
 
	mss_size
;

55 } 
	t¡ack_t
;

	@/usr/include/bits/sigthread.h

20 #iâdeà
_BITS_SIGTHREAD_H


21 
	#_BITS_SIGTHREAD_H
 1

	)

23 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_PTHREAD_H


31 
	$±h»ad_sigmask
 (
__how
,

32 
__cÚ¡
 
__sig£t_t
 *
__»¡riù
 
__Ãwmask
,

33 
__sig£t_t
 *
__»¡riù
 
__Şdmask
)
__THROW
;

36 
	$±h»ad_kl
 (
±h»ad_t
 
__th»adid
, 
__signo
è
__THROW
;

	@/usr/include/bits/sockaddr.h

24 #iâdeà
_BITS_SOCKADDR_H


25 
	#_BITS_SOCKADDR_H
 1

	)

29 
	t§_çmy_t
;

35 
	#__SOCKADDR_COMMON
(
§_´efix
) \

36 
§_çmy_t
 
§_´efix
##
çmy


	)

38 
	#__SOCKADDR_COMMON_SIZE
 ( ())

	)

	@/usr/include/bits/socket.h

21 #iâdeà
__BITS_SOCKET_H


22 
	#__BITS_SOCKET_H


	)

24 #iâdeà
_SYS_SOCKET_H


28 
	#__Ãed_size_t


	)

29 
	~<¡ddef.h
>

31 
	~<sys/ty³s.h
>

34 #iâdeà
__sockËn_t_defšed


35 
__sockËn_t
 
	tsockËn_t
;

36 
	#__sockËn_t_defšed


	)

40 
	e__sock‘_ty³


42 
	mSOCK_STREAM
 = 1,

44 
	#SOCK_STREAM
 
SOCK_STREAM


	)

45 
	mSOCK_DGRAM
 = 2,

47 
	#SOCK_DGRAM
 
SOCK_DGRAM


	)

48 
	mSOCK_RAW
 = 3,

49 
	#SOCK_RAW
 
SOCK_RAW


	)

50 
	mSOCK_RDM
 = 4,

51 
	#SOCK_RDM
 
SOCK_RDM


	)

52 
	mSOCK_SEQPACKET
 = 5,

54 
	#SOCK_SEQPACKET
 
SOCK_SEQPACKET


	)

55 
	mSOCK_DCCP
 = 6,

56 
	#SOCK_DCCP
 
SOCK_DCCP


	)

57 
	mSOCK_PACKET
 = 10,

60 
	#SOCK_PACKET
 
SOCK_PACKET


	)

65 
	mSOCK_CLOEXEC
 = 02000000,

67 
	#SOCK_CLOEXEC
 
SOCK_CLOEXEC


	)

68 
	mSOCK_NONBLOCK
 = 04000

70 
	#SOCK_NONBLOCK
 
SOCK_NONBLOCK


	)

74 
	#PF_UNSPEC
 0

	)

75 
	#PF_LOCAL
 1

	)

76 
	#PF_UNIX
 
PF_LOCAL


	)

77 
	#PF_FILE
 
PF_LOCAL


	)

78 
	#PF_INET
 2

	)

79 
	#PF_AX25
 3

	)

80 
	#PF_IPX
 4

	)

81 
	#PF_APPLETALK
 5

	)

82 
	#PF_NETROM
 6

	)

83 
	#PF_BRIDGE
 7

	)

84 
	#PF_ATMPVC
 8

	)

85 
	#PF_X25
 9

	)

86 
	#PF_INET6
 10

	)

87 
	#PF_ROSE
 11

	)

88 
	#PF_DECÃt
 12

	)

89 
	#PF_NETBEUI
 13

	)

90 
	#PF_SECURITY
 14

	)

91 
	#PF_KEY
 15

	)

92 
	#PF_NETLINK
 16

	)

93 
	#PF_ROUTE
 
PF_NETLINK


	)

94 
	#PF_PACKET
 17

	)

95 
	#PF_ASH
 18

	)

96 
	#PF_ECONET
 19

	)

97 
	#PF_ATMSVC
 20

	)

98 
	#PF_SNA
 22

	)

99 
	#PF_IRDA
 23

	)

100 
	#PF_PPPOX
 24

	)

101 
	#PF_WANPIPE
 25

	)

102 
	#PF_BLUETOOTH
 31

	)

103 
	#PF_IUCV
 32

	)

104 
	#PF_RXRPC
 33

	)

105 
	#PF_ISDN
 34

	)

106 
	#PF_MAX
 35

	)

109 
	#AF_UNSPEC
 
PF_UNSPEC


	)

110 
	#AF_LOCAL
 
PF_LOCAL


	)

111 
	#AF_UNIX
 
PF_UNIX


	)

112 
	#AF_FILE
 
PF_FILE


	)

113 
	#AF_INET
 
PF_INET


	)

114 
	#AF_AX25
 
PF_AX25


	)

115 
	#AF_IPX
 
PF_IPX


	)

116 
	#AF_APPLETALK
 
PF_APPLETALK


	)

117 
	#AF_NETROM
 
PF_NETROM


	)

118 
	#AF_BRIDGE
 
PF_BRIDGE


	)

119 
	#AF_ATMPVC
 
PF_ATMPVC


	)

120 
	#AF_X25
 
PF_X25


	)

121 
	#AF_INET6
 
PF_INET6


	)

122 
	#AF_ROSE
 
PF_ROSE


	)

123 
	#AF_DECÃt
 
PF_DECÃt


	)

124 
	#AF_NETBEUI
 
PF_NETBEUI


	)

125 
	#AF_SECURITY
 
PF_SECURITY


	)

126 
	#AF_KEY
 
PF_KEY


	)

127 
	#AF_NETLINK
 
PF_NETLINK


	)

128 
	#AF_ROUTE
 
PF_ROUTE


	)

129 
	#AF_PACKET
 
PF_PACKET


	)

130 
	#AF_ASH
 
PF_ASH


	)

131 
	#AF_ECONET
 
PF_ECONET


	)

132 
	#AF_ATMSVC
 
PF_ATMSVC


	)

133 
	#AF_SNA
 
PF_SNA


	)

134 
	#AF_IRDA
 
PF_IRDA


	)

135 
	#AF_PPPOX
 
PF_PPPOX


	)

136 
	#AF_WANPIPE
 
PF_WANPIPE


	)

137 
	#AF_BLUETOOTH
 
PF_BLUETOOTH


	)

138 
	#AF_IUCV
 
PF_IUCV


	)

139 
	#AF_RXRPC
 
PF_RXRPC


	)

140 
	#AF_ISDN
 
PF_ISDN


	)

141 
	#AF_MAX
 
PF_MAX


	)

147 
	#SOL_RAW
 255

	)

148 
	#SOL_DECNET
 261

	)

149 
	#SOL_X25
 262

	)

150 
	#SOL_PACKET
 263

	)

151 
	#SOL_ATM
 264

	)

152 
	#SOL_AAL
 265

	)

153 
	#SOL_IRDA
 266

	)

156 
	#SOMAXCONN
 128

	)

159 
	~<b™s/sockaddr.h
>

162 
	ssockaddr


164 
__SOCKADDR_COMMON
 (
§_
);

165 
	m§_d©a
[14];

171 
	#__ss_®igÁy³
 

	)

172 
	#_SS_SIZE
 128

	)

173 
	#_SS_PADSIZE
 (
_SS_SIZE
 - (2 *  (
__ss_®igÁy³
)))

	)

175 
	ssockaddr_¡Üage


177 
__SOCKADDR_COMMON
 (
ss_
);

178 
__ss_®igÁy³
 
	m__ss_®ign
;

179 
	m__ss_·ddšg
[
_SS_PADSIZE
];

186 
	mMSG_OOB
 = 0x01,

187 
	#MSG_OOB
 
MSG_OOB


	)

188 
	mMSG_PEEK
 = 0x02,

189 
	#MSG_PEEK
 
MSG_PEEK


	)

190 
	mMSG_DONTROUTE
 = 0x04,

191 
	#MSG_DONTROUTE
 
MSG_DONTROUTE


	)

192 #ifdeà
__USE_GNU


194 
	mMSG_TRYHARD
 = 
MSG_DONTROUTE
,

195 
	#MSG_TRYHARD
 
MSG_DONTROUTE


	)

197 
	mMSG_CTRUNC
 = 0x08,

198 
	#MSG_CTRUNC
 
MSG_CTRUNC


	)

199 
	mMSG_PROXY
 = 0x10,

200 
	#MSG_PROXY
 
MSG_PROXY


	)

201 
	mMSG_TRUNC
 = 0x20,

202 
	#MSG_TRUNC
 
MSG_TRUNC


	)

203 
	mMSG_DONTWAIT
 = 0x40,

204 
	#MSG_DONTWAIT
 
MSG_DONTWAIT


	)

205 
	mMSG_EOR
 = 0x80,

206 
	#MSG_EOR
 
MSG_EOR


	)

207 
	mMSG_WAITALL
 = 0x100,

208 
	#MSG_WAITALL
 
MSG_WAITALL


	)

209 
	mMSG_FIN
 = 0x200,

210 
	#MSG_FIN
 
MSG_FIN


	)

211 
	mMSG_SYN
 = 0x400,

212 
	#MSG_SYN
 
MSG_SYN


	)

213 
	mMSG_CONFIRM
 = 0x800,

214 
	#MSG_CONFIRM
 
MSG_CONFIRM


	)

215 
	mMSG_RST
 = 0x1000,

216 
	#MSG_RST
 
MSG_RST


	)

217 
	mMSG_ERRQUEUE
 = 0x2000,

218 
	#MSG_ERRQUEUE
 
MSG_ERRQUEUE


	)

219 
	mMSG_NOSIGNAL
 = 0x4000,

220 
	#MSG_NOSIGNAL
 
MSG_NOSIGNAL


	)

221 
	mMSG_MORE
 = 0x8000,

222 
	#MSG_MORE
 
MSG_MORE


	)

224 
	mMSG_CMSG_CLOEXEC
 = 0x40000000

227 
	#MSG_CMSG_CLOEXEC
 
MSG_CMSG_CLOEXEC


	)

233 
	smsghdr


235 *
	mmsg_Çme
;

236 
sockËn_t
 
	mmsg_Çm–’
;

238 
iovec
 *
	mmsg_iov
;

239 
size_t
 
	mmsg_iovËn
;

241 *
	mmsg_cÚŒŞ
;

242 
size_t
 
	mmsg_cÚŒŞËn
;

247 
	mmsg_æags
;

251 
	scmsghdr


253 
size_t
 
	mcmsg_Ën
;

258 
	mcmsg_Ëv–
;

259 
	mcmsg_ty³
;

260 #ià(!
defšed
 
__STRICT_ANSI__
 && 
__GNUC__
 >ğ2è|| 
__STDC_VERSION__
 >= 199901L

261 
__ex‹nsiÚ__
 
__cmsg_d©a
 
	m__æex¬r
;

266 #ià(!
defšed
 
__STRICT_ANSI__
 && 
__GNUC__
 >ğ2è|| 
__STDC_VERSION__
 >= 199901L

267 
	#CMSG_DATA
(
cmsg
è((cmsg)->
__cmsg_d©a
)

	)

269 
	#CMSG_DATA
(
cmsg
è((*è((
cmsghdr
 *è(cmsgè+ 1))

	)

271 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
è
	`__cmsg_nxthdr
 (mhdr, cmsg)

	)

272 
	#CMSG_FIRSTHDR
(
mhdr
) \

273 ((
size_t
è(
mhdr
)->
msg_cÚŒŞËn
 >ğ (
cmsghdr
) \

274 ? (
cmsghdr
 *è(
mhdr
)->
msg_cÚŒŞ
 : (cmsghd¸*è0)

	)

275 
	#CMSG_ALIGN
(
Ën
è((Ö’è+  (
size_t
) - 1) \

276 & (
size_t
è~( (size_tè- 1))

	)

277 
	#CMSG_SPACE
(
Ën
è(
	`CMSG_ALIGN
 (len) \

278 + 
	`CMSG_ALIGN
 ( (
cmsghdr
)))

	)

279 
	#CMSG_LEN
(
Ën
è(
	`CMSG_ALIGN
 ( (
cmsghdr
)è+ (Ën))

	)

281 
cmsghdr
 *
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
,

282 
cmsghdr
 *
__cmsg
è
__THROW
;

283 #ifdeà
__USE_EXTERN_INLINES


284 #iâdeà
_EXTERN_INLINE


285 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

287 
_EXTERN_INLINE
 
cmsghdr
 *

288 
	`__NTH
 (
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
, 
cmsghdr
 *
__cmsg
))

290 ià((
size_t
è
__cmsg
->
cmsg_Ën
 <  (
cmsghdr
))

294 
__cmsg
 = (
cmsghdr
 *) ((*) __cmsg

295 + 
	`CMSG_ALIGN
 (
__cmsg
->
cmsg_Ën
));

296 ià((*è(
__cmsg
 + 1è> ((*è
__mhdr
->
msg_cÚŒŞ


297 + 
__mhdr
->
msg_cÚŒŞËn
)

298 || ((*è
__cmsg
 + 
	`CMSG_ALIGN
 (__cmsg->
cmsg_Ën
)

299 > ((*è
__mhdr
->
msg_cÚŒŞ
 + __mhdr->
msg_cÚŒŞËn
)))

302  
__cmsg
;

303 
	}
}

310 
	mSCM_RIGHTS
 = 0x01

311 
	#SCM_RIGHTS
 
SCM_RIGHTS


	)

312 #ifdeà
__USE_BSD


313 , 
	mSCM_CREDENTIALS
 = 0x02

314 
	#SCM_CREDENTIALS
 
SCM_CREDENTIALS


	)

318 #ifdeà
__USE_GNU


320 
	suüed


322 
pid_t
 
	mpid
;

323 
uid_t
 
	muid
;

324 
gid_t
 
	mgid
;

329 #ià!
defšed
 
__USE_MISC
 && !defšed 
__USE_GNU


330 #iâdeà
FIOGETOWN


331 
	#__SYS_SOCKET_H_undef_FIOGETOWN


	)

333 #iâdeà
FIOSETOWN


334 
	#__SYS_SOCKET_H_undef_FIOSETOWN


	)

336 #iâdeà
SIOCATMARK


337 
	#__SYS_SOCKET_H_undef_SIOCATMARK


	)

339 #iâdeà
SIOCGPGRP


340 
	#__SYS_SOCKET_H_undef_SIOCGPGRP


	)

342 #iâdeà
SIOCGSTAMP


343 
	#__SYS_SOCKET_H_undef_SIOCGSTAMP


	)

345 #iâdeà
SIOCGSTAMPNS


346 
	#__SYS_SOCKET_H_undef_SIOCGSTAMPNS


	)

348 #iâdeà
SIOCSPGRP


349 
	#__SYS_SOCKET_H_undef_SIOCSPGRP


	)

354 
	~<asm/sock‘.h
>

356 #ià!
defšed
 
__USE_MISC
 && !defšed 
__USE_GNU


357 #ifdeà
__SYS_SOCKET_H_undef_FIOGETOWN


358 #undeà
__SYS_SOCKET_H_undef_FIOGETOWN


359 #undeà
FIOGETOWN


361 #ifdeà
__SYS_SOCKET_H_undef_FIOSETOWN


362 #undeà
__SYS_SOCKET_H_undef_FIOSETOWN


363 #undeà
FIOSETOWN


365 #ifdeà
__SYS_SOCKET_H_undef_SIOCATMARK


366 #undeà
__SYS_SOCKET_H_undef_SIOCATMARK


367 #undeà
SIOCATMARK


369 #ifdeà
__SYS_SOCKET_H_undef_SIOCGPGRP


370 #undeà
__SYS_SOCKET_H_undef_SIOCGPGRP


371 #undeà
SIOCGPGRP


373 #ifdeà
__SYS_SOCKET_H_undef_SIOCGSTAMP


374 #undeà
__SYS_SOCKET_H_undef_SIOCGSTAMP


375 #undeà
SIOCGSTAMP


377 #ifdeà
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


378 #undeà
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


379 #undeà
SIOCGSTAMPNS


381 #ifdeà
__SYS_SOCKET_H_undef_SIOCSPGRP


382 #undeà
__SYS_SOCKET_H_undef_SIOCSPGRP


383 #undeà
SIOCSPGRP


388 
	slšg”


390 
	ml_Úoff
;

391 
	ml_lšg”
;

	@/usr/include/bits/socket2.h

20 #iâdeà
_SYS_SOCKET_H


24 
ssize_t
 
__»cv_chk
 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

25 
__æags
);

26 
ssize_t
 
__REDIRECT
 (
__»cv_®Ÿs
, (
__fd
, *
__buf
, 
size_t
 
__n
,

27 
__æags
), 
»cv
);

28 
ssize_t
 
__REDIRECT
 (
__»cv_chk_w¬n
,

29 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

30 
__æags
), 
__»cv_chk
)

31 
__w¬Ç‰r
 ("recv called with bigger†engthhan size of destination "

34 
__ex‹º_®ways_šlše
 
ssize_t


35 
	$»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
)

37 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

39 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

40  
	`__»cv_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
);

42 ià(
__n
 > 
	`__bos0
 (
__buf
))

43  
	`__»cv_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
);

45  
	`__»cv_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
);

46 
	}
}

48 
ssize_t
 
__»cväom_chk
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

49 
size_t
 
__buæ’
, 
__æags
,

50 
__SOCKADDR_ARG
 
__addr
,

51 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

52 
ssize_t
 
__REDIRECT
 (
__»cväom_®Ÿs
,

53 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

54 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

55 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
»cväom
);

56 
ssize_t
 
__REDIRECT
 (
__»cväom_chk_w¬n
,

57 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

58 
size_t
 
__buæ’
, 
__æags
,

59 
__SOCKADDR_ARG
 
__addr
,

60 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
__»cväom_chk
)

61 
__w¬Ç‰r
 ("recvfrom called with bigger†engthhan size of "

64 
__ex‹º_®ways_šlše
 
ssize_t


65 
	$»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
, 
__æags
,

66 
__SOCKADDR_ARG
 
__addr
, 
sockËn_t
 *
__»¡riù
 
__addr_Ën
)

68 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

70 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

71  
	`__»cväom_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
,

72 
__addr
, 
__addr_Ën
);

73 ià(
__n
 > 
	`__bos0
 (
__buf
))

74  
	`__»cväom_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
,

75 
__addr
, 
__addr_Ën
);

77  
	`__»cväom_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
, 
__addr
, 
__addr_Ën
);

78 
	}
}

	@/usr/include/bits/stat.h

19 #iâdeà
_SYS_STAT_H


24 
	#_STAT_VER_KERNEL
 0

	)

26 #ià
__WORDSIZE
 == 32

27 
	#_STAT_VER_SVR4
 2

	)

28 
	#_STAT_VER_LINUX
 3

	)

31 
	#_MKNOD_VER_LINUX
 1

	)

32 
	#_MKNOD_VER_SVR4
 2

	)

33 
	#_MKNOD_VER
 
_MKNOD_VER_LINUX


	)

35 
	#_STAT_VER_LINUX
 1

	)

38 
	#_MKNOD_VER_LINUX
 0

	)

41 
	#_STAT_VER
 
_STAT_VER_LINUX


	)

43 
	s¡©


45 
__dev_t
 
	m¡_dev
;

46 #ià
__WORDSIZE
 == 32

47 
	m__·d1
;

49 #ià
__WORDSIZE
 =ğ64 || !
defšed
 
__USE_FILE_OFFSET64


50 
__šo_t
 
	m¡_šo
;

52 
__šo_t
 
	m__¡_šo
;

54 #ià
__WORDSIZE
 == 32

55 
__mode_t
 
	m¡_mode
;

56 
__Æšk_t
 
	m¡_Æšk
;

58 
__Æšk_t
 
	m¡_Æšk
;

59 
__mode_t
 
	m¡_mode
;

61 
__uid_t
 
	m¡_uid
;

62 
__gid_t
 
	m¡_gid
;

63 #ià
__WORDSIZE
 == 64

64 
	m__·d0
;

66 
__dev_t
 
	m¡_rdev
;

67 #ià
__WORDSIZE
 == 32

68 
	m__·d2
;

70 #ià
__WORDSIZE
 =ğ64 || !
defšed
 
__USE_FILE_OFFSET64


71 
__off_t
 
	m¡_size
;

73 
__off64_t
 
	m¡_size
;

75 
__blksize_t
 
	m¡_blksize
;

76 #ià
__WORDSIZE
 =ğ64 || !
defšed
 
__USE_FILE_OFFSET64


77 
__blkút_t
 
	m¡_blocks
;

79 
__blkút64_t
 
	m¡_blocks
;

81 #ifdeà
__USE_MISC


88 
time¥ec
 
	m¡_©im
;

89 
time¥ec
 
	m¡_mtim
;

90 
time¥ec
 
	m¡_ùim
;

91 
	#¡_©ime
 
¡_©im
.
tv_£c


	)

92 
	#¡_mtime
 
¡_mtim
.
tv_£c


	)

93 
	#¡_ùime
 
¡_ùim
.
tv_£c


	)

95 
__time_t
 
	m¡_©ime
;

96 
	m¡_©im’£c
;

97 
__time_t
 
	m¡_mtime
;

98 
	m¡_mtim’£c
;

99 
__time_t
 
	m¡_ùime
;

100 
	m¡_ùim’£c
;

102 #ià
__WORDSIZE
 == 64

103 
	m__unu£d
[3];

105 #iâdeà
__USE_FILE_OFFSET64


106 
	m__unu£d4
;

107 
	m__unu£d5
;

109 
__šo64_t
 
	m¡_šo
;

114 #ifdeà
__USE_LARGEFILE64


116 
	s¡©64


118 
__dev_t
 
	m¡_dev
;

119 #ià
__WORDSIZE
 == 64

120 
__šo64_t
 
	m¡_šo
;

121 
__Æšk_t
 
	m¡_Æšk
;

122 
__mode_t
 
	m¡_mode
;

124 
	m__·d1
;

125 
__šo_t
 
	m__¡_šo
;

126 
__mode_t
 
	m¡_mode
;

127 
__Æšk_t
 
	m¡_Æšk
;

129 
__uid_t
 
	m¡_uid
;

130 
__gid_t
 
	m¡_gid
;

131 #ià
__WORDSIZE
 == 64

132 
	m__·d0
;

133 
__dev_t
 
	m¡_rdev
;

134 
__off_t
 
	m¡_size
;

136 
__dev_t
 
	m¡_rdev
;

137 
	m__·d2
;

138 
__off64_t
 
	m¡_size
;

140 
__blksize_t
 
	m¡_blksize
;

141 
__blkút64_t
 
	m¡_blocks
;

142 #ifdeà
__USE_MISC


149 
time¥ec
 
	m¡_©im
;

150 
time¥ec
 
	m¡_mtim
;

151 
time¥ec
 
	m¡_ùim
;

152 
	#¡_©ime
 
¡_©im
.
tv_£c


	)

153 
	#¡_mtime
 
¡_mtim
.
tv_£c


	)

154 
	#¡_ùime
 
¡_ùim
.
tv_£c


	)

156 
__time_t
 
	m¡_©ime
;

157 
	m¡_©im’£c
;

158 
__time_t
 
	m¡_mtime
;

159 
	m¡_mtim’£c
;

160 
__time_t
 
	m¡_ùime
;

161 
	m¡_ùim’£c
;

163 #ià
__WORDSIZE
 == 64

164 
	m__unu£d
[3];

166 
__šo64_t
 
	m¡_šo
;

172 
	#_STATBUF_ST_BLKSIZE


	)

173 
	#_STATBUF_ST_RDEV


	)

175 
	#_STATBUF_ST_NSEC


	)

179 
	#__S_IFMT
 0170000

	)

182 
	#__S_IFDIR
 0040000

	)

183 
	#__S_IFCHR
 0020000

	)

184 
	#__S_IFBLK
 0060000

	)

185 
	#__S_IFREG
 0100000

	)

186 
	#__S_IFIFO
 0010000

	)

187 
	#__S_IFLNK
 0120000

	)

188 
	#__S_IFSOCK
 0140000

	)

192 
	#__S_TYPEISMQ
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

193 
	#__S_TYPEISSEM
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

194 
	#__S_TYPEISSHM
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

198 
	#__S_ISUID
 04000

	)

199 
	#__S_ISGID
 02000

	)

200 
	#__S_ISVTX
 01000

	)

201 
	#__S_IREAD
 0400

	)

202 
	#__S_IWRITE
 0200

	)

203 
	#__S_IEXEC
 0100

	)

205 #ià
defšed
 
__USE_ATFILE
 || defšed 
__USE_GNU


207 
	#UTIME_NOW
 ((1È<< 30è- 1l)

	)

208 
	#UTIME_OMIT
 ((1È<< 30è- 2l)

	)

	@/usr/include/bits/stdio-ldbl.h

20 #iâdeà
_STDIO_H


24 
__BEGIN_NAMESPACE_STD


25 
	$__LDBL_REDIR_DECL
 (
årštf
)

26 
	$__LDBL_REDIR_DECL
 (
´štf
)

27 
	$__LDBL_REDIR_DECL
 (
¥rštf
)

28 
	$__LDBL_REDIR_DECL
 (
vårštf
)

29 
	$__LDBL_REDIR_DECL
 (
v´štf
)

30 
	$__LDBL_REDIR_DECL
 (
v¥rštf
)

31 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

32 && !
defšed
 
__REDIRECT
 \

33 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

34 
	$__LDBL_REDIR1_DECL
 (
fsÿnf
, 
__Ædbl___isoc99_fsÿnf
)

35 
	$__LDBL_REDIR1_DECL
 (
sÿnf
, 
__Ædbl___isoc99_sÿnf
)

36 
	$__LDBL_REDIR1_DECL
 (
ssÿnf
, 
__Ædbl___isoc99_ssÿnf
)

38 
	$__LDBL_REDIR_DECL
 (
fsÿnf
)

39 
	$__LDBL_REDIR_DECL
 (
sÿnf
)

40 
	$__LDBL_REDIR_DECL
 (
ssÿnf
)

42 
__END_NAMESPACE_STD


44 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


45 
__BEGIN_NAMESPACE_C99


46 
	$__LDBL_REDIR_DECL
 (
¢´štf
)

47 
	$__LDBL_REDIR_DECL
 (
v¢´štf
)

48 
__END_NAMESPACE_C99


51 #ifdef 
__USE_ISOC99


52 
__BEGIN_NAMESPACE_C99


53 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

54 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

55 
	$__LDBL_REDIR1_DECL
 (
vfsÿnf
, 
__Ædbl___isoc99_vfsÿnf
)

56 
	$__LDBL_REDIR1_DECL
 (
vsÿnf
, 
__Ædbl___isoc99_vsÿnf
)

57 
	$__LDBL_REDIR1_DECL
 (
vssÿnf
, 
__Ædbl___isoc99_vssÿnf
)

59 
	$__LDBL_REDIR_DECL
 (
vfsÿnf
)

60 
	$__LDBL_REDIR_DECL
 (
vssÿnf
)

61 
	$__LDBL_REDIR_DECL
 (
vsÿnf
)

63 
__END_NAMESPACE_C99


66 #ifdeà
__USE_GNU


67 
	$__LDBL_REDIR_DECL
 (
vd´štf
)

68 
	$__LDBL_REDIR_DECL
 (
d´štf
)

69 
	$__LDBL_REDIR_DECL
 (
va¥rštf
)

70 
	$__LDBL_REDIR_DECL
 (
__a¥rštf
)

71 
	$__LDBL_REDIR_DECL
 (
a¥rštf
)

72 
	$__LDBL_REDIR_DECL
 (
ob¡ack_´štf
)

73 
	$__LDBL_REDIR_DECL
 (
ob¡ack_v´štf
)

76 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


77 
	$__LDBL_REDIR_DECL
 (
__¥rštf_chk
)

78 
	$__LDBL_REDIR_DECL
 (
__v¥rštf_chk
)

79 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


80 
	$__LDBL_REDIR_DECL
 (
__¢´štf_chk
)

81 
	$__LDBL_REDIR_DECL
 (
__v¢´štf_chk
)

83 #ià
__USE_FORTIFY_LEVEL
 > 1

84 
	$__LDBL_REDIR_DECL
 (
__årštf_chk
)

85 
	$__LDBL_REDIR_DECL
 (
__´štf_chk
)

86 
	$__LDBL_REDIR_DECL
 (
__vårštf_chk
)

87 
	$__LDBL_REDIR_DECL
 (
__v´štf_chk
)

88 #ifdeà
__USE_GNU


89 
	$__LDBL_REDIR_DECL
 (
__a¥rštf_chk
)

90 
	$__LDBL_REDIR_DECL
 (
__va¥rštf_chk
)

91 
	$__LDBL_REDIR_DECL
 (
__d´štf_chk
)

92 
	$__LDBL_REDIR_DECL
 (
__vd´štf_chk
)

93 
	$__LDBL_REDIR_DECL
 (
__ob¡ack_´štf_chk
)

94 
	$__LDBL_REDIR_DECL
 (
__ob¡ack_v´štf_chk
)

	@/usr/include/bits/stdio.h

20 #iâdeà
_STDIO_H


24 #iâdeà
__ex‹º_šlše


25 
	#__STDIO_INLINE
 
šlše


	)

27 
	#__STDIO_INLINE
 
__ex‹º_šlše


	)

31 #ifdeà
__USE_EXTERN_INLINES


34 #ià!(
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše
)

36 
__STDIO_INLINE
 

37 
	$v´štf
 (
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

39  
	`vårštf
 (
¡dout
, 
__fmt
, 
__¬g
);

40 
	}
}

44 
__STDIO_INLINE
 

45 
	$g‘ch¬
 ()

47  
	`_IO_g‘c
 (
¡dš
);

48 
	}
}

51 #ifdeà
__USE_MISC


53 
__STDIO_INLINE
 

54 
	$fg‘c_uÆocked
 (
FILE
 *
__å
)

56  
	`_IO_g‘c_uÆocked
 (
__å
);

57 
	}
}

61 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


63 
__STDIO_INLINE
 

64 
	$g‘c_uÆocked
 (
FILE
 *
__å
)

66  
	`_IO_g‘c_uÆocked
 (
__å
);

67 
	}
}

70 
__STDIO_INLINE
 

71 
	$g‘ch¬_uÆocked
 ()

73  
	`_IO_g‘c_uÆocked
 (
¡dš
);

74 
	}
}

79 
__STDIO_INLINE
 

80 
	$putch¬
 (
__c
)

82  
	`_IO_putc
 (
__c
, 
¡dout
);

83 
	}
}

86 #ifdeà
__USE_MISC


88 
__STDIO_INLINE
 

89 
	$åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

91  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

92 
	}
}

96 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


98 
__STDIO_INLINE
 

99 
	$putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

101  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

102 
	}
}

105 
__STDIO_INLINE
 

106 
	$putch¬_uÆocked
 (
__c
)

108  
	`_IO_putc_uÆocked
 (
__c
, 
¡dout
);

109 
	}
}

113 #ifdef 
__USE_GNU


115 
__STDIO_INLINE
 
_IO_ssize_t


116 
	$g‘lše
 (**
__lš•Œ
, 
size_t
 *
__n
, 
FILE
 *
__¡»am
)

118  
	`__g‘d–im
 (
__lš•Œ
, 
__n
, '\n', 
__¡»am
);

119 
	}
}

123 #ifdeà
__USE_MISC


125 
__STDIO_INLINE
 

126 
__NTH
 (
	$ãof_uÆocked
 (
FILE
 *
__¡»am
))

128  
	`_IO_ãof_uÆocked
 (
__¡»am
);

129 
	}
}

132 
__STDIO_INLINE
 

133 
__NTH
 (
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
))

135  
	`_IO_ã¼Ü_uÆocked
 (
__¡»am
);

136 
	}
}

142 #ià
defšed
 
__USE_MISC
 && defšed 
__GNUC__
 && defšed 
__OPTIMIZE__
 \

143 && !
defšed
 
	g__ılu¥lus


145 
	#ä—d_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

146 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

147 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

148 && (
size_t
è(
size
) != 0) \

149 ? ({ *
__±r
 = (*è(
±r
); \

150 
FILE
 *
__¡»am
 = (
¡»am
); \

151 
size_t
 
__út
; \

152 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

153 
__út
 > 0; --__cnt) \

155 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
); \

156 ià(
__c
 =ğ
EOF
) \

158 *
__±r
++ = 
__c
; \

160 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

161 / (
size_t
è(
size
); }) \

162 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

163 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

165 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

166 (è(
n
), (
size_t
) 0) \

167 : 
	`ä—d_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

169 
	#fwr™e_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

170 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

171 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

172 && (
size_t
è(
size
) != 0) \

173 ? ({ cÚ¡ *
__±r
 = (cÚ¡ *è(
±r
); \

174 
FILE
 *
__¡»am
 = (
¡»am
); \

175 
size_t
 
__út
; \

176 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

177 
__út
 > 0; --__cnt) \

178 ià(
	`_IO_putc_uÆocked
 (*
__±r
++, 
__¡»am
è=ğ
EOF
) \

180 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

181 / (
size_t
è(
size
); }) \

182 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

183 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

185 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

186 (è(
n
), (
size_t
) 0) \

187 : 
	`fwr™e_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

191 #undeà
__STDIO_INLINE


	@/usr/include/bits/stdio2.h

20 #iâdeà
_STDIO_H


24 
	$__¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

25 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

26 
	$__v¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

27 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

28 
_G_va_li¡
 
__­
è
__THROW
;

30 #ifdeà
__va_¬g_·ck


31 
__ex‹º_®ways_šlše
 

32 
	`__NTH
 (
	$¥rštf
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fmt
, ...))

34  
	`__butš___¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

35 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

36 
	}
}

37 #–ià!
defšed
 
__ılu¥lus


38 
	#¥rštf
(
¡r
, ...) \

39 
	`__butš___¥rštf_chk
 (
¡r
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

40 
__VA_ARGS__
)

	)

43 
__ex‹º_®ways_šlše
 

44 
__NTH
 (
	$v¥rštf
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fmt
,

45 
_G_va_li¡
 
__­
))

47  
	`__butš___v¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

48 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

49 
	}
}

51 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


53 
	$__¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

54 
size_t
 
__¦’
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

55 ...è
__THROW
;

56 
	$__v¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

57 
size_t
 
__¦’
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

58 
_G_va_li¡
 
__­
è
__THROW
;

60 #ifdeà
__va_¬g_·ck


61 
__ex‹º_®ways_šlše
 

62 
	`__NTH
 (
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

63 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...))

65  
	`__butš___¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

66 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

67 
	}
}

68 #–ià!
defšed
 
__ılu¥lus


69 
	#¢´štf
(
¡r
, 
Ën
, ...) \

70 
	`__butš___¢´štf_chk
 (
¡r
, 
Ën
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

71 
__VA_ARGS__
)

	)

74 
__ex‹º_®ways_šlše
 

75 
__NTH
 (
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

76 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

78  
	`__butš___v¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

79 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

80 
	}
}

84 #ià
__USE_FORTIFY_LEVEL
 > 1

86 
__årštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

87 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

88 
__´štf_chk
 (
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

89 
__vårštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

90 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__­
);

91 
__v´štf_chk
 (
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

92 
_G_va_li¡
 
__­
);

94 #ifdeà
__va_¬g_·ck


95 
__ex‹º_®ways_šlše
 

96 
	$årštf
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__cÚ¡
 *__»¡riù 
__fmt
, ...)

98  
	`__årštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

99 
	`__va_¬g_·ck
 ());

100 
	}
}

102 
__ex‹º_®ways_šlše
 

103 
	$´štf
 (
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

105  
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

106 
	}
}

107 #–ià!
defšed
 
__ılu¥lus


108 
	#´štf
(...) \

109 
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

110 
	#årštf
(
¡»am
, ...) \

111 
	`__årštf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

114 
__ex‹º_®ways_šlše
 

115 
	$v´štf
 (
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

117 #ifdeà
__USE_EXTERN_INLINES


118  
	`__vårštf_chk
 (
¡dout
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

120  
	`__v´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

122 
	}
}

124 
__ex‹º_®ways_šlše
 

125 
	$vårštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

126 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

128  
	`__vårštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

129 
	}
}

131 #ifdeà
__USE_GNU


133 
	$__a¥rštf_chk
 (**
__»¡riù
 
__±r
, 
__æag
,

134 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

135 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 3, 4))è
__wur
;

136 
	$__va¥rštf_chk
 (**
__»¡riù
 
__±r
, 
__æag
,

137 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

138 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 3, 0))è
__wur
;

139 
	$__d´štf_chk
 (
__fd
, 
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fmt
,

140 ...è
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

141 
	$__vd´štf_chk
 (
__fd
, 
__æag
,

142 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

143 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

144 
	$__ob¡ack_´štf_chk
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

145 
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

147 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

148 
	$__ob¡ack_v´štf_chk
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

149 
__æag
,

150 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

151 
_G_va_li¡
 
__¬gs
)

152 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

154 #ifdeà
__va_¬g_·ck


155 
__ex‹º_®ways_šlše
 

156 
	`__NTH
 (
	$a¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__fmt
, ...))

158  
	`__a¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

159 
	`__va_¬g_·ck
 ());

160 
	}
}

162 
__ex‹º_®ways_šlše
 

163 
__NTH
 (
	$__a¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__fmt
,

166  
	`__a¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

167 
	`__va_¬g_·ck
 ());

168 
	}
}

170 
__ex‹º_®ways_šlše
 

171 
	$d´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

173  
	`__d´štf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

174 
	`__va_¬g_·ck
 ());

175 
	}
}

177 
__ex‹º_®ways_šlše
 

178 
__NTH
 (
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

179 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...))

181  
	`__ob¡ack_´štf_chk
 (
__ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

182 
	`__va_¬g_·ck
 ());

183 
	}
}

184 #–ià!
defšed
 
__ılu¥lus


185 
	#a¥rštf
(
±r
, ...) \

186 
	`__a¥rštf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

187 
	#__a¥rštf
(
±r
, ...) \

188 
	`__a¥rštf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

189 
	#d´štf
(
fd
, ...) \

190 
	`__d´štf_chk
 (
fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

191 
	#ob¡ack_´štf
(
ob¡ack
, ...) \

192 
	`__ob¡ack_´štf_chk
 (
ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

195 
__ex‹º_®ways_šlše
 

196 
__NTH
 (
	$va¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__fmt
,

197 
_G_va_li¡
 
__­
))

199  
	`__va¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

200 
	}
}

202 
__ex‹º_®ways_šlše
 

203 
	$vd´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

205  
	`__vd´štf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

206 
	}
}

208 
__ex‹º_®ways_šlše
 

209 
__NTH
 (
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

210 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

212  
	`__ob¡ack_v´štf_chk
 (
__ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

213 
__­
);

214 
	}
}

220 *
	$__g‘s_chk
 (*
__¡r
, 
size_t
è
__wur
;

221 *
	`__REDIRECT
 (
__g‘s_w¬n
, (*
__¡r
), 
g‘s
)

222 
__wur
 
	`__w¬Ç‰r
 ("please use fgets or getline instead, gets can't "

225 
__ex‹º_®ways_šlše
 
__wur
 *

226 
	$g‘s
 (*
__¡r
)

228 ià(
	`__bos
 (
__¡r
è!ğ(
size_t
) -1)

229  
	`__g‘s_chk
 (
__¡r
, 
	`__bos
 (__str));

230  
	`__g‘s_w¬n
 (
__¡r
);

231 
	}
}

233 *
	$__fg‘s_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

234 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

235 *
	`__REDIRECT
 (
__fg‘s_®Ÿs
,

236 (*
__»¡riù
 
__s
, 
__n
,

237 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s
è
__wur
;

238 *
	`__REDIRECT
 (
__fg‘s_chk_w¬n
,

239 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

240 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_chk
)

241 
__wur
 
	`__w¬Ç‰r
 ("fgets called with bigger sizehan†ength "

244 
__ex‹º_®ways_šlše
 
__wur
 *

245 
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

247 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

249 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

250  
	`__fg‘s_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

252 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

253  
	`__fg‘s_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

255  
	`__fg‘s_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

256 
	}
}

258 
size_t
 
	$__ä—d_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

259 
size_t
 
__size
, size_ˆ
__n
,

260 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

261 
size_t
 
	`__REDIRECT
 (
__ä—d_®Ÿs
,

262 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

263 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

264 
ä—d
è
__wur
;

265 
size_t
 
	`__REDIRECT
 (
__ä—d_chk_w¬n
,

266 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

267 
size_t
 
__size
, size_ˆ
__n
,

268 
FILE
 *
__»¡riù
 
__¡»am
),

269 
__ä—d_chk
)

270 
__wur
 
	`__w¬Ç‰r
 ("fread called with bigger size *‚membhan†ength "

273 
__ex‹º_®ways_šlše
 
__wur
 
size_t


274 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

275 
FILE
 *
__»¡riù
 
__¡»am
)

277 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

279 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

280 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

281 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

282  
	`__ä—d_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

284 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

285  
	`__ä—d_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

287  
	`__ä—d_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

288 
	}
}

290 #ifdeà
__USE_GNU


291 *
	$__fg‘s_uÆocked_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
,

292 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

293 *
	`__REDIRECT
 (
__fg‘s_uÆocked_®Ÿs
,

294 (*
__»¡riù
 
__s
, 
__n
,

295 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s_uÆocked
è
__wur
;

296 *
	`__REDIRECT
 (
__fg‘s_uÆocked_chk_w¬n
,

297 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

298 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_uÆocked_chk
)

299 
__wur
 
	`__w¬Ç‰r
 ("fgets_unlocked called with bigger sizehan†ength "

302 
__ex‹º_®ways_šlše
 
__wur
 *

303 
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

305 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

307 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

308  
	`__fg‘s_uÆocked_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

310 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

311  
	`__fg‘s_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

313  
	`__fg‘s_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

314 
	}
}

317 #ifdeà
__USE_MISC


318 #undeà
ä—d_uÆocked


319 
size_t
 
	$__ä—d_uÆocked_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

320 
size_t
 
__size
, size_ˆ
__n
,

321 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

322 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_®Ÿs
,

323 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

324 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

325 
ä—d_uÆocked
è
__wur
;

326 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_chk_w¬n
,

327 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

328 
size_t
 
__size
, size_ˆ
__n
,

329 
FILE
 *
__»¡riù
 
__¡»am
),

330 
__ä—d_uÆocked_chk
)

331 
__wur
 
	`__w¬Ç‰r
 ("fread_unlocked called with bigger size *‚membhan "

334 
__ex‹º_®ways_šlše
 
__wur
 
size_t


335 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

336 
FILE
 *
__»¡riù
 
__¡»am
)

338 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

340 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

341 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

342 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

343  
	`__ä—d_uÆocked_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

344 
__¡»am
);

346 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

347  
	`__ä—d_uÆocked_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

348 
__¡»am
);

351 #ifdeà
__USE_EXTERN_INLINES


352 ià(
	`__butš_cÚ¡ªt_p
 (
__size
)

353 && 
	`__butš_cÚ¡ªt_p
 (
__n
)

354 && (
__size
 | 
__n
è< (((
size_t
) 1) << (8 *  (size_t) / 2))

355 && 
__size
 * 
__n
 <= 8)

357 
size_t
 
__út
 = 
__size
 * 
__n
;

358 *
__ıŒ
 = (*è
__±r
;

359 ià(
__út
 == 0)

362 ; 
__út
 > 0; --__cnt)

364 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
);

365 ià(
__c
 =ğ
EOF
)

367 *
__ıŒ
++ = 
__c
;

369  (
__ıŒ
 - (*è
__±r
è/ 
__size
;

372  
	`__ä—d_uÆocked_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

373 
	}
}

	@/usr/include/bits/stdio_lim.h

19 #ià!
defšed
 
_STDIO_H
 && !defšed 
__Ãed_FOPEN_MAX
 && !defšed 
__Ãed_IOV_MAX


23 #ifdeà
_STDIO_H


24 
	#L_tm²am
 20

	)

25 
	#TMP_MAX
 238328

	)

26 
	#FILENAME_MAX
 4096

	)

28 #ifdeà
__USE_POSIX


29 
	#L_ù”mid
 9

	)

30 
	#L_cu£rid
 9

	)

34 #ià
defšed
 
__Ãed_FOPEN_MAX
 || defšed 
_STDIO_H


35 #undeà
FOPEN_MAX


36 
	#FOPEN_MAX
 16

	)

39 #ià
defšed
 
__Ãed_IOV_MAX
 && !defšed 
IOV_MAX


40 
	#IOV_MAX
 1024

	)

	@/usr/include/bits/stdlib-ldbl.h

20 #iâdeà
_STDLIB_H


24 #ifdef 
__USE_ISOC99


25 
__BEGIN_NAMESPACE_C99


26 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd
, 
¡¹od
)

27 
__END_NAMESPACE_C99


30 #ifdeà
__USE_GNU


31 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd_l
, 
¡¹od_l
)

34 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


35 #ifdeà
__USE_MISC


36 
	$__LDBL_REDIR1_DECL
 (
qecvt
, 
ecvt
)

37 
	$__LDBL_REDIR1_DECL
 (
qfcvt
, 
fcvt
)

38 
	$__LDBL_REDIR1_DECL
 (
qgcvt
, 
gcvt
)

39 
	$__LDBL_REDIR1_DECL
 (
qecvt_r
, 
ecvt_r
)

40 
	$__LDBL_REDIR1_DECL
 (
qfcvt_r
, 
fcvt_r
)

	@/usr/include/bits/stdlib.h

20 #iâdeà
_STDLIB_H


24 *
	$__»®·th_chk
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

25 *
__»¡riù
 
__»sŞved
,

26 
size_t
 
__»sŞvedËn
è
__THROW
 
__wur
;

27 *
	`__REDIRECT_NTH
 (
__»®·th_®Ÿs
,

28 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

29 *
__»¡riù
 
__»sŞved
), 
»®·th
è
__wur
;

30 *
	`__REDIRECT_NTH
 (
__»®·th_chk_w¬n
,

31 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

32 *
__»¡riù
 
__»sŞved
,

33 
size_t
 
__»sŞvedËn
), 
__»®·th_chk
è
__wur


34 
	`__w¬Ç‰r
 ("second‡rgument of„ealpath must beƒither NULL or‡t "

37 
__ex‹º_®ways_šlše
 
__wur
 *

38 
	`__NTH
 (
	$»®·th
 (
__cÚ¡
 *
__»¡riù
 
__Çme
, *__»¡riù 
__»sŞved
))

40 ià(
	`__bos
 (
__»sŞved
è!ğ(
size_t
) -1)

42 #ià
defšed
 
_LIBC_LIMITS_H_
 && defšed 
PATH_MAX


43 ià(
	`__bos
 (
__»sŞved
è< 
PATH_MAX
)

44  
	`__»®·th_chk_w¬n
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

46  
	`__»®·th_chk
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

49  
	`__»®·th_®Ÿs
 (
__Çme
, 
__»sŞved
);

50 
	}
}

53 
	$__±¢ame_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

54 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

55 
	`__REDIRECT_NTH
 (
__±¢ame_r_®Ÿs
, (
__fd
, *
__buf
,

56 
size_t
 
__buæ’
), 
±¢ame_r
)

57 
	`__nÚnuÎ
 ((2));

58 
	`__REDIRECT_NTH
 (
__±¢ame_r_chk_w¬n
,

59 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

60 
size_t
 
__Ä—l
), 
__±¢ame_r_chk
)

61 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ptsname_r called with buflen biggerhan "

64 
__ex‹º_®ways_šlše
 

65 
	`__NTH
 (
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

67 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

69 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

70  
	`__±¢ame_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

71 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

72  
	`__±¢ame_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

74  
	`__±¢ame_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

75 
	}
}

78 
	$__wùomb_chk
 (*
__s
, 
wch¬_t
 
__wch¬
, 
size_t
 
__buæ’
)

79 
__THROW
 
__wur
;

80 
	`__REDIRECT_NTH
 (
__wùomb_®Ÿs
, (*
__s
, 
wch¬_t
 
__wch¬
),

81 
wùomb
è
__wur
;

83 
__ex‹º_®ways_šlše
 
__wur
 

84 
	`__NTH
 (
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
))

89 
	#__STDLIB_MB_LEN_MAX
 16

	)

90 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__STDLIB_MB_LEN_MAX


93 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__STDLIB_MB_LEN_MAX
 > __bos (__s))

94  
	`__wùomb_chk
 (
__s
, 
__wch¬
, 
	`__bos
 (__s));

95  
	`__wùomb_®Ÿs
 (
__s
, 
__wch¬
);

96 
	}
}

99 
size_t
 
	$__mb¡owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

100 
__cÚ¡
 *
__»¡riù
 
__¤c
,

101 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

102 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_®Ÿs
,

103 (
wch¬_t
 *
__»¡riù
 
__d¡
,

104 
__cÚ¡
 *
__»¡riù
 
__¤c
,

105 
size_t
 
__Ën
), 
mb¡owcs
);

106 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_chk_w¬n
,

107 (
wch¬_t
 *
__»¡riù
 
__d¡
,

108 
__cÚ¡
 *
__»¡riù
 
__¤c
,

109 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__mb¡owcs_chk
)

110 
	`__w¬Ç‰r
 ("mbstowcs called with dst buffer smallerhan†en "

113 
__ex‹º_®ways_šlše
 
size_t


114 
	`__NTH
 (
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

115 
size_t
 
__Ën
))

117 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

119 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

120  
	`__mb¡owcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
,

121 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

123 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

124  
	`__mb¡owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
,

125 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

127  
	`__mb¡owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

128 
	}
}

131 
size_t
 
	$__wc¡ombs_chk
 (*
__»¡riù
 
__d¡
,

132 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

133 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

134 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_®Ÿs
,

135 (*
__»¡riù
 
__d¡
,

136 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

137 
size_t
 
__Ën
), 
wc¡ombs
);

138 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_chk_w¬n
,

139 (*
__»¡riù
 
__d¡
,

140 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

141 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__wc¡ombs_chk
)

142 
	`__w¬Ç‰r
 ("wcstombs called with dst buffer smallerhan†en");

144 
__ex‹º_®ways_šlše
 
size_t


145 
	`__NTH
 (
	$wc¡ombs
 (*
__»¡riù
 
__d¡
, 
__cÚ¡
 
wch¬_t
 *__»¡riù 
__¤c
,

146 
size_t
 
__Ën
))

148 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

150 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

151  
	`__wc¡ombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

152 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

153  
	`__wc¡ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

155  
	`__wc¡ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

156 
	}
}

	@/usr/include/bits/string.h

20 #iâdeà
_STRING_H


26 
	#_STRING_ARCH_uÇligÃd
 1

	)

	@/usr/include/bits/string2.h

21 #iâdeà
_STRING_H


25 #ià!
defšed
 
__NO_STRING_INLINES
 && !defšed 
__BOUNDED_POINTERS__


42 #iâdeà
__STRING_INLINE


43 #ifdeà
__ılu¥lus


44 
	#__STRING_INLINE
 
šlše


	)

46 
	#__STRING_INLINE
 
__ex‹º_šlše


	)

50 #ià
_STRING_ARCH_uÇligÃd


52 
	~<’dŸn.h
>

53 
	~<b™s/ty³s.h
>

55 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


56 
	#__STRING2_SMALL_GET16
(
¤c
, 
idx
) \

57 (((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1] << 8 \

58 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
])

	)

59 
	#__STRING2_SMALL_GET32
(
¤c
, 
idx
) \

60 (((((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 3] << 8 \

61 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 2]) << 8 \

62 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1]) << 8 \

63 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
])

	)

65 
	#__STRING2_SMALL_GET16
(
¤c
, 
idx
) \

66 (((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
] << 8 \

67 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1])

	)

68 
	#__STRING2_SMALL_GET32
(
¤c
, 
idx
) \

69 (((((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
] << 8 \

70 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1]) << 8 \

71 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 2]) << 8 \

72 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 3])

	)

77 
	#__STRING2_COPY_TYPE
(
N
) \

78 ¡ruù { 
__¬r
[
N
]; } \

79 
	t__©Œibu‹__
 ((
	t__·cked__
)è
	t__STRING2_COPY_ARR
##
	tN


	)

80 
	t__STRING2_COPY_TYPE
 (2);

81 
__STRING2_COPY_TYPE
 (3);

82 
__STRING2_COPY_TYPE
 (4);

83 
__STRING2_COPY_TYPE
 (5);

84 
__STRING2_COPY_TYPE
 (6);

85 
__STRING2_COPY_TYPE
 (7);

86 
__STRING2_COPY_TYPE
 (8);

87 #undeà
__STRING2_COPY_TYPE


93 
	#__¡ršg2_1b±r_p
(
__x
) \

94 ((
size_t
)(cÚ¡ *)((
__x
è+ 1è- (size_t)(cÚ¡ *)(__xè=ğ1)

	)

97 #ià!
defšed
 
_HAVE_STRING_ARCH_mem£t


98 #ià!
__GNUC_PREREQ
 (3, 0)

99 #ià
_STRING_ARCH_uÇligÃd


100 
	#mem£t
(
s
, 
c
, 
n
) \

101 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
n
) && (n) <= 16 \

102 ? ((
n
) == 1 \

103 ? 
	`__mem£t_1
 (
s
, 
c
) \

104 : 
	`__mem£t_gc
 (
s
, 
c
, 
n
)) \

105 : (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

106 ? ({ *
__s
 = (
s
); 
	`__bz”o
 (__s, 
n
); __s; }) \

107 : 
	`mem£t
 (
s
, 
c
, 
n
))))

	)

109 
	#__mem£t_1
(
s
, 
c
è({ *
__s
 = (s); \

110 *((
__ušt8_t
 *è
__s
èğ(__ušt8_tè
c
; __s; })

	)

112 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

113 ({ *
__s
 = (
s
); \

115 
__ui
; \

116 
__usi
; \

117 
__uc
; \

118 } *
__u
 = 
__s
; \

119 
__ušt8_t
 
__c
 = (__ušt8_tè(
c
); \

122 (è(
n
)) \

125 
__u
->
__ui
 = 
__c
 * 0x01010101; \

126 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

128 
__u
->
__ui
 = 
__c
 * 0x01010101; \

129 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

131 
__u
->
__ui
 = 
__c
 * 0x01010101; \

132 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

134 
__u
->
__usi
 = (è
__c
 * 0x0101; \

135 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2); \

136 
__u
->
__uc
 = (è
__c
; \

140 
__u
->
__ui
 = 
__c
 * 0x01010101; \

141 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

143 
__u
->
__ui
 = 
__c
 * 0x01010101; \

144 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

146 
__u
->
__ui
 = 
__c
 * 0x01010101; \

147 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

149 
__u
->
__usi
 = (è
__c
 * 0x0101; \

153 
__u
->
__ui
 = 
__c
 * 0x01010101; \

154 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

156 
__u
->
__ui
 = 
__c
 * 0x01010101; \

157 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

159 
__u
->
__ui
 = 
__c
 * 0x01010101; \

160 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

162 
__u
->
__uc
 = (è
__c
; \

166 
__u
->
__ui
 = 
__c
 * 0x01010101; \

167 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

169 
__u
->
__ui
 = 
__c
 * 0x01010101; \

170 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

172 
__u
->
__ui
 = 
__c
 * 0x01010101; \

173 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

175 
__u
->
__ui
 = 
__c
 * 0x01010101; \

180 
__s
; })

	)

182 
	#mem£t
(
s
, 
c
, 
n
) \

183 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

184 ? ({ *
__s
 = (
s
); 
	`__bz”o
 (__s, 
n
); __s; }) \

185 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

194 #ià
__GNUC_PREREQ
 (2, 91)

195 
	#__bz”o
(
s
, 
n
è
	`__butš_mem£t
 (s, '\0',‚)

	)

203 #ifdeà
__USE_GNU


204 #ià!
defšed
 
_HAVE_STRING_ARCH_mempıy
 || defšed 
_FORCE_INLINES


205 #iâdeà
_HAVE_STRING_ARCH_mempıy


206 #ià
__GNUC_PREREQ
 (3, 4)

207 
	#__mempıy
(
de¡
, 
¤c
, 
n
è
	`__butš_mempıy
 (de¡, src,‚)

	)

208 #–ià
__GNUC_PREREQ
 (3, 0)

209 
	#__mempıy
(
de¡
, 
¤c
, 
n
) \

210 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

211 && 
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
n
 <= 8 \

212 ? 
	`__butš_memıy
 (
de¡
, 
¤c
, 
n
) + (n) \

213 : 
	`__mempıy
 (
de¡
, 
¤c
, 
n
)))

	)

215 
	#__mempıy
(
de¡
, 
¤c
, 
n
) \

216 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

217 && 
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
n
 <= 8 \

218 ? 
	`__mempıy_sm®l
 (
de¡
, 
	`__mempıy_¬gs
 (
¤c
), 
n
) \

219 : 
	`__mempıy
 (
de¡
, 
¤c
, 
n
)))

	)

223 
	#mempıy
(
de¡
, 
¤c
, 
n
è
	`__mempıy
 (de¡, src,‚)

	)

226 #ià!
__GNUC_PREREQ
 (3, 0è|| 
defšed
 
_FORCE_INLINES


227 #ià
_STRING_ARCH_uÇligÃd


228 #iâdeà
_FORCE_INLINES


229 
	#__mempıy_¬gs
(
¤c
) \

230 ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[2], \

231 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[6], \

232 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

233 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

234 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

235 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

237 
__STRING_INLINE
 *
__mempıy_sm®l
 (*, , , , ,

238 
__ušt16_t
, __ušt16_t, 
__ušt32_t
,

239 
__ušt32_t
, 
size_t
);

240 
__STRING_INLINE
 *

241 
	$__mempıy_sm®l
 (*
__de¡1
,

242 
__¤c0_1
, 
__¤c2_1
, 
__¤c4_1
, 
__¤c6_1
,

243 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

244 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

245 
size_t
 
__¤ş’
)

248 
__ušt32_t
 
__ui
;

249 
__ušt16_t
 
__usi
;

250 
__uc
;

251 
__c
;

252 } *
__u
 = 
__de¡1
;

253 (è
__¤ş’
)

256 
__u
->
__c
 = 
__¤c0_1
;

257 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

260 
__u
->
__usi
 = 
__¤c0_2
;

261 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

264 
__u
->
__usi
 = 
__¤c0_2
;

265 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

266 
__u
->
__c
 = 
__¤c2_1
;

267 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

270 
__u
->
__ui
 = 
__¤c0_4
;

271 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

274 
__u
->
__ui
 = 
__¤c0_4
;

275 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

276 
__u
->
__c
 = 
__¤c4_1
;

277 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

280 
__u
->
__ui
 = 
__¤c0_4
;

281 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

282 
__u
->
__usi
 = 
__¤c4_2
;

283 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

286 
__u
->
__ui
 = 
__¤c0_4
;

287 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

288 
__u
->
__usi
 = 
__¤c4_2
;

289 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

290 
__u
->
__c
 = 
__¤c6_1
;

291 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

294 
__u
->
__ui
 = 
__¤c0_4
;

295 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

296 
__u
->
__ui
 = 
__¤c4_4
;

297 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

300  (*è
__u
;

301 
	}
}

303 #iâdeà
_FORCE_INLINES


304 
	#__mempıy_¬gs
(
¤c
) \

305 ((
__cÚ¡
 *è(
¤c
))[0], \

306 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

307 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1] } }), \

308 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

309 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

310 ((
__cÚ¡
 *è(
¤c
))[2] } }), \

311 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

312 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

313 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3] } }), \

314 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

315 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

316 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

317 ((
__cÚ¡
 *è(
¤c
))[4] } }), \

318 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

319 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

320 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

321 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5] } }), \

322 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

323 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

324 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

325 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

326 ((
__cÚ¡
 *è(
¤c
))[6] } }), \

327 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

328 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

329 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

330 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

331 ((
__cÚ¡
 *è(
¤c
))[6], ((__cÚ¡ *è(¤c))[7] } })

	)

333 
__STRING_INLINE
 *
__mempıy_sm®l
 (*, , 
__STRING2_COPY_ARR2
,

334 
__STRING2_COPY_ARR3
,

335 
__STRING2_COPY_ARR4
,

336 
__STRING2_COPY_ARR5
,

337 
__STRING2_COPY_ARR6
,

338 
__STRING2_COPY_ARR7
,

339 
__STRING2_COPY_ARR8
, 
size_t
);

340 
__STRING_INLINE
 *

341 
	$__mempıy_sm®l
 (*
__de¡
, 
__¤c1
,

342 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

343 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

344 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

345 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

348 
__c
;

349 
__STRING2_COPY_ARR2
 
__sÿ2
;

350 
__STRING2_COPY_ARR3
 
__sÿ3
;

351 
__STRING2_COPY_ARR4
 
__sÿ4
;

352 
__STRING2_COPY_ARR5
 
__sÿ5
;

353 
__STRING2_COPY_ARR6
 
__sÿ6
;

354 
__STRING2_COPY_ARR7
 
__sÿ7
;

355 
__STRING2_COPY_ARR8
 
__sÿ8
;

356 } *
__u
 = 
__de¡
;

357 (è
__¤ş’
)

360 
__u
->
__c
 = 
__¤c1
;

363 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

366 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

369 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

372 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

375 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

378 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

381 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

384  
	`__ex‹nsiÚ__
 ((*è
__u
 + 
__¤ş’
);

385 
	}
}

393 #iâdeà
_HAVE_STRING_ARCH_¡rchr


394 *
__¿wmemchr
 (cÚ¡ *
__s
, 
__c
);

395 #ià
__GNUC_PREREQ
 (3, 2)

396 
	#¡rchr
(
s
, 
c
) \

397 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
è&& !__butš_cÚ¡ªt_°(
s
) \

398 && (
c
) == '\0' \

399 ? (*è
	`__¿wmemchr
 (
s
, 
c
) \

400 : 
	`__butš_¡rchr
 (
s
, 
c
)))

	)

402 
	#¡rchr
(
s
, 
c
) \

403 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

404 ? (*è
	`__¿wmemchr
 (
s
, 
c
) \

405 : 
	`¡rchr
 (
s
, 
c
)))

	)

411 #ià(!
defšed
 
_HAVE_STRING_ARCH_¡rıy
 && !
__GNUC_PREREQ
 (3, 0)) \

412 || 
defšed
 
	g_FORCE_INLINES


413 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rıy
 && !
__GNUC_PREREQ
 (3, 0)

414 
	#¡rıy
(
de¡
, 
¤c
) \

415 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

416 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

417 ? 
	`__¡rıy_sm®l
 (
de¡
, 
	`__¡rıy_¬gs
 (
¤c
), \

418 
	`¡¾’
 (
¤c
) + 1) \

419 : (*è
	`memıy
 (
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1)) \

420 : 
	`¡rıy
 (
de¡
, 
¤c
)))

	)

423 #ià
_STRING_ARCH_uÇligÃd


424 #iâdeà
_FORCE_INLINES


425 
	#__¡rıy_¬gs
(
¤c
) \

426 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

427 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

428 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

429 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

431 
__STRING_INLINE
 *
__¡rıy_sm®l
 (*, 
__ušt16_t
, __uint16_t,

432 
__ušt32_t
, __ušt32_t, 
size_t
);

433 
__STRING_INLINE
 *

434 
	$__¡rıy_sm®l
 (*
__de¡
,

435 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

436 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

437 
size_t
 
__¤ş’
)

440 
__ušt32_t
 
__ui
;

441 
__ušt16_t
 
__usi
;

442 
__uc
;

443 } *
__u
 = (*è
__de¡
;

444 (è
__¤ş’
)

447 
__u
->
__uc
 = '\0';

450 
__u
->
__usi
 = 
__¤c0_2
;

453 
__u
->
__usi
 = 
__¤c0_2
;

454 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

455 
__u
->
__uc
 = '\0';

458 
__u
->
__ui
 = 
__¤c0_4
;

461 
__u
->
__ui
 = 
__¤c0_4
;

462 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

463 
__u
->
__uc
 = '\0';

466 
__u
->
__ui
 = 
__¤c0_4
;

467 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

468 
__u
->
__usi
 = 
__¤c4_2
;

471 
__u
->
__ui
 = 
__¤c0_4
;

472 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

473 
__u
->
__usi
 = 
__¤c4_2
;

474 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

475 
__u
->
__uc
 = '\0';

478 
__u
->
__ui
 = 
__¤c0_4
;

479 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

480 
__u
->
__ui
 = 
__¤c4_4
;

483  
__de¡
;

484 
	}
}

486 #iâdeà
_FORCE_INLINES


487 
	#__¡rıy_¬gs
(
¤c
) \

488 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

489 { { ((
__cÚ¡
 *è(
¤c
))[0], '\0' } }), \

490 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

491 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

493 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

494 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

495 ((
__cÚ¡
 *è(
¤c
))[2], '\0' } }), \

496 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

497 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

498 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

500 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

501 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

502 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

503 ((
__cÚ¡
 *è(
¤c
))[4], '\0' } }), \

504 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

505 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

506 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

507 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

509 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

510 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

511 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

512 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

513 ((
__cÚ¡
 *è(
¤c
))[6], '\0' } })

	)

515 
__STRING_INLINE
 *
__¡rıy_sm®l
 (*, 
__STRING2_COPY_ARR2
,

516 
__STRING2_COPY_ARR3
,

517 
__STRING2_COPY_ARR4
,

518 
__STRING2_COPY_ARR5
,

519 
__STRING2_COPY_ARR6
,

520 
__STRING2_COPY_ARR7
,

521 
__STRING2_COPY_ARR8
, 
size_t
);

522 
__STRING_INLINE
 *

523 
	$__¡rıy_sm®l
 (*
__de¡
,

524 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

525 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

526 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

527 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

530 
__c
;

531 
__STRING2_COPY_ARR2
 
__sÿ2
;

532 
__STRING2_COPY_ARR3
 
__sÿ3
;

533 
__STRING2_COPY_ARR4
 
__sÿ4
;

534 
__STRING2_COPY_ARR5
 
__sÿ5
;

535 
__STRING2_COPY_ARR6
 
__sÿ6
;

536 
__STRING2_COPY_ARR7
 
__sÿ7
;

537 
__STRING2_COPY_ARR8
 
__sÿ8
;

538 } *
__u
 = (*è
__de¡
;

539 (è
__¤ş’
)

542 
__u
->
__c
 = '\0';

545 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

548 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

551 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

554 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

557 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

560 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

563 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

566  
__de¡
;

567 
	}
}

573 #ifdeà
__USE_GNU


574 #ià!
defšed
 
_HAVE_STRING_ARCH_¡pıy
 || defšed 
_FORCE_INLINES


575 #iâdeà
_HAVE_STRING_ARCH_¡pıy


576 #ià
__GNUC_PREREQ
 (3, 4)

577 
	#__¡pıy
(
de¡
, 
¤c
è
	`__butš_¡pıy
 (de¡, src)

	)

578 #–ià
__GNUC_PREREQ
 (3, 0)

579 
	#__¡pıy
(
de¡
, 
¤c
) \

580 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

581 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

582 ? 
	`__butš_¡rıy
 (
de¡
, 
¤c
è+ 
	`¡¾’
 (src) \

583 : ((*è(
__mempıy
è(
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1) \

585 : 
	`__¡pıy
 (
de¡
, 
¤c
)))

	)

587 
	#__¡pıy
(
de¡
, 
¤c
) \

588 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

589 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

590 ? 
	`__¡pıy_sm®l
 (
de¡
, 
	`__¡pıy_¬gs
 (
¤c
), \

591 
	`¡¾’
 (
¤c
) + 1) \

592 : ((*è(
__mempıy
è(
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1) \

594 : 
	`__¡pıy
 (
de¡
, 
¤c
)))

	)

598 
	#¡pıy
(
de¡
, 
¤c
è
	`__¡pıy
 (de¡, src)

	)

601 #ià!
__GNUC_PREREQ
 (3, 0è|| 
defšed
 
_FORCE_INLINES


602 #ià
_STRING_ARCH_uÇligÃd


603 #iâdeà
_FORCE_INLINES


604 
	#__¡pıy_¬gs
(
¤c
) \

605 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

606 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

607 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

608 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

610 
__STRING_INLINE
 *
__¡pıy_sm®l
 (*, 
__ušt16_t
, __uint16_t,

611 
__ušt32_t
, __ušt32_t, 
size_t
);

612 
__STRING_INLINE
 *

613 
	$__¡pıy_sm®l
 (*
__de¡
,

614 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

615 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

616 
size_t
 
__¤ş’
)

619 
__ui
;

620 
__usi
;

621 
__uc
;

622 
__c
;

623 } *
__u
 = (*è
__de¡
;

624 (è
__¤ş’
)

627 
__u
->
__uc
 = '\0';

630 
__u
->
__usi
 = 
__¤c0_2
;

631 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

634 
__u
->
__usi
 = 
__¤c0_2
;

635 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

636 
__u
->
__uc
 = '\0';

639 
__u
->
__ui
 = 
__¤c0_4
;

640 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 3);

643 
__u
->
__ui
 = 
__¤c0_4
;

644 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

645 
__u
->
__uc
 = '\0';

648 
__u
->
__ui
 = 
__¤c0_4
;

649 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

650 
__u
->
__usi
 = 
__¤c4_2
;

651 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

654 
__u
->
__ui
 = 
__¤c0_4
;

655 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

656 
__u
->
__usi
 = 
__¤c4_2
;

657 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

658 
__u
->
__uc
 = '\0';

661 
__u
->
__ui
 = 
__¤c0_4
;

662 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

663 
__u
->
__ui
 = 
__¤c4_4
;

664 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 3);

667  &
__u
->
__c
;

668 
	}
}

670 #iâdeà
_FORCE_INLINES


671 
	#__¡pıy_¬gs
(
¤c
) \

672 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

673 { { ((
__cÚ¡
 *è(
¤c
))[0], '\0' } }), \

674 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

675 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

677 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

678 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

679 ((
__cÚ¡
 *è(
¤c
))[2], '\0' } }), \

680 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

681 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

682 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

684 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

685 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

686 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

687 ((
__cÚ¡
 *è(
¤c
))[4], '\0' } }), \

688 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

689 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

690 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

691 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

693 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

694 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

695 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

696 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

697 ((
__cÚ¡
 *è(
¤c
))[6], '\0' } })

	)

699 
__STRING_INLINE
 *
__¡pıy_sm®l
 (*, 
__STRING2_COPY_ARR2
,

700 
__STRING2_COPY_ARR3
,

701 
__STRING2_COPY_ARR4
,

702 
__STRING2_COPY_ARR5
,

703 
__STRING2_COPY_ARR6
,

704 
__STRING2_COPY_ARR7
,

705 
__STRING2_COPY_ARR8
, 
size_t
);

706 
__STRING_INLINE
 *

707 
	$__¡pıy_sm®l
 (*
__de¡
,

708 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

709 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

710 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

711 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

714 
__c
;

715 
__STRING2_COPY_ARR2
 
__sÿ2
;

716 
__STRING2_COPY_ARR3
 
__sÿ3
;

717 
__STRING2_COPY_ARR4
 
__sÿ4
;

718 
__STRING2_COPY_ARR5
 
__sÿ5
;

719 
__STRING2_COPY_ARR6
 
__sÿ6
;

720 
__STRING2_COPY_ARR7
 
__sÿ7
;

721 
__STRING2_COPY_ARR8
 
__sÿ8
;

722 } *
__u
 = (*è
__de¡
;

723 (è
__¤ş’
)

726 
__u
->
__c
 = '\0';

729 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

732 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

735 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

738 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

741 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

744 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

747 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

750  
__de¡
 + 
__¤ş’
 - 1;

751 
	}
}

759 #iâdeà
_HAVE_STRING_ARCH_¡ºıy


760 #ià
__GNUC_PREREQ
 (3, 2)

761 
	#¡ºıy
(
de¡
, 
¤c
, 
n
è
	`__butš_¡ºıy
 (de¡, src,‚)

	)

763 
	#¡ºıy
(
de¡
, 
¤c
, 
n
) \

764 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

765 ? (
	`¡¾’
 (
¤c
è+ 1 >ğ((
size_t
è(
n
)) \

766 ? (*è
	`memıy
 (
de¡
, 
¤c
, 
n
) \

767 : 
	`¡ºıy
 (
de¡
, 
¤c
, 
n
)) \

768 : 
	`¡ºıy
 (
de¡
, 
¤c
, 
n
)))

	)

774 #iâdeà
_HAVE_STRING_ARCH_¡ºÿt


775 #ifdeà
_USE_STRING_ARCH_¡rchr


776 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
) \

777 (
	`__ex‹nsiÚ__
 ({ *
__de¡
 = (
de¡
); \

778 
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

779 ? (
	`¡¾’
 (
¤c
è< ((
size_t
è(
n
)) \

780 ? 
	`¡rÿt
 (
__de¡
, 
¤c
) \

781 : (*((*è
	`__mempıy
 (
	`¡rchr
 (
__de¡
, '\0'), \

782 
¤c
, 
n
)èğ'\0', 
__de¡
)) \

783 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
); }))

	)

784 #–ià
__GNUC_PREREQ
 (3, 2)

785 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
è
	`__butš_¡ºÿt
 (de¡, src,‚)

	)

787 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
) \

788 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

789 ? (
	`¡¾’
 (
¤c
è< ((
size_t
è(
n
)) \

790 ? 
	`¡rÿt
 (
de¡
, 
¤c
) \

791 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
)) \

792 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
)))

	)

798 #iâdeà
_HAVE_STRING_ARCH_¡rcmp


799 #ià
__GNUC_PREREQ
 (3, 2)

800 
	#¡rcmp
(
s1
, 
s2
) \

801 
__ex‹nsiÚ__
 \

802 ({ 
size_t
 
__s1_Ën
, 
__s2_Ën
; \

803 (
	`__butš_cÚ¡ªt_p
 (
s1
è&& __butš_cÚ¡ªt_°(
s2
) \

804 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), 
__s2_Ën
 = sŒËÀ(
s2
), \

805 (!
	`__¡ršg2_1b±r_p
 (
s1
è|| 
__s1_Ën
 >= 4) \

806 && (!
	`__¡ršg2_1b±r_p
 (
s2
è|| 
__s2_Ën
 >= 4)) \

807 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

808 : (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

809 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), __s1_len < 4) \

810 ? (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

811 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

812 : 
	`__¡rcmp_cg
 (
s1
, 
s2
, 
__s1_Ën
)) \

813 : (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

814 && (
__s2_Ën
 = 
	`¡¾’
 (
s2
), __s2_len < 4) \

815 ? (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

816 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

817 : 
	`__¡rcmp_gc
 (
s1
, 
s2
, 
__s2_Ën
)) \

818 : 
	`__butš_¡rcmp
 (
s1
, 
s2
)))); })

	)

820 
	#¡rcmp
(
s1
, 
s2
) \

821 
__ex‹nsiÚ__
 \

822 ({ 
size_t
 
__s1_Ën
, 
__s2_Ën
; \

823 (
	`__butš_cÚ¡ªt_p
 (
s1
è&& __butš_cÚ¡ªt_°(
s2
) \

824 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), 
__s2_Ën
 = sŒËÀ(
s2
), \

825 (!
	`__¡ršg2_1b±r_p
 (
s1
è|| 
__s1_Ën
 >= 4) \

826 && (!
	`__¡ršg2_1b±r_p
 (
s2
è|| 
__s2_Ën
 >= 4)) \

827 ? 
	`memcmp
 ((
__cÚ¡
 *è(
s1
), (__cÚ¡ *è(
s2
), \

828 (
__s1_Ën
 < 
__s2_Ën
 ? __s1_len : __s2_len) + 1) \

829 : (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

830 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), __s1_len < 4) \

831 ? (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

832 ? 
	`__¡rcmp_cc
 (
s1
, 
s2
, 
__s1_Ën
) \

833 : 
	`__¡rcmp_cg
 (
s1
, 
s2
, 
__s1_Ën
)) \

834 : (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

835 && (
__s2_Ën
 = 
	`¡¾’
 (
s2
), __s2_len < 4) \

836 ? (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

837 ? 
	`__¡rcmp_cc
 (
s1
, 
s2
, 
__s2_Ën
) \

838 : 
	`__¡rcmp_gc
 (
s1
, 
s2
, 
__s2_Ën
)) \

839 : 
	`¡rcmp
 (
s1
, 
s2
)))); })

	)

842 
	#__¡rcmp_cc
(
s1
, 
s2
, 
l
) \

843 (
	`__ex‹nsiÚ__
 ({ 
__»suÉ
 = \

844 (((
__cÚ¡
 *è(__cÚ¡ *è(
s1
))[0] \

845 - ((
__cÚ¡
 *è(__cÚ¡ *)(
s2
))[0]);\

846 ià(
l
 > 0 && 
__»suÉ
 == 0) \

848 
__»suÉ
 = (((
__cÚ¡
 *) \

849 (
__cÚ¡
 *è(
s1
))[1] \

850 - ((
__cÚ¡
 *) \

851 (
__cÚ¡
 *è(
s2
))[1]); \

852 ià(
l
 > 1 && 
__»suÉ
 == 0) \

854 
__»suÉ
 = \

855 (((
__cÚ¡
 *) \

856 (
__cÚ¡
 *è(
s1
))[2] \

857 - ((
__cÚ¡
 *) \

858 (
__cÚ¡
 *è(
s2
))[2]); \

859 ià(
l
 > 2 && 
__»suÉ
 == 0) \

860 
__»suÉ
 = \

861 (((
__cÚ¡
 *) \

862 (
__cÚ¡
 *è(
s1
))[3] \

863 - ((
__cÚ¡
 *) \

864 (
__cÚ¡
 *è(
s2
))[3]); \

867 
__»suÉ
; }))

	)

869 
	#__¡rcmp_cg
(
s1
, 
s2
, 
l1
) \

870 (
	`__ex‹nsiÚ__
 ({ 
__cÚ¡
 *
__s2
 = \

871 (
__cÚ¡
 *è(__cÚ¡ *è(
s2
); \

872 
__»suÉ
 = \

873 (((
__cÚ¡
 *è(__cÚ¡ *è(
s1
))[0] \

874 - 
__s2
[0]); \

875 ià(
l1
 > 0 && 
__»suÉ
 == 0) \

877 
__»suÉ
 = (((
__cÚ¡
 *) \

878 (
__cÚ¡
 *è(
s1
))[1] - 
__s2
[1]); \

879 ià(
l1
 > 1 && 
__»suÉ
 == 0) \

881 
__»suÉ
 = (((
__cÚ¡
 *) \

882 (
__cÚ¡
 *è(
s1
))[2] - 
__s2
[2]);\

883 ià(
l1
 > 2 && 
__»suÉ
 == 0) \

884 
__»suÉ
 = (((
__cÚ¡
 *) \

885 (
__cÚ¡
 *è(
s1
))[3] \

886 - 
__s2
[3]); \

889 
__»suÉ
; }))

	)

891 
	#__¡rcmp_gc
(
s1
, 
s2
, 
l2
) \

892 (
	`__ex‹nsiÚ__
 ({ 
__cÚ¡
 *
__s1
 = \

893 (
__cÚ¡
 *è(__cÚ¡ *è(
s1
); \

894 
__»suÉ
 = \

895 
__s1
[0] - ((
__cÚ¡
 *) \

896 (
__cÚ¡
 *è(
s2
))[0]; \

897 ià(
l2
 > 0 && 
__»suÉ
 == 0) \

899 
__»suÉ
 = (
__s1
[1] \

900 - ((
__cÚ¡
 *) \

901 (
__cÚ¡
 *è(
s2
))[1]); \

902 ià(
l2
 > 1 && 
__»suÉ
 == 0) \

904 
__»suÉ
 = \

905 (
__s1
[2] - ((
__cÚ¡
 *) \

906 (
__cÚ¡
 *è(
s2
))[2]); \

907 ià(
l2
 > 2 && 
__»suÉ
 == 0) \

908 
__»suÉ
 = \

909 (
__s1
[3] \

910 - ((
__cÚ¡
 *) \

911 (
__cÚ¡
 *è(
s2
))[3]); \

914 
__»suÉ
; }))

	)

919 #iâdeà
_HAVE_STRING_ARCH_¡ºcmp


920 
	#¡ºcmp
(
s1
, 
s2
, 
n
) \

921 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
n
) \

922 && ((
	`__butš_cÚ¡ªt_p
 (
s1
) \

923 && 
	`¡¾’
 (
s1
è< ((
size_t
è(
n
))) \

924 || (
	`__butš_cÚ¡ªt_p
 (
s2
) \

925 && 
	`¡¾’
 (
s2
è< ((
size_t
è(
n
)))) \

926 ? 
	`¡rcmp
 (
s1
, 
s2
è: 
	`¡ºcmp
 (s1, s2, 
n
)))

	)

932 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rc¥n
 || defšed 
_FORCE_INLINES


933 #iâdeà
_HAVE_STRING_ARCH_¡rc¥n


934 #ià
__GNUC_PREREQ
 (3, 2)

935 
	#¡rc¥n
(
s
, 
»jeù
) \

936 
__ex‹nsiÚ__
 \

937 ({ 
__r0
, 
__r1
, 
__r2
; \

938 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

939 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

940 ? 
	`__butš_¡rc¥n
 (
s
, 
»jeù
) \

941 : ((
__r0
 = ((
__cÚ¡
 *è(
»jeù
))[0], __r0 == '\0') \

942 ? 
	`¡¾’
 (
s
) \

943 : ((
__r1
 = ((
__cÚ¡
 *è(
»jeù
))[1], __r1 == '\0') \

944 ? 
	`__¡rc¥n_c1
 (
s
, 
__r0
) \

945 : ((
__r2
 = ((
__cÚ¡
 *è(
»jeù
))[2], __r2 == '\0') \

946 ? 
	`__¡rc¥n_c2
 (
s
, 
__r0
, 
__r1
) \

947 : (((
__cÚ¡
 *è(
»jeù
))[3] == '\0' \

948 ? 
	`__¡rc¥n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

949 : 
	`__butš_¡rc¥n
 (
s
, 
»jeù
)))))) \

950 : 
	`__butš_¡rc¥n
 (
s
, 
»jeù
)); })

	)

952 
	#¡rc¥n
(
s
, 
»jeù
) \

953 
__ex‹nsiÚ__
 \

954 ({ 
__r0
, 
__r1
, 
__r2
; \

955 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

956 ? ((
__r0
 = ((
__cÚ¡
 *è(
»jeù
))[0], __r0 == '\0') \

957 ? 
	`¡¾’
 (
s
) \

958 : ((
__r1
 = ((
__cÚ¡
 *è(
»jeù
))[1], __r1 == '\0') \

959 ? 
	`__¡rc¥n_c1
 (
s
, 
__r0
) \

960 : ((
__r2
 = ((
__cÚ¡
 *è(
»jeù
))[2], __r2 == '\0') \

961 ? 
	`__¡rc¥n_c2
 (
s
, 
__r0
, 
__r1
) \

962 : (((
__cÚ¡
 *è(
»jeù
))[3] == '\0' \

963 ? 
	`__¡rc¥n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

964 : 
	`¡rc¥n
 (
s
, 
»jeù
))))) \

965 : 
	`¡rc¥n
 (
s
, 
»jeù
)); })

	)

969 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c1
 (
__cÚ¡
 *
__s
, 
__»jeù
);

970 
__STRING_INLINE
 
size_t


971 
	$__¡rc¥n_c1
 (
__cÚ¡
 *
__s
, 
__»jeù
)

973 
size_t
 
__»suÉ
 = 0;

974 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù
)

975 ++
__»suÉ
;

976  
__»suÉ
;

977 
	}
}

979 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c2
 (
__cÚ¡
 *
__s
, 
__»jeù1
,

980 
__»jeù2
);

981 
__STRING_INLINE
 
size_t


982 
	$__¡rc¥n_c2
 (
__cÚ¡
 *
__s
, 
__»jeù1
, 
__»jeù2
)

984 
size_t
 
__»suÉ
 = 0;

985 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù1


986 && 
__s
[
__»suÉ
] !ğ
__»jeù2
)

987 ++
__»suÉ
;

988  
__»suÉ
;

989 
	}
}

991 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c3
 (
__cÚ¡
 *
__s
, 
__»jeù1
,

992 
__»jeù2
, 
__»jeù3
);

993 
__STRING_INLINE
 
size_t


994 
	$__¡rc¥n_c3
 (
__cÚ¡
 *
__s
, 
__»jeù1
, 
__»jeù2
,

995 
__»jeù3
)

997 
size_t
 
__»suÉ
 = 0;

998 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù1


999 && 
__s
[
__»suÉ
] !ğ
__»jeù2
 && __s[__»suÉ] !ğ
__»jeù3
)

1000 ++
__»suÉ
;

1001  
__»suÉ
;

1002 
	}
}

1008 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r¥n
 || defšed 
_FORCE_INLINES


1009 #iâdeà
_HAVE_STRING_ARCH_¡r¥n


1010 #ià
__GNUC_PREREQ
 (3, 2)

1011 
	#¡r¥n
(
s
, 
acû±
) \

1012 
__ex‹nsiÚ__
 \

1013 ({ 
__a0
, 
__a1
, 
__a2
; \

1014 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1015 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

1016 ? 
	`__butš_¡r¥n
 (
s
, 
acû±
) \

1017 : ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1018 ? ((è(
s
), 0) \

1019 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1020 ? 
	`__¡r¥n_c1
 (
s
, 
__a0
) \

1021 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1022 ? 
	`__¡r¥n_c2
 (
s
, 
__a0
, 
__a1
) \

1023 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1024 ? 
	`__¡r¥n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1025 : 
	`__butš_¡r¥n
 (
s
, 
acû±
)))))) \

1026 : 
	`__butš_¡r¥n
 (
s
, 
acû±
)); })

	)

1028 
	#¡r¥n
(
s
, 
acû±
) \

1029 
__ex‹nsiÚ__
 \

1030 ({ 
__a0
, 
__a1
, 
__a2
; \

1031 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1032 ? ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1033 ? ((è(
s
), 0) \

1034 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1035 ? 
	`__¡r¥n_c1
 (
s
, 
__a0
) \

1036 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1037 ? 
	`__¡r¥n_c2
 (
s
, 
__a0
, 
__a1
) \

1038 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1039 ? 
	`__¡r¥n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1040 : 
	`¡r¥n
 (
s
, 
acû±
))))) \

1041 : 
	`¡r¥n
 (
s
, 
acû±
)); })

	)

1045 
__STRING_INLINE
 
size_t
 
__¡r¥n_c1
 (
__cÚ¡
 *
__s
, 
__acû±
);

1046 
__STRING_INLINE
 
size_t


1047 
	$__¡r¥n_c1
 (
__cÚ¡
 *
__s
, 
__acû±
)

1049 
size_t
 
__»suÉ
 = 0;

1051 
__s
[
__»suÉ
] =ğ
__acû±
)

1052 ++
__»suÉ
;

1053  
__»suÉ
;

1054 
	}
}

1056 
__STRING_INLINE
 
size_t
 
__¡r¥n_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1057 
__acû±2
);

1058 
__STRING_INLINE
 
size_t


1059 
	$__¡r¥n_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
)

1061 
size_t
 
__»suÉ
 = 0;

1063 
__s
[
__»suÉ
] =ğ
__acû±1
 || __s[__»suÉ] =ğ
__acû±2
)

1064 ++
__»suÉ
;

1065  
__»suÉ
;

1066 
	}
}

1068 
__STRING_INLINE
 
size_t
 
__¡r¥n_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1069 
__acû±2
, 
__acû±3
);

1070 
__STRING_INLINE
 
size_t


1071 
	$__¡r¥n_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
, 
__acû±3
)

1073 
size_t
 
__»suÉ
 = 0;

1075 
__s
[
__»suÉ
] =ğ
__acû±1
 || __s[__»suÉ] =ğ
__acû±2


1076 || 
__s
[
__»suÉ
] =ğ
__acû±3
)

1077 ++
__»suÉ
;

1078  
__»suÉ
;

1079 
	}
}

1084 #ià!
defšed
 
_HAVE_STRING_ARCH_¡½brk
 || defšed 
_FORCE_INLINES


1085 #iâdeà
_HAVE_STRING_ARCH_¡½brk


1086 #ià
__GNUC_PREREQ
 (3, 2)

1087 
	#¡½brk
(
s
, 
acû±
) \

1088 
__ex‹nsiÚ__
 \

1089 ({ 
__a0
, 
__a1
, 
__a2
; \

1090 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1091 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

1092 ? 
	`__butš_¡½brk
 (
s
, 
acû±
) \

1093 : ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1094 ? ((è(
s
), (*è
NULL
) \

1095 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1096 ? 
	`__butš_¡rchr
 (
s
, 
__a0
) \

1097 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1098 ? 
	`__¡½brk_c2
 (
s
, 
__a0
, 
__a1
) \

1099 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1100 ? 
	`__¡½brk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1101 : 
	`__butš_¡½brk
 (
s
, 
acû±
)))))) \

1102 : 
	`__butš_¡½brk
 (
s
, 
acû±
)); })

	)

1104 
	#¡½brk
(
s
, 
acû±
) \

1105 
__ex‹nsiÚ__
 \

1106 ({ 
__a0
, 
__a1
, 
__a2
; \

1107 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1108 ? ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1109 ? ((è(
s
), (*è
NULL
) \

1110 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1111 ? 
	`¡rchr
 (
s
, 
__a0
) \

1112 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1113 ? 
	`__¡½brk_c2
 (
s
, 
__a0
, 
__a1
) \

1114 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1115 ? 
	`__¡½brk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1116 : 
	`¡½brk
 (
s
, 
acû±
))))) \

1117 : 
	`¡½brk
 (
s
, 
acû±
)); })

	)

1121 
__STRING_INLINE
 *
__¡½brk_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1122 
__acû±2
);

1123 
__STRING_INLINE
 *

1124 
	$__¡½brk_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
)

1127 *
__s
 !ğ'\0' && *__ !ğ
__acû±1
 && *__ !ğ
__acû±2
)

1128 ++
__s
;

1129  *
__s
 =ğ'\0' ? 
NULL
 : (*è(
size_t
) __s;

1130 
	}
}

1132 
__STRING_INLINE
 *
__¡½brk_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1133 
__acû±2
, 
__acû±3
);

1134 
__STRING_INLINE
 *

1135 
	$__¡½brk_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
,

1136 
__acû±3
)

1139 *
__s
 !ğ'\0' && *__ !ğ
__acû±1
 && *__ !ğ
__acû±2


1140 && *
__s
 !ğ
__acû±3
)

1141 ++
__s
;

1142  *
__s
 =ğ'\0' ? 
NULL
 : (*è(
size_t
) __s;

1143 
	}
}

1149 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r¡r
 && !
__GNUC_PREREQ
 (2, 97)

1150 
	#¡r¡r
(
hay¡ack
, 
ÃedË
) \

1151 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
ÃedË
è&& 
	`__¡ršg2_1b±r_p
 (needle) \

1152 ? (((
__cÚ¡
 *è(
ÃedË
))[0] == '\0' \

1153 ? (*è(
size_t
è(
hay¡ack
) \

1154 : (((
__cÚ¡
 *è(
ÃedË
))[1] == '\0' \

1155 ? 
	`¡rchr
 (
hay¡ack
, \

1156 ((
__cÚ¡
 *è(
ÃedË
))[0]) \

1157 : 
	`¡r¡r
 (
hay¡ack
, 
ÃedË
))) \

1158 : 
	`¡r¡r
 (
hay¡ack
, 
ÃedË
)))

	)

1162 #ià!
defšed
 
_HAVE_STRING_ARCH_¡¹ok_r
 || defšed 
_FORCE_INLINES


1163 #iâdeà
_HAVE_STRING_ARCH_¡¹ok_r


1164 
	#__¡¹ok_r
(
s
, 
£p
, 
Ãx
) \

1165 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
£p
è&& 
	`__¡ršg2_1b±r_p
 (sep) \

1166 && ((
__cÚ¡
 *è(
£p
))[0] != '\0' \

1167 && ((
__cÚ¡
 *è(
£p
))[1] == '\0' \

1168 ? 
	`__¡¹ok_r_1c
 (
s
, ((
__cÚ¡
 *è(
£p
))[0], 
Ãx
) \

1169 : 
	`__¡¹ok_r
 (
s
, 
£p
, 
Ãx
)))

	)

1172 
__STRING_INLINE
 *
__¡¹ok_r_1c
 (*
__s
, 
__£p
, **
__Ãx
);

1173 
__STRING_INLINE
 *

1174 
	$__¡¹ok_r_1c
 (*
__s
, 
__£p
, **
__Ãx
)

1176 *
__»suÉ
;

1177 ià(
__s
 =ğ
NULL
)

1178 
__s
 = *
__Ãx
;

1179 *
__s
 =ğ
__£p
)

1180 ++
__s
;

1181 
__»suÉ
 = 
NULL
;

1182 ià(*
__s
 != '\0')

1184 
__»suÉ
 = 
__s
++;

1185 *
__s
 != '\0')

1186 ià(*
__s
++ =ğ
__£p
)

1188 
__s
[-1] = '\0';

1192 *
__Ãx
 = 
__s
;

1193  
__»suÉ
;

1194 
	}
}

1195 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


1196 
	#¡¹ok_r
(
s
, 
£p
, 
Ãx
è
	`__¡¹ok_r
 (s, s•,‚ex)

	)

1201 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r£p
 || defšed 
_FORCE_INLINES


1202 #iâdeà
_HAVE_STRING_ARCH_¡r£p


1204 *
__¡r£p_g
 (**
__¡ršgp
, 
__cÚ¡
 *
__d–im
);

1205 
	#__¡r£p
(
s
, 
»jeù
) \

1206 
__ex‹nsiÚ__
 \

1207 ({ 
__r0
, 
__r1
, 
__r2
; \

1208 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

1209 && (
__r0
 = ((
__cÚ¡
 *è(
»jeù
))[0], \

1210 ((
__cÚ¡
 *è(
»jeù
))[0] != '\0') \

1211 ? ((
__r1
 = ((
__cÚ¡
 *è(
»jeù
))[1], \

1212 ((
__cÚ¡
 *è(
»jeù
))[1] == '\0') \

1213 ? 
	`__¡r£p_1c
 (
s
, 
__r0
) \

1214 : ((
__r2
 = ((
__cÚ¡
 *è(
»jeù
))[2], __r2 == '\0') \

1215 ? 
	`__¡r£p_2c
 (
s
, 
__r0
, 
__r1
) \

1216 : (((
__cÚ¡
 *è(
»jeù
))[3] == '\0' \

1217 ? 
	`__¡r£p_3c
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

1218 : 
	`__¡r£p_g
 (
s
, 
»jeù
)))) \

1219 : 
	`__¡r£p_g
 (
s
, 
»jeù
)); })

	)

1222 
__STRING_INLINE
 *
__¡r£p_1c
 (**
__s
, 
__»jeù
);

1223 
__STRING_INLINE
 *

1224 
	$__¡r£p_1c
 (**
__s
, 
__»jeù
)

1226 *
__»tv®
 = *
__s
;

1227 ià(
__»tv®
 !ğ
NULL
 && (*
__s
 = 
	`¡rchr
 (__»tv®, 
__»jeù
)) != NULL)

1228 *(*
__s
)++ = '\0';

1229  
__»tv®
;

1230 
	}
}

1232 
__STRING_INLINE
 *
__¡r£p_2c
 (**
__s
, 
__»jeù1
, 
__»jeù2
);

1233 
__STRING_INLINE
 *

1234 
	$__¡r£p_2c
 (**
__s
, 
__»jeù1
, 
__»jeù2
)

1236 *
__»tv®
 = *
__s
;

1237 ià(
__»tv®
 !ğ
NULL
)

1239 *
__ı
 = 
__»tv®
;

1242 ià(*
__ı
 == '\0')

1244 
__ı
 = 
NULL
;

1247 ià(*
__ı
 =ğ
__»jeù1
 || *__ı =ğ
__»jeù2
)

1249 *
__ı
++ = '\0';

1252 ++
__ı
;

1254 *
__s
 = 
__ı
;

1256  
__»tv®
;

1257 
	}
}

1259 
__STRING_INLINE
 *
__¡r£p_3c
 (**
__s
, 
__»jeù1
, 
__»jeù2
,

1260 
__»jeù3
);

1261 
__STRING_INLINE
 *

1262 
	$__¡r£p_3c
 (**
__s
, 
__»jeù1
, 
__»jeù2
, 
__»jeù3
)

1264 *
__»tv®
 = *
__s
;

1265 ià(
__»tv®
 !ğ
NULL
)

1267 *
__ı
 = 
__»tv®
;

1270 ià(*
__ı
 == '\0')

1272 
__ı
 = 
NULL
;

1275 ià(*
__ı
 =ğ
__»jeù1
 || *__ı =ğ
__»jeù2
 || *__ı =ğ
__»jeù3
)

1277 *
__ı
++ = '\0';

1280 ++
__ı
;

1282 *
__s
 = 
__ı
;

1284  
__»tv®
;

1285 
	}
}

1286 #ifdeà
__USE_BSD


1287 
	#¡r£p
(
s
, 
»jeù
è
	`__¡r£p
 (s,„ejeù)

	)

1294 #ifdeà
__USE_MISC


1296 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rdup
 || !defšed 
_HAVE_STRING_ARCH_¡ºdup


1297 
	#__Ãed_m®loc_ªd_ÿÎoc


	)

1298 
	~<¡dlib.h
>

1301 #iâdeà
_HAVE_STRING_ARCH_¡rdup


1303 *
	$__¡rdup
 (
__cÚ¡
 *
__¡ršg
è
__THROW
 
__©Œibu‹_m®loc__
;

1304 
	#__¡rdup
(
s
) \

1305 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s) \

1306 ? (((
__cÚ¡
 *è(
s
))[0] == '\0' \

1307 ? (*è
	`ÿÎoc
 ((
size_t
) 1, (size_t) 1) \

1308 : ({ 
size_t
 
__Ën
 = 
	`¡¾’
 (
s
) + 1; \

1309 *
__»tv®
 = (*è
	`m®loc
 (
__Ën
); \

1310 ià(
__»tv®
 !ğ
NULL
) \

1311 
__»tv®
 = (*è
	`memıy
 (__»tv®, 
s
, 
__Ën
); \

1312 
__»tv®
; 
	}
})) \

1313 : 
	`__¡rdup
 (
s
)))

	)

1315 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


1316 
	#¡rdup
(
s
è
	`__¡rdup
 (s)

	)

1320 #iâdeà
_HAVE_STRING_ARCH_¡ºdup


1322 *
	$__¡ºdup
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__n
)

1323 
__THROW
 
__©Œibu‹_m®loc__
;

1324 
	#__¡ºdup
(
s
, 
n
) \

1325 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s) \

1326 ? (((
__cÚ¡
 *è(
s
))[0] == '\0' \

1327 ? (*è
	`ÿÎoc
 ((
size_t
) 1, (size_t) 1) \

1328 : ({ 
size_t
 
__Ën
 = 
	`¡¾’
 (
s
) + 1; \

1329 
size_t
 
__n
 = (
n
); \

1330 *
__»tv®
; \

1331 ià(
__n
 < 
__Ën
) \

1332 
__Ën
 = 
__n
 + 1; \

1333 
__»tv®
 = (*è
	`m®loc
 (
__Ën
); \

1334 ià(
__»tv®
 !ğ
NULL
) \

1336 
__»tv®
[
__Ën
 - 1] = '\0'; \

1337 
__»tv®
 = (*è
	`memıy
 (__»tv®, 
s
, \

1338 
__Ën
 - 1); \

1340 
__»tv®
; 
	}
})) \

1341 : 
	`__¡ºdup
 (
s
, 
n
)))

	)

1343 #ifdeà
__USE_GNU


1344 
	#¡ºdup
(
s
, 
n
è
	`__¡ºdup
 (s,‚)

	)

1350 #iâdeà
_FORCE_INLINES


1351 #undeà
__STRING_INLINE


	@/usr/include/bits/string3.h

19 #iâdeà
_STRING_H


23 
__w¬ndeş
 (
__w¬n_mem£t_z”o_Ën
,

26 #iâdeà
__ılu¥lus


30 #undeà
memıy


31 #undeà
memmove


32 #undeà
mem£t


33 #undeà
¡rÿt


34 #undeà
¡rıy


35 #undeà
¡ºÿt


36 #undeà
¡ºıy


37 #ifdeà
__USE_GNU


38 #undeà
mempıy


39 #undeà
¡pıy


41 #ifdeà
__USE_BSD


42 #undeà
bcİy


43 #undeà
bz”o


48 
__ex‹º_®ways_šlše
 *

49 
__NTH
 (
	$memıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

50 
size_t
 
__Ën
))

52  
	`__butš___memıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

53 
	}
}

55 
__ex‹º_®ways_šlše
 *

56 
__NTH
 (
	$memmove
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

57 
size_t
 
__Ën
))

59  
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

60 
	}
}

62 #ifdeà
__USE_GNU


63 
__ex‹º_®ways_šlše
 *

64 
__NTH
 (
	$mempıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

65 
size_t
 
__Ën
))

67  
	`__butš___mempıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

68 
	}
}

77 
__ex‹º_®ways_šlše
 *

78 
__NTH
 (
	$mem£t
 (*
__de¡
, 
__ch
, 
size_t
 
__Ën
))

80 ià(
	`__butš_cÚ¡ªt_p
 (
__Ën
) && __len == 0)

82 
	`__w¬n_mem£t_z”o_Ën
 ();

83  
__de¡
;

85  
	`__butš___mem£t_chk
 (
__de¡
, 
__ch
, 
__Ën
, 
	`__bos0
 (__dest));

86 
	}
}

88 #ifdeà
__USE_BSD


89 
__ex‹º_®ways_šlše
 

90 
__NTH
 (
	$bcİy
 (
__cÚ¡
 *
__»¡riù
 
__¤c
, *__»¡riù 
__de¡
,

91 
size_t
 
__Ën
))

93 (è
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

94 
	}
}

96 
__ex‹º_®ways_šlše
 

97 
__NTH
 (
	$bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

99 (è
	`__butš___mem£t_chk
 (
__de¡
, '\0', 
__Ën
, 
	`__bos0
 (__dest));

100 
	}
}

103 
__ex‹º_®ways_šlše
 *

104 
__NTH
 (
	$¡rıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
))

106  
	`__butš___¡rıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

107 
	}
}

109 #ifdeà
__USE_GNU


110 
__ex‹º_®ways_šlše
 *

111 
__NTH
 (
	$¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
))

113  
	`__butš___¡pıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

114 
	}
}

118 
__ex‹º_®ways_šlše
 *

119 
__NTH
 (
	$¡ºıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

120 
size_t
 
__Ën
))

122  
	`__butš___¡ºıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

123 
	}
}

126 *
	$__¡²ıy_chk
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
,

127 
size_t
 
__de¡Ën
è
__THROW
;

128 *
	`__REDIRECT_NTH
 (
__¡²ıy_®Ÿs
, (*
__de¡
,

129 
__cÚ¡
 *
__¤c
,

130 
size_t
 
__n
), 
¡²ıy
);

132 
__ex‹º_®ways_šlše
 *

133 
	`__NTH
 (
	$¡²ıy
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
))

135 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1

136 && (!
	`__butš_cÚ¡ªt_p
 (
__n
è|| __À<ğ
	`__bos
 (
__de¡
)))

137  
	`__¡²ıy_chk
 (
__de¡
, 
__¤c
, 
__n
, 
	`__bos
 (__dest));

138  
	`__¡²ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

139 
	}
}

142 
__ex‹º_®ways_šlše
 *

143 
__NTH
 (
	$¡rÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
))

145  
	`__butš___¡rÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

146 
	}
}

149 
__ex‹º_®ways_šlše
 *

150 
__NTH
 (
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

151 
size_t
 
__Ën
))

153  
	`__butš___¡ºÿt_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

154 
	}
}

	@/usr/include/bits/sys_errlist.h

20 #iâdeà
_STDIO_H


26 #ifdeà 
__USE_BSD


27 
sys_Ã¼
;

28 
__cÚ¡
 *__cÚ¡ 
sys_”¾i¡
[];

30 #ifdeà 
__USE_GNU


31 
_sys_Ã¼
;

32 
__cÚ¡
 *__cÚ¡ 
_sys_”¾i¡
[];

	@/usr/include/bits/syscall.h

3 #iâdeà
_SYSCALL_H


7 
	~<b™s/wÜdsize.h
>

9 
	#SYS__sysùl
 
__NR__sysùl


	)

10 
	#SYS_acûss
 
__NR_acûss


	)

11 
	#SYS_acù
 
__NR_acù


	)

12 
	#SYS_add_key
 
__NR_add_key


	)

13 
	#SYS_adjtimex
 
__NR_adjtimex


	)

14 
	#SYS_afs_sysÿÎ
 
__NR_afs_sysÿÎ


	)

15 
	#SYS_®¬m
 
__NR_®¬m


	)

16 
	#SYS_brk
 
__NR_brk


	)

17 
	#SYS_ÿpg‘
 
__NR_ÿpg‘


	)

18 
	#SYS_ÿp£t
 
__NR_ÿp£t


	)

19 
	#SYS_chdœ
 
__NR_chdœ


	)

20 
	#SYS_chmod
 
__NR_chmod


	)

21 
	#SYS_chown
 
__NR_chown


	)

22 
	#SYS_chroÙ
 
__NR_chroÙ


	)

23 
	#SYS_şock_g‘»s
 
__NR_şock_g‘»s


	)

24 
	#SYS_şock_g‘time
 
__NR_şock_g‘time


	)

25 
	#SYS_şock_Çno¦“p
 
__NR_şock_Çno¦“p


	)

26 
	#SYS_şock_£‰ime
 
__NR_şock_£‰ime


	)

27 
	#SYS_şÚe
 
__NR_şÚe


	)

28 
	#SYS_şo£
 
__NR_şo£


	)

29 
	#SYS_ü—t
 
__NR_ü—t


	)

30 
	#SYS_ü—‹_moduË
 
__NR_ü—‹_moduË


	)

31 
	#SYS_d–‘e_moduË
 
__NR_d–‘e_moduË


	)

32 
	#SYS_dup
 
__NR_dup


	)

33 
	#SYS_dup2
 
__NR_dup2


	)

34 
	#SYS_dup3
 
__NR_dup3


	)

35 
	#SYS_•Şl_ü—‹
 
__NR_•Şl_ü—‹


	)

36 
	#SYS_•Şl_ü—‹1
 
__NR_•Şl_ü—‹1


	)

37 
	#SYS_•Şl_ùl
 
__NR_•Şl_ùl


	)

38 
	#SYS_•Şl_pwa™
 
__NR_•Şl_pwa™


	)

39 
	#SYS_•Şl_wa™
 
__NR_•Şl_wa™


	)

40 
	#SYS_ev’tfd
 
__NR_ev’tfd


	)

41 
	#SYS_ev’tfd2
 
__NR_ev’tfd2


	)

42 
	#SYS_execve
 
__NR_execve


	)

43 
	#SYS_ex™
 
__NR_ex™


	)

44 
	#SYS_ex™_group
 
__NR_ex™_group


	)

45 
	#SYS_çcûs§t
 
__NR_çcûs§t


	)

46 
	#SYS_çdvi£64
 
__NR_çdvi£64


	)

47 
	#SYS_çÎoÿ‹
 
__NR_çÎoÿ‹


	)

48 
	#SYS_fchdœ
 
__NR_fchdœ


	)

49 
	#SYS_fchmod
 
__NR_fchmod


	)

50 
	#SYS_fchmod©
 
__NR_fchmod©


	)

51 
	#SYS_fchown
 
__NR_fchown


	)

52 
	#SYS_fchowÇt
 
__NR_fchowÇt


	)

53 
	#SYS_fú
 
__NR_fú


	)

54 
	#SYS_fd©async
 
__NR_fd©async


	)

55 
	#SYS_fg‘x©Œ
 
__NR_fg‘x©Œ


	)

56 
	#SYS_æi¡x©Œ
 
__NR_æi¡x©Œ


	)

57 
	#SYS_æock
 
__NR_æock


	)

58 
	#SYS_fÜk
 
__NR_fÜk


	)

59 
	#SYS_äemovex©Œ
 
__NR_äemovex©Œ


	)

60 
	#SYS_f£tx©Œ
 
__NR_f£tx©Œ


	)

61 
	#SYS_f¡©
 
__NR_f¡©


	)

62 
	#SYS_f¡©fs
 
__NR_f¡©fs


	)

63 
	#SYS_fsync
 
__NR_fsync


	)

64 
	#SYS_árunÿ‹
 
__NR_árunÿ‹


	)

65 
	#SYS_fu‹x
 
__NR_fu‹x


	)

66 
	#SYS_futime§t
 
__NR_futime§t


	)

67 
	#SYS_g‘_k”Ãl_syms
 
__NR_g‘_k”Ãl_syms


	)

68 
	#SYS_g‘_mempŞicy
 
__NR_g‘_mempŞicy


	)

69 
	#SYS_g‘_robu¡_li¡
 
__NR_g‘_robu¡_li¡


	)

70 
	#SYS_g‘_th»ad_¬—
 
__NR_g‘_th»ad_¬—


	)

71 
	#SYS_g‘cwd
 
__NR_g‘cwd


	)

72 
	#SYS_g‘d’ts
 
__NR_g‘d’ts


	)

73 
	#SYS_g‘d’ts64
 
__NR_g‘d’ts64


	)

74 
	#SYS_g‘egid
 
__NR_g‘egid


	)

75 
	#SYS_g‘euid
 
__NR_g‘euid


	)

76 
	#SYS_g‘gid
 
__NR_g‘gid


	)

77 
	#SYS_g‘groups
 
__NR_g‘groups


	)

78 
	#SYS_g‘™im”
 
__NR_g‘™im”


	)

79 
	#SYS_g‘pgid
 
__NR_g‘pgid


	)

80 
	#SYS_g‘pg½
 
__NR_g‘pg½


	)

81 
	#SYS_g‘pid
 
__NR_g‘pid


	)

82 
	#SYS_g‘pmsg
 
__NR_g‘pmsg


	)

83 
	#SYS_g‘µid
 
__NR_g‘µid


	)

84 
	#SYS_g‘´iÜ™y
 
__NR_g‘´iÜ™y


	)

85 
	#SYS_g‘»sgid
 
__NR_g‘»sgid


	)

86 
	#SYS_g‘»suid
 
__NR_g‘»suid


	)

87 
	#SYS_g‘¾im™
 
__NR_g‘¾im™


	)

88 
	#SYS_g‘ru§ge
 
__NR_g‘ru§ge


	)

89 
	#SYS_g‘sid
 
__NR_g‘sid


	)

90 
	#SYS_g‘tid
 
__NR_g‘tid


	)

91 
	#SYS_g‘timeofday
 
__NR_g‘timeofday


	)

92 
	#SYS_g‘uid
 
__NR_g‘uid


	)

93 
	#SYS_g‘x©Œ
 
__NR_g‘x©Œ


	)

94 
	#SYS_š™_moduË
 
__NR_š™_moduË


	)

95 
	#SYS_šÙify_add_w©ch
 
__NR_šÙify_add_w©ch


	)

96 
	#SYS_šÙify_š™
 
__NR_šÙify_š™


	)

97 
	#SYS_šÙify_š™1
 
__NR_šÙify_š™1


	)

98 
	#SYS_šÙify_rm_w©ch
 
__NR_šÙify_rm_w©ch


	)

99 
	#SYS_io_ÿnûl
 
__NR_io_ÿnûl


	)

100 
	#SYS_io_de¡roy
 
__NR_io_de¡roy


	)

101 
	#SYS_io_g‘ev’ts
 
__NR_io_g‘ev’ts


	)

102 
	#SYS_io_£tup
 
__NR_io_£tup


	)

103 
	#SYS_io_subm™
 
__NR_io_subm™


	)

104 
	#SYS_ioùl
 
__NR_ioùl


	)

105 
	#SYS_iİ”m
 
__NR_iİ”m


	)

106 
	#SYS_iİl
 
__NR_iİl


	)

107 
	#SYS_iİrio_g‘
 
__NR_iİrio_g‘


	)

108 
	#SYS_iİrio_£t
 
__NR_iİrio_£t


	)

109 
	#SYS_kexec_lßd
 
__NR_kexec_lßd


	)

110 
	#SYS_keyùl
 
__NR_keyùl


	)

111 
	#SYS_kl
 
__NR_kl


	)

112 
	#SYS_lchown
 
__NR_lchown


	)

113 
	#SYS_lg‘x©Œ
 
__NR_lg‘x©Œ


	)

114 
	#SYS_lšk
 
__NR_lšk


	)

115 
	#SYS_lšk©
 
__NR_lšk©


	)

116 
	#SYS_li¡x©Œ
 
__NR_li¡x©Œ


	)

117 
	#SYS_Îi¡x©Œ
 
__NR_Îi¡x©Œ


	)

118 
	#SYS_lookup_dcook›
 
__NR_lookup_dcook›


	)

119 
	#SYS_Ìemovex©Œ
 
__NR_Ìemovex©Œ


	)

120 
	#SYS_l£ek
 
__NR_l£ek


	)

121 
	#SYS_l£tx©Œ
 
__NR_l£tx©Œ


	)

122 
	#SYS_l¡©
 
__NR_l¡©


	)

123 
	#SYS_madvi£
 
__NR_madvi£


	)

124 
	#SYS_mbšd
 
__NR_mbšd


	)

125 
	#SYS_mig¿‹_·ges
 
__NR_mig¿‹_·ges


	)

126 
	#SYS_mšcÜe
 
__NR_mšcÜe


	)

127 
	#SYS_mkdœ
 
__NR_mkdœ


	)

128 
	#SYS_mkdœ©
 
__NR_mkdœ©


	)

129 
	#SYS_mknod
 
__NR_mknod


	)

130 
	#SYS_mknod©
 
__NR_mknod©


	)

131 
	#SYS_mlock
 
__NR_mlock


	)

132 
	#SYS_mlock®l
 
__NR_mlock®l


	)

133 
	#SYS_mm­
 
__NR_mm­


	)

134 
	#SYS_modify_ldt
 
__NR_modify_ldt


	)

135 
	#SYS_mouÁ
 
__NR_mouÁ


	)

136 
	#SYS_move_·ges
 
__NR_move_·ges


	)

137 
	#SYS_m´Ùeù
 
__NR_m´Ùeù


	)

138 
	#SYS_mq_g‘£‰r
 
__NR_mq_g‘£‰r


	)

139 
	#SYS_mq_nÙify
 
__NR_mq_nÙify


	)

140 
	#SYS_mq_İ’
 
__NR_mq_İ’


	)

141 
	#SYS_mq_timed»ûive
 
__NR_mq_timed»ûive


	)

142 
	#SYS_mq_timed£nd
 
__NR_mq_timed£nd


	)

143 
	#SYS_mq_uÆšk
 
__NR_mq_uÆšk


	)

144 
	#SYS_m»m­
 
__NR_m»m­


	)

145 
	#SYS_msync
 
__NR_msync


	)

146 
	#SYS_muÆock
 
__NR_muÆock


	)

147 
	#SYS_muÆock®l
 
__NR_muÆock®l


	)

148 
	#SYS_munm­
 
__NR_munm­


	)

149 
	#SYS_Çno¦“p
 
__NR_Çno¦“p


	)

150 
	#SYS_nfs£rvùl
 
__NR_nfs£rvùl


	)

151 
	#SYS_İ’
 
__NR_İ’


	)

152 
	#SYS_İ’©
 
__NR_İ’©


	)

153 
	#SYS_·u£
 
__NR_·u£


	)

154 
	#SYS_³rsÚ®™y
 
__NR_³rsÚ®™y


	)

155 
	#SYS_pe
 
__NR_pe


	)

156 
	#SYS_pe2
 
__NR_pe2


	)

157 
	#SYS_pivÙ_roÙ
 
__NR_pivÙ_roÙ


	)

158 
	#SYS_pŞl
 
__NR_pŞl


	)

159 
	#SYS_µŞl
 
__NR_µŞl


	)

160 
	#SYS_´ùl
 
__NR_´ùl


	)

161 
	#SYS_´—d64
 
__NR_´—d64


	)

162 
	#SYS_p£Ëù6
 
__NR_p£Ëù6


	)

163 
	#SYS_±¿û
 
__NR_±¿û


	)

164 
	#SYS_pumsg
 
__NR_pumsg


	)

165 
	#SYS_pwr™e64
 
__NR_pwr™e64


	)

166 
	#SYS_qu”y_moduË
 
__NR_qu”y_moduË


	)

167 
	#SYS_quÙaùl
 
__NR_quÙaùl


	)

168 
	#SYS_»ad
 
__NR_»ad


	)

169 
	#SYS_»adah—d
 
__NR_»adah—d


	)

170 
	#SYS_»adlšk
 
__NR_»adlšk


	)

171 
	#SYS_»adlšk©
 
__NR_»adlšk©


	)

172 
	#SYS_»adv
 
__NR_»adv


	)

173 
	#SYS_»boÙ
 
__NR_»boÙ


	)

174 
	#SYS_»m­_fe_·ges
 
__NR_»m­_fe_·ges


	)

175 
	#SYS_»movex©Œ
 
__NR_»movex©Œ


	)

176 
	#SYS_»Çme
 
__NR_»Çme


	)

177 
	#SYS_»Çm—t
 
__NR_»Çm—t


	)

178 
	#SYS_»que¡_key
 
__NR_»que¡_key


	)

179 
	#SYS_»¡¬t_sysÿÎ
 
__NR_»¡¬t_sysÿÎ


	)

180 
	#SYS_rmdœ
 
__NR_rmdœ


	)

181 
	#SYS_¹_sigaùiÚ
 
__NR_¹_sigaùiÚ


	)

182 
	#SYS_¹_sig³ndšg
 
__NR_¹_sig³ndšg


	)

183 
	#SYS_¹_sig´ocmask
 
__NR_¹_sig´ocmask


	)

184 
	#SYS_¹_sigqueuešfo
 
__NR_¹_sigqueuešfo


	)

185 
	#SYS_¹_sig»tuº
 
__NR_¹_sig»tuº


	)

186 
	#SYS_¹_sigsu¥’d
 
__NR_¹_sigsu¥’d


	)

187 
	#SYS_¹_sigtimedwa™
 
__NR_¹_sigtimedwa™


	)

188 
	#SYS_sched_g‘_´iÜ™y_max
 
__NR_sched_g‘_´iÜ™y_max


	)

189 
	#SYS_sched_g‘_´iÜ™y_mš
 
__NR_sched_g‘_´iÜ™y_mš


	)

190 
	#SYS_sched_g‘affš™y
 
__NR_sched_g‘affš™y


	)

191 
	#SYS_sched_g‘·¿m
 
__NR_sched_g‘·¿m


	)

192 
	#SYS_sched_g‘scheduËr
 
__NR_sched_g‘scheduËr


	)

193 
	#SYS_sched_¼_g‘_š‹rv®
 
__NR_sched_¼_g‘_š‹rv®


	)

194 
	#SYS_sched_£ffš™y
 
__NR_sched_£ffš™y


	)

195 
	#SYS_sched_£¬am
 
__NR_sched_£¬am


	)

196 
	#SYS_sched_£tscheduËr
 
__NR_sched_£tscheduËr


	)

197 
	#SYS_sched_y›ld
 
__NR_sched_y›ld


	)

198 
	#SYS_£Ëù
 
__NR_£Ëù


	)

199 
	#SYS_£ndfe
 
__NR_£ndfe


	)

200 
	#SYS_£t_mempŞicy
 
__NR_£t_mempŞicy


	)

201 
	#SYS_£t_robu¡_li¡
 
__NR_£t_robu¡_li¡


	)

202 
	#SYS_£t_th»ad_¬—
 
__NR_£t_th»ad_¬—


	)

203 
	#SYS_£t_tid_add»ss
 
__NR_£t_tid_add»ss


	)

204 
	#SYS_£tdomašÇme
 
__NR_£tdomašÇme


	)

205 
	#SYS_£tfsgid
 
__NR_£tfsgid


	)

206 
	#SYS_£tfsuid
 
__NR_£tfsuid


	)

207 
	#SYS_£tgid
 
__NR_£tgid


	)

208 
	#SYS_£tgroups
 
__NR_£tgroups


	)

209 
	#SYS_£tho¡Çme
 
__NR_£tho¡Çme


	)

210 
	#SYS_£t™im”
 
__NR_£t™im”


	)

211 
	#SYS_£gid
 
__NR_£gid


	)

212 
	#SYS_£riÜ™y
 
__NR_£riÜ™y


	)

213 
	#SYS_£Œegid
 
__NR_£Œegid


	)

214 
	#SYS_£Œesgid
 
__NR_£Œesgid


	)

215 
	#SYS_£Œesuid
 
__NR_£Œesuid


	)

216 
	#SYS_£Œeuid
 
__NR_£Œeuid


	)

217 
	#SYS_£Œlim™
 
__NR_£Œlim™


	)

218 
	#SYS_£tsid
 
__NR_£tsid


	)

219 
	#SYS_£‰imeofday
 
__NR_£‰imeofday


	)

220 
	#SYS_£tuid
 
__NR_£tuid


	)

221 
	#SYS_£tx©Œ
 
__NR_£tx©Œ


	)

222 
	#SYS_sig®t¡ack
 
__NR_sig®t¡ack


	)

223 
	#SYS_sigÇlfd
 
__NR_sigÇlfd


	)

224 
	#SYS_sigÇlfd4
 
__NR_sigÇlfd4


	)

225 
	#SYS_¥liû
 
__NR_¥liû


	)

226 
	#SYS_¡©
 
__NR_¡©


	)

227 
	#SYS_¡©fs
 
__NR_¡©fs


	)

228 
	#SYS_sw­off
 
__NR_sw­off


	)

229 
	#SYS_sw­Ú
 
__NR_sw­Ú


	)

230 
	#SYS_symlšk
 
__NR_symlšk


	)

231 
	#SYS_symlšk©
 
__NR_symlšk©


	)

232 
	#SYS_sync
 
__NR_sync


	)

233 
	#SYS_sync_fe_¿nge
 
__NR_sync_fe_¿nge


	)

234 
	#SYS_sysfs
 
__NR_sysfs


	)

235 
	#SYS_sysšfo
 
__NR_sysšfo


	)

236 
	#SYS_sy¦og
 
__NR_sy¦og


	)

237 
	#SYS_‹e
 
__NR_‹e


	)

238 
	#SYS_tgkl
 
__NR_tgkl


	)

239 
	#SYS_time
 
__NR_time


	)

240 
	#SYS_tim”_ü—‹
 
__NR_tim”_ü—‹


	)

241 
	#SYS_tim”_d–‘e
 
__NR_tim”_d–‘e


	)

242 
	#SYS_tim”_g‘ov”run
 
__NR_tim”_g‘ov”run


	)

243 
	#SYS_tim”_g‘time
 
__NR_tim”_g‘time


	)

244 
	#SYS_tim”_£‰ime
 
__NR_tim”_£‰ime


	)

245 
	#SYS_tim”fd_ü—‹
 
__NR_tim”fd_ü—‹


	)

246 
	#SYS_tim”fd_g‘time
 
__NR_tim”fd_g‘time


	)

247 
	#SYS_tim”fd_£‰ime
 
__NR_tim”fd_£‰ime


	)

248 
	#SYS_times
 
__NR_times


	)

249 
	#SYS_tkl
 
__NR_tkl


	)

250 
	#SYS_Œunÿ‹
 
__NR_Œunÿ‹


	)

251 
	#SYS_umask
 
__NR_umask


	)

252 
	#SYS_umouÁ2
 
__NR_umouÁ2


	)

253 
	#SYS_uÇme
 
__NR_uÇme


	)

254 
	#SYS_uÆšk
 
__NR_uÆšk


	)

255 
	#SYS_uÆšk©
 
__NR_uÆšk©


	)

256 
	#SYS_unsh¬e
 
__NR_unsh¬e


	)

257 
	#SYS_u£lib
 
__NR_u£lib


	)

258 
	#SYS_u¡©
 
__NR_u¡©


	)

259 
	#SYS_utime
 
__NR_utime


	)

260 
	#SYS_utim’§t
 
__NR_utim’§t


	)

261 
	#SYS_utimes
 
__NR_utimes


	)

262 
	#SYS_vfÜk
 
__NR_vfÜk


	)

263 
	#SYS_vhªgup
 
__NR_vhªgup


	)

264 
	#SYS_vm¥liû
 
__NR_vm¥liû


	)

265 
	#SYS_v£rv”
 
__NR_v£rv”


	)

266 
	#SYS_wa™4
 
__NR_wa™4


	)

267 
	#SYS_wa™id
 
__NR_wa™id


	)

268 
	#SYS_wr™e
 
__NR_wr™e


	)

269 
	#SYS_wr™ev
 
__NR_wr™ev


	)

270 #ià
__WORDSIZE
 == 64

271 
	#SYS_acû±
 
__NR_acû±


	)

272 
	#SYS_acû±4
 
__NR_acû±4


	)

273 
	#SYS_¬ch_´ùl
 
__NR_¬ch_´ùl


	)

274 
	#SYS_bšd
 
__NR_bšd


	)

275 
	#SYS_cÚÃù
 
__NR_cÚÃù


	)

276 
	#SYS_•Şl_ùl_Şd
 
__NR_•Şl_ùl_Şd


	)

277 
	#SYS_•Şl_wa™_Şd
 
__NR_•Şl_wa™_Şd


	)

278 
	#SYS_g‘³”Çme
 
__NR_g‘³”Çme


	)

279 
	#SYS_g‘sockÇme
 
__NR_g‘sockÇme


	)

280 
	#SYS_g‘sockİt
 
__NR_g‘sockİt


	)

281 
	#SYS_li¡’
 
__NR_li¡’


	)

282 
	#SYS_msgùl
 
__NR_msgùl


	)

283 
	#SYS_msgg‘
 
__NR_msgg‘


	)

284 
	#SYS_msgrcv
 
__NR_msgrcv


	)

285 
	#SYS_msg¢d
 
__NR_msg¢d


	)

286 
	#SYS_Ãwf¡©©
 
__NR_Ãwf¡©©


	)

287 
	#SYS_»cväom
 
__NR_»cväom


	)

288 
	#SYS_»cvmsg
 
__NR_»cvmsg


	)

289 
	#SYS_£cur™y
 
__NR_£cur™y


	)

290 
	#SYS_£mùl
 
__NR_£mùl


	)

291 
	#SYS_£mg‘
 
__NR_£mg‘


	)

292 
	#SYS_£mİ
 
__NR_£mİ


	)

293 
	#SYS_£mtimedİ
 
__NR_£mtimedİ


	)

294 
	#SYS_£ndmsg
 
__NR_£ndmsg


	)

295 
	#SYS_£ndto
 
__NR_£ndto


	)

296 
	#SYS_£tsockİt
 
__NR_£tsockİt


	)

297 
	#SYS_shm©
 
__NR_shm©


	)

298 
	#SYS_shmùl
 
__NR_shmùl


	)

299 
	#SYS_shmdt
 
__NR_shmdt


	)

300 
	#SYS_shmg‘
 
__NR_shmg‘


	)

301 
	#SYS_shutdown
 
__NR_shutdown


	)

302 
	#SYS_sock‘
 
__NR_sock‘


	)

303 
	#SYS_sock‘·œ
 
__NR_sock‘·œ


	)

304 
	#SYS_tuxÿÎ
 
__NR_tuxÿÎ


	)

306 
	#SYS__Î£ek
 
__NR__Î£ek


	)

307 
	#SYS__Ãw£Ëù
 
__NR__Ãw£Ëù


	)

308 
	#SYS_bdæush
 
__NR_bdæush


	)

309 
	#SYS_b»ak
 
__NR_b»ak


	)

310 
	#SYS_chown32
 
__NR_chown32


	)

311 
	#SYS_çdvi£64_64
 
__NR_çdvi£64_64


	)

312 
	#SYS_fchown32
 
__NR_fchown32


	)

313 
	#SYS_fú64
 
__NR_fú64


	)

314 
	#SYS_f¡©64
 
__NR_f¡©64


	)

315 
	#SYS_f¡©©64
 
__NR_f¡©©64


	)

316 
	#SYS_f¡©fs64
 
__NR_f¡©fs64


	)

317 
	#SYS_áime
 
__NR_áime


	)

318 
	#SYS_árunÿ‹64
 
__NR_árunÿ‹64


	)

319 
	#SYS_g‘ıu
 
__NR_g‘ıu


	)

320 
	#SYS_g‘egid32
 
__NR_g‘egid32


	)

321 
	#SYS_g‘euid32
 
__NR_g‘euid32


	)

322 
	#SYS_g‘gid32
 
__NR_g‘gid32


	)

323 
	#SYS_g‘groups32
 
__NR_g‘groups32


	)

324 
	#SYS_g‘»sgid32
 
__NR_g‘»sgid32


	)

325 
	#SYS_g‘»suid32
 
__NR_g‘»suid32


	)

326 
	#SYS_g‘uid32
 
__NR_g‘uid32


	)

327 
	#SYS_g‰y
 
__NR_g‰y


	)

328 
	#SYS_idË
 
__NR_idË


	)

329 
	#SYS_c
 
__NR_c


	)

330 
	#SYS_lchown32
 
__NR_lchown32


	)

331 
	#SYS_lock
 
__NR_lock


	)

332 
	#SYS_l¡©64
 
__NR_l¡©64


	)

333 
	#SYS_madvi£1
 
__NR_madvi£1


	)

334 
	#SYS_mm­2
 
__NR_mm­2


	)

335 
	#SYS_mpx
 
__NR_mpx


	)

336 
	#SYS_niû
 
__NR_niû


	)

337 
	#SYS_Şdf¡©
 
__NR_Şdf¡©


	)

338 
	#SYS_Şdl¡©
 
__NR_Şdl¡©


	)

339 
	#SYS_ŞdŞduÇme
 
__NR_ŞdŞduÇme


	)

340 
	#SYS_Şd¡©
 
__NR_Şd¡©


	)

341 
	#SYS_ŞduÇme
 
__NR_ŞduÇme


	)

342 
	#SYS_´of
 
__NR_´of


	)

343 
	#SYS_´of
 
__NR_´of


	)

344 
	#SYS_»addœ
 
__NR_»addœ


	)

345 
	#SYS_£ndfe64
 
__NR_£ndfe64


	)

346 
	#SYS_£tfsgid32
 
__NR_£tfsgid32


	)

347 
	#SYS_£tfsuid32
 
__NR_£tfsuid32


	)

348 
	#SYS_£tgid32
 
__NR_£tgid32


	)

349 
	#SYS_£tgroups32
 
__NR_£tgroups32


	)

350 
	#SYS_£Œegid32
 
__NR_£Œegid32


	)

351 
	#SYS_£Œesgid32
 
__NR_£Œesgid32


	)

352 
	#SYS_£Œesuid32
 
__NR_£Œesuid32


	)

353 
	#SYS_£Œeuid32
 
__NR_£Œeuid32


	)

354 
	#SYS_£tuid32
 
__NR_£tuid32


	)

355 
	#SYS_sg‘mask
 
__NR_sg‘mask


	)

356 
	#SYS_sigaùiÚ
 
__NR_sigaùiÚ


	)

357 
	#SYS_sigÇl
 
__NR_sigÇl


	)

358 
	#SYS_sig³ndšg
 
__NR_sig³ndšg


	)

359 
	#SYS_sig´ocmask
 
__NR_sig´ocmask


	)

360 
	#SYS_sig»tuº
 
__NR_sig»tuº


	)

361 
	#SYS_sigsu¥’d
 
__NR_sigsu¥’d


	)

362 
	#SYS_sock‘ÿÎ
 
__NR_sock‘ÿÎ


	)

363 
	#SYS_s£tmask
 
__NR_s£tmask


	)

364 
	#SYS_¡©64
 
__NR_¡©64


	)

365 
	#SYS_¡©fs64
 
__NR_¡©fs64


	)

366 
	#SYS_¡ime
 
__NR_¡ime


	)

367 
	#SYS_¡ty
 
__NR_¡ty


	)

368 
	#SYS_Œunÿ‹64
 
__NR_Œunÿ‹64


	)

369 
	#SYS_ug‘¾im™
 
__NR_ug‘¾im™


	)

370 
	#SYS_ulim™
 
__NR_ulim™


	)

371 
	#SYS_umouÁ
 
__NR_umouÁ


	)

372 
	#SYS_vm86
 
__NR_vm86


	)

373 
	#SYS_vm86Şd
 
__NR_vm86Şd


	)

374 
	#SYS_wa™pid
 
__NR_wa™pid


	)

	@/usr/include/bits/time.h

24 #iâdeà
__Ãed_timev®


25 #iâdeà
_BITS_TIME_H


26 
	#_BITS_TIME_H
 1

	)

34 
	#CLOCKS_PER_SEC
 1000000l

	)

36 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


39 
	~<b™s/ty³s.h
>

40 
__syscÚf
 ();

41 
	#CLK_TCK
 ((
__şock_t
è
	`__syscÚf
 (2)è

	)

44 #ifdeà
__USE_POSIX199309


46 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

50 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

52 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

55 
	#TIMER_ABSTIME
 1

	)

61 #ifdeà
__Ãed_timev®


62 #undeà
__Ãed_timev®


63 #iâdeà
_STRUCT_TIMEVAL


64 
	#_STRUCT_TIMEVAL
 1

	)

65 
	~<b™s/ty³s.h
>

69 
	stimev®


71 
__time_t
 
	mtv_£c
;

72 
__su£cÚds_t
 
	mtv_u£c
;

	@/usr/include/bits/types.h

24 #iâdef 
_BITS_TYPES_H


25 
	#_BITS_TYPES_H
 1

	)

27 
	~<ã©u»s.h
>

28 
	~<b™s/wÜdsize.h
>

31 
	t__u_ch¬
;

32 
	t__u_shÜt
;

33 
	t__u_št
;

34 
	t__u_lÚg
;

37 sigÃd 
	t__št8_t
;

38 
	t__ušt8_t
;

39 sigÃd 
	t__št16_t
;

40 
	t__ušt16_t
;

41 sigÃd 
	t__št32_t
;

42 
	t__ušt32_t
;

43 #ià
__WORDSIZE
 == 64

44 sigÃd 
	t__št64_t
;

45 
	t__ušt64_t
;

46 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


47 
__ex‹nsiÚ__
 sigÃd 
	t__št64_t
;

48 
__ex‹nsiÚ__
 
	t__ušt64_t
;

52 #ià
__WORDSIZE
 == 64

53 
	t__quad_t
;

54 
	t__u_quad_t
;

55 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


56 
__ex‹nsiÚ__
 
	t__quad_t
;

57 
__ex‹nsiÚ__
 
	t__u_quad_t
;

61 
	m__v®
[2];

62 } 
	t__quad_t
;

65 
__u_lÚg
 
	m__v®
[2];

66 } 
	t__u_quad_t
;

99 
	#__S16_TYPE
 

	)

100 
	#__U16_TYPE
 

	)

101 
	#__S32_TYPE
 

	)

102 
	#__U32_TYPE
 

	)

103 
	#__SLONGWORD_TYPE
 

	)

104 
	#__ULONGWORD_TYPE
 

	)

105 #ià
__WORDSIZE
 == 32

106 
	#__SQUAD_TYPE
 
__quad_t


	)

107 
	#__UQUAD_TYPE
 
__u_quad_t


	)

108 
	#__SWORD_TYPE
 

	)

109 
	#__UWORD_TYPE
 

	)

110 
	#__SLONG32_TYPE
 

	)

111 
	#__ULONG32_TYPE
 

	)

112 
	#__S64_TYPE
 
__quad_t


	)

113 
	#__U64_TYPE
 
__u_quad_t


	)

116 
	#__STD_TYPE
 
__ex‹nsiÚ__
 

	)

117 #–ià
__WORDSIZE
 == 64

118 
	t__SQUAD_TYPE
 

	)

119 
	t__UQUAD_TYPE
 

	)

120 
	t__SWORD_TYPE
 

	)

121 
	t__UWORD_TYPE
 

	)

122 
	t__SLONG32_TYPE
 

	)

123 
	t__ULONG32_TYPE
 

	)

124 
	t__S64_TYPE
 

	)

125 
	t__U64_TYPE
 

	)

127 
	t__STD_TYPE
 

	)

131 
	~<b™s/ty³sizes.h
>

134 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

135 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

136 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

137 
__STD_TYPE
 
__INO_T_TYPE
 
	g__šo_t
;

138 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__šo64_t
;

139 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

140 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__Æšk_t
;

141 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

142 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

143 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

144 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

145 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__şock_t
;

146 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__¾im_t
;

147 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__¾im64_t
;

148 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

149 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

150 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£cÚds_t
;

151 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£cÚds_t
;

153 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

154 
__STD_TYPE
 
__SWBLK_T_TYPE
 
	g__swblk_t
;

155 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

158 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__şockid_t
;

161 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__tim”_t
;

164 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

169 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blkút_t
;

170 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blkút64_t
;

173 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblkút_t
;

174 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblkút64_t
;

177 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfút_t
;

178 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfút64_t
;

180 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__off64_t
 
	t__loff_t
;

185 
__quad_t
 *
	t__qaddr_t
;

186 *
	t__ÿddr_t
;

189 
__STD_TYPE
 
__SWORD_TYPE
 
	g__šŒ_t
;

192 
__STD_TYPE
 
__U32_TYPE
 
	g__sockËn_t
;

195 #undeà
__STD_TYPE


	@/usr/include/bits/unistd.h

20 #iâdeà
_UNISTD_H


24 
ssize_t
 
	$__»ad_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

25 
size_t
 
__buæ’
è
__wur
;

26 
ssize_t
 
	`__REDIRECT
 (
__»ad_®Ÿs
, (
__fd
, *
__buf
,

27 
size_t
 
__nby‹s
), 
»ad
è
__wur
;

28 
ssize_t
 
	`__REDIRECT
 (
__»ad_chk_w¬n
,

29 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

30 
size_t
 
__buæ’
), 
__»ad_chk
)

31 
__wur
 
	`__w¬Ç‰r
 ("read called with bigger†engthhan size of "

34 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


35 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
)

37 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

39 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

40  
	`__»ad_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

42 ià(
__nby‹s
 > 
	`__bos0
 (
__buf
))

43  
	`__»ad_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

45  
	`__»ad_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
);

46 
	}
}

48 #ifdeà
__USE_UNIX98


49 
ssize_t
 
	$__´—d_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

50 
__off_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

51 
ssize_t
 
	$__´—d64_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

52 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

53 
ssize_t
 
	`__REDIRECT
 (
__´—d_®Ÿs
,

54 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

55 
__off_t
 
__off£t
), 
´—d
è
__wur
;

56 
ssize_t
 
	`__REDIRECT
 (
__´—d64_®Ÿs
,

57 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

58 
__off64_t
 
__off£t
), 
´—d64
è
__wur
;

59 
ssize_t
 
	`__REDIRECT
 (
__´—d_chk_w¬n
,

60 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

61 
__off_t
 
__off£t
, 
size_t
 
__bufsize
), 
__´—d_chk
)

62 
__wur
 
	`__w¬Ç‰r
 ("pread called with bigger†engthhan size of "

64 
ssize_t
 
	`__REDIRECT
 (
__´—d64_chk_w¬n
,

65 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

66 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
),

67 
__´—d64_chk
)

68 
__wur
 
	`__w¬Ç‰r
 ("pread64 called with bigger†engthhan size of "

71 #iâdeà
__USE_FILE_OFFSET64


72 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


73 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off_t
 
__off£t
)

75 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

77 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

78  
	`__´—d_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

80 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

81  
	`__´—d_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

82 
	`__bos0
 (
__buf
));

84  
	`__´—d_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

85 
	}
}

87 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


88 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

90 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

92 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

93  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

95 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

96  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

97 
	`__bos0
 (
__buf
));

100  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

101 
	}
}

104 #ifdeà
__USE_LARGEFILE64


105 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


106 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

108 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

110 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

111  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

113 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

114  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

115 
	`__bos0
 (
__buf
));

118  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

119 
	}
}

123 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


124 
ssize_t
 
	$__»adlšk_chk
 (
__cÚ¡
 *
__»¡riù
 
__·th
,

125 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

126 
size_t
 
__buæ’
)

127 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

128 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_®Ÿs
,

129 (
__cÚ¡
 *
__»¡riù
 
__·th
,

130 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
), 
»adlšk
)

131 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

132 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_chk_w¬n
,

133 (
__cÚ¡
 *
__»¡riù
 
__·th
,

134 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

135 
size_t
 
__buæ’
), 
__»adlšk_chk
)

136 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
	`__w¬Ç‰r
 ("readlink called with bigger†ength "

139 
__ex‹º_®ways_šlše
 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
ssize_t


140 
	`__NTH
 (
	$»adlšk
 (
__cÚ¡
 *
__»¡riù
 
__·th
, *__»¡riù 
__buf
,

141 
size_t
 
__Ën
))

143 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

145 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

146  
	`__»adlšk_chk
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

148 iàĞ
__Ën
 > 
	`__bos
 (
__buf
))

149  
	`__»adlšk_chk_w¬n
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

151  
	`__»adlšk_®Ÿs
 (
__·th
, 
__buf
, 
__Ën
);

152 
	}
}

155 #ifdeà
__USE_ATFILE


156 
ssize_t
 
	$__»adlšk©_chk
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

157 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

158 
size_t
 
__buæ’
)

159 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

160 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_®Ÿs
,

161 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

162 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
),

163 
»adlšk©
)

164 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

165 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_chk_w¬n
,

166 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

167 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

168 
size_t
 
__buæ’
), 
__»adlšk©_chk
)

169 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
	`__w¬Ç‰r
 ("readlinkat called with bigger "

173 
__ex‹º_®ways_šlše
 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
ssize_t


174 
	`__NTH
 (
	$»adlšk©
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

175 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
))

177 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

179 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

180  
	`__»adlšk©_chk
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

182 ià(
__Ën
 > 
	`__bos
 (
__buf
))

183  
	`__»adlšk©_chk_w¬n
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
,

184 
	`__bos
 (
__buf
));

186  
	`__»adlšk©_®Ÿs
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
);

187 
	}
}

190 *
	$__g‘cwd_chk
 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
)

191 
__THROW
 
__wur
;

192 *
	`__REDIRECT_NTH
 (
__g‘cwd_®Ÿs
,

193 (*
__buf
, 
size_t
 
__size
), 
g‘cwd
è
__wur
;

194 *
	`__REDIRECT_NTH
 (
__g‘cwd_chk_w¬n
,

195 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
),

196 
__g‘cwd_chk
)

197 
__wur
 
	`__w¬Ç‰r
 ("getcwd caller with bigger†engthhan size of "

200 
__ex‹º_®ways_šlše
 
__wur
 *

201 
	`__NTH
 (
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
))

203 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

205 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
))

206  
	`__g‘cwd_chk
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

208 ià(
__size
 > 
	`__bos
 (
__buf
))

209  
	`__g‘cwd_chk_w¬n
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

211  
	`__g‘cwd_®Ÿs
 (
__buf
, 
__size
);

212 
	}
}

214 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


215 *
	$__g‘wd_chk
 (*
__buf
, 
size_t
 
buæ’
)

216 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

217 *
	`__REDIRECT_NTH
 (
__g‘wd_w¬n
, (*
__buf
), 
g‘wd
)

218 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("please use getcwd instead,‡s getwd "

221 
__ex‹º_®ways_šlše
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
 *

222 
	`__NTH
 (
	$g‘wd
 (*
__buf
))

224 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

225  
	`__g‘wd_chk
 (
__buf
, 
	`__bos
 (__buf));

226  
	`__g‘wd_w¬n
 (
__buf
);

227 
	}
}

230 
size_t
 
	$__cÚf¡r_chk
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

231 
size_t
 
__buæ’
è
__THROW
;

232 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_®Ÿs
, (
__Çme
, *
__buf
,

233 
size_t
 
__Ën
), 
cÚf¡r
);

234 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_chk_w¬n
,

235 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

236 
size_t
 
__buæ’
), 
__cÚf¡r_chk
)

237 
	`__w¬Ç‰r
 ("confstr called with bigger†engthhan size of destination "

240 
__ex‹º_®ways_šlše
 
size_t


241 
	`__NTH
 (
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
))

243 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

245 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

246  
	`__cÚf¡r_chk
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

248 ià(
	`__bos
 (
__buf
è< 
__Ën
)

249  
	`__cÚf¡r_chk_w¬n
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

251  
	`__cÚf¡r_®Ÿs
 (
__Çme
, 
__buf
, 
__Ën
);

252 
	}
}

255 
	$__g‘groups_chk
 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
)

256 
__THROW
 
__wur
;

257 
	`__REDIRECT_NTH
 (
__g‘groups_®Ÿs
, (
__size
, 
__gid_t
 
__li¡
[]),

258 
g‘groups
è
__wur
;

259 
	`__REDIRECT_NTH
 (
__g‘groups_chk_w¬n
,

260 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
),

261 
__g‘groups_chk
)

262 
__wur
 
	`__w¬Ç‰r
 ("getgroups called with bigger group counthan what "

265 
__ex‹º_®ways_šlše
 

266 
	`__NTH
 (
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]))

268 ià(
	`__bos
 (
__li¡
è!ğ(
size_t
) -1)

270 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
) || __size < 0)

271  
	`__g‘groups_chk
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

273 ià(
__size
 *  (
__gid_t
è> 
	`__bos
 (
__li¡
))

274  
	`__g‘groups_chk_w¬n
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

276  
	`__g‘groups_®Ÿs
 (
__size
, 
__li¡
);

277 
	}
}

280 
	$__‰yÇme_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

281 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

282 
	`__REDIRECT_NTH
 (
__‰yÇme_r_®Ÿs
, (
__fd
, *
__buf
,

283 
size_t
 
__buæ’
), 
‰yÇme_r
)

284 
	`__nÚnuÎ
 ((2));

285 
	`__REDIRECT_NTH
 (
__‰yÇme_r_chk_w¬n
,

286 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

287 
size_t
 
__Ä—l
), 
__‰yÇme_r_chk
)

288 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ttyname_r called with bigger buflenhan "

291 
__ex‹º_®ways_šlše
 

292 
	`__NTH
 (
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

294 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

296 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

297  
	`__‰yÇme_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

299 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

300  
	`__‰yÇme_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

302  
	`__‰yÇme_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

303 
	}
}

306 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


307 
	$__g‘logš_r_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

308 
	`__nÚnuÎ
 ((1));

309 
	`__REDIRECT
 (
__g‘logš_r_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

310 
g‘logš_r
è
	`__nÚnuÎ
 ((1));

311 
	`__REDIRECT
 (
__g‘logš_r_chk_w¬n
,

312 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

313 
__g‘logš_r_chk
)

314 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("getlogin_r called with bigger buflenhan "

317 
__ex‹º_®ways_šlše
 

318 
	$g‘logš_r
 (*
__buf
, 
size_t
 
__buæ’
)

320 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

322 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

323  
	`__g‘logš_r_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

325 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

326  
	`__g‘logš_r_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

328  
	`__g‘logš_r_®Ÿs
 (
__buf
, 
__buæ’
);

329 
	}
}

333 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98


334 
	$__g‘ho¡Çme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

335 
__THROW
 
	`__nÚnuÎ
 ((1));

336 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

337 
g‘ho¡Çme
è
	`__nÚnuÎ
 ((1));

338 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_chk_w¬n
,

339 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

340 
__g‘ho¡Çme_chk
)

341 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("gethostname called with bigger buflenhan "

344 
__ex‹º_®ways_šlše
 

345 
	`__NTH
 (
	$g‘ho¡Çme
 (*
__buf
, 
size_t
 
__buæ’
))

347 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

349 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

350  
	`__g‘ho¡Çme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

352 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

353  
	`__g‘ho¡Çme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

355  
	`__g‘ho¡Çme_®Ÿs
 (
__buf
, 
__buæ’
);

356 
	}
}

360 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

361 
	$__g‘domašÇme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

362 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

363 
	`__REDIRECT_NTH
 (
__g‘domašÇme_®Ÿs
, (*
__buf
,

364 
size_t
 
__buæ’
),

365 
g‘domašÇme
è
	`__nÚnuÎ
 ((1)è
__wur
;

366 
	`__REDIRECT_NTH
 (
__g‘domašÇme_chk_w¬n
,

367 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

368 
__g‘domašÇme_chk
)

369 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("getdomainname called with bigger "

373 
__ex‹º_®ways_šlše
 

374 
	`__NTH
 (
	$g‘domašÇme
 (*
__buf
, 
size_t
 
__buæ’
))

376 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

378 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

379  
	`__g‘domašÇme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

381 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

382  
	`__g‘domašÇme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

384  
	`__g‘domašÇme_®Ÿs
 (
__buf
, 
__buæ’
);

385 
	}
}

	@/usr/include/bits/utsname.h

19 #iâdeà
_SYS_UTSNAME_H


24 
	#_UTSNAME_LENGTH
 65

	)

29 
	#_UTSNAME_DOMAIN_LENGTH
 
_UTSNAME_LENGTH


	)

	@/usr/include/bits/waitflags.h

20 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


26 
	#WNOHANG
 1

	)

27 
	#WUNTRACED
 2

	)

30 
	#WSTOPPED
 2

	)

31 
	#WEXITED
 4

	)

32 
	#WCONTINUED
 8

	)

33 
	#WNOWAIT
 0x01000000

	)

35 
	#__WNOTHREAD
 0x20000000

	)

37 
	#__WALL
 0x40000000

	)

38 
	#__WCLONE
 0x80000000

	)

	@/usr/include/bits/waitstatus.h

20 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


29 
	#__WEXITSTATUS
(
¡©us
è(((¡©usè& 0xff00è>> 8)

	)

32 
	#__WTERMSIG
(
¡©us
è((¡©usè& 0x7f)

	)

35 
	#__WSTOPSIG
(
¡©us
è
	`__WEXITSTATUS
(¡©us)

	)

38 
	#__WIFEXITED
(
¡©us
è(
	`__WTERMSIG
(¡©usè=ğ0)

	)

41 
	#__WIFSIGNALED
(
¡©us
) \

42 (((sigÃd è(((
¡©us
è& 0x7fè+ 1è>> 1è> 0)

	)

45 
	#__WIFSTOPPED
(
¡©us
è(((¡©usè& 0xffè=ğ0x7f)

	)

49 #ifdeà
WCONTINUED


50 
	#__WIFCONTINUED
(
¡©us
è((¡©usè=ğ
__W_CONTINUED
)

	)

54 
	#__WCOREDUMP
(
¡©us
è((¡©usè& 
__WCOREFLAG
)

	)

57 
	#__W_EXITCODE
(
»t
, 
sig
è(Ô‘è<< 8 | (sig))

	)

58 
	#__W_STOPCODE
(
sig
è((sigè<< 8 | 0x7f)

	)

59 
	#__W_CONTINUED
 0xffff

	)

60 
	#__WCOREFLAG
 0x80

	)

63 #ifdef 
__USE_BSD


65 
	~<’dŸn.h
>

67 
	uwa™


69 
	mw_¡©us
;

72 #if 
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


73 
	m__w_‹rmsig
:7;

74 
	m__w_cÜedump
:1;

75 
	m__w_»tcode
:8;

78 #if 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


80 
	m__w_»tcode
:8;

81 
	m__w_cÜedump
:1;

82 
	m__w_‹rmsig
:7;

84 } 
	m__wa™_‹rmš©ed
;

87 #if 
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


88 
	m__w_¡İv®
:8;

89 
	m__w_¡İsig
:8;

92 #if 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


94 
	m__w_¡İsig
:8;

95 
	m__w_¡İv®
:8;

97 } 
	m__wa™_¡İ³d
;

100 
	#w_‹rmsig
 
__wa™_‹rmš©ed
.
__w_‹rmsig


	)

101 
	#w_cÜedump
 
__wa™_‹rmš©ed
.
__w_cÜedump


	)

102 
	#w_»tcode
 
__wa™_‹rmš©ed
.
__w_»tcode


	)

103 
	#w_¡İsig
 
__wa™_¡İ³d
.
__w_¡İsig


	)

104 
	#w_¡İv®
 
__wa™_¡İ³d
.
__w_¡İv®


	)

	@/usr/include/bits/wchar.h

20 #iâdeà
_BITS_WCHAR_H


21 
	#_BITS_WCHAR_H
 1

	)

23 
	#__WCHAR_MIN
 (-2147483647 - 1)

	)

24 
	#__WCHAR_MAX
 (2147483647)

	)

	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__


4 
	#__WORDSIZE
 64

	)

5 
	#__WORDSIZE_COMPAT32
 1

	)

7 
	#__WORDSIZE
 32

	)

	@/usr/include/bits/xopen_lim.h

30 #iâdeà
_XOPEN_LIM_H


31 
	#_XOPEN_LIM_H
 1

	)

33 
	#__Ãed_IOV_MAX


	)

34 
	~<b™s/¡dio_lim.h
>

66 
	#_XOPEN_IOV_MAX
 
_POSIX_UIO_MAXIOV


	)

71 
	#NL_ARGMAX
 
_POSIX_ARG_MAX


	)

74 
	#NL_LANGMAX
 
_POSIX2_LINE_MAX


	)

77 
	#NL_MSGMAX
 
INT_MAX


	)

81 
	#NL_NMAX
 
INT_MAX


	)

84 
	#NL_SETMAX
 
INT_MAX


	)

87 
	#NL_TEXTMAX
 
INT_MAX


	)

90 
	#NZERO
 20

	)

94 #ifdeà
INT_MAX


95 #ià
INT_MAX
 == 32767

96 
	#WORD_BIT
 16

	)

98 #ià
INT_MAX
 == 2147483647

99 
	#WORD_BIT
 32

	)

102 
	#WORD_BIT
 64

	)

105 #–ià
defšed
 
__INT_MAX__


106 #ià
__INT_MAX__
 == 32767

107 
	#WORD_BIT
 16

	)

109 #ià
__INT_MAX__
 == 2147483647

110 
	#WORD_BIT
 32

	)

113 
	#WORD_BIT
 64

	)

117 
	#WORD_BIT
 32

	)

121 #ifdeà
LONG_MAX


122 #ià
LONG_MAX
 == 2147483647

123 
	#LONG_BIT
 32

	)

126 
	#LONG_BIT
 64

	)

128 #–ià
defšed
 
__LONG_MAX__


129 #ià
__LONG_MAX__
 == 2147483647

130 
	#LONG_BIT
 32

	)

133 
	#LONG_BIT
 64

	)

136 
	~<b™s/wÜdsize.h
>

137 #ià
__WORDSIZE
 == 64

138 
	#LONG_BIT
 64

	)

140 
	#LONG_BIT
 32

	)

	@/usr/include/endian.h

19 #iâdef 
_ENDIAN_H


20 
	#_ENDIAN_H
 1

	)

22 
	~<ã©u»s.h
>

32 
	#__LITTLE_ENDIAN
 1234

	)

33 
	#__BIG_ENDIAN
 4321

	)

34 
	#__PDP_ENDIAN
 3412

	)

37 
	~<b™s/’dŸn.h
>

41 #iâdeà
__FLOAT_WORD_ORDER


42 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

45 #ifdef 
__USE_BSD


46 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

47 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

48 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

49 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

52 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


53 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

54 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


55 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

59 #ifdeà
__USE_BSD


61 
	~<b™s/by‹sw­.h
>

63 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


64 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

65 
	#htŞe16
(
x
è(x)

	)

66 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

67 
	#Ë16toh
(
x
è(x)

	)

69 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

70 
	#htŞe32
(
x
è(x)

	)

71 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

72 
	#Ë32toh
(
x
è(x)

	)

74 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

75 
	#htŞe64
(
x
è(x)

	)

76 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

77 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/expat_external.h

5 #iâdeà
Ex·t_Ex‹º®_INCLUDED


6 
	#Ex·t_Ex‹º®_INCLUDED
 1

	)

10 #ià
defšed
(
_MSC_EXTENSIONS
è&& !defšed(
__BEOS__
è&& !defšed(
__CYGWIN__
)

11 
	#XML_USE_MSC_EXTENSIONS
 1

	)

36 #iâdeà
XMLCALL


37 #ià
defšed
(
_MSC_VER
)

38 
	#XMLCALL
 
__cdeş


	)

39 #–ià
defšed
(
__GNUC__
è&& defšed(
__i386
è&& !defšed(
__INTEL_COMPILER
)

40 
	#XMLCALL
 
	`__©Œibu‹__
((
cdeş
))

	)

52 
	#XMLCALL


	)

57 #ià!
defšed
(
XML_STATIC
è&& !defšed(
XMLIMPORT
)

58 #iâdeà
XML_BUILDING_EXPAT


61 #ifdeà
XML_USE_MSC_EXTENSIONS


62 
	#XMLIMPORT
 
	`__deş¥ec
(
dÎimpÜt
)

	)

70 #iâdeà
XMLIMPORT


71 
	#XMLIMPORT


	)

75 
	#XMLPARSEAPI
(
ty³
è
XMLIMPORT
y³ 
XMLCALL


	)

77 #ifdeà
__ılu¥lus


81 #ifdeà
XML_UNICODE_WCHAR_T


82 
	#XML_UNICODE


	)

85 #ifdeà
XML_UNICODE


86 #ifdeà
XML_UNICODE_WCHAR_T


87 
wch¬_t
 
	tXML_Ch¬
;

88 
wch¬_t
 
	tXML_LCh¬
;

90 
	tXML_Ch¬
;

91 
	tXML_LCh¬
;

94 
	tXML_Ch¬
;

95 
	tXML_LCh¬
;

98 #ifdeà
XML_LARGE_SIZE


99 #ià
defšed
(
XML_USE_MSC_EXTENSIONS
è&& 
_MSC_VER
 < 1400

100 
__št64
 
	tXML_Index
;

101 
	t__št64
 
	tXML_Size
;

103 
	tXML_Index
;

104 
	tXML_Size
;

107 
	tXML_Index
;

108 
	tXML_Size
;

111 #ifdeà
__ılu¥lus


	@/usr/include/features.h

19 #iâdef 
_FEATURES_H


20 
	#_FEATURES_H
 1

	)

93 #undeà
__USE_ISOC99


94 #undeà
__USE_ISOC95


95 #undeà
__USE_POSIX


96 #undeà
__USE_POSIX2


97 #undeà
__USE_POSIX199309


98 #undeà
__USE_POSIX199506


99 #undeà
__USE_XOPEN


100 #undeà
__USE_XOPEN_EXTENDED


101 #undeà
__USE_UNIX98


102 #undeà
__USE_XOPEN2K


103 #undeà
__USE_LARGEFILE


104 #undeà
__USE_LARGEFILE64


105 #undeà
__USE_FILE_OFFSET64


106 #undeà
__USE_BSD


107 #undeà
__USE_SVID


108 #undeà
__USE_MISC


109 #undeà
__USE_ATFILE


110 #undeà
__USE_GNU


111 #undeà
__USE_REENTRANT


112 #undeà
__USE_FORTIFY_LEVEL


113 #undeà
__FAVOR_BSD


114 #undeà
__KERNEL_STRICT_NAMES


118 #iâdeà
_LOOSE_KERNEL_NAMES


119 
	#__KERNEL_STRICT_NAMES


	)

123 
	#__USE_ANSI
 1

	)

132 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


133 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

134 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

136 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

141 #ià
defšed
 
_BSD_SOURCE
 && \

142 !(
defšed
 
	g_POSIX_SOURCE
 || defšed 
	g_POSIX_C_SOURCE
 || \

143 
defšed
 
	g_XOPEN_SOURCE
 || defšed 
	g_XOPEN_SOURCE_EXTENDED
 || \

144 
defšed
 
	g_GNU_SOURCE
 || defšed 
	g_SVID_SOURCE
)

145 
	#__FAVOR_BSD
 1

	)

149 #ifdeà
_GNU_SOURCE


150 #undeà
_ISOC99_SOURCE


151 
	#_ISOC99_SOURCE
 1

	)

152 #undeà
_POSIX_SOURCE


153 
	#_POSIX_SOURCE
 1

	)

154 #undeà
_POSIX_C_SOURCE


155 
	#_POSIX_C_SOURCE
 200112L

	)

156 #undeà
_XOPEN_SOURCE


157 
	#_XOPEN_SOURCE
 600

	)

158 #undeà
_XOPEN_SOURCE_EXTENDED


159 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

160 #undeà
_LARGEFILE64_SOURCE


161 
	#_LARGEFILE64_SOURCE
 1

	)

162 #undeà
_BSD_SOURCE


163 
	#_BSD_SOURCE
 1

	)

164 #undeà
_SVID_SOURCE


165 
	#_SVID_SOURCE
 1

	)

166 #undeà
_ATFILE_SOURCE


167 
	#_ATFILE_SOURCE
 1

	)

172 #ià(!
defšed
 
__STRICT_ANSI__
 && !defšed 
_ISOC99_SOURCE
 && \

173 !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 && \

174 !
defšed
 
	g_XOPEN_SOURCE
 && !defšed 
	g_XOPEN_SOURCE_EXTENDED
 && \

175 !
defšed
 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
)

176 
	#_BSD_SOURCE
 1

	)

177 
	#_SVID_SOURCE
 1

	)

184 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

185 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

186 
	#__USE_ISOC99
 1

	)

190 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

191 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

192 
	#__USE_ISOC95
 1

	)

197 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

198 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

199 
	#_POSIX_SOURCE
 1

	)

200 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

201 
	#_POSIX_C_SOURCE
 2

	)

202 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

203 
	#_POSIX_C_SOURCE
 199506L

	)

205 
	#_POSIX_C_SOURCE
 200112L

	)

209 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


210 
	#__USE_POSIX
 1

	)

213 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


214 
	#__USE_POSIX2
 1

	)

217 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

218 
	#__USE_POSIX199309
 1

	)

221 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

222 
	#__USE_POSIX199506
 1

	)

225 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

226 
	#__USE_XOPEN2K
 1

	)

229 #ifdef 
_XOPEN_SOURCE


230 
	#__USE_XOPEN
 1

	)

231 #ià(
_XOPEN_SOURCE
 - 0) >= 500

232 
	#__USE_XOPEN_EXTENDED
 1

	)

233 
	#__USE_UNIX98
 1

	)

234 #undeà
_LARGEFILE_SOURCE


235 
	#_LARGEFILE_SOURCE
 1

	)

236 #ià(
_XOPEN_SOURCE
 - 0) >= 600

237 
	#__USE_XOPEN2K
 1

	)

238 #undeà
__USE_ISOC99


239 
	#__USE_ISOC99
 1

	)

242 #ifdeà
_XOPEN_SOURCE_EXTENDED


243 
	#__USE_XOPEN_EXTENDED
 1

	)

248 #ifdeà
_LARGEFILE_SOURCE


249 
	#__USE_LARGEFILE
 1

	)

252 #ifdeà
_LARGEFILE64_SOURCE


253 
	#__USE_LARGEFILE64
 1

	)

256 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

257 
	#__USE_FILE_OFFSET64
 1

	)

260 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


261 
	#__USE_MISC
 1

	)

264 #ifdef 
_BSD_SOURCE


265 
	#__USE_BSD
 1

	)

268 #ifdef 
_SVID_SOURCE


269 
	#__USE_SVID
 1

	)

272 #ifdef 
_ATFILE_SOURCE


273 
	#__USE_ATFILE
 1

	)

276 #ifdef 
_GNU_SOURCE


277 
	#__USE_GNU
 1

	)

280 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


281 
	#__USE_REENTRANT
 1

	)

284 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

285 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

286 #ià
_FORTIFY_SOURCE
 > 1

287 
	#__USE_FORTIFY_LEVEL
 2

	)

289 
	#__USE_FORTIFY_LEVEL
 1

	)

292 
	#__USE_FORTIFY_LEVEL
 0

	)

296 
	#__STDC_IEC_559__
 1

	)

297 
	#__STDC_IEC_559_COMPLEX__
 1

	)

300 
	#__STDC_ISO_10646__
 200009L

	)

308 #undeà
__GNU_LIBRARY__


309 
	#__GNU_LIBRARY__
 6

	)

313 
	#__GLIBC__
 2

	)

314 
	#__GLIBC_MINOR__
 9

	)

316 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

317 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

320 #ià
defšed
 
__GNUC__
 \

321 || (
defšed
 
	g__PGI
 && defšed 
	g__i386__
 ) \

322 || (
defšed
 
	g__INTEL_COMPILER
 && (defšed 
	g__i386__
 || defšed 
	g__Ÿ64__
)) \

323 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

324 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

328 #iâdeà
__ASSEMBLER__


329 #iâdeà
_SYS_CDEFS_H


330 
	~<sys/cdefs.h
>

335 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


336 
	#__USE_LARGEFILE
 1

	)

337 
	#__USE_LARGEFILE64
 1

	)

343 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

344 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

345 && 
defšed
 
	g__ex‹º_šlše


346 
	#__USE_EXTERN_INLINES
 1

	)

354 
	~<gnu/¡ubs.h
>

	@/usr/include/libio.h

29 #iâdeà
_IO_STDIO_H


30 
	#_IO_STDIO_H


	)

32 
	~<_G_cÚfig.h
>

34 
	#_IO_pos_t
 
_G_åos_t


	)

35 
	#_IO_åos_t
 
_G_åos_t


	)

36 
	#_IO_åos64_t
 
_G_åos64_t


	)

37 
	#_IO_size_t
 
_G_size_t


	)

38 
	#_IO_ssize_t
 
_G_ssize_t


	)

39 
	#_IO_off_t
 
_G_off_t


	)

40 
	#_IO_off64_t
 
_G_off64_t


	)

41 
	#_IO_pid_t
 
_G_pid_t


	)

42 
	#_IO_uid_t
 
_G_uid_t


	)

43 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

44 
	#_IO_HAVE_SYS_WAIT
 
_G_HAVE_SYS_WAIT


	)

45 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

46 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

47 
	#_IO_va_li¡
 
_G_va_li¡


	)

48 
	#_IO_wšt_t
 
_G_wšt_t


	)

50 #ifdeà
_G_NEED_STDARG_H


52 
	#__Ãed___va_li¡


	)

53 
	~<¡d¬g.h
>

54 #ifdeà
__GNUC_VA_LIST


55 #undeà
_IO_va_li¡


56 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

60 #iâdeà
__P


61 #ià
_G_HAVE_SYS_CDEFS


62 
	~<sys/cdefs.h
>

64 #ifdeà
__STDC__


65 
	#__P
(
p
è
	)
p

66 
	#__PMT
(
p
è
	)
p

68 
	#__P
(
p
è()

	)

69 
	#__PMT
(
p
è()

	)

75 #iâdeà
_PARAMS


76 
	#_PARAMS
(
´Ùos
è
	`__P
ÕrÙos)

	)

79 #iâdeà
__STDC__


81 cÚ¡

	)

84 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

85 #iâdeà
_G_HAVE_PRINTF_FP


86 
	#_IO_USE_DTOA
 1

	)

89 #iâdeà
EOF


90 
	#EOF
 (-1)

	)

92 #iâdeà
NULL


93 #ià
defšed
 
__GNUG__
 && \

94 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

95 
	#NULL
 (
__nuÎ
)

	)

97 #ià!
defšed
(
__ılu¥lus
)

98 
	#NULL
 ((*)0)

	)

100 
	#NULL
 (0)

	)

105 
	#_IOS_INPUT
 1

	)

106 
	#_IOS_OUTPUT
 2

	)

107 
	#_IOS_ATEND
 4

	)

108 
	#_IOS_APPEND
 8

	)

109 
	#_IOS_TRUNC
 16

	)

110 
	#_IOS_NOCREATE
 32

	)

111 
	#_IOS_NOREPLACE
 64

	)

112 
	#_IOS_BIN
 128

	)

120 
	#_IO_MAGIC
 0xFBAD0000

	)

121 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

122 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

123 
	#_IO_USER_BUF
 1

	)

124 
	#_IO_UNBUFFERED
 2

	)

125 
	#_IO_NO_READS
 4

	)

126 
	#_IO_NO_WRITES
 8

	)

127 
	#_IO_EOF_SEEN
 0x10

	)

128 
	#_IO_ERR_SEEN
 0x20

	)

129 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

130 
	#_IO_LINKED
 0x80

	)

131 
	#_IO_IN_BACKUP
 0x100

	)

132 
	#_IO_LINE_BUF
 0x200

	)

133 
	#_IO_TIED_PUT_GET
 0x400

	)

134 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

135 
	#_IO_IS_APPENDING
 0x1000

	)

136 
	#_IO_IS_FILEBUF
 0x2000

	)

137 
	#_IO_BAD_SEEN
 0x4000

	)

138 
	#_IO_USER_LOCK
 0x8000

	)

140 
	#_IO_FLAGS2_MMAP
 1

	)

141 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

142 #ifdeà
_LIBC


143 
	#_IO_FLAGS2_FORTIFY
 4

	)

145 
	#_IO_FLAGS2_USER_WBUF
 8

	)

146 #ifdeà
_LIBC


147 
	#_IO_FLAGS2_SCANF_STD
 16

	)

151 
	#_IO_SKIPWS
 01

	)

152 
	#_IO_LEFT
 02

	)

153 
	#_IO_RIGHT
 04

	)

154 
	#_IO_INTERNAL
 010

	)

155 
	#_IO_DEC
 020

	)

156 
	#_IO_OCT
 040

	)

157 
	#_IO_HEX
 0100

	)

158 
	#_IO_SHOWBASE
 0200

	)

159 
	#_IO_SHOWPOINT
 0400

	)

160 
	#_IO_UPPERCASE
 01000

	)

161 
	#_IO_SHOWPOS
 02000

	)

162 
	#_IO_SCIENTIFIC
 04000

	)

163 
	#_IO_FIXED
 010000

	)

164 
	#_IO_UNITBUF
 020000

	)

165 
	#_IO_STDIO
 040000

	)

166 
	#_IO_DONT_CLOSE
 0100000

	)

167 
	#_IO_BOOLALPHA
 0200000

	)

170 
_IO_jump_t
; 
	g_IO_FILE
;

173 #ifdeà
_IO_MTSAFE_IO


174 #ià
defšed
 
__GLIBC__
 && __GLIBC__ >= 2

175 
	~<b™s/¡dio-lock.h
>

180 
	t_IO_lock_t
;

186 
	s_IO_m¬k”
 {

187 
_IO_m¬k”
 *
	m_Ãxt
;

188 
_IO_FILE
 *
	m_sbuf
;

192 
	m_pos
;

194 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

195 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

196 
	mpublic
:

197 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

198 ~
¡»amm¬k”
();

199 
§všg
(è{  
	m_¥os
 == -2; }

200 
d–
(
¡»amm¬k”
&);

201 
d–
();

206 
	e__codecvt_»suÉ


208 
	m__codecvt_ok
,

209 
	m__codecvt_·¹Ÿl
,

210 
	m__codecvt_”rÜ
,

211 
	m__codecvt_nocÚv


214 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


217 
	s_IO_codecvt


219 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

220 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

221 
	m__mb¡©e_t
 *,

222 cÚ¡ 
	mwch¬_t
 *,

223 cÚ¡ 
	mwch¬_t
 *,

224 cÚ¡ 
	mwch¬_t
 **, *,

226 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

227 
	m__mb¡©e_t
 *, *,

229 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

230 
	m__mb¡©e_t
 *,

232 cÚ¡ **, 
	mwch¬_t
 *,

233 
	mwch¬_t
 *, wchar_t **);

234 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

235 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

236 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

237 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

238 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

240 
_IO_icÚv_t
 
	m__cd_š
;

241 
_IO_icÚv_t
 
	m__cd_out
;

245 
	s_IO_wide_d©a


247 
wch¬_t
 *
	m_IO_»ad_±r
;

248 
wch¬_t
 *
	m_IO_»ad_’d
;

249 
wch¬_t
 *
	m_IO_»ad_ba£
;

250 
wch¬_t
 *
	m_IO_wr™e_ba£
;

251 
wch¬_t
 *
	m_IO_wr™e_±r
;

252 
wch¬_t
 *
	m_IO_wr™e_’d
;

253 
wch¬_t
 *
	m_IO_buf_ba£
;

254 
wch¬_t
 *
	m_IO_buf_’d
;

256 
wch¬_t
 *
	m_IO_§ve_ba£
;

257 
wch¬_t
 *
	m_IO_backup_ba£
;

259 
wch¬_t
 *
	m_IO_§ve_’d
;

261 
__mb¡©e_t
 
	m_IO_¡©e
;

262 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

263 
_IO_codecvt
 
	m_codecvt
;

265 
wch¬_t
 
	m_shÜtbuf
[1];

267 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

271 
	s_IO_FILE
 {

272 
	m_æags
;

273 
	#_IO_fe_æags
 
_æags


	)

277 * 
	m_IO_»ad_±r
;

278 * 
	m_IO_»ad_’d
;

279 * 
	m_IO_»ad_ba£
;

280 * 
	m_IO_wr™e_ba£
;

281 * 
	m_IO_wr™e_±r
;

282 * 
	m_IO_wr™e_’d
;

283 * 
	m_IO_buf_ba£
;

284 * 
	m_IO_buf_’d
;

286 *
	m_IO_§ve_ba£
;

287 *
	m_IO_backup_ba£
;

288 *
	m_IO_§ve_’d
;

290 
_IO_m¬k”
 *
	m_m¬k”s
;

292 
_IO_FILE
 *
	m_chaš
;

294 
	m_f’o
;

296 
	m_blksize
;

298 
	m_æags2
;

300 
_IO_off_t
 
	m_Şd_off£t
;

302 
	#__HAVE_COLUMN


	)

304 
	m_cur_cŞumn
;

305 sigÃd 
	m_vbË_off£t
;

306 
	m_shÜtbuf
[1];

310 
_IO_lock_t
 *
	m_lock
;

311 #ifdeà
_IO_USE_OLD_IO_FILE


314 
	s_IO_FILE_com¶‘e


316 
_IO_FILE
 
	m_fe
;

318 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

319 
_IO_off64_t
 
	m_off£t
;

320 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


322 
_IO_codecvt
 *
	m_codecvt
;

323 
_IO_wide_d©a
 *
	m_wide_d©a
;

324 
_IO_FILE
 *
	m_ä“»s_li¡
;

325 *
	m_ä“»s_buf
;

326 
size_t
 
	m_ä“»s_size
;

328 *
	m__·d1
;

329 *
	m__·d2
;

330 *
	m__·d3
;

331 *
	m__·d4
;

332 
size_t
 
	m__·d5
;

334 
	m_mode
;

336 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

340 #iâdeà
__ılu¥lus


341 
_IO_FILE
 
	t_IO_FILE
;

344 
	g_IO_FILE_¶us
;

346 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

347 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

348 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

349 #iâdeà
_LIBC


350 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

351 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

352 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

354 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

355 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

356 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

364 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

372 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, 
	t__cÚ¡
 *
	t__buf
,

373 
	tsize_t
 
	t__n
);

381 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

384 
	t__io_şo£_â
 (*
	t__cook›
);

387 #ifdeà
_GNU_SOURCE


389 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

390 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

391 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

392 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

397 
__io_»ad_â
 *
	m»ad
;

398 
__io_wr™e_â
 *
	mwr™e
;

399 
__io_£ek_â
 *
	m£ek
;

400 
__io_şo£_â
 *
	mşo£
;

401 } 
	t_IO_cook›_io_funùiÚs_t
;

402 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

404 
	g_IO_cook›_fe
;

407 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

408 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

412 #ifdeà
__ılu¥lus


416 
__und”æow
 (
_IO_FILE
 *);

417 
__uæow
 (
_IO_FILE
 *);

418 
__ov”æow
 (
_IO_FILE
 *, );

419 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


420 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

421 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

422 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

425 #ià 
__GNUC__
 >= 3

426 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

428 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

431 
	#_IO_g‘c_uÆocked
(
_å
) \

432 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

433 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

434 
	#_IO_³ekc_uÆocked
(
_å
) \

435 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

436 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

437 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

438 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

439 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

440 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

441 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

443 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


444 
	#_IO_g‘wc_uÆocked
(
_å
) \

445 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 >ğ(_å)->_wide_d©a->
_IO_»ad_’d
,\

447 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

448 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

449 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

450 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
, 0) \

451 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

452 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

455 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

456 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

458 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

459 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

460 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

461 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

463 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

466 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

467 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

469 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

470 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

471 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

473 #ifdeà
_IO_MTSAFE_IO


474 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_locked
 (_å)

	)

475 
	#_IO_æockfe
(
_å
) \

476 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_æockfe
 (_å)

	)

477 
	#_IO_fuÆockfe
(
_å
) \

478 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_fuÆockfe
 (_å)

	)

480 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

481 
	#_IO_æockfe
(
_å
è

	)

482 
	#_IO_fuÆockfe
(
_å
è

	)

483 
	#_IO_árylockfe
(
_å
è

	)

484 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

485 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

488 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

489 
_IO_va_li¡
, *
__»¡riù
);

490 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

491 
_IO_va_li¡
);

492 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

493 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

495 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

496 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

498 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

500 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


501 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

502 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

503 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

504 #ià
__GNUC__
 >= 2

507 #ià
defšed
 
_LIBC
 && defšed 
SHARED


508 
	~<shlib-com·t.h
>

509 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

510 
	#_IO_fwide_maybe_šcom·tibË
 \

511 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

512 cÚ¡ 
_IO_¡dš_u£d
;

513 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

516 #iâdeà
_IO_fwide_maybe_šcom·tibË


517 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

521 
	#_IO_fwide
(
__å
, 
__mode
) \

522 ({ 
__»suÉ
 = (
__mode
); \

523 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

525 ià((
__å
)->
_mode
 == 0) \

527 (
__å
)->
_mode
 = -1; \

528 
__»suÉ
 = (
__å
)->
_mode
; \

530 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

531 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

533 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

534 
__»suÉ
; })

	)

537 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

538 
_IO_va_li¡
, *
__»¡riù
);

539 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

540 
_IO_va_li¡
);

541 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

542 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

545 #ifdeà
__LDBL_COMPAT


546 
	~<b™s/libio-ldbl.h
>

549 #ifdeà
__ılu¥lus


	@/usr/include/linux/byteorder/little_endian.h

1 #iâdeà
_LINUX_BYTEORDER_LITTLE_ENDIAN_H


2 
	#_LINUX_BYTEORDER_LITTLE_ENDIAN_H


	)

4 #iâdeà
__LITTLE_ENDIAN


5 
	#__LITTLE_ENDIAN
 1234

	)

7 #iâdeà
__LITTLE_ENDIAN_BITFIELD


8 
	#__LITTLE_ENDIAN_BITFIELD


	)

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/by‹Üd”/swab.h
>

13 
	~<lšux/by‹Üd”/swabb.h
>

15 
	#__cÚ¡ªt_htÚl
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

16 
	#__cÚ¡ªt_Áohl
(
x
è
	`___cÚ¡ªt_swab32
((
__be32
)(x))

	)

17 
	#__cÚ¡ªt_htÚs
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

18 
	#__cÚ¡ªt_Áohs
(
x
è
	`___cÚ¡ªt_swab16
((
__be16
)(x))

	)

19 
	#__cÚ¡ªt_ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

20 
	#__cÚ¡ªt_Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

21 
	#__cÚ¡ªt_ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

22 
	#__cÚ¡ªt_Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

23 
	#__cÚ¡ªt_ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

24 
	#__cÚ¡ªt_Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

25 
	#__cÚ¡ªt_ıu_to_be64
(
x
è((
__be64
)
	`___cÚ¡ªt_swab64
((x)))

	)

26 
	#__cÚ¡ªt_be64_to_ıu
(
x
è
	`___cÚ¡ªt_swab64
((
__u64
)(
__be64
)(x))

	)

27 
	#__cÚ¡ªt_ıu_to_be32
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

28 
	#__cÚ¡ªt_be32_to_ıu
(
x
è
	`___cÚ¡ªt_swab32
((
__u32
)(
__be32
)(x))

	)

29 
	#__cÚ¡ªt_ıu_to_be16
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

30 
	#__cÚ¡ªt_be16_to_ıu
(
x
è
	`___cÚ¡ªt_swab16
((
__u16
)(
__be16
)(x))

	)

31 
	#__ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

32 
	#__Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

33 
	#__ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

34 
	#__Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

35 
	#__ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

36 
	#__Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

37 
	#__ıu_to_be64
(
x
è((
__be64
)
	`__swab64
((x)))

	)

38 
	#__be64_to_ıu
(
x
è
	`__swab64
((
__u64
)(
__be64
)(x))

	)

39 
	#__ıu_to_be32
(
x
è((
__be32
)
	`__swab32
((x)))

	)

40 
	#__be32_to_ıu
(
x
è
	`__swab32
((
__u32
)(
__be32
)(x))

	)

41 
	#__ıu_to_be16
(
x
è((
__be16
)
	`__swab16
((x)))

	)

42 
	#__be16_to_ıu
(
x
è
	`__swab16
((
__u16
)(
__be16
)(x))

	)

44 
šlše
 
__Ë64
 
	$__ıu_to_Ë64p
(cÚ¡ 
__u64
 *
p
)

46  (
__Ë64
)*
p
;

47 
	}
}

48 
šlše
 
__u64
 
	$__Ë64_to_ıup
(cÚ¡ 
__Ë64
 *
p
)

50  (
__u64
)*
p
;

51 
	}
}

52 
šlše
 
__Ë32
 
	$__ıu_to_Ë32p
(cÚ¡ 
__u32
 *
p
)

54  (
__Ë32
)*
p
;

55 
	}
}

56 
šlše
 
__u32
 
	$__Ë32_to_ıup
(cÚ¡ 
__Ë32
 *
p
)

58  (
__u32
)*
p
;

59 
	}
}

60 
šlše
 
__Ë16
 
	$__ıu_to_Ë16p
(cÚ¡ 
__u16
 *
p
)

62  (
__Ë16
)*
p
;

63 
	}
}

64 
šlše
 
__u16
 
	$__Ë16_to_ıup
(cÚ¡ 
__Ë16
 *
p
)

66  (
__u16
)*
p
;

67 
	}
}

68 
šlše
 
__be64
 
	$__ıu_to_be64p
(cÚ¡ 
__u64
 *
p
)

70  (
__be64
)
	`__swab64p
(
p
);

71 
	}
}

72 
šlše
 
__u64
 
	$__be64_to_ıup
(cÚ¡ 
__be64
 *
p
)

74  
	`__swab64p
((
__u64
 *)
p
);

75 
	}
}

76 
šlše
 
__be32
 
	$__ıu_to_be32p
(cÚ¡ 
__u32
 *
p
)

78  (
__be32
)
	`__swab32p
(
p
);

79 
	}
}

80 
šlše
 
__u32
 
	$__be32_to_ıup
(cÚ¡ 
__be32
 *
p
)

82  
	`__swab32p
((
__u32
 *)
p
);

83 
	}
}

84 
šlše
 
__be16
 
	$__ıu_to_be16p
(cÚ¡ 
__u16
 *
p
)

86  (
__be16
)
	`__swab16p
(
p
);

87 
	}
}

88 
šlše
 
__u16
 
	$__be16_to_ıup
(cÚ¡ 
__be16
 *
p
)

90  
	`__swab16p
((
__u16
 *)
p
);

91 
	}
}

92 
	#__ıu_to_Ë64s
(
x
èdØ{ ()(x); } 0)

	)

93 
	#__Ë64_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

94 
	#__ıu_to_Ë32s
(
x
èdØ{ ()(x); } 0)

	)

95 
	#__Ë32_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

96 
	#__ıu_to_Ë16s
(
x
èdØ{ ()(x); } 0)

	)

97 
	#__Ë16_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

98 
	#__ıu_to_be64s
(
x
è
	`__swab64s
((x))

	)

99 
	#__be64_to_ıus
(
x
è
	`__swab64s
((x))

	)

100 
	#__ıu_to_be32s
(
x
è
	`__swab32s
((x))

	)

101 
	#__be32_to_ıus
(
x
è
	`__swab32s
((x))

	)

102 
	#__ıu_to_be16s
(
x
è
	`__swab16s
((x))

	)

103 
	#__be16_to_ıus
(
x
è
	`__swab16s
((x))

	)

	@/usr/include/linux/hdlc/ioctl.h

1 #iâdeà
__HDLC_IOCTL_H__


2 
	#__HDLC_IOCTL_H__


	)

5 
	#GENERIC_HDLC_VERSION
 4

	)

7 
	#CLOCK_DEFAULT
 0

	)

8 
	#CLOCK_EXT
 1

	)

9 
	#CLOCK_INT
 2

	)

10 
	#CLOCK_TXINT
 3

	)

11 
	#CLOCK_TXFROMRX
 4

	)

14 
	#ENCODING_DEFAULT
 0

	)

15 
	#ENCODING_NRZ
 1

	)

16 
	#ENCODING_NRZI
 2

	)

17 
	#ENCODING_FM_MARK
 3

	)

18 
	#ENCODING_FM_SPACE
 4

	)

19 
	#ENCODING_MANCHESTER
 5

	)

22 
	#PARITY_DEFAULT
 0

	)

23 
	#PARITY_NONE
 1

	)

24 
	#PARITY_CRC16_PR0
 2

	)

25 
	#PARITY_CRC16_PR1
 3

	)

26 
	#PARITY_CRC16_PR0_CCITT
 4

	)

27 
	#PARITY_CRC16_PR1_CCITT
 5

	)

28 
	#PARITY_CRC32_PR0_CCITT
 6

	)

29 
	#PARITY_CRC32_PR1_CCITT
 7

	)

31 
	#LMI_DEFAULT
 0

	)

32 
	#LMI_NONE
 1

	)

33 
	#LMI_ANSI
 2

	)

34 
	#LMI_CCITT
 3

	)

35 
	#LMI_CISCO
 4

	)

38 
	mşock_¿‹
;

39 
	mşock_ty³
;

40 
	mloİback
;

41 } 
	tsync_£rŸl_£‰šgs
;

44 
	mşock_¿‹
;

45 
	mşock_ty³
;

46 
	mloİback
;

47 
	m¦Ù_m­
;

48 } 
	t‹1_£‰šgs
;

51 
	m’codšg
;

52 
	m·r™y
;

53 } 
	t¿w_hdlc_´Ùo
;

56 
	mt391
;

57 
	mt392
;

58 
	mn391
;

59 
	mn392
;

60 
	mn393
;

61 
	mlmi
;

62 
	mdû
;

63 } 
	tä_´Ùo
;

66 
	mdlci
;

67 } 
	tä_´Ùo_pvc
;

70 
	mdlci
;

71 
	mma¡”
[
IFNAMSIZ
];

72 }
	tä_´Ùo_pvc_šfo
;

75 
	mš‹rv®
;

76 
	mtimeout
;

77 } 
	tcisco_´Ùo
;

	@/usr/include/linux/ioctl.h

1 #iâdeà
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/ioùl.h
>

	@/usr/include/linux/limits.h

1 #iâdeà
_LINUX_LIMITS_H


2 
	#_LINUX_LIMITS_H


	)

4 
	#NR_OPEN
 1024

	)

6 
	#NGROUPS_MAX
 65536

	)

7 
	#ARG_MAX
 131072

	)

8 
	#LINK_MAX
 127

	)

9 
	#MAX_CANON
 255

	)

10 
	#MAX_INPUT
 255

	)

11 
	#NAME_MAX
 255

	)

12 
	#PATH_MAX
 4096

	)

13 
	#PIPE_BUF
 4096

	)

14 
	#XATTR_NAME_MAX
 255

	)

15 
	#XATTR_SIZE_MAX
 65536

	)

16 
	#XATTR_LIST_MAX
 65536

	)

18 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/netdevice.h

25 #iâdeà
_LINUX_NETDEVICE_H


26 
	#_LINUX_NETDEVICE_H


	)

28 
	~<lšux/if.h
>

29 
	~<lšux/if_‘h”.h
>

30 
	~<lšux/if_·ck‘.h
>

33 
	#MAX_ADDR_LEN
 32

	)

36 
	#NETDEV_TX_OK
 0

	)

37 
	#NETDEV_TX_BUSY
 1

	)

38 
	#NETDEV_TX_LOCKED
 -1

	)

46 
	sÃt_deviû_¡©s


48 
	mrx_·ck‘s
;

49 
	mtx_·ck‘s
;

50 
	mrx_by‹s
;

51 
	mtx_by‹s
;

52 
	mrx_”rÜs
;

53 
	mtx_”rÜs
;

54 
	mrx_drİ³d
;

55 
	mtx_drİ³d
;

56 
	mmuÉiÿ¡
;

57 
	mcŞlisiÚs
;

60 
	mrx_Ëngth_”rÜs
;

61 
	mrx_ov”_”rÜs
;

62 
	mrx_üc_”rÜs
;

63 
	mrx_äame_”rÜs
;

64 
	mrx_fifo_”rÜs
;

65 
	mrx_mis£d_”rÜs
;

68 
	mtx_abÜ‹d_”rÜs
;

69 
	mtx_ÿ¼›r_”rÜs
;

70 
	mtx_fifo_”rÜs
;

71 
	mtx_h—¹b—t_”rÜs
;

72 
	mtx_wšdow_”rÜs
;

75 
	mrx_com´es£d
;

76 
	mtx_com´es£d
;

82 
	mIF_PORT_UNKNOWN
 = 0,

83 
	mIF_PORT_10BASE2
,

84 
	mIF_PORT_10BASET
,

85 
	mIF_PORT_AUI
,

86 
	mIF_PORT_100BASET
,

87 
	mIF_PORT_100BASETX
,

88 
	mIF_PORT_100BASEFX


	@/usr/include/linux/param.h

1 #iâdeà
_LINUX_PARAM_H


2 
	#_LINUX_PARAM_H


	)

4 
	~<asm/·¿m.h
>

	@/usr/include/linux/posix_types.h

1 #iâdeà
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lšux/¡ddef.h
>

21 #undeà
__NFDBITS


22 
	#__NFDBITS
 (8 * ())

	)

24 #undeà
__FD_SETSIZE


25 
	#__FD_SETSIZE
 1024

	)

27 #undeà
__FDSET_LONGS


28 
	#__FDSET_LONGS
 (
__FD_SETSIZE
/
__NFDBITS
)

	)

30 #undeà
__FDELT


31 
	#__FDELT
(
d
è((dè/ 
__NFDBITS
)

	)

33 #undeà
__FDMASK


34 
	#__FDMASK
(
d
è(1UL << ((dè% 
__NFDBITS
))

	)

37 
	mfds_b™s
 [
__FDSET_LONGS
];

38 } 
	t__k”Ãl_fd_£t
;

41 (*
	t__k”Ãl_sighªdËr_t
)();

44 
	t__k”Ãl_key_t
;

45 
	t__k”Ãl_mqd_t
;

47 
	~<asm/posix_ty³s.h
>

	@/usr/include/linux/prctl.h

1 #iâdeà
_LINUX_PRCTL_H


2 
	#_LINUX_PRCTL_H


	)

6 
	#PR_SET_PDEATHSIG
 1

	)

7 
	#PR_GET_PDEATHSIG
 2

	)

10 
	#PR_GET_DUMPABLE
 3

	)

11 
	#PR_SET_DUMPABLE
 4

	)

14 
	#PR_GET_UNALIGN
 5

	)

15 
	#PR_SET_UNALIGN
 6

	)

16 
	#PR_UNALIGN_NOPRINT
 1

	)

17 
	#PR_UNALIGN_SIGBUS
 2

	)

21 
	#PR_GET_KEEPCAPS
 7

	)

22 
	#PR_SET_KEEPCAPS
 8

	)

25 
	#PR_GET_FPEMU
 9

	)

26 
	#PR_SET_FPEMU
 10

	)

27 
	#PR_FPEMU_NOPRINT
 1

	)

28 
	#PR_FPEMU_SIGFPE
 2

	)

31 
	#PR_GET_FPEXC
 11

	)

32 
	#PR_SET_FPEXC
 12

	)

33 
	#PR_FP_EXC_SW_ENABLE
 0x80

	)

34 
	#PR_FP_EXC_DIV
 0x010000

	)

35 
	#PR_FP_EXC_OVF
 0x020000

	)

36 
	#PR_FP_EXC_UND
 0x040000

	)

37 
	#PR_FP_EXC_RES
 0x080000

	)

38 
	#PR_FP_EXC_INV
 0x100000

	)

39 
	#PR_FP_EXC_DISABLED
 0

	)

40 
	#PR_FP_EXC_NONRECOV
 1

	)

41 
	#PR_FP_EXC_ASYNC
 2

	)

42 
	#PR_FP_EXC_PRECISE
 3

	)

46 
	#PR_GET_TIMING
 13

	)

47 
	#PR_SET_TIMING
 14

	)

48 
	#PR_TIMING_STATISTICAL
 0

	)

50 
	#PR_TIMING_TIMESTAMP
 1

	)

53 
	#PR_SET_NAME
 15

	)

54 
	#PR_GET_NAME
 16

	)

57 
	#PR_GET_ENDIAN
 19

	)

58 
	#PR_SET_ENDIAN
 20

	)

59 
	#PR_ENDIAN_BIG
 0

	)

60 
	#PR_ENDIAN_LITTLE
 1

	)

61 
	#PR_ENDIAN_PPC_LITTLE
 2

	)

64 
	#PR_GET_SECCOMP
 21

	)

65 
	#PR_SET_SECCOMP
 22

	)

68 
	#PR_CAPBSET_READ
 23

	)

69 
	#PR_CAPBSET_DROP
 24

	)

72 
	#PR_GET_TSC
 25

	)

73 
	#PR_SET_TSC
 26

	)

74 
	#PR_TSC_ENABLE
 1

	)

75 
	#PR_TSC_SIGSEGV
 2

	)

78 
	#PR_GET_SECUREBITS
 27

	)

79 
	#PR_SET_SECUREBITS
 28

	)

85 
	#PR_SET_TIMERSLACK
 29

	)

86 
	#PR_GET_TIMERSLACK
 30

	)

	@/usr/include/linux/socket.h

1 #iâdeà
_LINUX_SOCKET_H


2 
	#_LINUX_SOCKET_H


	)

7 
	#_K_SS_MAXSIZE
 128

	)

8 
	#_K_SS_ALIGNSIZE
 (
	`__®ignof__
 (
sockaddr
 *))

	)

11 
	s__k”Ãl_sockaddr_¡Üage
 {

12 
	mss_çmy
;

14 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

17 } 
__©Œibu‹__
 ((
®igÃd
(
_K_SS_ALIGNSIZE
)));

19 #ià
defšed
(
__KERNEL__
è|| !defšed(
__GLIBC__
) || (__GLIBC__ < 2)

21 
	~<asm/sock‘.h
>

22 
	~<lšux/sockios.h
>

23 
	~<lšux/uio.h
>

24 
	~<lšux/ty³s.h
>

27 #ifdeà
CONFIG_PROC_FS


28 
	g£q_fe
;

29 
sock‘_£q_show
(
£q_fe
 *
£q
);

32 
	t§_çmy_t
;

38 
	ssockaddr
 {

39 
§_çmy_t
 
	m§_çmy
;

40 
	m§_d©a
[14];

43 
	slšg”
 {

44 
	ml_Úoff
;

45 
	ml_lšg”
;

48 
	#sockaddr_¡Üage
 
__k”Ãl_sockaddr_¡Üage


	)

56 
	smsghdr
 {

57 * 
	mmsg_Çme
;

58 
	mmsg_Çm–’
;

59 
iovec
 * 
	mmsg_iov
;

60 
__k”Ãl_size_t
 
	mmsg_iovËn
;

61 * 
	mmsg_cÚŒŞ
;

62 
__k”Ãl_size_t
 
	mmsg_cÚŒŞËn
;

63 
	mmsg_æags
;

72 
	scmsghdr
 {

73 
__k”Ãl_size_t
 
	mcmsg_Ën
;

74 
	mcmsg_Ëv–
;

75 
	mcmsg_ty³
;

83 
	#__CMSG_NXTHDR
(
ùl
, 
Ën
, 
cmsg
è
	`__cmsg_nxthdr
((ùl),Ö’),(cmsg))

	)

84 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
è
	`cmsg_nxthdr
((mhdr), (cmsg))

	)

86 
	#CMSG_ALIGN
(
Ën
èĞ(Ö’)+()-1è& ~(()-1è)

	)

88 
	#CMSG_DATA
(
cmsg
è((*)((*)(cmsgè+ 
	`CMSG_ALIGN
((
cmsghdr
))))

	)

89 
	#CMSG_SPACE
(
Ën
è(
	`CMSG_ALIGN
((
cmsghdr
)è+ CMSG_ALIGNÖ’))

	)

90 
	#CMSG_LEN
(
Ën
è(
	`CMSG_ALIGN
((
cmsghdr
)è+ (Ën))

	)

92 
	#__CMSG_FIRSTHDR
(
ùl
,
Ën
è(Ö’è>ğ(
cmsghdr
) ? \

93 (
cmsghdr
 *)(
ùl
) : \

94 (
cmsghdr
 *)
NULL
)

	)

95 
	#CMSG_FIRSTHDR
(
msg
è
	`__CMSG_FIRSTHDR
((msg)->
msg_cÚŒŞ
, (msg)->
msg_cÚŒŞËn
)

	)

96 
	#CMSG_OK
(
mhdr
, 
cmsg
è((cmsg)->
cmsg_Ën
 >ğ(
cmsghdr
) && \

97 (
cmsg
)->
cmsg_Ën
 <= () \

98 ((
mhdr
)->
msg_cÚŒŞËn
 - \

99 ((*)(
cmsg
è- (*)(
mhdr
)->
msg_cÚŒŞ
)))

	)

105 #ià 
defšed
(
__GNUC__
)

106 
	#__KINLINE
 
__šlše__


	)

107 #–ià
defšed
(
__ılu¥lus
)

108 
	#__KINLINE
 
šlše


	)

110 
	#__KINLINE
 

	)

127 
__KINLINE
 
cmsghdr
 * 
	$__cmsg_nxthdr
(*
__ùl
, 
__k”Ãl_size_t
 
__size
,

128 
cmsghdr
 *
__cmsg
)

130 
cmsghdr
 * 
__±r
;

132 
__±r
 = (
cmsghdr
*)(((*è
__cmsg
è+ 
	`CMSG_ALIGN
(__cmsg->
cmsg_Ën
));

133 ià(()((*)(
__±r
+1è- (*è
__ùl
è> 
__size
)

134  (
cmsghdr
 *)0;

136  
__±r
;

137 
	}
}

139 
__KINLINE
 
cmsghdr
 * 
	$cmsg_nxthdr
 (
msghdr
 *
__msg
, 
cmsghdr
 *
__cmsg
)

141  
	`__cmsg_nxthdr
(
__msg
->
msg_cÚŒŞ
, __msg->
msg_cÚŒŞËn
, 
__cmsg
);

142 
	}
}

146 
	#SCM_RIGHTS
 0x01

	)

147 
	#SCM_CREDENTIALS
 0x02

	)

148 
	#SCM_SECURITY
 0x03

	)

150 
	suüed
 {

151 
__u32
 
	mpid
;

152 
__u32
 
	muid
;

153 
__u32
 
	mgid
;

157 
	#AF_UNSPEC
 0

	)

158 
	#AF_UNIX
 1

	)

159 
	#AF_LOCAL
 1

	)

160 
	#AF_INET
 2

	)

161 
	#AF_AX25
 3

	)

162 
	#AF_IPX
 4

	)

163 
	#AF_APPLETALK
 5

	)

164 
	#AF_NETROM
 6

	)

165 
	#AF_BRIDGE
 7

	)

166 
	#AF_ATMPVC
 8

	)

167 
	#AF_X25
 9

	)

168 
	#AF_INET6
 10

	)

169 
	#AF_ROSE
 11

	)

170 
	#AF_DECÃt
 12

	)

171 
	#AF_NETBEUI
 13

	)

172 
	#AF_SECURITY
 14

	)

173 
	#AF_KEY
 15

	)

174 
	#AF_NETLINK
 16

	)

175 
	#AF_ROUTE
 
AF_NETLINK


	)

176 
	#AF_PACKET
 17

	)

177 
	#AF_ASH
 18

	)

178 
	#AF_ECONET
 19

	)

179 
	#AF_ATMSVC
 20

	)

180 
	#AF_SNA
 22

	)

181 
	#AF_IRDA
 23

	)

182 
	#AF_PPPOX
 24

	)

183 
	#AF_WANPIPE
 25

	)

184 
	#AF_LLC
 26

	)

185 
	#AF_CAN
 29

	)

186 
	#AF_TIPC
 30

	)

187 
	#AF_BLUETOOTH
 31

	)

188 
	#AF_IUCV
 32

	)

189 
	#AF_RXRPC
 33

	)

190 
	#AF_ISDN
 34

	)

191 
	#AF_PHONET
 35

	)

192 
	#AF_MAX
 36

	)

195 
	#PF_UNSPEC
 
AF_UNSPEC


	)

196 
	#PF_UNIX
 
AF_UNIX


	)

197 
	#PF_LOCAL
 
AF_LOCAL


	)

198 
	#PF_INET
 
AF_INET


	)

199 
	#PF_AX25
 
AF_AX25


	)

200 
	#PF_IPX
 
AF_IPX


	)

201 
	#PF_APPLETALK
 
AF_APPLETALK


	)

202 
	#PF_NETROM
 
AF_NETROM


	)

203 
	#PF_BRIDGE
 
AF_BRIDGE


	)

204 
	#PF_ATMPVC
 
AF_ATMPVC


	)

205 
	#PF_X25
 
AF_X25


	)

206 
	#PF_INET6
 
AF_INET6


	)

207 
	#PF_ROSE
 
AF_ROSE


	)

208 
	#PF_DECÃt
 
AF_DECÃt


	)

209 
	#PF_NETBEUI
 
AF_NETBEUI


	)

210 
	#PF_SECURITY
 
AF_SECURITY


	)

211 
	#PF_KEY
 
AF_KEY


	)

212 
	#PF_NETLINK
 
AF_NETLINK


	)

213 
	#PF_ROUTE
 
AF_ROUTE


	)

214 
	#PF_PACKET
 
AF_PACKET


	)

215 
	#PF_ASH
 
AF_ASH


	)

216 
	#PF_ECONET
 
AF_ECONET


	)

217 
	#PF_ATMSVC
 
AF_ATMSVC


	)

218 
	#PF_SNA
 
AF_SNA


	)

219 
	#PF_IRDA
 
AF_IRDA


	)

220 
	#PF_PPPOX
 
AF_PPPOX


	)

221 
	#PF_WANPIPE
 
AF_WANPIPE


	)

222 
	#PF_LLC
 
AF_LLC


	)

223 
	#PF_CAN
 
AF_CAN


	)

224 
	#PF_TIPC
 
AF_TIPC


	)

225 
	#PF_BLUETOOTH
 
AF_BLUETOOTH


	)

226 
	#PF_IUCV
 
AF_IUCV


	)

227 
	#PF_RXRPC
 
AF_RXRPC


	)

228 
	#PF_ISDN
 
AF_ISDN


	)

229 
	#PF_PHONET
 
AF_PHONET


	)

230 
	#PF_MAX
 
AF_MAX


	)

233 
	#SOMAXCONN
 128

	)

239 
	#MSG_OOB
 1

	)

240 
	#MSG_PEEK
 2

	)

241 
	#MSG_DONTROUTE
 4

	)

242 
	#MSG_TRYHARD
 4

	)

243 
	#MSG_CTRUNC
 8

	)

244 
	#MSG_PROBE
 0x10

	)

245 
	#MSG_TRUNC
 0x20

	)

246 
	#MSG_DONTWAIT
 0x40

	)

247 
	#MSG_EOR
 0x80

	)

248 
	#MSG_WAITALL
 0x100

	)

249 
	#MSG_FIN
 0x200

	)

250 
	#MSG_SYN
 0x400

	)

251 
	#MSG_CONFIRM
 0x800

	)

252 
	#MSG_RST
 0x1000

	)

253 
	#MSG_ERRQUEUE
 0x2000

	)

254 
	#MSG_NOSIGNAL
 0x4000

	)

255 
	#MSG_MORE
 0x8000

	)

257 
	#MSG_EOF
 
MSG_FIN


	)

259 
	#MSG_CMSG_CLOEXEC
 0x40000000

	)

262 #ià
defšed
(
CONFIG_COMPAT
)

263 
	#MSG_CMSG_COMPAT
 0x80000000

	)

265 
	#MSG_CMSG_COMPAT
 0

	)

270 
	#SOL_IP
 0

	)

272 
	#SOL_TCP
 6

	)

273 
	#SOL_UDP
 17

	)

274 
	#SOL_IPV6
 41

	)

275 
	#SOL_ICMPV6
 58

	)

276 
	#SOL_SCTP
 132

	)

277 
	#SOL_UDPLITE
 136

	)

278 
	#SOL_RAW
 255

	)

279 
	#SOL_IPX
 256

	)

280 
	#SOL_AX25
 257

	)

281 
	#SOL_ATALK
 258

	)

282 
	#SOL_NETROM
 259

	)

283 
	#SOL_ROSE
 260

	)

284 
	#SOL_DECNET
 261

	)

285 
	#SOL_X25
 262

	)

286 
	#SOL_PACKET
 263

	)

287 
	#SOL_ATM
 264

	)

288 
	#SOL_AAL
 265

	)

289 
	#SOL_IRDA
 266

	)

290 
	#SOL_NETBEUI
 267

	)

291 
	#SOL_LLC
 268

	)

292 
	#SOL_DCCP
 269

	)

293 
	#SOL_NETLINK
 270

	)

294 
	#SOL_TIPC
 271

	)

295 
	#SOL_RXRPC
 272

	)

296 
	#SOL_PPPOL2TP
 273

	)

297 
	#SOL_BLUETOOTH
 274

	)

298 
	#SOL_PNPIPE
 275

	)

301 
	#IPX_TYPE
 1

	)

	@/usr/include/linux/sysctl.h

25 #iâdeà
_LINUX_SYSCTL_H


26 
	#_LINUX_SYSCTL_H


	)

28 
	~<lšux/k”Ãl.h
>

29 
	~<lšux/ty³s.h
>

32 
	gfe
;

33 
	gcom¶‘iÚ
;

35 
	#CTL_MAXNAME
 10

	)

40 
	s__sysùl_¬gs
 {

41 *
	mÇme
;

42 
	mÆ’
;

43 *
	mŞdv®
;

44 
size_t
 *
	mŞdËÅ
;

45 *
	mÃwv®
;

46 
size_t
 
	mÃwËn
;

47 
	m__unu£d
[4];

58 
	mCTL_KERN
=1,

59 
	mCTL_VM
=2,

60 
	mCTL_NET
=3,

61 
	mCTL_PROC
=4,

62 
	mCTL_FS
=5,

63 
	mCTL_DEBUG
=6,

64 
	mCTL_DEV
=7,

65 
	mCTL_BUS
=8,

66 
	mCTL_ABI
=9,

67 
	mCTL_CPU
=10,

68 
	mCTL_ARLAN
=254,

69 
	mCTL_S390DBF
=5677,

70 
	mCTL_SUNRPC
=7249,

71 
	mCTL_PM
=9899,

72 
	mCTL_FRV
=9898,

78 
	mCTL_BUS_ISA
=1

84 
	mINOTIFY_MAX_USER_INSTANCES
=1,

85 
	mINOTIFY_MAX_USER_WATCHES
=2,

86 
	mINOTIFY_MAX_QUEUED_EVENTS
=3

92 
	mKERN_OSTYPE
=1,

93 
	mKERN_OSRELEASE
=2,

94 
	mKERN_OSREV
=3,

95 
	mKERN_VERSION
=4,

96 
	mKERN_SECUREMASK
=5,

97 
	mKERN_PROF
=6,

98 
	mKERN_NODENAME
=7,

99 
	mKERN_DOMAINNAME
=8,

101 
	mKERN_PANIC
=15,

102 
	mKERN_REALROOTDEV
=16,

104 
	mKERN_SPARC_REBOOT
=21,

105 
	mKERN_CTLALTDEL
=22,

106 
	mKERN_PRINTK
=23,

107 
	mKERN_NAMETRANS
=24,

108 
	mKERN_PPC_HTABRECLAIM
=25,

109 
	mKERN_PPC_ZEROPAGED
=26,

110 
	mKERN_PPC_POWERSAVE_NAP
=27,

111 
	mKERN_MODPROBE
=28,

112 
	mKERN_SG_BIG_BUFF
=29,

113 
	mKERN_ACCT
=30,

114 
	mKERN_PPC_L2CR
=31,

116 
	mKERN_RTSIGNR
=32,

117 
	mKERN_RTSIGMAX
=33,

119 
	mKERN_SHMMAX
=34,

120 
	mKERN_MSGMAX
=35,

121 
	mKERN_MSGMNB
=36,

122 
	mKERN_MSGPOOL
=37,

123 
	mKERN_SYSRQ
=38,

124 
	mKERN_MAX_THREADS
=39,

125 
	mKERN_RANDOM
=40,

126 
	mKERN_SHMALL
=41,

127 
	mKERN_MSGMNI
=42,

128 
	mKERN_SEM
=43,

129 
	mKERN_SPARC_STOP_A
=44,

130 
	mKERN_SHMMNI
=45,

131 
	mKERN_OVERFLOWUID
=46,

132 
	mKERN_OVERFLOWGID
=47,

133 
	mKERN_SHMPATH
=48,

134 
	mKERN_HOTPLUG
=49,

135 
	mKERN_IEEE_EMULATION_WARNINGS
=50,

136 
	mKERN_S390_USER_DEBUG_LOGGING
=51,

137 
	mKERN_CORE_USES_PID
=52,

138 
	mKERN_TAINTED
=53,

139 
	mKERN_CADPID
=54,

140 
	mKERN_PIDMAX
=55,

141 
	mKERN_CORE_PATTERN
=56,

142 
	mKERN_PANIC_ON_OOPS
=57,

143 
	mKERN_HPPA_PWRSW
=58,

144 
	mKERN_HPPA_UNALIGNED
=59,

145 
	mKERN_PRINTK_RATELIMIT
=60,

146 
	mKERN_PRINTK_RATELIMIT_BURST
=61,

147 
	mKERN_PTY
=62,

148 
	mKERN_NGROUPS_MAX
=63,

149 
	mKERN_SPARC_SCONS_PWROFF
=64,

150 
	mKERN_HZ_TIMER
=65,

151 
	mKERN_UNKNOWN_NMI_PANIC
=66,

152 
	mKERN_BOOTLOADER_TYPE
=67,

153 
	mKERN_RANDOMIZE
=68,

154 
	mKERN_SETUID_DUMPABLE
=69,

155 
	mKERN_SPIN_RETRY
=70,

156 
	mKERN_ACPI_VIDEO_FLAGS
=71,

157 
	mKERN_IA64_UNALIGNED
=72,

158 
	mKERN_COMPAT_LOG
=73,

159 
	mKERN_MAX_LOCK_DEPTH
=74,

160 
	mKERN_NMI_WATCHDOG
=75,

161 
	mKERN_PANIC_ON_NMI
=76,

169 
	mVM_UNUSED1
=1,

170 
	mVM_UNUSED2
=2,

171 
	mVM_UNUSED3
=3,

172 
	mVM_UNUSED4
=4,

173 
	mVM_OVERCOMMIT_MEMORY
=5,

174 
	mVM_UNUSED5
=6,

175 
	mVM_UNUSED7
=7,

176 
	mVM_UNUSED8
=8,

177 
	mVM_UNUSED9
=9,

178 
	mVM_PAGE_CLUSTER
=10,

179 
	mVM_DIRTY_BACKGROUND
=11,

180 
	mVM_DIRTY_RATIO
=12,

181 
	mVM_DIRTY_WB_CS
=13,

182 
	mVM_DIRTY_EXPIRE_CS
=14,

183 
	mVM_NR_PDFLUSH_THREADS
=15,

184 
	mVM_OVERCOMMIT_RATIO
=16,

185 
	mVM_PAGEBUF
=17,

186 
	mVM_HUGETLB_PAGES
=18,

187 
	mVM_SWAPPINESS
=19,

188 
	mVM_LOWMEM_RESERVE_RATIO
=20,

189 
	mVM_MIN_FREE_KBYTES
=21,

190 
	mVM_MAX_MAP_COUNT
=22,

191 
	mVM_LAPTOP_MODE
=23,

192 
	mVM_BLOCK_DUMP
=24,

193 
	mVM_HUGETLB_GROUP
=25,

194 
	mVM_VFS_CACHE_PRESSURE
=26,

195 
	mVM_LEGACY_VA_LAYOUT
=27,

196 
	mVM_SWAP_TOKEN_TIMEOUT
=28,

197 
	mVM_DROP_PAGECACHE
=29,

198 
	mVM_PERCPU_PAGELIST_FRACTION
=30,

199 
	mVM_ZONE_RECLAIM_MODE
=31,

200 
	mVM_MIN_UNMAPPED
=32,

201 
	mVM_PANIC_ON_OOM
=33,

202 
	mVM_VDSO_ENABLED
=34,

203 
	mVM_MIN_SLAB
=35,

210 
	mNET_CORE
=1,

211 
	mNET_ETHER
=2,

212 
	mNET_802
=3,

213 
	mNET_UNIX
=4,

214 
	mNET_IPV4
=5,

215 
	mNET_IPX
=6,

216 
	mNET_ATALK
=7,

217 
	mNET_NETROM
=8,

218 
	mNET_AX25
=9,

219 
	mNET_BRIDGE
=10,

220 
	mNET_ROSE
=11,

221 
	mNET_IPV6
=12,

222 
	mNET_X25
=13,

223 
	mNET_TR
=14,

224 
	mNET_DECNET
=15,

225 
	mNET_ECONET
=16,

226 
	mNET_SCTP
=17,

227 
	mNET_LLC
=18,

228 
	mNET_NETFILTER
=19,

229 
	mNET_DCCP
=20,

230 
	mNET_IRDA
=412,

236 
	mRANDOM_POOLSIZE
=1,

237 
	mRANDOM_ENTROPY_COUNT
=2,

238 
	mRANDOM_READ_THRESH
=3,

239 
	mRANDOM_WRITE_THRESH
=4,

240 
	mRANDOM_BOOT_ID
=5,

241 
	mRANDOM_UUID
=6

247 
	mPTY_MAX
=1,

248 
	mPTY_NR
=2

254 
	mBUS_ISA_MEM_BASE
=1,

255 
	mBUS_ISA_PORT_BASE
=2,

256 
	mBUS_ISA_PORT_SHIFT
=3

262 
	mNET_CORE_WMEM_MAX
=1,

263 
	mNET_CORE_RMEM_MAX
=2,

264 
	mNET_CORE_WMEM_DEFAULT
=3,

265 
	mNET_CORE_RMEM_DEFAULT
=4,

267 
	mNET_CORE_MAX_BACKLOG
=6,

268 
	mNET_CORE_FASTROUTE
=7,

269 
	mNET_CORE_MSG_COST
=8,

270 
	mNET_CORE_MSG_BURST
=9,

271 
	mNET_CORE_OPTMEM_MAX
=10,

272 
	mNET_CORE_HOT_LIST_LENGTH
=11,

273 
	mNET_CORE_DIVERT_VERSION
=12,

274 
	mNET_CORE_NO_CONG_THRESH
=13,

275 
	mNET_CORE_NO_CONG
=14,

276 
	mNET_CORE_LO_CONG
=15,

277 
	mNET_CORE_MOD_CONG
=16,

278 
	mNET_CORE_DEV_WEIGHT
=17,

279 
	mNET_CORE_SOMAXCONN
=18,

280 
	mNET_CORE_BUDGET
=19,

281 
	mNET_CORE_AEVENT_ETIME
=20,

282 
	mNET_CORE_AEVENT_RSEQTH
=21,

283 
	mNET_CORE_WARNINGS
=22,

294 
	mNET_UNIX_DESTROY_DELAY
=1,

295 
	mNET_UNIX_DELETE_DELAY
=2,

296 
	mNET_UNIX_MAX_DGRAM_QLEN
=3,

302 
	mNET_NF_CONNTRACK_MAX
=1,

303 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

304 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

305 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

306 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

307 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

308 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

309 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

310 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

311 
	mNET_NF_CONNTRACK_UDP_TIMEOUT
=10,

312 
	mNET_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

313 
	mNET_NF_CONNTRACK_ICMP_TIMEOUT
=12,

314 
	mNET_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

315 
	mNET_NF_CONNTRACK_BUCKETS
=14,

316 
	mNET_NF_CONNTRACK_LOG_INVALID
=15,

317 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

318 
	mNET_NF_CONNTRACK_TCP_LOOSE
=17,

319 
	mNET_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

320 
	mNET_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

321 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

322 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

323 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

324 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

325 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

326 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

327 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

328 
	mNET_NF_CONNTRACK_COUNT
=27,

329 
	mNET_NF_CONNTRACK_ICMPV6_TIMEOUT
=28,

330 
	mNET_NF_CONNTRACK_FRAG6_TIMEOUT
=29,

331 
	mNET_NF_CONNTRACK_FRAG6_LOW_THRESH
=30,

332 
	mNET_NF_CONNTRACK_FRAG6_HIGH_THRESH
=31,

333 
	mNET_NF_CONNTRACK_CHECKSUM
=32,

340 
	mNET_IPV4_FORWARD
=8,

341 
	mNET_IPV4_DYNADDR
=9,

343 
	mNET_IPV4_CONF
=16,

344 
	mNET_IPV4_NEIGH
=17,

345 
	mNET_IPV4_ROUTE
=18,

346 
	mNET_IPV4_FIB_HASH
=19,

347 
	mNET_IPV4_NETFILTER
=20,

349 
	mNET_IPV4_TCP_TIMESTAMPS
=33,

350 
	mNET_IPV4_TCP_WINDOW_SCALING
=34,

351 
	mNET_IPV4_TCP_SACK
=35,

352 
	mNET_IPV4_TCP_RETRANS_COLLAPSE
=36,

353 
	mNET_IPV4_DEFAULT_TTL
=37,

354 
	mNET_IPV4_AUTOCONFIG
=38,

355 
	mNET_IPV4_NO_PMTU_DISC
=39,

356 
	mNET_IPV4_TCP_SYN_RETRIES
=40,

357 
	mNET_IPV4_IPFRAG_HIGH_THRESH
=41,

358 
	mNET_IPV4_IPFRAG_LOW_THRESH
=42,

359 
	mNET_IPV4_IPFRAG_TIME
=43,

360 
	mNET_IPV4_TCP_MAX_KA_PROBES
=44,

361 
	mNET_IPV4_TCP_KEEPALIVE_TIME
=45,

362 
	mNET_IPV4_TCP_KEEPALIVE_PROBES
=46,

363 
	mNET_IPV4_TCP_RETRIES1
=47,

364 
	mNET_IPV4_TCP_RETRIES2
=48,

365 
	mNET_IPV4_TCP_FIN_TIMEOUT
=49,

366 
	mNET_IPV4_IP_MASQ_DEBUG
=50,

367 
	mNET_TCP_SYNCOOKIES
=51,

368 
	mNET_TCP_STDURG
=52,

369 
	mNET_TCP_RFC1337
=53,

370 
	mNET_TCP_SYN_TAILDROP
=54,

371 
	mNET_TCP_MAX_SYN_BACKLOG
=55,

372 
	mNET_IPV4_LOCAL_PORT_RANGE
=56,

373 
	mNET_IPV4_ICMP_ECHO_IGNORE_ALL
=57,

374 
	mNET_IPV4_ICMP_ECHO_IGNORE_BROADCASTS
=58,

375 
	mNET_IPV4_ICMP_SOURCEQUENCH_RATE
=59,

376 
	mNET_IPV4_ICMP_DESTUNREACH_RATE
=60,

377 
	mNET_IPV4_ICMP_TIMEEXCEED_RATE
=61,

378 
	mNET_IPV4_ICMP_PARAMPROB_RATE
=62,

379 
	mNET_IPV4_ICMP_ECHOREPLY_RATE
=63,

380 
	mNET_IPV4_ICMP_IGNORE_BOGUS_ERROR_RESPONSES
=64,

381 
	mNET_IPV4_IGMP_MAX_MEMBERSHIPS
=65,

382 
	mNET_TCP_TW_RECYCLE
=66,

383 
	mNET_IPV4_ALWAYS_DEFRAG
=67,

384 
	mNET_IPV4_TCP_KEEPALIVE_INTVL
=68,

385 
	mNET_IPV4_INET_PEER_THRESHOLD
=69,

386 
	mNET_IPV4_INET_PEER_MINTTL
=70,

387 
	mNET_IPV4_INET_PEER_MAXTTL
=71,

388 
	mNET_IPV4_INET_PEER_GC_MINTIME
=72,

389 
	mNET_IPV4_INET_PEER_GC_MAXTIME
=73,

390 
	mNET_TCP_ORPHAN_RETRIES
=74,

391 
	mNET_TCP_ABORT_ON_OVERFLOW
=75,

392 
	mNET_TCP_SYNACK_RETRIES
=76,

393 
	mNET_TCP_MAX_ORPHANS
=77,

394 
	mNET_TCP_MAX_TW_BUCKETS
=78,

395 
	mNET_TCP_FACK
=79,

396 
	mNET_TCP_REORDERING
=80,

397 
	mNET_TCP_ECN
=81,

398 
	mNET_TCP_DSACK
=82,

399 
	mNET_TCP_MEM
=83,

400 
	mNET_TCP_WMEM
=84,

401 
	mNET_TCP_RMEM
=85,

402 
	mNET_TCP_APP_WIN
=86,

403 
	mNET_TCP_ADV_WIN_SCALE
=87,

404 
	mNET_IPV4_NONLOCAL_BIND
=88,

405 
	mNET_IPV4_ICMP_RATELIMIT
=89,

406 
	mNET_IPV4_ICMP_RATEMASK
=90,

407 
	mNET_TCP_TW_REUSE
=91,

408 
	mNET_TCP_FRTO
=92,

409 
	mNET_TCP_LOW_LATENCY
=93,

410 
	mNET_IPV4_IPFRAG_SECRET_INTERVAL
=94,

411 
	mNET_IPV4_IGMP_MAX_MSF
=96,

412 
	mNET_TCP_NO_METRICS_SAVE
=97,

413 
	mNET_TCP_DEFAULT_WIN_SCALE
=105,

414 
	mNET_TCP_MODERATE_RCVBUF
=106,

415 
	mNET_TCP_TSO_WIN_DIVISOR
=107,

416 
	mNET_TCP_BIC_BETA
=108,

417 
	mNET_IPV4_ICMP_ERRORS_USE_INBOUND_IFADDR
=109,

418 
	mNET_TCP_CONG_CONTROL
=110,

419 
	mNET_TCP_ABC
=111,

420 
	mNET_IPV4_IPFRAG_MAX_DIST
=112,

421 
	mNET_TCP_MTU_PROBING
=113,

422 
	mNET_TCP_BASE_MSS
=114,

423 
	mNET_IPV4_TCP_WORKAROUND_SIGNED_WINDOWS
=115,

424 
	mNET_TCP_DMA_COPYBREAK
=116,

425 
	mNET_TCP_SLOW_START_AFTER_IDLE
=117,

426 
	mNET_CIPSOV4_CACHE_ENABLE
=118,

427 
	mNET_CIPSOV4_CACHE_BUCKET_SIZE
=119,

428 
	mNET_CIPSOV4_RBM_OPTFMT
=120,

429 
	mNET_CIPSOV4_RBM_STRICTVALID
=121,

430 
	mNET_TCP_AVAIL_CONG_CONTROL
=122,

431 
	mNET_TCP_ALLOWED_CONG_CONTROL
=123,

432 
	mNET_TCP_MAX_SSTHRESH
=124,

433 
	mNET_TCP_FRTO_RESPONSE
=125,

437 
	mNET_IPV4_ROUTE_FLUSH
=1,

438 
	mNET_IPV4_ROUTE_MIN_DELAY
=2,

439 
	mNET_IPV4_ROUTE_MAX_DELAY
=3,

440 
	mNET_IPV4_ROUTE_GC_THRESH
=4,

441 
	mNET_IPV4_ROUTE_MAX_SIZE
=5,

442 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL
=6,

443 
	mNET_IPV4_ROUTE_GC_TIMEOUT
=7,

444 
	mNET_IPV4_ROUTE_GC_INTERVAL
=8,

445 
	mNET_IPV4_ROUTE_REDIRECT_LOAD
=9,

446 
	mNET_IPV4_ROUTE_REDIRECT_NUMBER
=10,

447 
	mNET_IPV4_ROUTE_REDIRECT_SILENCE
=11,

448 
	mNET_IPV4_ROUTE_ERROR_COST
=12,

449 
	mNET_IPV4_ROUTE_ERROR_BURST
=13,

450 
	mNET_IPV4_ROUTE_GC_ELASTICITY
=14,

451 
	mNET_IPV4_ROUTE_MTU_EXPIRES
=15,

452 
	mNET_IPV4_ROUTE_MIN_PMTU
=16,

453 
	mNET_IPV4_ROUTE_MIN_ADVMSS
=17,

454 
	mNET_IPV4_ROUTE_SECRET_INTERVAL
=18,

455 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL_MS
=19,

460 
	mNET_PROTO_CONF_ALL
=-2,

461 
	mNET_PROTO_CONF_DEFAULT
=-3

468 
	mNET_IPV4_CONF_FORWARDING
=1,

469 
	mNET_IPV4_CONF_MC_FORWARDING
=2,

470 
	mNET_IPV4_CONF_PROXY_ARP
=3,

471 
	mNET_IPV4_CONF_ACCEPT_REDIRECTS
=4,

472 
	mNET_IPV4_CONF_SECURE_REDIRECTS
=5,

473 
	mNET_IPV4_CONF_SEND_REDIRECTS
=6,

474 
	mNET_IPV4_CONF_SHARED_MEDIA
=7,

475 
	mNET_IPV4_CONF_RP_FILTER
=8,

476 
	mNET_IPV4_CONF_ACCEPT_SOURCE_ROUTE
=9,

477 
	mNET_IPV4_CONF_BOOTP_RELAY
=10,

478 
	mNET_IPV4_CONF_LOG_MARTIANS
=11,

479 
	mNET_IPV4_CONF_TAG
=12,

480 
	mNET_IPV4_CONF_ARPFILTER
=13,

481 
	mNET_IPV4_CONF_MEDIUM_ID
=14,

482 
	mNET_IPV4_CONF_NOXFRM
=15,

483 
	mNET_IPV4_CONF_NOPOLICY
=16,

484 
	mNET_IPV4_CONF_FORCE_IGMP_VERSION
=17,

485 
	mNET_IPV4_CONF_ARP_ANNOUNCE
=18,

486 
	mNET_IPV4_CONF_ARP_IGNORE
=19,

487 
	mNET_IPV4_CONF_PROMOTE_SECONDARIES
=20,

488 
	mNET_IPV4_CONF_ARP_ACCEPT
=21,

489 
	m__NET_IPV4_CONF_MAX


495 
	mNET_IPV4_NF_CONNTRACK_MAX
=1,

496 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

497 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

498 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

499 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

500 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

501 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

502 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

503 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

504 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT
=10,

505 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

506 
	mNET_IPV4_NF_CONNTRACK_ICMP_TIMEOUT
=12,

507 
	mNET_IPV4_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

508 
	mNET_IPV4_NF_CONNTRACK_BUCKETS
=14,

509 
	mNET_IPV4_NF_CONNTRACK_LOG_INVALID
=15,

510 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

511 
	mNET_IPV4_NF_CONNTRACK_TCP_LOOSE
=17,

512 
	mNET_IPV4_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

513 
	mNET_IPV4_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

514 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

515 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

516 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

517 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

518 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

519 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

520 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

521 
	mNET_IPV4_NF_CONNTRACK_COUNT
=27,

522 
	mNET_IPV4_NF_CONNTRACK_CHECKSUM
=28,

527 
	mNET_IPV6_CONF
=16,

528 
	mNET_IPV6_NEIGH
=17,

529 
	mNET_IPV6_ROUTE
=18,

530 
	mNET_IPV6_ICMP
=19,

531 
	mNET_IPV6_BINDV6ONLY
=20,

532 
	mNET_IPV6_IP6FRAG_HIGH_THRESH
=21,

533 
	mNET_IPV6_IP6FRAG_LOW_THRESH
=22,

534 
	mNET_IPV6_IP6FRAG_TIME
=23,

535 
	mNET_IPV6_IP6FRAG_SECRET_INTERVAL
=24,

536 
	mNET_IPV6_MLD_MAX_MSF
=25,

540 
	mNET_IPV6_ROUTE_FLUSH
=1,

541 
	mNET_IPV6_ROUTE_GC_THRESH
=2,

542 
	mNET_IPV6_ROUTE_MAX_SIZE
=3,

543 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL
=4,

544 
	mNET_IPV6_ROUTE_GC_TIMEOUT
=5,

545 
	mNET_IPV6_ROUTE_GC_INTERVAL
=6,

546 
	mNET_IPV6_ROUTE_GC_ELASTICITY
=7,

547 
	mNET_IPV6_ROUTE_MTU_EXPIRES
=8,

548 
	mNET_IPV6_ROUTE_MIN_ADVMSS
=9,

549 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL_MS
=10

553 
	mNET_IPV6_FORWARDING
=1,

554 
	mNET_IPV6_HOP_LIMIT
=2,

555 
	mNET_IPV6_MTU
=3,

556 
	mNET_IPV6_ACCEPT_RA
=4,

557 
	mNET_IPV6_ACCEPT_REDIRECTS
=5,

558 
	mNET_IPV6_AUTOCONF
=6,

559 
	mNET_IPV6_DAD_TRANSMITS
=7,

560 
	mNET_IPV6_RTR_SOLICITS
=8,

561 
	mNET_IPV6_RTR_SOLICIT_INTERVAL
=9,

562 
	mNET_IPV6_RTR_SOLICIT_DELAY
=10,

563 
	mNET_IPV6_USE_TEMPADDR
=11,

564 
	mNET_IPV6_TEMP_VALID_LFT
=12,

565 
	mNET_IPV6_TEMP_PREFERED_LFT
=13,

566 
	mNET_IPV6_REGEN_MAX_RETRY
=14,

567 
	mNET_IPV6_MAX_DESYNC_FACTOR
=15,

568 
	mNET_IPV6_MAX_ADDRESSES
=16,

569 
	mNET_IPV6_FORCE_MLD_VERSION
=17,

570 
	mNET_IPV6_ACCEPT_RA_DEFRTR
=18,

571 
	mNET_IPV6_ACCEPT_RA_PINFO
=19,

572 
	mNET_IPV6_ACCEPT_RA_RTR_PREF
=20,

573 
	mNET_IPV6_RTR_PROBE_INTERVAL
=21,

574 
	mNET_IPV6_ACCEPT_RA_RT_INFO_MAX_PLEN
=22,

575 
	mNET_IPV6_PROXY_NDP
=23,

576 
	mNET_IPV6_ACCEPT_SOURCE_ROUTE
=25,

577 
	m__NET_IPV6_MAX


582 
	mNET_IPV6_ICMP_RATELIMIT
=1

587 
	mNET_NEIGH_MCAST_SOLICIT
=1,

588 
	mNET_NEIGH_UCAST_SOLICIT
=2,

589 
	mNET_NEIGH_APP_SOLICIT
=3,

590 
	mNET_NEIGH_RETRANS_TIME
=4,

591 
	mNET_NEIGH_REACHABLE_TIME
=5,

592 
	mNET_NEIGH_DELAY_PROBE_TIME
=6,

593 
	mNET_NEIGH_GC_STALE_TIME
=7,

594 
	mNET_NEIGH_UNRES_QLEN
=8,

595 
	mNET_NEIGH_PROXY_QLEN
=9,

596 
	mNET_NEIGH_ANYCAST_DELAY
=10,

597 
	mNET_NEIGH_PROXY_DELAY
=11,

598 
	mNET_NEIGH_LOCKTIME
=12,

599 
	mNET_NEIGH_GC_INTERVAL
=13,

600 
	mNET_NEIGH_GC_THRESH1
=14,

601 
	mNET_NEIGH_GC_THRESH2
=15,

602 
	mNET_NEIGH_GC_THRESH3
=16,

603 
	mNET_NEIGH_RETRANS_TIME_MS
=17,

604 
	mNET_NEIGH_REACHABLE_TIME_MS
=18,

605 
	m__NET_NEIGH_MAX


610 
	mNET_DCCP_DEFAULT
=1,

615 
	mNET_IPX_PPROP_BROADCASTING
=1,

616 
	mNET_IPX_FORWARDING
=2

621 
	mNET_LLC2
=1,

622 
	mNET_LLC_STATION
=2,

627 
	mNET_LLC2_TIMEOUT
=1,

632 
	mNET_LLC_STATION_ACK_TIMEOUT
=1,

637 
	mNET_LLC2_ACK_TIMEOUT
=1,

638 
	mNET_LLC2_P_TIMEOUT
=2,

639 
	mNET_LLC2_REJ_TIMEOUT
=3,

640 
	mNET_LLC2_BUSY_TIMEOUT
=4,

645 
	mNET_ATALK_AARP_EXPIRY_TIME
=1,

646 
	mNET_ATALK_AARP_TICK_TIME
=2,

647 
	mNET_ATALK_AARP_RETRANSMIT_LIMIT
=3,

648 
	mNET_ATALK_AARP_RESOLVE_TIME
=4

654 
	mNET_NETROM_DEFAULT_PATH_QUALITY
=1,

655 
	mNET_NETROM_OBSOLESCENCE_COUNT_INITIALISER
=2,

656 
	mNET_NETROM_NETWORK_TTL_INITIALISER
=3,

657 
	mNET_NETROM_TRANSPORT_TIMEOUT
=4,

658 
	mNET_NETROM_TRANSPORT_MAXIMUM_TRIES
=5,

659 
	mNET_NETROM_TRANSPORT_ACKNOWLEDGE_DELAY
=6,

660 
	mNET_NETROM_TRANSPORT_BUSY_DELAY
=7,

661 
	mNET_NETROM_TRANSPORT_REQUESTED_WINDOW_SIZE
=8,

662 
	mNET_NETROM_TRANSPORT_NO_ACTIVITY_TIMEOUT
=9,

663 
	mNET_NETROM_ROUTING_CONTROL
=10,

664 
	mNET_NETROM_LINK_FAILS_COUNT
=11,

665 
	mNET_NETROM_RESET
=12

670 
	mNET_AX25_IP_DEFAULT_MODE
=1,

671 
	mNET_AX25_DEFAULT_MODE
=2,

672 
	mNET_AX25_BACKOFF_TYPE
=3,

673 
	mNET_AX25_CONNECT_MODE
=4,

674 
	mNET_AX25_STANDARD_WINDOW
=5,

675 
	mNET_AX25_EXTENDED_WINDOW
=6,

676 
	mNET_AX25_T1_TIMEOUT
=7,

677 
	mNET_AX25_T2_TIMEOUT
=8,

678 
	mNET_AX25_T3_TIMEOUT
=9,

679 
	mNET_AX25_IDLE_TIMEOUT
=10,

680 
	mNET_AX25_N2
=11,

681 
	mNET_AX25_PACLEN
=12,

682 
	mNET_AX25_PROTOCOL
=13,

683 
	mNET_AX25_DAMA_SLAVE_TIMEOUT
=14

688 
	mNET_ROSE_RESTART_REQUEST_TIMEOUT
=1,

689 
	mNET_ROSE_CALL_REQUEST_TIMEOUT
=2,

690 
	mNET_ROSE_RESET_REQUEST_TIMEOUT
=3,

691 
	mNET_ROSE_CLEAR_REQUEST_TIMEOUT
=4,

692 
	mNET_ROSE_ACK_HOLD_BACK_TIMEOUT
=5,

693 
	mNET_ROSE_ROUTING_CONTROL
=6,

694 
	mNET_ROSE_LINK_FAIL_TIMEOUT
=7,

695 
	mNET_ROSE_MAX_VCS
=8,

696 
	mNET_ROSE_WINDOW_SIZE
=9,

697 
	mNET_ROSE_NO_ACTIVITY_TIMEOUT
=10

702 
	mNET_X25_RESTART_REQUEST_TIMEOUT
=1,

703 
	mNET_X25_CALL_REQUEST_TIMEOUT
=2,

704 
	mNET_X25_RESET_REQUEST_TIMEOUT
=3,

705 
	mNET_X25_CLEAR_REQUEST_TIMEOUT
=4,

706 
	mNET_X25_ACK_HOLD_BACK_TIMEOUT
=5,

707 
	mNET_X25_FORWARD
=6

713 
	mNET_TR_RIF_TIMEOUT
=1

718 
	mNET_DECNET_NODE_TYPE
 = 1,

719 
	mNET_DECNET_NODE_ADDRESS
 = 2,

720 
	mNET_DECNET_NODE_NAME
 = 3,

721 
	mNET_DECNET_DEFAULT_DEVICE
 = 4,

722 
	mNET_DECNET_TIME_WAIT
 = 5,

723 
	mNET_DECNET_DN_COUNT
 = 6,

724 
	mNET_DECNET_DI_COUNT
 = 7,

725 
	mNET_DECNET_DR_COUNT
 = 8,

726 
	mNET_DECNET_DST_GC_INTERVAL
 = 9,

727 
	mNET_DECNET_CONF
 = 10,

728 
	mNET_DECNET_NO_FC_MAX_CWND
 = 11,

729 
	mNET_DECNET_MEM
 = 12,

730 
	mNET_DECNET_RMEM
 = 13,

731 
	mNET_DECNET_WMEM
 = 14,

732 
	mNET_DECNET_DEBUG_LEVEL
 = 255

737 
	mNET_DECNET_CONF_LOOPBACK
 = -2,

738 
	mNET_DECNET_CONF_DDCMP
 = -3,

739 
	mNET_DECNET_CONF_PPP
 = -4,

740 
	mNET_DECNET_CONF_X25
 = -5,

741 
	mNET_DECNET_CONF_GRE
 = -6,

742 
	mNET_DECNET_CONF_ETHER
 = -7

749 
	mNET_DECNET_CONF_DEV_PRIORITY
 = 1,

750 
	mNET_DECNET_CONF_DEV_T1
 = 2,

751 
	mNET_DECNET_CONF_DEV_T2
 = 3,

752 
	mNET_DECNET_CONF_DEV_T3
 = 4,

753 
	mNET_DECNET_CONF_DEV_FORWARDING
 = 5,

754 
	mNET_DECNET_CONF_DEV_BLKSIZE
 = 6,

755 
	mNET_DECNET_CONF_DEV_STATE
 = 7

760 
	mNET_SCTP_RTO_INITIAL
 = 1,

761 
	mNET_SCTP_RTO_MIN
 = 2,

762 
	mNET_SCTP_RTO_MAX
 = 3,

763 
	mNET_SCTP_RTO_ALPHA
 = 4,

764 
	mNET_SCTP_RTO_BETA
 = 5,

765 
	mNET_SCTP_VALID_COOKIE_LIFE
 = 6,

766 
	mNET_SCTP_ASSOCIATION_MAX_RETRANS
 = 7,

767 
	mNET_SCTP_PATH_MAX_RETRANS
 = 8,

768 
	mNET_SCTP_MAX_INIT_RETRANSMITS
 = 9,

769 
	mNET_SCTP_HB_INTERVAL
 = 10,

770 
	mNET_SCTP_PRESERVE_ENABLE
 = 11,

771 
	mNET_SCTP_MAX_BURST
 = 12,

772 
	mNET_SCTP_ADDIP_ENABLE
 = 13,

773 
	mNET_SCTP_PRSCTP_ENABLE
 = 14,

774 
	mNET_SCTP_SNDBUF_POLICY
 = 15,

775 
	mNET_SCTP_SACK_TIMEOUT
 = 16,

776 
	mNET_SCTP_RCVBUF_POLICY
 = 17,

781 
	mNET_BRIDGE_NF_CALL_ARPTABLES
 = 1,

782 
	mNET_BRIDGE_NF_CALL_IPTABLES
 = 2,

783 
	mNET_BRIDGE_NF_CALL_IP6TABLES
 = 3,

784 
	mNET_BRIDGE_NF_FILTER_VLAN_TAGGED
 = 4,

785 
	mNET_BRIDGE_NF_FILTER_PPPOE_TAGGED
 = 5,

790 
	mNET_IRDA_DISCOVERY
=1,

791 
	mNET_IRDA_DEVNAME
=2,

792 
	mNET_IRDA_DEBUG
=3,

793 
	mNET_IRDA_FAST_POLL
=4,

794 
	mNET_IRDA_DISCOVERY_SLOTS
=5,

795 
	mNET_IRDA_DISCOVERY_TIMEOUT
=6,

796 
	mNET_IRDA_SLOT_TIMEOUT
=7,

797 
	mNET_IRDA_MAX_BAUD_RATE
=8,

798 
	mNET_IRDA_MIN_TX_TURN_TIME
=9,

799 
	mNET_IRDA_MAX_TX_DATA_SIZE
=10,

800 
	mNET_IRDA_MAX_TX_WINDOW
=11,

801 
	mNET_IRDA_MAX_NOREPLY_TIME
=12,

802 
	mNET_IRDA_WARN_NOREPLY_TIME
=13,

803 
	mNET_IRDA_LAP_KEEPALIVE_TIME
=14,

810 
	mFS_NRINODE
=1,

811 
	mFS_STATINODE
=2,

812 
	mFS_MAXINODE
=3,

813 
	mFS_NRDQUOT
=4,

814 
	mFS_MAXDQUOT
=5,

815 
	mFS_NRFILE
=6,

816 
	mFS_MAXFILE
=7,

817 
	mFS_DENTRY
=8,

818 
	mFS_NRSUPER
=9,

819 
	mFS_MAXSUPER
=10,

820 
	mFS_OVERFLOWUID
=11,

821 
	mFS_OVERFLOWGID
=12,

822 
	mFS_LEASES
=13,

823 
	mFS_DIR_NOTIFY
=14,

824 
	mFS_LEASE_TIME
=15,

825 
	mFS_DQSTATS
=16,

826 
	mFS_XFS
=17,

827 
	mFS_AIO_NR
=18,

828 
	mFS_AIO_MAX_NR
=19,

829 
	mFS_INOTIFY
=20,

830 
	mFS_OCFS2
=988,

835 
	mFS_DQ_LOOKUPS
 = 1,

836 
	mFS_DQ_DROPS
 = 2,

837 
	mFS_DQ_READS
 = 3,

838 
	mFS_DQ_WRITES
 = 4,

839 
	mFS_DQ_CACHE_HITS
 = 5,

840 
	mFS_DQ_ALLOCATED
 = 6,

841 
	mFS_DQ_FREE
 = 7,

842 
	mFS_DQ_SYNCS
 = 8,

843 
	mFS_DQ_WARNINGS
 = 9,

850 
	mDEV_CDROM
=1,

851 
	mDEV_HWMON
=2,

852 
	mDEV_PARPORT
=3,

853 
	mDEV_RAID
=4,

854 
	mDEV_MAC_HID
=5,

855 
	mDEV_SCSI
=6,

856 
	mDEV_IPMI
=7,

861 
	mDEV_CDROM_INFO
=1,

862 
	mDEV_CDROM_AUTOCLOSE
=2,

863 
	mDEV_CDROM_AUTOEJECT
=3,

864 
	mDEV_CDROM_DEBUG
=4,

865 
	mDEV_CDROM_LOCK
=5,

866 
	mDEV_CDROM_CHECK_MEDIA
=6

871 
	mDEV_PARPORT_DEFAULT
=-3

876 
	mDEV_RAID_SPEED_LIMIT_MIN
=1,

877 
	mDEV_RAID_SPEED_LIMIT_MAX
=2

882 
	mDEV_PARPORT_DEFAULT_TIMESLICE
=1,

883 
	mDEV_PARPORT_DEFAULT_SPINTIME
=2

888 
	mDEV_PARPORT_SPINTIME
=1,

889 
	mDEV_PARPORT_BASE_ADDR
=2,

890 
	mDEV_PARPORT_IRQ
=3,

891 
	mDEV_PARPORT_DMA
=4,

892 
	mDEV_PARPORT_MODES
=5,

893 
	mDEV_PARPORT_DEVICES
=6,

894 
	mDEV_PARPORT_AUTOPROBE
=16

899 
	mDEV_PARPORT_DEVICES_ACTIVE
=-3,

904 
	mDEV_PARPORT_DEVICE_TIMESLICE
=1,

909 
	mDEV_MAC_HID_KEYBOARD_SENDS_LINUX_KEYCODES
=1,

910 
	mDEV_MAC_HID_KEYBOARD_LOCK_KEYCODES
=2,

911 
	mDEV_MAC_HID_MOUSE_BUTTON_EMULATION
=3,

912 
	mDEV_MAC_HID_MOUSE_BUTTON2_KEYCODE
=4,

913 
	mDEV_MAC_HID_MOUSE_BUTTON3_KEYCODE
=5,

914 
	mDEV_MAC_HID_ADB_MOUSE_SENDS_KEYCODES
=6

919 
	mDEV_SCSI_LOGGING_LEVEL
=1,

924 
	mDEV_IPMI_POWEROFF_POWERCYCLE
=1,

930 
	mABI_DEFHANDLER_COFF
=1,

931 
	mABI_DEFHANDLER_ELF
=2,

932 
	mABI_DEFHANDLER_LCALL7
=3,

933 
	mABI_DEFHANDLER_LIBCSO
=4,

934 
	mABI_TRACE
=5,

935 
	mABI_FAKE_UTSNAME
=6,

	@/usr/include/locale.h

23 #iâdef 
_LOCALE_H


24 
	#_LOCALE_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	#__Ãed_NULL


	)

29 
	~<¡ddef.h
>

30 
	~<b™s/loÿË.h
>

32 
	g__BEGIN_DECLS


36 
	#LC_CTYPE
 
__LC_CTYPE


	)

37 
	#LC_NUMERIC
 
__LC_NUMERIC


	)

38 
	#LC_TIME
 
__LC_TIME


	)

39 
	#LC_COLLATE
 
__LC_COLLATE


	)

40 
	#LC_MONETARY
 
__LC_MONETARY


	)

41 
	#LC_MESSAGES
 
__LC_MESSAGES


	)

42 
	#LC_ALL
 
__LC_ALL


	)

43 
	#LC_PAPER
 
__LC_PAPER


	)

44 
	#LC_NAME
 
__LC_NAME


	)

45 
	#LC_ADDRESS
 
__LC_ADDRESS


	)

46 
	#LC_TELEPHONE
 
__LC_TELEPHONE


	)

47 
	#LC_MEASUREMENT
 
__LC_MEASUREMENT


	)

48 
	#LC_IDENTIFICATION
 
__LC_IDENTIFICATION


	)

51 
__BEGIN_NAMESPACE_STD


54 
	slcÚv


58 *
	mdecim®_pošt
;

59 *
	mthou§nds_£p
;

65 *
	mgroupšg
;

71 *
	mšt_cu¼_symbŞ
;

72 *
	mcu¼’cy_symbŞ
;

73 *
	mmÚ_decim®_pošt
;

74 *
	mmÚ_thou§nds_£p
;

75 *
	mmÚ_groupšg
;

76 *
	mpos™ive_sign
;

77 *
	mÃg©ive_sign
;

78 
	mšt_äac_dig™s
;

79 
	mäac_dig™s
;

81 
	mp_cs_´eûdes
;

83 
	mp_£p_by_¥aû
;

85 
	mn_cs_´eûdes
;

87 
	mn_£p_by_¥aû
;

94 
	mp_sign_po¢
;

95 
	mn_sign_po¢
;

96 #ifdeà
__USE_ISOC99


98 
	mšt_p_cs_´eûdes
;

100 
	mšt_p_£p_by_¥aû
;

102 
	mšt_n_cs_´eûdes
;

104 
	mšt_n_£p_by_¥aû
;

111 
	mšt_p_sign_po¢
;

112 
	mšt_n_sign_po¢
;

114 
	m__št_p_cs_´eûdes
;

115 
	m__št_p_£p_by_¥aû
;

116 
	m__št_n_cs_´eûdes
;

117 
	m__št_n_£p_by_¥aû
;

118 
	m__št_p_sign_po¢
;

119 
	m__št_n_sign_po¢
;

125 *
	$£oÿË
 (
__ÿ‹gÜy
, 
__cÚ¡
 *
__loÿË
è
__THROW
;

128 
lcÚv
 *
	$loÿËcÚv
 (è
__THROW
;

130 
__END_NAMESPACE_STD


133 #ifdef 
__USE_GNU


146 
	~<xloÿË.h
>

148 
__loÿË_t
 
	tloÿË_t
;

154 
__loÿË_t
 
	$ÃwloÿË
 (
__ÿ‹gÜy_mask
, 
__cÚ¡
 *
__loÿË
,

155 
__loÿË_t
 
__ba£
è
__THROW
;

161 
	#LC_CTYPE_MASK
 (1 << 
__LC_CTYPE
)

	)

162 
	#LC_NUMERIC_MASK
 (1 << 
__LC_NUMERIC
)

	)

163 
	#LC_TIME_MASK
 (1 << 
__LC_TIME
)

	)

164 
	#LC_COLLATE_MASK
 (1 << 
__LC_COLLATE
)

	)

165 
	#LC_MONETARY_MASK
 (1 << 
__LC_MONETARY
)

	)

166 
	#LC_MESSAGES_MASK
 (1 << 
__LC_MESSAGES
)

	)

167 
	#LC_PAPER_MASK
 (1 << 
__LC_PAPER
)

	)

168 
	#LC_NAME_MASK
 (1 << 
__LC_NAME
)

	)

169 
	#LC_ADDRESS_MASK
 (1 << 
__LC_ADDRESS
)

	)

170 
	#LC_TELEPHONE_MASK
 (1 << 
__LC_TELEPHONE
)

	)

171 
	#LC_MEASUREMENT_MASK
 (1 << 
__LC_MEASUREMENT
)

	)

172 
	#LC_IDENTIFICATION_MASK
 (1 << 
__LC_IDENTIFICATION
)

	)

173 
	#LC_ALL_MASK
 (
LC_CTYPE_MASK
 \

174 | 
LC_NUMERIC_MASK
 \

175 | 
LC_TIME_MASK
 \

176 | 
LC_COLLATE_MASK
 \

177 | 
LC_MONETARY_MASK
 \

178 | 
LC_MESSAGES_MASK
 \

179 | 
LC_PAPER_MASK
 \

180 | 
LC_NAME_MASK
 \

181 | 
LC_ADDRESS_MASK
 \

182 | 
LC_TELEPHONE_MASK
 \

183 | 
LC_MEASUREMENT_MASK
 \

184 | 
LC_IDENTIFICATION_MASK
 \

185 )

	)

189 
__loÿË_t
 
	$du¶oÿË
 (
__loÿË_t
 
__d©a£t
è
__THROW
;

193 
	$ä“loÿË
 (
__loÿË_t
 
__d©a£t
è
__THROW
;

200 
__loÿË_t
 
	$u£loÿË
 (
__loÿË_t
 
__d©a£t
è
__THROW
;

204 
	#LC_GLOBAL_LOCALE
 ((
__loÿË_t
è-1L)

	)

208 
__END_DECLS


	@/usr/include/paths.h

32 #iâdeà
_PATHS_H_


33 
	#_PATHS_H_


	)

36 
	#_PATH_DEFPATH
 "/u¤/bš:/bš"

	)

38 
	#_PATH_STDPATH
 \

39 "/u¤/bš:/bš:/u¤/sbš:/sbš"

	)

41 
	#_PATH_BSHELL
 "/bš/sh"

	)

42 
	#_PATH_CONSOLE
 "/dev/cÚsŞe"

	)

43 
	#_PATH_CSHELL
 "/bš/csh"

	)

44 
	#_PATH_DEVDB
 "/v¬/run/dev.db"

	)

45 
	#_PATH_DEVNULL
 "/dev/nuÎ"

	)

46 
	#_PATH_DRUM
 "/dev/drum"

	)

47 
	#_PATH_KLOG
 "/´oc/kmsg"

	)

48 
	#_PATH_KMEM
 "/dev/kmem"

	)

49 
	#_PATH_LASTLOG
 "/v¬/log/Ï¡log"

	)

50 
	#_PATH_MAILDIR
 "/v¬/ma"

	)

51 
	#_PATH_MAN
 "/u¤/sh¬e/mª"

	)

52 
	#_PATH_MEM
 "/dev/mem"

	)

53 
	#_PATH_MNTTAB
 "/‘c/f¡ab"

	)

54 
	#_PATH_MOUNTED
 "/‘c/mb"

	)

55 
	#_PATH_NOLOGIN
 "/‘c/nŞogš"

	)

56 
	#_PATH_PRESERVE
 "/v¬/lib"

	)

57 
	#_PATH_RWHODIR
 "/v¬/¥oŞ/rwho"

	)

58 
	#_PATH_SENDMAIL
 "/u¤/sbš/£ndma"

	)

59 
	#_PATH_SHADOW
 "/‘c/shadow"

	)

60 
	#_PATH_SHELLS
 "/‘c/sh–ls"

	)

61 
	#_PATH_TTY
 "/dev/‰y"

	)

62 
	#_PATH_UNIX
 "/boÙ/vmlšux"

	)

63 
	#_PATH_UTMP
 "/v¬/run/utmp"

	)

64 
	#_PATH_VI
 "/u¤/bš/vi"

	)

65 
	#_PATH_WTMP
 "/v¬/log/wtmp"

	)

68 
	#_PATH_DEV
 "/dev/"

	)

69 
	#_PATH_TMP
 "/tmp/"

	)

70 
	#_PATH_VARDB
 "/v¬/lib/misc/"

	)

71 
	#_PATH_VARRUN
 "/v¬/run/"

	)

72 
	#_PATH_VARTMP
 "/v¬/tmp/"

	)

	@/usr/include/sys/cdefs.h

20 #iâdef 
_SYS_CDEFS_H


21 
	#_SYS_CDEFS_H
 1

	)

24 #iâdeà
_FEATURES_H


25 
	~<ã©u»s.h
>

31 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


36 #undeà
__P


37 #undeà
__PMT


39 #ifdeà
__GNUC__


46 #ià!
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (3, 3)

47 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

48 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
)è
	)
fct

50 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

51 
	#__THROW
 
	`throw
 ()

	)

52 
	#__NTH
(
fù
èfù 
	`throw
 ()

	)

54 
	#__THROW


	)

55 
	#__NTH
(
fù
è
	)
fct

61 
	#__šlše


	)

63 
	#__THROW


	)

64 
	#__NTH
(
fù
è
	)
fct

66 
	#__cÚ¡
 cÚ¡

	)

67 
	#__sigÃd
 sigÃd

	)

68 
	#__vŞ©e
 vŞ©e

	)

74 
	#__P
(
¬gs
è
	)
args

75 
	#__PMT
(
¬gs
è
	)
args

80 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

81 
	#__STRING
(
x
è#x

	)

84 
	#__±r_t
 *

	)

85 
	#__lÚg_doubË_t
 

	)

89 #ifdef 
__ılu¥lus


90 
	#__BEGIN_DECLS
 "C" {

	)

91 
	#__END_DECLS
 }

	)

93 
	#__BEGIN_DECLS


	)

94 
	#__END_DECLS


	)

103 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES


104 
	#__BEGIN_NAMESPACE_STD
 
Çme¥aû
 
¡d
 {

	)

105 
	#__END_NAMESPACE_STD
 }

	)

106 
	#__USING_NAMESPACE_STD
(
Çme
è
usšg
 
¡d
::Çme;

	)

107 
	#__BEGIN_NAMESPACE_C99
 
Çme¥aû
 
__c99
 {

	)

108 
	#__END_NAMESPACE_C99
 }

	)

109 
	#__USING_NAMESPACE_C99
(
Çme
è
usšg
 
__c99
::Çme;

	)

114 
	#__BEGIN_NAMESPACE_STD


	)

115 
	#__END_NAMESPACE_STD


	)

116 
	#__USING_NAMESPACE_STD
(
Çme
)

	)

117 
	#__BEGIN_NAMESPACE_C99


	)

118 
	#__END_NAMESPACE_C99


	)

119 
	#__USING_NAMESPACE_C99
(
Çme
)

	)

124 #iâdeà
__BOUNDED_POINTERS__


125 
	#__bounded


	)

126 
	#__unbounded


	)

127 
	#__±rv®ue


	)

132 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

133 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

135 #ià
__GNUC_PREREQ
 (4,3)

136 
	#__w¬ndeş
(
Çme
, 
msg
) \

137 
	`Çme
 (è
	`__©Œibu‹__
((
	`__w¬nšg__
 (
msg
)))

	)

138 
	#__w¬Ç‰r
(
msg
è
	`__©Œibu‹__
((
	`__w¬nšg__
 (msg)))

	)

139 
	#__”rÜdeş
(
Çme
, 
msg
) \

140 
	`Çme
 (è
	`__©Œibu‹__
((
	`__”rÜ__
 (
msg
)))

	)

142 
	#__w¬ndeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

143 
	#__w¬Ç‰r
(
msg
)

	)

144 
	#__”rÜdeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

148 #ià
__GNUC_PREREQ
 (2,97)

150 
	#__æex¬r
 []

	)

152 #ifdeà
__GNUC__


153 
	#__æex¬r
 [0]

	)

155 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

156 
	#__æex¬r
 []

	)

159 
	#__æex¬r
 [1]

	)

175 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

177 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

178 #ifdeà
__ılu¥lus


179 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

180 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

182 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

183 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

185 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

186 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

199 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

200 
	#__©Œibu‹__
(
xyz
è

	)

206 #ià
__GNUC_PREREQ
 (2,96)

207 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

209 
	#__©Œibu‹_m®loc__


	)

215 #ià
__GNUC_PREREQ
 (2,96)

216 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

218 
	#__©Œibu‹_pu»__


	)

224 #ià
__GNUC_PREREQ
 (3,1)

225 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

226 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

228 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

229 
	#__©Œibu‹_nošlše__


	)

233 #ià
__GNUC_PREREQ
 (3,2)

234 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

236 
	#__©Œibu‹_d•»ÿ‹d__


	)

245 #ià
__GNUC_PREREQ
 (2,8)

246 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

248 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

255 #ià
__GNUC_PREREQ
 (2,97)

256 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

257 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

259 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

264 #ià
__GNUC_PREREQ
 (3,3)

265 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

267 
	#__nÚnuÎ
(
·¿ms
)

	)

272 #ià
__GNUC_PREREQ
 (3,4)

273 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

274 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

275 #ià
__USE_FORTIFY_LEVEL
 > 0

276 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

279 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

281 #iâdeà
__wur


282 
	#__wur


	)

286 #ià
__GNUC_PREREQ
 (3,2)

287 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

289 
	#__®ways_šlše
 
__šlše


	)

294 #ià!
defšed
 
__ılu¥lus
 || 
__GNUC_PREREQ
 (4,3)

295 #ià
defšed
 
__GNUC_STDC_INLINE__
 || defšed 
__ılu¥lus


296 
	#__ex‹º_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

297 #ià
__GNUC_PREREQ
 (4,3)

298 
	#__ex‹º_®ways_šlše
 \

299 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
, 
__¬tificŸl__
))

	)

301 
	#__ex‹º_®ways_šlše
 \

302 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

305 
	#__ex‹º_šlše
 
__šlše


	)

306 
	#__ex‹º_®ways_šlše
 
__®ways_šlše


	)

312 #ià
__GNUC_PREREQ
 (4,3)

313 
	#__va_¬g_·ck
(è
	`__butš_va_¬g_·ck
 ()

	)

314 
	#__va_¬g_·ck_Ën
(è
	`__butš_va_¬g_·ck_Ën
 ()

	)

321 #ià!
__GNUC_PREREQ
 (2,8)

322 
	#__ex‹nsiÚ__


	)

326 #ià!
__GNUC_PREREQ
 (2,92)

327 
	#__»¡riù


	)

333 #ià
__GNUC_PREREQ
 (3,1è&& !
defšed
 
__GNUG__


334 
	#__»¡riù_¬r
 
__»¡riù


	)

336 #ifdeà
__GNUC__


337 
	#__»¡riù_¬r


	)

339 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

340 
	#__»¡riù_¬r
 
»¡riù


	)

343 
	#__»¡riù_¬r


	)

348 
	~<b™s/wÜdsize.h
>

350 #ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


351 
	#__LDBL_COMPAT
 1

	)

352 #ifdeà
__REDIRECT


353 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

354 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

355 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

356 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

357 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

358 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

359 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

360 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

361 
	#__LDBL_REDIR_DECL
(
Çme
) \

362 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

363 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

364 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

365 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

366 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

369 #ià!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT


370 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

371 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

372 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

373 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

374 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

375 #ifdeà
__REDIRECT


376 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

377 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

378 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

	@/usr/include/sys/select.h

22 #iâdeà
_SYS_SELECT_H


23 
	#_SYS_SELECT_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	~<b™s/ty³s.h
>

31 
	~<b™s/£Ëù.h
>

34 
	~<b™s/sig£t.h
>

36 #iâdeà
__sig£t_t_defšed


37 
	#__sig£t_t_defšed


	)

38 
__sig£t_t
 
	tsig£t_t
;

42 
	#__Ãed_time_t


	)

43 
	#__Ãed_time¥ec


	)

44 
	~<time.h
>

45 
	#__Ãed_timev®


	)

46 
	~<b™s/time.h
>

48 #iâdeà
__su£cÚds_t_defšed


49 
__su£cÚds_t
 
	tsu£cÚds_t
;

50 
	#__su£cÚds_t_defšed


	)

55 
	t__fd_mask
;

58 #undeà
__NFDBITS


59 #undeà
__FDELT


60 #undeà
__FDMASK


62 
	#__NFDBITS
 (8 *  (
__fd_mask
))

	)

63 
	#__FDELT
(
d
è((dè/ 
__NFDBITS
)

	)

64 
	#__FDMASK
(
d
è((
__fd_mask
è1 << ((dè% 
__NFDBITS
))

	)

71 #ifdeà
__USE_XOPEN


72 
__fd_mask
 
	mfds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

73 
	#__FDS_BITS
(
£t
è((£t)->
fds_b™s
)

	)

75 
__fd_mask
 
	m__fds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

76 
	#__FDS_BITS
(
£t
è((£t)->
__fds_b™s
)

	)

78 } 
	tfd_£t
;

81 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

83 #ifdeà
__USE_MISC


85 
__fd_mask
 
	tfd_mask
;

88 
	#NFDBITS
 
__NFDBITS


	)

93 
	#FD_SET
(
fd
, 
fd£
è
	`__FD_SET
 (fd, fd£)

	)

94 
	#FD_CLR
(
fd
, 
fd£
è
	`__FD_CLR
 (fd, fd£)

	)

95 
	#FD_ISSET
(
fd
, 
fd£
è
	`__FD_ISSET
 (fd, fd£)

	)

96 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
 (fd£)

	)

99 
__BEGIN_DECLS


109 
£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

110 
fd_£t
 *
__»¡riù
 
__wr™efds
,

111 
fd_£t
 *
__»¡riù
 
__exû±fds
,

112 
timev®
 *
__»¡riù
 
__timeout
);

114 #ifdeà
__USE_XOPEN2K


121 
p£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

122 
fd_£t
 *
__»¡riù
 
__wr™efds
,

123 
fd_£t
 *
__»¡riù
 
__exû±fds
,

124 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
,

125 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__sigmask
);

128 
	g__END_DECLS


	@/usr/include/sys/syslog.h

32 #iâdeà
_SYS_SYSLOG_H


33 
	#_SYS_SYSLOG_H
 1

	)

35 
	~<ã©u»s.h
>

36 
	#__Ãed___va_li¡


	)

37 
	~<¡d¬g.h
>

40 
	~<b™s/sy¦og-·th.h
>

51 
	#LOG_EMERG
 0

	)

52 
	#LOG_ALERT
 1

	)

53 
	#LOG_CRIT
 2

	)

54 
	#LOG_ERR
 3

	)

55 
	#LOG_WARNING
 4

	)

56 
	#LOG_NOTICE
 5

	)

57 
	#LOG_INFO
 6

	)

58 
	#LOG_DEBUG
 7

	)

60 
	#LOG_PRIMASK
 0x07

	)

62 
	#LOG_PRI
(
p
è(Õè& 
LOG_PRIMASK
)

	)

63 
	#LOG_MAKEPRI
(
çc
, 
´i
è(((çcè<< 3è| (´i))

	)

65 #ifdeà
SYSLOG_NAMES


66 
	#INTERNAL_NOPRI
 0x10

	)

68 
	#INTERNAL_MARK
 
	`LOG_MAKEPRI
(
LOG_NFACILITIES
, 0)

	)

69 
	s_code
 {

70 *
	mc_Çme
;

71 
	mc_v®
;

72 } 
	tCODE
;

74 
CODE
 
	g´iÜ™yÇmes
[] =

76 { "®”t", 
LOG_ALERT
 },

77 { "ü™", 
LOG_CRIT
 },

78 { "debug", 
LOG_DEBUG
 },

79 { "em”g", 
LOG_EMERG
 },

80 { "”r", 
LOG_ERR
 },

81 { "”rÜ", 
LOG_ERR
 },

82 { "šfo", 
LOG_INFO
 },

83 { "nÚe", 
INTERNAL_NOPRI
 },

84 { "nÙiû", 
LOG_NOTICE
 },

85 { "·nic", 
LOG_EMERG
 },

86 { "w¬n", 
LOG_WARNING
 },

87 { "w¬nšg", 
LOG_WARNING
 },

88 { 
NULL
, -1 }

93 
	#LOG_KERN
 (0<<3è

	)

94 
	#LOG_USER
 (1<<3è

	)

95 
	#LOG_MAIL
 (2<<3è

	)

96 
	#LOG_DAEMON
 (3<<3è

	)

97 
	#LOG_AUTH
 (4<<3è

	)

98 
	#LOG_SYSLOG
 (5<<3è

	)

99 
	#LOG_LPR
 (6<<3è

	)

100 
	#LOG_NEWS
 (7<<3è

	)

101 
	#LOG_UUCP
 (8<<3è

	)

102 
	#LOG_CRON
 (9<<3è

	)

103 
	#LOG_AUTHPRIV
 (10<<3è

	)

104 
	#LOG_FTP
 (11<<3è

	)

107 
	#LOG_LOCAL0
 (16<<3è

	)

108 
	#LOG_LOCAL1
 (17<<3è

	)

109 
	#LOG_LOCAL2
 (18<<3è

	)

110 
	#LOG_LOCAL3
 (19<<3è

	)

111 
	#LOG_LOCAL4
 (20<<3è

	)

112 
	#LOG_LOCAL5
 (21<<3è

	)

113 
	#LOG_LOCAL6
 (22<<3è

	)

114 
	#LOG_LOCAL7
 (23<<3è

	)

116 
	#LOG_NFACILITIES
 24

	)

117 
	#LOG_FACMASK
 0x03f8

	)

119 
	#LOG_FAC
(
p
è((Õè& 
LOG_FACMASK
è>> 3)

	)

121 #ifdeà
SYSLOG_NAMES


122 
CODE
 
	gçc™yÇmes
[] =

124 { "auth", 
LOG_AUTH
 },

125 { "auth´iv", 
LOG_AUTHPRIV
 },

126 { "üÚ", 
LOG_CRON
 },

127 { "d«mÚ", 
LOG_DAEMON
 },

128 { "áp", 
LOG_FTP
 },

129 { "k”n", 
LOG_KERN
 },

130 { "Ír", 
LOG_LPR
 },

131 { "ma", 
LOG_MAIL
 },

132 { "m¬k", 
INTERNAL_MARK
 },

133 { "Ãws", 
LOG_NEWS
 },

134 { "£cur™y", 
LOG_AUTH
 },

135 { "sy¦og", 
LOG_SYSLOG
 },

136 { "u£r", 
LOG_USER
 },

137 { "uuı", 
LOG_UUCP
 },

138 { "loÿl0", 
LOG_LOCAL0
 },

139 { "loÿl1", 
LOG_LOCAL1
 },

140 { "loÿl2", 
LOG_LOCAL2
 },

141 { "loÿl3", 
LOG_LOCAL3
 },

142 { "loÿl4", 
LOG_LOCAL4
 },

143 { "loÿl5", 
LOG_LOCAL5
 },

144 { "loÿl6", 
LOG_LOCAL6
 },

145 { "loÿl7", 
LOG_LOCAL7
 },

146 { 
NULL
, -1 }

153 
	#LOG_MASK
(
´i
è(1 << (´i)è

	)

154 
	#LOG_UPTO
(
´i
è((1 << (Õri)+1)è- 1è

	)

162 
	#LOG_PID
 0x01

	)

163 
	#LOG_CONS
 0x02

	)

164 
	#LOG_ODELAY
 0x04

	)

165 
	#LOG_NDELAY
 0x08

	)

166 
	#LOG_NOWAIT
 0x10

	)

167 
	#LOG_PERROR
 0x20

	)

169 
__BEGIN_DECLS


175 
şo£log
 ();

181 
İ’log
 (
__cÚ¡
 *
__id’t
, 
__İtiÚ
, 
__çc™y
);

184 
	$£ogmask
 (
__mask
è
__THROW
;

190 
	$sy¦og
 (
__´i
, 
__cÚ¡
 *
__fmt
, ...)

191 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

193 #ifdeà
__USE_BSD


200 
	$vsy¦og
 (
__´i
, 
__cÚ¡
 *
__fmt
, 
__gnuc_va_li¡
 
__­
)

201 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

206 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


207 
	~<b™s/sy¦og.h
>

209 #ifdeà
__LDBL_COMPAT


210 
	~<b™s/sy¦og-ldbl.h
>

213 
__END_DECLS


	@/usr/include/sys/sysmacros.h

21 #iâdeà
_SYS_SYSMACROS_H


22 
	#_SYS_SYSMACROS_H
 1

	)

24 
	~<ã©u»s.h
>

29 #ifdeà
__GLIBC_HAVE_LONG_LONG


30 
__ex‹nsiÚ__


31 
	$gnu_dev_majÜ
 (
__dev
)

32 
__THROW
;

33 
__ex‹nsiÚ__


34 
	$gnu_dev_mšÜ
 (
__dev
)

35 
__THROW
;

36 
__ex‹nsiÚ__


37 
	$gnu_dev_makedev
 (
__majÜ
,

38 
__mšÜ
)

39 
__THROW
;

41 #ià
defšed
 
__GNUC__
 && __GNUC__ >ğ2 && defšed 
__USE_EXTERN_INLINES


42 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

43 
	`__NTH
 (
	$gnu_dev_majÜ
 (
__dev
))

45  ((
__dev
 >> 8) & 0xfff) | (() (__dev >> 32) & ~0xfff);

46 
	}
}

48 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

49 
__NTH
 (
	$gnu_dev_mšÜ
 (
__dev
))

51  (
__dev
 & 0xff) | (() (__dev >> 12) & ~0xff);

52 
	}
}

54 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

55 
__NTH
 (
	$gnu_dev_makedev
 (
__majÜ
, 
__mšÜ
))

57  ((
__mšÜ
 & 0xffè| ((
__majÜ
 & 0xfff) << 8)

58 | (((è(
__mšÜ
 & ~0xff)) << 12)

59 | (((è(
__majÜ
 & ~0xfff)) << 32));

60 
	}
}

65 
	#majÜ
(
dev
è
	`gnu_dev_majÜ
 (dev)

	)

66 
	#mšÜ
(
dev
è
	`gnu_dev_mšÜ
 (dev)

	)

67 
	#makedev
(
maj
, 
mš
è
	`gnu_dev_makedev
 (maj, mš)

	)

	@/usr/include/sys/ttydefaults.h

40 #iâdeà
_SYS_TTYDEFAULTS_H_


41 
	#_SYS_TTYDEFAULTS_H_


	)

46 
	#TTYDEF_IFLAG
 (
BRKINT
 | 
ISTRIP
 | 
ICRNL
 | 
IMAXBEL
 | 
IXON
 | 
IXANY
)

	)

47 
	#TTYDEF_OFLAG
 (
OPOST
 | 
ONLCR
 | 
XTABS
)

	)

48 
	#TTYDEF_LFLAG
 (
ECHO
 | 
ICANON
 | 
ISIG
 | 
IEXTEN
 | 
ECHOE
|
ECHOKE
|
ECHOCTL
)

	)

49 
	#TTYDEF_CFLAG
 (
CREAD
 | 
CS7
 | 
PARENB
 | 
HUPCL
)

	)

50 
	#TTYDEF_SPEED
 (
B9600
)

	)

55 
	#CTRL
(
x
è(x&037)

	)

56 
	#CEOF
 
	`CTRL
('d')

	)

57 #ifdeà
_POSIX_VDISABLE


58 
	#CEOL
 
_POSIX_VDISABLE


	)

60 
	#CEOL
 '\0'

	)

62 
	#CERASE
 0177

	)

63 
	#CINTR
 
	`CTRL
('c')

	)

64 #ifdeà
_POSIX_VDISABLE


65 
	#CSTATUS
 
_POSIX_VDISABLE


	)

67 
	#CSTATUS
 '\0'

	)

69 
	#CKILL
 
	`CTRL
('u')

	)

70 
	#CMIN
 1

	)

71 
	#CQUIT
 034

	)

72 
	#CSUSP
 
	`CTRL
('z')

	)

73 
	#CTIME
 0

	)

74 
	#CDSUSP
 
	`CTRL
('y')

	)

75 
	#CSTART
 
	`CTRL
('q')

	)

76 
	#CSTOP
 
	`CTRL
('s')

	)

77 
	#CLNEXT
 
	`CTRL
('v')

	)

78 
	#CDISCARD
 
	`CTRL
('o')

	)

79 
	#CWERASE
 
	`CTRL
('w')

	)

80 
	#CREPRINT
 
	`CTRL
('r')

	)

81 
	#CEOT
 
CEOF


	)

83 
	#CBRK
 
CEOL


	)

84 
	#CRPRNT
 
CREPRINT


	)

85 
	#CFLUSH
 
CDISCARD


	)

93 #ifdeà
TTYDEFCHARS


94 
cc_t
 
	g‰ydefch¬s
[
NCCS
] = {

95 
CEOF
, 
CEOL
, CEOL, 
CERASE
, 
CWERASE
, 
CKILL
, 
CREPRINT
,

96 
_POSIX_VDISABLE
, 
CINTR
, 
CQUIT
, 
CSUSP
, 
CDSUSP
, 
CSTART
, 
CSTOP
, 
CLNEXT
,

97 
CDISCARD
, 
CMIN
, 
CTIME
, 
CSTATUS
, 
_POSIX_VDISABLE


99 #undeà
TTYDEFCHARS


	@/usr/include/sys/ucontext.h

19 #iâdeà
_SYS_UCONTEXT_H


20 
	#_SYS_UCONTEXT_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<sigÇl.h
>

24 
	~<b™s/wÜdsize.h
>

28 
	~<b™s/sigcÚ‹xt.h
>

30 #ià
__WORDSIZE
 == 64

33 
	tg»g_t
;

36 
	#NGREG
 23

	)

39 
g»g_t
 
	tg»g£t_t
[
NGREG
];

41 #ifdeà
__USE_GNU


45 
	mREG_R8
 = 0,

46 
	#REG_R8
 
REG_R8


	)

47 
	mREG_R9
,

48 
	#REG_R9
 
REG_R9


	)

49 
	mREG_R10
,

50 
	#REG_R10
 
REG_R10


	)

51 
	mREG_R11
,

52 
	#REG_R11
 
REG_R11


	)

53 
	mREG_R12
,

54 
	#REG_R12
 
REG_R12


	)

55 
	mREG_R13
,

56 
	#REG_R13
 
REG_R13


	)

57 
	mREG_R14
,

58 
	#REG_R14
 
REG_R14


	)

59 
	mREG_R15
,

60 
	#REG_R15
 
REG_R15


	)

61 
	mREG_RDI
,

62 
	#REG_RDI
 
REG_RDI


	)

63 
	mREG_RSI
,

64 
	#REG_RSI
 
REG_RSI


	)

65 
	mREG_RBP
,

66 
	#REG_RBP
 
REG_RBP


	)

67 
	mREG_RBX
,

68 
	#REG_RBX
 
REG_RBX


	)

69 
	mREG_RDX
,

70 
	#REG_RDX
 
REG_RDX


	)

71 
	mREG_RAX
,

72 
	#REG_RAX
 
REG_RAX


	)

73 
	mREG_RCX
,

74 
	#REG_RCX
 
REG_RCX


	)

75 
	mREG_RSP
,

76 
	#REG_RSP
 
REG_RSP


	)

77 
	mREG_RIP
,

78 
	#REG_RIP
 
REG_RIP


	)

79 
	mREG_EFL
,

80 
	#REG_EFL
 
REG_EFL


	)

81 
	mREG_CSGSFS
,

82 
	#REG_CSGSFS
 
REG_CSGSFS


	)

83 
	mREG_ERR
,

84 
	#REG_ERR
 
REG_ERR


	)

85 
	mREG_TRAPNO
,

86 
	#REG_TRAPNO
 
REG_TRAPNO


	)

87 
	mREG_OLDMASK
,

88 
	#REG_OLDMASK
 
REG_OLDMASK


	)

89 
	mREG_CR2


90 
	#REG_CR2
 
REG_CR2


	)

94 
	s_libc_åx»g


96 
	msignifiÿnd
[4];

97 
	mexpÚ’t
;

98 
	m·ddšg
[3];

101 
	s_libc_xmm»g


103 
__ušt32_t
 
	m–em’t
[4];

106 
	s_libc_å¡©e


109 
__ušt16_t
 
	mcwd
;

110 
__ušt16_t
 
	mswd
;

111 
__ušt16_t
 
	máw
;

112 
__ušt16_t
 
	mfİ
;

113 
__ušt64_t
 
	mr
;

114 
__ušt64_t
 
	mrdp
;

115 
__ušt32_t
 
	mmxc¤
;

116 
__ušt32_t
 
	mmxü_mask
;

117 
_libc_åx»g
 
	m_¡
[8];

118 
_libc_xmm»g
 
	m_xmm
[16];

119 
__ušt32_t
 
	m·ddšg
[24];

123 
_libc_å¡©e
 *
	tå»g£t_t
;

128 
g»g£t_t
 
	mg»gs
;

130 
å»g£t_t
 
	må»gs
;

131 
	m__»£rved1
 [8];

132 } 
	tmcÚ‹xt_t
;

135 
	sucÚ‹xt


137 
	muc_æags
;

138 
ucÚ‹xt
 *
	muc_lšk
;

139 
¡ack_t
 
	muc_¡ack
;

140 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

141 
__sig£t_t
 
	muc_sigmask
;

142 
_libc_å¡©e
 
	m__å»gs_mem
;

143 } 
	tucÚ‹xt_t
;

148 
	tg»g_t
;

151 
	#NGREG
 19

	)

154 
g»g_t
 
	tg»g£t_t
[
NGREG
];

156 #ifdeà
__USE_GNU


160 
	mREG_GS
 = 0,

161 
	#REG_GS
 
REG_GS


	)

162 
	mREG_FS
,

163 
	#REG_FS
 
REG_FS


	)

164 
	mREG_ES
,

165 
	#REG_ES
 
REG_ES


	)

166 
	mREG_DS
,

167 
	#REG_DS
 
REG_DS


	)

168 
	mREG_EDI
,

169 
	#REG_EDI
 
REG_EDI


	)

170 
	mREG_ESI
,

171 
	#REG_ESI
 
REG_ESI


	)

172 
	mREG_EBP
,

173 
	#REG_EBP
 
REG_EBP


	)

174 
	mREG_ESP
,

175 
	#REG_ESP
 
REG_ESP


	)

176 
	mREG_EBX
,

177 
	#REG_EBX
 
REG_EBX


	)

178 
	mREG_EDX
,

179 
	#REG_EDX
 
REG_EDX


	)

180 
	mREG_ECX
,

181 
	#REG_ECX
 
REG_ECX


	)

182 
	mREG_EAX
,

183 
	#REG_EAX
 
REG_EAX


	)

184 
	mREG_TRAPNO
,

185 
	#REG_TRAPNO
 
REG_TRAPNO


	)

186 
	mREG_ERR
,

187 
	#REG_ERR
 
REG_ERR


	)

188 
	mREG_EIP
,

189 
	#REG_EIP
 
REG_EIP


	)

190 
	mREG_CS
,

191 
	#REG_CS
 
REG_CS


	)

192 
	mREG_EFL
,

193 
	#REG_EFL
 
REG_EFL


	)

194 
	mREG_UESP
,

195 
	#REG_UESP
 
REG_UESP


	)

196 
	mREG_SS


197 
	#REG_SS
 
REG_SS


	)

202 
	s_libc_å»g


204 
	msignifiÿnd
[4];

205 
	mexpÚ’t
;

208 
	s_libc_å¡©e


210 
	mcw
;

211 
	msw
;

212 
	mg
;

213 
	moff
;

214 
	mcs£l
;

215 
	md©aoff
;

216 
	md©a£l
;

217 
_libc_å»g
 
	m_¡
[8];

218 
	m¡©us
;

222 
_libc_å¡©e
 *
	tå»g£t_t
;

227 
g»g£t_t
 
	mg»gs
;

230 
å»g£t_t
 
	må»gs
;

231 
	mŞdmask
;

232 
	mü2
;

233 } 
	tmcÚ‹xt_t
;

236 
	sucÚ‹xt


238 
	muc_æags
;

239 
ucÚ‹xt
 *
	muc_lšk
;

240 
¡ack_t
 
	muc_¡ack
;

241 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

242 
__sig£t_t
 
	muc_sigmask
;

243 
_libc_å¡©e
 
	m__å»gs_mem
;

244 } 
	tucÚ‹xt_t
;

	@/usr/include/sys/uio.h

19 #iâdeà
_SYS_UIO_H


20 
	#_SYS_UIO_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	~<sys/ty³s.h
>

26 
	g__BEGIN_DECLS


29 
	~<b™s/uio.h
>

40 
ssize_t
 
»adv
 (
__fd
, 
__cÚ¡
 
iovec
 *
__iovec
, 
__couÁ
);

50 
ssize_t
 
wr™ev
 (
__fd
, 
__cÚ¡
 
iovec
 *
__iovec
, 
__couÁ
);

52 
	g__END_DECLS


	@/usr/include/xlocale.h

21 #iâdeà
_XLOCALE_H


22 
	#_XLOCALE_H
 1

	)

28 
	s__loÿË_¡ruù


31 
loÿË_d©a
 *
	m__loÿËs
[13];

34 cÚ¡ *
	m__ùy³_b
;

35 cÚ¡ *
	m__ùy³_tŞow”
;

36 cÚ¡ *
	m__ùy³_touµ”
;

39 cÚ¡ *
	m__Çmes
[13];

40 } *
	t__loÿË_t
;

	@/usr/include/_G_config.h

4 #iâdeà
_G_cÚfig_h


5 
	#_G_cÚfig_h
 1

	)

9 
	~<b™s/ty³s.h
>

10 
	#__Ãed_size_t


	)

11 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


12 
	#__Ãed_wch¬_t


	)

14 
	#__Ãed_NULL


	)

15 
	~<¡ddef.h
>

16 
	#__Ãed_mb¡©e_t


	)

17 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


18 
	#__Ãed_wšt_t


	)

20 
	~<wch¬.h
>

21 
	#_G_size_t
 
size_t


	)

24 
__off_t
 
	m__pos
;

25 
__mb¡©e_t
 
	m__¡©e
;

26 } 
	t_G_åos_t
;

29 
__off64_t
 
	m__pos
;

30 
__mb¡©e_t
 
	m__¡©e
;

31 } 
	t_G_åos64_t
;

32 
	#_G_ssize_t
 
__ssize_t


	)

33 
	#_G_off_t
 
__off_t


	)

34 
	#_G_off64_t
 
__off64_t


	)

35 
	#_G_pid_t
 
__pid_t


	)

36 
	#_G_uid_t
 
__uid_t


	)

37 
	#_G_wch¬_t
 
wch¬_t


	)

38 
	#_G_wšt_t
 
wšt_t


	)

39 
	#_G_¡©64
 
¡©64


	)

40 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


41 
	~<gcÚv.h
>

44 
__gcÚv_šfo
 
	m__cd
;

47 
__gcÚv_šfo
 
	m__cd
;

48 
__gcÚv_¡•_d©a
 
	m__d©a
;

49 } 
	m__combšed
;

50 } 
	t_G_icÚv_t
;

53 
	t_G_št16_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__HI__
)));

54 
	t_G_št32_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__SI__
)));

55 
	t_G_ušt16_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__HI__
)));

56 
	t_G_ušt32_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__SI__
)));

58 
	#_G_HAVE_BOOL
 1

	)

62 
	#_G_HAVE_ATEXIT
 1

	)

63 
	#_G_HAVE_SYS_CDEFS
 1

	)

64 
	#_G_HAVE_SYS_WAIT
 1

	)

65 
	#_G_NEED_STDARG_H
 1

	)

66 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

68 
	#_G_HAVE_PRINTF_FP
 1

	)

69 
	#_G_HAVE_MMAP
 1

	)

70 
	#_G_HAVE_MREMAP
 1

	)

71 
	#_G_HAVE_LONG_DOUBLE_IO
 1

	)

72 
	#_G_HAVE_IO_FILE_OPEN
 1

	)

73 
	#_G_HAVE_IO_GETLINE_INFO
 1

	)

75 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

77 
	#_G_OPEN64
 
__İ’64


	)

78 
	#_G_LSEEK64
 
__l£ek64


	)

79 
	#_G_MMAP64
 
__mm­64


	)

80 
	#_G_FSTAT64
(
fd
,
buf
è
	`__fx¡©64
 (
_STAT_VER
, fd, buf)

	)

83 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

85 
	#_G_BUFSIZ
 8192

	)

88 
	#_G_NAMES_HAVE_UNDERSCORE
 0

	)

89 
	#_G_VTABLE_LABEL_HAS_LENGTH
 1

	)

90 
	#_G_USING_THUNKS
 1

	)

91 
	#_G_VTABLE_LABEL_PREFIX
 "__vt_"

	)

92 
	#_G_VTABLE_LABEL_PREFIX_ID
 
__vt_


	)

95 #ià
defšed
 
__ılu¥lus
 || defšed 
__STDC__


96 
	#_G_ARGS
(
ARGLIST
è
	)
ARGLIST

98 
	#_G_ARGS
(
ARGLIST
è()

	)

	@/usr/include/asm/ioctl.h

1 
	~<asm-g’”ic/ioùl.h
>

	@/usr/include/asm/ioctls.h

1 #iâdeà
_ASM_X86_IOCTLS_H


2 
	#_ASM_X86_IOCTLS_H


	)

4 
	~<asm/ioùl.h
>

8 
	#TCGETS
 0x5401

	)

9 
	#TCSETS
 0x5402

	)

10 
	#TCSETSW
 0x5403

	)

11 
	#TCSETSF
 0x5404

	)

12 
	#TCGETA
 0x5405

	)

13 
	#TCSETA
 0x5406

	)

14 
	#TCSETAW
 0x5407

	)

15 
	#TCSETAF
 0x5408

	)

16 
	#TCSBRK
 0x5409

	)

17 
	#TCXONC
 0x540A

	)

18 
	#TCFLSH
 0x540B

	)

19 
	#TIOCEXCL
 0x540C

	)

20 
	#TIOCNXCL
 0x540D

	)

21 
	#TIOCSCTTY
 0x540E

	)

22 
	#TIOCGPGRP
 0x540F

	)

23 
	#TIOCSPGRP
 0x5410

	)

24 
	#TIOCOUTQ
 0x5411

	)

25 
	#TIOCSTI
 0x5412

	)

26 
	#TIOCGWINSZ
 0x5413

	)

27 
	#TIOCSWINSZ
 0x5414

	)

28 
	#TIOCMGET
 0x5415

	)

29 
	#TIOCMBIS
 0x5416

	)

30 
	#TIOCMBIC
 0x5417

	)

31 
	#TIOCMSET
 0x5418

	)

32 
	#TIOCGSOFTCAR
 0x5419

	)

33 
	#TIOCSSOFTCAR
 0x541A

	)

34 
	#FIONREAD
 0x541B

	)

35 
	#TIOCINQ
 
FIONREAD


	)

36 
	#TIOCLINUX
 0x541C

	)

37 
	#TIOCCONS
 0x541D

	)

38 
	#TIOCGSERIAL
 0x541E

	)

39 
	#TIOCSSERIAL
 0x541F

	)

40 
	#TIOCPKT
 0x5420

	)

41 
	#FIONBIO
 0x5421

	)

42 
	#TIOCNOTTY
 0x5422

	)

43 
	#TIOCSETD
 0x5423

	)

44 
	#TIOCGETD
 0x5424

	)

45 
	#TCSBRKP
 0x5425

	)

47 
	#TIOCSBRK
 0x5427

	)

48 
	#TIOCCBRK
 0x5428

	)

49 
	#TIOCGSID
 0x5429

	)

50 
	#TCGETS2
 
	`_IOR
('T', 0x2A, 
‹rmios2
)

	)

51 
	#TCSETS2
 
	`_IOW
('T', 0x2B, 
‹rmios2
)

	)

52 
	#TCSETSW2
 
	`_IOW
('T', 0x2C, 
‹rmios2
)

	)

53 
	#TCSETSF2
 
	`_IOW
('T', 0x2D, 
‹rmios2
)

	)

54 
	#TIOCGRS485
 0x542E

	)

55 
	#TIOCSRS485
 0x542F

	)

56 
	#TIOCGPTN
 
	`_IOR
('T', 0x30, )

	)

58 
	#TIOCSPTLCK
 
	`_IOW
('T', 0x31, è

	)

59 
	#TCGETX
 0x5432

	)

60 
	#TCSETX
 0x5433

	)

61 
	#TCSETXF
 0x5434

	)

62 
	#TCSETXW
 0x5435

	)

64 
	#FIONCLEX
 0x5450

	)

65 
	#FIOCLEX
 0x5451

	)

66 
	#FIOASYNC
 0x5452

	)

67 
	#TIOCSERCONFIG
 0x5453

	)

68 
	#TIOCSERGWILD
 0x5454

	)

69 
	#TIOCSERSWILD
 0x5455

	)

70 
	#TIOCGLCKTRMIOS
 0x5456

	)

71 
	#TIOCSLCKTRMIOS
 0x5457

	)

72 
	#TIOCSERGSTRUCT
 0x5458

	)

73 
	#TIOCSERGETLSR
 0x5459

	)

74 
	#TIOCSERGETMULTI
 0x545A

	)

75 
	#TIOCSERSETMULTI
 0x545B

	)

77 
	#TIOCMIWAIT
 0x545C

	)

78 
	#TIOCGICOUNT
 0x545D

	)

79 
	#TIOCGHAYESESP
 0x545E

	)

80 
	#TIOCSHAYESESP
 0x545F

	)

81 
	#FIOQSIZE
 0x5460

	)

84 
	#TIOCPKT_DATA
 0

	)

85 
	#TIOCPKT_FLUSHREAD
 1

	)

86 
	#TIOCPKT_FLUSHWRITE
 2

	)

87 
	#TIOCPKT_STOP
 4

	)

88 
	#TIOCPKT_START
 8

	)

89 
	#TIOCPKT_NOSTOP
 16

	)

90 
	#TIOCPKT_DOSTOP
 32

	)

92 
	#TIOCSER_TEMT
 0x01

	)

	@/usr/include/asm/param.h

1 #iâdeà
_ASM_X86_PARAM_H


2 
	#_ASM_X86_PARAM_H


	)

5 #iâdeà
HZ


6 
	#HZ
 100

	)

9 
	#EXEC_PAGESIZE
 4096

	)

11 #iâdeà
NOGROUP


12 
	#NOGROUP
 (-1)

	)

15 
	#MAXHOSTNAMELEN
 64

	)

	@/usr/include/asm/posix_types.h

1 #ifdeà
__i386__


2 
	~"posix_ty³s_32.h
"

4 
	~"posix_ty³s_64.h
"

	@/usr/include/asm/socket.h

1 #iâdeà
_ASM_X86_SOCKET_H


2 
	#_ASM_X86_SOCKET_H


	)

4 
	~<asm/sockios.h
>

7 
	#SOL_SOCKET
 1

	)

9 
	#SO_DEBUG
 1

	)

10 
	#SO_REUSEADDR
 2

	)

11 
	#SO_TYPE
 3

	)

12 
	#SO_ERROR
 4

	)

13 
	#SO_DONTROUTE
 5

	)

14 
	#SO_BROADCAST
 6

	)

15 
	#SO_SNDBUF
 7

	)

16 
	#SO_RCVBUF
 8

	)

17 
	#SO_SNDBUFFORCE
 32

	)

18 
	#SO_RCVBUFFORCE
 33

	)

19 
	#SO_KEEPALIVE
 9

	)

20 
	#SO_OOBINLINE
 10

	)

21 
	#SO_NO_CHECK
 11

	)

22 
	#SO_PRIORITY
 12

	)

23 
	#SO_LINGER
 13

	)

24 
	#SO_BSDCOMPAT
 14

	)

26 
	#SO_PASSCRED
 16

	)

27 
	#SO_PEERCRED
 17

	)

28 
	#SO_RCVLOWAT
 18

	)

29 
	#SO_SNDLOWAT
 19

	)

30 
	#SO_RCVTIMEO
 20

	)

31 
	#SO_SNDTIMEO
 21

	)

34 
	#SO_SECURITY_AUTHENTICATION
 22

	)

35 
	#SO_SECURITY_ENCRYPTION_TRANSPORT
 23

	)

36 
	#SO_SECURITY_ENCRYPTION_NETWORK
 24

	)

38 
	#SO_BINDTODEVICE
 25

	)

41 
	#SO_ATTACH_FILTER
 26

	)

42 
	#SO_DETACH_FILTER
 27

	)

44 
	#SO_PEERNAME
 28

	)

45 
	#SO_TIMESTAMP
 29

	)

46 
	#SCM_TIMESTAMP
 
SO_TIMESTAMP


	)

48 
	#SO_ACCEPTCONN
 30

	)

50 
	#SO_PEERSEC
 31

	)

51 
	#SO_PASSSEC
 34

	)

52 
	#SO_TIMESTAMPNS
 35

	)

53 
	#SCM_TIMESTAMPNS
 
SO_TIMESTAMPNS


	)

55 
	#SO_MARK
 36

	)

	@/usr/include/bits/endian.h

3 #iâdeà
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/libio-ldbl.h

20 #iâdeà
_IO_STDIO_H


24 
	$__LDBL_REDIR_DECL
 (
_IO_vfsÿnf
)

25 
	`__LDBL_REDIR_DECL
 (
_IO_vårštf
)

	@/usr/include/bits/local_lim.h

25 #iâdeà
NR_OPEN


26 
	#__undef_NR_OPEN


	)

28 #iâdeà
LINK_MAX


29 
	#__undef_LINK_MAX


	)

31 #iâdeà
OPEN_MAX


32 
	#__undef_OPEN_MAX


	)

34 #iâdeà
ARG_MAX


35 
	#__undef_ARG_MAX


	)

39 
	~<lšux/lim™s.h
>

42 #ifdeà
__undef_NR_OPEN


43 #undeà
NR_OPEN


44 #undeà
__undef_NR_OPEN


47 #ifdeà
__undef_LINK_MAX


48 #undeà
LINK_MAX


49 #undeà
__undef_LINK_MAX


52 #ifdeà
__undef_OPEN_MAX


53 #undeà
OPEN_MAX


54 #undeà
__undef_OPEN_MAX


57 #ifdeà
__undef_ARG_MAX


58 #undeà
ARG_MAX


59 #undeà
__undef_ARG_MAX


63 
	#_POSIX_THREAD_KEYS_MAX
 128

	)

65 
	#PTHREAD_KEYS_MAX
 1024

	)

68 
	#_POSIX_THREAD_DESTRUCTOR_ITERATIONS
 4

	)

70 
	#PTHREAD_DESTRUCTOR_ITERATIONS
 
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


	)

73 
	#_POSIX_THREAD_THREADS_MAX
 64

	)

75 #undeà
PTHREAD_THREADS_MAX


79 
	#AIO_PRIO_DELTA_MAX
 20

	)

82 
	#PTHREAD_STACK_MIN
 16384

	)

85 
	#DELAYTIMER_MAX
 2147483647

	)

88 
	#TTY_NAME_MAX
 32

	)

91 
	#LOGIN_NAME_MAX
 256

	)

94 
	#HOST_NAME_MAX
 64

	)

97 
	#MQ_PRIO_MAX
 32768

	)

100 
	#SEM_VALUE_MAX
 (2147483647)

	)

	@/usr/include/bits/locale.h

20 #ià!
defšed
 
_LOCALE_H
 && !defšed 
_LANGINFO_H


24 #iâdeà
_BITS_LOCALE_H


25 
	#_BITS_LOCALE_H
 1

	)

29 
	m__LC_CTYPE
 = 0,

30 
	m__LC_NUMERIC
 = 1,

31 
	m__LC_TIME
 = 2,

32 
	m__LC_COLLATE
 = 3,

33 
	m__LC_MONETARY
 = 4,

34 
	m__LC_MESSAGES
 = 5,

35 
	m__LC_ALL
 = 6,

36 
	m__LC_PAPER
 = 7,

37 
	m__LC_NAME
 = 8,

38 
	m__LC_ADDRESS
 = 9,

39 
	m__LC_TELEPHONE
 = 10,

40 
	m__LC_MEASUREMENT
 = 11,

41 
	m__LC_IDENTIFICATION
 = 12

	@/usr/include/bits/select.h

19 #iâdeà
_SYS_SELECT_H


26 
	#__FD_ZERO
(
s
) \

28 
__i
; \

29 
fd_£t
 *
__¬r
 = (
s
); \

30 
__i
 = 0; __˜<  (
fd_£t
è/  (
__fd_mask
); ++__i) \

31 
	`__FDS_BITS
 (
__¬r
)[
__i
] = 0; \

32 } 0)

	)

33 
	#__FD_SET
(
d
, 
s
è(
	`__FDS_BITS
 (s)[
	`__FDELT
(d)] |ğ
	`__FDMASK
(d))

	)

34 
	#__FD_CLR
(
d
, 
s
è(
	`__FDS_BITS
 (s)[
	`__FDELT
(d)] &ğ~
	`__FDMASK
(d))

	)

35 
	#__FD_ISSET
(
d
, 
s
è((
	`__FDS_BITS
 (s)[
	`__FDELT
(d)] & 
	`__FDMASK
(d)è!ğ0)

	)

	@/usr/include/bits/stdio-lock.h

20 #iâdeà
_BITS_STDIO_LOCK_H


21 
	#_BITS_STDIO_LOCK_H
 1

	)

23 
	~<b™s/libc-lock.h
>

24 
	~<lowËv–lock.h
>

28 
	#_IO_lock_šex³nsive
 1

	)

30 ¡ruù { 
	mlock
; 
	mút
; *
	mowÃr
; } 
	t_IO_lock_t
;

32 
	#_IO_lock_š™Ÿliz”
 { 
LLL_LOCK_INITIALIZER
, 0, 
NULL
 }

	)

34 
	#_IO_lock_š™
(
_Çme
) \

35 ((
_Çme
èğ(
_IO_lock_t
è
_IO_lock_š™Ÿliz”
 , 0)

	)

37 
	#_IO_lock_fši
(
_Çme
) \

38 ((è0)

	)

40 
	#_IO_lock_lock
(
_Çme
) \

42 *
__£lf
 = 
THREAD_SELF
; \

43 ià((
_Çme
).
owÃr
 !ğ
__£lf
) \

45 
	`Îl_lock
 ((
_Çme
).
lock
, 
LLL_PRIVATE
); \

46 (
_Çme
).
owÃr
 = 
__£lf
; \

48 ++(
_Çme
).
út
; \

49 } 0)

	)

51 
	#_IO_lock_Œylock
(
_Çme
) \

53 
__»suÉ
 = 0; \

54 *
__£lf
 = 
THREAD_SELF
; \

55 ià((
_Çme
).
owÃr
 !ğ
__£lf
) \

57 ià(
	`Îl_Œylock
 ((
_Çme
).
lock
) == 0) \

59 (
_Çme
).
owÃr
 = 
__£lf
; \

60 (
_Çme
).
út
 = 1; \

63 
__»suÉ
 = 
EBUSY
; \

66 ++(
_Çme
).
út
; \

67 
__»suÉ
; \

68 })

	)

70 
	#_IO_lock_uÆock
(
_Çme
) \

72 ià(--(
_Çme
).
út
 == 0) \

74 (
_Çme
).
owÃr
 = 
NULL
; \

75 
	`Îl_uÆock
 ((
_Çme
).
lock
, 
LLL_PRIVATE
); \

77 } 0)

	)

81 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
) \

82 
	`__libc_ş—nup_»giÚ_¡¬t
 (((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0, 
_fù
, _å)

	)

83 
	#_IO_ş—nup_»giÚ_¡¬t_nßrg
(
_fù
) \

84 
	`__libc_ş—nup_»giÚ_¡¬t
 (1, 
_fù
, 
NULL
)

	)

85 
	#_IO_ş—nup_»giÚ_’d
(
_do™
) \

86 
	`__libc_ş—nup_»giÚ_’d
 (
_do™
)

	)

88 #ià
defšed
 
_LIBC
 && !defšed 
NOT_IN_libc


90 #ifdeà
__EXCEPTIONS


91 
	#_IO_acquœe_lock
(
_å
) \

93 
_IO_FILE
 *
_IO_acquœe_lock_fe
 \

94 
	`__©Œibu‹__
((
	`ş—nup
 (
_IO_acquœe_lock_fù
))) \

95 ğ(
_å
); \

96 
	`_IO_æockfe
 (
_IO_acquœe_lock_fe
);

	)

97 
	#_IO_acquœe_lock_ş—r_æags2
(
_å
) \

99 
_IO_FILE
 *
_IO_acquœe_lock_fe
 \

100 
	`__©Œibu‹__
((
	`ş—nup
 (
_IO_acquœe_lock_ş—r_æags2_fù
))) \

101 ğ(
_å
); \

102 
	`_IO_æockfe
 (
_IO_acquœe_lock_fe
);

	)

104 
	#_IO_acquœe_lock
(
_å
è
_IO_acquœe_lock_Ãeds_exû±iÚs_’abËd


	)

105 
	#_IO_acquœe_lock_ş—r_æags2
(
_å
è
	`_IO_acquœe_lock
 (_å)

	)

107 
	#_IO_»Ëa£_lock
(
_å
è; } 0)

	)

	@/usr/include/bits/syslog-ldbl.h

20 #iâdeà
_SYS_SYSLOG_H


24 
	$__LDBL_REDIR_DECL
 (
sy¦og
)

26 #ifdeà
__USE_BSD


27 
	$__LDBL_REDIR_DECL
 (
vsy¦og
)

30 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


31 
	$__LDBL_REDIR_DECL
 (
__sy¦og_chk
)

33 #ifdeà
__USE_BSD


34 
	$__LDBL_REDIR_DECL
 (
__vsy¦og_chk
)

	@/usr/include/bits/syslog-path.h

20 #iâdeà
_SYS_SYSLOG_H


24 #iâdeà
_BITS_SYSLOG_PATH_H


25 
	#_BITS_SYSLOG_PATH_H
 1

	)

27 
	#_PATH_LOG
 "/dev/log"

	)

	@/usr/include/bits/syslog.h

20 #iâdeà
_SYS_SYSLOG_H


25 
	$__sy¦og_chk
 (
__´i
, 
__æag
, 
__cÚ¡
 *
__fmt
, ...)

26 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

28 #ifdeà
__va_¬g_·ck


29 
__ex‹º_®ways_šlše
 

30 
	$sy¦og
 (
__´i
, 
__cÚ¡
 *
__fmt
, ...)

32  
	`__sy¦og_chk
 (
__´i
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

33 
	}
}

34 #–ià!
defšed
 
__ılu¥lus


35 
	#sy¦og
(
´i
, ...) \

36 
	`__sy¦og_chk
 (
´i
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

40 #ifdeà
__USE_BSD


41 
	$__vsy¦og_chk
 (
__´i
, 
__æag
, 
__cÚ¡
 *
__fmt
,

42 
__gnuc_va_li¡
 
__­
)

43 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

45 
__ex‹º_®ways_šlše
 

46 
	$vsy¦og
 (
__´i
, 
__cÚ¡
 *
__fmt
, 
__gnuc_va_li¡
 
__­
)

48  
	`__vsy¦og_chk
 (
__´i
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

49 
	}
}

	@/usr/include/bits/typesizes.h

20 #iâdeà
_BITS_TYPES_H


24 #iâdef 
_BITS_TYPESIZES_H


25 
	#_BITS_TYPESIZES_H
 1

	)

30 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

31 
	#__UID_T_TYPE
 
__U32_TYPE


	)

32 
	#__GID_T_TYPE
 
__U32_TYPE


	)

33 
	#__INO_T_TYPE
 
__ULONGWORD_TYPE


	)

34 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

35 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

36 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

37 
	#__OFF_T_TYPE
 
__SLONGWORD_TYPE


	)

38 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

39 
	#__PID_T_TYPE
 
__S32_TYPE


	)

40 
	#__RLIM_T_TYPE
 
__ULONGWORD_TYPE


	)

41 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

42 
	#__BLKCNT_T_TYPE
 
__SLONGWORD_TYPE


	)

43 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

44 
	#__FSBLKCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

45 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

46 
	#__FSFILCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

47 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

48 
	#__ID_T_TYPE
 
__U32_TYPE


	)

49 
	#__CLOCK_T_TYPE
 
__SLONGWORD_TYPE


	)

50 
	#__TIME_T_TYPE
 
__SLONGWORD_TYPE


	)

51 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

52 
	#__SUSECONDS_T_TYPE
 
__SLONGWORD_TYPE


	)

53 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

54 
	#__SWBLK_T_TYPE
 
__SLONGWORD_TYPE


	)

55 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

56 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

57 
	#__TIMER_T_TYPE
 *

	)

58 
	#__BLKSIZE_T_TYPE
 
__SLONGWORD_TYPE


	)

59 
	#__FSID_T_TYPE
 sŒuù { 
__v®
[2]; }

	)

60 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

63 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/bits/uio.h

19 #ià!
defšed
 
_SYS_UIO_H
 && !defšed 
_FCNTL_H


23 #iâdeà
_BITS_UIO_H


24 
	#_BITS_UIO_H
 1

	)

26 
	~<sys/ty³s.h
>

40 
	#UIO_MAXIOV
 1024

	)

44 
	siovec


46 *
	miov_ba£
;

47 
size_t
 
	miov_Ën
;

	@/usr/include/gnu/stubs.h

4 
	~<b™s/wÜdsize.h
>

6 #ià
__WORDSIZE
 == 32

7 
	~<gnu/¡ubs-32.h
>

8 #–ià
__WORDSIZE
 == 64

9 
	~<gnu/¡ubs-64.h
>

	@/usr/include/linux/byteorder/swab.h

1 #iâdeà
_LINUX_BYTEORDER_SWAB_H


2 
	#_LINUX_BYTEORDER_SWAB_H


	)

64 
__šlše__
 
__u16
 
	$___swab16
(
__u16
 
x
)

66  
x
<<8 | x>>8;

67 
	}
}

68 
__šlše__
 
__u32
 
	$___swab32
(
__u32
 
x
)

70  
x
<<24 | x>>24 |

71 (
x
 & (
__u32
)0x0000ff00UL)<<8 |

72 (
x
 & (
__u32
)0x00ff0000UL)>>8;

73 
	}
}

74 
__šlše__
 
__u64
 
	$___swab64
(
__u64
 
x
)

76  
x
<<56 | x>>56 |

77 (
x
 & (
__u64
)0x000000000000ff00ULL)<<40 |

78 (
x
 & (
__u64
)0x0000000000ff0000ULL)<<24 |

79 (
x
 & (
__u64
)0x00000000ff000000ULL)<< 8 |

80 (
x
 & (
__u64
)0x000000ff00000000ULL)>> 8 |

81 (
x
 & (
__u64
)0x0000ff0000000000ULL)>>24 |

82 (
x
 & (
__u64
)0x00ff000000000000ULL)>>40;

83 
	}
}

85 
	#___cÚ¡ªt_swab16
(
x
) \

86 ((
__u16
)( \

87 (((
__u16
)(
x
) & (__u16)0x00ffU) << 8) | \

88 (((
__u16
)(
x
è& (__u16)0xff00Uè>> 8è))

	)

89 
	#___cÚ¡ªt_swab32
(
x
) \

90 ((
__u32
)( \

91 (((
__u32
)(
x
) & (__u32)0x000000ffUL) << 24) | \

92 (((
__u32
)(
x
) & (__u32)0x0000ff00UL) << 8) | \

93 (((
__u32
)(
x
) & (__u32)0x00ff0000UL) >> 8) | \

94 (((
__u32
)(
x
è& (__u32)0xff000000ULè>> 24è))

	)

95 
	#___cÚ¡ªt_swab64
(
x
) \

96 ((
__u64
)( \

97 (
__u64
)(((__u64)(
x
) & (__u64)0x00000000000000ffULL) << 56) | \

98 (
__u64
)(((__u64)(
x
) & (__u64)0x000000000000ff00ULL) << 40) | \

99 (
__u64
)(((__u64)(
x
) & (__u64)0x0000000000ff0000ULL) << 24) | \

100 (
__u64
)(((__u64)(
x
) & (__u64)0x00000000ff000000ULL) << 8) | \

101 (
__u64
)(((__u64)(
x
) & (__u64)0x000000ff00000000ULL) >> 8) | \

102 (
__u64
)(((__u64)(
x
) & (__u64)0x0000ff0000000000ULL) >> 24) | \

103 (
__u64
)(((__u64)(
x
) & (__u64)0x00ff000000000000ULL) >> 40) | \

104 (
__u64
)(((__u64)(
x
è& (__u64)0xff00000000000000ULLè>> 56è))

	)

109 #iâdeà
__¬ch__swab16


110 
	#__¬ch__swab16
(
x
è
	`___swab16
(x)

	)

112 #iâdeà
__¬ch__swab32


113 
	#__¬ch__swab32
(
x
è
	`___swab32
(x)

	)

115 #iâdeà
__¬ch__swab64


116 
	#__¬ch__swab64
(
x
è
	`___swab64
(x)

	)

119 #iâdeà
__¬ch__swab16p


120 
	#__¬ch__swab16p
(
x
è
	`__¬ch__swab16
(*(x))

	)

122 #iâdeà
__¬ch__swab32p


123 
	#__¬ch__swab32p
(
x
è
	`__¬ch__swab32
(*(x))

	)

125 #iâdeà
__¬ch__swab64p


126 
	#__¬ch__swab64p
(
x
è
	`__¬ch__swab64
(*(x))

	)

129 #iâdeà
__¬ch__swab16s


130 
	#__¬ch__swab16s
(
x
è(()(*(xèğ
	`__¬ch__swab16p
(x)))

	)

132 #iâdeà
__¬ch__swab32s


133 
	#__¬ch__swab32s
(
x
è(()(*(xèğ
	`__¬ch__swab32p
(x)))

	)

135 #iâdeà
__¬ch__swab64s


136 
	#__¬ch__swab64s
(
x
è(()(*(xèğ
	`__¬ch__swab64p
(x)))

	)

143 #ià
defšed
(
__GNUC__
è&& defšed(
__OPTIMIZE__
)

144 
	#__swab16
(
x
) \

145 (
	`__butš_cÚ¡ªt_p
((
__u16
)(
x
)) ? \

146 
	`___cÚ¡ªt_swab16
((
x
)) : \

147 
	`__fswab16
((
x
)))

	)

148 
	#__swab32
(
x
) \

149 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

150 
	`___cÚ¡ªt_swab32
((
x
)) : \

151 
	`__fswab32
((
x
)))

	)

152 
	#__swab64
(
x
) \

153 (
	`__butš_cÚ¡ªt_p
((
__u64
)(
x
)) ? \

154 
	`___cÚ¡ªt_swab64
((
x
)) : \

155 
	`__fswab64
((
x
)))

	)

157 
	#__swab16
(
x
è
	`__fswab16
(x)

	)

158 
	#__swab32
(
x
è
	`__fswab32
(x)

	)

159 
	#__swab64
(
x
è
	`__fswab64
(x)

	)

163 
__šlše__
 
__u16
 
	$__fswab16
(
__u16
 
x
)

165  
	`__¬ch__swab16
(
x
);

166 
	}
}

167 
__šlše__
 
__u16
 
	$__swab16p
(cÚ¡ 
__u16
 *
x
)

169  
	`__¬ch__swab16p
(
x
);

170 
	}
}

171 
__šlše__
 
	$__swab16s
(
__u16
 *
addr
)

173 
	`__¬ch__swab16s
(
addr
);

174 
	}
}

176 
__šlše__
 
__u32
 
	$__fswab32
(
__u32
 
x
)

178  
	`__¬ch__swab32
(
x
);

179 
	}
}

180 
__šlše__
 
__u32
 
	$__swab32p
(cÚ¡ 
__u32
 *
x
)

182  
	`__¬ch__swab32p
(
x
);

183 
	}
}

184 
__šlše__
 
	$__swab32s
(
__u32
 *
addr
)

186 
	`__¬ch__swab32s
(
addr
);

187 
	}
}

189 #ifdeà
__BYTEORDER_HAS_U64__


190 
__šlše__
 
__u64
 
	$__fswab64
(
__u64
 
x
)

192 #ifdeà
__SWAB_64_THRU_32__


193 
__u32
 
h
 = 
x
 >> 32;

194 
__u32
 
l
 = 
x
 & ((1ULL<<32)-1);

195  (((
__u64
)
	`__swab32
(
l
)è<< 32è| ((__u64)(__swab32(
h
)));

197  
	`__¬ch__swab64
(
x
);

199 
	}
}

200 
__šlše__
 
__u64
 
	$__swab64p
(cÚ¡ 
__u64
 *
x
)

202  
	`__¬ch__swab64p
(
x
);

203 
	}
}

204 
__šlše__
 
	$__swab64s
(
__u64
 *
addr
)

206 
	`__¬ch__swab64s
(
addr
);

207 
	}
}

	@/usr/include/linux/byteorder/swabb.h

1 #iâdeà
_LINUX_BYTEORDER_SWABB_H


2 
	#_LINUX_BYTEORDER_SWABB_H


	)

28 
	~<lšux/ty³s.h
>

30 
	#___swahw32
(
x
) \

32 
__u32
 
__x
 = (
x
); \

33 ((
__u32
)( \

34 (((
__u32
)(
__x
) & (__u32)0x0000ffffUL) << 16) | \

35 (((
__u32
)(
__x
) & (__u32)0xffff0000UL) >> 16) )); \

36 })

	)

37 
	#___swahb32
(
x
) \

39 
__u32
 
__x
 = (
x
); \

40 ((
__u32
)( \

41 (((
__u32
)(
__x
) & (__u32)0x00ff00ffUL) << 8) | \

42 (((
__u32
)(
__x
) & (__u32)0xff00ff00UL) >> 8) )); \

43 })

	)

45 
	#___cÚ¡ªt_swahw32
(
x
) \

46 ((
__u32
)( \

47 (((
__u32
)(
x
) & (__u32)0x0000ffffUL) << 16) | \

48 (((
__u32
)(
x
è& (__u32)0xffff0000ULè>> 16è))

	)

49 
	#___cÚ¡ªt_swahb32
(
x
) \

50 ((
__u32
)( \

51 (((
__u32
)(
x
) & (__u32)0x00ff00ffUL) << 8) | \

52 (((
__u32
)(
x
è& (__u32)0xff00ff00ULè>> 8è))

	)

57 #iâdeà
__¬ch__swahw32


58 
	#__¬ch__swahw32
(
x
è
	`___swahw32
(x)

	)

60 #iâdeà
__¬ch__swahb32


61 
	#__¬ch__swahb32
(
x
è
	`___swahb32
(x)

	)

64 #iâdeà
__¬ch__swahw32p


65 
	#__¬ch__swahw32p
(
x
è
	`__swahw32
(*(x))

	)

67 #iâdeà
__¬ch__swahb32p


68 
	#__¬ch__swahb32p
(
x
è
	`__swahb32
(*(x))

	)

71 #iâdeà
__¬ch__swahw32s


72 
	#__¬ch__swahw32s
(
x
èdØ{ *(xèğ
	`__swahw32p
((x)); } 0)

	)

74 #iâdeà
__¬ch__swahb32s


75 
	#__¬ch__swahb32s
(
x
èdØ{ *(xèğ
	`__swahb32p
((x)); } 0)

	)

82 
	#__swahw32
(
x
) \

83 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

84 
	`___swahw32
((
x
)) : \

85 
	`__fswahw32
((
x
)))

	)

86 
	#__swahb32
(
x
) \

87 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

88 
	`___swahb32
((
x
)) : \

89 
	`__fswahb32
((
x
)))

	)

92 
šlše
 
__u32
 
	$__fswahw32
(
__u32
 
x
)

94  
	`__¬ch__swahw32
(
x
);

95 
	}
}

97 
šlše
 
__u32
 
	$__swahw32p
(
__u32
 *
x
)

99  
	`__¬ch__swahw32p
(
x
);

100 
	}
}

102 
šlše
 
	$__swahw32s
(
__u32
 *
addr
)

104 
	`__¬ch__swahw32s
(
addr
);

105 
	}
}

107 
šlše
 
__u32
 
	$__fswahb32
(
__u32
 
x
)

109  
	`__¬ch__swahb32
(
x
);

110 
	}
}

112 
šlše
 
__u32
 
	$__swahb32p
(
__u32
 *
x
)

114  
	`__¬ch__swahb32p
(
x
);

115 
	}
}

117 
šlše
 
	$__swahb32s
(
__u32
 *
addr
)

119 
	`__¬ch__swahb32s
(
addr
);

120 
	}
}

122 #ifdeà
__BYTEORDER_HAS_U64__


128 
	#swahw32
 
__swahw32


	)

129 
	#swahb32
 
__swahb32


	)

130 
	#swahw32p
 
__swahw32p


	)

131 
	#swahb32p
 
__swahb32p


	)

132 
	#swahw32s
 
__swahw32s


	)

133 
	#swahb32s
 
__swahb32s


	)

	@/usr/include/linux/errno.h

1 #iâdeà
_LINUX_ERRNO_H


2 
	#_LINUX_ERRNO_H


	)

4 
	~<asm/”ºo.h
>

	@/usr/include/linux/if_ether.h

21 #iâdeà
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<lšux/ty³s.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_HLEN
 14

	)

33 
	#ETH_ZLEN
 60

	)

34 
	#ETH_DATA_LEN
 1500

	)

35 
	#ETH_FRAME_LEN
 1514

	)

36 
	#ETH_FCS_LEN
 4

	)

42 
	#ETH_P_LOOP
 0x0060

	)

43 
	#ETH_P_PUP
 0x0200

	)

44 
	#ETH_P_PUPAT
 0x0201

	)

45 
	#ETH_P_IP
 0x0800

	)

46 
	#ETH_P_X25
 0x0805

	)

47 
	#ETH_P_ARP
 0x0806

	)

48 
	#ETH_P_BPQ
 0x08FF

	)

49 
	#ETH_P_IEEEPUP
 0x0a00

	)

50 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

51 
	#ETH_P_DEC
 0x6000

	)

52 
	#ETH_P_DNA_DL
 0x6001

	)

53 
	#ETH_P_DNA_RC
 0x6002

	)

54 
	#ETH_P_DNA_RT
 0x6003

	)

55 
	#ETH_P_LAT
 0x6004

	)

56 
	#ETH_P_DIAG
 0x6005

	)

57 
	#ETH_P_CUST
 0x6006

	)

58 
	#ETH_P_SCA
 0x6007

	)

59 
	#ETH_P_TEB
 0x6558

	)

60 
	#ETH_P_RARP
 0x8035

	)

61 
	#ETH_P_ATALK
 0x809B

	)

62 
	#ETH_P_AARP
 0x80F3

	)

63 
	#ETH_P_8021Q
 0x8100

	)

64 
	#ETH_P_IPX
 0x8137

	)

65 
	#ETH_P_IPV6
 0x86DD

	)

66 
	#ETH_P_PAUSE
 0x8808

	)

67 
	#ETH_P_SLOW
 0x8809

	)

68 
	#ETH_P_WCCP
 0x883E

	)

70 
	#ETH_P_PPP_DISC
 0x8863

	)

71 
	#ETH_P_PPP_SES
 0x8864

	)

72 
	#ETH_P_MPLS_UC
 0x8847

	)

73 
	#ETH_P_MPLS_MC
 0x8848

	)

74 
	#ETH_P_ATMMPOA
 0x884ø

	)

75 
	#ETH_P_ATMFATE
 0x8884

	)

78 
	#ETH_P_PAE
 0x888E

	)

79 
	#ETH_P_AOE
 0x88A2

	)

80 
	#ETH_P_TIPC
 0x88CA

	)

81 
	#ETH_P_EDSA
 0xDADA

	)

87 
	#ETH_P_802_3
 0x0001

	)

88 
	#ETH_P_AX25
 0x0002

	)

89 
	#ETH_P_ALL
 0x0003

	)

90 
	#ETH_P_802_2
 0x0004

	)

91 
	#ETH_P_SNAP
 0x0005

	)

92 
	#ETH_P_DDCMP
 0x0006

	)

93 
	#ETH_P_WAN_PPP
 0x0007

	)

94 
	#ETH_P_PPP_MP
 0x0008

	)

95 
	#ETH_P_LOCALTALK
 0x0009

	)

96 
	#ETH_P_CAN
 0x000C

	)

97 
	#ETH_P_PPPTALK
 0x0010

	)

98 
	#ETH_P_TR_802_2
 0x0011

	)

99 
	#ETH_P_MOBITEX
 0x0015

	)

100 
	#ETH_P_CONTROL
 0x0016

	)

101 
	#ETH_P_IRDA
 0x0017

	)

102 
	#ETH_P_ECONET
 0x0018

	)

103 
	#ETH_P_HDLC
 0x0019

	)

104 
	#ETH_P_ARCNET
 0x001A

	)

105 
	#ETH_P_DSA
 0x001B

	)

106 
	#ETH_P_TRAILER
 0x001C

	)

107 
	#ETH_P_PHONET
 0x00F5

	)

113 
	s‘hhdr
 {

114 
	mh_de¡
[
ETH_ALEN
];

115 
	mh_sourû
[
ETH_ALEN
];

116 
__be16
 
	mh_´Ùo
;

117 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/if_packet.h

1 #iâdeà
__LINUX_IF_PACKET_H


2 
	#__LINUX_IF_PACKET_H


	)

4 
	~<lšux/ty³s.h
>

6 
	ssockaddr_pkt


8 
	m¥kt_çmy
;

9 
	m¥kt_deviû
[14];

10 
__be16
 
	m¥kt_´ÙocŞ
;

13 
	ssockaddr_Î


15 
	m¦l_çmy
;

16 
__be16
 
	m¦l_´ÙocŞ
;

17 
	m¦l_ifšdex
;

18 
	m¦l_h©y³
;

19 
	m¦l_pk‰y³
;

20 
	m¦l_h®’
;

21 
	m¦l_addr
[8];

26 
	#PACKET_HOST
 0

	)

27 
	#PACKET_BROADCAST
 1

	)

28 
	#PACKET_MULTICAST
 2

	)

29 
	#PACKET_OTHERHOST
 3

	)

30 
	#PACKET_OUTGOING
 4

	)

32 
	#PACKET_LOOPBACK
 5

	)

33 
	#PACKET_FASTROUTE
 6

	)

37 
	#PACKET_ADD_MEMBERSHIP
 1

	)

38 
	#PACKET_DROP_MEMBERSHIP
 2

	)

39 
	#PACKET_RECV_OUTPUT
 3

	)

41 
	#PACKET_RX_RING
 5

	)

42 
	#PACKET_STATISTICS
 6

	)

43 
	#PACKET_COPY_THRESH
 7

	)

44 
	#PACKET_AUXDATA
 8

	)

45 
	#PACKET_ORIGDEV
 9

	)

46 
	#PACKET_VERSION
 10

	)

47 
	#PACKET_HDRLEN
 11

	)

48 
	#PACKET_RESERVE
 12

	)

50 
	sack‘_¡©s


52 
	m_·ck‘s
;

53 
	m_drİs
;

56 
	sack‘_auxd©a


58 
__u32
 
	m_¡©us
;

59 
__u32
 
	m_Ën
;

60 
__u32
 
	m_¢­Ën
;

61 
__u16
 
	m_mac
;

62 
__u16
 
	m_Ãt
;

63 
__u16
 
	m_vÏn_tci
;

66 
	sack‘_hdr


68 
	m_¡©us
;

69 
	#TP_STATUS_KERNEL
 0

	)

70 
	#TP_STATUS_USER
 1

	)

71 
	#TP_STATUS_COPY
 2

	)

72 
	#TP_STATUS_LOSING
 4

	)

73 
	#TP_STATUS_CSUMNOTREADY
 8

	)

74 
	m_Ën
;

75 
	m_¢­Ën
;

76 
	m_mac
;

77 
	m_Ãt
;

78 
	m_£c
;

79 
	m_u£c
;

82 
	#TPACKET_ALIGNMENT
 16

	)

83 
	#TPACKET_ALIGN
(
x
è(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

84 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘_hdr
)è+ (
sockaddr_Î
))

	)

86 
	sack‘2_hdr


88 
__u32
 
	m_¡©us
;

89 
__u32
 
	m_Ën
;

90 
__u32
 
	m_¢­Ën
;

91 
__u16
 
	m_mac
;

92 
__u16
 
	m_Ãt
;

93 
__u32
 
	m_£c
;

94 
__u32
 
	m_n£c
;

95 
__u16
 
	m_vÏn_tci
;

98 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘2_hdr
)è+ (
sockaddr_Î
))

	)

100 
	eack‘_v”siÚs


102 
	mTPACKET_V1
,

103 
	mTPACKET_V2
,

119 
	sack‘_»q


121 
	m_block_size
;

122 
	m_block_Ä
;

123 
	m_äame_size
;

124 
	m_äame_Ä
;

127 
	s·ck‘_m»q


129 
	mmr_ifšdex
;

130 
	mmr_ty³
;

131 
	mmr_®’
;

132 
	mmr_add»ss
[8];

135 
	#PACKET_MR_MULTICAST
 0

	)

136 
	#PACKET_MR_PROMISC
 1

	)

137 
	#PACKET_MR_ALLMULTI
 2

	)

	@/usr/include/linux/kernel.h

1 #iâdeà
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

9 
	#SI_LOAD_SHIFT
 16

	)

10 
	ssysšfo
 {

11 
	mu±ime
;

12 
	mlßds
[3];

13 
	mtÙ®¿m
;

14 
	mä“¿m
;

15 
	msh¬ed¿m
;

16 
	mbufã¼am
;

17 
	mtÙ®sw­
;

18 
	mä“sw­
;

19 
	m´ocs
;

20 
	m·d
;

21 
	mtÙ®high
;

22 
	mä“high
;

23 
	mmem_un™
;

24 
	m_f
[20-2*()-()];

28 
	#BUILD_BUG_ON
(
cÚd™iÚ
è(()([1 - 2*!!(cÚd™iÚ)]))

	)

34 
	#BUILD_BUG_ON_ZERO
(
e
è(([1 - 2 * !!Ó)]è- 1)

	)

37 
	#__FUNCTION__
 (
__func__
)

	)

40 #ifdeà
CONFIG_NUMA


41 
	#NUMA_BUILD
 1

	)

43 
	#NUMA_BUILD
 0

	)

47 #ifdeà
CONFIG_FTRACE_MCOUNT_RECORD


48 
	#REBUILD_DUE_TO_FTRACE_MCOUNT_RECORD


	)

	@/usr/include/linux/sockios.h

18 #iâdeà
_LINUX_SOCKIOS_H


19 
	#_LINUX_SOCKIOS_H


	)

21 
	~<asm/sockios.h
>

24 
	#SIOCINQ
 
FIONREAD


	)

25 
	#SIOCOUTQ
 
TIOCOUTQ


	)

28 
	#SIOCADDRT
 0x890B

	)

29 
	#SIOCDELRT
 0x890C

	)

30 
	#SIOCRTMSG
 0x890D

	)

33 
	#SIOCGIFNAME
 0x8910

	)

34 
	#SIOCSIFLINK
 0x8911

	)

35 
	#SIOCGIFCONF
 0x8912

	)

36 
	#SIOCGIFFLAGS
 0x8913

	)

37 
	#SIOCSIFFLAGS
 0x8914

	)

38 
	#SIOCGIFADDR
 0x8915

	)

39 
	#SIOCSIFADDR
 0x8916

	)

40 
	#SIOCGIFDSTADDR
 0x8917

	)

41 
	#SIOCSIFDSTADDR
 0x8918

	)

42 
	#SIOCGIFBRDADDR
 0x8919

	)

43 
	#SIOCSIFBRDADDR
 0x891¨

	)

44 
	#SIOCGIFNETMASK
 0x891b

	)

45 
	#SIOCSIFNETMASK
 0x891ø

	)

46 
	#SIOCGIFMETRIC
 0x891d

	)

47 
	#SIOCSIFMETRIC
 0x891

	)

48 
	#SIOCGIFMEM
 0x891à

	)

49 
	#SIOCSIFMEM
 0x8920

	)

50 
	#SIOCGIFMTU
 0x8921

	)

51 
	#SIOCSIFMTU
 0x8922

	)

52 
	#SIOCSIFNAME
 0x8923

	)

53 
	#SIOCSIFHWADDR
 0x8924

	)

54 
	#SIOCGIFENCAP
 0x8925

	)

55 
	#SIOCSIFENCAP
 0x8926

	)

56 
	#SIOCGIFHWADDR
 0x8927

	)

57 
	#SIOCGIFSLAVE
 0x8929

	)

58 
	#SIOCSIFSLAVE
 0x8930

	)

59 
	#SIOCADDMULTI
 0x8931

	)

60 
	#SIOCDELMULTI
 0x8932

	)

61 
	#SIOCGIFINDEX
 0x8933

	)

62 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

63 
	#SIOCSIFPFLAGS
 0x8934

	)

64 
	#SIOCGIFPFLAGS
 0x8935

	)

65 
	#SIOCDIFADDR
 0x8936

	)

66 
	#SIOCSIFHWBROADCAST
 0x8937

	)

67 
	#SIOCGIFCOUNT
 0x8938

	)

69 
	#SIOCGIFBR
 0x8940

	)

70 
	#SIOCSIFBR
 0x8941

	)

72 
	#SIOCGIFTXQLEN
 0x8942

	)

73 
	#SIOCSIFTXQLEN
 0x8943

	)

78 
	#SIOCETHTOOL
 0x8946

	)

80 
	#SIOCGMIIPHY
 0x8947

	)

81 
	#SIOCGMIIREG
 0x8948

	)

82 
	#SIOCSMIIREG
 0x8949

	)

84 
	#SIOCWANDEV
 0x894A

	)

88 
	#SIOCDARP
 0x8953

	)

89 
	#SIOCGARP
 0x8954

	)

90 
	#SIOCSARP
 0x8955

	)

93 
	#SIOCDRARP
 0x8960

	)

94 
	#SIOCGRARP
 0x8961

	)

95 
	#SIOCSRARP
 0x8962

	)

99 
	#SIOCGIFMAP
 0x8970

	)

100 
	#SIOCSIFMAP
 0x8971

	)

104 
	#SIOCADDDLCI
 0x8980

	)

105 
	#SIOCDELDLCI
 0x8981

	)

107 
	#SIOCGIFVLAN
 0x8982

	)

108 
	#SIOCSIFVLAN
 0x8983

	)

112 
	#SIOCBONDENSLAVE
 0x8990

	)

113 
	#SIOCBONDRELEASE
 0x8991

	)

114 
	#SIOCBONDSETHWADDR
 0x8992

	)

115 
	#SIOCBONDSLAVEINFOQUERY
 0x8993

	)

116 
	#SIOCBONDINFOQUERY
 0x8994

	)

117 
	#SIOCBONDCHANGEACTIVE
 0x8995

	)

120 
	#SIOCBRADDBR
 0x89a0

	)

121 
	#SIOCBRDELBR
 0x89a1

	)

122 
	#SIOCBRADDIF
 0x89a2

	)

123 
	#SIOCBRDELIF
 0x89a3

	)

136 
	#SIOCDEVPRIVATE
 0x89F0

	)

142 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/linux/stddef.h

1 #iâdeà
_LINUX_STDDEF_H


2 
	#_LINUX_STDDEF_H


	)

6 #undeà
NULL


7 #ià
defšed
(
__ılu¥lus
)

8 
	#NULL
 0

	)

10 
	#NULL
 ((*)0)

	)

	@/usr/include/linux/uio.h

1 #iâdeà
__LINUX_UIO_H


2 
	#__LINUX_UIO_H


	)

5 
	~<lšux/ty³s.h
>

16 
	siovec


18 *
	miov_ba£
;

19 
__k”Ãl_size_t
 
	miov_Ën
;

27 
	#UIO_FASTIOV
 8

	)

28 
	#UIO_MAXIOV
 1024

	)

37 
šlše
 
size_t
 
	$iov_Ëngth
(cÚ¡ 
iovec
 *
iov
, 
Ä_£gs
)

39 
£g
;

40 
size_t
 
»t
 = 0;

42 
£g
 = 0; seg < 
Ä_£gs
; seg++)

43 
»t
 +ğ
iov
[
£g
].
iov_Ën
;

44  
»t
;

45 
	}
}

47 
iov_shÜ‹n
(
iovec
 *
iov
, 
Ä_£gs
, 
size_t
 
to
);

	@/usr/include/asm-generic/ioctl.h

1 #iâdeà
_ASM_GENERIC_IOCTL_H


2 
	#_ASM_GENERIC_IOCTL_H


	)

22 
	#_IOC_NRBITS
 8

	)

23 
	#_IOC_TYPEBITS
 8

	)

30 #iâdeà
_IOC_SIZEBITS


31 
	#_IOC_SIZEBITS
 14

	)

34 #iâdeà
_IOC_DIRBITS


35 
	#_IOC_DIRBITS
 2

	)

38 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

39 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

40 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

41 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

43 
	#_IOC_NRSHIFT
 0

	)

44 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

45 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

46 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

53 #iâdeà
_IOC_NONE


54 
	#_IOC_NONE
 0U

	)

57 #iâdeà
_IOC_WRITE


58 
	#_IOC_WRITE
 1U

	)

61 #iâdeà
_IOC_READ


62 
	#_IOC_READ
 2U

	)

65 
	#_IOC
(
dœ
,
ty³
,
Ä
,
size
) \

66 (((
dœ
è<< 
_IOC_DIRSHIFT
) | \

67 ((
ty³
è<< 
_IOC_TYPESHIFT
) | \

68 ((
Ä
è<< 
_IOC_NRSHIFT
) | \

69 ((
size
è<< 
_IOC_SIZESHIFT
))

	)

71 
	#_IOC_TYPECHECK
(
t
è(Ñ))

	)

74 
	#_IO
(
ty³
,
Ä
è
	`_IOC
(
_IOC_NONE
,Ñy³),Òr),0)

	)

75 
	#_IOR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

76 
	#_IOW
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

77 
	#_IOWR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

78 
	#_IOR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(size))

	)

79 
	#_IOW_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(size))

	)

80 
	#_IOWR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(size))

	)

83 
	#_IOC_DIR
(
Ä
è((Òrè>> 
_IOC_DIRSHIFT
è& 
_IOC_DIRMASK
)

	)

84 
	#_IOC_TYPE
(
Ä
è((Òrè>> 
_IOC_TYPESHIFT
è& 
_IOC_TYPEMASK
)

	)

85 
	#_IOC_NR
(
Ä
è((Òrè>> 
_IOC_NRSHIFT
è& 
_IOC_NRMASK
)

	)

86 
	#_IOC_SIZE
(
Ä
è((Òrè>> 
_IOC_SIZESHIFT
è& 
_IOC_SIZEMASK
)

	)

90 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

91 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

92 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
è<< 
_IOC_DIRSHIFT
)

	)

93 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

94 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/asm/errno.h

1 
	~<asm-g’”ic/”ºo.h
>

	@/usr/include/asm/sockios.h

1 #iâdeà
_ASM_X86_SOCKIOS_H


2 
	#_ASM_X86_SOCKIOS_H


	)

5 
	#FIOSETOWN
 0x8901

	)

6 
	#SIOCSPGRP
 0x8902

	)

7 
	#FIOGETOWN
 0x8903

	)

8 
	#SIOCGPGRP
 0x8904

	)

9 
	#SIOCATMARK
 0x8905

	)

10 
	#SIOCGSTAMP
 0x8906

	)

11 
	#SIOCGSTAMPNS
 0x8907

	)

	@/usr/include/bits/libc-lock.h

20 #iâdeà
_BITS_LIBC_LOCK_H


21 
	#_BITS_LIBC_LOCK_H
 1

	)

23 
	~<±h»ad.h
>

24 
	#__Ãed_NULL


	)

25 
	~<¡ddef.h
>

34 #ifdeà
_LIBC


35 
	~<lowËv–lock.h
>

36 
	~<s.h
>

37 
	~<±h»ad-funùiÚs.h
>

41 #ià
defšed
 
_LIBC
 || defšed 
_IO_MTSAFE_IO


42 #ià(
defšed
 
NOT_IN_libc
 && !defšed 
IS_IN_lib±h»ad
è|| !defšed 
_LIBC


43 
±h»ad_mu‹x_t
 
	t__libc_lock_t
;

44 ¡ruù { 
±h»ad_mu‹x_t
 
	mmu‹x
; } 
	t__libc_lock_»cursive_t
;

46 
	t__libc_lock_t
;

47 ¡ruù { 
	mlock
; 
	mút
; *
	mowÃr
; } 
	t__libc_lock_»cursive_t
;

49 ¡ruù { 
±h»ad_mu‹x_t
 
	mmu‹x
; } 
	t__¹ld_lock_»cursive_t
;

50 #ifdeà
__USE_UNIX98


51 
±h»ad_rwlock_t
 
	t__libc_rwlock_t
;

53 
__libc_rwlock_İaque__
 
	t__libc_rwlock_t
;

56 
__libc_lock_İaque__
 
	t__libc_lock_t
;

57 
__libc_lock_»cursive_İaque__
 
	t__libc_lock_»cursive_t
;

58 
__libc_rwlock_İaque__
 
	t__libc_rwlock_t
;

62 
±h»ad_key_t
 
	t__libc_key_t
;

71 
	#__libc_lock_defše
(
CLASS
,
NAME
) \

72 
CLASS
 
__libc_lock_t
 
NAME
;

	)

73 
	#__libc_rwlock_defše
(
CLASS
,
NAME
) \

74 
CLASS
 
__libc_rwlock_t
 
NAME
;

	)

75 
	#__libc_lock_defše_»cursive
(
CLASS
,
NAME
) \

76 
CLASS
 
__libc_lock_»cursive_t
 
NAME
;

	)

77 
	#__¹ld_lock_defše_»cursive
(
CLASS
,
NAME
) \

78 
CLASS
 
__¹ld_lock_»cursive_t
 
NAME
;

	)

89 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

90 #ià
LLL_LOCK_INITIALIZER
 == 0

91 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

92 
CLASS
 
__libc_lock_t
 
NAME
;

	)

94 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

95 
CLASS
 
__libc_lock_t
 
NAME
 = 
LLL_LOCK_INITIALIZER
;

	)

98 #ià
__LT_SPINLOCK_INIT
 == 0

99 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

100 
CLASS
 
__libc_lock_t
 
NAME
;

	)

102 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

103 
CLASS
 
__libc_lock_t
 
NAME
 = 
PTHREAD_MUTEX_INITIALIZER
;

	)

107 
	#__libc_rwlock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

108 
CLASS
 
__libc_rwlock_t
 
NAME
 = 
PTHREAD_RWLOCK_INITIALIZER
;

	)

112 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

113 #ià
LLL_LOCK_INITIALIZER
 == 0

114 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

115 
CLASS
 
__libc_lock_»cursive_t
 
NAME
;

	)

117 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

118 
CLASS
 
__libc_lock_»cursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

120 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

121 { 
LLL_LOCK_INITIALIZER
, 0, 
NULL
 }

	)

123 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

124 
CLASS
 
__libc_lock_»cursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

125 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

126 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

129 
	#__¹ld_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

130 
CLASS
 
__¹ld_lock_»cursive_t
 
NAME
 = 
_RTLD_LOCK_RECURSIVE_INITIALIZER
;

	)

131 
	#_RTLD_LOCK_RECURSIVE_INITIALIZER
 \

132 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

134 
	#__¹ld_lock_š™Ÿlize
(
NAME
) \

135 (è((
NAME
èğ(
__¹ld_lock_»cursive_t
è
_RTLD_LOCK_RECURSIVE_INITIALIZER
)

	)

142 #ifdeà
__PIC__


143 
	#__libc_maybe_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

144 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of
 (
FUNC
è*
_â
 = (FUNC); \

145 
_â
 !ğ
NULL
 ? (*_âè
ARGS
 : 
ELSE
; }))

	)

147 
	#__libc_maybe_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

148 (
FUNC
 !ğ
NULL
 ? FUNC 
ARGS
 : 
ELSE
)

	)

152 #ià
defšed
 
SHARED
 && !defšed 
NOT_IN_libc


153 
	#PTFAVAIL
(
NAME
è
__libc_±h»ad_funùiÚs_š™


	)

154 
	#__libc_±f_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

155 (
__libc_±h»ad_funùiÚs_š™
 ? 
	`PTHFCT_CALL
 (
±r_
##
FUNC
, 
ARGS
è: 
ELSE
)

	)

156 
	#__libc_±f_ÿÎ_®ways
(
FUNC
, 
ARGS
) \

157 
	`PTHFCT_CALL
 (
±r_
##
FUNC
, 
ARGS
)

	)

159 
	#PTFAVAIL
(
NAME
è(NAME !ğ
NULL
)

	)

160 
	#__libc_±f_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

161 
	`__libc_maybe_ÿÎ
 (
FUNC
, 
ARGS
, 
ELSE
)

	)

162 
	#__libc_±f_ÿÎ_®ways
(
FUNC
, 
ARGS
) \

163 
FUNC
 
ARGS


	)

169 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

170 
	#__libc_lock_š™
(
NAME
è((NAMEèğ
LLL_LOCK_INITIALIZER
, 0)

	)

172 
	#__libc_lock_š™
(
NAME
) \

173 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_š™
, (&(
NAME
), 
NULL
), 0)

	)

175 #ià
defšed
 
SHARED
 && !defšed 
NOT_IN_libc


178 
	#__libc_rwlock_š™
(
NAME
) \

179 (
	`__butš_mem£t
 (&(
NAME
), '\0',  (NAME)), 0)

	)

181 
	#__libc_rwlock_š™
(
NAME
) \

182 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_š™
, (&(
NAME
), 
NULL
), 0)

	)

186 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

187 
	#__libc_lock_š™_»cursive
(
NAME
) \

188 ((
NAME
èğ(
__libc_lock_»cursive_t
è
_LIBC_LOCK_RECURSIVE_INITIALIZER
, 0)

	)

190 
	#__libc_lock_š™_»cursive
(
NAME
) \

192 ià(
__±h»ad_mu‹x_š™
 !ğ
NULL
) \

194 
±h»ad_mu‹x©Œ_t
 
__©Œ
; \

195 
	`__±h»ad_mu‹x©Œ_š™
 (&
__©Œ
); \

196 
	`__±h»ad_mu‹x©Œ_£‰y³
 (&
__©Œ
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

197 
	`__±h»ad_mu‹x_š™
 (&(
NAME
).
mu‹x
, &
__©Œ
); \

198 
	`__±h»ad_mu‹x©Œ_de¡roy
 (&
__©Œ
); \

200 } 0)

	)

203 
	#__¹ld_lock_š™_»cursive
(
NAME
) \

205 ià(
__±h»ad_mu‹x_š™
 !ğ
NULL
) \

207 
±h»ad_mu‹x©Œ_t
 
__©Œ
; \

208 
	`__±h»ad_mu‹x©Œ_š™
 (&
__©Œ
); \

209 
	`__±h»ad_mu‹x©Œ_£‰y³
 (&
__©Œ
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

210 
	`__±h»ad_mu‹x_š™
 (&(
NAME
).
mu‹x
, &
__©Œ
); \

211 
	`__±h»ad_mu‹x©Œ_de¡roy
 (&
__©Œ
); \

213 } 0)

	)

218 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

219 
	#__libc_lock_fši
(
NAME
è((è0)

	)

221 
	#__libc_lock_fši
(
NAME
) \

222 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_de¡roy
, (&(
NAME
)), 0)

	)

224 #ià
defšed
 
SHARED
 && !defšed 
NOT_IN_libc


225 
	#__libc_rwlock_fši
(
NAME
è((è0)

	)

227 
	#__libc_rwlock_fši
(
NAME
) \

228 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_de¡roy
, (&(
NAME
)), 0)

	)

232 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

233 
	#__libc_lock_fši_»cursive
(
NAME
è((è0)

	)

235 
	#__libc_lock_fši_»cursive
(
NAME
) \

236 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_de¡roy
, (&(
NAME
)), 0)

	)

240 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

241 
	#__libc_lock_lock
(
NAME
) \

242 ({ 
	`Îl_lock
 (
NAME
, 
LLL_PRIVATE
); 0; })

	)

244 
	#__libc_lock_lock
(
NAME
) \

245 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
)), 0)

	)

247 
	#__libc_rwlock_rdlock
(
NAME
) \

248 
	`__libc_±f_ÿÎ
 (
__±h»ad_rwlock_rdlock
, (&(
NAME
)), 0)

	)

249 
	#__libc_rwlock_w¾ock
(
NAME
) \

250 
	`__libc_±f_ÿÎ
 (
__±h»ad_rwlock_w¾ock
, (&(
NAME
)), 0)

	)

253 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

254 
	#__libc_lock_lock_»cursive
(
NAME
) \

256 *
£lf
 = 
THREAD_SELF
; \

257 ià((
NAME
).
owÃr
 !ğ
£lf
) \

259 
	`Îl_lock
 ((
NAME
).
lock
, 
LLL_PRIVATE
); \

260 (
NAME
).
owÃr
 = 
£lf
; \

262 ++(
NAME
).
út
; \

263 } 0)

	)

265 
	#__libc_lock_lock_»cursive
(
NAME
) \

266 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
).
mu‹x
), 0)

	)

270 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

271 
	#__libc_lock_Œylock
(
NAME
) \

272 
	`Îl_Œylock
 (
NAME
)

	)

274 
	#__libc_lock_Œylock
(
NAME
) \

275 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
)), 0)

	)

277 
	#__libc_rwlock_Œyrdlock
(
NAME
) \

278 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_Œyrdlock
, (&(
NAME
)), 0)

	)

279 
	#__libc_rwlock_Œyw¾ock
(
NAME
) \

280 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_Œyw¾ock
, (&(
NAME
)), 0)

	)

283 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

284 
	#__libc_lock_Œylock_»cursive
(
NAME
) \

286 
»suÉ
 = 0; \

287 *
£lf
 = 
THREAD_SELF
; \

288 ià((
NAME
).
owÃr
 !ğ
£lf
) \

290 ià(
	`Îl_Œylock
 ((
NAME
).
lock
) == 0) \

292 (
NAME
).
owÃr
 = 
£lf
; \

293 (
NAME
).
út
 = 1; \

296 
»suÉ
 = 
EBUSY
; \

299 ++(
NAME
).
út
; \

300 
»suÉ
; \

301 })

	)

303 
	#__libc_lock_Œylock_»cursive
(
NAME
) \

304 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
)), 0)

	)

307 
	#__¹ld_lock_Œylock_»cursive
(
NAME
) \

308 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
).
mu‹x
), 0)

	)

311 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

312 
	#__libc_lock_uÆock
(
NAME
) \

313 
	`Îl_uÆock
 (
NAME
, 
LLL_PRIVATE
)

	)

315 
	#__libc_lock_uÆock
(
NAME
) \

316 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
)), 0)

	)

318 
	#__libc_rwlock_uÆock
(
NAME
) \

319 
	`__libc_±f_ÿÎ
 (
__±h»ad_rwlock_uÆock
, (&(
NAME
)), 0)

	)

322 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

324 
	#__libc_lock_uÆock_»cursive
(
NAME
) \

326 ià(--(
NAME
).
út
 == 0) \

328 (
NAME
).
owÃr
 = 
NULL
; \

329 
	`Îl_uÆock
 ((
NAME
).
lock
, 
LLL_PRIVATE
); \

331 } 0)

	)

333 
	#__libc_lock_uÆock_»cursive
(
NAME
) \

334 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
)), 0)

	)

337 #ià
defšed
 
_LIBC
 && defšed 
SHARED


338 
	#__¹ld_lock_deçuÉ_lock_»cursive
(
lock
) \

339 ++((
±h»ad_mu‹x_t
 *)(
lock
))->
__d©a
.
__couÁ
;

	)

341 
	#__¹ld_lock_deçuÉ_uÆock_»cursive
(
lock
) \

342 --((
±h»ad_mu‹x_t
 *)(
lock
))->
__d©a
.
__couÁ
;

	)

344 
	#__¹ld_lock_lock_»cursive
(
NAME
) \

345 
	`GL
(
dl_¹ld_lock_»cursive
è(&(
NAME
).
mu‹x
)

	)

347 
	#__¹ld_lock_uÆock_»cursive
(
NAME
) \

348 
	`GL
(
dl_¹ld_uÆock_»cursive
è(&(
NAME
).
mu‹x
)

	)

350 
	#__¹ld_lock_lock_»cursive
(
NAME
) \

351 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
).
mu‹x
), 0)

	)

353 
	#__¹ld_lock_uÆock_»cursive
(
NAME
) \

354 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
).
mu‹x
), 0)

	)

358 #ià
PTHREAD_ONCE_INIT
 == 0

361 
	#__libc_Úû_defše
(
CLASS
, 
NAME
) \

362 
CLASS
 
±h»ad_Úû_t
 
NAME


	)

364 
	#__libc_Úû_defše
(
CLASS
, 
NAME
) \

365 
CLASS
 
±h»ad_Úû_t
 
NAME
 = 
PTHREAD_ONCE_INIT


	)

369 
	#__libc_Úû
(
ONCE_CONTROL
, 
INIT_FUNCTION
) \

371 ià(
	`PTFAVAIL
 (
__±h»ad_Úû
)) \

372 
	`__libc_±f_ÿÎ_®ways
 (
__±h»ad_Úû
, (&(
ONCE_CONTROL
), \

373 
INIT_FUNCTION
)); \

374 ià((
ONCE_CONTROL
è=ğ
PTHREAD_ONCE_INIT
) { \

375 
	`INIT_FUNCTION
 (); \

376 (
ONCE_CONTROL
) |= 2; \

378 } 0)

	)

385 
_±h»ad_ş—nup_push
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

386 (*
routše
è(*), *
¬g
);

387 
	`_±h»ad_ş—nup_pİ
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

388 
execu‹
);

389 
	`_±h»ad_ş—nup_push_deãr
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

390 (*
routše
è(*), *
¬g
);

391 
	`_±h»ad_ş—nup_pİ_»¡Üe
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

392 
execu‹
);

395 
	#__libc_ş—nup_»giÚ_¡¬t
(
DOIT
, 
FCT
, 
ARG
) \

396 { 
_±h»ad_ş—nup_bufãr
 
_bufãr
; \

397 
_ava
; \

398 ià(
DOIT
) { \

399 
_ava
 = 
	`PTFAVAIL
 (
_±h»ad_ş—nup_push_deãr
); \

400 ià(
_ava
) { \

401 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_push_deãr
, (&
_bufãr
, 
FCT
, \

402 
ARG
)); \

404 
_bufãr
.
__routše
 = (
FCT
); \

405 
_bufãr
.
__¬g
 = (
ARG
); \

408 
_ava
 = 0; \

409 }

	)

412 
	#__libc_ş—nup_»giÚ_’d
(
DOIT
) \

413 ià(
_ava
) { \

414 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_pİ_»¡Üe
, (&
_bufãr
, 
DOIT
));\

415 } ià(
DOIT
) \

416 
_bufãr
.
	`__routše
 (_bufãr.
__¬g
); \

417 
	}

	)
}

420 
	#__libc_ş—nup_’d
(
DOIT
) \

421 ià(
_ava
) { \

422 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_pİ_»¡Üe
, (&
_bufãr
, 
DOIT
));\

423 } ià(
DOIT
) \

424 
_bufãr
.
	`__routše
 (_bufãr.
__¬g
)

	)

428 
__ex‹º_šlše
 

429 
	$__libc_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
f
)

431 ià(
f
->
__do_™
)

432 
f
->
	`__ÿnûl_routše
 (f->
__ÿnûl_¬g
);

433 
	}
}

435 
	#__libc_ş—nup_push
(
fù
, 
¬g
) \

437 
__±h»ad_ş—nup_äame
 
__şäame
 \

438 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__libc_ş—nup_routše
))) \

439 ğ{ .
__ÿnûl_routše
 = (
fù
), .
__ÿnûl_¬g
 = (
¬g
), \

440 .
__do_™
 = 1 };

	)

442 
	#__libc_ş—nup_pİ
(
execu‹
) \

443 
__şäame
.
__do_™
 = (
execu‹
); \

444 } 0)

	)

448 
	#__libc_key_ü—‹
(
KEY
, 
DESTRUCTOR
) \

449 
	`__libc_±f_ÿÎ
 (
__±h»ad_key_ü—‹
, (
KEY
, 
DESTRUCTOR
), 1)

	)

452 
	#__libc_g‘¥ecific
(
KEY
) \

453 
	`__libc_±f_ÿÎ
 (
__±h»ad_g‘¥ecific
, (
KEY
), 
NULL
)

	)

456 
	#__libc_£t¥ecific
(
KEY
, 
VALUE
) \

457 
	`__libc_±f_ÿÎ
 (
__±h»ad_£t¥ecific
, (
KEY
, 
VALUE
), 0)

	)

463 
	#__libc_©fÜk
(
PREPARE
, 
PARENT
, 
CHILD
) \

464 
	`__»gi¡”_©fÜk
 (
PREPARE
, 
PARENT
, 
CHILD
, 
NULL
)

	)

465 
__»gi¡”_©fÜk
 ((*
__´•¬e
) (),

466 (*
__·»Á
) (),

467 (*
__chd
) (),

468 *
__dso_hªdË
);

473 
	`__±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

474 
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__mu‹x_©Œ
);

476 
	`__±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

478 
	`__±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

480 
	`__±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

482 
	`__±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

484 
	`__±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
);

486 
	`__±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
);

488 
	`__±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

489 
__kšd
);

491 #ifdeà
__USE_UNIX98


492 
	`__±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__rwlock
,

493 
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *
__©Œ
);

495 
	`__±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
);

497 
	`__±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
);

499 
	`__±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
);

501 
	`__±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
);

503 
	`__±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
);

505 
	`__±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
);

508 
	`__±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

509 (*
__de¡r_funùiÚ
) (*));

511 
	`__±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

512 
__cÚ¡
 *
__poš‹r
);

514 *
	`__±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
);

516 
	`__±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

517 (*
__š™_routše
) ());

519 
	`__±h»ad_©fÜk
 ((*
__´•¬e
) (),

520 (*
__·»Á
) (),

521 (*
__chd
) ());

527 #iâdeà
__NO_WEAK_PTHREAD_ALIASES


528 #ifdeà
w—k_ex‹º


529 #ià
_LIBC


530 
	~<bp-sym.h
>

532 
	#BP_SYM
 (
sym
è
	)
sym

534 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_š™
))

535 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_de¡roy
))

536 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_lock
))

537 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_Œylock
))

538 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_uÆock
))

539 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x©Œ_š™
))

540 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x©Œ_de¡roy
))

541 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x©Œ_£‰y³
))

542 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_š™
))

543 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_de¡roy
))

544 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_rdlock
))

545 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_Œyrdlock
))

546 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_w¾ock
))

547 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_Œyw¾ock
))

548 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_uÆock
))

549 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_key_ü—‹
))

550 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_£t¥ecific
))

551 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_g‘¥ecific
))

552 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_Úû
))

553 
	$w—k_ex‹º
 (
__±h»ad_š™Ÿlize
)

554 
	$w—k_ex‹º
 (
__±h»ad_©fÜk
)

555 
	`w—k_ex‹º
 (
	$BP_SYM
 (
_±h»ad_ş—nup_push_deãr
))

556 
	`w—k_ex‹º
 (
	$BP_SYM
 (
_±h»ad_ş—nup_pİ_»¡Üe
))

557 
	`w—k_ex‹º
 (
	$BP_SYM
 (
±h»ad_£tÿnûl¡©e
))

559 #´agm¨
w—k
 
__±h»ad_mu‹x_š™


560 #´agm¨
w—k
 
__±h»ad_mu‹x_de¡roy


561 #´agm¨
w—k
 
__±h»ad_mu‹x_lock


562 #´agm¨
w—k
 
__±h»ad_mu‹x_Œylock


563 #´agm¨
w—k
 
__±h»ad_mu‹x_uÆock


564 #´agm¨
w—k
 
__±h»ad_mu‹x©Œ_š™


565 #´agm¨
w—k
 
__±h»ad_mu‹x©Œ_de¡roy


566 #´agm¨
w—k
 
__±h»ad_mu‹x©Œ_£‰y³


567 #´agm¨
w—k
 
__±h»ad_rwlock_de¡roy


568 #´agm¨
w—k
 
__±h»ad_rwlock_rdlock


569 #´agm¨
w—k
 
__±h»ad_rwlock_Œyrdlock


570 #´agm¨
w—k
 
__±h»ad_rwlock_w¾ock


571 #´agm¨
w—k
 
__±h»ad_rwlock_Œyw¾ock


572 #´agm¨
w—k
 
__±h»ad_rwlock_uÆock


573 #´agm¨
w—k
 
__±h»ad_key_ü—‹


574 #´agm¨
w—k
 
__±h»ad_£t¥ecific


575 #´agm¨
w—k
 
__±h»ad_g‘¥ecific


576 #´agm¨
w—k
 
__±h»ad_Úû


577 #´agm¨
w—k
 
__±h»ad_š™Ÿlize


578 #´agm¨
w—k
 
__±h»ad_©fÜk


579 #´agm¨
w—k
 
_±h»ad_ş—nup_push_deãr


580 #´agm¨
w—k
 
_±h»ad_ş—nup_pİ_»¡Üe


581 #´agm¨
w—k
 
±h»ad_£tÿnûl¡©e


	@/usr/include/gconv.h

23 #iâdeà
_GCONV_H


24 
	#_GCONV_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	#__Ãed_mb¡©e_t


	)

28 
	#__Ãed_wšt_t


	)

29 
	~<wch¬.h
>

30 
	#__Ãed_size_t


	)

31 
	#__Ãed_wch¬_t


	)

32 
	~<¡ddef.h
>

35 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

40 
	m__GCONV_OK
 = 0,

41 
	m__GCONV_NOCONV
,

42 
	m__GCONV_NODB
,

43 
	m__GCONV_NOMEM
,

45 
	m__GCONV_EMPTY_INPUT
,

46 
	m__GCONV_FULL_OUTPUT
,

47 
	m__GCONV_ILLEGAL_INPUT
,

48 
	m__GCONV_INCOMPLETE_INPUT
,

50 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

51 
	m__GCONV_INTERNAL_ERROR


58 
	m__GCONV_IS_LAST
 = 0x0001,

59 
	m__GCONV_IGNORE_ERRORS
 = 0x0002

64 
	g__gcÚv_¡•
;

65 
	g__gcÚv_¡•_d©a
;

66 
	g__gcÚv_lßded_objeù
;

67 
	g__gcÚv_Œªs_d©a
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

72 
	t__cÚ¡
 **, __const *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 (*
	t__gcÚv_Œªs_fù
è(
	t__gcÚv_¡•
 *,

85 
	t__gcÚv_¡•_d©a
 *, *,

86 
	t__cÚ¡
 *,

87 
	t__cÚ¡
 **,

88 
	t__cÚ¡
 *, **,

89 
	tsize_t
 *);

92 (*
	t__gcÚv_Œªs_cÚ‹xt_fù
è(*, 
	t__cÚ¡
 *,

93 
	t__cÚ¡
 *,

97 (*
	t__gcÚv_Œªs_qu”y_fù
è(
	t__cÚ¡
 *, __const ***,

98 
	tsize_t
 *);

101 (*
	t__gcÚv_Œªs_š™_fù
) (**, const *);

102 (*
	t__gcÚv_Œªs_’d_fù
) (*);

104 
	s__gcÚv_Œªs_d©a


107 
__gcÚv_Œªs_fù
 
__Œªs_fù
;

108 
__gcÚv_Œªs_cÚ‹xt_fù
 
__Œªs_cÚ‹xt_fù
;

109 
__gcÚv_Œªs_’d_fù
 
__Œªs_’d_fù
;

110 *
__d©a
;

111 
__gcÚv_Œªs_d©a
 *
__Ãxt
;

116 
	s__gcÚv_¡•


118 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

119 
__cÚ¡
 *
__modÇme
;

121 
__couÁ”
;

123 *
__äom_Çme
;

124 *
__to_Çme
;

126 
__gcÚv_fù
 
__fù
;

127 
__gcÚv_btowc_fù
 
__btowc_fù
;

128 
__gcÚv_š™_fù
 
__š™_fù
;

129 
__gcÚv_’d_fù
 
__’d_fù
;

133 
__mš_Ãeded_äom
;

134 
__max_Ãeded_äom
;

135 
__mš_Ãeded_to
;

136 
__max_Ãeded_to
;

139 
__¡©eful
;

141 *
__d©a
;

146 
	s__gcÚv_¡•_d©a


148 *
__outbuf
;

149 *
__outbuãnd
;

153 
__æags
;

157 
__švoÿtiÚ_couÁ”
;

161 
__š‹º®_u£
;

163 
__mb¡©e_t
 *
__¡©•
;

164 
__mb¡©e_t
 
__¡©e
;

168 
__gcÚv_Œªs_d©a
 *
__Œªs
;

173 
	s__gcÚv_šfo


175 
size_t
 
__n¡•s
;

176 
__gcÚv_¡•
 *
__¡•s
;

177 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
 
__æex¬r
;

178 } *
	t__gcÚv_t
;

	@/usr/include/gnu/stubs-32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___k”Ãl_co¦


	)

11 
	#__¡ub___k”Ãl_sšl


	)

12 
	#__¡ub___k”Ãl_Æ


	)

13 
	#__¡ub_chæags


	)

14 
	#__¡ub_ç‰ach


	)

15 
	#__¡ub_fchæags


	)

16 
	#__¡ub_fd‘ach


	)

17 
	#__¡ub_g‰y


	)

18 
	#__¡ub_lchmod


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/wchar.h

24 #iâdeà
_WCHAR_H


26 #ià!
defšed
 
__Ãed_mb¡©e_t
 && !defšed 
__Ãed_wšt_t


27 
	#_WCHAR_H
 1

	)

28 
	~<ã©u»s.h
>

31 #ifdeà
_WCHAR_H


33 
	#__Ãed___FILE


	)

34 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


35 
	#__Ãed_FILE


	)

37 
	~<¡dio.h
>

39 
	#__Ãed___va_li¡


	)

40 
	~<¡d¬g.h
>

42 
	~<b™s/wch¬.h
>

45 
	#__Ãed_size_t


	)

46 
	#__Ãed_wch¬_t


	)

47 
	#__Ãed_NULL


	)

49 #ià
defšed
 
_WCHAR_H
 || defšed 
__Ãed_wšt_t
 || !defšed 
__WINT_TYPE__


50 #undeà
__Ãed_wšt_t


51 
	#__Ãed_wšt_t


	)

52 
	~<¡ddef.h
>

56 #iâdeà
_WINT_T


61 
	#_WINT_T


	)

62 
	twšt_t
;

66 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES
 \

67 && 
defšed
 
__WINT_TYPE__


68 
__BEGIN_NAMESPACE_STD


69 
__WINT_TYPE__
 
	twšt_t
;

70 
	g__END_NAMESPACE_STD


75 #ià(
defšed
 
_WCHAR_H
 || defšed 
__Ãed_mb¡©e_t
è&& !defšed 
__mb¡©e_t_defšed


76 
	#__mb¡©e_t_defšed
 1

	)

80 
	m__couÁ
;

83 #ifdeà
__WINT_TYPE__


84 
__WINT_TYPE__
 
	m__wch
;

86 
wšt_t
 
	m__wch
;

88 
	m__wchb
[4];

89 } 
	m__v®ue
;

90 } 
	t__mb¡©e_t
;

92 #undeà
__Ãed_mb¡©e_t


97 #ifdeà
_WCHAR_H


99 
__BEGIN_NAMESPACE_C99


101 
__mb¡©e_t
 
	tmb¡©e_t
;

102 
	g__END_NAMESPACE_C99


103 #ifdeà
__USE_GNU


104 
	$__USING_NAMESPACE_C99
(
mb¡©e_t
)

107 #iâdeà
WCHAR_MIN


109 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

110 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

113 #iâdeà
WEOF


114 
	#WEOF
 (0xffffffffu)

	)

119 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_UNIX98


120 
	~<wùy³.h
>

124 
__BEGIN_DECLS


126 
__BEGIN_NAMESPACE_STD


129 
tm
;

130 
__END_NAMESPACE_STD


134 
	$__USING_NAMESPACE_STD
(
tm
)

137 
__BEGIN_NAMESPACE_STD


139 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

140 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

142 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

143 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

144 
__THROW
;

147 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

150 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

151 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

152 
__THROW
;

155 
	$wcscmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
)

156 
__THROW
 
__©Œibu‹_pu»__
;

158 
	$wc¢cmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

159 
__THROW
 
__©Œibu‹_pu»__
;

160 
__END_NAMESPACE_STD


162 #ifdeà
__USE_GNU


164 
	$wcsÿ£cmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

167 
	$wc¢ÿ£cmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

168 
size_t
 
__n
è
__THROW
;

172 
	~<xloÿË.h
>

174 
	$wcsÿ£cmp_l
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

175 
__loÿË_t
 
__loc
è
__THROW
;

177 
	$wc¢ÿ£cmp_l
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

178 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

181 
__BEGIN_NAMESPACE_STD


184 
	$wcscŞl
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

188 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

189 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

190 
__END_NAMESPACE_STD


192 #ifdeà
__USE_GNU


198 
	$wcscŞl_l
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

199 
__loÿË_t
 
__loc
è
__THROW
;

204 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, 
__cÚ¡
 wch¬_ˆ*
__s2
,

205 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

208 
wch¬_t
 *
	$wcsdup
 (
__cÚ¡
 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

211 
__BEGIN_NAMESPACE_STD


213 
wch¬_t
 *
	$wcschr
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

214 
__THROW
 
__©Œibu‹_pu»__
;

216 
wch¬_t
 *
	$wc¤chr
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

217 
__THROW
 
__©Œibu‹_pu»__
;

218 
__END_NAMESPACE_STD


220 #ifdeà
__USE_GNU


223 
wch¬_t
 *
	$wcschºul
 (
__cÚ¡
 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

224 
__THROW
 
__©Œibu‹_pu»__
;

227 
__BEGIN_NAMESPACE_STD


230 
size_t
 
	$wcsc¥n
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, __cÚ¡ wch¬_ˆ*
__»jeù
)

231 
__THROW
 
__©Œibu‹_pu»__
;

234 
size_t
 
	$wcs¥n
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, __cÚ¡ wch¬_ˆ*
__acû±
)

235 
__THROW
 
__©Œibu‹_pu»__
;

237 
wch¬_t
 *
	$wc¥brk
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, __cÚ¡ wch¬_ˆ*
__acû±
)

238 
__THROW
 
__©Œibu‹_pu»__
;

240 
wch¬_t
 *
	$wcs¡r
 (
__cÚ¡
 
wch¬_t
 *
__hay¡ack
, __cÚ¡ wch¬_ˆ*
__ÃedË
)

241 
__THROW
 
__©Œibu‹_pu»__
;

244 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

245 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__d–im
,

246 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

249 
size_t
 
	$wc¦’
 (
__cÚ¡
 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

250 
__END_NAMESPACE_STD


252 #ifdeà
__USE_XOPEN


254 
wch¬_t
 *
	$wcswcs
 (
__cÚ¡
 
wch¬_t
 *
__hay¡ack
, __cÚ¡ wch¬_ˆ*
__ÃedË
)

255 
__THROW
 
__©Œibu‹_pu»__
;

258 #ifdeà
__USE_GNU


260 
size_t
 
	$wc¢Ën
 (
__cÚ¡
 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

261 
__THROW
 
__©Œibu‹_pu»__
;

265 
__BEGIN_NAMESPACE_STD


267 
wch¬_t
 *
	$wmemchr
 (
__cÚ¡
 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

268 
__THROW
 
__©Œibu‹_pu»__
;

271 
	$wmemcmp
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s1
,

272 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

273 
__THROW
 
__©Œibu‹_pu»__
;

276 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

277 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

281 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, 
__cÚ¡
 wch¬_ˆ*
__s2
, 
size_t
 
__n
)

282 
__THROW
;

285 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

286 
__END_NAMESPACE_STD


288 #ifdeà
__USE_GNU


291 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

292 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

293 
__THROW
;

297 
__BEGIN_NAMESPACE_STD


300 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

304 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

308 
	$mbsš™
 (
__cÚ¡
 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

312 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

313 
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

314 
mb¡©e_t
 *
__p
è
__THROW
;

317 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

318 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

321 
size_t
 
	$__mb¾’
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

322 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

323 
size_t
 
	$mb¾’
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

324 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

325 
__END_NAMESPACE_STD


327 #ifdeà
__USE_EXTERN_INLINES


333 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

334 
__ex‹º_šlše
 
wšt_t


335 
	`__NTH
 (
	$btowc
 (
__c
))

336 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

337 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

339 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

340 
__ex‹º_šlše
 

341 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

342 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

343 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

345 
__ex‹º_šlše
 
size_t


346 
__NTH
 (
	$mb¾’
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

347 
mb¡©e_t
 *
__»¡riù
 
__ps
))

348 {  (
__ps
 !ğ
NULL


349 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

352 
__BEGIN_NAMESPACE_STD


355 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

356 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

357 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

361 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

362 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

363 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

364 
__END_NAMESPACE_STD


367 #ifdef 
__USE_GNU


370 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

371 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

372 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

376 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

377 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

378 
size_t
 
__nwc
, size_ˆ
__Ën
,

379 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

384 #ifdeà
__USE_XOPEN


386 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

390 
	$wcswidth
 (
__cÚ¡
 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

394 
__BEGIN_NAMESPACE_STD


397 
	$wc¡od
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

398 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

399 
__END_NAMESPACE_STD


401 #ifdeà
__USE_ISOC99


402 
__BEGIN_NAMESPACE_C99


404 
	$wc¡of
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

405 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

406 
	$wc¡Şd
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

407 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

408 
__END_NAMESPACE_C99


412 
__BEGIN_NAMESPACE_STD


415 
	$wc¡Ş
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

416 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

420 
	$wc¡oul
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

421 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

422 
__THROW
;

423 
__END_NAMESPACE_STD


425 #ià
defšed
 
__USE_ISOC99
 || (defšed 
__GNUC__
 && defšed 
__USE_GNU
)

426 
__BEGIN_NAMESPACE_C99


429 
__ex‹nsiÚ__


430 
	$wc¡Şl
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

431 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

432 
__THROW
;

436 
__ex‹nsiÚ__


437 
	$wc¡ouÎ
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

438 
wch¬_t
 **
__»¡riù
 
__’d±r
,

439 
__ba£
è
__THROW
;

440 
__END_NAMESPACE_C99


443 #ià
defšed
 
__GNUC__
 && defšed 
__USE_GNU


446 
__ex‹nsiÚ__


447 
	$wc¡oq
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

448 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

449 
__THROW
;

453 
__ex‹nsiÚ__


454 
	$wc¡ouq
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

455 
wch¬_t
 **
__»¡riù
 
__’d±r
,

456 
__ba£
è
__THROW
;

459 #ifdeà
__USE_GNU


473 
	~<xloÿË.h
>

477 
	$wc¡Ş_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

478 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

479 
__loÿË_t
 
__loc
è
__THROW
;

481 
	$wc¡oul_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

482 
wch¬_t
 **
__»¡riù
 
__’d±r
,

483 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

485 
__ex‹nsiÚ__


486 
	$wc¡Şl_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

487 
wch¬_t
 **
__»¡riù
 
__’d±r
,

488 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

490 
__ex‹nsiÚ__


491 
	$wc¡ouÎ_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

492 
wch¬_t
 **
__»¡riù
 
__’d±r
,

493 
__ba£
, 
__loÿË_t
 
__loc
)

494 
__THROW
;

496 
	$wc¡od_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

497 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

498 
__THROW
;

500 
	$wc¡of_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

501 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

502 
__THROW
;

504 
	$wc¡Şd_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

505 
wch¬_t
 **
__»¡riù
 
__’d±r
,

506 
__loÿË_t
 
__loc
è
__THROW
;

510 #ifdef 
__USE_GNU


513 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
è
__THROW
;

517 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
)

518 
__THROW
;

524 #ifdef 
__USE_GNU


527 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

530 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


531 
__BEGIN_NAMESPACE_STD


534 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

541 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

542 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

548 
	`w´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

551 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

552 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

553 
__THROW
 ;

559 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

560 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

561 
__gnuc_va_li¡
 
__¬g
)

567 
	`vw´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

568 
__gnuc_va_li¡
 
__¬g
)

572 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

573 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

574 
__gnuc_va_li¡
 
__¬g
)

575 
__THROW
 ;

582 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

583 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

589 
	`wsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

592 
	$swsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

593 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

594 
__THROW
 ;

596 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

597 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

598 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

599 #ifdeà
__REDIRECT


603 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

604 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

605 
__isoc99_fwsÿnf
)

607 
	`__REDIRECT
 (
wsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

608 
__isoc99_wsÿnf
)

610 
	`__REDIRECT
 (
swsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

611 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

612 
__isoc99_swsÿnf
)

613 
__THROW
 ;

615 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

616 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

617 
	`__isoc99_wsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

618 
	$__isoc99_swsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

619 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

620 
__THROW
;

621 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

622 
	#wsÿnf
 
__isoc99_wsÿnf


	)

623 
	#swsÿnf
 
__isoc99_swsÿnf


	)

627 
__END_NAMESPACE_STD


630 #ifdeà
__USE_ISOC99


631 
__BEGIN_NAMESPACE_C99


636 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

637 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

638 
__gnuc_va_li¡
 
__¬g
)

644 
	`vwsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

645 
__gnuc_va_li¡
 
__¬g
)

648 
	$vswsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

649 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

650 
__gnuc_va_li¡
 
__¬g
)

651 
__THROW
 ;

653 #ià!
defšed
 
__USE_GNU
 \

654 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

655 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

656 #ifdeà
__REDIRECT


657 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

658 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

659 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

661 
	`__REDIRECT
 (
vwsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

662 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

664 
	`__REDIRECT
 (
vswsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

665 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

666 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

667 
__THROW
 ;

669 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

670 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

671 
__gnuc_va_li¡
 
__¬g
);

672 
	`__isoc99_vwsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

673 
__gnuc_va_li¡
 
__¬g
);

674 
	$__isoc99_vswsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

675 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

676 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

677 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

678 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

679 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

683 
__END_NAMESPACE_C99


687 
__BEGIN_NAMESPACE_STD


692 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

693 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

699 
wšt_t
 
	`g‘wch¬
 ();

706 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

707 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

713 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

721 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

722 
__FILE
 *
__»¡riù
 
__¡»am
);

728 
	`åutws
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ws
,

729 
__FILE
 *
__»¡riù
 
__¡»am
);

736 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

737 
__END_NAMESPACE_STD


740 #ifdeà
__USE_GNU


748 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

749 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

757 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

765 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

774 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

775 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

784 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

785 
__FILE
 *
__»¡riù
 
__¡»am
);

793 
	`åutws_uÆocked
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ws
,

794 
__FILE
 *
__»¡riù
 
__¡»am
);

798 
__BEGIN_NAMESPACE_C99


802 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

803 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

804 
__cÚ¡
 
tm
 *
__»¡riù
 
__
è
__THROW
;

805 
__END_NAMESPACE_C99


807 #ifdeà
__USE_GNU


808 
	~<xloÿË.h
>

812 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

813 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

814 
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

815 
__loÿË_t
 
__loc
è
__THROW
;

824 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_GNU


825 
	#__Ãed_iswxxx


	)

826 
	~<wùy³.h
>

830 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


831 
	~<b™s/wch¬2.h
>

834 #ifdeà
__LDBL_COMPAT


835 
	~<b™s/wch¬-ldbl.h
>

838 
__END_DECLS


844 #undeà
__Ãed_mb¡©e_t


845 #undeà
__Ãed_wšt_t


	@/usr/include/asm-generic/errno.h

1 #iâdeà
_ASM_GENERIC_ERRNO_H


2 
	#_ASM_GENERIC_ERRNO_H


	)

4 
	~<asm-g’”ic/”ºo-ba£.h
>

6 
	#EDEADLK
 35

	)

7 
	#ENAMETOOLONG
 36

	)

8 
	#ENOLCK
 37

	)

9 
	#ENOSYS
 38

	)

10 
	#ENOTEMPTY
 39

	)

11 
	#ELOOP
 40

	)

12 
	#EWOULDBLOCK
 
EAGAIN


	)

13 
	#ENOMSG
 42

	)

14 
	#EIDRM
 43

	)

15 
	#ECHRNG
 44

	)

16 
	#EL2NSYNC
 45

	)

17 
	#EL3HLT
 46

	)

18 
	#EL3RST
 47

	)

19 
	#ELNRNG
 48

	)

20 
	#EUNATCH
 49

	)

21 
	#ENOCSI
 50

	)

22 
	#EL2HLT
 51

	)

23 
	#EBADE
 52

	)

24 
	#EBADR
 53

	)

25 
	#EXFULL
 54

	)

26 
	#ENOANO
 55

	)

27 
	#EBADRQC
 56

	)

28 
	#EBADSLT
 57

	)

30 
	#EDEADLOCK
 
EDEADLK


	)

32 
	#EBFONT
 59

	)

33 
	#ENOSTR
 60

	)

34 
	#ENODATA
 61

	)

35 
	#ETIME
 62

	)

36 
	#ENOSR
 63

	)

37 
	#ENONET
 64

	)

38 
	#ENOPKG
 65

	)

39 
	#EREMOTE
 66

	)

40 
	#ENOLINK
 67

	)

41 
	#EADV
 68

	)

42 
	#ESRMNT
 69

	)

43 
	#ECOMM
 70

	)

44 
	#EPROTO
 71

	)

45 
	#EMULTIHOP
 72

	)

46 
	#EDOTDOT
 73

	)

47 
	#EBADMSG
 74

	)

48 
	#EOVERFLOW
 75

	)

49 
	#ENOTUNIQ
 76

	)

50 
	#EBADFD
 77

	)

51 
	#EREMCHG
 78

	)

52 
	#ELIBACC
 79

	)

53 
	#ELIBBAD
 80

	)

54 
	#ELIBSCN
 81

	)

55 
	#ELIBMAX
 82

	)

56 
	#ELIBEXEC
 83

	)

57 
	#EILSEQ
 84

	)

58 
	#ERESTART
 85

	)

59 
	#ESTRPIPE
 86

	)

60 
	#EUSERS
 87

	)

61 
	#ENOTSOCK
 88

	)

62 
	#EDESTADDRREQ
 89

	)

63 
	#EMSGSIZE
 90

	)

64 
	#EPROTOTYPE
 91

	)

65 
	#ENOPROTOOPT
 92

	)

66 
	#EPROTONOSUPPORT
 93

	)

67 
	#ESOCKTNOSUPPORT
 94

	)

68 
	#EOPNOTSUPP
 95

	)

69 
	#EPFNOSUPPORT
 96

	)

70 
	#EAFNOSUPPORT
 97

	)

71 
	#EADDRINUSE
 98

	)

72 
	#EADDRNOTAVAIL
 99

	)

73 
	#ENETDOWN
 100

	)

74 
	#ENETUNREACH
 101

	)

75 
	#ENETRESET
 102

	)

76 
	#ECONNABORTED
 103

	)

77 
	#ECONNRESET
 104

	)

78 
	#ENOBUFS
 105

	)

79 
	#EISCONN
 106

	)

80 
	#ENOTCONN
 107

	)

81 
	#ESHUTDOWN
 108

	)

82 
	#ETOOMANYREFS
 109

	)

83 
	#ETIMEDOUT
 110

	)

84 
	#ECONNREFUSED
 111

	)

85 
	#EHOSTDOWN
 112

	)

86 
	#EHOSTUNREACH
 113

	)

87 
	#EALREADY
 114

	)

88 
	#EINPROGRESS
 115

	)

89 
	#ESTALE
 116

	)

90 
	#EUCLEAN
 117

	)

91 
	#ENOTNAM
 118

	)

92 
	#ENAVAIL
 119

	)

93 
	#EISNAM
 120

	)

94 
	#EREMOTEIO
 121

	)

95 
	#EDQUOT
 122

	)

97 
	#ENOMEDIUM
 123

	)

98 
	#EMEDIUMTYPE
 124

	)

99 
	#ECANCELED
 125

	)

100 
	#ENOKEY
 126

	)

101 
	#EKEYEXPIRED
 127

	)

102 
	#EKEYREVOKED
 128

	)

103 
	#EKEYREJECTED
 129

	)

106 
	#EOWNERDEAD
 130

	)

107 
	#ENOTRECOVERABLE
 131

	)

	@/usr/include/bits/wchar-ldbl.h

20 #iâdeà
_WCHAR_H


24 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


25 
__BEGIN_NAMESPACE_C99


26 
__LDBL_REDIR_DECL
 (
fw´štf
);

27 
__LDBL_REDIR_DECL
 (
w´štf
);

28 
__LDBL_REDIR_DECL
 (
sw´štf
);

29 
__LDBL_REDIR_DECL
 (
vfw´štf
);

30 
__LDBL_REDIR_DECL
 (
vw´štf
);

31 
__LDBL_REDIR_DECL
 (
vsw´štf
);

32 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

33 && !
defšed
 
	g__REDIRECT
 \

34 && (
defšed
 
	g__STRICT_ANSI__
 || defšed 
	g__USE_XOPEN2K
)

35 
	$__LDBL_REDIR1_DECL
 (
fwsÿnf
, 
__Ædbl___isoc99_fwsÿnf
)

36 
	$__LDBL_REDIR1_DECL
 (
wsÿnf
, 
__Ædbl___isoc99_wsÿnf
)

37 
	$__LDBL_REDIR1_DECL
 (
swsÿnf
, 
__Ædbl___isoc99_swsÿnf
)

39 
	`__LDBL_REDIR_DECL
 (
fwsÿnf
);

40 
	`__LDBL_REDIR_DECL
 (
wsÿnf
);

41 
	`__LDBL_REDIR_DECL
 (
swsÿnf
);

43 
__END_NAMESPACE_C99


46 #ifdeà
__USE_ISOC99


47 
__BEGIN_NAMESPACE_C99


48 
	`__LDBL_REDIR1_DECL
 (
wc¡Şd
, 
wc¡od
);

49 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

50 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

51 
	$__LDBL_REDIR1_DECL
 (
vfwsÿnf
, 
__Ædbl___isoc99_vfwsÿnf
)

52 
	$__LDBL_REDIR1_DECL
 (
vwsÿnf
, 
__Ædbl___isoc99_vwsÿnf
)

53 
	$__LDBL_REDIR1_DECL
 (
vswsÿnf
, 
__Ædbl___isoc99_vswsÿnf
)

55 
	`__LDBL_REDIR_DECL
 (
vfwsÿnf
);

56 
	`__LDBL_REDIR_DECL
 (
vwsÿnf
);

57 
	`__LDBL_REDIR_DECL
 (
vswsÿnf
);

59 
__END_NAMESPACE_C99


62 #ifdeà
__USE_GNU


63 
	`__LDBL_REDIR1_DECL
 (
wc¡Şd_l
, 
wc¡od_l
);

66 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


67 
	$__LDBL_REDIR_DECL
 (
__sw´štf_chk
)

68 
	$__LDBL_REDIR_DECL
 (
__vsw´štf_chk
)

69 #ià
__USE_FORTIFY_LEVEL
 > 1

70 
	$__LDBL_REDIR_DECL
 (
__fw´štf_chk
)

71 
	$__LDBL_REDIR_DECL
 (
__w´štf_chk
)

72 
	$__LDBL_REDIR_DECL
 (
__vfw´štf_chk
)

73 
	$__LDBL_REDIR_DECL
 (
__vw´štf_chk
)

	@/usr/include/bits/wchar2.h

20 #iâdeà
_WCHAR_H


25 
wch¬_t
 *
	$__wmemıy_chk
 (
wch¬_t
 *
__»¡riù
 
__s1
,

26 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

27 
size_t
 
__ns1
è
__THROW
;

28 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemıy_®Ÿs
,

29 (
wch¬_t
 *
__»¡riù
 
__s1
,

30 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
),

31 
wmemıy
);

32 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemıy_chk_w¬n
,

33 (
wch¬_t
 *
__»¡riù
 
__s1
,

34 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

35 
size_t
 
__ns1
), 
__wmemıy_chk
)

36 
	`__w¬Ç‰r
 ("wmemcpy called with†ength biggerhan size of destination "

39 
__ex‹º_®ways_šlše
 
wch¬_t
 *

40 
	`__NTH
 (
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
, 
__cÚ¡
 wch¬_ˆ*__»¡riù 
__s2
,

41 
size_t
 
__n
))

43 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

45 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

46  
	`__wmemıy_chk
 (
__s1
, 
__s2
, 
__n
,

47 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

49 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

50  
	`__wmemıy_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

51 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

53  
	`__wmemıy_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

54 
	}
}

57 
wch¬_t
 *
	$__wmemmove_chk
 (
wch¬_t
 *
__s1
, 
__cÚ¡
 wch¬_ˆ*
__s2
,

58 
size_t
 
__n
, size_ˆ
__ns1
è
__THROW
;

59 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_®Ÿs
, (wch¬_ˆ*
__s1
,

60 
__cÚ¡
 
wch¬_t
 *
__s2
,

61 
size_t
 
__n
), 
wmemmove
);

62 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_chk_w¬n
,

63 (
wch¬_t
 *
__»¡riù
 
__s1
,

64 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

65 
size_t
 
__ns1
), 
__wmemmove_chk
)

66 
	`__w¬Ç‰r
 ("wmemmove called with†ength biggerhan size of destination "

69 
__ex‹º_®ways_šlše
 
wch¬_t
 *

70 
	`__NTH
 (
	$wmemmove
 (
wch¬_t
 *
__»¡riù
 
__s1
, 
__cÚ¡
 wch¬_ˆ*__»¡riù 
__s2
,

71 
size_t
 
__n
))

73 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

75 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

76  
	`__wmemmove_chk
 (
__s1
, 
__s2
, 
__n
,

77 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

79 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

80  
	`__wmemmove_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

81 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

83  
	`__wmemmove_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

84 
	}
}

87 #ifdeà
__USE_GNU


88 
wch¬_t
 *
	$__wmempıy_chk
 (
wch¬_t
 *
__»¡riù
 
__s1
,

89 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

90 
size_t
 
__ns1
è
__THROW
;

91 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmempıy_®Ÿs
,

92 (
wch¬_t
 *
__»¡riù
 
__s1
,

93 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
,

94 
size_t
 
__n
), 
wmempıy
);

95 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmempıy_chk_w¬n
,

96 (
wch¬_t
 *
__»¡riù
 
__s1
,

97 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

98 
size_t
 
__ns1
), 
__wmempıy_chk
)

99 
	`__w¬Ç‰r
 ("wmempcpy called with†ength biggerhan size of destination "

102 
__ex‹º_®ways_šlše
 
wch¬_t
 *

103 
	`__NTH
 (
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
, 
__cÚ¡
 wch¬_ˆ*__»¡riù 
__s2
,

104 
size_t
 
__n
))

106 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

108 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

109  
	`__wmempıy_chk
 (
__s1
, 
__s2
, 
__n
,

110 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

112 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

113  
	`__wmempıy_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

114 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

116  
	`__wmempıy_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

117 
	}
}

121 
wch¬_t
 *
	$__wmem£t_chk
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
,

122 
size_t
 
__ns
è
__THROW
;

123 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_®Ÿs
, (wch¬_ˆ*
__s
, wch¬_ˆ
__c
,

124 
size_t
 
__n
), 
wmem£t
);

125 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_chk_w¬n
,

126 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
,

127 
size_t
 
__ns
), 
__wmem£t_chk
)

128 
	`__w¬Ç‰r
 ("wmemset called with†ength biggerhan size of destination "

131 
__ex‹º_®ways_šlše
 
wch¬_t
 *

132 
	`__NTH
 (
	$wmem£t
 (
wch¬_t
 *
__»¡riù
 
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
))

134 ià(
	`__bos0
 (
__s
è!ğ(
size_t
) -1)

136 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

137  
	`__wmem£t_chk
 (
__s
, 
__c
, 
__n
, 
	`__bos0
 (__sè/  (
wch¬_t
));

139 ià(
__n
 > 
	`__bos0
 (
__s
è/  (
wch¬_t
))

140  
	`__wmem£t_chk_w¬n
 (
__s
, 
__c
, 
__n
,

141 
	`__bos0
 (
__s
è/  (
wch¬_t
));

143  
	`__wmem£t_®Ÿs
 (
__s
, 
__c
, 
__n
);

144 
	}
}

147 
wch¬_t
 *
	$__wcsıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

149 
size_t
 
__n
è
__THROW
;

150 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wcsıy_®Ÿs
,

151 (
wch¬_t
 *
__»¡riù
 
__de¡
,

152 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wcsıy
);

154 
__ex‹º_®ways_šlše
 
wch¬_t
 *

155 
	`__NTH
 (
	$wcsıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
))

157 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

158  
	`__wcsıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

159  
	`__wcsıy_®Ÿs
 (
__de¡
, 
__¤c
);

160 
	}
}

163 
wch¬_t
 *
	$__wııy_chk
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
,

164 
size_t
 
__de¡Ën
è
__THROW
;

165 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wııy_®Ÿs
, (wch¬_ˆ*
__de¡
,

166 
__cÚ¡
 
wch¬_t
 *
__¤c
),

167 
wııy
);

169 
__ex‹º_®ways_šlše
 
wch¬_t
 *

170 
	`__NTH
 (
	$wııy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
))

172 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

173  
	`__wııy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

174  
	`__wııy_®Ÿs
 (
__de¡
, 
__¤c
);

175 
	}
}

178 
wch¬_t
 *
	$__wc¢ıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

179 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
,

180 
size_t
 
__de¡Ën
è
__THROW
;

181 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ıy_®Ÿs
,

182 (
wch¬_t
 *
__»¡riù
 
__de¡
,

183 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

184 
size_t
 
__n
), 
wc¢ıy
);

185 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ıy_chk_w¬n
,

186 (
wch¬_t
 *
__»¡riù
 
__de¡
,

187 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

188 
size_t
 
__n
, size_ˆ
__de¡Ën
), 
__wc¢ıy_chk
)

189 
	`__w¬Ç‰r
 ("wcsncpy called with†ength biggerhan size of destination "

192 
__ex‹º_®ways_šlše
 
wch¬_t
 *

193 
	`__NTH
 (
	$wc¢ıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
))

195 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

197 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

198  
	`__wc¢ıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

199 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

200 ià(
__n
 > 
	`__bos
 (
__de¡
è/  (
wch¬_t
))

201  
	`__wc¢ıy_chk_w¬n
 (
__de¡
, 
__¤c
, 
__n
,

202 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

204  
	`__wc¢ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

205 
	}
}

208 
wch¬_t
 *
	$__wınıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

209 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
,

210 
size_t
 
__de¡Ën
è
__THROW
;

211 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wınıy_®Ÿs
,

212 (
wch¬_t
 *
__»¡riù
 
__de¡
,

213 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

214 
size_t
 
__n
), 
wınıy
);

215 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wınıy_chk_w¬n
,

216 (
wch¬_t
 *
__»¡riù
 
__de¡
,

217 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

218 
size_t
 
__n
, size_ˆ
__de¡Ën
), 
__wınıy_chk
)

219 
	`__w¬Ç‰r
 ("wcpncpy called with†ength biggerhan size of destination "

222 
__ex‹º_®ways_šlše
 
wch¬_t
 *

223 
	`__NTH
 (
	$wınıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
))

225 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

227 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

228  
	`__wınıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

229 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

230 ià(
__n
 > 
	`__bos
 (
__de¡
è/  (
wch¬_t
))

231  
	`__wınıy_chk_w¬n
 (
__de¡
, 
__¤c
, 
__n
,

232 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

234  
	`__wınıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

235 
	}
}

238 
wch¬_t
 *
	$__wcsÿt_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

239 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

240 
size_t
 
__de¡Ën
è
__THROW
;

241 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wcsÿt_®Ÿs
,

242 (
wch¬_t
 *
__»¡riù
 
__de¡
,

243 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wcsÿt
);

245 
__ex‹º_®ways_šlše
 
wch¬_t
 *

246 
	`__NTH
 (
	$wcsÿt
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
))

248 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

249  
	`__wcsÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

250  
	`__wcsÿt_®Ÿs
 (
__de¡
, 
__¤c
);

251 
	}
}

254 
wch¬_t
 *
	$__wc¢ÿt_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

255 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

256 
size_t
 
__n
, size_ˆ
__de¡Ën
è
__THROW
;

257 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ÿt_®Ÿs
,

258 (
wch¬_t
 *
__»¡riù
 
__de¡
,

259 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

260 
size_t
 
__n
), 
wc¢ÿt
);

262 
__ex‹º_®ways_šlše
 
wch¬_t
 *

263 
	`__NTH
 (
	$wc¢ÿt
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
))

265 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

266  
	`__wc¢ÿt_chk
 (
__de¡
, 
__¤c
, 
__n
,

267 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

268  
	`__wc¢ÿt_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

269 
	}
}

272 
	$__sw´štf_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

273 
__æag
, 
size_t
 
__s_Ën
,

274 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

275 
__THROW
 ;

277 
	`__REDIRECT_NTH_LDBL
 (
__sw´štf_®Ÿs
,

278 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

279 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, ...),

280 
sw´štf
);

282 #ifdeà
__va_¬g_·ck


283 
__ex‹º_®ways_šlše
 

284 
	`__NTH
 (
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

285 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, ...))

287 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1)

288  
	`__sw´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

289 
	`__bos
 (
__s
è/  (
wch¬_t
),

290 
__fmt
, 
	`__va_¬g_·ck
 ());

291  
	`__sw´štf_®Ÿs
 (
__s
, 
__n
, 
__fmt
, 
	`__va_¬g_·ck
 ());

292 
	}
}

293 #–ià!
defšed
 
__ılu¥lus


295 
	#sw´štf
(
s
, 
n
, ...) \

296 (
	`__bos
 (
s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1 \

297 ? 
	`__sw´štf_chk
 (
s
, 
n
, 
__USE_FORTIFY_LEVEL
 - 1, \

298 
	`__bos
 (
s
è/  (
wch¬_t
), 
__VA_ARGS__
) \

299 : 
	`sw´štf
 (
s
, 
n
, 
__VA_ARGS__
))

	)

302 
	$__vsw´štf_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

303 
__æag
, 
size_t
 
__s_Ën
,

304 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

305 
__gnuc_va_li¡
 
__¬g
)

306 
__THROW
 ;

308 
	`__REDIRECT_NTH_LDBL
 (
__vsw´štf_®Ÿs
,

309 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

310 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
,

311 
__gnuc_va_li¡
 
__­
), 
vsw´štf
);

313 
__ex‹º_®ways_šlše
 

314 
	`__NTH
 (
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

315 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
))

317 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1)

318  
	`__vsw´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

319 
	`__bos
 (
__s
è/  (
wch¬_t
), 
__fmt
, 
__­
);

320  
	`__vsw´štf_®Ÿs
 (
__s
, 
__n
, 
__fmt
, 
__­
);

321 
	}
}

324 #ià
__USE_FORTIFY_LEVEL
 > 1

326 
__fw´štf_chk
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

327 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

328 
__w´štf_chk
 (
__æag
, 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

330 
__vfw´štf_chk
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

331 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

332 
__gnuc_va_li¡
 
__­
);

333 
__vw´štf_chk
 (
__æag
, 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

334 
__gnuc_va_li¡
 
__­
);

336 #ifdeà
__va_¬g_·ck


337 
__ex‹º_®ways_šlše
 

338 
	$w´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, ...)

340  
	`__w´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

341 
	}
}

343 
__ex‹º_®ways_šlše
 

344 
	$fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__cÚ¡
 
wch¬_t
 *__»¡riù 
__fmt
, ...)

346  
	`__fw´štf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

347 
	`__va_¬g_·ck
 ());

348 
	}
}

349 #–ià!
defšed
 
__ılu¥lus


350 
	#w´štf
(...) \

351 
	`__w´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

352 
	#fw´štf
(
¡»am
, ...) \

353 
	`__fw´štf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

356 
__ex‹º_®ways_šlše
 

357 
	$vw´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
)

359  
	`__vw´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

360 
	}
}

362 
__ex‹º_®ways_šlše
 

363 
	$vfw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

364 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
)

366  
	`__vfw´štf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

367 
	}
}

371 
wch¬_t
 *
	$__fg‘ws_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

372 
__FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

373 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_®Ÿs
,

374 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
,

375 
__FILE
 *
__»¡riù
 
__¡»am
), 
fg‘ws
è
__wur
;

376 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_chk_w¬n
,

377 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

378 
__FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘ws_chk
)

379 
__wur
 
	`__w¬Ç‰r
 ("fgetws called with bigger sizehan†ength "

382 
__ex‹º_®ways_šlše
 
__wur
 
wch¬_t
 *

383 
	$fg‘ws
 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
, 
__FILE
 *__»¡riù 
__¡»am
)

385 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

387 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

388  
	`__fg‘ws_chk
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

389 
__n
, 
__¡»am
);

391 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
è/  (
wch¬_t
))

392  
	`__fg‘ws_chk_w¬n
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

393 
__n
, 
__¡»am
);

395  
	`__fg‘ws_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

396 
	}
}

398 #ifdeà
__USE_GNU


399 
wch¬_t
 *
	$__fg‘ws_uÆocked_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
,

400 
__n
, 
__FILE
 *
__»¡riù
 
__¡»am
)

401 
__wur
;

402 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_uÆocked_®Ÿs
,

403 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
,

404 
__FILE
 *
__»¡riù
 
__¡»am
), 
fg‘ws_uÆocked
)

405 
__wur
;

406 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_uÆocked_chk_w¬n
,

407 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

408 
__FILE
 *
__»¡riù
 
__¡»am
),

409 
__fg‘ws_uÆocked_chk
)

410 
__wur
 
	`__w¬Ç‰r
 ("fgetws_unlocked called with bigger sizehan†ength "

413 
__ex‹º_®ways_šlše
 
__wur
 
wch¬_t
 *

414 
	$fg‘ws_uÆocked
 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
, 
__FILE
 *__»¡riù 
__¡»am
)

416 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

418 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

419  
	`__fg‘ws_uÆocked_chk
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

420 
__n
, 
__¡»am
);

422 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
è/  (
wch¬_t
))

423  
	`__fg‘ws_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

424 
__n
, 
__¡»am
);

426  
	`__fg‘ws_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

427 
	}
}

431 
size_t
 
	$__wütomb_chk
 (*
__s
, 
wch¬_t
 
__wch¬
, 
mb¡©e_t
 *
__p
,

432 
size_t
 
__buæ’
è
__THROW
 
__wur
;

433 
size_t
 
	`__REDIRECT_NTH
 (
__wütomb_®Ÿs
,

434 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wch¬
,

435 
mb¡©e_t
 *
__»¡riù
 
__ps
), 
wütomb
è
__wur
;

437 
__ex‹º_®ways_šlše
 
__wur
 
size_t


438 
	`__NTH
 (
	$wütomb
 (*
__s
, 
wch¬_t
 
__wch¬
, 
mb¡©e_t
 *
__ps
))

443 
	#__WCHAR_MB_LEN_MAX
 16

	)

444 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__WCHAR_MB_LEN_MAX


447 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__WCHAR_MB_LEN_MAX
 > __bos (__s))

448  
	`__wütomb_chk
 (
__s
, 
__wch¬
, 
__ps
, 
	`__bos
 (__s));

449  
	`__wütomb_®Ÿs
 (
__s
, 
__wch¬
, 
__ps
);

450 
	}
}

453 
size_t
 
	$__mb¤towcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

454 
__cÚ¡
 **
__»¡riù
 
__¤c
,

455 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

456 
size_t
 
__d¡Ën
è
__THROW
;

457 
size_t
 
	`__REDIRECT_NTH
 (
__mb¤towcs_®Ÿs
,

458 (
wch¬_t
 *
__»¡riù
 
__d¡
,

459 
__cÚ¡
 **
__»¡riù
 
__¤c
,

460 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

461 
mb¤towcs
);

462 
size_t
 
	`__REDIRECT_NTH
 (
__mb¤towcs_chk_w¬n
,

463 (
wch¬_t
 *
__»¡riù
 
__d¡
,

464 
__cÚ¡
 **
__»¡riù
 
__¤c
,

465 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

466 
size_t
 
__d¡Ën
), 
__mb¤towcs_chk
)

467 
	`__w¬Ç‰r
 ("mbsrtowcs called with dst buffer smallerhan†en "

470 
__ex‹º_®ways_šlše
 
size_t


471 
	`__NTH
 (
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, 
__cÚ¡
 **__»¡riù 
__¤c
,

472 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

474 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

476 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

477  
	`__mb¤towcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
,

478 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

480 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

481  
	`__mb¤towcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
,

482 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

484  
	`__mb¤towcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
);

485 
	}
}

488 
size_t
 
	$__wc¤tombs_chk
 (*
__»¡riù
 
__d¡
,

489 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

490 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

491 
size_t
 
__d¡Ën
è
__THROW
;

492 
size_t
 
	`__REDIRECT_NTH
 (
__wc¤tombs_®Ÿs
,

493 (*
__»¡riù
 
__d¡
,

494 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

495 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

496 
wc¤tombs
);

497 
size_t
 
	`__REDIRECT_NTH
 (
__wc¤tombs_chk_w¬n
,

498 (*
__»¡riù
 
__d¡
,

499 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

500 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

501 
size_t
 
__d¡Ën
), 
__wc¤tombs_chk
)

502 
	`__w¬Ç‰r
 ("wcsrtombs called with dst buffer smallerhan†en");

504 
__ex‹º_®ways_šlše
 
size_t


505 
	`__NTH
 (
	$wc¤tombs
 (*
__»¡riù
 
__d¡
, 
__cÚ¡
 
wch¬_t
 **__»¡riù 
__¤c
,

506 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

508 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

510 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

511  
	`__wc¤tombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
, 
	`__bos
 (__dst));

513 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

514  
	`__wc¤tombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
, 
	`__bos
 (__dst));

516  
	`__wc¤tombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
);

517 
	}
}

520 #ifdeà
__USE_GNU


521 
size_t
 
	$__mb¢¹owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

522 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

523 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

524 
size_t
 
__d¡Ën
è
__THROW
;

525 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢¹owcs_®Ÿs
,

526 (
wch¬_t
 *
__»¡riù
 
__d¡
,

527 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

528 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

529 
mb¢¹owcs
);

530 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢¹owcs_chk_w¬n
,

531 (
wch¬_t
 *
__»¡riù
 
__d¡
,

532 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

533 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

534 
size_t
 
__d¡Ën
), 
__mb¢¹owcs_chk
)

535 
	`__w¬Ç‰r
 ("mbsnrtowcs called with dst buffer smallerhan†en "

538 
__ex‹º_®ways_šlše
 
size_t


539 
	`__NTH
 (
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, 
__cÚ¡
 **__»¡riù 
__¤c
,

540 
size_t
 
__nmc
, size_ˆ
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

542 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

544 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

545  
	`__mb¢¹owcs_chk
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
,

546 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

548 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

549  
	`__mb¢¹owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
,

550 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

552  
	`__mb¢¹owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
);

553 
	}
}

556 
size_t
 
	$__wc¢¹ombs_chk
 (*
__»¡riù
 
__d¡
,

557 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

558 
size_t
 
__nwc
, size_ˆ
__Ën
,

559 
mb¡©e_t
 *
__»¡riù
 
__ps
, 
size_t
 
__d¡Ën
)

560 
__THROW
;

561 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢¹ombs_®Ÿs
,

562 (*
__»¡riù
 
__d¡
,

563 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

564 
size_t
 
__nwc
, size_ˆ
__Ën
,

565 
mb¡©e_t
 *
__»¡riù
 
__ps
), 
wc¢¹ombs
);

566 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢¹ombs_chk_w¬n
,

567 (*
__»¡riù
 
__d¡
,

568 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

569 
size_t
 
__nwc
, size_ˆ
__Ën
,

570 
mb¡©e_t
 *
__»¡riù
 
__ps
,

571 
size_t
 
__d¡Ën
), 
__wc¢¹ombs_chk
)

572 
	`__w¬Ç‰r
 ("wcsnrtombs called with dst buffer smallerhan†en");

574 
__ex‹º_®ways_šlše
 
size_t


575 
	`__NTH
 (
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
, 
__cÚ¡
 
wch¬_t
 **__»¡riù 
__¤c
,

576 
size_t
 
__nwc
, size_ˆ
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

578 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

580 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

581  
	`__wc¢¹ombs_chk
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
,

582 
	`__bos
 (
__d¡
));

584 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

585  
	`__wc¢¹ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
,

586 
	`__bos
 (
__d¡
));

588  
	`__wc¢¹ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
);

589 
	}
}

	@/usr/include/pthread.h

20 #iâdeà
_PTHREAD_H


21 
	#_PTHREAD_H
 1

	)

23 
	~<ã©u»s.h
>

24 
	~<’dŸn.h
>

25 
	~<sched.h
>

26 
	~<time.h
>

28 
	#__Ãed_sig£t_t


	)

29 
	~<sigÇl.h
>

30 
	~<b™s/±h»adty³s.h
>

31 
	~<b™s/£tjmp.h
>

32 
	~<b™s/wÜdsize.h
>

38 
	mPTHREAD_CREATE_JOINABLE
,

39 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

40 
	mPTHREAD_CREATE_DETACHED


41 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

48 
	mPTHREAD_MUTEX_TIMED_NP
,

49 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

50 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

51 
	mPTHREAD_MUTEX_ADAPTIVE_NP


52 #ifdeà
__USE_UNIX98


54 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

55 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

56 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

57 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


59 #ifdeà
__USE_GNU


61 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


66 #ifdeà
__USE_GNU


70 
	mPTHREAD_MUTEX_STALLED_NP
,

71 
	mPTHREAD_MUTEX_ROBUST_NP


76 #ifdeà
__USE_UNIX98


80 
	mPTHREAD_PRIO_NONE
,

81 
	mPTHREAD_PRIO_INHERIT
,

82 
	mPTHREAD_PRIO_PROTECT


88 #ià
__WORDSIZE
 == 64

89 
	#PTHREAD_MUTEX_INITIALIZER
 \

90 { { 0, 0, 0, 0, 0, 0, { 0, 0 } } }

	)

91 #ifdeà
__USE_GNU


92 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

93 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0, 0 } } }

	)

94 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

95 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0, 0 } } }

	)

96 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

97 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0, 0 } } }

	)

100 
	#PTHREAD_MUTEX_INITIALIZER
 \

101 { { 0, 0, 0, 0, 0, { 0 } } }

	)

102 #ifdeà
__USE_GNU


103 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

104 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0 } } }

	)

105 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

106 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0 } } }

	)

107 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

108 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0 } } }

	)

114 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


117 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

118 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

119 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

120 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


124 
	#PTHREAD_RWLOCK_INITIALIZER
 \

125 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

126 #ifdeà
__USE_GNU


127 #ià
__WORDSIZE
 == 64

128 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

130 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

132 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


133 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

134 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

135 0, 0, 0, 0 } }

	)

137 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

138 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

139 0 } }

	)

149 
	mPTHREAD_INHERIT_SCHED
,

150 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

151 
	mPTHREAD_EXPLICIT_SCHED


152 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

159 
	mPTHREAD_SCOPE_SYSTEM
,

160 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

161 
	mPTHREAD_SCOPE_PROCESS


162 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

169 
	mPTHREAD_PROCESS_PRIVATE
,

170 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

171 
	mPTHREAD_PROCESS_SHARED


172 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

178 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*è0, 0, 0 } }

	)

182 
	s_±h»ad_ş—nup_bufãr


184 (*
	m__routše
) (*);

185 *
	m__¬g
;

186 
	m__ÿnûÉy³
;

187 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

193 
	mPTHREAD_CANCEL_ENABLE
,

194 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

195 
	mPTHREAD_CANCEL_DISABLE


196 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

200 
	mPTHREAD_CANCEL_DEFERRED
,

201 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

202 
	mPTHREAD_CANCEL_ASYNCHRONOUS


203 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

205 
	#PTHREAD_CANCELED
 ((*è-1)

	)

209 
	#PTHREAD_ONCE_INIT
 0

	)

212 #ifdeà
__USE_XOPEN2K


216 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

220 
__BEGIN_DECLS


225 
±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

226 
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

227 *(*
__¡¬t_routše
) (*),

228 *
__»¡riù
 
__¬g
è
__THROW
 
__nÚnuÎ
 ((1, 3));

234 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

242 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

244 #ifdeà
__USE_GNU


247 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

255 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

256 
__cÚ¡
 
time¥ec
 *
__ab¡ime
);

263 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

267 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

270 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
è
__THROW
;

278 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

281 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

282 
__THROW
 
	`__nÚnuÎ
 ((1));

285 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__©Œ
,

286 *
__d‘ach¡©e
)

287 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

290 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

291 
__d‘ach¡©e
)

292 
__THROW
 
	`__nÚnuÎ
 ((1));

296 
	$±h»ad_©Œ_g‘gu¬dsize
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__©Œ
,

297 
size_t
 *
__gu¬dsize
)

298 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

301 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

302 
size_t
 
__gu¬dsize
)

303 
__THROW
 
	`__nÚnuÎ
 ((1));

307 
	$±h»ad_©Œ_g‘sched·¿m
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


308 
__©Œ
,

309 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

310 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

313 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

314 
__cÚ¡
 
sched_·¿m
 *
__»¡riù


315 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

318 
	$±h»ad_©Œ_g‘schedpŞicy
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


319 
__©Œ
, *
__»¡riù
 
__pŞicy
)

320 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

323 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

324 
__THROW
 
	`__nÚnuÎ
 ((1));

327 
	$±h»ad_©Œ_g‘šh”™sched
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


328 
__©Œ
, *
__»¡riù
 
__šh”™
)

329 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

332 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

333 
__šh”™
)

334 
__THROW
 
	`__nÚnuÎ
 ((1));

338 
	$±h»ad_©Œ_g‘scİe
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

339 *
__»¡riù
 
__scİe
)

340 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

343 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

344 
__THROW
 
	`__nÚnuÎ
 ((1));

347 
	$±h»ad_©Œ_g‘¡ackaddr
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


348 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

349 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

355 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

356 *
__¡ackaddr
)

357 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

360 
	$±h»ad_©Œ_g‘¡acksize
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


361 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

362 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

367 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

368 
size_t
 
__¡acksize
)

369 
__THROW
 
	`__nÚnuÎ
 ((1));

371 #ifdeà
__USE_XOPEN2K


373 
	$±h»ad_©Œ_g‘¡ack
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

374 **
__»¡riù
 
__¡ackaddr
,

375 
size_t
 *
__»¡riù
 
__¡acksize
)

376 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

381 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

382 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

385 #ifdeà
__USE_GNU


388 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

389 
size_t
 
__ıu£tsize
,

390 
__cÚ¡
 
ıu_£t_t
 *
__ıu£t
)

391 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

395 
	$±h»ad_©Œ_g‘affš™y_Å
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__©Œ
,

396 
size_t
 
__ıu£tsize
,

397 
ıu_£t_t
 *
__ıu£t
)

398 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

404 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

405 
__THROW
 
	`__nÚnuÎ
 ((2));

413 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

414 
__cÚ¡
 
sched_·¿m
 *
__·¿m
)

415 
__THROW
 
	`__nÚnuÎ
 ((3));

418 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

419 *
__»¡riù
 
__pŞicy
,

420 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

421 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

424 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

425 
__THROW
;

428 #ifdeà
__USE_UNIX98


430 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

433 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

436 #ifdeà
__USE_GNU


441 
	$±h»ad_y›ld
 (è
__THROW
;

446 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

447 
__cÚ¡
 
ıu_£t_t
 *
__ıu£t
)

448 
__THROW
 
	`__nÚnuÎ
 ((3));

451 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

452 
ıu_£t_t
 *
__ıu£t
)

453 
__THROW
 
	`__nÚnuÎ
 ((3));

466 
	`±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

467 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

478 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

482 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

485 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

490 
	`±h»ad_‹¡ÿnûl
 ();

499 
__jmp_buf
 
__ÿnûl_jmp_buf
;

500 
__mask_was_§ved
;

501 } 
__ÿnûl_jmp_buf
[1];

502 *
__·d
[4];

503 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

506 #iâdeà
__ş—nup_fù_©Œibu‹


507 
	#__ş—nup_fù_©Œibu‹


	)

512 
	s__±h»ad_ş—nup_äame


514 (*
__ÿnûl_routše
) (*);

515 *
__ÿnûl_¬g
;

516 
__do_™
;

517 
__ÿnûl_ty³
;

520 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


521 #ifdeà
__ılu¥lus


523 şas 
	c__±h»ad_ş—nup_şass


525 (*
__ÿnûl_routše
) (*);

526 *
__ÿnûl_¬g
;

527 
__do_™
;

528 
__ÿnûl_ty³
;

530 
public
:

531 
	`__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

532 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

533 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

534 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

535 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

536 &
__ÿnûl_ty³
); 
	}
}

537 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

547 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

549 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

553 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

554 
__şäame
.
	`__£tdo™
 (
execu‹
); \

555 } 0)

	)

557 #ifdeà
__USE_GNU


561 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

563 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

564 
__şäame
.
	`__deãr
 ()

	)

569 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

570 
__şäame
.
	`__»¡Üe
 (); \

571 
__şäame
.
	`__£tdo™
 (
execu‹
); \

572 } 0)

	)

579 
__ex‹º_šlše
 

580 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

582 ià(
__äame
->
__do_™
)

583 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

584 
	}
}

593 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

595 
__±h»ad_ş—nup_äame
 
__şäame
 \

596 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

597 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

598 .
__do_™
 = 1 };

	)

602 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

603 
__şäame
.
__do_™
 = (
execu‹
); \

604 } 0)

	)

606 #ifdeà
__USE_GNU


610 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

612 
__±h»ad_ş—nup_äame
 
__şäame
 \

613 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

614 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

615 .
__do_™
 = 1 }; \

616 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

617 &
__şäame
.
__ÿnûl_ty³
)

	)

622 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

623 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

624 
__şäame
.
__do_™
 = (
execu‹
); \

625 } 0)

	)

636 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

638 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

639 (*
__ÿnûl_routše
è(*èğ(
routše
); \

640 *
__ÿnûl_¬g
 = (
¬g
); \

641 
nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

642 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

643 ià(
	`__butš_ex³ù
 (
nÙ_fœ¡_ÿÎ
, 0)) \

645 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

646 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

650 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

651 dØ{

	)

652 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

653 
__ş—nup_fù_©Œibu‹
;

657 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

660 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

661 ià(
execu‹
) \

662 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

663 } 0)

	)

664 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

665 
__ş—nup_fù_©Œibu‹
;

667 #ifdeà
__USE_GNU


671 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

673 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

674 (*
__ÿnûl_routše
è(*èğ(
routše
); \

675 *
__ÿnûl_¬g
 = (
¬g
); \

676 
nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

677 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

678 ià(
	`__butš_ex³ù
 (
nÙ_fœ¡_ÿÎ
, 0)) \

680 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

681 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

685 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

686 dØ{

	)

687 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

688 
__ş—nup_fù_©Œibu‹
;

693 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

696 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

697 ià(
execu‹
) \

698 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

699 
	}
} 0)

	)

700 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

701 
__ş—nup_fù_©Œibu‹
;

705 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

706 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

707 #iâdeà
SHARED


708 
	`__©Œibu‹__
 ((
__w—k__
))

714 
__jmp_buf_g
;

715 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROW
;

721 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

722 
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

723 
__THROW
 
	`__nÚnuÎ
 ((1));

726 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

727 
__THROW
 
	`__nÚnuÎ
 ((1));

730 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

731 
__THROW
 
	`__nÚnuÎ
 ((1));

734 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

735 
__THROW
 
	`__nÚnuÎ
 ((1));

737 #ifdeà
__USE_XOPEN2K


739 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

740 
__cÚ¡
 
time¥ec
 *
__»¡riù


741 
__ab¡ime
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

745 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

746 
__THROW
 
	`__nÚnuÎ
 ((1));

749 #ifdeà
__USE_UNIX98


751 
	$±h»ad_mu‹x_g‘´ioûšg
 (
__cÚ¡
 
±h»ad_mu‹x_t
 *

752 
__»¡riù
 
__mu‹x
,

753 *
__»¡riù
 
__´ioûšg
)

754 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

758 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

759 
__´ioûšg
,

760 *
__»¡riù
 
__Şd_ûšg
)

761 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

765 #ifdeà
__USE_GNU


767 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

768 
__THROW
 
	`__nÚnuÎ
 ((1));

776 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

777 
__THROW
 
	`__nÚnuÎ
 ((1));

780 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

781 
__THROW
 
	`__nÚnuÎ
 ((1));

784 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *

785 
__»¡riù
 
__©Œ
,

786 *
__»¡riù
 
__psh¬ed
)

787 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

790 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

791 
__psh¬ed
)

792 
__THROW
 
	`__nÚnuÎ
 ((1));

794 #ifdeà
__USE_UNIX98


796 
	$±h»ad_mu‹x©Œ_g‘ty³
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


797 
__©Œ
, *
__»¡riù
 
__kšd
)

798 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

803 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

804 
__THROW
 
	`__nÚnuÎ
 ((1));

807 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *

808 
__»¡riù
 
__©Œ
,

809 *
__»¡riù
 
__´ÙocŞ
)

810 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

814 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

815 
__´ÙocŞ
)

816 
__THROW
 
	`__nÚnuÎ
 ((1));

819 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *

820 
__»¡riù
 
__©Œ
,

821 *
__»¡riù
 
__´ioûšg
)

822 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

825 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

826 
__´ioûšg
)

827 
__THROW
 
	`__nÚnuÎ
 ((1));

830 #ifdeà
__USE_GNU


832 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

833 *
__robu¡Ãss
)

834 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

837 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

838 
__robu¡Ãss
)

839 
__THROW
 
	`__nÚnuÎ
 ((1));

843 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


848 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

849 
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *
__»¡riù


850 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

853 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

854 
__THROW
 
	`__nÚnuÎ
 ((1));

857 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

858 
__THROW
 
	`__nÚnuÎ
 ((1));

861 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

862 
__THROW
 
	`__nÚnuÎ
 ((1));

864 #ifdeà
__USE_XOPEN2K


866 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

867 
__cÚ¡
 
time¥ec
 *
__»¡riù


868 
__ab¡ime
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

872 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

873 
__THROW
 
	`__nÚnuÎ
 ((1));

876 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

877 
__THROW
 
	`__nÚnuÎ
 ((1));

879 #ifdeà
__USE_XOPEN2K


881 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

882 
__cÚ¡
 
time¥ec
 *
__»¡riù


883 
__ab¡ime
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

887 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

888 
__THROW
 
	`__nÚnuÎ
 ((1));

894 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

895 
__THROW
 
	`__nÚnuÎ
 ((1));

898 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

899 
__THROW
 
	`__nÚnuÎ
 ((1));

902 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *

903 
__»¡riù
 
__©Œ
,

904 *
__»¡riù
 
__psh¬ed
)

905 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

908 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

909 
__psh¬ed
)

910 
__THROW
 
	`__nÚnuÎ
 ((1));

913 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *

914 
__»¡riù
 
__©Œ
,

915 *
__»¡riù
 
__´ef
)

916 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

919 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

920 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

928 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

929 
__cÚ¡
 
±h»ad_cÚd©Œ_t
 *
__»¡riù


930 
__cÚd_©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

933 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

934 
__THROW
 
	`__nÚnuÎ
 ((1));

937 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

938 
__THROW
 
	`__nÚnuÎ
 ((1));

941 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

942 
__THROW
 
	`__nÚnuÎ
 ((1));

949 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

950 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

951 
	`__nÚnuÎ
 ((1, 2));

960 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

961 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

962 
__cÚ¡
 
time¥ec
 *
__»¡riù


963 
__ab¡ime
è
	`__nÚnuÎ
 ((1, 2, 3));

968 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

969 
__THROW
 
	`__nÚnuÎ
 ((1));

972 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

973 
__THROW
 
	`__nÚnuÎ
 ((1));

976 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_cÚd©Œ_t
 *

977 
__»¡riù
 
__©Œ
,

978 *
__»¡riù
 
__psh¬ed
)

979 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

982 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

983 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

985 #ifdeà
__USE_XOPEN2K


987 
	$±h»ad_cÚd©Œ_g‘şock
 (
__cÚ¡
 
±h»ad_cÚd©Œ_t
 *

988 
__»¡riù
 
__©Œ
,

989 
__şockid_t
 *
__»¡riù
 
__şock_id
)

990 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

993 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

994 
__şockid_t
 
__şock_id
)

995 
__THROW
 
	`__nÚnuÎ
 ((1));

999 #ifdeà
__USE_XOPEN2K


1004 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1005 
__THROW
 
	`__nÚnuÎ
 ((1));

1008 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1009 
__THROW
 
	`__nÚnuÎ
 ((1));

1012 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1013 
__THROW
 
	`__nÚnuÎ
 ((1));

1016 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1017 
__THROW
 
	`__nÚnuÎ
 ((1));

1020 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1021 
__THROW
 
	`__nÚnuÎ
 ((1));

1028 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1029 
__cÚ¡
 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1030 
__©Œ
, 
__couÁ
)

1031 
__THROW
 
	`__nÚnuÎ
 ((1));

1034 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1035 
__THROW
 
	`__nÚnuÎ
 ((1));

1038 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1039 
__THROW
 
	`__nÚnuÎ
 ((1));

1043 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1044 
__THROW
 
	`__nÚnuÎ
 ((1));

1047 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1048 
__THROW
 
	`__nÚnuÎ
 ((1));

1051 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_b¬r›¿‰r_t
 *

1052 
__»¡riù
 
__©Œ
,

1053 *
__»¡riù
 
__psh¬ed
)

1054 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1057 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1058 
__psh¬ed
)

1059 
__THROW
 
	`__nÚnuÎ
 ((1));

1071 
	`±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1072 (*
__de¡r_funùiÚ
) (*))

1073 
__THROW
 
	`__nÚnuÎ
 ((1));

1076 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1079 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1082 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1083 
__cÚ¡
 *
__poš‹r
è
__THROW
 ;

1086 #ifdeà
__USE_XOPEN2K


1088 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1089 
__şockid_t
 *
__şock_id
)

1090 
__THROW
 
	`__nÚnuÎ
 ((2));

1105 
	`±h»ad_©fÜk
 ((*
__´•¬e
) (),

1106 (*
__·»Á
) (),

1107 (*
__chd
è()è
__THROW
;

1110 #ifdeà
__USE_EXTERN_INLINES


1112 
__ex‹º_šlše
 

1113 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1115  
__th»ad1
 =ğ
__th»ad2
;

1116 
	}
}

1119 
	g__END_DECLS


	@/usr/include/wctype.h

24 #iâdeà
_WCTYPE_H


26 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

29 #iâdeà
__Ãed_iswxxx


30 
	#_WCTYPE_H
 1

	)

33 
	#__Ãed_wšt_t


	)

34 
	~<wch¬.h
>

38 #iâdeà
WEOF


39 
	#WEOF
 (0xffffffffu)

	)

42 #undeà
__Ãed_iswxxx


47 #iâdeà
__iswxxx_defšed


48 
	#__iswxxx_defšed
 1

	)

50 
__BEGIN_NAMESPACE_C99


53 
	twùy³_t
;

54 
	g__END_NAMESPACE_C99


56 #iâdeà
_ISwb™


61 
	~<’dŸn.h
>

62 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


63 
	#_ISwb™
(
b™
è(1 << (b™))

	)

65 
	#_ISwb™
(
b™
) \

66 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

67 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

68 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

69 : (è((1UL << (
b™
)è>> 24))))

	)

74 
	m__ISwuµ”
 = 0,

75 
	m__ISwlow”
 = 1,

76 
	m__ISw®pha
 = 2,

77 
	m__ISwdig™
 = 3,

78 
	m__ISwxdig™
 = 4,

79 
	m__ISw¥aû
 = 5,

80 
	m__ISw´št
 = 6,

81 
	m__ISwg¿ph
 = 7,

82 
	m__ISwbÏnk
 = 8,

83 
	m__ISwúŒl
 = 9,

84 
	m__ISwpunù
 = 10,

85 
	m__ISw®num
 = 11,

87 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

88 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

89 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

90 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

91 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

92 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

93 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

94 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

95 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

96 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

97 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

98 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

103 
__BEGIN_DECLS


105 
__BEGIN_NAMESPACE_C99


112 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

118 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

121 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

125 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

129 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

134 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

137 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

142 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

147 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

152 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

157 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

162 #ifdeà
__USE_ISOC99


163 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

172 
wùy³_t
 
	$wùy³
 (
__cÚ¡
 *
__´İ”ty
è
__THROW
;

176 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

177 
__END_NAMESPACE_C99


184 
__BEGIN_NAMESPACE_C99


187 
__cÚ¡
 
	t__št32_t
 *
	twù¿ns_t
;

188 
__END_NAMESPACE_C99


189 #ifdeà
__USE_GNU


190 
	$__USING_NAMESPACE_C99
(
wù¿ns_t
)

193 
__BEGIN_NAMESPACE_C99


195 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

198 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

199 
__END_NAMESPACE_C99


201 
__END_DECLS


208 #ifdeà
_WCTYPE_H


214 
__BEGIN_DECLS


216 
__BEGIN_NAMESPACE_C99


219 
wù¿ns_t
 
	$wù¿ns
 (
__cÚ¡
 *
__´İ”ty
è
__THROW
;

222 
wšt_t
 
	$towù¿ns
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
è
__THROW
;

223 
__END_NAMESPACE_C99


225 #ifdeà
__USE_GNU


227 
	~<xloÿË.h
>

231 
	$isw®num_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

237 
	$isw®pha_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

240 
	$iswúŒl_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

244 
	$iswdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

248 
	$iswg¿ph_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

253 
	$iswlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

256 
	$isw´št_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

261 
	$iswpunù_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

266 
	$isw¥aû_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

271 
	$iswuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

276 
	$iswxdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

281 
	$iswbÏnk_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

285 
wùy³_t
 
	$wùy³_l
 (
__cÚ¡
 *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

286 
__THROW
;

290 
	$iswùy³_l
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
, 
__loÿË_t
 
__loÿË
)

291 
__THROW
;

299 
wšt_t
 
	$towlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

302 
wšt_t
 
	$towuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

306 
wù¿ns_t
 
	$wù¿ns_l
 (
__cÚ¡
 *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

307 
__THROW
;

310 
wšt_t
 
	$towù¿ns_l
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
,

311 
__loÿË_t
 
__loÿË
è
__THROW
;

315 
__END_DECLS


	@/usr/include/asm-generic/errno-base.h

1 #iâdeà
_ASM_GENERIC_ERRNO_BASE_H


2 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

4 
	#EPERM
 1

	)

5 
	#ENOENT
 2

	)

6 
	#ESRCH
 3

	)

7 
	#EINTR
 4

	)

8 
	#EIO
 5

	)

9 
	#ENXIO
 6

	)

10 
	#E2BIG
 7

	)

11 
	#ENOEXEC
 8

	)

12 
	#EBADF
 9

	)

13 
	#ECHILD
 10

	)

14 
	#EAGAIN
 11

	)

15 
	#ENOMEM
 12

	)

16 
	#EACCES
 13

	)

17 
	#EFAULT
 14

	)

18 
	#ENOTBLK
 15

	)

19 
	#EBUSY
 16

	)

20 
	#EEXIST
 17

	)

21 
	#EXDEV
 18

	)

22 
	#ENODEV
 19

	)

23 
	#ENOTDIR
 20

	)

24 
	#EISDIR
 21

	)

25 
	#EINVAL
 22

	)

26 
	#ENFILE
 23

	)

27 
	#EMFILE
 24

	)

28 
	#ENOTTY
 25

	)

29 
	#ETXTBSY
 26

	)

30 
	#EFBIG
 27

	)

31 
	#ENOSPC
 28

	)

32 
	#ESPIPE
 29

	)

33 
	#EROFS
 30

	)

34 
	#EMLINK
 31

	)

35 
	#EPIPE
 32

	)

36 
	#EDOM
 33

	)

37 
	#ERANGE
 34

	)

	@/usr/include/bits/setjmp.h

20 #iâdeà
_BITS_SETJMP_H


21 
	#_BITS_SETJMP_H
 1

	)

23 #ià!
defšed
 
_SETJMP_H
 && !defšed 
_PTHREAD_H


27 
	~<b™s/wÜdsize.h
>

29 #iâdeà
_ASM


31 #ià
__WORDSIZE
 == 64

32 
	t__jmp_buf
[8];

34 
	t__jmp_buf
[6];

	@/usr/include/sched.h

20 #iâdef 
_SCHED_H


21 
	#_SCHED_H
 1

	)

23 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	#__Ãed_size_t


	)

29 
	~<¡ddef.h
>

31 
	#__Ãed_time¥ec


	)

32 
	~<time.h
>

35 
	~<b™s/sched.h
>

37 
	#sched_´iÜ™y
 
__sched_´iÜ™y


	)

40 
__BEGIN_DECLS


43 
	$sched_£¬am
 (
__pid_t
 
__pid
, 
__cÚ¡
 
sched_·¿m
 *
__·¿m
)

44 
__THROW
;

47 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

50 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

51 
__cÚ¡
 
sched_·¿m
 *
__·¿m
è
__THROW
;

54 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

57 
	$sched_y›ld
 (è
__THROW
;

60 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

63 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

66 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

69 #ifdeà
__USE_GNU


71 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

72 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

73 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

74 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

75 
ıu£
)

	)

76 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

77 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

79 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

80 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

81 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

82 
ıu£
)

	)

83 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

84 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

86 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

87 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

88 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

89 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

91 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

92 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

93 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

94 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

95 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

96 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

97 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

98 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

99 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

100 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

101 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

102 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

104 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

105 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

106 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

110 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

111 
__cÚ¡
 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

114 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

115 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

118 
__END_DECLS


	@/usr/include/bits/sched.h

22 #iâdeà
__Ãed_sched·¿m


24 #iâdeà
_SCHED_H


30 
	#SCHED_OTHER
 0

	)

31 
	#SCHED_FIFO
 1

	)

32 
	#SCHED_RR
 2

	)

33 #ifdeà
__USE_GNU


34 
	#SCHED_BATCH
 3

	)

37 #ifdeà
__USE_MISC


39 
	#CSIGNAL
 0x000000fà

	)

40 
	#CLONE_VM
 0x00000100

	)

41 
	#CLONE_FS
 0x00000200

	)

42 
	#CLONE_FILES
 0x00000400

	)

43 
	#CLONE_SIGHAND
 0x00000800

	)

44 
	#CLONE_PTRACE
 0x00002000

	)

45 
	#CLONE_VFORK
 0x00004000

	)

47 
	#CLONE_PARENT
 0x00008000

	)

49 
	#CLONE_THREAD
 0x00010000

	)

50 
	#CLONE_NEWNS
 0x00020000

	)

51 
	#CLONE_SYSVSEM
 0x00040000

	)

52 
	#CLONE_SETTLS
 0x00080000

	)

53 
	#CLONE_PARENT_SETTID
 0x00100000

	)

55 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

57 
	#CLONE_DETACHED
 0x00400000

	)

58 
	#CLONE_UNTRACED
 0x00800000

	)

60 
	#CLONE_CHILD_SETTID
 0x01000000

	)

62 
	#CLONE_NEWUTS
 0x04000000

	)

63 
	#CLONE_NEWIPC
 0x08000000

	)

64 
	#CLONE_NEWUSER
 0x10000000

	)

65 
	#CLONE_NEWPID
 0x20000000

	)

66 
	#CLONE_NEWNET
 0x40000000

	)

67 
	#CLONE_IO
 0x80000000

	)

71 
	ssched_·¿m


73 
	m__sched_´iÜ™y
;

76 
	g__BEGIN_DECLS


78 #ifdeà
__USE_MISC


80 
şÚe
 ((*
__â
è(*
__¬g
), *
__chd_¡ack
,

81 
__æags
, *
__¬g
, ...è
__THROW
;

84 
	$unsh¬e
 (
__æags
è
__THROW
;

87 
	$sched_g‘ıu
 (è
__THROW
;

90 
__END_DECLS


94 #ià!
defšed
 
__defšed_sched·¿m
 \

95 && (
defšed
 
__Ãed_sched·¿m
 || defšed 
_SCHED_H
)

96 
	#__defšed_sched·¿m
 1

	)

98 
	s__sched_·¿m


100 
__sched_´iÜ™y
;

102 #undeà
__Ãed_sched·¿m


106 #ià
defšed
 
_SCHED_H
 && !defšed 
__ıu_£t_t_defšed


107 
	#__ıu_£t_t_defšed


	)

109 
	#__CPU_SETSIZE
 1024

	)

110 
	#__NCPUBITS
 (8 *  (
__ıu_mask
))

	)

113 
	t__ıu_mask
;

116 
	#__CPUELT
(
ıu
è((ıuè/ 
__NCPUBITS
)

	)

117 
	#__CPUMASK
(
ıu
è((
__ıu_mask
è1 << ((ıuè% 
__NCPUBITS
))

	)

122 
__ıu_mask
 
__b™s
[
__CPU_SETSIZE
 / 
__NCPUBITS
];

123 } 
	tıu_£t_t
;

126 #ià
	`__GNUC_PREREQ
 (2, 91)

127 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

128 dØ
	`__butš_mem£t
 (
ıu£
, '\0', 
£tsize
); 0)

	)

130 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

132 
size_t
 
__i
; \

133 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

134 
ıu_£t_t
 *
__¬r
 = (
ıu£
); \

135 
__i
 = 0; __˜< 
__imax
; ++__i) \

136 
__¬r
->
__b™s
[
__i
] = 0; \

137 
	}
} 0)

	)

139 
	#__CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
) \

140 (
__ex‹nsiÚ__
 \

141 ({ 
size_t
 
__ıu
 = (
ıu
); \

142 
__ıu
 < 8 * (
£tsize
) \

143 ? ((
ıu£
)->
__b™s
[
	`__CPUELT
 (
__ıu
)] |ğ
	`__CPUMASK
 (__ıu)è: 0; }))

	)

144 
	#__CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
) \

145 (
__ex‹nsiÚ__
 \

146 ({ 
size_t
 
__ıu
 = (
ıu
); \

147 
__ıu
 < 8 * (
£tsize
) \

148 ? ((
ıu£
)->
__b™s
[
	`__CPUELT
 (
__ıu
)] &ğ~
	`__CPUMASK
 (__ıu)è: 0; }))

	)

149 
	#__CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
) \

150 (
__ex‹nsiÚ__
 \

151 ({ 
size_t
 
__ıu
 = (
ıu
); \

152 
__ıu
 < 8 * (
£tsize
) \

153 ? (((
ıu£
)->
__b™s
[
	`__CPUELT
 (
__ıu
)] & 
	`__CPUMASK
 (__cpu))) != 0 \

154 : 0; }))

	)

156 
	#__CPU_COUNT_S
(
£tsize
, 
ıu£
) \

157 
	`__sched_ıucouÁ
 (
£tsize
, 
ıu£
)

	)

159 #ià
__GNUC_PREREQ
 (2, 91)

160 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

161 (
	`__butš_memcmp
 (
ıu£1
, 
ıu£2
, 
£tsize
è=ğ0)

	)

163 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

164 (
__ex‹nsiÚ__
 \

165 ({ 
ıu_£t_t
 *
__¬r1
 = (
ıu£1
); \

166 
ıu_£t_t
 *
__¬r2
 = (
ıu£2
); \

167 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

168 
size_t
 
__i
; \

169 
__i
 = 0; __˜< 
__imax
; ++__i) \

170 ià(
__¬r1
->
__b™s
[
__i
] !ğ
__¬r2
->__bits[__i]) \

172 
__i
 =ğ
__imax
; }))

	)

175 
	#__CPU_OP_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, 
İ
) \

176 (
__ex‹nsiÚ__
 \

177 ({ 
ıu_£t_t
 *
__de¡
 = (
de¡£t
); \

178 
ıu_£t_t
 *
__¬r1
 = (
¤c£t1
); \

179 
ıu_£t_t
 *
__¬r2
 = (
¤c£t2
); \

180 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

181 
size_t
 
__i
; \

182 
__i
 = 0; __˜< 
__imax
; ++__i) \

183 
__de¡
->
__b™s
[
__i
] = 
__¬r1
->__b™s[__i] 
İ
 
__¬r2
->__bits[__i]; \

184 
__de¡
; }))

	)

186 
	#__CPU_ALLOC_SIZE
(
couÁ
) \

187 ((((
couÁ
è+ 
__NCPUBITS
 - 1è/ __NCPUBITSè*  (
__ıu_mask
))

	)

188 
	#__CPU_ALLOC
(
couÁ
è
	`__sched_ıu®loc
 (couÁ)

	)

189 
	#__CPU_FREE
(
ıu£t
è
	`__sched_ıuä“
 (ıu£t)

	)

191 
__BEGIN_DECLS


193 
	$__sched_ıucouÁ
 (
size_t
 
__£tsize
, cÚ¡ 
ıu_£t_t
 *
__£
)

194 
__THROW
;

195 
ıu_£t_t
 *
	$__sched_ıu®loc
 (
size_t
 
__couÁ
è
__THROW
 
__wur
;

196 
	$__sched_ıuä“
 (
ıu_£t_t
 *
__£t
è
__THROW
;

198 
__END_DECLS


	@
1
.
1
/usr/include
408
10781
hald-runner/main.c
hald-runner/runner.c
hald-runner/runner.h
hald-runner/utils.c
hald-runner/utils.h
hald/access-check.c
hald/access-check.h
hald/cache_test.c
hald/ci-tracker.c
hald/ci-tracker.h
hald/ck-tracker.c
hald/ck-tracker.h
hald/create_cache.c
hald/device.c
hald/device.h
hald/device_info.c
hald/device_info.h
hald/device_pm.c
hald/device_pm.h
hald/device_store.c
hald/device_store.h
hald/dummy/osspec.c
hald/freebsd/addons/addon-storage.c
hald/freebsd/hal-file-monitor.c
hald/freebsd/hf-acpi.c
hald/freebsd/hf-acpi.h
hald/freebsd/hf-ata.c
hald/freebsd/hf-ata.h
hald/freebsd/hf-block.c
hald/freebsd/hf-block.h
hald/freebsd/hf-computer.c
hald/freebsd/hf-computer.h
hald/freebsd/hf-devd.c
hald/freebsd/hf-devd.h
hald/freebsd/hf-devtree.c
hald/freebsd/hf-devtree.h
hald/freebsd/hf-drm.c
hald/freebsd/hf-drm.h
hald/freebsd/hf-net.c
hald/freebsd/hf-net.h
hald/freebsd/hf-osspec.h
hald/freebsd/hf-pci.c
hald/freebsd/hf-pci.h
hald/freebsd/hf-pcmcia.c
hald/freebsd/hf-pcmcia.h
hald/freebsd/hf-scsi.c
hald/freebsd/hf-scsi.h
hald/freebsd/hf-serial.c
hald/freebsd/hf-serial.h
hald/freebsd/hf-sound.c
hald/freebsd/hf-sound.h
hald/freebsd/hf-storage.c
hald/freebsd/hf-storage.h
hald/freebsd/hf-usb.c
hald/freebsd/hf-usb.h
hald/freebsd/hf-util.c
hald/freebsd/hf-util.h
hald/freebsd/hf-volume.c
hald/freebsd/hf-volume.h
hald/freebsd/libprobe/hfp-cdrom.c
hald/freebsd/libprobe/hfp-cdrom.h
hald/freebsd/libprobe/hfp.c
hald/freebsd/libprobe/hfp.h
hald/freebsd/osspec.c
hald/freebsd/probing/freebsd_dvd_rw_utils.c
hald/freebsd/probing/freebsd_dvd_rw_utils.h
hald/freebsd/probing/probe-hiddev.c
hald/freebsd/probing/probe-scsi.c
hald/freebsd/probing/probe-smbios.c
hald/freebsd/probing/probe-storage.c
hald/freebsd/probing/probe-volume.c
hald/hal-file-monitor.h
hald/hald.c
hald/hald.h
hald/hald_dbus.c
hald/hald_dbus.h
hald/hald_runner.c
hald/hald_runner.h
hald/hald_test.c
hald/hald_test_libhal.c
hald/ids.c
hald/ids.h
hald/linux/acpi.c
hald/linux/acpi.h
hald/linux/addons/addon-acpi-buttons-toshiba.c
hald/linux/addons/addon-acpi.c
hald/linux/addons/addon-als.c
hald/linux/addons/addon-cpufreq-userspace.c
hald/linux/addons/addon-cpufreq-userspace.h
hald/linux/addons/addon-cpufreq.c
hald/linux/addons/addon-cpufreq.h
hald/linux/addons/addon-dell-backlight.cpp
hald/linux/addons/addon-generic-backlight.c
hald/linux/addons/addon-hid-ups.c
hald/linux/addons/addon-imac-backlight.c
hald/linux/addons/addon-input.c
hald/linux/addons/addon-ipw-killswitch.c
hald/linux/addons/addon-leds.c
hald/linux/addons/addon-macbook-backlight.c
hald/linux/addons/addon-macbookpro-backlight.c
hald/linux/addons/addon-mmc.c
hald/linux/addons/addon-omap-backlight.c
hald/linux/addons/addon-omap-gpio.c
hald/linux/addons/addon-pmu.c
hald/linux/addons/addon-rfkill-killswitch.c
hald/linux/addons/addon-storage.c
hald/linux/addons/addon-usb-cable.c
hald/linux/addons/addon-usb-csr.c
hald/linux/apm.c
hald/linux/apm.h
hald/linux/blockdev.c
hald/linux/blockdev.h
hald/linux/coldplug.c
hald/linux/coldplug.h
hald/linux/device.c
hald/linux/device.h
hald/linux/hal-file-monitor.c
hald/linux/hotplug.c
hald/linux/hotplug.h
hald/linux/hotplug_helper.h
hald/linux/inotify_local.h
hald/linux/input_local.h
hald/linux/osspec.c
hald/linux/osspec_linux.h
hald/linux/pmu.c
hald/linux/pmu.h
hald/linux/probing/linux_dvd_rw_utils.c
hald/linux/probing/linux_dvd_rw_utils.h
hald/linux/probing/probe-hiddev.c
hald/linux/probing/probe-ieee1394-unit.c
hald/linux/probing/probe-input.c
hald/linux/probing/probe-net-bluetooth.c
hald/linux/probing/probe-pc-floppy.c
hald/linux/probing/probe-printer.c
hald/linux/probing/probe-serial.c
hald/linux/probing/probe-smbios.c
hald/linux/probing/probe-storage.c
hald/linux/probing/probe-video4linux.c
hald/linux/probing/probe-volume.c
hald/logger.c
hald/logger.h
hald/mmap_cache.c
hald/mmap_cache.h
hald/osspec.h
hald/rule.h
hald/solaris/addons/addon-storage.c
hald/solaris/devinfo.c
hald/solaris/devinfo.h
hald/solaris/devinfo_ieee1394.c
hald/solaris/devinfo_ieee1394.h
hald/solaris/devinfo_misc.c
hald/solaris/devinfo_misc.h
hald/solaris/devinfo_pci.c
hald/solaris/devinfo_pci.h
hald/solaris/devinfo_storage.c
hald/solaris/devinfo_storage.h
hald/solaris/devinfo_usb.c
hald/solaris/devinfo_usb.h
hald/solaris/hotplug.c
hald/solaris/hotplug.h
hald/solaris/osspec.c
hald/solaris/osspec_solaris.h
hald/solaris/probing/cdutils.c
hald/solaris/probing/cdutils.h
hald/solaris/probing/fsutils.c
hald/solaris/probing/fsutils.h
hald/solaris/probing/probe-storage.c
hald/solaris/probing/probe-volume.c
hald/solaris/sysevent.c
hald/solaris/sysevent.h
hald/util.c
hald/util.h
hald/util_helper.c
hald/util_helper.h
hald/util_helper_priv.c
hald/util_helper_priv.h
hald/util_pm.c
hald/util_pm.h
libhal-storage/libhal-storage.c
libhal-storage/libhal-storage.h
libhal/libhal.c
libhal/libhal.h
libhal/uthash.h
partutil/partutil.c
partutil/partutil.h
tools/hal-acl-tool.c
tools/hal-device.c
tools/hal-disable-polling.c
tools/hal-is-caller-locked-out.c
tools/hal-is-caller-privileged.c
tools/hal-lock.c
tools/hal-setup-keymap.c
tools/hal-storage-cleanup-all-mountpoints.c
tools/hal-storage-cleanup-mountpoint.c
tools/hal-storage-closetray.c
tools/hal-storage-eject.c
tools/hal-storage-mount.c
tools/hal-storage-shared.c
tools/hal-storage-shared.h
tools/hal-storage-unmount.c
tools/hal-system-power-pm-is-supported.c
tools/hal-system-power-pmu.c
tools/hal-system-setserial.c
tools/hal-system-sonypic.c
tools/hal_find_by_capability.c
tools/hal_find_by_property.c
tools/hal_get_property.c
tools/hal_set_property.c
tools/lshal.c
tools/umount-hal.c
/usr/include/asm/byteorder.h
/usr/include/asm/types.h
/usr/include/assert.h
/usr/include/ctype.h
/usr/include/dirent.h
/usr/include/errno.h
/usr/include/error.h
/usr/include/expat.h
/usr/include/fcntl.h
/usr/include/fstab.h
/usr/include/getopt.h
/usr/include/grp.h
/usr/include/inttypes.h
/usr/include/libgen.h
/usr/include/libintl.h
/usr/include/limits.h
/usr/include/linux/adb.h
/usr/include/linux/cdrom.h
/usr/include/linux/fd.h
/usr/include/linux/fs.h
/usr/include/linux/hdreg.h
/usr/include/linux/hiddev.h
/usr/include/linux/if.h
/usr/include/linux/if_arp.h
/usr/include/linux/kdev_t.h
/usr/include/linux/pmu.h
/usr/include/linux/serial.h
/usr/include/linux/sonypi.h
/usr/include/linux/time.h
/usr/include/linux/types.h
/usr/include/linux/videodev.h
/usr/include/linux/videodev2.h
/usr/include/linux/wireless.h
/usr/include/malloc.h
/usr/include/math.h
/usr/include/mntent.h
/usr/include/net/if.h
/usr/include/net/if_arp.h
/usr/include/netinet/in.h
/usr/include/poll.h
/usr/include/pwd.h
/usr/include/scsi/scsi.h
/usr/include/scsi/sg.h
/usr/include/signal.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/strings.h
/usr/include/sys/file.h
/usr/include/sys/inotify.h
/usr/include/sys/io.h
/usr/include/sys/ioctl.h
/usr/include/sys/mman.h
/usr/include/sys/mount.h
/usr/include/sys/param.h
/usr/include/sys/poll.h
/usr/include/sys/prctl.h
/usr/include/sys/resource.h
/usr/include/sys/socket.h
/usr/include/sys/stat.h
/usr/include/sys/syscall.h
/usr/include/sys/sysctl.h
/usr/include/sys/time.h
/usr/include/sys/types.h
/usr/include/sys/un.h
/usr/include/sys/utsname.h
/usr/include/sys/wait.h
/usr/include/syslog.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm/unistd.h
/usr/include/bits/byteswap.h
/usr/include/bits/confname.h
/usr/include/bits/dirent.h
/usr/include/bits/environments.h
/usr/include/bits/errno.h
/usr/include/bits/error.h
/usr/include/bits/fcntl.h
/usr/include/bits/fcntl2.h
/usr/include/bits/huge_val.h
/usr/include/bits/huge_valf.h
/usr/include/bits/huge_vall.h
/usr/include/bits/in.h
/usr/include/bits/inf.h
/usr/include/bits/ioctl-types.h
/usr/include/bits/ioctls.h
/usr/include/bits/mathcalls.h
/usr/include/bits/mathdef.h
/usr/include/bits/mathinline.h
/usr/include/bits/mman.h
/usr/include/bits/nan.h
/usr/include/bits/poll.h
/usr/include/bits/posix1_lim.h
/usr/include/bits/posix2_lim.h
/usr/include/bits/posix_opt.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/resource.h
/usr/include/bits/sigaction.h
/usr/include/bits/sigcontext.h
/usr/include/bits/siginfo.h
/usr/include/bits/signum.h
/usr/include/bits/sigset.h
/usr/include/bits/sigstack.h
/usr/include/bits/sigthread.h
/usr/include/bits/sockaddr.h
/usr/include/bits/socket.h
/usr/include/bits/socket2.h
/usr/include/bits/stat.h
/usr/include/bits/stdio-ldbl.h
/usr/include/bits/stdio.h
/usr/include/bits/stdio2.h
/usr/include/bits/stdio_lim.h
/usr/include/bits/stdlib-ldbl.h
/usr/include/bits/stdlib.h
/usr/include/bits/string.h
/usr/include/bits/string2.h
/usr/include/bits/string3.h
/usr/include/bits/sys_errlist.h
/usr/include/bits/syscall.h
/usr/include/bits/time.h
/usr/include/bits/types.h
/usr/include/bits/unistd.h
/usr/include/bits/utsname.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/bits/wchar.h
/usr/include/bits/wordsize.h
/usr/include/bits/xopen_lim.h
/usr/include/endian.h
/usr/include/expat_external.h
/usr/include/features.h
/usr/include/libio.h
/usr/include/linux/byteorder/little_endian.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/ioctl.h
/usr/include/linux/limits.h
/usr/include/linux/netdevice.h
/usr/include/linux/param.h
/usr/include/linux/posix_types.h
/usr/include/linux/prctl.h
/usr/include/linux/socket.h
/usr/include/linux/sysctl.h
/usr/include/locale.h
/usr/include/paths.h
/usr/include/sys/cdefs.h
/usr/include/sys/select.h
/usr/include/sys/syslog.h
/usr/include/sys/sysmacros.h
/usr/include/sys/ttydefaults.h
/usr/include/sys/ucontext.h
/usr/include/sys/uio.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/asm/ioctl.h
/usr/include/asm/ioctls.h
/usr/include/asm/param.h
/usr/include/asm/posix_types.h
/usr/include/asm/socket.h
/usr/include/bits/endian.h
/usr/include/bits/libio-ldbl.h
/usr/include/bits/local_lim.h
/usr/include/bits/locale.h
/usr/include/bits/select.h
/usr/include/bits/stdio-lock.h
/usr/include/bits/syslog-ldbl.h
/usr/include/bits/syslog-path.h
/usr/include/bits/syslog.h
/usr/include/bits/typesizes.h
/usr/include/bits/uio.h
/usr/include/gnu/stubs.h
/usr/include/linux/byteorder/swab.h
/usr/include/linux/byteorder/swabb.h
/usr/include/linux/errno.h
/usr/include/linux/if_ether.h
/usr/include/linux/if_packet.h
/usr/include/linux/kernel.h
/usr/include/linux/sockios.h
/usr/include/linux/stddef.h
/usr/include/linux/uio.h
/usr/include/asm-generic/ioctl.h
/usr/include/asm/errno.h
/usr/include/asm/sockios.h
/usr/include/bits/libc-lock.h
/usr/include/gconv.h
/usr/include/gnu/stubs-32.h
/usr/include/wchar.h
/usr/include/asm-generic/errno.h
/usr/include/bits/wchar-ldbl.h
/usr/include/bits/wchar2.h
/usr/include/pthread.h
/usr/include/wctype.h
/usr/include/asm-generic/errno-base.h
/usr/include/bits/setjmp.h
/usr/include/sched.h
/usr/include/bits/sched.h
